# 🚀 GitHub Pages 배포 완벽 가이드

## 📋 시작하기 전에

다음 항목들을 준비해주세요:

1. ✅ GitHub 계정 (https://github.com)
2. ✅ Supabase 프로젝트 생성
3. ✅ Supabase에 schema.sql 실행 완료
4. ✅ Supabase Storage 버킷 생성 완료

---

## 1️⃣ GitHub 저장소 생성 (웹에서)

### 방법:
1. https://github.com/new 접속
2. **Repository name** 입력: `company-intranet` 
   - (원하는 이름으로 변경 가능)
3. **Public** 또는 **Private** 선택
4. **Create repository** 클릭
5. 생성된 페이지에서 저장소 URL 복사
   - 예: `https://github.com/heony/company-intranet.git`

> ⚠️ **중요**: 저장소 이름을 기억하세요! (예: `company-intranet`)

---

## 2️⃣ 저장소 이름 설정 확인

`vite.config.js` 파일을 열고 `base` 경로가 저장소 이름과 일치하는지 확인:

```javascript
export default defineConfig({
  plugins: [react()],
  base: '/company-intranet/',  // ← 여기! 저장소 이름과 일치해야 함
})
```

**예시:**
- 저장소 이름이 `my-intranet` → `base: '/my-intranet/'`
- 저장소 이름이 `work-system` → `base: '/work-system/'`

현재는 `company-intranet`으로 설정되어 있습니다.

---

## 3️⃣ Git 초기화 및 푸시 (터미널에서)

### 터미널 명령어:

```bash
# 1. 모든 파일 추가
git add .

# 2. 첫 커밋 생성
git commit -m "feat: 업무일지 관리 시스템 초기 배포"

# 3. GitHub 저장소 연결 
# (아래 URL을 1단계에서 복사한 실제 주소로 변경)
git remote add origin https://github.com/사용자명/company-intranet.git

# 4. main 브랜치로 푸시
git branch -M main
git push -u origin main
```

> ✏️ **수정 필수**: 3번 명령어의 URL을 실제 저장소 주소로 변경하세요!

---

## 4️⃣ GitHub Secrets 설정 (웹에서)

### Supabase 키 찾기:
1. https://supabase.com 로그인
2. 프로젝트 선택
3. 왼쪽 메뉴 **Settings** → **API**
4. 다음 정보 복사:
   - **Project URL** (예: `https://xxxxx.supabase.co`)
   - **anon public** 키 (긴 문자열)

### GitHub에 등록:
1. GitHub 저장소 페이지로 이동
2. **Settings** 탭 클릭
3. 왼쪽 메뉴 → **Secrets and variables** → **Actions** 클릭
4. **New repository secret** 버튼 클릭

#### Secret 1 추가:
```
Name: VITE_SUPABASE_URL
Secret: https://xxxxx.supabase.co
```
↑ Supabase의 **Project URL** 붙여넣기

#### Secret 2 추가:
```
Name: VITE_SUPABASE_ANON_KEY
Secret: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```
↑ Supabase의 **anon public** 키 붙여넣기

> ⚠️ **주의**: 오타가 있으면 배포 실패! 복사-붙여넣기로 정확히 입력하세요.

---

## 5️⃣ GitHub Pages 활성화 (웹에서)

1. 같은 **Settings** 페이지에서
2. 왼쪽 메뉴 → **Pages** 클릭
3. **Source** 섹션에서:
   - ❌ `Deploy from a branch` (이거 아님!)
   - ✅ `GitHub Actions` 선택
4. 자동 저장됨 (Save 버튼 없음)

---

## 6️⃣ 배포 확인 (자동 배포됨!)

### 진행 상황 확인:
1. GitHub 저장소의 **Actions** 탭 클릭
2. "Deploy to GitHub Pages" 워크플로우 확인
3. 진행 중: 🟡 노란색 점
4. 성공: ✅ 초록색 체크 (약 1-2분 소요)
5. 실패: ❌ 빨간색 X (에러 로그 확인 가능)

### 배포된 사이트 접속:
```
https://사용자명.github.io/company-intranet/
```

예시:
- 사용자명이 `heony` → `https://heony.github.io/company-intranet/`
- 사용자명이 `john` → `https://john.github.io/company-intranet/`

---

## 🔄 코드 수정 후 재배포

코드를 수정한 후 다시 배포하는 방법:

### 방법 1: 자동 스크립트 (추천)
```bash
./deploy.sh
```
스크립트가 커밋 메시지를 입력받고 자동으로 배포합니다.

### 방법 2: 수동 배포
```bash
git add .
git commit -m "fix: 버그 수정"
git push origin main
```

푸시하면 GitHub Actions가 자동으로 재배포합니다!

---

## ❓ 문제 해결

### 문제 1: 페이지가 404 오류
**증상**: 배포 성공했는데 페이지에 404 오류  
**원인**: `vite.config.js`의 `base` 경로가 저장소 이름과 불일치  
**해결**:
1. `vite.config.js` 열기
2. `base: '/저장소이름/'`이 정확한지 확인
3. 수정 후 다시 푸시

### 문제 2: Actions 탭에서 빌드 실패
**증상**: ❌ 빨간색 X 표시  
**원인**: Secrets 오타 또는 미설정  
**해결**:
1. GitHub → Settings → Secrets 확인
2. `VITE_SUPABASE_URL`과 `VITE_SUPABASE_ANON_KEY` 재확인
3. 오타 수정 후 다시 푸시

### 문제 3: 이미지 업로드 안됨
**증상**: 이미지 첨부 버튼 클릭해도 업로드 실패  
**원인**: Supabase Storage 버킷 또는 RLS 정책 미설정  
**해결**:
1. Supabase Dashboard → Storage
2. `work_log_images` 버킷 생성 확인
3. `work_logs_pdfs` 버킷 생성 확인
4. RLS 정책 설정 (`supabase/schema.sql` 하단 참고)

### 문제 4: 로그인 안됨
**증상**: 이메일 입력 후 매직링크 안옴  
**원인**: Supabase Auth 설정 문제  
**해결**:
1. Supabase → Authentication → URL Configuration
2. **Site URL** 설정: `https://사용자명.github.io/company-intranet/`
3. **Redirect URLs** 추가: 위와 동일

---

## ✅ 배포 성공 체크리스트

배포 후 다음 항목들을 확인하세요:

- [ ] 사이트 접속 가능 (`https://사용자명.github.io/저장소명/`)
- [ ] 로그인 페이지 표시됨
- [ ] 매직링크 로그인 작동
- [ ] 대시보드 데이터 로드
- [ ] 공지사항 목록 표시
- [ ] 업무일지 작성 가능
- [ ] 이미지 업로드 및 압축 작동
- [ ] PDF 첨부 가능
- [ ] 마이페이지 수정 가능

---

## 📱 모바일에서도 확인하세요!

배포된 사이트는 반응형이므로 모바일에서도 잘 작동합니다.

---

## 💡 팁

### GitHub Desktop 사용자
GUI 도구를 선호한다면:
1. GitHub Desktop 다운로드: https://desktop.github.com
2. 저장소 클론
3. 파일 수정
4. Commit → Push 버튼 클릭

### 배포 URL 공유
팀원들에게 배포 URL을 공유하세요:
```
https://사용자명.github.io/company-intranet/
```

### 커스텀 도메인 사용
회사 도메인을 사용하고 싶다면:
1. GitHub Pages → Custom domain 설정
2. DNS CNAME 레코드 추가
3. HTTPS 자동 적용

---

## 🎉 배포 완료!

축하합니다! 이제 업무일지 시스템을 온라인에서 사용할 수 있습니다.

**다음 단계:**
1. 팀원들을 Supabase에 사용자로 등록
2. 관리자 권한 설정 (users 테이블의 role을 'admin'으로 변경)
3. 공지사항 작성
4. 업무일지 작성 시작!

문제가 있으면 GitHub Issues에 등록하거나 DEPLOY.md를 참고하세요.

**배포 성공을 기원합니다! 🚀**
