(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();const oC="modulepreload",lC=function(e){return"/company-intranet/"+e},sN={},cC=function(t,r,s){let a=Promise.resolve();if(r&&r.length>0){let d=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");a=d(r.map(h=>{if(h=lC(h),h in sN)return;sN[h]=!0;const m=h.endsWith(".css"),x=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${x}`))return;const y=document.createElement("link");if(y.rel=m?"stylesheet":oC,m||(y.as="script"),y.crossOrigin="",y.href=h,u&&y.setAttribute("nonce",u),document.head.appendChild(y),m)return new Promise((v,b)=>{y.addEventListener("load",v),y.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${h}`)))})}))}function o(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return a.then(l=>{for(const u of l||[])u.status==="rejected"&&o(u.reason);return t().catch(o)})};var Th=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Rx={exports:{}},Xu={};var aN;function uC(){if(aN)return Xu;aN=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(s,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:e,type:s,key:l,ref:a!==void 0?a:null,props:o}}return Xu.Fragment=t,Xu.jsx=r,Xu.jsxs=r,Xu}var nN;function dC(){return nN||(nN=1,Rx.exports=uC()),Rx.exports}var n=dC(),Dx={exports:{}},Xt={};var iN;function fC(){if(iN)return Xt;iN=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),y=Symbol.iterator;function v(J){return J===null||typeof J!="object"?null:(J=y&&J[y]||J["@@iterator"],typeof J=="function"?J:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,_={};function w(J,M,Y){this.props=J,this.context=M,this.refs=_,this.updater=Y||b}w.prototype.isReactComponent={},w.prototype.setState=function(J,M){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,M,"setState")},w.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function k(){}k.prototype=w.prototype;function N(J,M,Y){this.props=J,this.context=M,this.refs=_,this.updater=Y||b}var E=N.prototype=new k;E.constructor=N,g(E,w.prototype),E.isPureReactComponent=!0;var C=Array.isArray;function L(){}var O={H:null,A:null,T:null,S:null},B=Object.prototype.hasOwnProperty;function F(J,M,Y){var G=Y.ref;return{$$typeof:e,type:J,key:M,ref:G!==void 0?G:null,props:Y}}function q(J,M){return F(J.type,M,J.props)}function fe(J){return typeof J=="object"&&J!==null&&J.$$typeof===e}function D(J){var M={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(Y){return M[Y]})}var V=/\/+/g;function I(J,M){return typeof J=="object"&&J!==null&&J.key!=null?D(""+J.key):M.toString(36)}function ae(J){switch(J.status){case"fulfilled":return J.value;case"rejected":throw J.reason;default:switch(typeof J.status=="string"?J.then(L,L):(J.status="pending",J.then(function(M){J.status==="pending"&&(J.status="fulfilled",J.value=M)},function(M){J.status==="pending"&&(J.status="rejected",J.reason=M)})),J.status){case"fulfilled":return J.value;case"rejected":throw J.reason}}throw J}function Q(J,M,Y,G,re){var ce=typeof J;(ce==="undefined"||ce==="boolean")&&(J=null);var P=!1;if(J===null)P=!0;else switch(ce){case"bigint":case"string":case"number":P=!0;break;case"object":switch(J.$$typeof){case e:case t:P=!0;break;case m:return P=J._init,Q(P(J._payload),M,Y,G,re)}}if(P)return re=re(J),P=G===""?"."+I(J,0):G,C(re)?(Y="",P!=null&&(Y=P.replace(V,"$&/")+"/"),Q(re,M,Y,"",function(ne){return ne})):re!=null&&(fe(re)&&(re=q(re,Y+(re.key==null||J&&J.key===re.key?"":(""+re.key).replace(V,"$&/")+"/")+P)),M.push(re)),1;P=0;var U=G===""?".":G+":";if(C(J))for(var le=0;le<J.length;le++)G=J[le],ce=U+I(G,le),P+=Q(G,M,Y,ce,re);else if(le=v(J),typeof le=="function")for(J=le.call(J),le=0;!(G=J.next()).done;)G=G.value,ce=U+I(G,le++),P+=Q(G,M,Y,ce,re);else if(ce==="object"){if(typeof J.then=="function")return Q(ae(J),M,Y,G,re);throw M=String(J),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.")}return P}function te(J,M,Y){if(J==null)return J;var G=[],re=0;return Q(J,G,"","",function(ce){return M.call(Y,ce,re++)}),G}function ve(J){if(J._status===-1){var M=J._result;M=M(),M.then(function(Y){(J._status===0||J._status===-1)&&(J._status=1,J._result=Y)},function(Y){(J._status===0||J._status===-1)&&(J._status=2,J._result=Y)}),J._status===-1&&(J._status=0,J._result=M)}if(J._status===1)return J._result.default;throw J._result}var ee=typeof reportError=="function"?reportError:function(J){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var M=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof J=="object"&&J!==null&&typeof J.message=="string"?String(J.message):String(J),error:J});if(!window.dispatchEvent(M))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",J);return}console.error(J)},Se={map:te,forEach:function(J,M,Y){te(J,function(){M.apply(this,arguments)},Y)},count:function(J){var M=0;return te(J,function(){M++}),M},toArray:function(J){return te(J,function(M){return M})||[]},only:function(J){if(!fe(J))throw Error("React.Children.only expected to receive a single React element child.");return J}};return Xt.Activity=x,Xt.Children=Se,Xt.Component=w,Xt.Fragment=r,Xt.Profiler=a,Xt.PureComponent=N,Xt.StrictMode=s,Xt.Suspense=d,Xt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Xt.__COMPILER_RUNTIME={__proto__:null,c:function(J){return O.H.useMemoCache(J)}},Xt.cache=function(J){return function(){return J.apply(null,arguments)}},Xt.cacheSignal=function(){return null},Xt.cloneElement=function(J,M,Y){if(J==null)throw Error("The argument must be a React element, but you passed "+J+".");var G=g({},J.props),re=J.key;if(M!=null)for(ce in M.key!==void 0&&(re=""+M.key),M)!B.call(M,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&M.ref===void 0||(G[ce]=M[ce]);var ce=arguments.length-2;if(ce===1)G.children=Y;else if(1<ce){for(var P=Array(ce),U=0;U<ce;U++)P[U]=arguments[U+2];G.children=P}return F(J.type,re,G)},Xt.createContext=function(J){return J={$$typeof:l,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null},J.Provider=J,J.Consumer={$$typeof:o,_context:J},J},Xt.createElement=function(J,M,Y){var G,re={},ce=null;if(M!=null)for(G in M.key!==void 0&&(ce=""+M.key),M)B.call(M,G)&&G!=="key"&&G!=="__self"&&G!=="__source"&&(re[G]=M[G]);var P=arguments.length-2;if(P===1)re.children=Y;else if(1<P){for(var U=Array(P),le=0;le<P;le++)U[le]=arguments[le+2];re.children=U}if(J&&J.defaultProps)for(G in P=J.defaultProps,P)re[G]===void 0&&(re[G]=P[G]);return F(J,ce,re)},Xt.createRef=function(){return{current:null}},Xt.forwardRef=function(J){return{$$typeof:u,render:J}},Xt.isValidElement=fe,Xt.lazy=function(J){return{$$typeof:m,_payload:{_status:-1,_result:J},_init:ve}},Xt.memo=function(J,M){return{$$typeof:h,type:J,compare:M===void 0?null:M}},Xt.startTransition=function(J){var M=O.T,Y={};O.T=Y;try{var G=J(),re=O.S;re!==null&&re(Y,G),typeof G=="object"&&G!==null&&typeof G.then=="function"&&G.then(L,ee)}catch(ce){ee(ce)}finally{M!==null&&Y.types!==null&&(M.types=Y.types),O.T=M}},Xt.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Xt.use=function(J){return O.H.use(J)},Xt.useActionState=function(J,M,Y){return O.H.useActionState(J,M,Y)},Xt.useCallback=function(J,M){return O.H.useCallback(J,M)},Xt.useContext=function(J){return O.H.useContext(J)},Xt.useDebugValue=function(){},Xt.useDeferredValue=function(J,M){return O.H.useDeferredValue(J,M)},Xt.useEffect=function(J,M){return O.H.useEffect(J,M)},Xt.useEffectEvent=function(J){return O.H.useEffectEvent(J)},Xt.useId=function(){return O.H.useId()},Xt.useImperativeHandle=function(J,M,Y){return O.H.useImperativeHandle(J,M,Y)},Xt.useInsertionEffect=function(J,M){return O.H.useInsertionEffect(J,M)},Xt.useLayoutEffect=function(J,M){return O.H.useLayoutEffect(J,M)},Xt.useMemo=function(J,M){return O.H.useMemo(J,M)},Xt.useOptimistic=function(J,M){return O.H.useOptimistic(J,M)},Xt.useReducer=function(J,M,Y){return O.H.useReducer(J,M,Y)},Xt.useRef=function(J){return O.H.useRef(J)},Xt.useState=function(J){return O.H.useState(J)},Xt.useSyncExternalStore=function(J,M,Y){return O.H.useSyncExternalStore(J,M,Y)},Xt.useTransition=function(){return O.H.useTransition()},Xt.version="19.2.3",Xt}var oN;function Yy(){return oN||(oN=1,Dx.exports=fC()),Dx.exports}var X=Yy(),Ox={exports:{}},Yu={},Fx={exports:{}},Lx={};var lN;function hC(){return lN||(lN=1,(function(e){function t(Q,te){var ve=Q.length;Q.push(te);e:for(;0<ve;){var ee=ve-1>>>1,Se=Q[ee];if(0<a(Se,te))Q[ee]=te,Q[ve]=Se,ve=ee;else break e}}function r(Q){return Q.length===0?null:Q[0]}function s(Q){if(Q.length===0)return null;var te=Q[0],ve=Q.pop();if(ve!==te){Q[0]=ve;e:for(var ee=0,Se=Q.length,J=Se>>>1;ee<J;){var M=2*(ee+1)-1,Y=Q[M],G=M+1,re=Q[G];if(0>a(Y,ve))G<Se&&0>a(re,Y)?(Q[ee]=re,Q[G]=ve,ee=G):(Q[ee]=Y,Q[M]=ve,ee=M);else if(G<Se&&0>a(re,ve))Q[ee]=re,Q[G]=ve,ee=G;else break e}}return te}function a(Q,te){var ve=Q.sortIndex-te.sortIndex;return ve!==0?ve:Q.id-te.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var d=[],h=[],m=1,x=null,y=3,v=!1,b=!1,g=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function E(Q){for(var te=r(h);te!==null;){if(te.callback===null)s(h);else if(te.startTime<=Q)s(h),te.sortIndex=te.expirationTime,t(d,te);else break;te=r(h)}}function C(Q){if(g=!1,E(Q),!b)if(r(d)!==null)b=!0,L||(L=!0,D());else{var te=r(h);te!==null&&ae(C,te.startTime-Q)}}var L=!1,O=-1,B=5,F=-1;function q(){return _?!0:!(e.unstable_now()-F<B)}function fe(){if(_=!1,L){var Q=e.unstable_now();F=Q;var te=!0;try{e:{b=!1,g&&(g=!1,k(O),O=-1),v=!0;var ve=y;try{t:{for(E(Q),x=r(d);x!==null&&!(x.expirationTime>Q&&q());){var ee=x.callback;if(typeof ee=="function"){x.callback=null,y=x.priorityLevel;var Se=ee(x.expirationTime<=Q);if(Q=e.unstable_now(),typeof Se=="function"){x.callback=Se,E(Q),te=!0;break t}x===r(d)&&s(d),E(Q)}else s(d);x=r(d)}if(x!==null)te=!0;else{var J=r(h);J!==null&&ae(C,J.startTime-Q),te=!1}}break e}finally{x=null,y=ve,v=!1}te=void 0}}finally{te?D():L=!1}}}var D;if(typeof N=="function")D=function(){N(fe)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,I=V.port2;V.port1.onmessage=fe,D=function(){I.postMessage(null)}}else D=function(){w(fe,0)};function ae(Q,te){O=w(function(){Q(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Q){Q.callback=null},e.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<Q?Math.floor(1e3/Q):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(Q){switch(y){case 1:case 2:case 3:var te=3;break;default:te=y}var ve=y;y=te;try{return Q()}finally{y=ve}},e.unstable_requestPaint=function(){_=!0},e.unstable_runWithPriority=function(Q,te){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ve=y;y=Q;try{return te()}finally{y=ve}},e.unstable_scheduleCallback=function(Q,te,ve){var ee=e.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?ee+ve:ee):ve=ee,Q){case 1:var Se=-1;break;case 2:Se=250;break;case 5:Se=1073741823;break;case 4:Se=1e4;break;default:Se=5e3}return Se=ve+Se,Q={id:m++,callback:te,priorityLevel:Q,startTime:ve,expirationTime:Se,sortIndex:-1},ve>ee?(Q.sortIndex=ve,t(h,Q),r(d)===null&&Q===r(h)&&(g?(k(O),O=-1):g=!0,ae(C,ve-ee))):(Q.sortIndex=Se,t(d,Q),b||v||(b=!0,L||(L=!0,D()))),Q},e.unstable_shouldYield=q,e.unstable_wrapCallback=function(Q){var te=y;return function(){var ve=y;y=te;try{return Q.apply(this,arguments)}finally{y=ve}}}})(Lx)),Lx}var cN;function mC(){return cN||(cN=1,Fx.exports=hC()),Fx.exports}var Ix={exports:{}},Zs={};var uN;function pC(){if(uN)return Zs;uN=1;var e=Yy();function t(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var s={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(d,h,m){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:d,containerInfo:h,implementation:m}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Zs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Zs.createPortal=function(d,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return o(d,h,null,m)},Zs.flushSync=function(d){var h=l.T,m=s.p;try{if(l.T=null,s.p=2,d)return d()}finally{l.T=h,s.p=m,s.d.f()}},Zs.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,s.d.C(d,h))},Zs.prefetchDNS=function(d){typeof d=="string"&&s.d.D(d)},Zs.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var m=h.as,x=u(m,h.crossOrigin),y=typeof h.integrity=="string"?h.integrity:void 0,v=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?s.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:v}):m==="script"&&s.d.X(d,{crossOrigin:x,integrity:y,fetchPriority:v,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Zs.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=u(h.as,h.crossOrigin);s.d.M(d,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&s.d.M(d)},Zs.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,x=u(m,h.crossOrigin);s.d.L(d,m,{crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Zs.preloadModule=function(d,h){if(typeof d=="string")if(h){var m=u(h.as,h.crossOrigin);s.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else s.d.m(d)},Zs.requestFormReset=function(d){s.d.r(d)},Zs.unstable_batchedUpdates=function(d,h){return d(h)},Zs.useFormState=function(d,h,m){return l.H.useFormState(d,h,m)},Zs.useFormStatus=function(){return l.H.useHostTransitionStatus()},Zs.version="19.2.3",Zs}var dN;function xC(){if(dN)return Ix.exports;dN=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Ix.exports=pC(),Ix.exports}var fN;function gC(){if(fN)return Yu;fN=1;var e=mC(),t=Yy(),r=xC();function s(i){var c="https://react.dev/errors/"+i;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var c=i,f=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(f=c.return),i=c.return;while(i)}return c.tag===3?f:null}function l(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function u(i){if(i.tag===31){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function d(i){if(o(i)!==i)throw Error(s(188))}function h(i){var c=i.alternate;if(!c){if(c=o(i),c===null)throw Error(s(188));return c!==i?null:i}for(var f=i,p=c;;){var j=f.return;if(j===null)break;var R=j.alternate;if(R===null){if(p=j.return,p!==null){f=p;continue}break}if(j.child===R.child){for(R=j.child;R;){if(R===f)return d(j),i;if(R===p)return d(j),c;R=R.sibling}throw Error(s(188))}if(f.return!==p.return)f=j,p=R;else{for(var Z=!1,ge=j.child;ge;){if(ge===f){Z=!0,f=j,p=R;break}if(ge===p){Z=!0,p=j,f=R;break}ge=ge.sibling}if(!Z){for(ge=R.child;ge;){if(ge===f){Z=!0,f=R,p=j;break}if(ge===p){Z=!0,p=R,f=j;break}ge=ge.sibling}if(!Z)throw Error(s(189))}}if(f.alternate!==p)throw Error(s(190))}if(f.tag!==3)throw Error(s(188));return f.stateNode.current===f?i:c}function m(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i;for(i=i.child;i!==null;){if(c=m(i),c!==null)return c;i=i.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),N=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),q=Symbol.for("react.memo_cache_sentinel"),fe=Symbol.iterator;function D(i){return i===null||typeof i!="object"?null:(i=fe&&i[fe]||i["@@iterator"],typeof i=="function"?i:null)}var V=Symbol.for("react.client.reference");function I(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===V?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case g:return"Fragment";case w:return"Profiler";case _:return"StrictMode";case C:return"Suspense";case L:return"SuspenseList";case F:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case b:return"Portal";case N:return i.displayName||"Context";case k:return(i._context.displayName||"Context")+".Consumer";case E:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case O:return c=i.displayName||null,c!==null?c:I(i.type)||"Memo";case B:c=i._payload,i=i._init;try{return I(i(c))}catch{}}return null}var ae=Array.isArray,Q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve={pending:!1,data:null,method:null,action:null},ee=[],Se=-1;function J(i){return{current:i}}function M(i){0>Se||(i.current=ee[Se],ee[Se]=null,Se--)}function Y(i,c){Se++,ee[Se]=i.current,i.current=c}var G=J(null),re=J(null),ce=J(null),P=J(null);function U(i,c){switch(Y(ce,c),Y(re,i),Y(G,null),c.nodeType){case 9:case 11:i=(i=c.documentElement)&&(i=i.namespaceURI)?E2(i):0;break;default:if(i=c.tagName,c=c.namespaceURI)c=E2(c),i=j2(c,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}M(G),Y(G,i)}function le(){M(G),M(re),M(ce)}function ne(i){i.memoizedState!==null&&Y(P,i);var c=G.current,f=j2(c,i.type);c!==f&&(Y(re,i),Y(G,f))}function ie(i){re.current===i&&(M(G),M(re)),P.current===i&&(M(P),Wu._currentValue=ve)}var H,K;function S(i){if(H===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);H=c&&c[1]||"",K=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+H+i+K}var ue=!1;function z(i,c){if(!i||ue)return"";ue=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(c){var ut=function(){throw Error()};if(Object.defineProperty(ut.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ut,[])}catch(Ze){var Xe=Ze}Reflect.construct(i,[],ut)}else{try{ut.call()}catch(Ze){Xe=Ze}i.call(ut.prototype)}}else{try{throw Error()}catch(Ze){Xe=Ze}(ut=i())&&typeof ut.catch=="function"&&ut.catch(function(){})}}catch(Ze){if(Ze&&Xe&&typeof Ze.stack=="string")return[Ze.stack,Xe.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var j=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");j&&j.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var R=p.DetermineComponentFrameRoot(),Z=R[0],ge=R[1];if(Z&&ge){var Fe=Z.split(`
`),Ve=ge.split(`
`);for(j=p=0;p<Fe.length&&!Fe[p].includes("DetermineComponentFrameRoot");)p++;for(;j<Ve.length&&!Ve[j].includes("DetermineComponentFrameRoot");)j++;if(p===Fe.length||j===Ve.length)for(p=Fe.length-1,j=Ve.length-1;1<=p&&0<=j&&Fe[p]!==Ve[j];)j--;for(;1<=p&&0<=j;p--,j--)if(Fe[p]!==Ve[j]){if(p!==1||j!==1)do if(p--,j--,0>j||Fe[p]!==Ve[j]){var it=`
`+Fe[p].replace(" at new "," at ");return i.displayName&&it.includes("<anonymous>")&&(it=it.replace("<anonymous>",i.displayName)),it}while(1<=p&&0<=j);break}}}finally{ue=!1,Error.prepareStackTrace=f}return(f=i?i.displayName||i.name:"")?S(f):""}function T(i,c){switch(i.tag){case 26:case 27:case 5:return S(i.type);case 16:return S("Lazy");case 13:return i.child!==c&&c!==null?S("Suspense Fallback"):S("Suspense");case 19:return S("SuspenseList");case 0:case 15:return z(i.type,!1);case 11:return z(i.type.render,!1);case 1:return z(i.type,!0);case 31:return S("Activity");default:return""}}function A(i){try{var c="",f=null;do c+=T(i,f),f=i,i=i.return;while(i);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var W=Object.prototype.hasOwnProperty,pe=e.unstable_scheduleCallback,_e=e.unstable_cancelCallback,oe=e.unstable_shouldYield,Te=e.unstable_requestPaint,Me=e.unstable_now,Ae=e.unstable_getCurrentPriorityLevel,Re=e.unstable_ImmediatePriority,et=e.unstable_UserBlockingPriority,He=e.unstable_NormalPriority,at=e.unstable_LowPriority,De=e.unstable_IdlePriority,mt=e.log,At=e.unstable_setDisableYieldValue,wt=null,Ct=null;function It(i){if(typeof mt=="function"&&At(i),Ct&&typeof Ct.setStrictMode=="function")try{Ct.setStrictMode(wt,i)}catch{}}var Le=Math.clz32?Math.clz32:se,tt=Math.log,ct=Math.LN2;function se(i){return i>>>=0,i===0?32:31-(tt(i)/ct|0)|0}var Ne=256,xe=262144,je=4194304;function de(i){var c=i&42;if(c!==0)return c;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Oe(i,c,f){var p=i.pendingLanes;if(p===0)return 0;var j=0,R=i.suspendedLanes,Z=i.pingedLanes;i=i.warmLanes;var ge=p&134217727;return ge!==0?(p=ge&~R,p!==0?j=de(p):(Z&=ge,Z!==0?j=de(Z):f||(f=ge&~i,f!==0&&(j=de(f))))):(ge=p&~R,ge!==0?j=de(ge):Z!==0?j=de(Z):f||(f=p&~i,f!==0&&(j=de(f)))),j===0?0:c!==0&&c!==j&&(c&R)===0&&(R=j&-j,f=c&-c,R>=f||R===32&&(f&4194048)!==0)?c:j}function Ue(i,c){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&c)===0}function rt(i,c){switch(i){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pt(){var i=je;return je<<=1,(je&62914560)===0&&(je=4194304),i}function _t(i){for(var c=[],f=0;31>f;f++)c.push(i);return c}function Vt(i,c){i.pendingLanes|=c,c!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function yr(i,c,f,p,j,R){var Z=i.pendingLanes;i.pendingLanes=f,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=f,i.entangledLanes&=f,i.errorRecoveryDisabledLanes&=f,i.shellSuspendCounter=0;var ge=i.entanglements,Fe=i.expirationTimes,Ve=i.hiddenUpdates;for(f=Z&~f;0<f;){var it=31-Le(f),ut=1<<it;ge[it]=0,Fe[it]=-1;var Xe=Ve[it];if(Xe!==null)for(Ve[it]=null,it=0;it<Xe.length;it++){var Ze=Xe[it];Ze!==null&&(Ze.lane&=-536870913)}f&=~ut}p!==0&&_r(i,p,0),R!==0&&j===0&&i.tag!==0&&(i.suspendedLanes|=R&~(Z&~c))}function _r(i,c,f){i.pendingLanes|=c,i.suspendedLanes&=~c;var p=31-Le(c);i.entangledLanes|=c,i.entanglements[p]=i.entanglements[p]|1073741824|f&261930}function zt(i,c){var f=i.entangledLanes|=c;for(i=i.entanglements;f;){var p=31-Le(f),j=1<<p;j&c|i[p]&c&&(i[p]|=c),f&=~j}}function fr(i,c){var f=c&-c;return f=(f&42)!==0?1:kr(f),(f&(i.suspendedLanes|c))!==0?0:f}function kr(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Jr(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function he(){var i=te.p;return i!==0?i:(i=window.event,i===void 0?32:Y2(i.type))}function we(i,c){var f=te.p;try{return te.p=i,c()}finally{te.p=f}}var ye=Math.random().toString(36).slice(2),be="__reactFiber$"+ye,ke="__reactProps$"+ye,Ee="__reactContainer$"+ye,We="__reactEvents$"+ye,st="__reactListeners$"+ye,$e="__reactHandles$"+ye,qe="__reactResources$"+ye,Ke="__reactMarker$"+ye;function ft(i){delete i[be],delete i[ke],delete i[We],delete i[st],delete i[$e]}function vt(i){var c=i[be];if(c)return c;for(var f=i.parentNode;f;){if(c=f[Ee]||f[be]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(i=F2(i);i!==null;){if(f=i[be])return f;i=F2(i)}return c}i=f,f=i.parentNode}return null}function kt(i){if(i=i[be]||i[Ee]){var c=i.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return i}return null}function xt(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i.stateNode;throw Error(s(33))}function me(i){var c=i[qe];return c||(c=i[qe]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Ie(i){i[Ke]=!0}var bt=new Set,yt={};function Ut(i,c){Br(i,c),Br(i+"Capture",c)}function Br(i,c){for(yt[i]=c,i=0;i<c.length;i++)bt.add(c[i])}var us=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ds={},Wa={};function No(i){return W.call(Wa,i)?!0:W.call(ds,i)?!1:us.test(i)?Wa[i]=!0:(ds[i]=!0,!1)}function Js(i,c,f){if(No(c))if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":i.removeAttribute(c);return;case"boolean":var p=c.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(c);return}}i.setAttribute(c,""+f)}}function Ga(i,c,f){if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttribute(c,""+f)}}function Gn(i,c,f,p){if(p===null)i.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(f);return}i.setAttributeNS(c,f,""+p)}}function Va(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function yb(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function e6(i,c,f){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,c);if(!i.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var j=p.get,R=p.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return j.call(this)},set:function(Z){f=""+Z,R.call(this,Z)}}),Object.defineProperty(i,c,{enumerable:p.enumerable}),{getValue:function(){return f},setValue:function(Z){f=""+Z},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function Sm(i){if(!i._valueTracker){var c=yb(i)?"checked":"value";i._valueTracker=e6(i,c,""+i[c])}}function vb(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var f=c.getValue(),p="";return i&&(p=yb(i)?i.checked?"true":"false":i.value),i=p,i!==f?(c.setValue(i),!0):!1}function yf(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var t6=/[\n"\\]/g;function Ka(i){return i.replace(t6,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function km(i,c,f,p,j,R,Z,ge){i.name="",Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?i.type=Z:i.removeAttribute("type"),c!=null?Z==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+Va(c)):i.value!==""+Va(c)&&(i.value=""+Va(c)):Z!=="submit"&&Z!=="reset"||i.removeAttribute("value"),c!=null?Em(i,Z,Va(c)):f!=null?Em(i,Z,Va(f)):p!=null&&i.removeAttribute("value"),j==null&&R!=null&&(i.defaultChecked=!!R),j!=null&&(i.checked=j&&typeof j!="function"&&typeof j!="symbol"),ge!=null&&typeof ge!="function"&&typeof ge!="symbol"&&typeof ge!="boolean"?i.name=""+Va(ge):i.removeAttribute("name")}function bb(i,c,f,p,j,R,Z,ge){if(R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(i.type=R),c!=null||f!=null){if(!(R!=="submit"&&R!=="reset"||c!=null)){Sm(i);return}f=f!=null?""+Va(f):"",c=c!=null?""+Va(c):f,ge||c===i.value||(i.value=c),i.defaultValue=c}p=p??j,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=ge?i.checked:!!p,i.defaultChecked=!!p,Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"&&(i.name=Z),Sm(i)}function Em(i,c,f){c==="number"&&yf(i.ownerDocument)===i||i.defaultValue===""+f||(i.defaultValue=""+f)}function Al(i,c,f,p){if(i=i.options,c){c={};for(var j=0;j<f.length;j++)c["$"+f[j]]=!0;for(f=0;f<i.length;f++)j=c.hasOwnProperty("$"+i[f].value),i[f].selected!==j&&(i[f].selected=j),j&&p&&(i[f].defaultSelected=!0)}else{for(f=""+Va(f),c=null,j=0;j<i.length;j++){if(i[j].value===f){i[j].selected=!0,p&&(i[j].defaultSelected=!0);return}c!==null||i[j].disabled||(c=i[j])}c!==null&&(c.selected=!0)}}function wb(i,c,f){if(c!=null&&(c=""+Va(c),c!==i.value&&(i.value=c),f==null)){i.defaultValue!==c&&(i.defaultValue=c);return}i.defaultValue=f!=null?""+Va(f):""}function _b(i,c,f,p){if(c==null){if(p!=null){if(f!=null)throw Error(s(92));if(ae(p)){if(1<p.length)throw Error(s(93));p=p[0]}f=p}f==null&&(f=""),c=f}f=Va(c),i.defaultValue=f,p=i.textContent,p===f&&p!==""&&p!==null&&(i.value=p),Sm(i)}function Cl(i,c){if(c){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=c;return}}i.textContent=c}var r6=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nb(i,c,f){var p=c.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?p?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="":p?i.setProperty(c,f):typeof f!="number"||f===0||r6.has(c)?c==="float"?i.cssFloat=f:i[c]=(""+f).trim():i[c]=f+"px"}function Sb(i,c,f){if(c!=null&&typeof c!="object")throw Error(s(62));if(i=i.style,f!=null){for(var p in f)!f.hasOwnProperty(p)||c!=null&&c.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var j in c)p=c[j],c.hasOwnProperty(j)&&f[j]!==p&&Nb(i,j,p)}else for(var R in c)c.hasOwnProperty(R)&&Nb(i,R,c[R])}function jm(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var s6=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),a6=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function vf(i){return a6.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Vn(){}var Tm=null;function Am(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Rl=null,Dl=null;function kb(i){var c=kt(i);if(c&&(i=c.stateNode)){var f=i[ke]||null;e:switch(i=c.stateNode,c.type){case"input":if(km(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),c=f.name,f.type==="radio"&&c!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Ka(""+c)+'"][type="radio"]'),c=0;c<f.length;c++){var p=f[c];if(p!==i&&p.form===i.form){var j=p[ke]||null;if(!j)throw Error(s(90));km(p,j.value,j.defaultValue,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name)}}for(c=0;c<f.length;c++)p=f[c],p.form===i.form&&vb(p)}break e;case"textarea":wb(i,f.value,f.defaultValue);break e;case"select":c=f.value,c!=null&&Al(i,!!f.multiple,c,!1)}}}var Cm=!1;function Eb(i,c,f){if(Cm)return i(c,f);Cm=!0;try{var p=i(c);return p}finally{if(Cm=!1,(Rl!==null||Dl!==null)&&(ih(),Rl&&(c=Rl,i=Dl,Dl=Rl=null,kb(c),i)))for(c=0;c<i.length;c++)kb(i[c])}}function lu(i,c){var f=i.stateNode;if(f===null)return null;var p=f[ke]||null;if(p===null)return null;f=p[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(s(231,c,typeof f));return f}var Kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rm=!1;if(Kn)try{var cu={};Object.defineProperty(cu,"passive",{get:function(){Rm=!0}}),window.addEventListener("test",cu,cu),window.removeEventListener("test",cu,cu)}catch{Rm=!1}var Fi=null,Dm=null,bf=null;function jb(){if(bf)return bf;var i,c=Dm,f=c.length,p,j="value"in Fi?Fi.value:Fi.textContent,R=j.length;for(i=0;i<f&&c[i]===j[i];i++);var Z=f-i;for(p=1;p<=Z&&c[f-p]===j[R-p];p++);return bf=j.slice(i,1<p?1-p:void 0)}function wf(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function _f(){return!0}function Tb(){return!1}function xa(i){function c(f,p,j,R,Z){this._reactName=f,this._targetInst=j,this.type=p,this.nativeEvent=R,this.target=Z,this.currentTarget=null;for(var ge in i)i.hasOwnProperty(ge)&&(f=i[ge],this[ge]=f?f(R):R[ge]);return this.isDefaultPrevented=(R.defaultPrevented!=null?R.defaultPrevented:R.returnValue===!1)?_f:Tb,this.isPropagationStopped=Tb,this}return x(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=_f)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=_f)},persist:function(){},isPersistent:_f}),c}var So={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nf=xa(So),uu=x({},So,{view:0,detail:0}),n6=xa(uu),Om,Fm,du,Sf=x({},uu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Im,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==du&&(du&&i.type==="mousemove"?(Om=i.screenX-du.screenX,Fm=i.screenY-du.screenY):Fm=Om=0,du=i),Om)},movementY:function(i){return"movementY"in i?i.movementY:Fm}}),Ab=xa(Sf),i6=x({},Sf,{dataTransfer:0}),o6=xa(i6),l6=x({},uu,{relatedTarget:0}),Lm=xa(l6),c6=x({},So,{animationName:0,elapsedTime:0,pseudoElement:0}),u6=xa(c6),d6=x({},So,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),f6=xa(d6),h6=x({},So,{data:0}),Cb=xa(h6),m6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},p6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},x6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function g6(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=x6[i])?!!c[i]:!1}function Im(){return g6}var y6=x({},uu,{key:function(i){if(i.key){var c=m6[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=wf(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?p6[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Im,charCode:function(i){return i.type==="keypress"?wf(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?wf(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),v6=xa(y6),b6=x({},Sf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rb=xa(b6),w6=x({},uu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Im}),_6=xa(w6),N6=x({},So,{propertyName:0,elapsedTime:0,pseudoElement:0}),S6=xa(N6),k6=x({},Sf,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),E6=xa(k6),j6=x({},So,{newState:0,oldState:0}),T6=xa(j6),A6=[9,13,27,32],Mm=Kn&&"CompositionEvent"in window,fu=null;Kn&&"documentMode"in document&&(fu=document.documentMode);var C6=Kn&&"TextEvent"in window&&!fu,Db=Kn&&(!Mm||fu&&8<fu&&11>=fu),Ob=" ",Fb=!1;function Lb(i,c){switch(i){case"keyup":return A6.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ib(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ol=!1;function R6(i,c){switch(i){case"compositionend":return Ib(c);case"keypress":return c.which!==32?null:(Fb=!0,Ob);case"textInput":return i=c.data,i===Ob&&Fb?null:i;default:return null}}function D6(i,c){if(Ol)return i==="compositionend"||!Mm&&Lb(i,c)?(i=jb(),bf=Dm=Fi=null,Ol=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Db&&c.locale!=="ko"?null:c.data;default:return null}}var O6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mb(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!O6[i.type]:c==="textarea"}function Bb(i,c,f,p){Rl?Dl?Dl.push(p):Dl=[p]:Rl=p,c=hh(c,"onChange"),0<c.length&&(f=new Nf("onChange","change",null,f,p),i.push({event:f,listeners:c}))}var hu=null,mu=null;function F6(i){b2(i,0)}function kf(i){var c=xt(i);if(vb(c))return i}function Pb(i,c){if(i==="change")return c}var Ub=!1;if(Kn){var Bm;if(Kn){var Pm="oninput"in document;if(!Pm){var zb=document.createElement("div");zb.setAttribute("oninput","return;"),Pm=typeof zb.oninput=="function"}Bm=Pm}else Bm=!1;Ub=Bm&&(!document.documentMode||9<document.documentMode)}function $b(){hu&&(hu.detachEvent("onpropertychange",qb),mu=hu=null)}function qb(i){if(i.propertyName==="value"&&kf(mu)){var c=[];Bb(c,mu,i,Am(i)),Eb(F6,c)}}function L6(i,c,f){i==="focusin"?($b(),hu=c,mu=f,hu.attachEvent("onpropertychange",qb)):i==="focusout"&&$b()}function I6(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return kf(mu)}function M6(i,c){if(i==="click")return kf(c)}function B6(i,c){if(i==="input"||i==="change")return kf(c)}function P6(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var Ta=typeof Object.is=="function"?Object.is:P6;function pu(i,c){if(Ta(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var f=Object.keys(i),p=Object.keys(c);if(f.length!==p.length)return!1;for(p=0;p<f.length;p++){var j=f[p];if(!W.call(c,j)||!Ta(i[j],c[j]))return!1}return!0}function Hb(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Wb(i,c){var f=Hb(i);i=0;for(var p;f;){if(f.nodeType===3){if(p=i+f.textContent.length,i<=c&&p>=c)return{node:f,offset:c-i};i=p}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=Hb(f)}}function Gb(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?Gb(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function Vb(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var c=yf(i.document);c instanceof i.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)i=c.contentWindow;else break;c=yf(i.document)}return c}function Um(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}var U6=Kn&&"documentMode"in document&&11>=document.documentMode,Fl=null,zm=null,xu=null,$m=!1;function Kb(i,c,f){var p=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;$m||Fl==null||Fl!==yf(p)||(p=Fl,"selectionStart"in p&&Um(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),xu&&pu(xu,p)||(xu=p,p=hh(zm,"onSelect"),0<p.length&&(c=new Nf("onSelect","select",null,c,f),i.push({event:c,listeners:p}),c.target=Fl)))}function ko(i,c){var f={};return f[i.toLowerCase()]=c.toLowerCase(),f["Webkit"+i]="webkit"+c,f["Moz"+i]="moz"+c,f}var Ll={animationend:ko("Animation","AnimationEnd"),animationiteration:ko("Animation","AnimationIteration"),animationstart:ko("Animation","AnimationStart"),transitionrun:ko("Transition","TransitionRun"),transitionstart:ko("Transition","TransitionStart"),transitioncancel:ko("Transition","TransitionCancel"),transitionend:ko("Transition","TransitionEnd")},qm={},Xb={};Kn&&(Xb=document.createElement("div").style,"AnimationEvent"in window||(delete Ll.animationend.animation,delete Ll.animationiteration.animation,delete Ll.animationstart.animation),"TransitionEvent"in window||delete Ll.transitionend.transition);function Eo(i){if(qm[i])return qm[i];if(!Ll[i])return i;var c=Ll[i],f;for(f in c)if(c.hasOwnProperty(f)&&f in Xb)return qm[i]=c[f];return i}var Yb=Eo("animationend"),Jb=Eo("animationiteration"),Zb=Eo("animationstart"),z6=Eo("transitionrun"),$6=Eo("transitionstart"),q6=Eo("transitioncancel"),Qb=Eo("transitionend"),ew=new Map,Hm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Hm.push("scrollEnd");function xn(i,c){ew.set(i,c),Ut(c,[i])}var Ef=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Xa=[],Il=0,Wm=0;function jf(){for(var i=Il,c=Wm=Il=0;c<i;){var f=Xa[c];Xa[c++]=null;var p=Xa[c];Xa[c++]=null;var j=Xa[c];Xa[c++]=null;var R=Xa[c];if(Xa[c++]=null,p!==null&&j!==null){var Z=p.pending;Z===null?j.next=j:(j.next=Z.next,Z.next=j),p.pending=j}R!==0&&tw(f,j,R)}}function Tf(i,c,f,p){Xa[Il++]=i,Xa[Il++]=c,Xa[Il++]=f,Xa[Il++]=p,Wm|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function Gm(i,c,f,p){return Tf(i,c,f,p),Af(i)}function jo(i,c){return Tf(i,null,null,c),Af(i)}function tw(i,c,f){i.lanes|=f;var p=i.alternate;p!==null&&(p.lanes|=f);for(var j=!1,R=i.return;R!==null;)R.childLanes|=f,p=R.alternate,p!==null&&(p.childLanes|=f),R.tag===22&&(i=R.stateNode,i===null||i._visibility&1||(j=!0)),i=R,R=R.return;return i.tag===3?(R=i.stateNode,j&&c!==null&&(j=31-Le(f),i=R.hiddenUpdates,p=i[j],p===null?i[j]=[c]:p.push(c),c.lane=f|536870912),R):null}function Af(i){if(50<Bu)throw Bu=0,tx=null,Error(s(185));for(var c=i.return;c!==null;)i=c,c=i.return;return i.tag===3?i.stateNode:null}var Ml={};function H6(i,c,f,p){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Aa(i,c,f,p){return new H6(i,c,f,p)}function Vm(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Xn(i,c){var f=i.alternate;return f===null?(f=Aa(i.tag,c,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=c,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&65011712,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,c=i.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f.refCleanup=i.refCleanup,f}function rw(i,c){i.flags&=65011714;var f=i.alternate;return f===null?(i.childLanes=0,i.lanes=c,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=f.childLanes,i.lanes=f.lanes,i.child=f.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=f.memoizedProps,i.memoizedState=f.memoizedState,i.updateQueue=f.updateQueue,i.type=f.type,c=f.dependencies,i.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),i}function Cf(i,c,f,p,j,R){var Z=0;if(p=i,typeof i=="function")Vm(i)&&(Z=1);else if(typeof i=="string")Z=XA(i,f,G.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case F:return i=Aa(31,f,c,j),i.elementType=F,i.lanes=R,i;case g:return To(f.children,j,R,c);case _:Z=8,j|=24;break;case w:return i=Aa(12,f,c,j|2),i.elementType=w,i.lanes=R,i;case C:return i=Aa(13,f,c,j),i.elementType=C,i.lanes=R,i;case L:return i=Aa(19,f,c,j),i.elementType=L,i.lanes=R,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case N:Z=10;break e;case k:Z=9;break e;case E:Z=11;break e;case O:Z=14;break e;case B:Z=16,p=null;break e}Z=29,f=Error(s(130,i===null?"null":typeof i,"")),p=null}return c=Aa(Z,f,c,j),c.elementType=i,c.type=p,c.lanes=R,c}function To(i,c,f,p){return i=Aa(7,i,p,c),i.lanes=f,i}function Km(i,c,f){return i=Aa(6,i,null,c),i.lanes=f,i}function sw(i){var c=Aa(18,null,null,0);return c.stateNode=i,c}function Xm(i,c,f){return c=Aa(4,i.children!==null?i.children:[],i.key,c),c.lanes=f,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}var aw=new WeakMap;function Ya(i,c){if(typeof i=="object"&&i!==null){var f=aw.get(i);return f!==void 0?f:(c={value:i,source:c,stack:A(c)},aw.set(i,c),c)}return{value:i,source:c,stack:A(c)}}var Bl=[],Pl=0,Rf=null,gu=0,Ja=[],Za=0,Li=null,An=1,Cn="";function Yn(i,c){Bl[Pl++]=gu,Bl[Pl++]=Rf,Rf=i,gu=c}function nw(i,c,f){Ja[Za++]=An,Ja[Za++]=Cn,Ja[Za++]=Li,Li=i;var p=An;i=Cn;var j=32-Le(p)-1;p&=~(1<<j),f+=1;var R=32-Le(c)+j;if(30<R){var Z=j-j%5;R=(p&(1<<Z)-1).toString(32),p>>=Z,j-=Z,An=1<<32-Le(c)+j|f<<j|p,Cn=R+i}else An=1<<R|f<<j|p,Cn=i}function Ym(i){i.return!==null&&(Yn(i,1),nw(i,1,0))}function Jm(i){for(;i===Rf;)Rf=Bl[--Pl],Bl[Pl]=null,gu=Bl[--Pl],Bl[Pl]=null;for(;i===Li;)Li=Ja[--Za],Ja[Za]=null,Cn=Ja[--Za],Ja[Za]=null,An=Ja[--Za],Ja[Za]=null}function iw(i,c){Ja[Za++]=An,Ja[Za++]=Cn,Ja[Za++]=Li,An=c.id,Cn=c.overflow,Li=i}var Bs=null,$r=null,hr=!1,Ii=null,Qa=!1,Zm=Error(s(519));function Mi(i){var c=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw yu(Ya(c,i)),Zm}function ow(i){var c=i.stateNode,f=i.type,p=i.memoizedProps;switch(c[be]=i,c[ke]=p,f){case"dialog":lr("cancel",c),lr("close",c);break;case"iframe":case"object":case"embed":lr("load",c);break;case"video":case"audio":for(f=0;f<Uu.length;f++)lr(Uu[f],c);break;case"source":lr("error",c);break;case"img":case"image":case"link":lr("error",c),lr("load",c);break;case"details":lr("toggle",c);break;case"input":lr("invalid",c),bb(c,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":lr("invalid",c);break;case"textarea":lr("invalid",c),_b(c,p.value,p.defaultValue,p.children)}f=p.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||c.textContent===""+f||p.suppressHydrationWarning===!0||S2(c.textContent,f)?(p.popover!=null&&(lr("beforetoggle",c),lr("toggle",c)),p.onScroll!=null&&lr("scroll",c),p.onScrollEnd!=null&&lr("scrollend",c),p.onClick!=null&&(c.onclick=Vn),c=!0):c=!1,c||Mi(i,!0)}function lw(i){for(Bs=i.return;Bs;)switch(Bs.tag){case 5:case 31:case 13:Qa=!1;return;case 27:case 3:Qa=!0;return;default:Bs=Bs.return}}function Ul(i){if(i!==Bs)return!1;if(!hr)return lw(i),hr=!0,!1;var c=i.tag,f;if((f=c!==3&&c!==27)&&((f=c===5)&&(f=i.type,f=!(f!=="form"&&f!=="button")||xx(i.type,i.memoizedProps)),f=!f),f&&$r&&Mi(i),lw(i),c===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));$r=O2(i)}else if(c===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));$r=O2(i)}else c===27?(c=$r,Ji(i.type)?(i=wx,wx=null,$r=i):$r=c):$r=Bs?tn(i.stateNode.nextSibling):null;return!0}function Ao(){$r=Bs=null,hr=!1}function Qm(){var i=Ii;return i!==null&&(ba===null?ba=i:ba.push.apply(ba,i),Ii=null),i}function yu(i){Ii===null?Ii=[i]:Ii.push(i)}var ep=J(null),Co=null,Jn=null;function Bi(i,c,f){Y(ep,c._currentValue),c._currentValue=f}function Zn(i){i._currentValue=ep.current,M(ep)}function tp(i,c,f){for(;i!==null;){var p=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,p!==null&&(p.childLanes|=c)):p!==null&&(p.childLanes&c)!==c&&(p.childLanes|=c),i===f)break;i=i.return}}function rp(i,c,f,p){var j=i.child;for(j!==null&&(j.return=i);j!==null;){var R=j.dependencies;if(R!==null){var Z=j.child;R=R.firstContext;e:for(;R!==null;){var ge=R;R=j;for(var Fe=0;Fe<c.length;Fe++)if(ge.context===c[Fe]){R.lanes|=f,ge=R.alternate,ge!==null&&(ge.lanes|=f),tp(R.return,f,i),p||(Z=null);break e}R=ge.next}}else if(j.tag===18){if(Z=j.return,Z===null)throw Error(s(341));Z.lanes|=f,R=Z.alternate,R!==null&&(R.lanes|=f),tp(Z,f,i),Z=null}else Z=j.child;if(Z!==null)Z.return=j;else for(Z=j;Z!==null;){if(Z===i){Z=null;break}if(j=Z.sibling,j!==null){j.return=Z.return,Z=j;break}Z=Z.return}j=Z}}function zl(i,c,f,p){i=null;for(var j=c,R=!1;j!==null;){if(!R){if((j.flags&524288)!==0)R=!0;else if((j.flags&262144)!==0)break}if(j.tag===10){var Z=j.alternate;if(Z===null)throw Error(s(387));if(Z=Z.memoizedProps,Z!==null){var ge=j.type;Ta(j.pendingProps.value,Z.value)||(i!==null?i.push(ge):i=[ge])}}else if(j===P.current){if(Z=j.alternate,Z===null)throw Error(s(387));Z.memoizedState.memoizedState!==j.memoizedState.memoizedState&&(i!==null?i.push(Wu):i=[Wu])}j=j.return}i!==null&&rp(c,i,f,p),c.flags|=262144}function Df(i){for(i=i.firstContext;i!==null;){if(!Ta(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Ro(i){Co=i,Jn=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Ps(i){return cw(Co,i)}function Of(i,c){return Co===null&&Ro(i),cw(i,c)}function cw(i,c){var f=c._currentValue;if(c={context:c,memoizedValue:f,next:null},Jn===null){if(i===null)throw Error(s(308));Jn=c,i.dependencies={lanes:0,firstContext:c},i.flags|=524288}else Jn=Jn.next=c;return f}var W6=typeof AbortController<"u"?AbortController:function(){var i=[],c=this.signal={aborted:!1,addEventListener:function(f,p){i.push(p)}};this.abort=function(){c.aborted=!0,i.forEach(function(f){return f()})}},G6=e.unstable_scheduleCallback,V6=e.unstable_NormalPriority,vs={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sp(){return{controller:new W6,data:new Map,refCount:0}}function vu(i){i.refCount--,i.refCount===0&&G6(V6,function(){i.controller.abort()})}var bu=null,ap=0,$l=0,ql=null;function K6(i,c){if(bu===null){var f=bu=[];ap=0,$l=ox(),ql={status:"pending",value:void 0,then:function(p){f.push(p)}}}return ap++,c.then(uw,uw),c}function uw(){if(--ap===0&&bu!==null){ql!==null&&(ql.status="fulfilled");var i=bu;bu=null,$l=0,ql=null;for(var c=0;c<i.length;c++)(0,i[c])()}}function X6(i,c){var f=[],p={status:"pending",value:null,reason:null,then:function(j){f.push(j)}};return i.then(function(){p.status="fulfilled",p.value=c;for(var j=0;j<f.length;j++)(0,f[j])(c)},function(j){for(p.status="rejected",p.reason=j,j=0;j<f.length;j++)(0,f[j])(void 0)}),p}var dw=Q.S;Q.S=function(i,c){K_=Me(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&K6(i,c),dw!==null&&dw(i,c)};var Do=J(null);function np(){var i=Do.current;return i!==null?i:Pr.pooledCache}function Ff(i,c){c===null?Y(Do,Do.current):Y(Do,c.pool)}function fw(){var i=np();return i===null?null:{parent:vs._currentValue,pool:i}}var Hl=Error(s(460)),ip=Error(s(474)),Lf=Error(s(542)),If={then:function(){}};function hw(i){return i=i.status,i==="fulfilled"||i==="rejected"}function mw(i,c,f){switch(f=i[f],f===void 0?i.push(c):f!==c&&(c.then(Vn,Vn),c=f),c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,xw(i),i;default:if(typeof c.status=="string")c.then(Vn,Vn);else{if(i=Pr,i!==null&&100<i.shellSuspendCounter)throw Error(s(482));i=c,i.status="pending",i.then(function(p){if(c.status==="pending"){var j=c;j.status="fulfilled",j.value=p}},function(p){if(c.status==="pending"){var j=c;j.status="rejected",j.reason=p}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,xw(i),i}throw Fo=c,Hl}}function Oo(i){try{var c=i._init;return c(i._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Fo=f,Hl):f}}var Fo=null;function pw(){if(Fo===null)throw Error(s(459));var i=Fo;return Fo=null,i}function xw(i){if(i===Hl||i===Lf)throw Error(s(483))}var Wl=null,wu=0;function Mf(i){var c=wu;return wu+=1,Wl===null&&(Wl=[]),mw(Wl,i,c)}function _u(i,c){c=c.props.ref,i.ref=c!==void 0?c:null}function Bf(i,c){throw c.$$typeof===y?Error(s(525)):(i=Object.prototype.toString.call(c),Error(s(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i)))}function gw(i){function c(ze,Be){if(i){var Ge=ze.deletions;Ge===null?(ze.deletions=[Be],ze.flags|=16):Ge.push(Be)}}function f(ze,Be){if(!i)return null;for(;Be!==null;)c(ze,Be),Be=Be.sibling;return null}function p(ze){for(var Be=new Map;ze!==null;)ze.key!==null?Be.set(ze.key,ze):Be.set(ze.index,ze),ze=ze.sibling;return Be}function j(ze,Be){return ze=Xn(ze,Be),ze.index=0,ze.sibling=null,ze}function R(ze,Be,Ge){return ze.index=Ge,i?(Ge=ze.alternate,Ge!==null?(Ge=Ge.index,Ge<Be?(ze.flags|=67108866,Be):Ge):(ze.flags|=67108866,Be)):(ze.flags|=1048576,Be)}function Z(ze){return i&&ze.alternate===null&&(ze.flags|=67108866),ze}function ge(ze,Be,Ge,lt){return Be===null||Be.tag!==6?(Be=Km(Ge,ze.mode,lt),Be.return=ze,Be):(Be=j(Be,Ge),Be.return=ze,Be)}function Fe(ze,Be,Ge,lt){var Mt=Ge.type;return Mt===g?it(ze,Be,Ge.props.children,lt,Ge.key):Be!==null&&(Be.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===B&&Oo(Mt)===Be.type)?(Be=j(Be,Ge.props),_u(Be,Ge),Be.return=ze,Be):(Be=Cf(Ge.type,Ge.key,Ge.props,null,ze.mode,lt),_u(Be,Ge),Be.return=ze,Be)}function Ve(ze,Be,Ge,lt){return Be===null||Be.tag!==4||Be.stateNode.containerInfo!==Ge.containerInfo||Be.stateNode.implementation!==Ge.implementation?(Be=Xm(Ge,ze.mode,lt),Be.return=ze,Be):(Be=j(Be,Ge.children||[]),Be.return=ze,Be)}function it(ze,Be,Ge,lt,Mt){return Be===null||Be.tag!==7?(Be=To(Ge,ze.mode,lt,Mt),Be.return=ze,Be):(Be=j(Be,Ge),Be.return=ze,Be)}function ut(ze,Be,Ge){if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return Be=Km(""+Be,ze.mode,Ge),Be.return=ze,Be;if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case v:return Ge=Cf(Be.type,Be.key,Be.props,null,ze.mode,Ge),_u(Ge,Be),Ge.return=ze,Ge;case b:return Be=Xm(Be,ze.mode,Ge),Be.return=ze,Be;case B:return Be=Oo(Be),ut(ze,Be,Ge)}if(ae(Be)||D(Be))return Be=To(Be,ze.mode,Ge,null),Be.return=ze,Be;if(typeof Be.then=="function")return ut(ze,Mf(Be),Ge);if(Be.$$typeof===N)return ut(ze,Of(ze,Be),Ge);Bf(ze,Be)}return null}function Xe(ze,Be,Ge,lt){var Mt=Be!==null?Be.key:null;if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint")return Mt!==null?null:ge(ze,Be,""+Ge,lt);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case v:return Ge.key===Mt?Fe(ze,Be,Ge,lt):null;case b:return Ge.key===Mt?Ve(ze,Be,Ge,lt):null;case B:return Ge=Oo(Ge),Xe(ze,Be,Ge,lt)}if(ae(Ge)||D(Ge))return Mt!==null?null:it(ze,Be,Ge,lt,null);if(typeof Ge.then=="function")return Xe(ze,Be,Mf(Ge),lt);if(Ge.$$typeof===N)return Xe(ze,Be,Of(ze,Ge),lt);Bf(ze,Ge)}return null}function Ze(ze,Be,Ge,lt,Mt){if(typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint")return ze=ze.get(Ge)||null,ge(Be,ze,""+lt,Mt);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case v:return ze=ze.get(lt.key===null?Ge:lt.key)||null,Fe(Be,ze,lt,Mt);case b:return ze=ze.get(lt.key===null?Ge:lt.key)||null,Ve(Be,ze,lt,Mt);case B:return lt=Oo(lt),Ze(ze,Be,Ge,lt,Mt)}if(ae(lt)||D(lt))return ze=ze.get(Ge)||null,it(Be,ze,lt,Mt,null);if(typeof lt.then=="function")return Ze(ze,Be,Ge,Mf(lt),Mt);if(lt.$$typeof===N)return Ze(ze,Be,Ge,Of(Be,lt),Mt);Bf(Be,lt)}return null}function Rt(ze,Be,Ge,lt){for(var Mt=null,vr=null,Ft=Be,Qt=Be=0,ur=null;Ft!==null&&Qt<Ge.length;Qt++){Ft.index>Qt?(ur=Ft,Ft=null):ur=Ft.sibling;var br=Xe(ze,Ft,Ge[Qt],lt);if(br===null){Ft===null&&(Ft=ur);break}i&&Ft&&br.alternate===null&&c(ze,Ft),Be=R(br,Be,Qt),vr===null?Mt=br:vr.sibling=br,vr=br,Ft=ur}if(Qt===Ge.length)return f(ze,Ft),hr&&Yn(ze,Qt),Mt;if(Ft===null){for(;Qt<Ge.length;Qt++)Ft=ut(ze,Ge[Qt],lt),Ft!==null&&(Be=R(Ft,Be,Qt),vr===null?Mt=Ft:vr.sibling=Ft,vr=Ft);return hr&&Yn(ze,Qt),Mt}for(Ft=p(Ft);Qt<Ge.length;Qt++)ur=Ze(Ft,ze,Qt,Ge[Qt],lt),ur!==null&&(i&&ur.alternate!==null&&Ft.delete(ur.key===null?Qt:ur.key),Be=R(ur,Be,Qt),vr===null?Mt=ur:vr.sibling=ur,vr=ur);return i&&Ft.forEach(function(ro){return c(ze,ro)}),hr&&Yn(ze,Qt),Mt}function $t(ze,Be,Ge,lt){if(Ge==null)throw Error(s(151));for(var Mt=null,vr=null,Ft=Be,Qt=Be=0,ur=null,br=Ge.next();Ft!==null&&!br.done;Qt++,br=Ge.next()){Ft.index>Qt?(ur=Ft,Ft=null):ur=Ft.sibling;var ro=Xe(ze,Ft,br.value,lt);if(ro===null){Ft===null&&(Ft=ur);break}i&&Ft&&ro.alternate===null&&c(ze,Ft),Be=R(ro,Be,Qt),vr===null?Mt=ro:vr.sibling=ro,vr=ro,Ft=ur}if(br.done)return f(ze,Ft),hr&&Yn(ze,Qt),Mt;if(Ft===null){for(;!br.done;Qt++,br=Ge.next())br=ut(ze,br.value,lt),br!==null&&(Be=R(br,Be,Qt),vr===null?Mt=br:vr.sibling=br,vr=br);return hr&&Yn(ze,Qt),Mt}for(Ft=p(Ft);!br.done;Qt++,br=Ge.next())br=Ze(Ft,ze,Qt,br.value,lt),br!==null&&(i&&br.alternate!==null&&Ft.delete(br.key===null?Qt:br.key),Be=R(br,Be,Qt),vr===null?Mt=br:vr.sibling=br,vr=br);return i&&Ft.forEach(function(iC){return c(ze,iC)}),hr&&Yn(ze,Qt),Mt}function Fr(ze,Be,Ge,lt){if(typeof Ge=="object"&&Ge!==null&&Ge.type===g&&Ge.key===null&&(Ge=Ge.props.children),typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case v:e:{for(var Mt=Ge.key;Be!==null;){if(Be.key===Mt){if(Mt=Ge.type,Mt===g){if(Be.tag===7){f(ze,Be.sibling),lt=j(Be,Ge.props.children),lt.return=ze,ze=lt;break e}}else if(Be.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===B&&Oo(Mt)===Be.type){f(ze,Be.sibling),lt=j(Be,Ge.props),_u(lt,Ge),lt.return=ze,ze=lt;break e}f(ze,Be);break}else c(ze,Be);Be=Be.sibling}Ge.type===g?(lt=To(Ge.props.children,ze.mode,lt,Ge.key),lt.return=ze,ze=lt):(lt=Cf(Ge.type,Ge.key,Ge.props,null,ze.mode,lt),_u(lt,Ge),lt.return=ze,ze=lt)}return Z(ze);case b:e:{for(Mt=Ge.key;Be!==null;){if(Be.key===Mt)if(Be.tag===4&&Be.stateNode.containerInfo===Ge.containerInfo&&Be.stateNode.implementation===Ge.implementation){f(ze,Be.sibling),lt=j(Be,Ge.children||[]),lt.return=ze,ze=lt;break e}else{f(ze,Be);break}else c(ze,Be);Be=Be.sibling}lt=Xm(Ge,ze.mode,lt),lt.return=ze,ze=lt}return Z(ze);case B:return Ge=Oo(Ge),Fr(ze,Be,Ge,lt)}if(ae(Ge))return Rt(ze,Be,Ge,lt);if(D(Ge)){if(Mt=D(Ge),typeof Mt!="function")throw Error(s(150));return Ge=Mt.call(Ge),$t(ze,Be,Ge,lt)}if(typeof Ge.then=="function")return Fr(ze,Be,Mf(Ge),lt);if(Ge.$$typeof===N)return Fr(ze,Be,Of(ze,Ge),lt);Bf(ze,Ge)}return typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint"?(Ge=""+Ge,Be!==null&&Be.tag===6?(f(ze,Be.sibling),lt=j(Be,Ge),lt.return=ze,ze=lt):(f(ze,Be),lt=Km(Ge,ze.mode,lt),lt.return=ze,ze=lt),Z(ze)):f(ze,Be)}return function(ze,Be,Ge,lt){try{wu=0;var Mt=Fr(ze,Be,Ge,lt);return Wl=null,Mt}catch(Ft){if(Ft===Hl||Ft===Lf)throw Ft;var vr=Aa(29,Ft,null,ze.mode);return vr.lanes=lt,vr.return=ze,vr}}}var Lo=gw(!0),yw=gw(!1),Pi=!1;function op(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lp(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Ui(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function zi(i,c,f){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Nr&2)!==0){var j=p.pending;return j===null?c.next=c:(c.next=j.next,j.next=c),p.pending=c,c=Af(i),tw(i,null,f),c}return Tf(i,p,c,f),Af(i)}function Nu(i,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194048)!==0)){var p=c.lanes;p&=i.pendingLanes,f|=p,c.lanes=f,zt(i,f)}}function cp(i,c){var f=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,f===p)){var j=null,R=null;if(f=f.firstBaseUpdate,f!==null){do{var Z={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};R===null?j=R=Z:R=R.next=Z,f=f.next}while(f!==null);R===null?j=R=c:R=R.next=c}else j=R=c;f={baseState:p.baseState,firstBaseUpdate:j,lastBaseUpdate:R,shared:p.shared,callbacks:p.callbacks},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=c:i.next=c,f.lastBaseUpdate=c}var up=!1;function Su(){if(up){var i=ql;if(i!==null)throw i}}function ku(i,c,f,p){up=!1;var j=i.updateQueue;Pi=!1;var R=j.firstBaseUpdate,Z=j.lastBaseUpdate,ge=j.shared.pending;if(ge!==null){j.shared.pending=null;var Fe=ge,Ve=Fe.next;Fe.next=null,Z===null?R=Ve:Z.next=Ve,Z=Fe;var it=i.alternate;it!==null&&(it=it.updateQueue,ge=it.lastBaseUpdate,ge!==Z&&(ge===null?it.firstBaseUpdate=Ve:ge.next=Ve,it.lastBaseUpdate=Fe))}if(R!==null){var ut=j.baseState;Z=0,it=Ve=Fe=null,ge=R;do{var Xe=ge.lane&-536870913,Ze=Xe!==ge.lane;if(Ze?(cr&Xe)===Xe:(p&Xe)===Xe){Xe!==0&&Xe===$l&&(up=!0),it!==null&&(it=it.next={lane:0,tag:ge.tag,payload:ge.payload,callback:null,next:null});e:{var Rt=i,$t=ge;Xe=c;var Fr=f;switch($t.tag){case 1:if(Rt=$t.payload,typeof Rt=="function"){ut=Rt.call(Fr,ut,Xe);break e}ut=Rt;break e;case 3:Rt.flags=Rt.flags&-65537|128;case 0:if(Rt=$t.payload,Xe=typeof Rt=="function"?Rt.call(Fr,ut,Xe):Rt,Xe==null)break e;ut=x({},ut,Xe);break e;case 2:Pi=!0}}Xe=ge.callback,Xe!==null&&(i.flags|=64,Ze&&(i.flags|=8192),Ze=j.callbacks,Ze===null?j.callbacks=[Xe]:Ze.push(Xe))}else Ze={lane:Xe,tag:ge.tag,payload:ge.payload,callback:ge.callback,next:null},it===null?(Ve=it=Ze,Fe=ut):it=it.next=Ze,Z|=Xe;if(ge=ge.next,ge===null){if(ge=j.shared.pending,ge===null)break;Ze=ge,ge=Ze.next,Ze.next=null,j.lastBaseUpdate=Ze,j.shared.pending=null}}while(!0);it===null&&(Fe=ut),j.baseState=Fe,j.firstBaseUpdate=Ve,j.lastBaseUpdate=it,R===null&&(j.shared.lanes=0),Gi|=Z,i.lanes=Z,i.memoizedState=ut}}function vw(i,c){if(typeof i!="function")throw Error(s(191,i));i.call(c)}function bw(i,c){var f=i.callbacks;if(f!==null)for(i.callbacks=null,i=0;i<f.length;i++)vw(f[i],c)}var Gl=J(null),Pf=J(0);function ww(i,c){i=oi,Y(Pf,i),Y(Gl,c),oi=i|c.baseLanes}function dp(){Y(Pf,oi),Y(Gl,Gl.current)}function fp(){oi=Pf.current,M(Gl),M(Pf)}var Ca=J(null),en=null;function $i(i){var c=i.alternate;Y(fs,fs.current&1),Y(Ca,i),en===null&&(c===null||Gl.current!==null||c.memoizedState!==null)&&(en=i)}function hp(i){Y(fs,fs.current),Y(Ca,i),en===null&&(en=i)}function _w(i){i.tag===22?(Y(fs,fs.current),Y(Ca,i),en===null&&(en=i)):qi()}function qi(){Y(fs,fs.current),Y(Ca,Ca.current)}function Ra(i){M(Ca),en===i&&(en=null),M(fs)}var fs=J(0);function Uf(i){for(var c=i;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||vx(f)||bx(f)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Qn=0,Yt=null,Dr=null,bs=null,zf=!1,Vl=!1,Io=!1,$f=0,Eu=0,Kl=null,Y6=0;function rs(){throw Error(s(321))}function mp(i,c){if(c===null)return!1;for(var f=0;f<c.length&&f<i.length;f++)if(!Ta(i[f],c[f]))return!1;return!0}function pp(i,c,f,p,j,R){return Qn=R,Yt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Q.H=i===null||i.memoizedState===null?n_:Cp,Io=!1,R=f(p,j),Io=!1,Vl&&(R=Sw(c,f,p,j)),Nw(i),R}function Nw(i){Q.H=Au;var c=Dr!==null&&Dr.next!==null;if(Qn=0,bs=Dr=Yt=null,zf=!1,Eu=0,Kl=null,c)throw Error(s(300));i===null||ws||(i=i.dependencies,i!==null&&Df(i)&&(ws=!0))}function Sw(i,c,f,p){Yt=i;var j=0;do{if(Vl&&(Kl=null),Eu=0,Vl=!1,25<=j)throw Error(s(301));if(j+=1,bs=Dr=null,i.updateQueue!=null){var R=i.updateQueue;R.lastEffect=null,R.events=null,R.stores=null,R.memoCache!=null&&(R.memoCache.index=0)}Q.H=i_,R=c(f,p)}while(Vl);return R}function J6(){var i=Q.H,c=i.useState()[0];return c=typeof c.then=="function"?ju(c):c,i=i.useState()[0],(Dr!==null?Dr.memoizedState:null)!==i&&(Yt.flags|=1024),c}function xp(){var i=$f!==0;return $f=0,i}function gp(i,c,f){c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~f}function yp(i){if(zf){for(i=i.memoizedState;i!==null;){var c=i.queue;c!==null&&(c.pending=null),i=i.next}zf=!1}Qn=0,bs=Dr=Yt=null,Vl=!1,Eu=$f=0,Kl=null}function ua(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bs===null?Yt.memoizedState=bs=i:bs=bs.next=i,bs}function hs(){if(Dr===null){var i=Yt.alternate;i=i!==null?i.memoizedState:null}else i=Dr.next;var c=bs===null?Yt.memoizedState:bs.next;if(c!==null)bs=c,Dr=i;else{if(i===null)throw Yt.alternate===null?Error(s(467)):Error(s(310));Dr=i,i={memoizedState:Dr.memoizedState,baseState:Dr.baseState,baseQueue:Dr.baseQueue,queue:Dr.queue,next:null},bs===null?Yt.memoizedState=bs=i:bs=bs.next=i}return bs}function qf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ju(i){var c=Eu;return Eu+=1,Kl===null&&(Kl=[]),i=mw(Kl,i,c),c=Yt,(bs===null?c.memoizedState:bs.next)===null&&(c=c.alternate,Q.H=c===null||c.memoizedState===null?n_:Cp),i}function Hf(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return ju(i);if(i.$$typeof===N)return Ps(i)}throw Error(s(438,String(i)))}function vp(i){var c=null,f=Yt.updateQueue;if(f!==null&&(c=f.memoCache),c==null){var p=Yt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(c={data:p.data.map(function(j){return j.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),f===null&&(f=qf(),Yt.updateQueue=f),f.memoCache=c,f=c.data[c.index],f===void 0)for(f=c.data[c.index]=Array(i),p=0;p<i;p++)f[p]=q;return c.index++,f}function ei(i,c){return typeof c=="function"?c(i):c}function Wf(i){var c=hs();return bp(c,Dr,i)}function bp(i,c,f){var p=i.queue;if(p===null)throw Error(s(311));p.lastRenderedReducer=f;var j=i.baseQueue,R=p.pending;if(R!==null){if(j!==null){var Z=j.next;j.next=R.next,R.next=Z}c.baseQueue=j=R,p.pending=null}if(R=i.baseState,j===null)i.memoizedState=R;else{c=j.next;var ge=Z=null,Fe=null,Ve=c,it=!1;do{var ut=Ve.lane&-536870913;if(ut!==Ve.lane?(cr&ut)===ut:(Qn&ut)===ut){var Xe=Ve.revertLane;if(Xe===0)Fe!==null&&(Fe=Fe.next={lane:0,revertLane:0,gesture:null,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null}),ut===$l&&(it=!0);else if((Qn&Xe)===Xe){Ve=Ve.next,Xe===$l&&(it=!0);continue}else ut={lane:0,revertLane:Ve.revertLane,gesture:null,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null},Fe===null?(ge=Fe=ut,Z=R):Fe=Fe.next=ut,Yt.lanes|=Xe,Gi|=Xe;ut=Ve.action,Io&&f(R,ut),R=Ve.hasEagerState?Ve.eagerState:f(R,ut)}else Xe={lane:ut,revertLane:Ve.revertLane,gesture:Ve.gesture,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null},Fe===null?(ge=Fe=Xe,Z=R):Fe=Fe.next=Xe,Yt.lanes|=ut,Gi|=ut;Ve=Ve.next}while(Ve!==null&&Ve!==c);if(Fe===null?Z=R:Fe.next=ge,!Ta(R,i.memoizedState)&&(ws=!0,it&&(f=ql,f!==null)))throw f;i.memoizedState=R,i.baseState=Z,i.baseQueue=Fe,p.lastRenderedState=R}return j===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function wp(i){var c=hs(),f=c.queue;if(f===null)throw Error(s(311));f.lastRenderedReducer=i;var p=f.dispatch,j=f.pending,R=c.memoizedState;if(j!==null){f.pending=null;var Z=j=j.next;do R=i(R,Z.action),Z=Z.next;while(Z!==j);Ta(R,c.memoizedState)||(ws=!0),c.memoizedState=R,c.baseQueue===null&&(c.baseState=R),f.lastRenderedState=R}return[R,p]}function kw(i,c,f){var p=Yt,j=hs(),R=hr;if(R){if(f===void 0)throw Error(s(407));f=f()}else f=c();var Z=!Ta((Dr||j).memoizedState,f);if(Z&&(j.memoizedState=f,ws=!0),j=j.queue,Sp(Tw.bind(null,p,j,i),[i]),j.getSnapshot!==c||Z||bs!==null&&bs.memoizedState.tag&1){if(p.flags|=2048,Xl(9,{destroy:void 0},jw.bind(null,p,j,f,c),null),Pr===null)throw Error(s(349));R||(Qn&127)!==0||Ew(p,c,f)}return f}function Ew(i,c,f){i.flags|=16384,i={getSnapshot:c,value:f},c=Yt.updateQueue,c===null?(c=qf(),Yt.updateQueue=c,c.stores=[i]):(f=c.stores,f===null?c.stores=[i]:f.push(i))}function jw(i,c,f,p){c.value=f,c.getSnapshot=p,Aw(c)&&Cw(i)}function Tw(i,c,f){return f(function(){Aw(c)&&Cw(i)})}function Aw(i){var c=i.getSnapshot;i=i.value;try{var f=c();return!Ta(i,f)}catch{return!0}}function Cw(i){var c=jo(i,2);c!==null&&wa(c,i,2)}function _p(i){var c=ua();if(typeof i=="function"){var f=i;if(i=f(),Io){It(!0);try{f()}finally{It(!1)}}}return c.memoizedState=c.baseState=i,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:i},c}function Rw(i,c,f,p){return i.baseState=f,bp(i,Dr,typeof p=="function"?p:ei)}function Z6(i,c,f,p,j){if(Kf(i))throw Error(s(485));if(i=c.action,i!==null){var R={payload:j,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Z){R.listeners.push(Z)}};Q.T!==null?f(!0):R.isTransition=!1,p(R),f=c.pending,f===null?(R.next=c.pending=R,Dw(c,R)):(R.next=f.next,c.pending=f.next=R)}}function Dw(i,c){var f=c.action,p=c.payload,j=i.state;if(c.isTransition){var R=Q.T,Z={};Q.T=Z;try{var ge=f(j,p),Fe=Q.S;Fe!==null&&Fe(Z,ge),Ow(i,c,ge)}catch(Ve){Np(i,c,Ve)}finally{R!==null&&Z.types!==null&&(R.types=Z.types),Q.T=R}}else try{R=f(j,p),Ow(i,c,R)}catch(Ve){Np(i,c,Ve)}}function Ow(i,c,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(p){Fw(i,c,p)},function(p){return Np(i,c,p)}):Fw(i,c,f)}function Fw(i,c,f){c.status="fulfilled",c.value=f,Lw(c),i.state=f,c=i.pending,c!==null&&(f=c.next,f===c?i.pending=null:(f=f.next,c.next=f,Dw(i,f)))}function Np(i,c,f){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do c.status="rejected",c.reason=f,Lw(c),c=c.next;while(c!==p)}i.action=null}function Lw(i){i=i.listeners;for(var c=0;c<i.length;c++)(0,i[c])()}function Iw(i,c){return c}function Mw(i,c){if(hr){var f=Pr.formState;if(f!==null){e:{var p=Yt;if(hr){if($r){t:{for(var j=$r,R=Qa;j.nodeType!==8;){if(!R){j=null;break t}if(j=tn(j.nextSibling),j===null){j=null;break t}}R=j.data,j=R==="F!"||R==="F"?j:null}if(j){$r=tn(j.nextSibling),p=j.data==="F!";break e}}Mi(p)}p=!1}p&&(c=f[0])}}return f=ua(),f.memoizedState=f.baseState=c,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Iw,lastRenderedState:c},f.queue=p,f=r_.bind(null,Yt,p),p.dispatch=f,p=_p(!1),R=Ap.bind(null,Yt,!1,p.queue),p=ua(),j={state:c,dispatch:null,action:i,pending:null},p.queue=j,f=Z6.bind(null,Yt,j,R,f),j.dispatch=f,p.memoizedState=i,[c,f,!1]}function Bw(i){var c=hs();return Pw(c,Dr,i)}function Pw(i,c,f){if(c=bp(i,c,Iw)[0],i=Wf(ei)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var p=ju(c)}catch(Z){throw Z===Hl?Lf:Z}else p=c;c=hs();var j=c.queue,R=j.dispatch;return f!==c.memoizedState&&(Yt.flags|=2048,Xl(9,{destroy:void 0},Q6.bind(null,j,f),null)),[p,R,i]}function Q6(i,c){i.action=c}function Uw(i){var c=hs(),f=Dr;if(f!==null)return Pw(c,f,i);hs(),c=c.memoizedState,f=hs();var p=f.queue.dispatch;return f.memoizedState=i,[c,p,!1]}function Xl(i,c,f,p){return i={tag:i,create:f,deps:p,inst:c,next:null},c=Yt.updateQueue,c===null&&(c=qf(),Yt.updateQueue=c),f=c.lastEffect,f===null?c.lastEffect=i.next=i:(p=f.next,f.next=i,i.next=p,c.lastEffect=i),i}function zw(){return hs().memoizedState}function Gf(i,c,f,p){var j=ua();Yt.flags|=i,j.memoizedState=Xl(1|c,{destroy:void 0},f,p===void 0?null:p)}function Vf(i,c,f,p){var j=hs();p=p===void 0?null:p;var R=j.memoizedState.inst;Dr!==null&&p!==null&&mp(p,Dr.memoizedState.deps)?j.memoizedState=Xl(c,R,f,p):(Yt.flags|=i,j.memoizedState=Xl(1|c,R,f,p))}function $w(i,c){Gf(8390656,8,i,c)}function Sp(i,c){Vf(2048,8,i,c)}function eA(i){Yt.flags|=4;var c=Yt.updateQueue;if(c===null)c=qf(),Yt.updateQueue=c,c.events=[i];else{var f=c.events;f===null?c.events=[i]:f.push(i)}}function qw(i){var c=hs().memoizedState;return eA({ref:c,nextImpl:i}),function(){if((Nr&2)!==0)throw Error(s(440));return c.impl.apply(void 0,arguments)}}function Hw(i,c){return Vf(4,2,i,c)}function Ww(i,c){return Vf(4,4,i,c)}function Gw(i,c){if(typeof c=="function"){i=i();var f=c(i);return function(){typeof f=="function"?f():c(null)}}if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function Vw(i,c,f){f=f!=null?f.concat([i]):null,Vf(4,4,Gw.bind(null,c,i),f)}function kp(){}function Kw(i,c){var f=hs();c=c===void 0?null:c;var p=f.memoizedState;return c!==null&&mp(c,p[1])?p[0]:(f.memoizedState=[i,c],i)}function Xw(i,c){var f=hs();c=c===void 0?null:c;var p=f.memoizedState;if(c!==null&&mp(c,p[1]))return p[0];if(p=i(),Io){It(!0);try{i()}finally{It(!1)}}return f.memoizedState=[p,c],p}function Ep(i,c,f){return f===void 0||(Qn&1073741824)!==0&&(cr&261930)===0?i.memoizedState=c:(i.memoizedState=f,i=Y_(),Yt.lanes|=i,Gi|=i,f)}function Yw(i,c,f,p){return Ta(f,c)?f:Gl.current!==null?(i=Ep(i,f,p),Ta(i,c)||(ws=!0),i):(Qn&42)===0||(Qn&1073741824)!==0&&(cr&261930)===0?(ws=!0,i.memoizedState=f):(i=Y_(),Yt.lanes|=i,Gi|=i,c)}function Jw(i,c,f,p,j){var R=te.p;te.p=R!==0&&8>R?R:8;var Z=Q.T,ge={};Q.T=ge,Ap(i,!1,c,f);try{var Fe=j(),Ve=Q.S;if(Ve!==null&&Ve(ge,Fe),Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"){var it=X6(Fe,p);Tu(i,c,it,Fa(i))}else Tu(i,c,p,Fa(i))}catch(ut){Tu(i,c,{then:function(){},status:"rejected",reason:ut},Fa())}finally{te.p=R,Z!==null&&ge.types!==null&&(Z.types=ge.types),Q.T=Z}}function tA(){}function jp(i,c,f,p){if(i.tag!==5)throw Error(s(476));var j=Zw(i).queue;Jw(i,j,c,ve,f===null?tA:function(){return Qw(i),f(p)})}function Zw(i){var c=i.memoizedState;if(c!==null)return c;c={memoizedState:ve,baseState:ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:ve},next:null};var f={};return c.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:f},next:null},i.memoizedState=c,i=i.alternate,i!==null&&(i.memoizedState=c),c}function Qw(i){var c=Zw(i);c.next===null&&(c=i.alternate.memoizedState),Tu(i,c.next.queue,{},Fa())}function Tp(){return Ps(Wu)}function e_(){return hs().memoizedState}function t_(){return hs().memoizedState}function rA(i){for(var c=i.return;c!==null;){switch(c.tag){case 24:case 3:var f=Fa();i=Ui(f);var p=zi(c,i,f);p!==null&&(wa(p,c,f),Nu(p,c,f)),c={cache:sp()},i.payload=c;return}c=c.return}}function sA(i,c,f){var p=Fa();f={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Kf(i)?s_(c,f):(f=Gm(i,c,f,p),f!==null&&(wa(f,i,p),a_(f,c,p)))}function r_(i,c,f){var p=Fa();Tu(i,c,f,p)}function Tu(i,c,f,p){var j={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Kf(i))s_(c,j);else{var R=i.alternate;if(i.lanes===0&&(R===null||R.lanes===0)&&(R=c.lastRenderedReducer,R!==null))try{var Z=c.lastRenderedState,ge=R(Z,f);if(j.hasEagerState=!0,j.eagerState=ge,Ta(ge,Z))return Tf(i,c,j,0),Pr===null&&jf(),!1}catch{}if(f=Gm(i,c,j,p),f!==null)return wa(f,i,p),a_(f,c,p),!0}return!1}function Ap(i,c,f,p){if(p={lane:2,revertLane:ox(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Kf(i)){if(c)throw Error(s(479))}else c=Gm(i,f,p,2),c!==null&&wa(c,i,2)}function Kf(i){var c=i.alternate;return i===Yt||c!==null&&c===Yt}function s_(i,c){Vl=zf=!0;var f=i.pending;f===null?c.next=c:(c.next=f.next,f.next=c),i.pending=c}function a_(i,c,f){if((f&4194048)!==0){var p=c.lanes;p&=i.pendingLanes,f|=p,c.lanes=f,zt(i,f)}}var Au={readContext:Ps,use:Hf,useCallback:rs,useContext:rs,useEffect:rs,useImperativeHandle:rs,useLayoutEffect:rs,useInsertionEffect:rs,useMemo:rs,useReducer:rs,useRef:rs,useState:rs,useDebugValue:rs,useDeferredValue:rs,useTransition:rs,useSyncExternalStore:rs,useId:rs,useHostTransitionStatus:rs,useFormState:rs,useActionState:rs,useOptimistic:rs,useMemoCache:rs,useCacheRefresh:rs};Au.useEffectEvent=rs;var n_={readContext:Ps,use:Hf,useCallback:function(i,c){return ua().memoizedState=[i,c===void 0?null:c],i},useContext:Ps,useEffect:$w,useImperativeHandle:function(i,c,f){f=f!=null?f.concat([i]):null,Gf(4194308,4,Gw.bind(null,c,i),f)},useLayoutEffect:function(i,c){return Gf(4194308,4,i,c)},useInsertionEffect:function(i,c){Gf(4,2,i,c)},useMemo:function(i,c){var f=ua();c=c===void 0?null:c;var p=i();if(Io){It(!0);try{i()}finally{It(!1)}}return f.memoizedState=[p,c],p},useReducer:function(i,c,f){var p=ua();if(f!==void 0){var j=f(c);if(Io){It(!0);try{f(c)}finally{It(!1)}}}else j=c;return p.memoizedState=p.baseState=j,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:j},p.queue=i,i=i.dispatch=sA.bind(null,Yt,i),[p.memoizedState,i]},useRef:function(i){var c=ua();return i={current:i},c.memoizedState=i},useState:function(i){i=_p(i);var c=i.queue,f=r_.bind(null,Yt,c);return c.dispatch=f,[i.memoizedState,f]},useDebugValue:kp,useDeferredValue:function(i,c){var f=ua();return Ep(f,i,c)},useTransition:function(){var i=_p(!1);return i=Jw.bind(null,Yt,i.queue,!0,!1),ua().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,c,f){var p=Yt,j=ua();if(hr){if(f===void 0)throw Error(s(407));f=f()}else{if(f=c(),Pr===null)throw Error(s(349));(cr&127)!==0||Ew(p,c,f)}j.memoizedState=f;var R={value:f,getSnapshot:c};return j.queue=R,$w(Tw.bind(null,p,R,i),[i]),p.flags|=2048,Xl(9,{destroy:void 0},jw.bind(null,p,R,f,c),null),f},useId:function(){var i=ua(),c=Pr.identifierPrefix;if(hr){var f=Cn,p=An;f=(p&~(1<<32-Le(p)-1)).toString(32)+f,c="_"+c+"R_"+f,f=$f++,0<f&&(c+="H"+f.toString(32)),c+="_"}else f=Y6++,c="_"+c+"r_"+f.toString(32)+"_";return i.memoizedState=c},useHostTransitionStatus:Tp,useFormState:Mw,useActionState:Mw,useOptimistic:function(i){var c=ua();c.memoizedState=c.baseState=i;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=f,c=Ap.bind(null,Yt,!0,f),f.dispatch=c,[i,c]},useMemoCache:vp,useCacheRefresh:function(){return ua().memoizedState=rA.bind(null,Yt)},useEffectEvent:function(i){var c=ua(),f={impl:i};return c.memoizedState=f,function(){if((Nr&2)!==0)throw Error(s(440));return f.impl.apply(void 0,arguments)}}},Cp={readContext:Ps,use:Hf,useCallback:Kw,useContext:Ps,useEffect:Sp,useImperativeHandle:Vw,useInsertionEffect:Hw,useLayoutEffect:Ww,useMemo:Xw,useReducer:Wf,useRef:zw,useState:function(){return Wf(ei)},useDebugValue:kp,useDeferredValue:function(i,c){var f=hs();return Yw(f,Dr.memoizedState,i,c)},useTransition:function(){var i=Wf(ei)[0],c=hs().memoizedState;return[typeof i=="boolean"?i:ju(i),c]},useSyncExternalStore:kw,useId:e_,useHostTransitionStatus:Tp,useFormState:Bw,useActionState:Bw,useOptimistic:function(i,c){var f=hs();return Rw(f,Dr,i,c)},useMemoCache:vp,useCacheRefresh:t_};Cp.useEffectEvent=qw;var i_={readContext:Ps,use:Hf,useCallback:Kw,useContext:Ps,useEffect:Sp,useImperativeHandle:Vw,useInsertionEffect:Hw,useLayoutEffect:Ww,useMemo:Xw,useReducer:wp,useRef:zw,useState:function(){return wp(ei)},useDebugValue:kp,useDeferredValue:function(i,c){var f=hs();return Dr===null?Ep(f,i,c):Yw(f,Dr.memoizedState,i,c)},useTransition:function(){var i=wp(ei)[0],c=hs().memoizedState;return[typeof i=="boolean"?i:ju(i),c]},useSyncExternalStore:kw,useId:e_,useHostTransitionStatus:Tp,useFormState:Uw,useActionState:Uw,useOptimistic:function(i,c){var f=hs();return Dr!==null?Rw(f,Dr,i,c):(f.baseState=i,[i,f.queue.dispatch])},useMemoCache:vp,useCacheRefresh:t_};i_.useEffectEvent=qw;function Rp(i,c,f,p){c=i.memoizedState,f=f(p,c),f=f==null?c:x({},c,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var Dp={enqueueSetState:function(i,c,f){i=i._reactInternals;var p=Fa(),j=Ui(p);j.payload=c,f!=null&&(j.callback=f),c=zi(i,j,p),c!==null&&(wa(c,i,p),Nu(c,i,p))},enqueueReplaceState:function(i,c,f){i=i._reactInternals;var p=Fa(),j=Ui(p);j.tag=1,j.payload=c,f!=null&&(j.callback=f),c=zi(i,j,p),c!==null&&(wa(c,i,p),Nu(c,i,p))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var f=Fa(),p=Ui(f);p.tag=2,c!=null&&(p.callback=c),c=zi(i,p,f),c!==null&&(wa(c,i,f),Nu(c,i,f))}};function o_(i,c,f,p,j,R,Z){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,R,Z):c.prototype&&c.prototype.isPureReactComponent?!pu(f,p)||!pu(j,R):!0}function l_(i,c,f,p){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,p),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,p),c.state!==i&&Dp.enqueueReplaceState(c,c.state,null)}function Mo(i,c){var f=c;if("ref"in c){f={};for(var p in c)p!=="ref"&&(f[p]=c[p])}if(i=i.defaultProps){f===c&&(f=x({},f));for(var j in i)f[j]===void 0&&(f[j]=i[j])}return f}function c_(i){Ef(i)}function u_(i){console.error(i)}function d_(i){Ef(i)}function Xf(i,c){try{var f=i.onUncaughtError;f(c.value,{componentStack:c.stack})}catch(p){setTimeout(function(){throw p})}}function f_(i,c,f){try{var p=i.onCaughtError;p(f.value,{componentStack:f.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(j){setTimeout(function(){throw j})}}function Op(i,c,f){return f=Ui(f),f.tag=3,f.payload={element:null},f.callback=function(){Xf(i,c)},f}function h_(i){return i=Ui(i),i.tag=3,i}function m_(i,c,f,p){var j=f.type.getDerivedStateFromError;if(typeof j=="function"){var R=p.value;i.payload=function(){return j(R)},i.callback=function(){f_(c,f,p)}}var Z=f.stateNode;Z!==null&&typeof Z.componentDidCatch=="function"&&(i.callback=function(){f_(c,f,p),typeof j!="function"&&(Vi===null?Vi=new Set([this]):Vi.add(this));var ge=p.stack;this.componentDidCatch(p.value,{componentStack:ge!==null?ge:""})})}function aA(i,c,f,p,j){if(f.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(c=f.alternate,c!==null&&zl(c,f,j,!0),f=Ca.current,f!==null){switch(f.tag){case 31:case 13:return en===null?oh():f.alternate===null&&ss===0&&(ss=3),f.flags&=-257,f.flags|=65536,f.lanes=j,p===If?f.flags|=16384:(c=f.updateQueue,c===null?f.updateQueue=new Set([p]):c.add(p),ax(i,p,j)),!1;case 22:return f.flags|=65536,p===If?f.flags|=16384:(c=f.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([p])},f.updateQueue=c):(f=c.retryQueue,f===null?c.retryQueue=new Set([p]):f.add(p)),ax(i,p,j)),!1}throw Error(s(435,f.tag))}return ax(i,p,j),oh(),!1}if(hr)return c=Ca.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=j,p!==Zm&&(i=Error(s(422),{cause:p}),yu(Ya(i,f)))):(p!==Zm&&(c=Error(s(423),{cause:p}),yu(Ya(c,f))),i=i.current.alternate,i.flags|=65536,j&=-j,i.lanes|=j,p=Ya(p,f),j=Op(i.stateNode,p,j),cp(i,j),ss!==4&&(ss=2)),!1;var R=Error(s(520),{cause:p});if(R=Ya(R,f),Mu===null?Mu=[R]:Mu.push(R),ss!==4&&(ss=2),c===null)return!0;p=Ya(p,f),f=c;do{switch(f.tag){case 3:return f.flags|=65536,i=j&-j,f.lanes|=i,i=Op(f.stateNode,p,i),cp(f,i),!1;case 1:if(c=f.type,R=f.stateNode,(f.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(Vi===null||!Vi.has(R))))return f.flags|=65536,j&=-j,f.lanes|=j,j=h_(j),m_(j,i,f,p),cp(f,j),!1}f=f.return}while(f!==null);return!1}var Fp=Error(s(461)),ws=!1;function Us(i,c,f,p){c.child=i===null?yw(c,null,f,p):Lo(c,i.child,f,p)}function p_(i,c,f,p,j){f=f.render;var R=c.ref;if("ref"in p){var Z={};for(var ge in p)ge!=="ref"&&(Z[ge]=p[ge])}else Z=p;return Ro(c),p=pp(i,c,f,Z,R,j),ge=xp(),i!==null&&!ws?(gp(i,c,j),ti(i,c,j)):(hr&&ge&&Ym(c),c.flags|=1,Us(i,c,p,j),c.child)}function x_(i,c,f,p,j){if(i===null){var R=f.type;return typeof R=="function"&&!Vm(R)&&R.defaultProps===void 0&&f.compare===null?(c.tag=15,c.type=R,g_(i,c,R,p,j)):(i=Cf(f.type,null,p,c,c.mode,j),i.ref=c.ref,i.return=c,c.child=i)}if(R=i.child,!$p(i,j)){var Z=R.memoizedProps;if(f=f.compare,f=f!==null?f:pu,f(Z,p)&&i.ref===c.ref)return ti(i,c,j)}return c.flags|=1,i=Xn(R,p),i.ref=c.ref,i.return=c,c.child=i}function g_(i,c,f,p,j){if(i!==null){var R=i.memoizedProps;if(pu(R,p)&&i.ref===c.ref)if(ws=!1,c.pendingProps=p=R,$p(i,j))(i.flags&131072)!==0&&(ws=!0);else return c.lanes=i.lanes,ti(i,c,j)}return Lp(i,c,f,p,j)}function y_(i,c,f,p){var j=p.children,R=i!==null?i.memoizedState:null;if(i===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((c.flags&128)!==0){if(R=R!==null?R.baseLanes|f:f,i!==null){for(p=c.child=i.child,j=0;p!==null;)j=j|p.lanes|p.childLanes,p=p.sibling;p=j&~R}else p=0,c.child=null;return v_(i,c,R,f,p)}if((f&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},i!==null&&Ff(c,R!==null?R.cachePool:null),R!==null?ww(c,R):dp(),_w(c);else return p=c.lanes=536870912,v_(i,c,R!==null?R.baseLanes|f:f,f,p)}else R!==null?(Ff(c,R.cachePool),ww(c,R),qi(),c.memoizedState=null):(i!==null&&Ff(c,null),dp(),qi());return Us(i,c,j,f),c.child}function Cu(i,c){return i!==null&&i.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function v_(i,c,f,p,j){var R=np();return R=R===null?null:{parent:vs._currentValue,pool:R},c.memoizedState={baseLanes:f,cachePool:R},i!==null&&Ff(c,null),dp(),_w(c),i!==null&&zl(i,c,p,!0),c.childLanes=j,null}function Yf(i,c){return c=Zf({mode:c.mode,children:c.children},i.mode),c.ref=i.ref,i.child=c,c.return=i,c}function b_(i,c,f){return Lo(c,i.child,null,f),i=Yf(c,c.pendingProps),i.flags|=2,Ra(c),c.memoizedState=null,i}function nA(i,c,f){var p=c.pendingProps,j=(c.flags&128)!==0;if(c.flags&=-129,i===null){if(hr){if(p.mode==="hidden")return i=Yf(c,p),c.lanes=536870912,Cu(null,i);if(hp(c),(i=$r)?(i=D2(i,Qa),i=i!==null&&i.data==="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:Li!==null?{id:An,overflow:Cn}:null,retryLane:536870912,hydrationErrors:null},f=sw(i),f.return=c,c.child=f,Bs=c,$r=null)):i=null,i===null)throw Mi(c);return c.lanes=536870912,null}return Yf(c,p)}var R=i.memoizedState;if(R!==null){var Z=R.dehydrated;if(hp(c),j)if(c.flags&256)c.flags&=-257,c=b_(i,c,f);else if(c.memoizedState!==null)c.child=i.child,c.flags|=128,c=null;else throw Error(s(558));else if(ws||zl(i,c,f,!1),j=(f&i.childLanes)!==0,ws||j){if(p=Pr,p!==null&&(Z=fr(p,f),Z!==0&&Z!==R.retryLane))throw R.retryLane=Z,jo(i,Z),wa(p,i,Z),Fp;oh(),c=b_(i,c,f)}else i=R.treeContext,$r=tn(Z.nextSibling),Bs=c,hr=!0,Ii=null,Qa=!1,i!==null&&iw(c,i),c=Yf(c,p),c.flags|=4096;return c}return i=Xn(i.child,{mode:p.mode,children:p.children}),i.ref=c.ref,c.child=i,i.return=c,i}function Jf(i,c){var f=c.ref;if(f===null)i!==null&&i.ref!==null&&(c.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(s(284));(i===null||i.ref!==f)&&(c.flags|=4194816)}}function Lp(i,c,f,p,j){return Ro(c),f=pp(i,c,f,p,void 0,j),p=xp(),i!==null&&!ws?(gp(i,c,j),ti(i,c,j)):(hr&&p&&Ym(c),c.flags|=1,Us(i,c,f,j),c.child)}function w_(i,c,f,p,j,R){return Ro(c),c.updateQueue=null,f=Sw(c,p,f,j),Nw(i),p=xp(),i!==null&&!ws?(gp(i,c,R),ti(i,c,R)):(hr&&p&&Ym(c),c.flags|=1,Us(i,c,f,R),c.child)}function __(i,c,f,p,j){if(Ro(c),c.stateNode===null){var R=Ml,Z=f.contextType;typeof Z=="object"&&Z!==null&&(R=Ps(Z)),R=new f(p,R),c.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,R.updater=Dp,c.stateNode=R,R._reactInternals=c,R=c.stateNode,R.props=p,R.state=c.memoizedState,R.refs={},op(c),Z=f.contextType,R.context=typeof Z=="object"&&Z!==null?Ps(Z):Ml,R.state=c.memoizedState,Z=f.getDerivedStateFromProps,typeof Z=="function"&&(Rp(c,f,Z,p),R.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(Z=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),Z!==R.state&&Dp.enqueueReplaceState(R,R.state,null),ku(c,p,R,j),Su(),R.state=c.memoizedState),typeof R.componentDidMount=="function"&&(c.flags|=4194308),p=!0}else if(i===null){R=c.stateNode;var ge=c.memoizedProps,Fe=Mo(f,ge);R.props=Fe;var Ve=R.context,it=f.contextType;Z=Ml,typeof it=="object"&&it!==null&&(Z=Ps(it));var ut=f.getDerivedStateFromProps;it=typeof ut=="function"||typeof R.getSnapshotBeforeUpdate=="function",ge=c.pendingProps!==ge,it||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(ge||Ve!==Z)&&l_(c,R,p,Z),Pi=!1;var Xe=c.memoizedState;R.state=Xe,ku(c,p,R,j),Su(),Ve=c.memoizedState,ge||Xe!==Ve||Pi?(typeof ut=="function"&&(Rp(c,f,ut,p),Ve=c.memoizedState),(Fe=Pi||o_(c,f,Fe,p,Xe,Ve,Z))?(it||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(c.flags|=4194308)):(typeof R.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=p,c.memoizedState=Ve),R.props=p,R.state=Ve,R.context=Z,p=Fe):(typeof R.componentDidMount=="function"&&(c.flags|=4194308),p=!1)}else{R=c.stateNode,lp(i,c),Z=c.memoizedProps,it=Mo(f,Z),R.props=it,ut=c.pendingProps,Xe=R.context,Ve=f.contextType,Fe=Ml,typeof Ve=="object"&&Ve!==null&&(Fe=Ps(Ve)),ge=f.getDerivedStateFromProps,(Ve=typeof ge=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(Z!==ut||Xe!==Fe)&&l_(c,R,p,Fe),Pi=!1,Xe=c.memoizedState,R.state=Xe,ku(c,p,R,j),Su();var Ze=c.memoizedState;Z!==ut||Xe!==Ze||Pi||i!==null&&i.dependencies!==null&&Df(i.dependencies)?(typeof ge=="function"&&(Rp(c,f,ge,p),Ze=c.memoizedState),(it=Pi||o_(c,f,it,p,Xe,Ze,Fe)||i!==null&&i.dependencies!==null&&Df(i.dependencies))?(Ve||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(p,Ze,Fe),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(p,Ze,Fe)),typeof R.componentDidUpdate=="function"&&(c.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof R.componentDidUpdate!="function"||Z===i.memoizedProps&&Xe===i.memoizedState||(c.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||Z===i.memoizedProps&&Xe===i.memoizedState||(c.flags|=1024),c.memoizedProps=p,c.memoizedState=Ze),R.props=p,R.state=Ze,R.context=Fe,p=it):(typeof R.componentDidUpdate!="function"||Z===i.memoizedProps&&Xe===i.memoizedState||(c.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||Z===i.memoizedProps&&Xe===i.memoizedState||(c.flags|=1024),p=!1)}return R=p,Jf(i,c),p=(c.flags&128)!==0,R||p?(R=c.stateNode,f=p&&typeof f.getDerivedStateFromError!="function"?null:R.render(),c.flags|=1,i!==null&&p?(c.child=Lo(c,i.child,null,j),c.child=Lo(c,null,f,j)):Us(i,c,f,j),c.memoizedState=R.state,i=c.child):i=ti(i,c,j),i}function N_(i,c,f,p){return Ao(),c.flags|=256,Us(i,c,f,p),c.child}var Ip={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Mp(i){return{baseLanes:i,cachePool:fw()}}function Bp(i,c,f){return i=i!==null?i.childLanes&~f:0,c&&(i|=Oa),i}function S_(i,c,f){var p=c.pendingProps,j=!1,R=(c.flags&128)!==0,Z;if((Z=R)||(Z=i!==null&&i.memoizedState===null?!1:(fs.current&2)!==0),Z&&(j=!0,c.flags&=-129),Z=(c.flags&32)!==0,c.flags&=-33,i===null){if(hr){if(j?$i(c):qi(),(i=$r)?(i=D2(i,Qa),i=i!==null&&i.data!=="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:Li!==null?{id:An,overflow:Cn}:null,retryLane:536870912,hydrationErrors:null},f=sw(i),f.return=c,c.child=f,Bs=c,$r=null)):i=null,i===null)throw Mi(c);return bx(i)?c.lanes=32:c.lanes=536870912,null}var ge=p.children;return p=p.fallback,j?(qi(),j=c.mode,ge=Zf({mode:"hidden",children:ge},j),p=To(p,j,f,null),ge.return=c,p.return=c,ge.sibling=p,c.child=ge,p=c.child,p.memoizedState=Mp(f),p.childLanes=Bp(i,Z,f),c.memoizedState=Ip,Cu(null,p)):($i(c),Pp(c,ge))}var Fe=i.memoizedState;if(Fe!==null&&(ge=Fe.dehydrated,ge!==null)){if(R)c.flags&256?($i(c),c.flags&=-257,c=Up(i,c,f)):c.memoizedState!==null?(qi(),c.child=i.child,c.flags|=128,c=null):(qi(),ge=p.fallback,j=c.mode,p=Zf({mode:"visible",children:p.children},j),ge=To(ge,j,f,null),ge.flags|=2,p.return=c,ge.return=c,p.sibling=ge,c.child=p,Lo(c,i.child,null,f),p=c.child,p.memoizedState=Mp(f),p.childLanes=Bp(i,Z,f),c.memoizedState=Ip,c=Cu(null,p));else if($i(c),bx(ge)){if(Z=ge.nextSibling&&ge.nextSibling.dataset,Z)var Ve=Z.dgst;Z=Ve,p=Error(s(419)),p.stack="",p.digest=Z,yu({value:p,source:null,stack:null}),c=Up(i,c,f)}else if(ws||zl(i,c,f,!1),Z=(f&i.childLanes)!==0,ws||Z){if(Z=Pr,Z!==null&&(p=fr(Z,f),p!==0&&p!==Fe.retryLane))throw Fe.retryLane=p,jo(i,p),wa(Z,i,p),Fp;vx(ge)||oh(),c=Up(i,c,f)}else vx(ge)?(c.flags|=192,c.child=i.child,c=null):(i=Fe.treeContext,$r=tn(ge.nextSibling),Bs=c,hr=!0,Ii=null,Qa=!1,i!==null&&iw(c,i),c=Pp(c,p.children),c.flags|=4096);return c}return j?(qi(),ge=p.fallback,j=c.mode,Fe=i.child,Ve=Fe.sibling,p=Xn(Fe,{mode:"hidden",children:p.children}),p.subtreeFlags=Fe.subtreeFlags&65011712,Ve!==null?ge=Xn(Ve,ge):(ge=To(ge,j,f,null),ge.flags|=2),ge.return=c,p.return=c,p.sibling=ge,c.child=p,Cu(null,p),p=c.child,ge=i.child.memoizedState,ge===null?ge=Mp(f):(j=ge.cachePool,j!==null?(Fe=vs._currentValue,j=j.parent!==Fe?{parent:Fe,pool:Fe}:j):j=fw(),ge={baseLanes:ge.baseLanes|f,cachePool:j}),p.memoizedState=ge,p.childLanes=Bp(i,Z,f),c.memoizedState=Ip,Cu(i.child,p)):($i(c),f=i.child,i=f.sibling,f=Xn(f,{mode:"visible",children:p.children}),f.return=c,f.sibling=null,i!==null&&(Z=c.deletions,Z===null?(c.deletions=[i],c.flags|=16):Z.push(i)),c.child=f,c.memoizedState=null,f)}function Pp(i,c){return c=Zf({mode:"visible",children:c},i.mode),c.return=i,i.child=c}function Zf(i,c){return i=Aa(22,i,null,c),i.lanes=0,i}function Up(i,c,f){return Lo(c,i.child,null,f),i=Pp(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function k_(i,c,f){i.lanes|=c;var p=i.alternate;p!==null&&(p.lanes|=c),tp(i.return,c,f)}function zp(i,c,f,p,j,R){var Z=i.memoizedState;Z===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:p,tail:f,tailMode:j,treeForkCount:R}:(Z.isBackwards=c,Z.rendering=null,Z.renderingStartTime=0,Z.last=p,Z.tail=f,Z.tailMode=j,Z.treeForkCount=R)}function E_(i,c,f){var p=c.pendingProps,j=p.revealOrder,R=p.tail;p=p.children;var Z=fs.current,ge=(Z&2)!==0;if(ge?(Z=Z&1|2,c.flags|=128):Z&=1,Y(fs,Z),Us(i,c,p,f),p=hr?gu:0,!ge&&i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&k_(i,f,c);else if(i.tag===19)k_(i,f,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(j){case"forwards":for(f=c.child,j=null;f!==null;)i=f.alternate,i!==null&&Uf(i)===null&&(j=f),f=f.sibling;f=j,f===null?(j=c.child,c.child=null):(j=f.sibling,f.sibling=null),zp(c,!1,j,f,R,p);break;case"backwards":case"unstable_legacy-backwards":for(f=null,j=c.child,c.child=null;j!==null;){if(i=j.alternate,i!==null&&Uf(i)===null){c.child=j;break}i=j.sibling,j.sibling=f,f=j,j=i}zp(c,!0,f,null,R,p);break;case"together":zp(c,!1,null,null,void 0,p);break;default:c.memoizedState=null}return c.child}function ti(i,c,f){if(i!==null&&(c.dependencies=i.dependencies),Gi|=c.lanes,(f&c.childLanes)===0)if(i!==null){if(zl(i,c,f,!1),(f&c.childLanes)===0)return null}else return null;if(i!==null&&c.child!==i.child)throw Error(s(153));if(c.child!==null){for(i=c.child,f=Xn(i,i.pendingProps),c.child=f,f.return=c;i.sibling!==null;)i=i.sibling,f=f.sibling=Xn(i,i.pendingProps),f.return=c;f.sibling=null}return c.child}function $p(i,c){return(i.lanes&c)!==0?!0:(i=i.dependencies,!!(i!==null&&Df(i)))}function iA(i,c,f){switch(c.tag){case 3:U(c,c.stateNode.containerInfo),Bi(c,vs,i.memoizedState.cache),Ao();break;case 27:case 5:ne(c);break;case 4:U(c,c.stateNode.containerInfo);break;case 10:Bi(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,hp(c),null;break;case 13:var p=c.memoizedState;if(p!==null)return p.dehydrated!==null?($i(c),c.flags|=128,null):(f&c.child.childLanes)!==0?S_(i,c,f):($i(c),i=ti(i,c,f),i!==null?i.sibling:null);$i(c);break;case 19:var j=(i.flags&128)!==0;if(p=(f&c.childLanes)!==0,p||(zl(i,c,f,!1),p=(f&c.childLanes)!==0),j){if(p)return E_(i,c,f);c.flags|=128}if(j=c.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),Y(fs,fs.current),p)break;return null;case 22:return c.lanes=0,y_(i,c,f,c.pendingProps);case 24:Bi(c,vs,i.memoizedState.cache)}return ti(i,c,f)}function j_(i,c,f){if(i!==null)if(i.memoizedProps!==c.pendingProps)ws=!0;else{if(!$p(i,f)&&(c.flags&128)===0)return ws=!1,iA(i,c,f);ws=(i.flags&131072)!==0}else ws=!1,hr&&(c.flags&1048576)!==0&&nw(c,gu,c.index);switch(c.lanes=0,c.tag){case 16:e:{var p=c.pendingProps;if(i=Oo(c.elementType),c.type=i,typeof i=="function")Vm(i)?(p=Mo(i,p),c.tag=1,c=__(null,c,i,p,f)):(c.tag=0,c=Lp(null,c,i,p,f));else{if(i!=null){var j=i.$$typeof;if(j===E){c.tag=11,c=p_(null,c,i,p,f);break e}else if(j===O){c.tag=14,c=x_(null,c,i,p,f);break e}}throw c=I(i)||i,Error(s(306,c,""))}}return c;case 0:return Lp(i,c,c.type,c.pendingProps,f);case 1:return p=c.type,j=Mo(p,c.pendingProps),__(i,c,p,j,f);case 3:e:{if(U(c,c.stateNode.containerInfo),i===null)throw Error(s(387));p=c.pendingProps;var R=c.memoizedState;j=R.element,lp(i,c),ku(c,p,null,f);var Z=c.memoizedState;if(p=Z.cache,Bi(c,vs,p),p!==R.cache&&rp(c,[vs],f,!0),Su(),p=Z.element,R.isDehydrated)if(R={element:p,isDehydrated:!1,cache:Z.cache},c.updateQueue.baseState=R,c.memoizedState=R,c.flags&256){c=N_(i,c,p,f);break e}else if(p!==j){j=Ya(Error(s(424)),c),yu(j),c=N_(i,c,p,f);break e}else for(i=c.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,$r=tn(i.firstChild),Bs=c,hr=!0,Ii=null,Qa=!0,f=yw(c,null,p,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Ao(),p===j){c=ti(i,c,f);break e}Us(i,c,p,f)}c=c.child}return c;case 26:return Jf(i,c),i===null?(f=B2(c.type,null,c.pendingProps,null))?c.memoizedState=f:hr||(f=c.type,i=c.pendingProps,p=mh(ce.current).createElement(f),p[be]=c,p[ke]=i,zs(p,f,i),Ie(p),c.stateNode=p):c.memoizedState=B2(c.type,i.memoizedProps,c.pendingProps,i.memoizedState),null;case 27:return ne(c),i===null&&hr&&(p=c.stateNode=L2(c.type,c.pendingProps,ce.current),Bs=c,Qa=!0,j=$r,Ji(c.type)?(wx=j,$r=tn(p.firstChild)):$r=j),Us(i,c,c.pendingProps.children,f),Jf(i,c),i===null&&(c.flags|=4194304),c.child;case 5:return i===null&&hr&&((j=p=$r)&&(p=IA(p,c.type,c.pendingProps,Qa),p!==null?(c.stateNode=p,Bs=c,$r=tn(p.firstChild),Qa=!1,j=!0):j=!1),j||Mi(c)),ne(c),j=c.type,R=c.pendingProps,Z=i!==null?i.memoizedProps:null,p=R.children,xx(j,R)?p=null:Z!==null&&xx(j,Z)&&(c.flags|=32),c.memoizedState!==null&&(j=pp(i,c,J6,null,null,f),Wu._currentValue=j),Jf(i,c),Us(i,c,p,f),c.child;case 6:return i===null&&hr&&((i=f=$r)&&(f=MA(f,c.pendingProps,Qa),f!==null?(c.stateNode=f,Bs=c,$r=null,i=!0):i=!1),i||Mi(c)),null;case 13:return S_(i,c,f);case 4:return U(c,c.stateNode.containerInfo),p=c.pendingProps,i===null?c.child=Lo(c,null,p,f):Us(i,c,p,f),c.child;case 11:return p_(i,c,c.type,c.pendingProps,f);case 7:return Us(i,c,c.pendingProps,f),c.child;case 8:return Us(i,c,c.pendingProps.children,f),c.child;case 12:return Us(i,c,c.pendingProps.children,f),c.child;case 10:return p=c.pendingProps,Bi(c,c.type,p.value),Us(i,c,p.children,f),c.child;case 9:return j=c.type._context,p=c.pendingProps.children,Ro(c),j=Ps(j),p=p(j),c.flags|=1,Us(i,c,p,f),c.child;case 14:return x_(i,c,c.type,c.pendingProps,f);case 15:return g_(i,c,c.type,c.pendingProps,f);case 19:return E_(i,c,f);case 31:return nA(i,c,f);case 22:return y_(i,c,f,c.pendingProps);case 24:return Ro(c),p=Ps(vs),i===null?(j=np(),j===null&&(j=Pr,R=sp(),j.pooledCache=R,R.refCount++,R!==null&&(j.pooledCacheLanes|=f),j=R),c.memoizedState={parent:p,cache:j},op(c),Bi(c,vs,j)):((i.lanes&f)!==0&&(lp(i,c),ku(c,null,null,f),Su()),j=i.memoizedState,R=c.memoizedState,j.parent!==p?(j={parent:p,cache:p},c.memoizedState=j,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=j),Bi(c,vs,p)):(p=R.cache,Bi(c,vs,p),p!==j.cache&&rp(c,[vs],f,!0))),Us(i,c,c.pendingProps.children,f),c.child;case 29:throw c.pendingProps}throw Error(s(156,c.tag))}function ri(i){i.flags|=4}function qp(i,c,f,p,j){if((c=(i.mode&32)!==0)&&(c=!1),c){if(i.flags|=16777216,(j&335544128)===j)if(i.stateNode.complete)i.flags|=8192;else if(e2())i.flags|=8192;else throw Fo=If,ip}else i.flags&=-16777217}function T_(i,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!q2(c))if(e2())i.flags|=8192;else throw Fo=If,ip}function Qf(i,c){c!==null&&(i.flags|=4),i.flags&16384&&(c=i.tag!==22?pt():536870912,i.lanes|=c,Ql|=c)}function Ru(i,c){if(!hr)switch(i.tailMode){case"hidden":c=i.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function qr(i){var c=i.alternate!==null&&i.alternate.child===i.child,f=0,p=0;if(c)for(var j=i.child;j!==null;)f|=j.lanes|j.childLanes,p|=j.subtreeFlags&65011712,p|=j.flags&65011712,j.return=i,j=j.sibling;else for(j=i.child;j!==null;)f|=j.lanes|j.childLanes,p|=j.subtreeFlags,p|=j.flags,j.return=i,j=j.sibling;return i.subtreeFlags|=p,i.childLanes=f,c}function oA(i,c,f){var p=c.pendingProps;switch(Jm(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qr(c),null;case 1:return qr(c),null;case 3:return f=c.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),Zn(vs),le(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(Ul(c)?ri(c):i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Qm())),qr(c),null;case 26:var j=c.type,R=c.memoizedState;return i===null?(ri(c),R!==null?(qr(c),T_(c,R)):(qr(c),qp(c,j,null,p,f))):R?R!==i.memoizedState?(ri(c),qr(c),T_(c,R)):(qr(c),c.flags&=-16777217):(i=i.memoizedProps,i!==p&&ri(c),qr(c),qp(c,j,i,p,f)),null;case 27:if(ie(c),f=ce.current,j=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==p&&ri(c);else{if(!p){if(c.stateNode===null)throw Error(s(166));return qr(c),null}i=G.current,Ul(c)?ow(c):(i=L2(j,p,f),c.stateNode=i,ri(c))}return qr(c),null;case 5:if(ie(c),j=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==p&&ri(c);else{if(!p){if(c.stateNode===null)throw Error(s(166));return qr(c),null}if(R=G.current,Ul(c))ow(c);else{var Z=mh(ce.current);switch(R){case 1:R=Z.createElementNS("http://www.w3.org/2000/svg",j);break;case 2:R=Z.createElementNS("http://www.w3.org/1998/Math/MathML",j);break;default:switch(j){case"svg":R=Z.createElementNS("http://www.w3.org/2000/svg",j);break;case"math":R=Z.createElementNS("http://www.w3.org/1998/Math/MathML",j);break;case"script":R=Z.createElement("div"),R.innerHTML="<script><\/script>",R=R.removeChild(R.firstChild);break;case"select":R=typeof p.is=="string"?Z.createElement("select",{is:p.is}):Z.createElement("select"),p.multiple?R.multiple=!0:p.size&&(R.size=p.size);break;default:R=typeof p.is=="string"?Z.createElement(j,{is:p.is}):Z.createElement(j)}}R[be]=c,R[ke]=p;e:for(Z=c.child;Z!==null;){if(Z.tag===5||Z.tag===6)R.appendChild(Z.stateNode);else if(Z.tag!==4&&Z.tag!==27&&Z.child!==null){Z.child.return=Z,Z=Z.child;continue}if(Z===c)break e;for(;Z.sibling===null;){if(Z.return===null||Z.return===c)break e;Z=Z.return}Z.sibling.return=Z.return,Z=Z.sibling}c.stateNode=R;e:switch(zs(R,j,p),j){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&ri(c)}}return qr(c),qp(c,c.type,i===null?null:i.memoizedProps,c.pendingProps,f),null;case 6:if(i&&c.stateNode!=null)i.memoizedProps!==p&&ri(c);else{if(typeof p!="string"&&c.stateNode===null)throw Error(s(166));if(i=ce.current,Ul(c)){if(i=c.stateNode,f=c.memoizedProps,p=null,j=Bs,j!==null)switch(j.tag){case 27:case 5:p=j.memoizedProps}i[be]=c,i=!!(i.nodeValue===f||p!==null&&p.suppressHydrationWarning===!0||S2(i.nodeValue,f)),i||Mi(c,!0)}else i=mh(i).createTextNode(p),i[be]=c,c.stateNode=i}return qr(c),null;case 31:if(f=c.memoizedState,i===null||i.memoizedState!==null){if(p=Ul(c),f!==null){if(i===null){if(!p)throw Error(s(318));if(i=c.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(557));i[be]=c}else Ao(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;qr(c),i=!1}else f=Qm(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=f),i=!0;if(!i)return c.flags&256?(Ra(c),c):(Ra(c),null);if((c.flags&128)!==0)throw Error(s(558))}return qr(c),null;case 13:if(p=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(j=Ul(c),p!==null&&p.dehydrated!==null){if(i===null){if(!j)throw Error(s(318));if(j=c.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(s(317));j[be]=c}else Ao(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;qr(c),j=!1}else j=Qm(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=j),j=!0;if(!j)return c.flags&256?(Ra(c),c):(Ra(c),null)}return Ra(c),(c.flags&128)!==0?(c.lanes=f,c):(f=p!==null,i=i!==null&&i.memoizedState!==null,f&&(p=c.child,j=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(j=p.alternate.memoizedState.cachePool.pool),R=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(R=p.memoizedState.cachePool.pool),R!==j&&(p.flags|=2048)),f!==i&&f&&(c.child.flags|=8192),Qf(c,c.updateQueue),qr(c),null);case 4:return le(),i===null&&dx(c.stateNode.containerInfo),qr(c),null;case 10:return Zn(c.type),qr(c),null;case 19:if(M(fs),p=c.memoizedState,p===null)return qr(c),null;if(j=(c.flags&128)!==0,R=p.rendering,R===null)if(j)Ru(p,!1);else{if(ss!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(R=Uf(i),R!==null){for(c.flags|=128,Ru(p,!1),i=R.updateQueue,c.updateQueue=i,Qf(c,i),c.subtreeFlags=0,i=f,f=c.child;f!==null;)rw(f,i),f=f.sibling;return Y(fs,fs.current&1|2),hr&&Yn(c,p.treeForkCount),c.child}i=i.sibling}p.tail!==null&&Me()>ah&&(c.flags|=128,j=!0,Ru(p,!1),c.lanes=4194304)}else{if(!j)if(i=Uf(R),i!==null){if(c.flags|=128,j=!0,i=i.updateQueue,c.updateQueue=i,Qf(c,i),Ru(p,!0),p.tail===null&&p.tailMode==="hidden"&&!R.alternate&&!hr)return qr(c),null}else 2*Me()-p.renderingStartTime>ah&&f!==536870912&&(c.flags|=128,j=!0,Ru(p,!1),c.lanes=4194304);p.isBackwards?(R.sibling=c.child,c.child=R):(i=p.last,i!==null?i.sibling=R:c.child=R,p.last=R)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=Me(),i.sibling=null,f=fs.current,Y(fs,j?f&1|2:f&1),hr&&Yn(c,p.treeForkCount),i):(qr(c),null);case 22:case 23:return Ra(c),fp(),p=c.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(c.flags|=8192):p&&(c.flags|=8192),p?(f&536870912)!==0&&(c.flags&128)===0&&(qr(c),c.subtreeFlags&6&&(c.flags|=8192)):qr(c),f=c.updateQueue,f!==null&&Qf(c,f.retryQueue),f=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==f&&(c.flags|=2048),i!==null&&M(Do),null;case 24:return f=null,i!==null&&(f=i.memoizedState.cache),c.memoizedState.cache!==f&&(c.flags|=2048),Zn(vs),qr(c),null;case 25:return null;case 30:return null}throw Error(s(156,c.tag))}function lA(i,c){switch(Jm(c),c.tag){case 1:return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return Zn(vs),le(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 26:case 27:case 5:return ie(c),null;case 31:if(c.memoizedState!==null){if(Ra(c),c.alternate===null)throw Error(s(340));Ao()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 13:if(Ra(c),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(s(340));Ao()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return M(fs),null;case 4:return le(),null;case 10:return Zn(c.type),null;case 22:case 23:return Ra(c),fp(),i!==null&&M(Do),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 24:return Zn(vs),null;case 25:return null;default:return null}}function A_(i,c){switch(Jm(c),c.tag){case 3:Zn(vs),le();break;case 26:case 27:case 5:ie(c);break;case 4:le();break;case 31:c.memoizedState!==null&&Ra(c);break;case 13:Ra(c);break;case 19:M(fs);break;case 10:Zn(c.type);break;case 22:case 23:Ra(c),fp(),i!==null&&M(Do);break;case 24:Zn(vs)}}function Du(i,c){try{var f=c.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var j=p.next;f=j;do{if((f.tag&i)===i){p=void 0;var R=f.create,Z=f.inst;p=R(),Z.destroy=p}f=f.next}while(f!==j)}}catch(ge){jr(c,c.return,ge)}}function Hi(i,c,f){try{var p=c.updateQueue,j=p!==null?p.lastEffect:null;if(j!==null){var R=j.next;p=R;do{if((p.tag&i)===i){var Z=p.inst,ge=Z.destroy;if(ge!==void 0){Z.destroy=void 0,j=c;var Fe=f,Ve=ge;try{Ve()}catch(it){jr(j,Fe,it)}}}p=p.next}while(p!==R)}}catch(it){jr(c,c.return,it)}}function C_(i){var c=i.updateQueue;if(c!==null){var f=i.stateNode;try{bw(c,f)}catch(p){jr(i,i.return,p)}}}function R_(i,c,f){f.props=Mo(i.type,i.memoizedProps),f.state=i.memoizedState;try{f.componentWillUnmount()}catch(p){jr(i,c,p)}}function Ou(i,c){try{var f=i.ref;if(f!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof f=="function"?i.refCleanup=f(p):f.current=p}}catch(j){jr(i,c,j)}}function Rn(i,c){var f=i.ref,p=i.refCleanup;if(f!==null)if(typeof p=="function")try{p()}catch(j){jr(i,c,j)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(j){jr(i,c,j)}else f.current=null}function D_(i){var c=i.type,f=i.memoizedProps,p=i.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":f.autoFocus&&p.focus();break e;case"img":f.src?p.src=f.src:f.srcSet&&(p.srcset=f.srcSet)}}catch(j){jr(i,i.return,j)}}function Hp(i,c,f){try{var p=i.stateNode;CA(p,i.type,f,c),p[ke]=c}catch(j){jr(i,i.return,j)}}function O_(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ji(i.type)||i.tag===4}function Wp(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||O_(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ji(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Gp(i,c,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,c?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(i,c):(c=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,c.appendChild(i),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=Vn));else if(p!==4&&(p===27&&Ji(i.type)&&(f=i.stateNode,c=null),i=i.child,i!==null))for(Gp(i,c,f),i=i.sibling;i!==null;)Gp(i,c,f),i=i.sibling}function eh(i,c,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,c?f.insertBefore(i,c):f.appendChild(i);else if(p!==4&&(p===27&&Ji(i.type)&&(f=i.stateNode),i=i.child,i!==null))for(eh(i,c,f),i=i.sibling;i!==null;)eh(i,c,f),i=i.sibling}function F_(i){var c=i.stateNode,f=i.memoizedProps;try{for(var p=i.type,j=c.attributes;j.length;)c.removeAttributeNode(j[0]);zs(c,p,f),c[be]=i,c[ke]=f}catch(R){jr(i,i.return,R)}}var si=!1,_s=!1,Vp=!1,L_=typeof WeakSet=="function"?WeakSet:Set,Ds=null;function cA(i,c){if(i=i.containerInfo,mx=wh,i=Vb(i),Um(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else e:{f=(f=i.ownerDocument)&&f.defaultView||window;var p=f.getSelection&&f.getSelection();if(p&&p.rangeCount!==0){f=p.anchorNode;var j=p.anchorOffset,R=p.focusNode;p=p.focusOffset;try{f.nodeType,R.nodeType}catch{f=null;break e}var Z=0,ge=-1,Fe=-1,Ve=0,it=0,ut=i,Xe=null;t:for(;;){for(var Ze;ut!==f||j!==0&&ut.nodeType!==3||(ge=Z+j),ut!==R||p!==0&&ut.nodeType!==3||(Fe=Z+p),ut.nodeType===3&&(Z+=ut.nodeValue.length),(Ze=ut.firstChild)!==null;)Xe=ut,ut=Ze;for(;;){if(ut===i)break t;if(Xe===f&&++Ve===j&&(ge=Z),Xe===R&&++it===p&&(Fe=Z),(Ze=ut.nextSibling)!==null)break;ut=Xe,Xe=ut.parentNode}ut=Ze}f=ge===-1||Fe===-1?null:{start:ge,end:Fe}}else f=null}f=f||{start:0,end:0}}else f=null;for(px={focusedElem:i,selectionRange:f},wh=!1,Ds=c;Ds!==null;)if(c=Ds,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,Ds=i;else for(;Ds!==null;){switch(c=Ds,R=c.alternate,i=c.flags,c.tag){case 0:if((i&4)!==0&&(i=c.updateQueue,i=i!==null?i.events:null,i!==null))for(f=0;f<i.length;f++)j=i[f],j.ref.impl=j.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&R!==null){i=void 0,f=c,j=R.memoizedProps,R=R.memoizedState,p=f.stateNode;try{var Rt=Mo(f.type,j);i=p.getSnapshotBeforeUpdate(Rt,R),p.__reactInternalSnapshotBeforeUpdate=i}catch($t){jr(f,f.return,$t)}}break;case 3:if((i&1024)!==0){if(i=c.stateNode.containerInfo,f=i.nodeType,f===9)yx(i);else if(f===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":yx(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(s(163))}if(i=c.sibling,i!==null){i.return=c.return,Ds=i;break}Ds=c.return}}function I_(i,c,f){var p=f.flags;switch(f.tag){case 0:case 11:case 15:ni(i,f),p&4&&Du(5,f);break;case 1:if(ni(i,f),p&4)if(i=f.stateNode,c===null)try{i.componentDidMount()}catch(Z){jr(f,f.return,Z)}else{var j=Mo(f.type,c.memoizedProps);c=c.memoizedState;try{i.componentDidUpdate(j,c,i.__reactInternalSnapshotBeforeUpdate)}catch(Z){jr(f,f.return,Z)}}p&64&&C_(f),p&512&&Ou(f,f.return);break;case 3:if(ni(i,f),p&64&&(i=f.updateQueue,i!==null)){if(c=null,f.child!==null)switch(f.child.tag){case 27:case 5:c=f.child.stateNode;break;case 1:c=f.child.stateNode}try{bw(i,c)}catch(Z){jr(f,f.return,Z)}}break;case 27:c===null&&p&4&&F_(f);case 26:case 5:ni(i,f),c===null&&p&4&&D_(f),p&512&&Ou(f,f.return);break;case 12:ni(i,f);break;case 31:ni(i,f),p&4&&P_(i,f);break;case 13:ni(i,f),p&4&&U_(i,f),p&64&&(i=f.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(f=yA.bind(null,f),BA(i,f))));break;case 22:if(p=f.memoizedState!==null||si,!p){c=c!==null&&c.memoizedState!==null||_s,j=si;var R=_s;si=p,(_s=c)&&!R?ii(i,f,(f.subtreeFlags&8772)!==0):ni(i,f),si=j,_s=R}break;case 30:break;default:ni(i,f)}}function M_(i){var c=i.alternate;c!==null&&(i.alternate=null,M_(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&ft(c)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Xr=null,ga=!1;function ai(i,c,f){for(f=f.child;f!==null;)B_(i,c,f),f=f.sibling}function B_(i,c,f){if(Ct&&typeof Ct.onCommitFiberUnmount=="function")try{Ct.onCommitFiberUnmount(wt,f)}catch{}switch(f.tag){case 26:_s||Rn(f,c),ai(i,c,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:_s||Rn(f,c);var p=Xr,j=ga;Ji(f.type)&&(Xr=f.stateNode,ga=!1),ai(i,c,f),$u(f.stateNode),Xr=p,ga=j;break;case 5:_s||Rn(f,c);case 6:if(p=Xr,j=ga,Xr=null,ai(i,c,f),Xr=p,ga=j,Xr!==null)if(ga)try{(Xr.nodeType===9?Xr.body:Xr.nodeName==="HTML"?Xr.ownerDocument.body:Xr).removeChild(f.stateNode)}catch(R){jr(f,c,R)}else try{Xr.removeChild(f.stateNode)}catch(R){jr(f,c,R)}break;case 18:Xr!==null&&(ga?(i=Xr,C2(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,f.stateNode),oc(i)):C2(Xr,f.stateNode));break;case 4:p=Xr,j=ga,Xr=f.stateNode.containerInfo,ga=!0,ai(i,c,f),Xr=p,ga=j;break;case 0:case 11:case 14:case 15:Hi(2,f,c),_s||Hi(4,f,c),ai(i,c,f);break;case 1:_s||(Rn(f,c),p=f.stateNode,typeof p.componentWillUnmount=="function"&&R_(f,c,p)),ai(i,c,f);break;case 21:ai(i,c,f);break;case 22:_s=(p=_s)||f.memoizedState!==null,ai(i,c,f),_s=p;break;default:ai(i,c,f)}}function P_(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{oc(i)}catch(f){jr(c,c.return,f)}}}function U_(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{oc(i)}catch(f){jr(c,c.return,f)}}function uA(i){switch(i.tag){case 31:case 13:case 19:var c=i.stateNode;return c===null&&(c=i.stateNode=new L_),c;case 22:return i=i.stateNode,c=i._retryCache,c===null&&(c=i._retryCache=new L_),c;default:throw Error(s(435,i.tag))}}function th(i,c){var f=uA(i);c.forEach(function(p){if(!f.has(p)){f.add(p);var j=vA.bind(null,i,p);p.then(j,j)}})}function ya(i,c){var f=c.deletions;if(f!==null)for(var p=0;p<f.length;p++){var j=f[p],R=i,Z=c,ge=Z;e:for(;ge!==null;){switch(ge.tag){case 27:if(Ji(ge.type)){Xr=ge.stateNode,ga=!1;break e}break;case 5:Xr=ge.stateNode,ga=!1;break e;case 3:case 4:Xr=ge.stateNode.containerInfo,ga=!0;break e}ge=ge.return}if(Xr===null)throw Error(s(160));B_(R,Z,j),Xr=null,ga=!1,R=j.alternate,R!==null&&(R.return=null),j.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)z_(c,i),c=c.sibling}var gn=null;function z_(i,c){var f=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ya(c,i),va(i),p&4&&(Hi(3,i,i.return),Du(3,i),Hi(5,i,i.return));break;case 1:ya(c,i),va(i),p&512&&(_s||f===null||Rn(f,f.return)),p&64&&si&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(f=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=f===null?p:f.concat(p))));break;case 26:var j=gn;if(ya(c,i),va(i),p&512&&(_s||f===null||Rn(f,f.return)),p&4){var R=f!==null?f.memoizedState:null;if(p=i.memoizedState,f===null)if(p===null)if(i.stateNode===null){e:{p=i.type,f=i.memoizedProps,j=j.ownerDocument||j;t:switch(p){case"title":R=j.getElementsByTagName("title")[0],(!R||R[Ke]||R[be]||R.namespaceURI==="http://www.w3.org/2000/svg"||R.hasAttribute("itemprop"))&&(R=j.createElement(p),j.head.insertBefore(R,j.querySelector("head > title"))),zs(R,p,f),R[be]=i,Ie(R),p=R;break e;case"link":var Z=z2("link","href",j).get(p+(f.href||""));if(Z){for(var ge=0;ge<Z.length;ge++)if(R=Z[ge],R.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&R.getAttribute("rel")===(f.rel==null?null:f.rel)&&R.getAttribute("title")===(f.title==null?null:f.title)&&R.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){Z.splice(ge,1);break t}}R=j.createElement(p),zs(R,p,f),j.head.appendChild(R);break;case"meta":if(Z=z2("meta","content",j).get(p+(f.content||""))){for(ge=0;ge<Z.length;ge++)if(R=Z[ge],R.getAttribute("content")===(f.content==null?null:""+f.content)&&R.getAttribute("name")===(f.name==null?null:f.name)&&R.getAttribute("property")===(f.property==null?null:f.property)&&R.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&R.getAttribute("charset")===(f.charSet==null?null:f.charSet)){Z.splice(ge,1);break t}}R=j.createElement(p),zs(R,p,f),j.head.appendChild(R);break;default:throw Error(s(468,p))}R[be]=i,Ie(R),p=R}i.stateNode=p}else $2(j,i.type,i.stateNode);else i.stateNode=U2(j,p,i.memoizedProps);else R!==p?(R===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):R.count--,p===null?$2(j,i.type,i.stateNode):U2(j,p,i.memoizedProps)):p===null&&i.stateNode!==null&&Hp(i,i.memoizedProps,f.memoizedProps)}break;case 27:ya(c,i),va(i),p&512&&(_s||f===null||Rn(f,f.return)),f!==null&&p&4&&Hp(i,i.memoizedProps,f.memoizedProps);break;case 5:if(ya(c,i),va(i),p&512&&(_s||f===null||Rn(f,f.return)),i.flags&32){j=i.stateNode;try{Cl(j,"")}catch(Rt){jr(i,i.return,Rt)}}p&4&&i.stateNode!=null&&(j=i.memoizedProps,Hp(i,j,f!==null?f.memoizedProps:j)),p&1024&&(Vp=!0);break;case 6:if(ya(c,i),va(i),p&4){if(i.stateNode===null)throw Error(s(162));p=i.memoizedProps,f=i.stateNode;try{f.nodeValue=p}catch(Rt){jr(i,i.return,Rt)}}break;case 3:if(gh=null,j=gn,gn=ph(c.containerInfo),ya(c,i),gn=j,va(i),p&4&&f!==null&&f.memoizedState.isDehydrated)try{oc(c.containerInfo)}catch(Rt){jr(i,i.return,Rt)}Vp&&(Vp=!1,$_(i));break;case 4:p=gn,gn=ph(i.stateNode.containerInfo),ya(c,i),va(i),gn=p;break;case 12:ya(c,i),va(i);break;case 31:ya(c,i),va(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,th(i,p)));break;case 13:ya(c,i),va(i),i.child.flags&8192&&i.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(sh=Me()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,th(i,p)));break;case 22:j=i.memoizedState!==null;var Fe=f!==null&&f.memoizedState!==null,Ve=si,it=_s;if(si=Ve||j,_s=it||Fe,ya(c,i),_s=it,si=Ve,va(i),p&8192)e:for(c=i.stateNode,c._visibility=j?c._visibility&-2:c._visibility|1,j&&(f===null||Fe||si||_s||Bo(i)),f=null,c=i;;){if(c.tag===5||c.tag===26){if(f===null){Fe=f=c;try{if(R=Fe.stateNode,j)Z=R.style,typeof Z.setProperty=="function"?Z.setProperty("display","none","important"):Z.display="none";else{ge=Fe.stateNode;var ut=Fe.memoizedProps.style,Xe=ut!=null&&ut.hasOwnProperty("display")?ut.display:null;ge.style.display=Xe==null||typeof Xe=="boolean"?"":(""+Xe).trim()}}catch(Rt){jr(Fe,Fe.return,Rt)}}}else if(c.tag===6){if(f===null){Fe=c;try{Fe.stateNode.nodeValue=j?"":Fe.memoizedProps}catch(Rt){jr(Fe,Fe.return,Rt)}}}else if(c.tag===18){if(f===null){Fe=c;try{var Ze=Fe.stateNode;j?R2(Ze,!0):R2(Fe.stateNode,!1)}catch(Rt){jr(Fe,Fe.return,Rt)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===i)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break e;for(;c.sibling===null;){if(c.return===null||c.return===i)break e;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}p&4&&(p=i.updateQueue,p!==null&&(f=p.retryQueue,f!==null&&(p.retryQueue=null,th(i,f))));break;case 19:ya(c,i),va(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,th(i,p)));break;case 30:break;case 21:break;default:ya(c,i),va(i)}}function va(i){var c=i.flags;if(c&2){try{for(var f,p=i.return;p!==null;){if(O_(p)){f=p;break}p=p.return}if(f==null)throw Error(s(160));switch(f.tag){case 27:var j=f.stateNode,R=Wp(i);eh(i,R,j);break;case 5:var Z=f.stateNode;f.flags&32&&(Cl(Z,""),f.flags&=-33);var ge=Wp(i);eh(i,ge,Z);break;case 3:case 4:var Fe=f.stateNode.containerInfo,Ve=Wp(i);Gp(i,Ve,Fe);break;default:throw Error(s(161))}}catch(it){jr(i,i.return,it)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function $_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var c=i;$_(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),i=i.sibling}}function ni(i,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)I_(i,c.alternate,c),c=c.sibling}function Bo(i){for(i=i.child;i!==null;){var c=i;switch(c.tag){case 0:case 11:case 14:case 15:Hi(4,c,c.return),Bo(c);break;case 1:Rn(c,c.return);var f=c.stateNode;typeof f.componentWillUnmount=="function"&&R_(c,c.return,f),Bo(c);break;case 27:$u(c.stateNode);case 26:case 5:Rn(c,c.return),Bo(c);break;case 22:c.memoizedState===null&&Bo(c);break;case 30:Bo(c);break;default:Bo(c)}i=i.sibling}}function ii(i,c,f){for(f=f&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var p=c.alternate,j=i,R=c,Z=R.flags;switch(R.tag){case 0:case 11:case 15:ii(j,R,f),Du(4,R);break;case 1:if(ii(j,R,f),p=R,j=p.stateNode,typeof j.componentDidMount=="function")try{j.componentDidMount()}catch(Ve){jr(p,p.return,Ve)}if(p=R,j=p.updateQueue,j!==null){var ge=p.stateNode;try{var Fe=j.shared.hiddenCallbacks;if(Fe!==null)for(j.shared.hiddenCallbacks=null,j=0;j<Fe.length;j++)vw(Fe[j],ge)}catch(Ve){jr(p,p.return,Ve)}}f&&Z&64&&C_(R),Ou(R,R.return);break;case 27:F_(R);case 26:case 5:ii(j,R,f),f&&p===null&&Z&4&&D_(R),Ou(R,R.return);break;case 12:ii(j,R,f);break;case 31:ii(j,R,f),f&&Z&4&&P_(j,R);break;case 13:ii(j,R,f),f&&Z&4&&U_(j,R);break;case 22:R.memoizedState===null&&ii(j,R,f),Ou(R,R.return);break;case 30:break;default:ii(j,R,f)}c=c.sibling}}function Kp(i,c){var f=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),i=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(i=c.memoizedState.cachePool.pool),i!==f&&(i!=null&&i.refCount++,f!=null&&vu(f))}function Xp(i,c){i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&vu(i))}function yn(i,c,f,p){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)q_(i,c,f,p),c=c.sibling}function q_(i,c,f,p){var j=c.flags;switch(c.tag){case 0:case 11:case 15:yn(i,c,f,p),j&2048&&Du(9,c);break;case 1:yn(i,c,f,p);break;case 3:yn(i,c,f,p),j&2048&&(i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&vu(i)));break;case 12:if(j&2048){yn(i,c,f,p),i=c.stateNode;try{var R=c.memoizedProps,Z=R.id,ge=R.onPostCommit;typeof ge=="function"&&ge(Z,c.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Fe){jr(c,c.return,Fe)}}else yn(i,c,f,p);break;case 31:yn(i,c,f,p);break;case 13:yn(i,c,f,p);break;case 23:break;case 22:R=c.stateNode,Z=c.alternate,c.memoizedState!==null?R._visibility&2?yn(i,c,f,p):Fu(i,c):R._visibility&2?yn(i,c,f,p):(R._visibility|=2,Yl(i,c,f,p,(c.subtreeFlags&10256)!==0||!1)),j&2048&&Kp(Z,c);break;case 24:yn(i,c,f,p),j&2048&&Xp(c.alternate,c);break;default:yn(i,c,f,p)}}function Yl(i,c,f,p,j){for(j=j&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var R=i,Z=c,ge=f,Fe=p,Ve=Z.flags;switch(Z.tag){case 0:case 11:case 15:Yl(R,Z,ge,Fe,j),Du(8,Z);break;case 23:break;case 22:var it=Z.stateNode;Z.memoizedState!==null?it._visibility&2?Yl(R,Z,ge,Fe,j):Fu(R,Z):(it._visibility|=2,Yl(R,Z,ge,Fe,j)),j&&Ve&2048&&Kp(Z.alternate,Z);break;case 24:Yl(R,Z,ge,Fe,j),j&&Ve&2048&&Xp(Z.alternate,Z);break;default:Yl(R,Z,ge,Fe,j)}c=c.sibling}}function Fu(i,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var f=i,p=c,j=p.flags;switch(p.tag){case 22:Fu(f,p),j&2048&&Kp(p.alternate,p);break;case 24:Fu(f,p),j&2048&&Xp(p.alternate,p);break;default:Fu(f,p)}c=c.sibling}}var Lu=8192;function Jl(i,c,f){if(i.subtreeFlags&Lu)for(i=i.child;i!==null;)H_(i,c,f),i=i.sibling}function H_(i,c,f){switch(i.tag){case 26:Jl(i,c,f),i.flags&Lu&&i.memoizedState!==null&&YA(f,gn,i.memoizedState,i.memoizedProps);break;case 5:Jl(i,c,f);break;case 3:case 4:var p=gn;gn=ph(i.stateNode.containerInfo),Jl(i,c,f),gn=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=Lu,Lu=16777216,Jl(i,c,f),Lu=p):Jl(i,c,f));break;default:Jl(i,c,f)}}function W_(i){var c=i.alternate;if(c!==null&&(i=c.child,i!==null)){c.child=null;do c=i.sibling,i.sibling=null,i=c;while(i!==null)}}function Iu(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];Ds=p,V_(p,i)}W_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)G_(i),i=i.sibling}function G_(i){switch(i.tag){case 0:case 11:case 15:Iu(i),i.flags&2048&&Hi(9,i,i.return);break;case 3:Iu(i);break;case 12:Iu(i);break;case 22:var c=i.stateNode;i.memoizedState!==null&&c._visibility&2&&(i.return===null||i.return.tag!==13)?(c._visibility&=-3,rh(i)):Iu(i);break;default:Iu(i)}}function rh(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];Ds=p,V_(p,i)}W_(i)}for(i=i.child;i!==null;){switch(c=i,c.tag){case 0:case 11:case 15:Hi(8,c,c.return),rh(c);break;case 22:f=c.stateNode,f._visibility&2&&(f._visibility&=-3,rh(c));break;default:rh(c)}i=i.sibling}}function V_(i,c){for(;Ds!==null;){var f=Ds;switch(f.tag){case 0:case 11:case 15:Hi(8,f,c);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var p=f.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:vu(f.memoizedState.cache)}if(p=f.child,p!==null)p.return=f,Ds=p;else e:for(f=i;Ds!==null;){p=Ds;var j=p.sibling,R=p.return;if(M_(p),p===f){Ds=null;break e}if(j!==null){j.return=R,Ds=j;break e}Ds=R}}}var dA={getCacheForType:function(i){var c=Ps(vs),f=c.data.get(i);return f===void 0&&(f=i(),c.data.set(i,f)),f},cacheSignal:function(){return Ps(vs).controller.signal}},fA=typeof WeakMap=="function"?WeakMap:Map,Nr=0,Pr=null,or=null,cr=0,Er=0,Da=null,Wi=!1,Zl=!1,Yp=!1,oi=0,ss=0,Gi=0,Po=0,Jp=0,Oa=0,Ql=0,Mu=null,ba=null,Zp=!1,sh=0,K_=0,ah=1/0,nh=null,Vi=null,Ts=0,Ki=null,ec=null,li=0,Qp=0,ex=null,X_=null,Bu=0,tx=null;function Fa(){return(Nr&2)!==0&&cr!==0?cr&-cr:Q.T!==null?ox():he()}function Y_(){if(Oa===0)if((cr&536870912)===0||hr){var i=xe;xe<<=1,(xe&3932160)===0&&(xe=262144),Oa=i}else Oa=536870912;return i=Ca.current,i!==null&&(i.flags|=32),Oa}function wa(i,c,f){(i===Pr&&(Er===2||Er===9)||i.cancelPendingCommit!==null)&&(tc(i,0),Xi(i,cr,Oa,!1)),Vt(i,f),((Nr&2)===0||i!==Pr)&&(i===Pr&&((Nr&2)===0&&(Po|=f),ss===4&&Xi(i,cr,Oa,!1)),Dn(i))}function J_(i,c,f){if((Nr&6)!==0)throw Error(s(327));var p=!f&&(c&127)===0&&(c&i.expiredLanes)===0||Ue(i,c),j=p?pA(i,c):sx(i,c,!0),R=p;do{if(j===0){Zl&&!p&&Xi(i,c,0,!1);break}else{if(f=i.current.alternate,R&&!hA(f)){j=sx(i,c,!1),R=!1;continue}if(j===2){if(R=c,i.errorRecoveryDisabledLanes&R)var Z=0;else Z=i.pendingLanes&-536870913,Z=Z!==0?Z:Z&536870912?536870912:0;if(Z!==0){c=Z;e:{var ge=i;j=Mu;var Fe=ge.current.memoizedState.isDehydrated;if(Fe&&(tc(ge,Z).flags|=256),Z=sx(ge,Z,!1),Z!==2){if(Yp&&!Fe){ge.errorRecoveryDisabledLanes|=R,Po|=R,j=4;break e}R=ba,ba=j,R!==null&&(ba===null?ba=R:ba.push.apply(ba,R))}j=Z}if(R=!1,j!==2)continue}}if(j===1){tc(i,0),Xi(i,c,0,!0);break}e:{switch(p=i,R=j,R){case 0:case 1:throw Error(s(345));case 4:if((c&4194048)!==c)break;case 6:Xi(p,c,Oa,!Wi);break e;case 2:ba=null;break;case 3:case 5:break;default:throw Error(s(329))}if((c&62914560)===c&&(j=sh+300-Me(),10<j)){if(Xi(p,c,Oa,!Wi),Oe(p,0,!0)!==0)break e;li=c,p.timeoutHandle=T2(Z_.bind(null,p,f,ba,nh,Zp,c,Oa,Po,Ql,Wi,R,"Throttled",-0,0),j);break e}Z_(p,f,ba,nh,Zp,c,Oa,Po,Ql,Wi,R,null,-0,0)}}break}while(!0);Dn(i)}function Z_(i,c,f,p,j,R,Z,ge,Fe,Ve,it,ut,Xe,Ze){if(i.timeoutHandle=-1,ut=c.subtreeFlags,ut&8192||(ut&16785408)===16785408){ut={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Vn},H_(c,R,ut);var Rt=(R&62914560)===R?sh-Me():(R&4194048)===R?K_-Me():0;if(Rt=JA(ut,Rt),Rt!==null){li=R,i.cancelPendingCommit=Rt(i2.bind(null,i,c,R,f,p,j,Z,ge,Fe,it,ut,null,Xe,Ze)),Xi(i,R,Z,!Ve);return}}i2(i,c,R,f,p,j,Z,ge,Fe)}function hA(i){for(var c=i;;){var f=c.tag;if((f===0||f===11||f===15)&&c.flags&16384&&(f=c.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var p=0;p<f.length;p++){var j=f[p],R=j.getSnapshot;j=j.value;try{if(!Ta(R(),j))return!1}catch{return!1}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Xi(i,c,f,p){c&=~Jp,c&=~Po,i.suspendedLanes|=c,i.pingedLanes&=~c,p&&(i.warmLanes|=c),p=i.expirationTimes;for(var j=c;0<j;){var R=31-Le(j),Z=1<<R;p[R]=-1,j&=~Z}f!==0&&_r(i,f,c)}function ih(){return(Nr&6)===0?(Pu(0),!1):!0}function rx(){if(or!==null){if(Er===0)var i=or.return;else i=or,Jn=Co=null,yp(i),Wl=null,wu=0,i=or;for(;i!==null;)A_(i.alternate,i),i=i.return;or=null}}function tc(i,c){var f=i.timeoutHandle;f!==-1&&(i.timeoutHandle=-1,OA(f)),f=i.cancelPendingCommit,f!==null&&(i.cancelPendingCommit=null,f()),li=0,rx(),Pr=i,or=f=Xn(i.current,null),cr=c,Er=0,Da=null,Wi=!1,Zl=Ue(i,c),Yp=!1,Ql=Oa=Jp=Po=Gi=ss=0,ba=Mu=null,Zp=!1,(c&8)!==0&&(c|=c&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=c;0<p;){var j=31-Le(p),R=1<<j;c|=i[j],p&=~R}return oi=c,jf(),f}function Q_(i,c){Yt=null,Q.H=Au,c===Hl||c===Lf?(c=pw(),Er=3):c===ip?(c=pw(),Er=4):Er=c===Fp?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Da=c,or===null&&(ss=1,Xf(i,Ya(c,i.current)))}function e2(){var i=Ca.current;return i===null?!0:(cr&4194048)===cr?en===null:(cr&62914560)===cr||(cr&536870912)!==0?i===en:!1}function t2(){var i=Q.H;return Q.H=Au,i===null?Au:i}function r2(){var i=Q.A;return Q.A=dA,i}function oh(){ss=4,Wi||(cr&4194048)!==cr&&Ca.current!==null||(Zl=!0),(Gi&134217727)===0&&(Po&134217727)===0||Pr===null||Xi(Pr,cr,Oa,!1)}function sx(i,c,f){var p=Nr;Nr|=2;var j=t2(),R=r2();(Pr!==i||cr!==c)&&(nh=null,tc(i,c)),c=!1;var Z=ss;e:do try{if(Er!==0&&or!==null){var ge=or,Fe=Da;switch(Er){case 8:rx(),Z=6;break e;case 3:case 2:case 9:case 6:Ca.current===null&&(c=!0);var Ve=Er;if(Er=0,Da=null,rc(i,ge,Fe,Ve),f&&Zl){Z=0;break e}break;default:Ve=Er,Er=0,Da=null,rc(i,ge,Fe,Ve)}}mA(),Z=ss;break}catch(it){Q_(i,it)}while(!0);return c&&i.shellSuspendCounter++,Jn=Co=null,Nr=p,Q.H=j,Q.A=R,or===null&&(Pr=null,cr=0,jf()),Z}function mA(){for(;or!==null;)s2(or)}function pA(i,c){var f=Nr;Nr|=2;var p=t2(),j=r2();Pr!==i||cr!==c?(nh=null,ah=Me()+500,tc(i,c)):Zl=Ue(i,c);e:do try{if(Er!==0&&or!==null){c=or;var R=Da;t:switch(Er){case 1:Er=0,Da=null,rc(i,c,R,1);break;case 2:case 9:if(hw(R)){Er=0,Da=null,a2(c);break}c=function(){Er!==2&&Er!==9||Pr!==i||(Er=7),Dn(i)},R.then(c,c);break e;case 3:Er=7;break e;case 4:Er=5;break e;case 7:hw(R)?(Er=0,Da=null,a2(c)):(Er=0,Da=null,rc(i,c,R,7));break;case 5:var Z=null;switch(or.tag){case 26:Z=or.memoizedState;case 5:case 27:var ge=or;if(Z?q2(Z):ge.stateNode.complete){Er=0,Da=null;var Fe=ge.sibling;if(Fe!==null)or=Fe;else{var Ve=ge.return;Ve!==null?(or=Ve,lh(Ve)):or=null}break t}}Er=0,Da=null,rc(i,c,R,5);break;case 6:Er=0,Da=null,rc(i,c,R,6);break;case 8:rx(),ss=6;break e;default:throw Error(s(462))}}xA();break}catch(it){Q_(i,it)}while(!0);return Jn=Co=null,Q.H=p,Q.A=j,Nr=f,or!==null?0:(Pr=null,cr=0,jf(),ss)}function xA(){for(;or!==null&&!oe();)s2(or)}function s2(i){var c=j_(i.alternate,i,oi);i.memoizedProps=i.pendingProps,c===null?lh(i):or=c}function a2(i){var c=i,f=c.alternate;switch(c.tag){case 15:case 0:c=w_(f,c,c.pendingProps,c.type,void 0,cr);break;case 11:c=w_(f,c,c.pendingProps,c.type.render,c.ref,cr);break;case 5:yp(c);default:A_(f,c),c=or=rw(c,oi),c=j_(f,c,oi)}i.memoizedProps=i.pendingProps,c===null?lh(i):or=c}function rc(i,c,f,p){Jn=Co=null,yp(c),Wl=null,wu=0;var j=c.return;try{if(aA(i,j,c,f,cr)){ss=1,Xf(i,Ya(f,i.current)),or=null;return}}catch(R){if(j!==null)throw or=j,R;ss=1,Xf(i,Ya(f,i.current)),or=null;return}c.flags&32768?(hr||p===1?i=!0:Zl||(cr&536870912)!==0?i=!1:(Wi=i=!0,(p===2||p===9||p===3||p===6)&&(p=Ca.current,p!==null&&p.tag===13&&(p.flags|=16384))),n2(c,i)):lh(c)}function lh(i){var c=i;do{if((c.flags&32768)!==0){n2(c,Wi);return}i=c.return;var f=oA(c.alternate,c,oi);if(f!==null){or=f;return}if(c=c.sibling,c!==null){or=c;return}or=c=i}while(c!==null);ss===0&&(ss=5)}function n2(i,c){do{var f=lA(i.alternate,i);if(f!==null){f.flags&=32767,or=f;return}if(f=i.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!c&&(i=i.sibling,i!==null)){or=i;return}or=i=f}while(i!==null);ss=6,or=null}function i2(i,c,f,p,j,R,Z,ge,Fe){i.cancelPendingCommit=null;do ch();while(Ts!==0);if((Nr&6)!==0)throw Error(s(327));if(c!==null){if(c===i.current)throw Error(s(177));if(R=c.lanes|c.childLanes,R|=Wm,yr(i,f,R,Z,ge,Fe),i===Pr&&(or=Pr=null,cr=0),ec=c,Ki=i,li=f,Qp=R,ex=j,X_=p,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,bA(He,function(){return d2(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||p){p=Q.T,Q.T=null,j=te.p,te.p=2,Z=Nr,Nr|=4;try{cA(i,c,f)}finally{Nr=Z,te.p=j,Q.T=p}}Ts=1,o2(),l2(),c2()}}function o2(){if(Ts===1){Ts=0;var i=Ki,c=ec,f=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||f){f=Q.T,Q.T=null;var p=te.p;te.p=2;var j=Nr;Nr|=4;try{z_(c,i);var R=px,Z=Vb(i.containerInfo),ge=R.focusedElem,Fe=R.selectionRange;if(Z!==ge&&ge&&ge.ownerDocument&&Gb(ge.ownerDocument.documentElement,ge)){if(Fe!==null&&Um(ge)){var Ve=Fe.start,it=Fe.end;if(it===void 0&&(it=Ve),"selectionStart"in ge)ge.selectionStart=Ve,ge.selectionEnd=Math.min(it,ge.value.length);else{var ut=ge.ownerDocument||document,Xe=ut&&ut.defaultView||window;if(Xe.getSelection){var Ze=Xe.getSelection(),Rt=ge.textContent.length,$t=Math.min(Fe.start,Rt),Fr=Fe.end===void 0?$t:Math.min(Fe.end,Rt);!Ze.extend&&$t>Fr&&(Z=Fr,Fr=$t,$t=Z);var ze=Wb(ge,$t),Be=Wb(ge,Fr);if(ze&&Be&&(Ze.rangeCount!==1||Ze.anchorNode!==ze.node||Ze.anchorOffset!==ze.offset||Ze.focusNode!==Be.node||Ze.focusOffset!==Be.offset)){var Ge=ut.createRange();Ge.setStart(ze.node,ze.offset),Ze.removeAllRanges(),$t>Fr?(Ze.addRange(Ge),Ze.extend(Be.node,Be.offset)):(Ge.setEnd(Be.node,Be.offset),Ze.addRange(Ge))}}}}for(ut=[],Ze=ge;Ze=Ze.parentNode;)Ze.nodeType===1&&ut.push({element:Ze,left:Ze.scrollLeft,top:Ze.scrollTop});for(typeof ge.focus=="function"&&ge.focus(),ge=0;ge<ut.length;ge++){var lt=ut[ge];lt.element.scrollLeft=lt.left,lt.element.scrollTop=lt.top}}wh=!!mx,px=mx=null}finally{Nr=j,te.p=p,Q.T=f}}i.current=c,Ts=2}}function l2(){if(Ts===2){Ts=0;var i=Ki,c=ec,f=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||f){f=Q.T,Q.T=null;var p=te.p;te.p=2;var j=Nr;Nr|=4;try{I_(i,c.alternate,c)}finally{Nr=j,te.p=p,Q.T=f}}Ts=3}}function c2(){if(Ts===4||Ts===3){Ts=0,Te();var i=Ki,c=ec,f=li,p=X_;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Ts=5:(Ts=0,ec=Ki=null,u2(i,i.pendingLanes));var j=i.pendingLanes;if(j===0&&(Vi=null),Jr(f),c=c.stateNode,Ct&&typeof Ct.onCommitFiberRoot=="function")try{Ct.onCommitFiberRoot(wt,c,void 0,(c.current.flags&128)===128)}catch{}if(p!==null){c=Q.T,j=te.p,te.p=2,Q.T=null;try{for(var R=i.onRecoverableError,Z=0;Z<p.length;Z++){var ge=p[Z];R(ge.value,{componentStack:ge.stack})}}finally{Q.T=c,te.p=j}}(li&3)!==0&&ch(),Dn(i),j=i.pendingLanes,(f&261930)!==0&&(j&42)!==0?i===tx?Bu++:(Bu=0,tx=i):Bu=0,Pu(0)}}function u2(i,c){(i.pooledCacheLanes&=c)===0&&(c=i.pooledCache,c!=null&&(i.pooledCache=null,vu(c)))}function ch(){return o2(),l2(),c2(),d2()}function d2(){if(Ts!==5)return!1;var i=Ki,c=Qp;Qp=0;var f=Jr(li),p=Q.T,j=te.p;try{te.p=32>f?32:f,Q.T=null,f=ex,ex=null;var R=Ki,Z=li;if(Ts=0,ec=Ki=null,li=0,(Nr&6)!==0)throw Error(s(331));var ge=Nr;if(Nr|=4,G_(R.current),q_(R,R.current,Z,f),Nr=ge,Pu(0,!1),Ct&&typeof Ct.onPostCommitFiberRoot=="function")try{Ct.onPostCommitFiberRoot(wt,R)}catch{}return!0}finally{te.p=j,Q.T=p,u2(i,c)}}function f2(i,c,f){c=Ya(f,c),c=Op(i.stateNode,c,2),i=zi(i,c,2),i!==null&&(Vt(i,2),Dn(i))}function jr(i,c,f){if(i.tag===3)f2(i,i,f);else for(;c!==null;){if(c.tag===3){f2(c,i,f);break}else if(c.tag===1){var p=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Vi===null||!Vi.has(p))){i=Ya(f,i),f=h_(2),p=zi(c,f,2),p!==null&&(m_(f,p,c,i),Vt(p,2),Dn(p));break}}c=c.return}}function ax(i,c,f){var p=i.pingCache;if(p===null){p=i.pingCache=new fA;var j=new Set;p.set(c,j)}else j=p.get(c),j===void 0&&(j=new Set,p.set(c,j));j.has(f)||(Yp=!0,j.add(f),i=gA.bind(null,i,c,f),c.then(i,i))}function gA(i,c,f){var p=i.pingCache;p!==null&&p.delete(c),i.pingedLanes|=i.suspendedLanes&f,i.warmLanes&=~f,Pr===i&&(cr&f)===f&&(ss===4||ss===3&&(cr&62914560)===cr&&300>Me()-sh?(Nr&2)===0&&tc(i,0):Jp|=f,Ql===cr&&(Ql=0)),Dn(i)}function h2(i,c){c===0&&(c=pt()),i=jo(i,c),i!==null&&(Vt(i,c),Dn(i))}function yA(i){var c=i.memoizedState,f=0;c!==null&&(f=c.retryLane),h2(i,f)}function vA(i,c){var f=0;switch(i.tag){case 31:case 13:var p=i.stateNode,j=i.memoizedState;j!==null&&(f=j.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(s(314))}p!==null&&p.delete(c),h2(i,f)}function bA(i,c){return pe(i,c)}var uh=null,sc=null,nx=!1,dh=!1,ix=!1,Yi=0;function Dn(i){i!==sc&&i.next===null&&(sc===null?uh=sc=i:sc=sc.next=i),dh=!0,nx||(nx=!0,_A())}function Pu(i,c){if(!ix&&dh){ix=!0;do for(var f=!1,p=uh;p!==null;){if(i!==0){var j=p.pendingLanes;if(j===0)var R=0;else{var Z=p.suspendedLanes,ge=p.pingedLanes;R=(1<<31-Le(42|i)+1)-1,R&=j&~(Z&~ge),R=R&201326741?R&201326741|1:R?R|2:0}R!==0&&(f=!0,g2(p,R))}else R=cr,R=Oe(p,p===Pr?R:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(R&3)===0||Ue(p,R)||(f=!0,g2(p,R));p=p.next}while(f);ix=!1}}function wA(){m2()}function m2(){dh=nx=!1;var i=0;Yi!==0&&DA()&&(i=Yi);for(var c=Me(),f=null,p=uh;p!==null;){var j=p.next,R=p2(p,c);R===0?(p.next=null,f===null?uh=j:f.next=j,j===null&&(sc=f)):(f=p,(i!==0||(R&3)!==0)&&(dh=!0)),p=j}Ts!==0&&Ts!==5||Pu(i),Yi!==0&&(Yi=0)}function p2(i,c){for(var f=i.suspendedLanes,p=i.pingedLanes,j=i.expirationTimes,R=i.pendingLanes&-62914561;0<R;){var Z=31-Le(R),ge=1<<Z,Fe=j[Z];Fe===-1?((ge&f)===0||(ge&p)!==0)&&(j[Z]=rt(ge,c)):Fe<=c&&(i.expiredLanes|=ge),R&=~ge}if(c=Pr,f=cr,f=Oe(i,i===c?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,f===0||i===c&&(Er===2||Er===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&_e(p),i.callbackNode=null,i.callbackPriority=0;if((f&3)===0||Ue(i,f)){if(c=f&-f,c===i.callbackPriority)return c;switch(p!==null&&_e(p),Jr(f)){case 2:case 8:f=et;break;case 32:f=He;break;case 268435456:f=De;break;default:f=He}return p=x2.bind(null,i),f=pe(f,p),i.callbackPriority=c,i.callbackNode=f,c}return p!==null&&p!==null&&_e(p),i.callbackPriority=2,i.callbackNode=null,2}function x2(i,c){if(Ts!==0&&Ts!==5)return i.callbackNode=null,i.callbackPriority=0,null;var f=i.callbackNode;if(ch()&&i.callbackNode!==f)return null;var p=cr;return p=Oe(i,i===Pr?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(J_(i,p,c),p2(i,Me()),i.callbackNode!=null&&i.callbackNode===f?x2.bind(null,i):null)}function g2(i,c){if(ch())return null;J_(i,c,!0)}function _A(){FA(function(){(Nr&6)!==0?pe(Re,wA):m2()})}function ox(){if(Yi===0){var i=$l;i===0&&(i=Ne,Ne<<=1,(Ne&261888)===0&&(Ne=256)),Yi=i}return Yi}function y2(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:vf(""+i)}function v2(i,c){var f=c.ownerDocument.createElement("input");return f.name=c.name,f.value=c.value,i.id&&f.setAttribute("form",i.id),c.parentNode.insertBefore(f,c),i=new FormData(i),f.parentNode.removeChild(f),i}function NA(i,c,f,p,j){if(c==="submit"&&f&&f.stateNode===j){var R=y2((j[ke]||null).action),Z=p.submitter;Z&&(c=(c=Z[ke]||null)?y2(c.formAction):Z.getAttribute("formAction"),c!==null&&(R=c,Z=null));var ge=new Nf("action","action",null,p,j);i.push({event:ge,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Yi!==0){var Fe=Z?v2(j,Z):new FormData(j);jp(f,{pending:!0,data:Fe,method:j.method,action:R},null,Fe)}}else typeof R=="function"&&(ge.preventDefault(),Fe=Z?v2(j,Z):new FormData(j),jp(f,{pending:!0,data:Fe,method:j.method,action:R},R,Fe))},currentTarget:j}]})}}for(var lx=0;lx<Hm.length;lx++){var cx=Hm[lx],SA=cx.toLowerCase(),kA=cx[0].toUpperCase()+cx.slice(1);xn(SA,"on"+kA)}xn(Yb,"onAnimationEnd"),xn(Jb,"onAnimationIteration"),xn(Zb,"onAnimationStart"),xn("dblclick","onDoubleClick"),xn("focusin","onFocus"),xn("focusout","onBlur"),xn(z6,"onTransitionRun"),xn($6,"onTransitionStart"),xn(q6,"onTransitionCancel"),xn(Qb,"onTransitionEnd"),Br("onMouseEnter",["mouseout","mouseover"]),Br("onMouseLeave",["mouseout","mouseover"]),Br("onPointerEnter",["pointerout","pointerover"]),Br("onPointerLeave",["pointerout","pointerover"]),Ut("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ut("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ut("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ut("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ut("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ut("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),EA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Uu));function b2(i,c){c=(c&4)!==0;for(var f=0;f<i.length;f++){var p=i[f],j=p.event;p=p.listeners;e:{var R=void 0;if(c)for(var Z=p.length-1;0<=Z;Z--){var ge=p[Z],Fe=ge.instance,Ve=ge.currentTarget;if(ge=ge.listener,Fe!==R&&j.isPropagationStopped())break e;R=ge,j.currentTarget=Ve;try{R(j)}catch(it){Ef(it)}j.currentTarget=null,R=Fe}else for(Z=0;Z<p.length;Z++){if(ge=p[Z],Fe=ge.instance,Ve=ge.currentTarget,ge=ge.listener,Fe!==R&&j.isPropagationStopped())break e;R=ge,j.currentTarget=Ve;try{R(j)}catch(it){Ef(it)}j.currentTarget=null,R=Fe}}}}function lr(i,c){var f=c[We];f===void 0&&(f=c[We]=new Set);var p=i+"__bubble";f.has(p)||(w2(c,i,2,!1),f.add(p))}function ux(i,c,f){var p=0;c&&(p|=4),w2(f,i,p,c)}var fh="_reactListening"+Math.random().toString(36).slice(2);function dx(i){if(!i[fh]){i[fh]=!0,bt.forEach(function(f){f!=="selectionchange"&&(EA.has(f)||ux(f,!1,i),ux(f,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[fh]||(c[fh]=!0,ux("selectionchange",!1,c))}}function w2(i,c,f,p){switch(Y2(c)){case 2:var j=eC;break;case 8:j=tC;break;default:j=Ex}f=j.bind(null,c,f,i),j=void 0,!Rm||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(j=!0),p?j!==void 0?i.addEventListener(c,f,{capture:!0,passive:j}):i.addEventListener(c,f,!0):j!==void 0?i.addEventListener(c,f,{passive:j}):i.addEventListener(c,f,!1)}function fx(i,c,f,p,j){var R=p;if((c&1)===0&&(c&2)===0&&p!==null)e:for(;;){if(p===null)return;var Z=p.tag;if(Z===3||Z===4){var ge=p.stateNode.containerInfo;if(ge===j)break;if(Z===4)for(Z=p.return;Z!==null;){var Fe=Z.tag;if((Fe===3||Fe===4)&&Z.stateNode.containerInfo===j)return;Z=Z.return}for(;ge!==null;){if(Z=vt(ge),Z===null)return;if(Fe=Z.tag,Fe===5||Fe===6||Fe===26||Fe===27){p=R=Z;continue e}ge=ge.parentNode}}p=p.return}Eb(function(){var Ve=R,it=Am(f),ut=[];e:{var Xe=ew.get(i);if(Xe!==void 0){var Ze=Nf,Rt=i;switch(i){case"keypress":if(wf(f)===0)break e;case"keydown":case"keyup":Ze=v6;break;case"focusin":Rt="focus",Ze=Lm;break;case"focusout":Rt="blur",Ze=Lm;break;case"beforeblur":case"afterblur":Ze=Lm;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=Ab;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=o6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=_6;break;case Yb:case Jb:case Zb:Ze=u6;break;case Qb:Ze=S6;break;case"scroll":case"scrollend":Ze=n6;break;case"wheel":Ze=E6;break;case"copy":case"cut":case"paste":Ze=f6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=Rb;break;case"toggle":case"beforetoggle":Ze=T6}var $t=(c&4)!==0,Fr=!$t&&(i==="scroll"||i==="scrollend"),ze=$t?Xe!==null?Xe+"Capture":null:Xe;$t=[];for(var Be=Ve,Ge;Be!==null;){var lt=Be;if(Ge=lt.stateNode,lt=lt.tag,lt!==5&&lt!==26&&lt!==27||Ge===null||ze===null||(lt=lu(Be,ze),lt!=null&&$t.push(zu(Be,lt,Ge))),Fr)break;Be=Be.return}0<$t.length&&(Xe=new Ze(Xe,Rt,null,f,it),ut.push({event:Xe,listeners:$t}))}}if((c&7)===0){e:{if(Xe=i==="mouseover"||i==="pointerover",Ze=i==="mouseout"||i==="pointerout",Xe&&f!==Tm&&(Rt=f.relatedTarget||f.fromElement)&&(vt(Rt)||Rt[Ee]))break e;if((Ze||Xe)&&(Xe=it.window===it?it:(Xe=it.ownerDocument)?Xe.defaultView||Xe.parentWindow:window,Ze?(Rt=f.relatedTarget||f.toElement,Ze=Ve,Rt=Rt?vt(Rt):null,Rt!==null&&(Fr=o(Rt),$t=Rt.tag,Rt!==Fr||$t!==5&&$t!==27&&$t!==6)&&(Rt=null)):(Ze=null,Rt=Ve),Ze!==Rt)){if($t=Ab,lt="onMouseLeave",ze="onMouseEnter",Be="mouse",(i==="pointerout"||i==="pointerover")&&($t=Rb,lt="onPointerLeave",ze="onPointerEnter",Be="pointer"),Fr=Ze==null?Xe:xt(Ze),Ge=Rt==null?Xe:xt(Rt),Xe=new $t(lt,Be+"leave",Ze,f,it),Xe.target=Fr,Xe.relatedTarget=Ge,lt=null,vt(it)===Ve&&($t=new $t(ze,Be+"enter",Rt,f,it),$t.target=Ge,$t.relatedTarget=Fr,lt=$t),Fr=lt,Ze&&Rt)t:{for($t=jA,ze=Ze,Be=Rt,Ge=0,lt=ze;lt;lt=$t(lt))Ge++;lt=0;for(var Mt=Be;Mt;Mt=$t(Mt))lt++;for(;0<Ge-lt;)ze=$t(ze),Ge--;for(;0<lt-Ge;)Be=$t(Be),lt--;for(;Ge--;){if(ze===Be||Be!==null&&ze===Be.alternate){$t=ze;break t}ze=$t(ze),Be=$t(Be)}$t=null}else $t=null;Ze!==null&&_2(ut,Xe,Ze,$t,!1),Rt!==null&&Fr!==null&&_2(ut,Fr,Rt,$t,!0)}}e:{if(Xe=Ve?xt(Ve):window,Ze=Xe.nodeName&&Xe.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&Xe.type==="file")var vr=Pb;else if(Mb(Xe))if(Ub)vr=B6;else{vr=I6;var Ft=L6}else Ze=Xe.nodeName,!Ze||Ze.toLowerCase()!=="input"||Xe.type!=="checkbox"&&Xe.type!=="radio"?Ve&&jm(Ve.elementType)&&(vr=Pb):vr=M6;if(vr&&(vr=vr(i,Ve))){Bb(ut,vr,f,it);break e}Ft&&Ft(i,Xe,Ve),i==="focusout"&&Ve&&Xe.type==="number"&&Ve.memoizedProps.value!=null&&Em(Xe,"number",Xe.value)}switch(Ft=Ve?xt(Ve):window,i){case"focusin":(Mb(Ft)||Ft.contentEditable==="true")&&(Fl=Ft,zm=Ve,xu=null);break;case"focusout":xu=zm=Fl=null;break;case"mousedown":$m=!0;break;case"contextmenu":case"mouseup":case"dragend":$m=!1,Kb(ut,f,it);break;case"selectionchange":if(U6)break;case"keydown":case"keyup":Kb(ut,f,it)}var Qt;if(Mm)e:{switch(i){case"compositionstart":var ur="onCompositionStart";break e;case"compositionend":ur="onCompositionEnd";break e;case"compositionupdate":ur="onCompositionUpdate";break e}ur=void 0}else Ol?Lb(i,f)&&(ur="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(ur="onCompositionStart");ur&&(Db&&f.locale!=="ko"&&(Ol||ur!=="onCompositionStart"?ur==="onCompositionEnd"&&Ol&&(Qt=jb()):(Fi=it,Dm="value"in Fi?Fi.value:Fi.textContent,Ol=!0)),Ft=hh(Ve,ur),0<Ft.length&&(ur=new Cb(ur,i,null,f,it),ut.push({event:ur,listeners:Ft}),Qt?ur.data=Qt:(Qt=Ib(f),Qt!==null&&(ur.data=Qt)))),(Qt=C6?R6(i,f):D6(i,f))&&(ur=hh(Ve,"onBeforeInput"),0<ur.length&&(Ft=new Cb("onBeforeInput","beforeinput",null,f,it),ut.push({event:Ft,listeners:ur}),Ft.data=Qt)),NA(ut,i,Ve,f,it)}b2(ut,c)})}function zu(i,c,f){return{instance:i,listener:c,currentTarget:f}}function hh(i,c){for(var f=c+"Capture",p=[];i!==null;){var j=i,R=j.stateNode;if(j=j.tag,j!==5&&j!==26&&j!==27||R===null||(j=lu(i,f),j!=null&&p.unshift(zu(i,j,R)),j=lu(i,c),j!=null&&p.push(zu(i,j,R))),i.tag===3)return p;i=i.return}return[]}function jA(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function _2(i,c,f,p,j){for(var R=c._reactName,Z=[];f!==null&&f!==p;){var ge=f,Fe=ge.alternate,Ve=ge.stateNode;if(ge=ge.tag,Fe!==null&&Fe===p)break;ge!==5&&ge!==26&&ge!==27||Ve===null||(Fe=Ve,j?(Ve=lu(f,R),Ve!=null&&Z.unshift(zu(f,Ve,Fe))):j||(Ve=lu(f,R),Ve!=null&&Z.push(zu(f,Ve,Fe)))),f=f.return}Z.length!==0&&i.push({event:c,listeners:Z})}var TA=/\r\n?/g,AA=/\u0000|\uFFFD/g;function N2(i){return(typeof i=="string"?i:""+i).replace(TA,`
`).replace(AA,"")}function S2(i,c){return c=N2(c),N2(i)===c}function Or(i,c,f,p,j,R){switch(f){case"children":typeof p=="string"?c==="body"||c==="textarea"&&p===""||Cl(i,p):(typeof p=="number"||typeof p=="bigint")&&c!=="body"&&Cl(i,""+p);break;case"className":Ga(i,"class",p);break;case"tabIndex":Ga(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Ga(i,f,p);break;case"style":Sb(i,p,R);break;case"data":if(c!=="object"){Ga(i,"data",p);break}case"src":case"href":if(p===""&&(c!=="a"||f!=="href")){i.removeAttribute(f);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=vf(""+p),i.setAttribute(f,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof R=="function"&&(f==="formAction"?(c!=="input"&&Or(i,c,"name",j.name,j,null),Or(i,c,"formEncType",j.formEncType,j,null),Or(i,c,"formMethod",j.formMethod,j,null),Or(i,c,"formTarget",j.formTarget,j,null)):(Or(i,c,"encType",j.encType,j,null),Or(i,c,"method",j.method,j,null),Or(i,c,"target",j.target,j,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=vf(""+p),i.setAttribute(f,p);break;case"onClick":p!=null&&(i.onclick=Vn);break;case"onScroll":p!=null&&lr("scroll",i);break;case"onScrollEnd":p!=null&&lr("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(s(61));if(f=p.__html,f!=null){if(j.children!=null)throw Error(s(60));i.innerHTML=f}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}f=vf(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""+p):i.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""):i.removeAttribute(f);break;case"capture":case"download":p===!0?i.setAttribute(f,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,p):i.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(f,p):i.removeAttribute(f);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(f):i.setAttribute(f,p);break;case"popover":lr("beforetoggle",i),lr("toggle",i),Js(i,"popover",p);break;case"xlinkActuate":Gn(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Gn(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Gn(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Gn(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Gn(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Gn(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Gn(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Gn(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Gn(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Js(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=s6.get(f)||f,Js(i,f,p))}}function hx(i,c,f,p,j,R){switch(f){case"style":Sb(i,p,R);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(s(61));if(f=p.__html,f!=null){if(j.children!=null)throw Error(s(60));i.innerHTML=f}}break;case"children":typeof p=="string"?Cl(i,p):(typeof p=="number"||typeof p=="bigint")&&Cl(i,""+p);break;case"onScroll":p!=null&&lr("scroll",i);break;case"onScrollEnd":p!=null&&lr("scrollend",i);break;case"onClick":p!=null&&(i.onclick=Vn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!yt.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(j=f.endsWith("Capture"),c=f.slice(2,j?f.length-7:void 0),R=i[ke]||null,R=R!=null?R[f]:null,typeof R=="function"&&i.removeEventListener(c,R,j),typeof p=="function")){typeof R!="function"&&R!==null&&(f in i?i[f]=null:i.hasAttribute(f)&&i.removeAttribute(f)),i.addEventListener(c,p,j);break e}f in i?i[f]=p:p===!0?i.setAttribute(f,""):Js(i,f,p)}}}function zs(i,c,f){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":lr("error",i),lr("load",i);var p=!1,j=!1,R;for(R in f)if(f.hasOwnProperty(R)){var Z=f[R];if(Z!=null)switch(R){case"src":p=!0;break;case"srcSet":j=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,c));default:Or(i,c,R,Z,f,null)}}j&&Or(i,c,"srcSet",f.srcSet,f,null),p&&Or(i,c,"src",f.src,f,null);return;case"input":lr("invalid",i);var ge=R=Z=j=null,Fe=null,Ve=null;for(p in f)if(f.hasOwnProperty(p)){var it=f[p];if(it!=null)switch(p){case"name":j=it;break;case"type":Z=it;break;case"checked":Fe=it;break;case"defaultChecked":Ve=it;break;case"value":R=it;break;case"defaultValue":ge=it;break;case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(s(137,c));break;default:Or(i,c,p,it,f,null)}}bb(i,R,ge,Fe,Ve,Z,j,!1);return;case"select":lr("invalid",i),p=Z=R=null;for(j in f)if(f.hasOwnProperty(j)&&(ge=f[j],ge!=null))switch(j){case"value":R=ge;break;case"defaultValue":Z=ge;break;case"multiple":p=ge;default:Or(i,c,j,ge,f,null)}c=R,f=Z,i.multiple=!!p,c!=null?Al(i,!!p,c,!1):f!=null&&Al(i,!!p,f,!0);return;case"textarea":lr("invalid",i),R=j=p=null;for(Z in f)if(f.hasOwnProperty(Z)&&(ge=f[Z],ge!=null))switch(Z){case"value":p=ge;break;case"defaultValue":j=ge;break;case"children":R=ge;break;case"dangerouslySetInnerHTML":if(ge!=null)throw Error(s(91));break;default:Or(i,c,Z,ge,f,null)}_b(i,p,j,R);return;case"option":for(Fe in f)f.hasOwnProperty(Fe)&&(p=f[Fe],p!=null)&&(Fe==="selected"?i.selected=p&&typeof p!="function"&&typeof p!="symbol":Or(i,c,Fe,p,f,null));return;case"dialog":lr("beforetoggle",i),lr("toggle",i),lr("cancel",i),lr("close",i);break;case"iframe":case"object":lr("load",i);break;case"video":case"audio":for(p=0;p<Uu.length;p++)lr(Uu[p],i);break;case"image":lr("error",i),lr("load",i);break;case"details":lr("toggle",i);break;case"embed":case"source":case"link":lr("error",i),lr("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ve in f)if(f.hasOwnProperty(Ve)&&(p=f[Ve],p!=null))switch(Ve){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,c));default:Or(i,c,Ve,p,f,null)}return;default:if(jm(c)){for(it in f)f.hasOwnProperty(it)&&(p=f[it],p!==void 0&&hx(i,c,it,p,f,void 0));return}}for(ge in f)f.hasOwnProperty(ge)&&(p=f[ge],p!=null&&Or(i,c,ge,p,f,null))}function CA(i,c,f,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var j=null,R=null,Z=null,ge=null,Fe=null,Ve=null,it=null;for(Ze in f){var ut=f[Ze];if(f.hasOwnProperty(Ze)&&ut!=null)switch(Ze){case"checked":break;case"value":break;case"defaultValue":Fe=ut;default:p.hasOwnProperty(Ze)||Or(i,c,Ze,null,p,ut)}}for(var Xe in p){var Ze=p[Xe];if(ut=f[Xe],p.hasOwnProperty(Xe)&&(Ze!=null||ut!=null))switch(Xe){case"type":R=Ze;break;case"name":j=Ze;break;case"checked":Ve=Ze;break;case"defaultChecked":it=Ze;break;case"value":Z=Ze;break;case"defaultValue":ge=Ze;break;case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(s(137,c));break;default:Ze!==ut&&Or(i,c,Xe,Ze,p,ut)}}km(i,Z,ge,Fe,Ve,it,R,j);return;case"select":Ze=Z=ge=Xe=null;for(R in f)if(Fe=f[R],f.hasOwnProperty(R)&&Fe!=null)switch(R){case"value":break;case"multiple":Ze=Fe;default:p.hasOwnProperty(R)||Or(i,c,R,null,p,Fe)}for(j in p)if(R=p[j],Fe=f[j],p.hasOwnProperty(j)&&(R!=null||Fe!=null))switch(j){case"value":Xe=R;break;case"defaultValue":ge=R;break;case"multiple":Z=R;default:R!==Fe&&Or(i,c,j,R,p,Fe)}c=ge,f=Z,p=Ze,Xe!=null?Al(i,!!f,Xe,!1):!!p!=!!f&&(c!=null?Al(i,!!f,c,!0):Al(i,!!f,f?[]:"",!1));return;case"textarea":Ze=Xe=null;for(ge in f)if(j=f[ge],f.hasOwnProperty(ge)&&j!=null&&!p.hasOwnProperty(ge))switch(ge){case"value":break;case"children":break;default:Or(i,c,ge,null,p,j)}for(Z in p)if(j=p[Z],R=f[Z],p.hasOwnProperty(Z)&&(j!=null||R!=null))switch(Z){case"value":Xe=j;break;case"defaultValue":Ze=j;break;case"children":break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(91));break;default:j!==R&&Or(i,c,Z,j,p,R)}wb(i,Xe,Ze);return;case"option":for(var Rt in f)Xe=f[Rt],f.hasOwnProperty(Rt)&&Xe!=null&&!p.hasOwnProperty(Rt)&&(Rt==="selected"?i.selected=!1:Or(i,c,Rt,null,p,Xe));for(Fe in p)Xe=p[Fe],Ze=f[Fe],p.hasOwnProperty(Fe)&&Xe!==Ze&&(Xe!=null||Ze!=null)&&(Fe==="selected"?i.selected=Xe&&typeof Xe!="function"&&typeof Xe!="symbol":Or(i,c,Fe,Xe,p,Ze));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $t in f)Xe=f[$t],f.hasOwnProperty($t)&&Xe!=null&&!p.hasOwnProperty($t)&&Or(i,c,$t,null,p,Xe);for(Ve in p)if(Xe=p[Ve],Ze=f[Ve],p.hasOwnProperty(Ve)&&Xe!==Ze&&(Xe!=null||Ze!=null))switch(Ve){case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(s(137,c));break;default:Or(i,c,Ve,Xe,p,Ze)}return;default:if(jm(c)){for(var Fr in f)Xe=f[Fr],f.hasOwnProperty(Fr)&&Xe!==void 0&&!p.hasOwnProperty(Fr)&&hx(i,c,Fr,void 0,p,Xe);for(it in p)Xe=p[it],Ze=f[it],!p.hasOwnProperty(it)||Xe===Ze||Xe===void 0&&Ze===void 0||hx(i,c,it,Xe,p,Ze);return}}for(var ze in f)Xe=f[ze],f.hasOwnProperty(ze)&&Xe!=null&&!p.hasOwnProperty(ze)&&Or(i,c,ze,null,p,Xe);for(ut in p)Xe=p[ut],Ze=f[ut],!p.hasOwnProperty(ut)||Xe===Ze||Xe==null&&Ze==null||Or(i,c,ut,Xe,p,Ze)}function k2(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function RA(){if(typeof performance.getEntriesByType=="function"){for(var i=0,c=0,f=performance.getEntriesByType("resource"),p=0;p<f.length;p++){var j=f[p],R=j.transferSize,Z=j.initiatorType,ge=j.duration;if(R&&ge&&k2(Z)){for(Z=0,ge=j.responseEnd,p+=1;p<f.length;p++){var Fe=f[p],Ve=Fe.startTime;if(Ve>ge)break;var it=Fe.transferSize,ut=Fe.initiatorType;it&&k2(ut)&&(Fe=Fe.responseEnd,Z+=it*(Fe<ge?1:(ge-Ve)/(Fe-Ve)))}if(--p,c+=8*(R+Z)/(j.duration/1e3),i++,10<i)break}}if(0<i)return c/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var mx=null,px=null;function mh(i){return i.nodeType===9?i:i.ownerDocument}function E2(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function j2(i,c){if(i===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&c==="foreignObject"?0:i}function xx(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var gx=null;function DA(){var i=window.event;return i&&i.type==="popstate"?i===gx?!1:(gx=i,!0):(gx=null,!1)}var T2=typeof setTimeout=="function"?setTimeout:void 0,OA=typeof clearTimeout=="function"?clearTimeout:void 0,A2=typeof Promise=="function"?Promise:void 0,FA=typeof queueMicrotask=="function"?queueMicrotask:typeof A2<"u"?function(i){return A2.resolve(null).then(i).catch(LA)}:T2;function LA(i){setTimeout(function(){throw i})}function Ji(i){return i==="head"}function C2(i,c){var f=c,p=0;do{var j=f.nextSibling;if(i.removeChild(f),j&&j.nodeType===8)if(f=j.data,f==="/$"||f==="/&"){if(p===0){i.removeChild(j),oc(c);return}p--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")p++;else if(f==="html")$u(i.ownerDocument.documentElement);else if(f==="head"){f=i.ownerDocument.head,$u(f);for(var R=f.firstChild;R;){var Z=R.nextSibling,ge=R.nodeName;R[Ke]||ge==="SCRIPT"||ge==="STYLE"||ge==="LINK"&&R.rel.toLowerCase()==="stylesheet"||f.removeChild(R),R=Z}}else f==="body"&&$u(i.ownerDocument.body);f=j}while(f);oc(c)}function R2(i,c){var f=i;i=0;do{var p=f.nextSibling;if(f.nodeType===1?c?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(c?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),p&&p.nodeType===8)if(f=p.data,f==="/$"){if(i===0)break;i--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||i++;f=p}while(f)}function yx(i){var c=i.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var f=c;switch(c=c.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":yx(f),ft(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}i.removeChild(f)}}function IA(i,c,f,p){for(;i.nodeType===1;){var j=f;if(i.nodeName.toLowerCase()!==c.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Ke])switch(c){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(R=i.getAttribute("rel"),R==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(R!==j.rel||i.getAttribute("href")!==(j.href==null||j.href===""?null:j.href)||i.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin)||i.getAttribute("title")!==(j.title==null?null:j.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(R=i.getAttribute("src"),(R!==(j.src==null?null:j.src)||i.getAttribute("type")!==(j.type==null?null:j.type)||i.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin))&&R&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(c==="input"&&i.type==="hidden"){var R=j.name==null?null:""+j.name;if(j.type==="hidden"&&i.getAttribute("name")===R)return i}else return i;if(i=tn(i.nextSibling),i===null)break}return null}function MA(i,c,f){if(c==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!f||(i=tn(i.nextSibling),i===null))return null;return i}function D2(i,c){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=tn(i.nextSibling),i===null))return null;return i}function vx(i){return i.data==="$?"||i.data==="$~"}function bx(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function BA(i,c){var f=i.ownerDocument;if(i.data==="$~")i._reactRetry=c;else if(i.data!=="$?"||f.readyState!=="loading")c();else{var p=function(){c(),f.removeEventListener("DOMContentLoaded",p)};f.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function tn(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return i}var wx=null;function O2(i){i=i.nextSibling;for(var c=0;i;){if(i.nodeType===8){var f=i.data;if(f==="/$"||f==="/&"){if(c===0)return tn(i.nextSibling);c--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||c++}i=i.nextSibling}return null}function F2(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(c===0)return i;c--}else f!=="/$"&&f!=="/&"||c++}i=i.previousSibling}return null}function L2(i,c,f){switch(c=mh(f),i){case"html":if(i=c.documentElement,!i)throw Error(s(452));return i;case"head":if(i=c.head,!i)throw Error(s(453));return i;case"body":if(i=c.body,!i)throw Error(s(454));return i;default:throw Error(s(451))}}function $u(i){for(var c=i.attributes;c.length;)i.removeAttributeNode(c[0]);ft(i)}var rn=new Map,I2=new Set;function ph(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var ci=te.d;te.d={f:PA,r:UA,D:zA,C:$A,L:qA,m:HA,X:GA,S:WA,M:VA};function PA(){var i=ci.f(),c=ih();return i||c}function UA(i){var c=kt(i);c!==null&&c.tag===5&&c.type==="form"?Qw(c):ci.r(i)}var ac=typeof document>"u"?null:document;function M2(i,c,f){var p=ac;if(p&&typeof c=="string"&&c){var j=Ka(c);j='link[rel="'+i+'"][href="'+j+'"]',typeof f=="string"&&(j+='[crossorigin="'+f+'"]'),I2.has(j)||(I2.add(j),i={rel:i,crossOrigin:f,href:c},p.querySelector(j)===null&&(c=p.createElement("link"),zs(c,"link",i),Ie(c),p.head.appendChild(c)))}}function zA(i){ci.D(i),M2("dns-prefetch",i,null)}function $A(i,c){ci.C(i,c),M2("preconnect",i,c)}function qA(i,c,f){ci.L(i,c,f);var p=ac;if(p&&i&&c){var j='link[rel="preload"][as="'+Ka(c)+'"]';c==="image"&&f&&f.imageSrcSet?(j+='[imagesrcset="'+Ka(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(j+='[imagesizes="'+Ka(f.imageSizes)+'"]')):j+='[href="'+Ka(i)+'"]';var R=j;switch(c){case"style":R=nc(i);break;case"script":R=ic(i)}rn.has(R)||(i=x({rel:"preload",href:c==="image"&&f&&f.imageSrcSet?void 0:i,as:c},f),rn.set(R,i),p.querySelector(j)!==null||c==="style"&&p.querySelector(qu(R))||c==="script"&&p.querySelector(Hu(R))||(c=p.createElement("link"),zs(c,"link",i),Ie(c),p.head.appendChild(c)))}}function HA(i,c){ci.m(i,c);var f=ac;if(f&&i){var p=c&&typeof c.as=="string"?c.as:"script",j='link[rel="modulepreload"][as="'+Ka(p)+'"][href="'+Ka(i)+'"]',R=j;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":R=ic(i)}if(!rn.has(R)&&(i=x({rel:"modulepreload",href:i},c),rn.set(R,i),f.querySelector(j)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Hu(R)))return}p=f.createElement("link"),zs(p,"link",i),Ie(p),f.head.appendChild(p)}}}function WA(i,c,f){ci.S(i,c,f);var p=ac;if(p&&i){var j=me(p).hoistableStyles,R=nc(i);c=c||"default";var Z=j.get(R);if(!Z){var ge={loading:0,preload:null};if(Z=p.querySelector(qu(R)))ge.loading=5;else{i=x({rel:"stylesheet",href:i,"data-precedence":c},f),(f=rn.get(R))&&_x(i,f);var Fe=Z=p.createElement("link");Ie(Fe),zs(Fe,"link",i),Fe._p=new Promise(function(Ve,it){Fe.onload=Ve,Fe.onerror=it}),Fe.addEventListener("load",function(){ge.loading|=1}),Fe.addEventListener("error",function(){ge.loading|=2}),ge.loading|=4,xh(Z,c,p)}Z={type:"stylesheet",instance:Z,count:1,state:ge},j.set(R,Z)}}}function GA(i,c){ci.X(i,c);var f=ac;if(f&&i){var p=me(f).hoistableScripts,j=ic(i),R=p.get(j);R||(R=f.querySelector(Hu(j)),R||(i=x({src:i,async:!0},c),(c=rn.get(j))&&Nx(i,c),R=f.createElement("script"),Ie(R),zs(R,"link",i),f.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},p.set(j,R))}}function VA(i,c){ci.M(i,c);var f=ac;if(f&&i){var p=me(f).hoistableScripts,j=ic(i),R=p.get(j);R||(R=f.querySelector(Hu(j)),R||(i=x({src:i,async:!0,type:"module"},c),(c=rn.get(j))&&Nx(i,c),R=f.createElement("script"),Ie(R),zs(R,"link",i),f.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},p.set(j,R))}}function B2(i,c,f,p){var j=(j=ce.current)?ph(j):null;if(!j)throw Error(s(446));switch(i){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(c=nc(f.href),f=me(j).hoistableStyles,p=f.get(c),p||(p={type:"style",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){i=nc(f.href);var R=me(j).hoistableStyles,Z=R.get(i);if(Z||(j=j.ownerDocument||j,Z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},R.set(i,Z),(R=j.querySelector(qu(i)))&&!R._p&&(Z.instance=R,Z.state.loading=5),rn.has(i)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},rn.set(i,f),R||KA(j,i,f,Z.state))),c&&p===null)throw Error(s(528,""));return Z}if(c&&p!==null)throw Error(s(529,""));return null;case"script":return c=f.async,f=f.src,typeof f=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=ic(f),f=me(j).hoistableScripts,p=f.get(c),p||(p={type:"script",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,i))}}function nc(i){return'href="'+Ka(i)+'"'}function qu(i){return'link[rel="stylesheet"]['+i+"]"}function P2(i){return x({},i,{"data-precedence":i.precedence,precedence:null})}function KA(i,c,f,p){i.querySelector('link[rel="preload"][as="style"]['+c+"]")?p.loading=1:(c=i.createElement("link"),p.preload=c,c.addEventListener("load",function(){return p.loading|=1}),c.addEventListener("error",function(){return p.loading|=2}),zs(c,"link",f),Ie(c),i.head.appendChild(c))}function ic(i){return'[src="'+Ka(i)+'"]'}function Hu(i){return"script[async]"+i}function U2(i,c,f){if(c.count++,c.instance===null)switch(c.type){case"style":var p=i.querySelector('style[data-href~="'+Ka(f.href)+'"]');if(p)return c.instance=p,Ie(p),p;var j=x({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Ie(p),zs(p,"style",j),xh(p,f.precedence,i),c.instance=p;case"stylesheet":j=nc(f.href);var R=i.querySelector(qu(j));if(R)return c.state.loading|=4,c.instance=R,Ie(R),R;p=P2(f),(j=rn.get(j))&&_x(p,j),R=(i.ownerDocument||i).createElement("link"),Ie(R);var Z=R;return Z._p=new Promise(function(ge,Fe){Z.onload=ge,Z.onerror=Fe}),zs(R,"link",p),c.state.loading|=4,xh(R,f.precedence,i),c.instance=R;case"script":return R=ic(f.src),(j=i.querySelector(Hu(R)))?(c.instance=j,Ie(j),j):(p=f,(j=rn.get(R))&&(p=x({},f),Nx(p,j)),i=i.ownerDocument||i,j=i.createElement("script"),Ie(j),zs(j,"link",p),i.head.appendChild(j),c.instance=j);case"void":return null;default:throw Error(s(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(p=c.instance,c.state.loading|=4,xh(p,f.precedence,i));return c.instance}function xh(i,c,f){for(var p=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),j=p.length?p[p.length-1]:null,R=j,Z=0;Z<p.length;Z++){var ge=p[Z];if(ge.dataset.precedence===c)R=ge;else if(R!==j)break}R?R.parentNode.insertBefore(i,R.nextSibling):(c=f.nodeType===9?f.head:f,c.insertBefore(i,c.firstChild))}function _x(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.title==null&&(i.title=c.title)}function Nx(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.integrity==null&&(i.integrity=c.integrity)}var gh=null;function z2(i,c,f){if(gh===null){var p=new Map,j=gh=new Map;j.set(f,p)}else j=gh,p=j.get(f),p||(p=new Map,j.set(f,p));if(p.has(i))return p;for(p.set(i,null),f=f.getElementsByTagName(i),j=0;j<f.length;j++){var R=f[j];if(!(R[Ke]||R[be]||i==="link"&&R.getAttribute("rel")==="stylesheet")&&R.namespaceURI!=="http://www.w3.org/2000/svg"){var Z=R.getAttribute(c)||"";Z=i+Z;var ge=p.get(Z);ge?ge.push(R):p.set(Z,[R])}}return p}function $2(i,c,f){i=i.ownerDocument||i,i.head.insertBefore(f,c==="title"?i.querySelector("head > title"):null)}function XA(i,c,f){if(f===1||c.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;return c.rel==="stylesheet"?(i=c.disabled,typeof c.precedence=="string"&&i==null):!0;case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function q2(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function YA(i,c,f,p){if(f.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var j=nc(p.href),R=c.querySelector(qu(j));if(R){c=R._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(i.count++,i=yh.bind(i),c.then(i,i)),f.state.loading|=4,f.instance=R,Ie(R);return}R=c.ownerDocument||c,p=P2(p),(j=rn.get(j))&&_x(p,j),R=R.createElement("link"),Ie(R);var Z=R;Z._p=new Promise(function(ge,Fe){Z.onload=ge,Z.onerror=Fe}),zs(R,"link",p),f.instance=R}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(f,c),(c=f.state.preload)&&(f.state.loading&3)===0&&(i.count++,f=yh.bind(i),c.addEventListener("load",f),c.addEventListener("error",f))}}var Sx=0;function JA(i,c){return i.stylesheets&&i.count===0&&bh(i,i.stylesheets),0<i.count||0<i.imgCount?function(f){var p=setTimeout(function(){if(i.stylesheets&&bh(i,i.stylesheets),i.unsuspend){var R=i.unsuspend;i.unsuspend=null,R()}},6e4+c);0<i.imgBytes&&Sx===0&&(Sx=62500*RA());var j=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&bh(i,i.stylesheets),i.unsuspend)){var R=i.unsuspend;i.unsuspend=null,R()}},(i.imgBytes>Sx?50:800)+c);return i.unsuspend=f,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(j)}}:null}function yh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bh(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var vh=null;function bh(i,c){i.stylesheets=null,i.unsuspend!==null&&(i.count++,vh=new Map,c.forEach(ZA,i),vh=null,yh.call(i))}function ZA(i,c){if(!(c.state.loading&4)){var f=vh.get(i);if(f)var p=f.get(null);else{f=new Map,vh.set(i,f);for(var j=i.querySelectorAll("link[data-precedence],style[data-precedence]"),R=0;R<j.length;R++){var Z=j[R];(Z.nodeName==="LINK"||Z.getAttribute("media")!=="not all")&&(f.set(Z.dataset.precedence,Z),p=Z)}p&&f.set(null,p)}j=c.instance,Z=j.getAttribute("data-precedence"),R=f.get(Z)||p,R===p&&f.set(null,j),f.set(Z,j),this.count++,p=yh.bind(this),j.addEventListener("load",p),j.addEventListener("error",p),R?R.parentNode.insertBefore(j,R.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(j,i.firstChild)),c.state.loading|=4}}var Wu={$$typeof:N,Provider:null,Consumer:null,_currentValue:ve,_currentValue2:ve,_threadCount:0};function QA(i,c,f,p,j,R,Z,ge,Fe){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_t(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_t(0),this.hiddenUpdates=_t(null),this.identifierPrefix=p,this.onUncaughtError=j,this.onCaughtError=R,this.onRecoverableError=Z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Fe,this.incompleteTransitions=new Map}function H2(i,c,f,p,j,R,Z,ge,Fe,Ve,it,ut){return i=new QA(i,c,f,Z,Fe,Ve,it,ut,ge),c=1,R===!0&&(c|=24),R=Aa(3,null,null,c),i.current=R,R.stateNode=i,c=sp(),c.refCount++,i.pooledCache=c,c.refCount++,R.memoizedState={element:p,isDehydrated:f,cache:c},op(R),i}function W2(i){return i?(i=Ml,i):Ml}function G2(i,c,f,p,j,R){j=W2(j),p.context===null?p.context=j:p.pendingContext=j,p=Ui(c),p.payload={element:f},R=R===void 0?null:R,R!==null&&(p.callback=R),f=zi(i,p,c),f!==null&&(wa(f,i,c),Nu(f,i,c))}function V2(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<c?f:c}}function kx(i,c){V2(i,c),(i=i.alternate)&&V2(i,c)}function K2(i){if(i.tag===13||i.tag===31){var c=jo(i,67108864);c!==null&&wa(c,i,67108864),kx(i,67108864)}}function X2(i){if(i.tag===13||i.tag===31){var c=Fa();c=kr(c);var f=jo(i,c);f!==null&&wa(f,i,c),kx(i,c)}}var wh=!0;function eC(i,c,f,p){var j=Q.T;Q.T=null;var R=te.p;try{te.p=2,Ex(i,c,f,p)}finally{te.p=R,Q.T=j}}function tC(i,c,f,p){var j=Q.T;Q.T=null;var R=te.p;try{te.p=8,Ex(i,c,f,p)}finally{te.p=R,Q.T=j}}function Ex(i,c,f,p){if(wh){var j=jx(p);if(j===null)fx(i,c,p,_h,f),J2(i,p);else if(sC(j,i,c,f,p))p.stopPropagation();else if(J2(i,p),c&4&&-1<rC.indexOf(i)){for(;j!==null;){var R=kt(j);if(R!==null)switch(R.tag){case 3:if(R=R.stateNode,R.current.memoizedState.isDehydrated){var Z=de(R.pendingLanes);if(Z!==0){var ge=R;for(ge.pendingLanes|=2,ge.entangledLanes|=2;Z;){var Fe=1<<31-Le(Z);ge.entanglements[1]|=Fe,Z&=~Fe}Dn(R),(Nr&6)===0&&(ah=Me()+500,Pu(0))}}break;case 31:case 13:ge=jo(R,2),ge!==null&&wa(ge,R,2),ih(),kx(R,2)}if(R=jx(p),R===null&&fx(i,c,p,_h,f),R===j)break;j=R}j!==null&&p.stopPropagation()}else fx(i,c,p,null,f)}}function jx(i){return i=Am(i),Tx(i)}var _h=null;function Tx(i){if(_h=null,i=vt(i),i!==null){var c=o(i);if(c===null)i=null;else{var f=c.tag;if(f===13){if(i=l(c),i!==null)return i;i=null}else if(f===31){if(i=u(c),i!==null)return i;i=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null)}}return _h=i,null}function Y2(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ae()){case Re:return 2;case et:return 8;case He:case at:return 32;case De:return 268435456;default:return 32}default:return 32}}var Ax=!1,Zi=null,Qi=null,eo=null,Gu=new Map,Vu=new Map,to=[],rC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function J2(i,c){switch(i){case"focusin":case"focusout":Zi=null;break;case"dragenter":case"dragleave":Qi=null;break;case"mouseover":case"mouseout":eo=null;break;case"pointerover":case"pointerout":Gu.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vu.delete(c.pointerId)}}function Ku(i,c,f,p,j,R){return i===null||i.nativeEvent!==R?(i={blockedOn:c,domEventName:f,eventSystemFlags:p,nativeEvent:R,targetContainers:[j]},c!==null&&(c=kt(c),c!==null&&K2(c)),i):(i.eventSystemFlags|=p,c=i.targetContainers,j!==null&&c.indexOf(j)===-1&&c.push(j),i)}function sC(i,c,f,p,j){switch(c){case"focusin":return Zi=Ku(Zi,i,c,f,p,j),!0;case"dragenter":return Qi=Ku(Qi,i,c,f,p,j),!0;case"mouseover":return eo=Ku(eo,i,c,f,p,j),!0;case"pointerover":var R=j.pointerId;return Gu.set(R,Ku(Gu.get(R)||null,i,c,f,p,j)),!0;case"gotpointercapture":return R=j.pointerId,Vu.set(R,Ku(Vu.get(R)||null,i,c,f,p,j)),!0}return!1}function Z2(i){var c=vt(i.target);if(c!==null){var f=o(c);if(f!==null){if(c=f.tag,c===13){if(c=l(f),c!==null){i.blockedOn=c,we(i.priority,function(){X2(f)});return}}else if(c===31){if(c=u(f),c!==null){i.blockedOn=c,we(i.priority,function(){X2(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Nh(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var f=jx(i.nativeEvent);if(f===null){f=i.nativeEvent;var p=new f.constructor(f.type,f);Tm=p,f.target.dispatchEvent(p),Tm=null}else return c=kt(f),c!==null&&K2(c),i.blockedOn=f,!1;c.shift()}return!0}function Q2(i,c,f){Nh(i)&&f.delete(c)}function aC(){Ax=!1,Zi!==null&&Nh(Zi)&&(Zi=null),Qi!==null&&Nh(Qi)&&(Qi=null),eo!==null&&Nh(eo)&&(eo=null),Gu.forEach(Q2),Vu.forEach(Q2)}function Sh(i,c){i.blockedOn===c&&(i.blockedOn=null,Ax||(Ax=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,aC)))}var kh=null;function eN(i){kh!==i&&(kh=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){kh===i&&(kh=null);for(var c=0;c<i.length;c+=3){var f=i[c],p=i[c+1],j=i[c+2];if(typeof p!="function"){if(Tx(p||f)===null)continue;break}var R=kt(f);R!==null&&(i.splice(c,3),c-=3,jp(R,{pending:!0,data:j,method:f.method,action:p},p,j))}}))}function oc(i){function c(Fe){return Sh(Fe,i)}Zi!==null&&Sh(Zi,i),Qi!==null&&Sh(Qi,i),eo!==null&&Sh(eo,i),Gu.forEach(c),Vu.forEach(c);for(var f=0;f<to.length;f++){var p=to[f];p.blockedOn===i&&(p.blockedOn=null)}for(;0<to.length&&(f=to[0],f.blockedOn===null);)Z2(f),f.blockedOn===null&&to.shift();if(f=(i.ownerDocument||i).$$reactFormReplay,f!=null)for(p=0;p<f.length;p+=3){var j=f[p],R=f[p+1],Z=j[ke]||null;if(typeof R=="function")Z||eN(f);else if(Z){var ge=null;if(R&&R.hasAttribute("formAction")){if(j=R,Z=R[ke]||null)ge=Z.formAction;else if(Tx(j)!==null)continue}else ge=Z.action;typeof ge=="function"?f[p+1]=ge:(f.splice(p,3),p-=3),eN(f)}}}function tN(){function i(R){R.canIntercept&&R.info==="react-transition"&&R.intercept({handler:function(){return new Promise(function(Z){return j=Z})},focusReset:"manual",scroll:"manual"})}function c(){j!==null&&(j(),j=null),p||setTimeout(f,20)}function f(){if(!p&&!navigation.transition){var R=navigation.currentEntry;R&&R.url!=null&&navigation.navigate(R.url,{state:R.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,j=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(f,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),j!==null&&(j(),j=null)}}}function Cx(i){this._internalRoot=i}Eh.prototype.render=Cx.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(s(409));var f=c.current,p=Fa();G2(f,p,i,c,null,null)},Eh.prototype.unmount=Cx.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;G2(i.current,2,null,i,null,null),ih(),c[Ee]=null}};function Eh(i){this._internalRoot=i}Eh.prototype.unstable_scheduleHydration=function(i){if(i){var c=he();i={blockedOn:null,target:i,priority:c};for(var f=0;f<to.length&&c!==0&&c<to[f].priority;f++);to.splice(f,0,i),f===0&&Z2(i)}};var rN=t.version;if(rN!=="19.2.3")throw Error(s(527,rN,"19.2.3"));te.findDOMNode=function(i){var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(s(188)):(i=Object.keys(i).join(","),Error(s(268,i)));return i=h(c),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var nC={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jh.isDisabled&&jh.supportsFiber)try{wt=jh.inject(nC),Ct=jh}catch{}}return Yu.createRoot=function(i,c){if(!a(i))throw Error(s(299));var f=!1,p="",j=c_,R=u_,Z=d_;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(j=c.onUncaughtError),c.onCaughtError!==void 0&&(R=c.onCaughtError),c.onRecoverableError!==void 0&&(Z=c.onRecoverableError)),c=H2(i,1,!1,null,null,f,p,null,j,R,Z,tN),i[Ee]=c.current,dx(i),new Cx(c)},Yu.hydrateRoot=function(i,c,f){if(!a(i))throw Error(s(299));var p=!1,j="",R=c_,Z=u_,ge=d_,Fe=null;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(j=f.identifierPrefix),f.onUncaughtError!==void 0&&(R=f.onUncaughtError),f.onCaughtError!==void 0&&(Z=f.onCaughtError),f.onRecoverableError!==void 0&&(ge=f.onRecoverableError),f.formState!==void 0&&(Fe=f.formState)),c=H2(i,1,!0,c,f??null,p,j,Fe,R,Z,ge,tN),c.context=W2(null),f=c.current,p=Fa(),p=kr(p),j=Ui(p),j.callback=null,zi(f,j,p),f=p,c.current.lanes=f,Vt(c,f),Dn(c),i[Ee]=c.current,dx(i),new Eh(c)},Yu.version="19.2.3",Yu}var hN;function yC(){if(hN)return Ox.exports;hN=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Ox.exports=gC(),Ox.exports}var vC=yC();var zc;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(zc||(zc={}));class Mx extends Error{constructor(t,r,s){super(t),this.message=t,this.code=r,this.data=s}}const bC=e=>{var t,r;return e?.androidBridge?"android":!((r=(t=e?.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},wC=e=>{const t=e.CapacitorCustomPlatform||null,r=e.Capacitor||{},s=r.Plugins=r.Plugins||{},a=()=>t!==null?t.name:bC(e),o=()=>a()!=="web",l=x=>{const y=h.get(x);return!!(y?.platforms.has(a())||u(x))},u=x=>{var y;return(y=r.PluginHeaders)===null||y===void 0?void 0:y.find(v=>v.name===x)},d=x=>e.console.error(x),h=new Map,m=(x,y={})=>{const v=h.get(x);if(v)return console.warn(`Capacitor plugin "${x}" already registered. Cannot register plugins twice.`),v.proxy;const b=a(),g=u(x);let _;const w=async()=>(!_&&b in y?_=typeof y[b]=="function"?_=await y[b]():_=y[b]:t!==null&&!_&&"web"in y&&(_=typeof y.web=="function"?_=await y.web():_=y.web),_),k=(B,F)=>{var q,fe;if(g){const D=g?.methods.find(V=>F===V.name);if(D)return D.rtype==="promise"?V=>r.nativePromise(x,F.toString(),V):(V,I)=>r.nativeCallback(x,F.toString(),V,I);if(B)return(q=B[F])===null||q===void 0?void 0:q.bind(B)}else{if(B)return(fe=B[F])===null||fe===void 0?void 0:fe.bind(B);throw new Mx(`"${x}" plugin is not implemented on ${b}`,zc.Unimplemented)}},N=B=>{let F;const q=(...fe)=>{const D=w().then(V=>{const I=k(V,B);if(I){const ae=I(...fe);return F=ae?.remove,ae}else throw new Mx(`"${x}.${B}()" is not implemented on ${b}`,zc.Unimplemented)});return B==="addListener"&&(D.remove=async()=>F()),D};return q.toString=()=>`${B.toString()}() { [capacitor code] }`,Object.defineProperty(q,"name",{value:B,writable:!1,configurable:!1}),q},E=N("addListener"),C=N("removeListener"),L=(B,F)=>{const q=E({eventName:B},F),fe=async()=>{const V=await q;C({eventName:B,callbackId:V},F)},D=new Promise(V=>q.then(()=>V({remove:fe})));return D.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await fe()},D},O=new Proxy({},{get(B,F){switch(F){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return g?L:E;case"removeListener":return C;default:return N(F)}}});return s[x]=O,h.set(x,{name:x,proxy:O,platforms:new Set([...Object.keys(y),...g?[b]:[]])}),O};return r.convertFileSrc||(r.convertFileSrc=x=>x),r.getPlatform=a,r.handleError=d,r.isNativePlatform=o,r.isPluginAvailable=l,r.registerPlugin=m,r.Exception=Mx,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},_C=e=>e.Capacitor=wC(e),N0=_C(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Jy=N0.registerPlugin;class Zy{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,r){let s=!1;this.listeners[t]||(this.listeners[t]=[],s=!0),this.listeners[t].push(r);const o=this.windowListeners[t];o&&!o.registered&&this.addWindowListener(o),s&&this.sendRetainedArgumentsForEvent(t);const l=async()=>this.removeListener(t,r);return Promise.resolve({remove:l})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,r,s){const a=this.listeners[t];if(!a){if(s){let o=this.retainedEventArguments[t];o||(o=[]),o.push(r),this.retainedEventArguments[t]=o}return}a.forEach(o=>o(r))}hasListeners(t){var r;return!!(!((r=this.listeners[t])===null||r===void 0)&&r.length)}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:s=>{this.notifyListeners(r,s)}}}unimplemented(t="not implemented"){return new N0.Exception(t,zc.Unimplemented)}unavailable(t="not available"){return new N0.Exception(t,zc.Unavailable)}async removeListener(t,r){const s=this.listeners[t];if(!s)return;const a=s.indexOf(r);this.listeners[t].splice(a,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const r=this.retainedEventArguments[t];r&&(delete this.retainedEventArguments[t],r.forEach(s=>{this.notifyListeners(t,s)}))}}const mN=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),pN=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class NC extends Zy{async getCookies(){const t=document.cookie,r={};return t.split(";").forEach(s=>{if(s.length<=0)return;let[a,o]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=pN(a).trim(),o=pN(o).trim(),r[a]=o}),r}async setCookie(t){try{const r=mN(t.key),s=mN(t.value),a=`; expires=${(t.expires||"").replace("expires=","")}`,o=(t.path||"/").replace("path=",""),l=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${s||""}${a}; path=${o}; ${l};`}catch(r){return Promise.reject(r)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}Jy("CapacitorCookies",{web:()=>new NC});const SC=async e=>new Promise((t,r)=>{const s=new FileReader;s.onload=()=>{const a=s.result;t(a.indexOf(",")>=0?a.split(",")[1]:a)},s.onerror=a=>r(a),s.readAsDataURL(e)}),kC=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(a=>a.toLocaleLowerCase()).reduce((a,o,l)=>(a[o]=e[t[l]],a),{})},EC=(e,t=!0)=>e?Object.entries(e).reduce((s,a)=>{const[o,l]=a;let u,d;return Array.isArray(l)?(d="",l.forEach(h=>{u=t?encodeURIComponent(h):h,d+=`${o}=${u}&`}),d.slice(0,-1)):(u=t?encodeURIComponent(l):l,d=`${o}=${u}`),`${s}&${d}`},"").substr(1):null,jC=(e,t={})=>{const r=Object.assign({method:e.method||"GET",headers:e.headers},t),a=kC(e.headers)["content-type"]||"";if(typeof e.data=="string")r.body=e.data;else if(a.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[l,u]of Object.entries(e.data||{}))o.set(l,u);r.body=o.toString()}else if(a.includes("multipart/form-data")||e.data instanceof FormData){const o=new FormData;if(e.data instanceof FormData)e.data.forEach((u,d)=>{o.append(d,u)});else for(const u of Object.keys(e.data))o.append(u,e.data[u]);r.body=o;const l=new Headers(r.headers);l.delete("content-type"),r.headers=l}else(a.includes("application/json")||typeof e.data=="object")&&(r.body=JSON.stringify(e.data));return r};class TC extends Zy{async request(t){const r=jC(t,t.webFetchExtra),s=EC(t.params,t.shouldEncodeUrlParams),a=s?`${t.url}?${s}`:t.url,o=await fetch(a,r),l=o.headers.get("content-type")||"";let{responseType:u="text"}=o.ok?t:{};l.includes("application/json")&&(u="json");let d,h;switch(u){case"arraybuffer":case"blob":h=await o.blob(),d=await SC(h);break;case"json":d=await o.json();break;default:d=await o.text()}const m={};return o.headers.forEach((x,y)=>{m[y]=x}),{data:d,headers:m,status:o.status,url:o.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}Jy("CapacitorHttp",{web:()=>new TC});var xN;(function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"})(xN||(xN={}));var gN;(function(e){e.StatusBar="StatusBar",e.NavigationBar="NavigationBar"})(gN||(gN={}));class AC extends Zy{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}Jy("SystemBars",{web:()=>new AC});var yN="popstate";function CC(e={}){function t(s,a){let{pathname:o,search:l,hash:u}=s.location;return uy("",{pathname:o,search:l,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(s,a){return typeof a=="string"?a:kd(a)}return DC(t,r,null,e)}function Yr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function fn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function RC(){return Math.random().toString(36).substring(2,10)}function vN(e,t){return{usr:e.state,key:e.key,idx:t}}function uy(e,t,r=null,s){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Qc(t):t,state:r,key:t&&t.key||s||RC()}}function kd({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Qc(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let s=e.indexOf("?");s>=0&&(t.search=e.substring(s),e=e.substring(0,s)),e&&(t.pathname=e)}return t}function DC(e,t,r,s={}){let{window:a=document.defaultView,v5Compat:o=!1}=s,l=a.history,u="POP",d=null,h=m();h==null&&(h=0,l.replaceState({...l.state,idx:h},""));function m(){return(l.state||{idx:null}).idx}function x(){u="POP";let _=m(),w=_==null?null:_-h;h=_,d&&d({action:u,location:g.location,delta:w})}function y(_,w){u="PUSH";let k=uy(g.location,_,w);h=m()+1;let N=vN(k,h),E=g.createHref(k);try{l.pushState(N,"",E)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;a.location.assign(E)}o&&d&&d({action:u,location:g.location,delta:1})}function v(_,w){u="REPLACE";let k=uy(g.location,_,w);h=m();let N=vN(k,h),E=g.createHref(k);l.replaceState(N,"",E),o&&d&&d({action:u,location:g.location,delta:0})}function b(_){return OC(_)}let g={get action(){return u},get location(){return e(a,l)},listen(_){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(yN,x),d=_,()=>{a.removeEventListener(yN,x),d=null}},createHref(_){return t(a,_)},createURL:b,encodeLocation(_){let w=b(_);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:y,replace:v,go(_){return l.go(_)}};return g}function OC(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Yr(r,"No window.location.(origin|href) available to create URL");let s=typeof e=="string"?e:kd(e);return s=s.replace(/ $/,"%20"),!t&&s.startsWith("//")&&(s=r+s),new URL(s,r)}function qE(e,t,r="/"){return FC(e,t,r,!1)}function FC(e,t,r,s){let a=typeof t=="string"?Qc(t):t,o=wi(a.pathname||"/",r);if(o==null)return null;let l=HE(e);LC(l);let u=null;for(let d=0;u==null&&d<l.length;++d){let h=GC(o);u=HC(l[d],h,s)}return u}function HE(e,t=[],r=[],s="",a=!1){let o=(l,u,d=a,h)=>{let m={relativePath:h===void 0?l.path||"":h,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(s)&&d)return;Yr(m.relativePath.startsWith(s),`Absolute route path "${m.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(s.length)}let x=gi([s,m.relativePath]),y=r.concat(m);l.children&&l.children.length>0&&(Yr(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),HE(l.children,t,y,x,d)),!(l.path==null&&!l.index)&&t.push({path:x,score:$C(x,l.index),routesMeta:y})};return e.forEach((l,u)=>{if(l.path===""||!l.path?.includes("?"))o(l,u);else for(let d of WE(l.path))o(l,u,!0,d)}),t}function WE(e){let t=e.split("/");if(t.length===0)return[];let[r,...s]=t,a=r.endsWith("?"),o=r.replace(/\?$/,"");if(s.length===0)return a?[o,""]:[o];let l=WE(s.join("/")),u=[];return u.push(...l.map(d=>d===""?o:[o,d].join("/"))),a&&u.push(...l),u.map(d=>e.startsWith("/")&&d===""?"/":d)}function LC(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:qC(t.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}var IC=/^:[\w-]+$/,MC=3,BC=2,PC=1,UC=10,zC=-2,bN=e=>e==="*";function $C(e,t){let r=e.split("/"),s=r.length;return r.some(bN)&&(s+=zC),t&&(s+=BC),r.filter(a=>!bN(a)).reduce((a,o)=>a+(IC.test(o)?MC:o===""?PC:UC),s)}function qC(e,t){return e.length===t.length&&e.slice(0,-1).every((s,a)=>s===t[a])?e[e.length-1]-t[t.length-1]:0}function HC(e,t,r=!1){let{routesMeta:s}=e,a={},o="/",l=[];for(let u=0;u<s.length;++u){let d=s[u],h=u===s.length-1,m=o==="/"?t:t.slice(o.length)||"/",x=S0({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},m),y=d.route;if(!x&&h&&r&&!s[s.length-1].route.index&&(x=S0({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!x)return null;Object.assign(a,x.params),l.push({params:a,pathname:gi([o,x.pathname]),pathnameBase:YC(gi([o,x.pathnameBase])),route:y}),x.pathnameBase!=="/"&&(o=gi([o,x.pathnameBase]))}return l}function S0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,s]=WC(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:s.reduce((h,{paramName:m,isOptional:x},y)=>{if(m==="*"){let b=u[y]||"";l=o.slice(0,o.length-b.length).replace(/(.)\/+$/,"$1")}const v=u[y];return x&&!v?h[m]=void 0:h[m]=(v||"").replace(/%2F/g,"/"),h},{}),pathname:o,pathnameBase:l,pattern:e}}function WC(e,t=!1,r=!0){fn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let s=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,d)=>(s.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(s.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),s]}function GC(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return fn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function wi(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=e.charAt(r);return s&&s!=="/"?null:e.slice(r)||"/"}var GE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,VC=e=>GE.test(e);function KC(e,t="/"){let{pathname:r,search:s="",hash:a=""}=typeof e=="string"?Qc(e):e,o;if(r)if(VC(r))o=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),fn(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${r}`)}r.startsWith("/")?o=wN(r.substring(1),"/"):o=wN(r,t)}else o=t;return{pathname:o,search:JC(s),hash:ZC(a)}}function wN(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Bx(e,t,r,s){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function XC(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Qy(e){let t=XC(e);return t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase)}function ev(e,t,r,s=!1){let a;typeof e=="string"?a=Qc(e):(a={...e},Yr(!a.pathname||!a.pathname.includes("?"),Bx("?","pathname","search",a)),Yr(!a.pathname||!a.pathname.includes("#"),Bx("#","pathname","hash",a)),Yr(!a.search||!a.search.includes("#"),Bx("#","search","hash",a)));let o=e===""||a.pathname==="",l=o?"/":a.pathname,u;if(l==null)u=r;else{let x=t.length-1;if(!s&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),x-=1;a.pathname=y.join("/")}u=x>=0?t[x]:"/"}let d=KC(a,u),h=l&&l!=="/"&&l.endsWith("/"),m=(o||l===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(h||m)&&(d.pathname+="/"),d}var gi=e=>e.join("/").replace(/\/\/+/g,"/"),YC=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),JC=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ZC=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,QC=class{constructor(e,t,r,s=!1){this.status=e,this.statusText=t||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function e8(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function t8(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var VE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function KE(e,t){let r=e;if(typeof r!="string"||!GE.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let s=r,a=!1;if(VE)try{let o=new URL(window.location.href),l=r.startsWith("//")?new URL(o.protocol+r):new URL(r),u=wi(l.pathname,t);l.origin===o.origin&&u!=null?r=u+l.search+l.hash:a=!0}catch{fn(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:a,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var XE=["POST","PUT","PATCH","DELETE"];new Set(XE);var r8=["GET",...XE];new Set(r8);var eu=X.createContext(null);eu.displayName="DataRouter";var X0=X.createContext(null);X0.displayName="DataRouterState";var s8=X.createContext(!1),YE=X.createContext({isTransitioning:!1});YE.displayName="ViewTransition";var a8=X.createContext(new Map);a8.displayName="Fetchers";var n8=X.createContext(null);n8.displayName="Await";var Ha=X.createContext(null);Ha.displayName="Navigation";var Zd=X.createContext(null);Zd.displayName="Location";var mn=X.createContext({outlet:null,matches:[],isDataRoute:!1});mn.displayName="Route";var tv=X.createContext(null);tv.displayName="RouteError";var JE="REACT_ROUTER_ERROR",i8="REDIRECT",o8="ROUTE_ERROR_RESPONSE";function l8(e){if(e.startsWith(`${JE}:${i8}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function c8(e){if(e.startsWith(`${JE}:${o8}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new QC(t.status,t.statusText,t.data)}catch{}}function u8(e,{relative:t}={}){Yr(tu(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:s}=X.useContext(Ha),{hash:a,pathname:o,search:l}=Qd(e,{relative:t}),u=o;return r!=="/"&&(u=o==="/"?r:gi([r,o])),s.createHref({pathname:u,search:l,hash:a})}function tu(){return X.useContext(Zd)!=null}function ki(){return Yr(tu(),"useLocation() may be used only in the context of a <Router> component."),X.useContext(Zd).location}var ZE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function QE(e){X.useContext(Ha).static||X.useLayoutEffect(e)}function ru(){let{isDataRoute:e}=X.useContext(mn);return e?k8():d8()}function d8(){Yr(tu(),"useNavigate() may be used only in the context of a <Router> component.");let e=X.useContext(eu),{basename:t,navigator:r}=X.useContext(Ha),{matches:s}=X.useContext(mn),{pathname:a}=ki(),o=JSON.stringify(Qy(s)),l=X.useRef(!1);return QE(()=>{l.current=!0}),X.useCallback((d,h={})=>{if(fn(l.current,ZE),!l.current)return;if(typeof d=="number"){r.go(d);return}let m=ev(d,JSON.parse(o),a,h.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:gi([t,m.pathname])),(h.replace?r.replace:r.push)(m,h.state,h)},[t,r,o,a,e])}var f8=X.createContext(null);function h8(e){let t=X.useContext(mn).outlet;return X.useMemo(()=>t&&X.createElement(f8.Provider,{value:e},t),[t,e])}function e3(){let{matches:e}=X.useContext(mn),t=e[e.length-1];return t?t.params:{}}function Qd(e,{relative:t}={}){let{matches:r}=X.useContext(mn),{pathname:s}=ki(),a=JSON.stringify(Qy(r));return X.useMemo(()=>ev(e,JSON.parse(a),s,t==="path"),[e,a,s,t])}function m8(e,t){return t3(e,t)}function t3(e,t,r,s,a){Yr(tu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=X.useContext(Ha),{matches:l}=X.useContext(mn),u=l[l.length-1],d=u?u.params:{},h=u?u.pathname:"/",m=u?u.pathnameBase:"/",x=u&&u.route;{let k=x&&x.path||"";s3(h,!x||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let y=ki(),v;if(t){let k=typeof t=="string"?Qc(t):t;Yr(m==="/"||k.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${k.pathname}" was given in the \`location\` prop.`),v=k}else v=y;let b=v.pathname||"/",g=b;if(m!=="/"){let k=m.replace(/^\//,"").split("/");g="/"+b.replace(/^\//,"").split("/").slice(k.length).join("/")}let _=qE(e,{pathname:g});fn(x||_!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),fn(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=v8(_&&_.map(k=>Object.assign({},k,{params:Object.assign({},d,k.params),pathname:gi([m,o.encodeLocation?o.encodeLocation(k.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?m:gi([m,o.encodeLocation?o.encodeLocation(k.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathnameBase])})),l,r,s,a);return t&&w?X.createElement(Zd.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},w):w}function p8(){let e=S8(),t=e8(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:s},o={padding:"2px 4px",backgroundColor:s},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=X.createElement(X.Fragment,null,X.createElement("p",null," Hey developer "),X.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",X.createElement("code",{style:o},"ErrorBoundary")," or"," ",X.createElement("code",{style:o},"errorElement")," prop on your route.")),X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},t),r?X.createElement("pre",{style:a},r):null,l)}var x8=X.createElement(p8,null),r3=class extends X.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const r=c8(e.digest);r&&(e=r)}let t=e!==void 0?X.createElement(mn.Provider,{value:this.props.routeContext},X.createElement(tv.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?X.createElement(g8,{error:e},t):t}};r3.contextType=s8;var Px=new WeakMap;function g8({children:e,error:t}){let{basename:r}=X.useContext(Ha);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let s=l8(t.digest);if(s){let a=Px.get(t);if(a)throw a;let o=KE(s.location,r);if(VE&&!Px.get(t))if(o.isExternal||s.reloadDocument)window.location.href=o.absoluteURL||o.to;else{const l=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(o.to,{replace:s.replace}));throw Px.set(t,l),l}return X.createElement("meta",{httpEquiv:"refresh",content:`0;url=${o.absoluteURL||o.to}`})}}return e}function y8({routeContext:e,match:t,children:r}){let s=X.useContext(eu);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),X.createElement(mn.Provider,{value:e},r)}function v8(e,t=[],r=null,s=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=r?.errors;if(l!=null){let m=o.findIndex(x=>x.route.id&&l?.[x.route.id]!==void 0);Yr(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,d=-1;if(r)for(let m=0;m<o.length;m++){let x=o[m];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(d=m),x.route.id){let{loaderData:y,errors:v}=r,b=x.route.loader&&!y.hasOwnProperty(x.route.id)&&(!v||v[x.route.id]===void 0);if(x.route.lazy||b){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}let h=r&&s?(m,x)=>{s(m,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:t8(r.matches),errorInfo:x})}:void 0;return o.reduceRight((m,x,y)=>{let v,b=!1,g=null,_=null;r&&(v=l&&x.route.id?l[x.route.id]:void 0,g=x.route.errorElement||x8,u&&(d<0&&y===0?(s3("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,_=null):d===y&&(b=!0,_=x.route.hydrateFallbackElement||null)));let w=t.concat(o.slice(0,y+1)),k=()=>{let N;return v?N=g:b?N=_:x.route.Component?N=X.createElement(x.route.Component,null):x.route.element?N=x.route.element:N=m,X.createElement(y8,{match:x,routeContext:{outlet:m,matches:w,isDataRoute:r!=null},children:N})};return r&&(x.route.ErrorBoundary||x.route.errorElement||y===0)?X.createElement(r3,{location:r.location,revalidation:r.revalidation,component:g,error:v,children:k(),routeContext:{outlet:null,matches:w,isDataRoute:!0},onError:h}):k()},null)}function rv(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function b8(e){let t=X.useContext(eu);return Yr(t,rv(e)),t}function w8(e){let t=X.useContext(X0);return Yr(t,rv(e)),t}function _8(e){let t=X.useContext(mn);return Yr(t,rv(e)),t}function sv(e){let t=_8(e),r=t.matches[t.matches.length-1];return Yr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function N8(){return sv("useRouteId")}function S8(){let e=X.useContext(tv),t=w8("useRouteError"),r=sv("useRouteError");return e!==void 0?e:t.errors?.[r]}function k8(){let{router:e}=b8("useNavigate"),t=sv("useNavigate"),r=X.useRef(!1);return QE(()=>{r.current=!0}),X.useCallback(async(a,o={})=>{fn(r.current,ZE),r.current&&(typeof a=="number"?await e.navigate(a):await e.navigate(a,{fromRouteId:t,...o}))},[e,t])}var _N={};function s3(e,t,r){!t&&!_N[e]&&(_N[e]=!0,fn(!1,r))}X.memo(E8);function E8({routes:e,future:t,state:r,onError:s}){return t3(e,void 0,r,s,t)}function Cc({to:e,replace:t,state:r,relative:s}){Yr(tu(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=X.useContext(Ha);fn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=X.useContext(mn),{pathname:l}=ki(),u=ru(),d=ev(e,Qy(o),l,s==="path"),h=JSON.stringify(d);return X.useEffect(()=>{u(JSON.parse(h),{replace:t,state:r,relative:s})},[u,h,s,t,r]),null}function j8(e){return h8(e.context)}function Ur(e){Yr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function T8({basename:e="/",children:t=null,location:r,navigationType:s="POP",navigator:a,static:o=!1,unstable_useTransitions:l}){Yr(!tu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=e.replace(/^\/*/,"/"),d=X.useMemo(()=>({basename:u,navigator:a,static:o,unstable_useTransitions:l,future:{}}),[u,a,o,l]);typeof r=="string"&&(r=Qc(r));let{pathname:h="/",search:m="",hash:x="",state:y=null,key:v="default"}=r,b=X.useMemo(()=>{let g=wi(h,u);return g==null?null:{location:{pathname:g,search:m,hash:x,state:y,key:v},navigationType:s}},[u,h,m,x,y,v,s]);return fn(b!=null,`<Router basename="${u}"> is not able to match the URL "${h}${m}${x}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:X.createElement(Ha.Provider,{value:d},X.createElement(Zd.Provider,{children:t,value:b}))}function A8({children:e,location:t}){return m8(dy(e),t)}function dy(e,t=[]){let r=[];return X.Children.forEach(e,(s,a)=>{if(!X.isValidElement(s))return;let o=[...t,a];if(s.type===X.Fragment){r.push.apply(r,dy(s.props.children,o));return}Yr(s.type===Ur,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Yr(!s.props.index||!s.props.children,"An index route cannot have child routes.");let l={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(l.children=dy(s.props.children,o)),r.push(l)}),r}var d0="get",f0="application/x-www-form-urlencoded";function Y0(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function C8(e){return Y0(e)&&e.tagName.toLowerCase()==="button"}function R8(e){return Y0(e)&&e.tagName.toLowerCase()==="form"}function D8(e){return Y0(e)&&e.tagName.toLowerCase()==="input"}function O8(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function F8(e,t){return e.button===0&&(!t||t==="_self")&&!O8(e)}var Ah=null;function L8(){if(Ah===null)try{new FormData(document.createElement("form"),0),Ah=!1}catch{Ah=!0}return Ah}var I8=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ux(e){return e!=null&&!I8.has(e)?(fn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${f0}"`),null):e}function M8(e,t){let r,s,a,o,l;if(R8(e)){let u=e.getAttribute("action");s=u?wi(u,t):null,r=e.getAttribute("method")||d0,a=Ux(e.getAttribute("enctype"))||f0,o=new FormData(e)}else if(C8(e)||D8(e)&&(e.type==="submit"||e.type==="image")){let u=e.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||u.getAttribute("action");if(s=d?wi(d,t):null,r=e.getAttribute("formmethod")||u.getAttribute("method")||d0,a=Ux(e.getAttribute("formenctype"))||Ux(u.getAttribute("enctype"))||f0,o=new FormData(u,e),!L8()){let{name:h,type:m,value:x}=e;if(m==="image"){let y=h?`${h}.`:"";o.append(`${y}x`,"0"),o.append(`${y}y`,"0")}else h&&o.append(h,x)}}else{if(Y0(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=d0,s=null,a=f0,l=e}return o&&a==="text/plain"&&(l=o,o=void 0),{action:s,method:r.toLowerCase(),encType:a,formData:o,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function av(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function B8(e,t,r,s){let a=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${s}`:a.pathname=`${a.pathname}.${s}`:a.pathname==="/"?a.pathname=`_root.${s}`:t&&wi(a.pathname,t)==="/"?a.pathname=`${t.replace(/\/$/,"")}/_root.${s}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${s}`,a}async function P8(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function U8(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function z8(e,t,r){let s=await Promise.all(e.map(async a=>{let o=t.routes[a.route.id];if(o){let l=await P8(o,r);return l.links?l.links():[]}return[]}));return W8(s.flat(1).filter(U8).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function NN(e,t,r,s,a,o){let l=(d,h)=>r[h]?d.route.id!==r[h].route.id:!0,u=(d,h)=>r[h].pathname!==d.pathname||r[h].route.path?.endsWith("*")&&r[h].params["*"]!==d.params["*"];return o==="assets"?t.filter((d,h)=>l(d,h)||u(d,h)):o==="data"?t.filter((d,h)=>{let m=s.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(l(d,h)||u(d,h))return!0;if(d.route.shouldRevalidate){let x=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function $8(e,t,{includeHydrateFallback:r}={}){return q8(e.map(s=>{let a=t.routes[s.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function q8(e){return[...new Set(e)]}function H8(e){let t={},r=Object.keys(e).sort();for(let s of r)t[s]=e[s];return t}function W8(e,t){let r=new Set;return new Set(t),e.reduce((s,a)=>{let o=JSON.stringify(H8(a));return r.has(o)||(r.add(o),s.push({key:o,link:a})),s},[])}function a3(){let e=X.useContext(eu);return av(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function G8(){let e=X.useContext(X0);return av(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var nv=X.createContext(void 0);nv.displayName="FrameworkContext";function n3(){let e=X.useContext(nv);return av(e,"You must render this element inside a <HydratedRouter> element"),e}function V8(e,t){let r=X.useContext(nv),[s,a]=X.useState(!1),[o,l]=X.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:h,onMouseLeave:m,onTouchStart:x}=t,y=X.useRef(null);X.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let g=w=>{w.forEach(k=>{l(k.isIntersecting)})},_=new IntersectionObserver(g,{threshold:.5});return y.current&&_.observe(y.current),()=>{_.disconnect()}}},[e]),X.useEffect(()=>{if(s){let g=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(g)}}},[s]);let v=()=>{a(!0)},b=()=>{a(!1),l(!1)};return r?e!=="intent"?[o,y,{}]:[o,y,{onFocus:Ju(u,v),onBlur:Ju(d,b),onMouseEnter:Ju(h,v),onMouseLeave:Ju(m,b),onTouchStart:Ju(x,v)}]:[!1,y,{}]}function Ju(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function K8({page:e,...t}){let{router:r}=a3(),s=X.useMemo(()=>qE(r.routes,e,r.basename),[r.routes,e,r.basename]);return s?X.createElement(Y8,{page:e,matches:s,...t}):null}function X8(e){let{manifest:t,routeModules:r}=n3(),[s,a]=X.useState([]);return X.useEffect(()=>{let o=!1;return z8(e,t,r).then(l=>{o||a(l)}),()=>{o=!0}},[e,t,r]),s}function Y8({page:e,matches:t,...r}){let s=ki(),{future:a,manifest:o,routeModules:l}=n3(),{basename:u}=a3(),{loaderData:d,matches:h}=G8(),m=X.useMemo(()=>NN(e,t,h,o,s,"data"),[e,t,h,o,s]),x=X.useMemo(()=>NN(e,t,h,o,s,"assets"),[e,t,h,o,s]),y=X.useMemo(()=>{if(e===s.pathname+s.search+s.hash)return[];let g=new Set,_=!1;if(t.forEach(k=>{let N=o.routes[k.route.id];!N||!N.hasLoader||(!m.some(E=>E.route.id===k.route.id)&&k.route.id in d&&l[k.route.id]?.shouldRevalidate||N.hasClientLoader?_=!0:g.add(k.route.id))}),g.size===0)return[];let w=B8(e,u,a.unstable_trailingSlashAwareDataRequests,"data");return _&&g.size>0&&w.searchParams.set("_routes",t.filter(k=>g.has(k.route.id)).map(k=>k.route.id).join(",")),[w.pathname+w.search]},[u,a.unstable_trailingSlashAwareDataRequests,d,s,o,m,t,e,l]),v=X.useMemo(()=>$8(x,o),[x,o]),b=X8(x);return X.createElement(X.Fragment,null,y.map(g=>X.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...r})),v.map(g=>X.createElement("link",{key:g,rel:"modulepreload",href:g,...r})),b.map(({key:g,link:_})=>X.createElement("link",{key:g,nonce:r.nonce,..._})))}function J8(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var Z8=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Z8&&(window.__reactRouterVersion="7.12.0")}catch{}function Q8({basename:e,children:t,unstable_useTransitions:r,window:s}){let a=X.useRef();a.current==null&&(a.current=CC({window:s,v5Compat:!0}));let o=a.current,[l,u]=X.useState({action:o.action,location:o.location}),d=X.useCallback(h=>{r===!1?u(h):X.startTransition(()=>u(h))},[r]);return X.useLayoutEffect(()=>o.listen(d),[o,d]),X.createElement(T8,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,unstable_useTransitions:r})}var i3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vs=X.forwardRef(function({onClick:t,discover:r="render",prefetch:s="none",relative:a,reloadDocument:o,replace:l,state:u,target:d,to:h,preventScrollReset:m,viewTransition:x,unstable_defaultShouldRevalidate:y,...v},b){let{basename:g,unstable_useTransitions:_}=X.useContext(Ha),w=typeof h=="string"&&i3.test(h),k=KE(h,g);h=k.to;let N=u8(h,{relative:a}),[E,C,L]=V8(s,v),O=rR(h,{replace:l,state:u,target:d,preventScrollReset:m,relative:a,viewTransition:x,unstable_defaultShouldRevalidate:y,unstable_useTransitions:_});function B(q){t&&t(q),q.defaultPrevented||O(q)}let F=X.createElement("a",{...v,...L,href:k.absoluteURL||N,onClick:k.isExternal||o?t:B,ref:J8(b,C),target:d,"data-discover":!w&&r==="render"?"true":void 0});return E&&!w?X.createElement(X.Fragment,null,F,X.createElement(K8,{page:N})):F});Vs.displayName="Link";var fy=X.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:s="",end:a=!1,style:o,to:l,viewTransition:u,children:d,...h},m){let x=Qd(l,{relative:h.relative}),y=ki(),v=X.useContext(X0),{navigator:b,basename:g}=X.useContext(Ha),_=v!=null&&oR(x)&&u===!0,w=b.encodeLocation?b.encodeLocation(x).pathname:x.pathname,k=y.pathname,N=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(k=k.toLowerCase(),N=N?N.toLowerCase():null,w=w.toLowerCase()),N&&g&&(N=wi(N,g)||N);const E=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let C=k===w||!a&&k.startsWith(w)&&k.charAt(E)==="/",L=N!=null&&(N===w||!a&&N.startsWith(w)&&N.charAt(w.length)==="/"),O={isActive:C,isPending:L,isTransitioning:_},B=C?t:void 0,F;typeof s=="function"?F=s(O):F=[s,C?"active":null,L?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let q=typeof o=="function"?o(O):o;return X.createElement(Vs,{...h,"aria-current":B,className:F,ref:m,style:q,to:l,viewTransition:u},typeof d=="function"?d(O):d)});fy.displayName="NavLink";var eR=X.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:s,replace:a,state:o,method:l=d0,action:u,onSubmit:d,relative:h,preventScrollReset:m,viewTransition:x,unstable_defaultShouldRevalidate:y,...v},b)=>{let{unstable_useTransitions:g}=X.useContext(Ha),_=nR(),w=iR(u,{relative:h}),k=l.toLowerCase()==="get"?"get":"post",N=typeof u=="string"&&i3.test(u),E=C=>{if(d&&d(C),C.defaultPrevented)return;C.preventDefault();let L=C.nativeEvent.submitter,O=L?.getAttribute("formmethod")||l,B=()=>_(L||C.currentTarget,{fetcherKey:t,method:O,navigate:r,replace:a,state:o,relative:h,preventScrollReset:m,viewTransition:x,unstable_defaultShouldRevalidate:y});g&&r!==!1?X.startTransition(()=>B()):B()};return X.createElement("form",{ref:b,method:k,action:w,onSubmit:s?d:E,...v,"data-discover":!N&&e==="render"?"true":void 0})});eR.displayName="Form";function tR(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function o3(e){let t=X.useContext(eu);return Yr(t,tR(e)),t}function rR(e,{target:t,replace:r,state:s,preventScrollReset:a,relative:o,viewTransition:l,unstable_defaultShouldRevalidate:u,unstable_useTransitions:d}={}){let h=ru(),m=ki(),x=Qd(e,{relative:o});return X.useCallback(y=>{if(F8(y,t)){y.preventDefault();let v=r!==void 0?r:kd(m)===kd(x),b=()=>h(e,{replace:v,state:s,preventScrollReset:a,relative:o,viewTransition:l,unstable_defaultShouldRevalidate:u});d?X.startTransition(()=>b()):b()}},[m,h,x,r,s,t,e,a,o,l,u,d])}var sR=0,aR=()=>`__${String(++sR)}__`;function nR(){let{router:e}=o3("useSubmit"),{basename:t}=X.useContext(Ha),r=N8(),s=e.fetch,a=e.navigate;return X.useCallback(async(o,l={})=>{let{action:u,method:d,encType:h,formData:m,body:x}=M8(o,t);if(l.navigate===!1){let y=l.fetcherKey||aR();await s(y,r,l.action||u,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:m,body:x,formMethod:l.method||d,formEncType:l.encType||h,flushSync:l.flushSync})}else await a(l.action||u,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:m,body:x,formMethod:l.method||d,formEncType:l.encType||h,replace:l.replace,state:l.state,fromRouteId:r,flushSync:l.flushSync,viewTransition:l.viewTransition})},[s,a,t,r])}function iR(e,{relative:t}={}){let{basename:r}=X.useContext(Ha),s=X.useContext(mn);Yr(s,"useFormAction must be used inside a RouteContext");let[a]=s.matches.slice(-1),o={...Qd(e||".",{relative:t})},l=ki();if(e==null){o.search=l.search;let u=new URLSearchParams(o.search),d=u.getAll("index");if(d.some(m=>m==="")){u.delete("index"),d.filter(x=>x).forEach(x=>u.append("index",x));let m=u.toString();o.search=m?`?${m}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(o.pathname=o.pathname==="/"?r:gi([r,o.pathname])),kd(o)}function oR(e,{relative:t}={}){let r=X.useContext(YE);Yr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=o3("useViewTransitionState"),a=Qd(e,{relative:t});if(!r.isTransitioning)return!1;let o=wi(r.currentLocation.pathname,s)||r.currentLocation.pathname,l=wi(r.nextLocation.pathname,s)||r.nextLocation.pathname;return S0(a.pathname,l)!=null||S0(a.pathname,o)!=null}const lR={};var hy=null;function cR(e){try{return crypto.getRandomValues(new Uint8Array(e))}catch{}try{return lR.randomBytes(e)}catch{}if(!hy)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return hy(e)}function uR(e){hy=e}function iv(e,t){if(e=e||ov,typeof e!="number")throw Error("Illegal arguments: "+typeof e+", "+typeof t);e<4?e=4:e>31&&(e=31);var r=[];return r.push("$2b$"),e<10&&r.push("0"),r.push(e.toString()),r.push("$"),r.push(k0(cR(Ed),Ed)),r.join("")}function l3(e,t,r){if(typeof t=="function"&&(r=t,t=void 0),typeof e=="function"&&(r=e,e=void 0),typeof e>"u")e=ov;else if(typeof e!="number")throw Error("illegal arguments: "+typeof e);function s(a){Nn(function(){try{a(null,iv(e))}catch(o){a(o)}})}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);s(r)}else return new Promise(function(a,o){s(function(l,u){if(l){o(l);return}a(u)})})}function c3(e,t){if(typeof t>"u"&&(t=ov),typeof t=="number"&&(t=iv(t)),typeof e!="string"||typeof t!="string")throw Error("Illegal arguments: "+typeof e+", "+typeof t);return my(e,t)}function u3(e,t,r,s){function a(o){typeof e=="string"&&typeof t=="number"?l3(t,function(l,u){my(e,u,o,s)}):typeof e=="string"&&typeof t=="string"?my(e,t,o,s):Nn(o.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)))}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);a(r)}else return new Promise(function(o,l){a(function(u,d){if(u){l(u);return}o(d)})})}function d3(e,t){for(var r=e.length^t.length,s=0;s<e.length;++s)r|=e.charCodeAt(s)^t.charCodeAt(s);return r===0}function dR(e,t){if(typeof e!="string"||typeof t!="string")throw Error("Illegal arguments: "+typeof e+", "+typeof t);return t.length!==60?!1:d3(c3(e,t.substring(0,t.length-31)),t)}function fR(e,t,r,s){function a(o){if(typeof e!="string"||typeof t!="string"){Nn(o.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)));return}if(t.length!==60){Nn(o.bind(this,null,!1));return}u3(e,t.substring(0,29),function(l,u){l?o(l):o(null,d3(u,t))},s)}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);a(r)}else return new Promise(function(o,l){a(function(u,d){if(u){l(u);return}o(d)})})}function hR(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)}function mR(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);if(e.length!==60)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)}function pR(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);return f3(e)>72}var Nn=typeof setImmediate=="function"?setImmediate:typeof scheduler=="object"&&typeof scheduler.postTask=="function"?scheduler.postTask.bind(scheduler):setTimeout;function f3(e){for(var t=0,r=0,s=0;s<e.length;++s)r=e.charCodeAt(s),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(s+1)&64512)===56320?(++s,t+=4):t+=3;return t}function xR(e){for(var t=0,r,s,a=new Array(f3(e)),o=0,l=e.length;o<l;++o)r=e.charCodeAt(o),r<128?a[t++]=r:r<2048?(a[t++]=r>>6|192,a[t++]=r&63|128):(r&64512)===55296&&((s=e.charCodeAt(o+1))&64512)===56320?(r=65536+((r&1023)<<10)+(s&1023),++o,a[t++]=r>>18|240,a[t++]=r>>12&63|128,a[t++]=r>>6&63|128,a[t++]=r&63|128):(a[t++]=r>>12|224,a[t++]=r>>6&63|128,a[t++]=r&63|128);return a}var lc="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),so=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function k0(e,t){var r=0,s=[],a,o;if(t<=0||t>e.length)throw Error("Illegal len: "+t);for(;r<t;){if(a=e[r++]&255,s.push(lc[a>>2&63]),a=(a&3)<<4,r>=t){s.push(lc[a&63]);break}if(o=e[r++]&255,a|=o>>4&15,s.push(lc[a&63]),a=(o&15)<<2,r>=t){s.push(lc[a&63]);break}o=e[r++]&255,a|=o>>6&3,s.push(lc[a&63]),s.push(lc[o&63])}return s.join("")}function h3(e,t){var r=0,s=e.length,a=0,o=[],l,u,d,h,m,x;if(t<=0)throw Error("Illegal len: "+t);for(;r<s-1&&a<t&&(x=e.charCodeAt(r++),l=x<so.length?so[x]:-1,x=e.charCodeAt(r++),u=x<so.length?so[x]:-1,!(l==-1||u==-1||(m=l<<2>>>0,m|=(u&48)>>4,o.push(String.fromCharCode(m)),++a>=t||r>=s)||(x=e.charCodeAt(r++),d=x<so.length?so[x]:-1,d==-1)||(m=(u&15)<<4>>>0,m|=(d&60)>>2,o.push(String.fromCharCode(m)),++a>=t||r>=s)));)x=e.charCodeAt(r++),h=x<so.length?so[x]:-1,m=(d&3)<<6>>>0,m|=h,o.push(String.fromCharCode(m)),++a;var y=[];for(r=0;r<a;r++)y.push(o[r].charCodeAt(0));return y}var Ed=16,ov=10,gR=16,yR=100,SN=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],kN=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],m3=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function jd(e,t,r,s){var a,o=e[t],l=e[t+1];return o^=r[0],a=s[o>>>24],a+=s[256|o>>16&255],a^=s[512|o>>8&255],a+=s[768|o&255],l^=a^r[1],a=s[l>>>24],a+=s[256|l>>16&255],a^=s[512|l>>8&255],a+=s[768|l&255],o^=a^r[2],a=s[o>>>24],a+=s[256|o>>16&255],a^=s[512|o>>8&255],a+=s[768|o&255],l^=a^r[3],a=s[l>>>24],a+=s[256|l>>16&255],a^=s[512|l>>8&255],a+=s[768|l&255],o^=a^r[4],a=s[o>>>24],a+=s[256|o>>16&255],a^=s[512|o>>8&255],a+=s[768|o&255],l^=a^r[5],a=s[l>>>24],a+=s[256|l>>16&255],a^=s[512|l>>8&255],a+=s[768|l&255],o^=a^r[6],a=s[o>>>24],a+=s[256|o>>16&255],a^=s[512|o>>8&255],a+=s[768|o&255],l^=a^r[7],a=s[l>>>24],a+=s[256|l>>16&255],a^=s[512|l>>8&255],a+=s[768|l&255],o^=a^r[8],a=s[o>>>24],a+=s[256|o>>16&255],a^=s[512|o>>8&255],a+=s[768|o&255],l^=a^r[9],a=s[l>>>24],a+=s[256|l>>16&255],a^=s[512|l>>8&255],a+=s[768|l&255],o^=a^r[10],a=s[o>>>24],a+=s[256|o>>16&255],a^=s[512|o>>8&255],a+=s[768|o&255],l^=a^r[11],a=s[l>>>24],a+=s[256|l>>16&255],a^=s[512|l>>8&255],a+=s[768|l&255],o^=a^r[12],a=s[o>>>24],a+=s[256|o>>16&255],a^=s[512|o>>8&255],a+=s[768|o&255],l^=a^r[13],a=s[l>>>24],a+=s[256|l>>16&255],a^=s[512|l>>8&255],a+=s[768|l&255],o^=a^r[14],a=s[o>>>24],a+=s[256|o>>16&255],a^=s[512|o>>8&255],a+=s[768|o&255],l^=a^r[15],a=s[l>>>24],a+=s[256|l>>16&255],a^=s[512|l>>8&255],a+=s[768|l&255],o^=a^r[16],e[t]=l^r[gR+1],e[t+1]=o,e}function wc(e,t){for(var r=0,s=0;r<4;++r)s=s<<8|e[t]&255,t=(t+1)%e.length;return{key:s,offp:t}}function EN(e,t,r){for(var s=0,a=[0,0],o=t.length,l=r.length,u,d=0;d<o;d++)u=wc(e,s),s=u.offp,t[d]=t[d]^u.key;for(d=0;d<o;d+=2)a=jd(a,0,t,r),t[d]=a[0],t[d+1]=a[1];for(d=0;d<l;d+=2)a=jd(a,0,t,r),r[d]=a[0],r[d+1]=a[1]}function vR(e,t,r,s){for(var a=0,o=[0,0],l=r.length,u=s.length,d,h=0;h<l;h++)d=wc(t,a),a=d.offp,r[h]=r[h]^d.key;for(a=0,h=0;h<l;h+=2)d=wc(e,a),a=d.offp,o[0]^=d.key,d=wc(e,a),a=d.offp,o[1]^=d.key,o=jd(o,0,r,s),r[h]=o[0],r[h+1]=o[1];for(h=0;h<u;h+=2)d=wc(e,a),a=d.offp,o[0]^=d.key,d=wc(e,a),a=d.offp,o[1]^=d.key,o=jd(o,0,r,s),s[h]=o[0],s[h+1]=o[1]}function jN(e,t,r,s,a){var o=m3.slice(),l=o.length,u;if(r<4||r>31)if(u=Error("Illegal number of rounds (4-31): "+r),s){Nn(s.bind(this,u));return}else throw u;if(t.length!==Ed)if(u=Error("Illegal salt length: "+t.length+" != "+Ed),s){Nn(s.bind(this,u));return}else throw u;r=1<<r>>>0;var d,h,m=0,x;typeof Int32Array=="function"?(d=new Int32Array(SN),h=new Int32Array(kN)):(d=SN.slice(),h=kN.slice()),vR(t,e,d,h);function y(){if(a&&a(m/r),m<r)for(var b=Date.now();m<r&&(m=m+1,EN(e,d,h),EN(t,d,h),!(Date.now()-b>yR)););else{for(m=0;m<64;m++)for(x=0;x<l>>1;x++)jd(o,x<<1,d,h);var g=[];for(m=0;m<l;m++)g.push((o[m]>>24&255)>>>0),g.push((o[m]>>16&255)>>>0),g.push((o[m]>>8&255)>>>0),g.push((o[m]&255)>>>0);if(s){s(null,g);return}else return g}s&&Nn(y)}if(typeof s<"u")y();else for(var v;;)if(typeof(v=y())<"u")return v||[]}function my(e,t,r,s){var a;if(typeof e!="string"||typeof t!="string")if(a=Error("Invalid string / salt: Not a string"),r){Nn(r.bind(this,a));return}else throw a;var o,l;if(t.charAt(0)!=="$"||t.charAt(1)!=="2")if(a=Error("Invalid salt version: "+t.substring(0,2)),r){Nn(r.bind(this,a));return}else throw a;if(t.charAt(2)==="$")o="\0",l=3;else{if(o=t.charAt(2),o!=="a"&&o!=="b"&&o!=="y"||t.charAt(3)!=="$")if(a=Error("Invalid salt revision: "+t.substring(2,4)),r){Nn(r.bind(this,a));return}else throw a;l=4}if(t.charAt(l+2)>"$")if(a=Error("Missing salt rounds"),r){Nn(r.bind(this,a));return}else throw a;var u=parseInt(t.substring(l,l+1),10)*10,d=parseInt(t.substring(l+1,l+2),10),h=u+d,m=t.substring(l+3,l+25);e+=o>="a"?"\0":"";var x=xR(e),y=h3(m,Ed);function v(b){var g=[];return g.push("$2"),o>="a"&&g.push(o),g.push("$"),h<10&&g.push("0"),g.push(h.toString()),g.push("$"),g.push(k0(y,y.length)),g.push(k0(b,m3.length*4-1)),g.join("")}if(typeof r>"u")return v(jN(x,y,h));jN(x,y,h,function(b,g){b?r(b,null):r(null,v(g))},s)}function bR(e,t){return k0(e,t)}function wR(e,t){return h3(e,t)}const zx={setRandomFallback:uR,genSaltSync:iv,genSalt:l3,hashSync:c3,hash:u3,compareSync:dR,compare:fR,getRounds:hR,getSalt:mR,truncates:pR,encodeBase64:bR,decodeBase64:wR};function J0(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r}function _R(e,t,r,s){function a(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function u(m){try{h(s.next(m))}catch(x){l(x)}}function d(m){try{h(s.throw(m))}catch(x){l(x)}}function h(m){m.done?o(m.value):a(m.value).then(u,d)}h((s=s.apply(e,t||[])).next())})}const NR=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class lv extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class SR extends lv{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class TN extends lv{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class AN extends lv{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var py;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(py||(py={}));class kR{constructor(t,{headers:r={},customFetch:s,region:a=py.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=NR(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return _R(this,arguments,void 0,function*(r,s={}){var a;let o,l;try{const{headers:u,method:d,body:h,signal:m,timeout:x}=s;let y={},{region:v}=s;v||(v=this.region);const b=new URL(`${this.url}/${r}`);v&&v!=="any"&&(y["x-region"]=v,b.searchParams.set("forceFunctionRegion",v));let g;h&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",g=h):typeof h=="string"?(y["Content-Type"]="text/plain",g=h):typeof FormData<"u"&&h instanceof FormData?g=h:(y["Content-Type"]="application/json",g=JSON.stringify(h)):h&&typeof h!="string"&&!(typeof Blob<"u"&&h instanceof Blob)&&!(h instanceof ArrayBuffer)&&!(typeof FormData<"u"&&h instanceof FormData)?g=JSON.stringify(h):g=h;let _=m;x&&(l=new AbortController,o=setTimeout(()=>l.abort(),x),m?(_=l.signal,m.addEventListener("abort",()=>l.abort())):_=l.signal);const w=yield this.fetch(b.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),u),body:g,signal:_}).catch(C=>{throw new SR(C)}),k=w.headers.get("x-relay-error");if(k&&k==="true")throw new TN(w);if(!w.ok)throw new AN(w);let N=((a=w.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),E;return N==="application/json"?E=yield w.json():N==="application/octet-stream"||N==="application/pdf"?E=yield w.blob():N==="text/event-stream"?E=w:N==="multipart/form-data"?E=yield w.formData():E=yield w.text(),{data:E,error:null,response:w}}catch(u){return{data:null,error:u,response:u instanceof AN||u instanceof TN?u.context:void 0}}finally{o&&clearTimeout(o)}})}}var ER=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},jR=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let a=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{let l=null,u=null,d=null,h=o.status,m=o.statusText;if(o.ok){var x,y;if(r.method!=="HEAD"){var v;const w=await o.text();w===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((v=r.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?u=w:u=JSON.parse(w))}const g=(x=r.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),_=(y=o.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");g&&_&&_.length>1&&(d=parseInt(_[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(u)&&(u.length>1?(l={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,h=406,m="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var b;const g=await o.text();try{l=JSON.parse(g),Array.isArray(l)&&o.status===404&&(u=[],l=null,h=200,m="OK")}catch{o.status===404&&g===""?(h=204,m="No Content"):l={message:g}}if(l&&r.isMaybeSingle&&(!(l==null||(b=l.details)===null||b===void 0)&&b.includes("0 rows"))&&(l=null,h=200,m="OK"),l&&r.shouldThrowOnError)throw new ER(l)}return{error:l,data:u,count:d,status:h,statusText:m}});return this.shouldThrowOnError||(a=a.catch(o=>{var l;let u="";const d=o?.cause;if(d){var h,m,x,y;const b=(h=d?.message)!==null&&h!==void 0?h:"",g=(m=d?.code)!==null&&m!==void 0?m:"";u=`${(x=o?.name)!==null&&x!==void 0?x:"FetchError"}: ${o?.message}`,u+=`

Caused by: ${(y=d?.name)!==null&&y!==void 0?y:"Error"}: ${b}`,g&&(u+=` (${g})`),d?.stack&&(u+=`
${d.stack}`)}else{var v;u=(v=o?.stack)!==null&&v!==void 0?v:""}return{error:{message:`${(l=o?.name)!==null&&l!==void 0?l:"FetchError"}: ${o?.message}`,details:u,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},TR=class extends jR{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:a=s}={}){const o=a?`${a}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const a=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:a=!1,format:o="text"}={}){var l;const u=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${u};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const CN=new RegExp("[,()]");var _c=class extends TR{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&CN.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&CN.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},AR=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:s}=t??{},a=r?"HEAD":"GET";let o=!1;const l=(e??"*").split("").map(h=>/\s/.test(h)&&!o?"":(h==='"'&&(o=!o),h)).join(""),{url:u,headers:d}=this.cloneRequestState();return u.searchParams.set("select",l),s&&d.append("Prefer",`count=${s}`),new _c({method:a,url:u,headers:d,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var s;const a="POST",{url:o,headers:l}=this.cloneRequestState();if(t&&l.append("Prefer",`count=${t}`),r||l.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);o.searchParams.set("columns",d.join(","))}}return new _c({method:a,url:o,headers:l,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:a=!0}={}){var o;const l="POST",{url:u,headers:d}=this.cloneRequestState();if(d.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&u.searchParams.set("on_conflict",t),s&&d.append("Prefer",`count=${s}`),a||d.append("Prefer","missing=default"),Array.isArray(e)){const h=e.reduce((m,x)=>m.concat(Object.keys(x)),[]);if(h.length>0){const m=[...new Set(h)].map(x=>`"${x}"`);u.searchParams.set("columns",m.join(","))}}return new _c({method:l,url:u,headers:d,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:t}={}){var r;const s="PATCH",{url:a,headers:o}=this.cloneRequestState();return t&&o.append("Prefer",`count=${t}`),new _c({method:s,url:a,headers:o,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:s,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new _c({method:r,url:s,headers:a,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},CR=class p3{constructor(t,{headers:r={},schema:s,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=s,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new AR(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new p3(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:s=!1,get:a=!1,count:o}={}){var l;let u;const d=new URL(`${this.url}/rpc/${t}`);let h;const m=v=>v!==null&&typeof v=="object"&&(!Array.isArray(v)||v.some(m)),x=s&&Object.values(r).some(m);x?(u="POST",h=r):s||a?(u=s?"HEAD":"GET",Object.entries(r).filter(([v,b])=>b!==void 0).map(([v,b])=>[v,Array.isArray(b)?`{${b.join(",")}}`:`${b}`]).forEach(([v,b])=>{d.searchParams.append(v,b)})):(u="POST",h=r);const y=new Headers(this.headers);return x?y.set("Prefer",o?`count=${o},return=minimal`:"return=minimal"):o&&y.set("Prefer",`count=${o}`),new _c({method:u,url:d,headers:y,schema:this.schemaName,body:h,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class RR{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const s=r.versions;if(s&&s.node){const a=s.node,o=parseInt(a.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const DR="2.90.1",OR=`realtime-js/${DR}`,x3="1.0.0",FR="2.0.0",RN=x3,xy=1e4,LR=1e3,IR=100;var oo;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(oo||(oo={}));var As;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(As||(As={}));var _n;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(_n||(_n={}));var gy;(function(e){e.websocket="websocket"})(gy||(gy={}));var Xo;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Xo||(Xo={}));class MR{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,s;const a=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,s;const a=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},l=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(t,r,s){var a,o;const l=t.topic,u=(a=t.ref)!==null&&a!==void 0?a:"",d=(o=t.join_ref)!==null&&o!==void 0?o:"",h=t.payload.event,m=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},x=Object.keys(m).length===0?"":JSON.stringify(m);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`userEvent length ${h.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`metadata length ${x.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+u.length+l.length+h.length+x.length,v=new ArrayBuffer(this.HEADER_LENGTH+y);let b=new DataView(v),g=0;b.setUint8(g++,this.KINDS.userBroadcastPush),b.setUint8(g++,d.length),b.setUint8(g++,u.length),b.setUint8(g++,l.length),b.setUint8(g++,h.length),b.setUint8(g++,x.length),b.setUint8(g++,r),Array.from(d,w=>b.setUint8(g++,w.charCodeAt(0))),Array.from(u,w=>b.setUint8(g++,w.charCodeAt(0))),Array.from(l,w=>b.setUint8(g++,w.charCodeAt(0))),Array.from(h,w=>b.setUint8(g++,w.charCodeAt(0))),Array.from(x,w=>b.setUint8(g++,w.charCodeAt(0)));var _=new Uint8Array(v.byteLength+s.byteLength);return _.set(new Uint8Array(v),0),_.set(new Uint8Array(s),v.byteLength),_.buffer}decode(t,r){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return r(s)}if(typeof t=="string"){const s=JSON.parse(t),[a,o,l,u,d]=s;return r({join_ref:a,ref:o,topic:l,event:u,payload:d})}return r({})}_binaryDecode(t){const r=new DataView(t),s=r.getUint8(0),a=new TextDecoder;if(s===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,r,a)}_decodeUserBroadcast(t,r,s){const a=r.getUint8(1),o=r.getUint8(2),l=r.getUint8(3),u=r.getUint8(4);let d=this.HEADER_LENGTH+4;const h=s.decode(t.slice(d,d+a));d=d+a;const m=s.decode(t.slice(d,d+o));d=d+o;const x=s.decode(t.slice(d,d+l));d=d+l;const y=t.slice(d,t.byteLength),v=u===this.JSON_ENCODING?JSON.parse(s.decode(y)):y,b={type:this.BROADCAST_EVENT,event:m,payload:v};return l>0&&(b.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([s])=>r.includes(s)))}}class g3{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var zr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(zr||(zr={}));const DN=(e,t,r={})=>{var s;const a=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((o,l)=>(o[l]=BR(l,e,t,a),o),{}):{}},BR=(e,t,r,s)=>{const a=t.find(u=>u.name===e),o=a?.type,l=r[e];return o&&!s.includes(o)?y3(o,l):yy(l)},y3=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return $R(t,r)}switch(e){case zr.bool:return PR(t);case zr.float4:case zr.float8:case zr.int2:case zr.int4:case zr.int8:case zr.numeric:case zr.oid:return UR(t);case zr.json:case zr.jsonb:return zR(t);case zr.timestamp:return qR(t);case zr.abstime:case zr.date:case zr.daterange:case zr.int4range:case zr.int8range:case zr.money:case zr.reltime:case zr.text:case zr.time:case zr.timestamptz:case zr.timetz:case zr.tsrange:case zr.tstzrange:return yy(t);default:return yy(t)}},yy=e=>e,PR=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},UR=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},zR=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},$R=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,s=e[r];if(e[0]==="{"&&s==="}"){let o;const l=e.slice(1,r);try{o=JSON.parse("["+l+"]")}catch{o=l?l.split(","):[]}return o.map(u=>y3(t,u))}return e},qR=e=>typeof e=="string"?e.replace(" ","T"):e,v3=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class $x{constructor(t,r,s={},a=xy){this.channel=t,this.event=r,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var ON;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(ON||(ON={}));class hd{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:o,onLeave:l,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=hd.syncState(this.state,a,o,l),this.pendingDiffs.forEach(d=>{this.state=hd.syncDiff(this.state,d,o,l)}),this.pendingDiffs=[],u()}),this.channel._on(s.diff,{},a=>{const{onJoin:o,onLeave:l,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=hd.syncDiff(this.state,a,o,l),u())}),this.onJoin((a,o,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:o,newPresences:l})}),this.onLeave((a,o,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:o,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,a){const o=this.cloneDeep(t),l=this.transformState(r),u={},d={};return this.map(o,(h,m)=>{l[h]||(d[h]=m)}),this.map(l,(h,m)=>{const x=o[h];if(x){const y=m.map(_=>_.presence_ref),v=x.map(_=>_.presence_ref),b=m.filter(_=>v.indexOf(_.presence_ref)<0),g=x.filter(_=>y.indexOf(_.presence_ref)<0);b.length>0&&(u[h]=b),g.length>0&&(d[h]=g)}else u[h]=m}),this.syncDiff(o,{joins:u,leaves:d},s,a)}static syncDiff(t,r,s,a){const{joins:o,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(o,(u,d)=>{var h;const m=(h=t[u])!==null&&h!==void 0?h:[];if(t[u]=this.cloneDeep(d),m.length>0){const x=t[u].map(v=>v.presence_ref),y=m.filter(v=>x.indexOf(v.presence_ref)<0);t[u].unshift(...y)}s(u,m,d)}),this.map(l,(u,d)=>{let h=t[u];if(!h)return;const m=d.map(x=>x.presence_ref);h=h.filter(x=>m.indexOf(x.presence_ref)<0),t[u]=h,a(u,h,d),h.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const a=t[s];return"metas"in a?r[s]=a.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[s]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var FN;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(FN||(FN={}));var md;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(md||(md={}));var fi;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(fi||(fi={}));class jc{constructor(t,r={config:{}},s){var a,o;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=As.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new $x(this,_n.join,this.params,this.timeout),this.rejoinTimer=new g3(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=As.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=As.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=As.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=As.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=As.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_n.reply,{},(l,u)=>{this._trigger(this._replyEventName(u),l)}),this.presence=new hd(this),this.broadcastEndpointURL=v3(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,a,o;if(this.socket.isConnected()||this.socket.connect(),this.state==As.closed){const{config:{broadcast:l,presence:u,private:d}}=this.params,h=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(v=>v.filter))!==null&&a!==void 0?a:[],m=!!this.bindings[md.PRESENCE]&&this.bindings[md.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,x={},y={broadcast:l,presence:Object.assign(Object.assign({},u),{enabled:m}),postgres_changes:h,private:d};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(v=>t?.(fi.CHANNEL_ERROR,v)),this._onClose(()=>t?.(fi.CLOSED)),this.updateJoinPayload(Object.assign({config:y},x)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:v})=>{var b;if(this.socket._isManualToken()||this.socket.setAuth(),v===void 0){t?.(fi.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,_=(b=g?.length)!==null&&b!==void 0?b:0,w=[];for(let k=0;k<_;k++){const N=g[k],{filter:{event:E,schema:C,table:L,filter:O}}=N,B=v&&v[k];if(B&&B.event===E&&jc.isFilterValueEqual(B.schema,C)&&jc.isFilterValueEqual(B.table,L)&&jc.isFilterValueEqual(B.filter,O))w.push(Object.assign(Object.assign({},N),{id:B.id}));else{this.unsubscribe(),this.state=As.errored,t?.(fi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(fi.SUBSCRIBED);return}}).receive("error",v=>{this.state=As.errored,t?.(fi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{t?.(fi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===As.joined&&t===md.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,s)}async httpSend(t,r,s={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(a=s.timeout)!==null&&a!==void 0?a:this.timeout);if(u.status===202)return{success:!0};let d=u.statusText;try{const h=await u.json();d=h.error||h.message||d}catch{}return Promise.reject(new Error(d))}async send(t,r={}){var s,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:l}=t,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:l,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=h.body)===null||a===void 0?void 0:a.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var l,u,d;const h=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(u=(l=this.params)===null||l===void 0?void 0:l.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.ack)&&o("ok"),h.receive("ok",()=>o("ok")),h.receive("error",()=>o("error")),h.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=As.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_n.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new $x(this,_n.leave,{},t),s.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=As.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const a=new AbortController,o=setTimeout(()=>a.abort(),s),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(o),l}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new $x(this,t,r,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>IR){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var a,o;const l=t.toLocaleLowerCase(),{close:u,error:d,leave:h,join:m}=_n;if(s&&[u,d,h,m].indexOf(l)>=0&&s!==this._joinRef())return;let y=this._onMessage(l,r,s);if(r&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(v=>{var b,g,_;return((b=v.filter)===null||b===void 0?void 0:b.event)==="*"||((_=(g=v.filter)===null||g===void 0?void 0:g.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===l}).map(v=>v.callback(y,s)):(o=this.bindings[l])===null||o===void 0||o.filter(v=>{var b,g,_,w,k,N,E,C;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in v){const L=v.id,O=(b=v.filter)===null||b===void 0?void 0:b.event;return L&&((g=r.ids)===null||g===void 0?void 0:g.includes(L))&&(O==="*"||O?.toLocaleLowerCase()===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))&&(!(!((w=v.filter)===null||w===void 0)&&w.table)||v.filter.table===((k=r.data)===null||k===void 0?void 0:k.table))}else{const L=(E=(N=v?.filter)===null||N===void 0?void 0:N.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return L==="*"||L===((C=r?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===l}).map(v=>{if(typeof y=="object"&&"ids"in y){const b=y.data,{schema:g,table:_,commit_timestamp:w,type:k,errors:N}=b;y=Object.assign(Object.assign({},{schema:g,table:_,commit_timestamp:w,eventType:k,new:{},old:{},errors:N}),this._getPayloadRecords(b))}v.callback(y,s)})}_isClosed(){return this.state===As.closed}_isJoined(){return this.state===As.joined}_isJoining(){return this.state===As.joining}_isLeaving(){return this.state===As.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const a=t.toLocaleLowerCase(),o={type:a,filter:r,callback:s};return this.bindings[a]?this.bindings[a].push(o):this.bindings[a]=[o],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var o;return!(((o=a.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===s&&jc.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(_n.close,{},t)}_onError(t){this._on(_n.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=As.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=DN(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=DN(t.columns,t.old_record)),r}}const qx=()=>{},Ch={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},HR=[1e3,2e3,5e3,1e4],WR=1e4,GR=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class VR{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xy,this.transport=null,this.heartbeatIntervalMs=Ch.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=qx,this.ref=0,this.reconnectTimer=null,this.vsn=RN,this.logger=qx,this.conn=null,this.sendBuffer=[],this.serializer=new MR,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...o)=>a(...o):(...o)=>fetch(...o),!(!((s=r?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${gy.websocket}`,this.httpEndpoint=v3(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=RR.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case oo.connecting:return Xo.Connecting;case oo.open:return Xo.Open;case oo.closing:return Xo.Closing;default:return Xo.Closed}}isConnected(){return this.connectionState()===Xo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,a=this.getChannels().find(o=>o.topic===s);if(a)return a;{const o=new jc(`realtime:${t}`,r,this);return this.channels.push(o),o}}push(t){const{topic:r,event:s,payload:a,ref:o}=t,l=()=>{this.encode(t,u=>{var d;(d=this.conn)===null||d===void 0||d.send(u)})};this.log("push",`${r} ${s} (${o})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(LR,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Ch.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const h=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",h)}catch(m){this.log("error","error in heartbeat callback",m)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:a,payload:o,ref:l}=r,u=l?`(${l})`:"",d=o.status||"";this.log("receive",`${d} ${s} ${a} ${u}`.trim(),o),this.channels.filter(h=>h._isMember(s)).forEach(h=>h._trigger(a,o,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===oo.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===oo.open||this.conn.readyState===oo.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(_n.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${s}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([GR],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,s=!1;if(t)r=t,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const o={access_token:r,version:OR};r&&a.updateJoinPayload(o),a.joinedOnce&&a._isJoined()&&a._push(_n.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new g3(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ch.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,a,o,l,u,d,h,m,x,y,v;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t?.timeout)!==null&&s!==void 0?s:xy,this.heartbeatIntervalMs=(a=t?.heartbeatIntervalMs)!==null&&a!==void 0?a:Ch.HEARTBEAT_INTERVAL,this.worker=(o=t?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(l=t?.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:qx,this.vsn=(d=t?.vsn)!==null&&d!==void 0?d:RN,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=t?.reconnectAfterMs)!==null&&h!==void 0?h:(b=>HR[b-1]||WR),this.vsn){case x3:this.encode=(m=t?.encode)!==null&&m!==void 0?m:((b,g)=>g(JSON.stringify(b))),this.decode=(x=t?.decode)!==null&&x!==void 0?x:((b,g)=>g(JSON.parse(b)));break;case FR:this.encode=(y=t?.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(v=t?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var Td=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function KR(e,t,r){const s=new URL(t,e);if(r)for(const[a,o]of Object.entries(r))o!==void 0&&s.searchParams.set(a,o);return s.toString()}async function XR(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function YR(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:a,body:o,headers:l}){const u=KR(e.baseUrl,s,a),d=await XR(e.auth),h=await t(u,{method:r,headers:{...o?{"Content-Type":"application/json"}:{},...d,...l},body:o?JSON.stringify(o):void 0}),m=await h.text(),x=(h.headers.get("content-type")||"").includes("application/json"),y=x&&m?JSON.parse(m):m;if(!h.ok){const v=x?y:void 0,b=v?.error;throw new Td(b?.message??`Request failed with status ${h.status}`,{status:h.status,icebergType:b?.type,icebergCode:b?.code,details:v})}return{status:h.status,headers:h.headers,data:y}}}}function Rh(e){return e.join("")}var JR=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Rh(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Rh(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Rh(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Rh(e.namespace)}`}),!0}catch(t){if(t instanceof Td&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Td&&r.status===409)return;throw r}}};function cc(e){return e.join("")}var ZR=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${cc(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${cc(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${cc(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${cc(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${cc(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${cc(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Td&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Td&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},QR=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=YR({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new JR(this.client,t),this.tableOps=new ZR(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Z0=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Zr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var eD=class extends Z0{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},vy=class extends Z0{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const cv=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),tD=()=>Response,by=e=>{if(Array.isArray(e))return e.map(r=>by(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,s])=>{const a=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[a]=by(s)}),t},rD=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},sD=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Ad(e){"@babel/helpers - typeof";return Ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ad(e)}function aD(e,t){if(Ad(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(Ad(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nD(e){var t=aD(e,"string");return Ad(t)=="symbol"?t:t+""}function iD(e,t,r){return(t=nD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Ht(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LN(Object(r),!0).forEach(function(s){iD(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const Hx=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},oD=async(e,t,r)=>{e instanceof await tD()&&!r?.noResolveJson?e.json().then(s=>{const a=e.status||500,o=s?.statusCode||a+"";t(new eD(Hx(s),a,o))}).catch(s=>{t(new vy(Hx(s),s))}):t(new vy(Hx(e),e))},lD=(e,t,r,s)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"||!s?a:(rD(s)?(a.headers=Ht({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(s)):a.body=s,t?.duplex&&(a.duplex=t.duplex),Ht(Ht({},a),r))};async function ef(e,t,r,s,a,o){return new Promise((l,u)=>{e(r,lD(t,s,a,o)).then(d=>{if(!d.ok)throw d;return s?.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>oD(d,u,s))})}async function Cd(e,t,r,s){return ef(e,"GET",t,r,s)}async function wn(e,t,r,s,a){return ef(e,"POST",t,s,a,r)}async function wy(e,t,r,s,a){return ef(e,"PUT",t,s,a,r)}async function cD(e,t,r,s){return ef(e,"HEAD",t,Ht(Ht({},r),{},{noResolveJson:!0}),s)}async function uv(e,t,r,s,a){return ef(e,"DELETE",t,s,a,r)}var uD=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Zr(t))return{data:null,error:t};throw t}}};let b3;b3=Symbol.toStringTag;var dD=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[b3]="BlobDownloadBuilder",this.promise=null}asStream(){return new uD(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Zr(t))return{data:null,error:t};throw t}}};const fD={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},IN={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var hD=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=cv(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,s){var a=this;try{let o;const l=Ht(Ht({},IN),s);let u=Ht(Ht({},a.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",l.cacheControl),d&&o.append("metadata",a.encodeMetadata(d)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.has("cacheControl")||o.append("cacheControl",l.cacheControl),d&&!o.has("metadata")&&o.append("metadata",a.encodeMetadata(d))):(o=r,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType,d&&(u["x-metadata"]=a.toBase64(a.encodeMetadata(d))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!l.duplex&&(l.duplex="half")),s?.headers&&(u=Ht(Ht({},u),s.headers));const h=a._removeEmptyFolders(t),m=a._getFinalPath(h),x=await(e=="PUT"?wy:wn)(a.fetch,`${a.url}/object/${m}`,o,Ht({headers:u},l?.duplex?{duplex:l.duplex}:{}));return{data:{path:h,id:x.Id,fullPath:x.Key},error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(Zr(o))return{data:null,error:o};throw o}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,s){var a=this;const o=a._removeEmptyFolders(e),l=a._getFinalPath(o),u=new URL(a.url+`/object/upload/sign/${l}`);u.searchParams.set("token",t);try{let d;const h=Ht({upsert:IN.upsert},s),m=Ht(Ht({},a.headers),{"x-upsert":String(h.upsert)});return typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",h.cacheControl)):(d=r,m["cache-control"]=`max-age=${h.cacheControl}`,m["content-type"]=h.contentType),{data:{path:o,fullPath:(await wy(a.fetch,u.toString(),d,{headers:m})).Key},error:null}}catch(d){if(a.shouldThrowOnError)throw d;if(Zr(d))return{data:null,error:d};throw d}}async createSignedUploadUrl(e,t){var r=this;try{let s=r._getFinalPath(e);const a=Ht({},r.headers);t?.upsert&&(a["x-upsert"]="true");const o=await wn(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:a}),l=new URL(r.url+o.url),u=l.searchParams.get("token");if(!u)throw new Z0("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:u},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Zr(s))return{data:null,error:s};throw s}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var s=this;try{return{data:await wn(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:s.headers}),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Zr(a))return{data:null,error:a};throw a}}async copy(e,t,r){var s=this;try{return{data:{path:(await wn(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:s.headers})).Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Zr(a))return{data:null,error:a};throw a}}async createSignedUrl(e,t,r){var s=this;try{let a=s._getFinalPath(e),o=await wn(s.fetch,`${s.url}/object/sign/${a}`,Ht({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:s.headers});const l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${s.url}${o.signedURL}${l}`)},{data:o,error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Zr(a))return{data:null,error:a};throw a}}async createSignedUrls(e,t,r){var s=this;try{const a=await wn(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:t,paths:e},{headers:s.headers}),o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(l=>Ht(Ht({},l),{},{signedUrl:l.signedURL?encodeURI(`${s.url}${l.signedURL}${o}`):null})),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Zr(a))return{data:null,error:a};throw a}}download(e,t){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(t?.transform||{}),a=s?`?${s}`:"",o=this._getFinalPath(e),l=()=>Cd(this.fetch,`${this.url}/${r}/${o}${a}`,{headers:this.headers,noResolveJson:!0});return new dD(l,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:by(await Cd(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Zr(s))return{data:null,error:s};throw s}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await cD(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Zr(s)&&s instanceof vy){const a=s.originalError;if([400,404].includes(a?.status))return{data:!1,error:s}}throw s}}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&s.push(a);const o=typeof t?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(t?.transform||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${u}`)}}}async remove(e){var t=this;try{return{data:await uv(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async list(e,t,r){var s=this;try{const a=Ht(Ht(Ht({},fD),t),{},{prefix:e||""});return{data:await wn(s.fetch,`${s.url}/object/list/${s.bucketId}`,a,{headers:s.headers},r),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Zr(a))return{data:null,error:a};throw a}}async listV2(e,t){var r=this;try{const s=Ht({},e);return{data:await wn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},t),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Zr(s))return{data:null,error:s};throw s}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const w3="2.90.1",_3={"X-Client-Info":`storage-js/${w3}`};var mD=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const a=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Ht(Ht({},_3),t),this.fetch=cv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await Cd(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Cd(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await wn(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Zr(s))return{data:null,error:s};throw s}}async updateBucket(e,t){var r=this;try{return{data:await wy(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Zr(s))return{data:null,error:s};throw s}}async emptyBucket(e){var t=this;try{return{data:await wn(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await uv(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},pD=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ht(Ht({},_3),t),this.fetch=cv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await wn(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const s=r.toString(),a=s?`${t.url}/bucket?${s}`:`${t.url}/bucket`;return{data:await Cd(t.fetch,a,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await uv(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Zr(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!sD(e))throw new Z0("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new QR({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(a,o){const l=a[o];return typeof l!="function"?l:async(...u)=>{try{return{data:await l.apply(a,u),error:null}}catch(d){if(s)throw d;return{data:null,error:d}}}}})}};const dv={"X-Client-Info":`storage-js/${w3}`,"Content-Type":"application/json"};var N3=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ba(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var Wx=class extends N3{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},xD=class extends N3{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const fv=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),gD=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},MN=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),yD=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const s=e.status||500,a=e;if(typeof a.json=="function")a.json().then(o=>{const l=o?.statusCode||o?.code||s+"";t(new Wx(MN(o),s,l))}).catch(()=>{const o=s+"";t(new Wx(a.statusText||`HTTP ${s} error`,s,o))});else{const o=s+"";t(new Wx(a.statusText||`HTTP ${s} error`,s,o))}}else t(new xD(MN(e),e))},vD=(e,t,r,s)=>{const a={method:e,headers:t?.headers||{}};return s?(gD(s)?(a.headers=Ht({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(s)):a.body=s,Ht(Ht({},a),r)):a};async function bD(e,t,r,s,a,o){return new Promise((l,u)=>{e(r,vD(t,s,a,o)).then(d=>{if(!d.ok)throw d;if(s?.noResolveJson)return d;const h=d.headers.get("content-type");return!h||!h.includes("application/json")?{}:d.json()}).then(d=>l(d)).catch(d=>yD(d,u,s))})}async function Pa(e,t,r,s,a){return bD(e,"POST",t,s,a,r)}var wD=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ht(Ht({},dv),t),this.fetch=fv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ba(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Pa(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ba(s))return{data:null,error:s};throw s}}async listIndexes(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ba(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Pa(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ba(s))return{data:null,error:s};throw s}}},_D=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ht(Ht({},dv),t),this.fetch=fv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Pa(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ba(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ba(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Pa(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ba(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ba(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Pa(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ba(r))return{data:null,error:r};throw r}}},ND=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ht(Ht({},dv),t),this.fetch=fv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ba(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ba(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ba(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ba(r))return{data:null,error:r};throw r}}},SD=class extends ND{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new kD(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},kD=class extends wD{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new ED(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},ED=class extends _D{constructor(e,t,r,s,a){super(e,t,a),this.vectorBucketName=r,this.indexName=s}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},jD=class extends mD{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new hD(this.url,this.headers,e,this.fetch)}get vectors(){return new SD(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new pD(this.url+"/iceberg",this.headers,this.fetch)}};const S3="2.90.1",Nc=30*1e3,_y=3,Gx=_y*Nc,TD="http://localhost:9999",AD="supabase.auth.token",CD={"X-Client-Info":`gotrue-js/${S3}`},Ny="X-Supabase-Api-Version",k3={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},RD=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,DD=600*1e3;class Rd extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function Lt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class OD extends Rd{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function FD(e){return Lt(e)&&e.name==="AuthApiError"}class Yo extends Rd{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ei extends Rd{constructor(t,r,s,a){super(t,s,a),this.name=r,this.status=s}}class La extends Ei{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function LD(e){return Lt(e)&&e.name==="AuthSessionMissingError"}class uc extends Ei{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Dh extends Ei{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Oh extends Ei{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ID(e){return Lt(e)&&e.name==="AuthImplicitGrantRedirectError"}class BN extends Ei{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class MD extends Ei{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Sy extends Ei{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Vx(e){return Lt(e)&&e.name==="AuthRetryableFetchError"}class PN extends Ei{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class ky extends Ei{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const E0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),UN=` 	
\r=`.split(""),BD=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<UN.length;t+=1)e[UN[t].charCodeAt(0)]=-2;for(let t=0;t<E0.length;t+=1)e[E0[t].charCodeAt(0)]=t;return e})();function zN(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(E0[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(E0[s]),t.queuedBits-=6}}function E3(e,t,r){const s=BD[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function $N(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},o=l=>{zD(l,s,r)};for(let l=0;l<e.length;l+=1)E3(e.charCodeAt(l),a,o);return t.join("")}function PD(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function UD(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}PD(s,t)}}function zD(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let s=1;s<6;s+=1)if((e>>7-s&1)===0){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Rc(e){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)E3(e.charCodeAt(a),r,s);return new Uint8Array(t)}function $D(e){const t=[];return UD(e,r=>t.push(r)),new Uint8Array(t)}function Zo(e){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};return e.forEach(a=>zN(a,r,s)),zN(null,r,s),t.join("")}function qD(e){return Math.round(Date.now()/1e3)+e}function HD(){return Symbol("auth-callback")}const qs=()=>typeof window<"u"&&typeof document<"u",Uo={tested:!1,writable:!1},j3=()=>{if(!qs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Uo.tested)return Uo.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Uo.tested=!0,Uo.writable=!0}catch{Uo.tested=!0,Uo.writable=!1}return Uo.writable};function WD(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,o)=>{t[o]=a})}catch{}return r.searchParams.forEach((s,a)=>{t[a]=s}),t}const T3=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),GD=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Sc=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},zo=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},$s=async(e,t)=>{await e.removeItem(t)};class Q0{constructor(){this.promise=new Q0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Q0.promiseConstructor=Promise;function Kx(e){const t=e.split(".");if(t.length!==3)throw new ky("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!RD.test(t[s]))throw new ky("JWT not in base64url format");return{header:JSON.parse($N(t[0])),payload:JSON.parse($N(t[1])),signature:Rc(t[2]),raw:{header:t[0],payload:t[1]}}}async function VD(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function KD(e,t){return new Promise((s,a)=>{(async()=>{for(let o=0;o<1/0;o++)try{const l=await e(o);if(!t(o,null,l)){s(l);return}}catch(l){if(!t(o,l)){a(l);return}}})()})}function XD(e){return("0"+e.toString(16)).substr(-2)}function YD(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let a="";for(let o=0;o<56;o++)a+=r.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(t),Array.from(t,XD).join("")}async function JD(e){const r=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(s);return Array.from(a).map(o=>String.fromCharCode(o)).join("")}async function ZD(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await JD(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function dc(e,t,r=!1){const s=YD();let a=s;r&&(a+="/PASSWORD_RECOVERY"),await Sc(e,`${t}-code-verifier`,a);const o=await ZD(s);return[o,s===o?"plain":"s256"]}const QD=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function eO(e){const t=e.headers.get(Ny);if(!t||!t.match(QD))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function tO(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function rO(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const sO=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function fc(e){if(!sO.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xx(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function aO(e,t){return new Proxy(e,{get:(r,s,a)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const o=s.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,a)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,s,a)}})}function qN(e){return JSON.parse(JSON.stringify(e))}const Ko=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),nO=[502,503,504];async function HN(e){var t;if(!GD(e))throw new Sy(Ko(e),0);if(nO.includes(e.status))throw new Sy(Ko(e),e.status);let r;try{r=await e.json()}catch(o){throw new Yo(Ko(o),o)}let s;const a=eO(e);if(a&&a.getTime()>=k3["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new PN(Ko(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new La}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,l)=>o&&typeof l=="string",!0))throw new PN(Ko(r),e.status,r.weak_password.reasons);throw new OD(Ko(r),e.status||500,s)}const iO=(e,t,r,s)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),r))};async function qt(e,t,r,s){var a;const o=Object.assign({},s?.headers);o[Ny]||(o[Ny]=k3["2024-01-01"].name),s?.jwt&&(o.Authorization=`Bearer ${s.jwt}`);const l=(a=s?.query)!==null&&a!==void 0?a:{};s?.redirectTo&&(l.redirect_to=s.redirectTo);const u=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await oO(e,t,r+u,{headers:o,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(d):{data:Object.assign({},d),error:null}}async function oO(e,t,r,s,a,o){const l=iO(t,s,a,o);let u;try{u=await e(r,Object.assign({},l))}catch(d){throw console.error(d),new Sy(Ko(d),0)}if(u.ok||await HN(u),s?.noResolveJson)return u;try{return await u.json()}catch(d){await HN(d)}}function bn(e){var t;let r=null;uO(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=qD(e.expires_in)));const s=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:s},error:null}}function WN(e){const t=bn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=e.weak_password),t}function lo(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function lO(e){return{data:e,error:null}}function cO(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:o}=e,l=J0(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:o},d=Object.assign({},l);return{data:{properties:u,user:d},error:null}}function GN(e){return e}function uO(e){return e.access_token&&e.refresh_token&&e.expires_in}const Yx=["global","local","others"];class dO{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=T3(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Yx[0]){if(Yx.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Yx.join(", ")}`);try{return await qt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Lt(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await qt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:lo})}catch(s){if(Lt(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=J0(t,["options"]),a=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(a.new_email=s?.newEmail,delete a.newEmail),await qt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:cO,redirectTo:r?.redirectTo})}catch(r){if(Lt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await qt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:lo})}catch(r){if(Lt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,a,o,l,u,d;try{const h={nextPage:null,lastPage:0,total:0},m=await qt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(o=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:GN});if(m.error)throw m.error;const x=await m.json(),y=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,v=(d=(u=m.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return v.length>0&&(v.forEach(b=>{const g=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(b.split(";")[1].split("=")[1]);h[`${_}Page`]=g}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},x),h),error:null}}catch(h){if(Lt(h))return{data:{users:[]},error:h};throw h}}async getUserById(t){fc(t);try{return await qt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:lo})}catch(r){if(Lt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){fc(t);try{return await qt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:lo})}catch(s){if(Lt(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){fc(t);try{return await qt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:lo})}catch(s){if(Lt(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){fc(t.userId);try{const{data:r,error:s}=await qt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:s}}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){fc(t.userId),fc(t.id);try{return{data:await qt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,a,o,l,u,d;try{const h={nextPage:null,lastPage:0,total:0},m=await qt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(o=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:GN});if(m.error)throw m.error;const x=await m.json(),y=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,v=(d=(u=m.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return v.length>0&&(v.forEach(b=>{const g=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(b.split(";")[1].split("=")[1]);h[`${_}Page`]=g}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},x),h),error:null}}catch(h){if(Lt(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(t){try{return await qt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await qt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await qt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Lt(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await qt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await qt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Lt(r))return{data:null,error:r};throw r}}}function VN(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const hc={debug:!!(globalThis&&j3()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class A3 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class fO extends A3{}async function hO(e,t,r){hc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),hc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){hc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{hc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw hc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new fO(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(hc.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function mO(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function C3(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function pO(e){return parseInt(e,16)}function xO(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function gO(e){var t;const{chainId:r,domain:s,expirationTime:a,issuedAt:o=new Date,nonce:l,notBefore:u,requestId:d,resources:h,scheme:m,uri:x,version:y}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const v=C3(e.address),b=m?`${m}://${s}`:s,g=e.statement?`${e.statement}
`:"",_=`${b} wants you to sign in with your Ethereum account:
${v}

${g}`;let w=`URI: ${x}
Version: ${y}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${o.toISOString()}`;if(a&&(w+=`
Expiration Time: ${a.toISOString()}`),u&&(w+=`
Not Before: ${u.toISOString()}`),d&&(w+=`
Request ID: ${d}`),h){let k=`
Resources:`;for(const N of h){if(!N||typeof N!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${N}`);k+=`
- ${N}`}w+=k}return`${_}
${w}`}class Es extends Error{constructor({message:t,code:r,cause:s,name:a}){var o;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(o=a??(s instanceof Error?s.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=r}}class j0 extends Es{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function yO({error:e,options:t}){var r,s,a;const{publicKey:o}=t;if(!o)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Es({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Es({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Es({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=o.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Es({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Es({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Es({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return o.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new Es({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Es({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(R3(l)){if(o.rp.id!==l)return new Es({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Es({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new Es({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Es({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Es({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function vO({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Es({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Es({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(R3(s)){if(r.rpId!==s)return new Es({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Es({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Es({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Es({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class bO{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const wO=new bO;function _O(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,a=J0(e,["challenge","user","excludeCredentials"]),o=Rc(t).buffer,l=Object.assign(Object.assign({},r),{id:Rc(r.id).buffer}),u=Object.assign(Object.assign({},a),{challenge:o,user:l});if(s&&s.length>0){u.excludeCredentials=new Array(s.length);for(let d=0;d<s.length;d++){const h=s[d];u.excludeCredentials[d]=Object.assign(Object.assign({},h),{id:Rc(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return u}function NO(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=J0(e,["challenge","allowCredentials"]),a=Rc(t).buffer,o=Object.assign(Object.assign({},s),{challenge:a});if(r&&r.length>0){o.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const u=r[l];o.allowCredentials[l]=Object.assign(Object.assign({},u),{id:Rc(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function SO(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Zo(new Uint8Array(e.response.attestationObject)),clientDataJSON:Zo(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function kO(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,s=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Zo(new Uint8Array(a.authenticatorData)),clientDataJSON:Zo(new Uint8Array(a.clientDataJSON)),signature:Zo(new Uint8Array(a.signature)),userHandle:a.userHandle?Zo(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function R3(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function KN(){var e,t;return!!(qs()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function EO(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new j0("Browser returned unexpected credential type",t)}:{data:null,error:new j0("Empty credential response",t)}}catch(t){return{data:null,error:yO({error:t,options:e})}}}async function jO(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new j0("Browser returned unexpected credential type",t)}:{data:null,error:new j0("Empty credential response",t)}}catch(t){return{data:null,error:vO({error:t,options:e})}}}const TO={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},AO={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function T0(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),s={};for(const a of e)if(a)for(const o in a){const l=a[o];if(l!==void 0)if(Array.isArray(l))s[o]=l;else if(r(l))s[o]=l;else if(t(l)){const u=s[o];t(u)?s[o]=T0(u,l):s[o]=T0(l)}else s[o]=l}return s}function CO(e,t){return T0(TO,e,t||{})}function RO(e,t){return T0(AO,e,t||{})}class DO{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:a},o){try{const{data:l,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:u};const d=a??wO.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:h}=l.webauthn.credential_options.publicKey;h.name||(h.name=`${h.id}:${s}`),h.displayName||(h.displayName=h.name)}switch(l.webauthn.type){case"create":{const h=CO(l.webauthn.credential_options.publicKey,o?.create),{data:m,error:x}=await EO({publicKey:h,signal:d});return m?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:x}}case"request":{const h=RO(l.webauthn.credential_options.publicKey,o?.request),{data:m,error:x}=await jO(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:h,signal:d}));return m?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:x}}}}catch(l){return Lt(l)?{data:null,error:l}:{data:null,error:new Yo("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},o){if(!r)return{data:null,error:new Rd("rpId is required for WebAuthn authentication")};try{if(!KN())return{data:null,error:new Yo("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:a},{request:o});if(!l)return{data:null,error:u};const{webauthn:d}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:d.type,rpId:r,rpOrigins:s,credential_response:d.credential_response}})}catch(l){return Lt(l)?{data:null,error:l}:{data:null,error:new Yo("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},o){if(!r)return{data:null,error:new Rd("rpId is required for WebAuthn registration")};try{if(!KN())return{data:null,error:new Yo("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(m=>{var x;return(x=m.data)===null||x===void 0?void 0:x.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===t&&y.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m?.id}):void 0),{data:null,error:u};const{data:d,error:h}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:a},{create:o});return d?this._verify({factorId:l.id,challengeId:d.challengeId,webauthn:{rpId:r,rpOrigins:s,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:h}}catch(l){return Lt(l)?{data:null,error:l}:{data:null,error:new Yo("Unexpected error in register",l)}}}}mO();const OO={url:TD,storageKey:AD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:CD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function XN(e,t,r){return await r()}const mc={};class Dd{get jwks(){var t,r;return(r=(t=mc[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){mc[this.storageKey]=Object.assign(Object.assign({},mc[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=mc[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){mc[this.storageKey]=Object.assign(Object.assign({},mc[this.storageKey]),{cachedAt:t})}constructor(t){var r,s,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},OO),t);if(this.storageKey=o.storageKey,this.instanceID=(r=Dd.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Dd.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&qs()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new dO({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=T3(o.fetch),this.lock=o.lock||XN,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,this.lockAcquireTimeout=o.lockAcquireTimeout,o.lock?this.lock=o.lock:this.persistSession&&qs()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=hO:this.lock=XN,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new DO(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:j3()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=VN(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=VN(this.memoryStorage)),qs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${S3}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},s="none";if(qs()&&(r=WD(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),qs()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:o}=await this._getSessionFromURL(r,s);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),ID(o)){const d=(t=o.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:o}}return{error:o}}const{session:l,redirectType:u}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",u),await this._saveSession(l),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Lt(r)?this._returnResult({error:r}):this._returnResult({error:new Yo("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,a;try{const o=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=t?.options)===null||a===void 0?void 0:a.captchaToken}},xform:bn}),{data:l,error:u}=o;if(u||!l)return this._returnResult({data:{user:null,session:null},error:u});const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(o){if(Lt(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(t){var r,s,a;try{let o;if("email"in t){const{email:m,password:x,options:y}=t;let v=null,b=null;this.flowType==="pkce"&&([v,b]=await dc(this.storage,this.storageKey)),o=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:m,password:x,data:(r=y?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:v,code_challenge_method:b},xform:bn})}else if("phone"in t){const{phone:m,password:x,options:y}=t;o=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:x,data:(s=y?.data)!==null&&s!==void 0?s:{},channel:(a=y?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:bn})}else throw new Dh("You must provide either an email or phone number and a password");const{data:l,error:u}=o;if(u||!l)return await $s(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(o){if(await $s(this.storage,`${this.storageKey}-code-verifier`),Lt(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(t){try{let r;if("email"in t){const{email:o,password:l,options:u}=t;r=await qt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:WN})}else if("phone"in t){const{phone:o,password:l,options:u}=t;r=await qt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:WN})}else throw new Dh("You must provide either an email or phone number and a password");const{data:s,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!s||!s.session||!s.user){const o=new uc;return this._returnResult({data:{user:null,session:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(r){if(Lt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,s,a,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,a,o,l,u,d,h,m,x,y;let v,b;if("message"in t)v=t.message,b=t.signature;else{const{chain:g,wallet:_,statement:w,options:k}=t;let N;if(qs())if(typeof _=="object")N=_;else{const F=window;if("ethereum"in F&&typeof F.ethereum=="object"&&"request"in F.ethereum&&typeof F.ethereum.request=="function")N=F.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!k?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=_}const E=new URL((r=k?.url)!==null&&r!==void 0?r:window.location.href),C=await N.request({method:"eth_requestAccounts"}).then(F=>F).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=C3(C[0]);let O=(s=k?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!O){const F=await N.request({method:"eth_chainId"});O=pO(F)}const B={domain:E.host,address:L,statement:w,uri:E.href,version:"1",chainId:O,nonce:(a=k?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(l=(o=k?.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(u=k?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(d=k?.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(h=k?.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(m=k?.signInWithEthereum)===null||m===void 0?void 0:m.resources};v=gO(B),b=await N.request({method:"personal_sign",params:[xO(v),L]})}try{const{data:g,error:_}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:b},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:bn});if(_)throw _;if(!g||!g.session||!g.user){const w=new uc;return this._returnResult({data:{user:null,session:null},error:w})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:_})}catch(g){if(Lt(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(t){var r,s,a,o,l,u,d,h,m,x,y,v;let b,g;if("message"in t)b=t.message,g=t.signature;else{const{chain:_,wallet:w,statement:k,options:N}=t;let E;if(qs())if(typeof w=="object")E=w;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))E=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!N?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=w}const C=new URL((r=N?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in E&&E.signIn){const L=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N?.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),k?{statement:k}:null));let O;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")O=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)O=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)b=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),g=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${C.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(a=(s=N?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((o=N?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((l=N?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((u=N?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((d=N?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((h=N?.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((x=(m=N?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||x===void 0)&&x.length?["Resources",...N.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const L=await E.signMessage(new TextEncoder().encode(b),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=L}}try{const{data:_,error:w}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:Zo(g)},!((y=t.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:bn});if(w)throw w;if(!_||!_.session||!_.user){const k=new uc;return this._returnResult({data:{user:null,session:null},error:k})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:w})}catch(_){if(Lt(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async _exchangeCodeForSession(t){const r=await zo(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new MD;const{data:o,error:l}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:bn});if(await $s(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!o||!o.session||!o.user){const u=new uc;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:a??null}),error:l})}catch(o){if(await $s(this.storage,`${this.storageKey}-code-verifier`),Lt(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(t){try{const{options:r,provider:s,token:a,access_token:o,nonce:l}=t,u=await qt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:o,nonce:l,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:bn}),{data:d,error:h}=u;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!d||!d.session||!d.user){const m=new uc;return this._returnResult({data:{user:null,session:null},error:m})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:h})}catch(r){if(Lt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,s,a,o,l;try{if("email"in t){const{email:u,options:d}=t;let h=null,m=null;this.flowType==="pkce"&&([h,m]=await dc(this.storage,this.storageKey));const{error:x}=await qt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=d?.data)!==null&&r!==void 0?r:{},create_user:(s=d?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:h,code_challenge_method:m},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in t){const{phone:u,options:d}=t,{data:h,error:m}=await qt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(a=d?.data)!==null&&a!==void 0?a:{},create_user:(o=d?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(l=d?.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:m})}throw new Dh("You must provide either an email or phone number.")}catch(u){if(await $s(this.storage,`${this.storageKey}-code-verifier`),Lt(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var r,s;try{let a,o;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,o=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:l,error:u}=await qt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:a,xform:bn});if(u)throw u;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,h=l.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(a){if(Lt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,s,a,o,l;try{let u=null,d=null;this.flowType==="pkce"&&([u,d]=await dc(this.storage,this.storageKey));const h=await qt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=t?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:d}),headers:this.headers,xform:lO});return!((o=h.data)===null||o===void 0)&&o.url&&qs()&&!(!((l=t.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(u){if(await $s(this.storage,`${this.storageKey}-code-verifier`),Lt(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new La;const{error:a}=await qt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(Lt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:a,options:o}=t,{error:l}=await qt(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in t){const{phone:s,type:a,options:o}=t,{data:l,error:u}=await qt(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l?.message_id},error:u})}throw new Dh("You must provide either an email or phone number and a type")}catch(r){if(Lt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await zo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<Gx:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const l=await zo(this.userStorage,this.storageKey+"-user");l?.user?t.user=l.user:t.user=Xx()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};t.user=aO(t.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:o}=await this._callRefreshToken(t.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await qt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:lo}):await this._useSession(async r=>{var s,a,o;const{data:l,error:u}=r;if(u)throw u;return!(!((s=l.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new La}:await qt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&o!==void 0?o:void 0,xform:lo})})}catch(r){if(Lt(r))return LD(r)&&(await this._removeSession(),await $s(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:a,error:o}=s;if(o)throw o;if(!a.session)throw new La;const l=a.session;let u=null,d=null;this.flowType==="pkce"&&t.email!=null&&([u,d]=await dc(this.storage,this.storageKey));const{data:h,error:m}=await qt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:d}),jwt:l.access_token,xform:lo});if(m)throw m;return l.user=h.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(s){if(await $s(this.storage,`${this.storageKey}-code-verifier`),Lt(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new La;const r=Date.now()/1e3;let s=r,a=!0,o=null;const{payload:l}=Kx(t.access_token);if(l.exp&&(s=l.exp,a=s<=r),a){const{data:u,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!u)return{data:{user:null,session:null},error:null};o=u}else{const{data:u,error:d}=await this._getUser(t.access_token);if(d)throw d;o={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(r){if(Lt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:l,error:u}=r;if(u)throw u;t=(s=l.session)!==null&&s!==void 0?s:void 0}if(!t?.refresh_token)throw new La;const{data:a,error:o}=await this._callRefreshToken(t.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Lt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!qs())throw new Oh("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Oh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new BN("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Oh("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new BN("No code detected.");const{data:k,error:N}=await this._exchangeCodeForSession(t.code);if(N)throw N;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:o,refresh_token:l,expires_in:u,expires_at:d,token_type:h}=t;if(!o||!u||!l||!h)throw new Oh("No session defined in URL");const m=Math.round(Date.now()/1e3),x=parseInt(u);let y=m+x;d&&(y=parseInt(d));const v=y-m;v*1e3<=Nc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${x}s`);const b=y-x;m-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,y,m):m-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,y,m);const{data:g,error:_}=await this._getUser(o);if(_)throw _;const w={provider_token:s,provider_refresh_token:a,access_token:o,expires_in:x,expires_at:y,refresh_token:l,token_type:h,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:t.type},error:null})}catch(s){if(Lt(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await zo(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:a,error:o}=r;if(o)return this._returnResult({error:o});const l=(s=a.session)===null||s===void 0?void 0:s.access_token;if(l){const{error:u}=await this.admin.signOut(l,t);if(u&&!(FD(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await $s(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=HD(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,a;try{const{data:{session:o},error:l}=r;if(l)throw l;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,r={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await dc(this.storage,this.storageKey,!0));try{return await qt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(await $s(this.storage,`${this.storageKey}-code-verifier`),Lt(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:a}=await this._useSession(async o=>{var l,u,d,h,m;const{data:x,error:y}=o;if(y)throw y;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await qt(this.fetch,"GET",v,{headers:this.headers,jwt:(m=(h=x.session)===null||h===void 0?void 0:h.access_token)!==null&&m!==void 0?m:void 0})});if(a)throw a;return qs()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:t.provider,url:s?.url},error:null})}catch(s){if(Lt(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:a,data:{session:o}}=r;if(a)throw a;const{options:l,provider:u,token:d,access_token:h,nonce:m}=t,x=await qt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=o?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:u,id_token:d,access_token:h,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:bn}),{data:y,error:v}=x;return v?this._returnResult({data:{user:null,session:null},error:v}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new uc}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:v}))}catch(a){if(await $s(this.storage,`${this.storageKey}-code-verifier`),Lt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,a;const{data:o,error:l}=r;if(l)throw l;return await qt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await KD(async a=>(a>0&&await VD(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await qt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:bn})),(a,o)=>{const l=200*Math.pow(2,a);return o&&Vx(o)&&Date.now()+l-s<Nc})}catch(s){if(this._debug(r,"error",s),Lt(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),qs()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await zo(this.storage,this.storageKey);if(a&&this.userStorage){let l=await zo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:a.user},await Sc(this.userStorage,this.storageKey+"-user",l)),a.user=(t=l?.user)!==null&&t!==void 0?t:Xx()}else if(a&&!a.user&&!a.user){const l=await zo(this.storage,this.storageKey+"-user");l&&l?.user?(a.user=l.user,await $s(this.storage,this.storageKey+"-user"),await Sc(this.storage,this.storageKey,a)):a.user=Xx()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const o=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Gx;if(this._debug(s,`session has${o?"":" not"} expired with margin of ${Gx}s`),o){if(this.autoRefreshToken&&a.refresh_token){const{error:l}=await this._callRefreshToken(a.refresh_token);l&&(console.error(l),Vx(l)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:u}=await this._getUser(a.access_token);!u&&l?.user?(a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(s,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new La;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Q0;const{data:o,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!o.session)throw new La;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const u={data:o.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(o){if(this._debug(a,"error",o),Lt(o)){const l={data:null,error:o};return Vx(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(o),o}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,s=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const o=[],l=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(d){o.push(d)}});if(await Promise.all(l),o.length>0){for(let u=0;u<o.length;u+=1)console.error(o[u]);throw o[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await $s(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Sc(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const o=qN(a);await Sc(this.storage,this.storageKey,o)}else{const a=qN(r);await Sc(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await $s(this.storage,this.storageKey),await $s(this.storage,this.storageKey+"-code-verifier"),await $s(this.storage,this.storageKey+"-user"),this.userStorage&&await $s(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&qs()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Nc);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-t)/Nc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Nc}ms, refresh threshold is ${_y} ticks`),a<=_y&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof A3)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qs()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const a=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[o,l]=await dc(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(u.toString())}if(s?.queryParams){const o=new URLSearchParams(s.queryParams);a.push(o.toString())}return s?.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:a,error:o}=r;return o?this._returnResult({data:null,error:o}):await qt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,a;const{data:o,error:l}=r;if(l)return this._returnResult({data:null,error:l});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:h}=await qt(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(s=o?.session)===null||s===void 0?void 0:s.access_token});return h?this._returnResult({data:null,error:h}):(t.factorType==="totp"&&d.type==="totp"&&(!((a=d?.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?SO(t.webauthn.credential_response):kO(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:d}=await qt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:d}))})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=await qt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});if(l.error)return l;const{data:u}=l;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:_O(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:NO(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const a={all:[],phone:[],totp:[],webauthn:[]};for(const o of(t=r?.factors)!==null&&t!==void 0?t:[])a.all.push(o),o.status==="verified"&&a[o.factor_type].push(o);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:s},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Kx(s.access_token);let l=null;o.aal&&(l=o.aal);let u=l;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(m=>m.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const h=o.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;return a?this._returnResult({data:null,error:a}):s?await qt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new La})})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:a},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!a)return this._returnResult({data:null,error:new La});const l=await qt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return l.data&&l.data.redirect_url&&qs()&&!r?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(s){if(Lt(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:a},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!a)return this._returnResult({data:null,error:new La});const l=await qt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return l.data&&l.data.redirect_url&&qs()&&!r?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(s){if(Lt(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await qt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new La})})}catch(t){if(Lt(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;return a?this._returnResult({data:null,error:a}):s?(await qt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new La})})}catch(r){if(Lt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(u=>u.kid===t);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(u=>u.kid===t),s&&this.jwks_cached_at+DD>a)return s;const{data:o,error:l}=await qt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=a,s=o.keys.find(u=>u.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:v,error:b}=await this.getSession();if(b||!v.session)return this._returnResult({data:null,error:b});s=v.session.access_token}const{header:a,payload:o,signature:l,raw:{header:u,payload:d}}=Kx(s);r?.allowExpired||tO(o.exp);const h=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!h){const{error:v}=await this.getUser(s);if(v)throw v;return{data:{claims:o,header:a,signature:l},error:null}}const m=rO(a.alg),x=await crypto.subtle.importKey("jwk",h,m,!0,["verify"]);if(!await crypto.subtle.verify(m,x,l,$D(`${u}.${d}`)))throw new ky("Invalid JWT signature");return{data:{claims:o,header:a,signature:l},error:null}}catch(s){if(Lt(s))return this._returnResult({data:null,error:s});throw s}}}Dd.nextInstanceID={};const FO=Dd,LO="2.90.1";let cd="";typeof Deno<"u"?cd="deno":typeof document<"u"?cd="web":typeof navigator<"u"&&navigator.product==="ReactNative"?cd="react-native":cd="node";const IO={"X-Client-Info":`supabase-js-${cd}/${LO}`},MO={headers:IO},BO={schema:"public"},PO={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},UO={};function Od(e){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Od(e)}function zO(e,t){if(Od(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(Od(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $O(e){var t=zO(e,"string");return Od(t)=="symbol"?t:t+""}function qO(e,t,r){return(t=$O(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function ns(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YN(Object(r),!0).forEach(function(s){qO(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YN(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const HO=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),WO=()=>Headers,GO=(e,t,r)=>{const s=HO(r),a=WO();return async(o,l)=>{var u;const d=(u=await t())!==null&&u!==void 0?u:e;let h=new a(l?.headers);return h.has("apikey")||h.set("apikey",e),h.has("Authorization")||h.set("Authorization",`Bearer ${d}`),s(o,ns(ns({},l),{},{headers:h}))}};function VO(e){return e.endsWith("/")?e:e+"/"}function KO(e,t){var r,s;const{db:a,auth:o,realtime:l,global:u}=e,{db:d,auth:h,realtime:m,global:x}=t,y={db:ns(ns({},d),a),auth:ns(ns({},h),o),realtime:ns(ns({},m),l),storage:{},global:ns(ns(ns({},x),u),{},{headers:ns(ns({},(r=x?.headers)!==null&&r!==void 0?r:{}),(s=u?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return e.accessToken?y.accessToken=e.accessToken:delete y.accessToken,y}function XO(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(VO(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var YO=class extends FO{constructor(e){super(e)}},JO=class{constructor(e,t,r){var s,a;this.supabaseUrl=e,this.supabaseKey=t;const o=XO(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,u={db:BO,realtime:UO,auth:ns(ns({},PO),{},{storageKey:l}),global:MO},d=KO(r??{},u);if(this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken)this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(m,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}});else{var h;this.auth=this._initSupabaseAuthClient((h=d.auth)!==null&&h!==void 0?h:{},this.headers,d.global.fetch)}this.fetch=GO(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(ns({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(m=>this.realtime.setAuth(m)).catch(m=>console.warn("Failed to set initial Realtime auth token:",m)),this.rest=new CR(new URL("rest/v1",o).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new jD(this.storageUrl.href,this.headers,this.fetch,r?.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new kR(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:s}=await e.auth.getSession();return(t=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,storageKey:o,flowType:l,lock:u,debug:d,throwOnError:h},m,x){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new YO({url:this.authUrl.href,headers:ns(ns({},y),m),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,flowType:l,lock:u,debug:d,throwOnError:h,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new VR(this.realtimeUrl.href,ns(ns({},e),{},{params:ns(ns({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const ZO=(e,t,r)=>new JO(e,t,r);function QO(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}QO()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const eF="https://khwzdwewgadvpglptvua.supabase.co",tF="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtod3pkd2V3Z2FkdnBnbHB0dnVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyNDIxODAsImV4cCI6MjA4MzgxODE4MH0.EiDPa3pJuEDNzfM-mho7PZ0NR83MGAH2XPf1lvP-9l4",Pe=ZO(eF,tF),D3=X.createContext({}),rF=({children:e})=>{const[t,r]=X.useState(null),[s,a]=X.useState(null),[o,l]=X.useState(!0);X.useEffect(()=>{const y=localStorage.getItem("user");if(y){const v=JSON.parse(y);r(v),a(v)}l(!1)},[]);const x={user:t,profile:s,loading:o,signInWithPassword:async(y,v)=>{try{const{data:b,error:g}=await Pe.from("users").select("id, user_id, name, team, rank, role, password, created_at").eq("user_id",y).single();if(g||!b)return{error:{message:"    ."}};if(b.password&&b.password.startsWith("$2")){if(!await zx.compare(v,b.password))return{error:{message:"    ."}}}else{if(b.password!==v)return{error:{message:"    ."}};const N=await zx.hash(v,10);await Pe.from("users").update({password:N}).eq("user_id",y)}const{password:w,...k}=b;return localStorage.setItem("user",JSON.stringify(k)),r(k),a(k),{data:k,error:null}}catch{return{error:{message:"   ."}}}},signUp:async({id:y,password:v,name:b,team:g,rank:_})=>{try{const{data:w}=await Pe.from("users").select("user_id").eq("user_id",y).single();if(w)return{error:{message:"   ."}};const k=await zx.hash(v,10),{data:N,error:E}=await Pe.from("users").insert([{user_id:y,password:k,name:b,team:g,rank:_,role:"user",created_at:new Date().toISOString()}]).select().single();return E?{error:{message:"   ."}}:{data:N,error:null}}catch{return{error:{message:"   ."}}}},signOut:async()=>(localStorage.removeItem("user"),r(null),a(null),{error:null}),updateProfile:async y=>{if(!t||!t.user_id)return{data:null,error:{message:" ."}};const{data:v,error:b}=await Pe.from("users").update(y).eq("user_id",t.user_id).select().single();if(!b&&v){const g={...t,...v};localStorage.setItem("user",JSON.stringify(g)),r(g),a(g)}return{data:v,error:b}},isAdmin:s?.role==="admin",isSubAdmin:s?.role==="sub_admin"};return n.jsx(D3.Provider,{value:x,children:e})},Kr=()=>{const e=X.useContext(D3);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};const sF=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),aF=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,s)=>s?s.toUpperCase():r.toLowerCase()),JN=e=>{const t=aF(e);return t.charAt(0).toUpperCase()+t.slice(1)},O3=(...e)=>e.filter((t,r,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===r).join(" ").trim(),nF=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var iF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const oF=X.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:a="",children:o,iconNode:l,...u},d)=>X.createElement("svg",{ref:d,...iF,width:t,height:t,stroke:e,strokeWidth:s?Number(r)*24/Number(t):r,className:O3("lucide",a),...!o&&!nF(u)&&{"aria-hidden":"true"},...u},[...l.map(([h,m])=>X.createElement(h,m)),...Array.isArray(o)?o:[o]]));const Ot=(e,t)=>{const r=X.forwardRef(({className:s,...a},o)=>X.createElement(oF,{ref:o,iconNode:t,className:O3(`lucide-${sF(JN(e))}`,`lucide-${e}`,s),...a}));return r.displayName=JN(e),r};const lF=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],ZN=Ot("arrow-down",lF);const cF=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],tf=Ot("arrow-left",cF);const uF=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],F3=Ot("arrow-right",uF);const dF=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],QN=Ot("arrow-up",dF);const fF=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],hF=Ot("award",fF);const mF=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],L3=Ot("book-open",mF);const pF=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],I3=Ot("briefcase",pF);const xF=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],ol=Ot("building-2",xF);const gF=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],M3=Ot("calendar-days",gF);const yF=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ha=Ot("calendar",yF);const vF=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],bF=Ot("camera",vF);const wF=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],A0=Ot("check",wF);const _F=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],$n=Ot("chevron-down",_F);const NF=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],$a=Ot("chevron-left",NF);const SF=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],pa=Ot("chevron-right",SF);const kF=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],_i=Ot("chevron-up",kF);const EF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Sn=Ot("circle-alert",EF);const jF=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ws=Ot("circle-check-big",jF);const TF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],C0=Ot("circle-plus",TF);const AF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],co=Ot("circle-x",AF);const CF=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],h0=Ot("clipboard-list",CF);const RF=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ta=Ot("clock",RF);const DF=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],em=Ot("copy",DF);const OF=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ts=Ot("download",OF);const FF=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Tc=Ot("external-link",FF);const LF=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],tm=Ot("eye",LF);const IF=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],MF=Ot("file-down",IF);const BF=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],rm=Ot("file-spreadsheet",BF);const PF=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Gs=Ot("file-text",PF);const UF=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],ka=Ot("file",UF);const zF=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],$F=Ot("folder-open",zF);const qF=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],HF=Ot("folder",qF);const WF=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],GF=Ot("funnel",WF);const VF=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],eS=Ot("history",VF);const KF=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],B3=Ot("house",KF);const XF=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],P3=Ot("image",XF);const YF=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],JF=Ot("lock-open",YF);const ZF=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],ll=Ot("lock",ZF);const QF=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Dc=Ot("log-out",QF);const e7=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],t7=Ot("mail",e7);const r7=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Ey=Ot("map-pin",r7);const s7=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],U3=Ot("maximize-2",s7);const a7=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],n7=Ot("megaphone",a7);const i7=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],$c=Ot("paperclip",i7);const o7=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],qc=Ot("pen-line",o7);const l7=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],js=Ot("pen",l7);const c7=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],u7=Ot("phone",c7);const d7=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],tS=Ot("pin",d7);const f7=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ps=Ot("plus",f7);const h7=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],na=Ot("printer",h7);const m7=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Oc=Ot("refresh-cw",m7);const p7=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],x7=Ot("rotate-ccw",p7);const g7=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],jy=Ot("save",g7);const y7=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ho=Ot("search",y7);const v7=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],yl=Ot("settings",v7);const b7=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],w7=Ot("smartphone",b7);const _7=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],z3=Ot("square-pen",_7);const N7=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Fd=Ot("tag",N7);const S7=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Jt=Ot("trash-2",S7);const k7=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],vl=Ot("triangle-alert",k7);const E7=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ji=Ot("upload",E7);const j7=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],T7=Ot("user-plus",j7);const A7=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],cl=Ot("user",A7);const C7=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ld=Ot("users",C7);const R7=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],mr=Ot("x",R7);class D7 extends X.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){this.setState({errorInfo:r})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset?.()};handleGoHome=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.href="/"};render(){return this.state.hasError?this.props.fallback?this.props.fallback(this.state.error,this.handleReset):n.jsx("div",{className:"min-h-[400px] flex items-center justify-center p-8",children:n.jsxs("div",{className:"max-w-md w-full text-center",children:[n.jsx("div",{className:"w-16 h-16 mx-auto mb-6 bg-red-100 rounded-full flex items-center justify-center",children:n.jsx(vl,{className:"w-8 h-8 text-red-500"})}),n.jsx("h2",{className:"text-xl font-bold text-toss-gray-900 mb-2",children:" "}),n.jsx("p",{className:"text-toss-gray-500 mb-6",children:this.props.message||"    .    ."}),!1,n.jsxs("div",{className:"flex gap-3 justify-center",children:[n.jsxs(Ye,{onClick:this.handleReset,variant:"secondary",className:"flex items-center gap-2",children:[n.jsx(Oc,{size:16})," "]}),n.jsxs(Ye,{onClick:this.handleGoHome,className:"flex items-center gap-2",children:[n.jsx(B3,{size:16}),""]})]})]})}):this.props.children}}const Ye=({children:e,variant:t="primary",size:r="md",disabled:s=!1,loading:a=!1,className:o="",...l})=>{const u="font-semibold transition-all duration-200 active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",d={primary:"bg-toss-blue text-white hover:bg-toss-blue-dark",secondary:"bg-toss-gray-100 text-toss-gray-800 hover:bg-toss-gray-200",ghost:"bg-transparent text-toss-gray-600 hover:bg-toss-gray-100",danger:"bg-red-500 text-white hover:bg-red-600"},h={sm:"py-2 px-4 text-sm rounded-toss",md:"py-3 px-6 rounded-toss",lg:"py-4 px-8 text-lg rounded-toss-lg"};return n.jsxs("button",{className:`${u} ${d[t]} ${h[r]} ${o}`,disabled:s||a,...l,children:[a&&n.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e]})},Et=({children:e,className:t="",padding:r="p-6",...s})=>n.jsx("div",{className:`bg-white rounded-toss-lg shadow-toss ${r} ${t}`,...s,children:e}),dr=({isOpen:e,onClose:t,title:r,children:s,size:a="default"})=>{if(!e)return null;const o={default:"max-w-2xl max-h-[90vh]",large:"max-w-4xl max-h-[95vh]",xl:"max-w-6xl max-h-[95vh]",full:"max-w-[95vw] max-h-[95vh]",a4:"max-w-[900px] max-h-[95vh]"};return n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),n.jsxs("div",{className:`relative bg-white rounded-toss-lg shadow-toss-lg w-full mx-4 overflow-auto ${o[a]||o.default}`,children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-toss-gray-100",children:[n.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:r}),n.jsx("button",{onClick:t,className:"text-toss-gray-500 hover:text-toss-gray-700",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsx("div",{className:"p-6",children:s})]})]})},O7=()=>{const{isAdmin:e,isSubAdmin:t}=Kr(),[r,s]=X.useState(!1),[a,o]=X.useState({}),l=ki(),u=x=>{o(y=>({...y,[x]:!y[x]}))};X.useEffect(()=>{l.pathname.startsWith("/worklogs")&&o(x=>({...x,worklogs:!0})),l.pathname.startsWith("/archive")&&o(x=>({...x,archive:!0})),l.pathname.startsWith("/admission")&&o(x=>({...x,admission:!0}))},[l.pathname]);const d=[{to:"/",icon:B3,label:""},{to:"/notices",icon:n7,label:""},{to:"/events",icon:M3,label:""},{icon:h0,label:"",isSubmenu:!0,menuKey:"worklogs",pathPrefix:"/worklogs",subItems:[{to:"/worklogs/daily",label:" "},{to:"/worklogs/weekly",label:" "},{to:"/worklogs/monthly",label:" "}]},{to:"/rescue",icon:vl,label:""},{icon:ol,label:"",isSubmenu:!0,menuKey:"admission",pathPrefix:"/admission",subItems:[{to:"/admission/ganghwa",label:""},{to:"/admission/bupyeong",label:""},{to:"/admission/nametag",label:" "}]},{to:"/meetings",icon:ha,label:""},{to:"/document-ledger",icon:L3,label:""},{to:"/document",icon:Gs,label:" "},{to:"/mypage",icon:cl,label:""}],h=[{href:"https://heony1216-eng.github.io/rescue-board/",icon:Tc,label:""},{href:"https://login.ecount.com/",icon:Tc,label:""},{href:"https://www.dropbox.com/home",icon:Tc,label:""},{href:"https://auth.worksmobile.com/login/login?accessUrl=https%3A%2F%2Fdrive.worksmobile.com%2Fdrive%2Fweb%2Fmy%3FresourceKey%3Droot&isRefreshed=true",icon:Tc,label:""}],m=({to:x,icon:y,label:v})=>n.jsxs(fy,{to:x,onClick:()=>s(!1),className:({isActive:b})=>`flex items-center gap-3 px-4 py-3 rounded-toss transition-all ${b?"bg-toss-blue text-white":"text-toss-gray-900 hover:bg-toss-blue/10 hover:text-toss-blue"}`,children:[n.jsx(y,{size:20}),n.jsx("span",{className:"font-medium",children:v})]});return n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>s(!0),className:"lg:hidden fixed top-4 left-4 z-40 p-2 bg-white rounded-toss shadow-toss",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),r&&n.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-40",onClick:()=>s(!1)}),n.jsxs("aside",{className:`fixed top-0 left-0 h-full w-64 bg-white shadow-toss-lg z-50 transform transition-transform duration-300 flex flex-col ${r?"translate-x-0":"-translate-x-full lg:translate-x-0"}`,children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-toss-gray-100 flex-shrink-0",children:[n.jsxs("h1",{className:"text-xl font-bold text-toss-gray-900",children:[n.jsx("span",{className:"text-toss-blue",children:""})," "]}),n.jsx("button",{onClick:()=>s(!1),className:"lg:hidden text-toss-gray-500",children:n.jsx(mr,{size:24})})]}),n.jsxs("nav",{className:"p-4 space-y-2 flex-1 overflow-y-auto",children:[n.jsxs("a",{href:"https://www.dropbox.com/scl/fi/vz0zmnbpr1kfzw2w3fu6g/.apk?rlkey=lp7l2m97ssh1nixykcjxwiaqf&st=m08bikmg&dl=1",target:"_blank",rel:"noopener noreferrer",onClick:()=>s(!1),className:"flex items-center gap-3 px-4 py-3 rounded-toss transition-all bg-toss-gray-100 text-toss-gray-600 hover:bg-toss-gray-200 mb-4",children:[n.jsx(w7,{size:20}),n.jsx("span",{className:"font-medium",children:" "})]}),d.map(x=>x.isSubmenu?n.jsxs("div",{children:[n.jsxs("button",{onClick:()=>u(x.menuKey),className:`w-full flex items-center justify-between gap-3 px-4 py-3 rounded-toss transition-all ${l.pathname.startsWith(x.pathPrefix)?"bg-toss-blue/10 text-toss-blue":"text-toss-gray-900 hover:bg-toss-blue/10 hover:text-toss-blue"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(x.icon,{size:20}),n.jsx("span",{className:"font-medium",children:x.label})]}),n.jsx($n,{size:16,className:`transition-transform ${a[x.menuKey]?"rotate-180":""}`})]}),a[x.menuKey]&&n.jsx("div",{className:"ml-4 mt-1 space-y-1",children:x.subItems.map(y=>n.jsxs(fy,{to:y.to,end:y.to==="/admission",onClick:()=>s(!1),className:({isActive:v})=>`flex items-center gap-3 px-4 py-2 rounded-toss transition-all text-sm ${v?"bg-toss-blue text-white":"text-toss-gray-700 hover:bg-toss-blue/10 hover:text-toss-blue"}`,children:[n.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current"}),n.jsx("span",{className:"font-medium",children:y.label})]},y.to))})]},x.label):n.jsx(m,{...x},x.to)),n.jsx("div",{className:"pt-4 mt-4 border-t border-toss-gray-100",children:h.map(x=>n.jsxs("a",{href:x.href,target:"_blank",rel:"noopener noreferrer",onClick:()=>s(!1),className:"flex items-center gap-3 px-4 py-3 rounded-toss transition-all text-toss-gray-900 hover:bg-toss-blue/10 hover:text-toss-blue",children:[n.jsx(x.icon,{size:20}),n.jsx("span",{className:"font-medium",children:x.label})]},x.href))})]})]})]})},F7=()=>{const{profile:e,signOut:t,isAdmin:r}=Kr(),s=ru(),a=async()=>{await t(),s("/login")};return n.jsx("header",{className:"bg-white shadow-toss sticky top-0 z-30",children:n.jsxs("div",{className:"flex items-center justify-between px-4 lg:px-8 py-4",children:[n.jsx("div",{className:"lg:hidden w-10"})," ",n.jsxs("div",{className:"flex items-center gap-4 ml-auto",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-toss-blue/10 rounded-full flex items-center justify-center",children:n.jsx(cl,{size:20,className:"text-toss-blue"})}),n.jsxs("div",{className:"hidden sm:block",children:[n.jsxs("p",{className:"font-semibold text-toss-gray-900",children:[e?.name||"",r&&n.jsx("span",{className:"ml-2 text-xs bg-toss-blue text-white px-2 py-0.5 rounded-full",children:""})]}),n.jsxs("p",{className:"text-sm text-toss-gray-500",children:[e?.team&&`${e.team}  `,e?.rank||""]})]})]}),n.jsx("button",{onClick:a,className:"p-2 text-toss-gray-500 hover:text-toss-gray-700 hover:bg-toss-gray-100 rounded-toss transition-all",title:"",children:n.jsx(Dc,{size:20})})]})]})})},L7=()=>n.jsxs("div",{className:"min-h-screen bg-toss-gray-50 overflow-hidden",children:[n.jsx(O7,{}),n.jsxs("div",{className:"lg:ml-64 min-h-screen",children:[n.jsx(F7,{}),n.jsx("main",{className:"p-4 lg:p-8 overflow-x-hidden",children:n.jsx(j8,{})})]})]}),I7=()=>{const[e,t]=X.useState("user"),[r,s]=X.useState(""),[a,o]=X.useState(""),[l,u]=X.useState(!1),[d,h]=X.useState(!1),[m,x]=X.useState(""),{signInWithPassword:y}=Kr(),v=ru();X.useEffect(()=>{const g=localStorage.getItem("savedId");g&&(s(g),u(!0))},[]);const b=async g=>{g.preventDefault(),h(!0),x("");const{error:_}=await y(r,a);_?x(_.message||"    ."):(l?localStorage.setItem("savedId",r):localStorage.removeItem("savedId"),v("/")),h(!1)};return n.jsx("div",{className:"min-h-screen bg-toss-gray-50 flex items-center justify-center p-4",children:n.jsxs("div",{className:"w-full max-w-md",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsxs("h1",{className:"text-3xl font-bold text-toss-gray-900 mb-2",children:[n.jsx("span",{className:"text-toss-blue",children:""})," "]}),n.jsx("p",{className:"text-toss-gray-500",children:"  "})]}),n.jsxs(Et,{className:"mb-4",children:[n.jsxs("div",{className:"flex mb-6 bg-toss-gray-100 p-1 rounded-toss",children:[n.jsx("button",{onClick:()=>t("user"),className:`flex-1 py-2 px-4 rounded-toss text-sm font-medium transition-all ${e==="user"?"bg-white text-toss-gray-900 shadow-sm":"text-toss-gray-500"}`,children:" "}),n.jsx("button",{onClick:()=>t("admin"),className:`flex-1 py-2 px-4 rounded-toss text-sm font-medium transition-all ${e==="admin"?"bg-white text-toss-gray-900 shadow-sm":"text-toss-gray-500"}`,children:" "})]}),n.jsxs("form",{onSubmit:b,className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(cl,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"text",value:r,onChange:g=>s(g.target.value),placeholder:e==="admin"?" ":"",required:!0,className:"w-full pl-12 pr-4 py-3 bg-toss-gray-100 border-0 rounded-toss text-toss-gray-900 placeholder-toss-gray-500 focus:ring-2 focus:ring-toss-blue focus:bg-white transition-all"})]}),n.jsxs("div",{className:"relative",children:[n.jsx(ll,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"password",value:a,onChange:g=>o(g.target.value),placeholder:"",required:!0,className:"w-full pl-12 pr-4 py-3 bg-toss-gray-100 border-0 rounded-toss text-toss-gray-900 placeholder-toss-gray-500 focus:ring-2 focus:ring-toss-blue focus:bg-white transition-all"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"rememberMe",checked:l,onChange:g=>u(g.target.checked),className:"w-4 h-4 text-toss-blue bg-toss-gray-100 border-toss-gray-300 rounded focus:ring-toss-blue focus:ring-2"}),n.jsx("label",{htmlFor:"rememberMe",className:"ml-2 text-sm text-toss-gray-700 cursor-pointer",children:"  "})]}),m&&n.jsx("p",{className:"text-sm text-red-500 bg-red-50 p-3 rounded-toss",children:m}),n.jsxs(Ye,{type:"submit",className:"w-full",loading:d,children:["",n.jsx(F3,{size:18})]})]}),e==="user"&&n.jsx("div",{className:"mt-6 pt-6 border-t border-toss-gray-200",children:n.jsxs(Vs,{to:"/register",className:"flex items-center justify-center gap-2 w-full py-3 bg-toss-gray-100 text-toss-gray-700 rounded-toss hover:bg-toss-gray-200 transition-colors font-medium",children:[n.jsx(T7,{size:18}),""]})})]}),n.jsx("p",{className:"text-center text-sm text-toss-gray-500",children:e==="user"?"   ":"  "})]})})},M7=()=>{const[e,t]=X.useState({id:"",password:"",confirmPassword:"",name:"",team:"",rank:""}),[r,s]=X.useState(!1),[a,o]=X.useState(""),[l,u]=X.useState(!1),{signUp:d}=Kr(),h=ru(),m=v=>{const{name:b,value:g}=v.target;t(_=>({..._,[b]:g}))},x=async v=>{if(v.preventDefault(),s(!0),o(""),e.password!==e.confirmPassword){o("  ."),s(!1);return}if(e.password.length<6){o(" 6  ."),s(!1);return}const{error:b}=await d({id:e.id,password:e.password,name:e.name,team:e.team,rank:e.rank});b?o(b.message||" .  ."):(u(!0),setTimeout(()=>{h("/login")},2e3)),s(!1)},y="w-full pl-12 pr-4 py-3 bg-toss-gray-100 border-0 rounded-toss text-toss-gray-900 placeholder-toss-gray-500 focus:ring-2 focus:ring-toss-blue focus:bg-white transition-all";return n.jsx("div",{className:"min-h-screen bg-toss-gray-50 flex items-center justify-center p-4",children:n.jsxs("div",{className:"w-full max-w-md",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsxs("h1",{className:"text-3xl font-bold text-toss-gray-900 mb-2",children:[n.jsx("span",{className:"text-toss-blue",children:""})," "]}),n.jsx("p",{className:"text-toss-gray-500",children:""})]}),n.jsx(Et,{className:"mb-4",children:l?n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),n.jsx("h2",{className:"text-xl font-semibold text-toss-gray-900 mb-2",children:" !"}),n.jsx("p",{className:"text-toss-gray-500",children:"  ..."})]}):n.jsxs("form",{onSubmit:x,className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(cl,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"text",name:"id",value:e.id,onChange:m,placeholder:" *",required:!0,className:y})]}),n.jsxs("div",{className:"relative",children:[n.jsx(ll,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"password",name:"password",value:e.password,onChange:m,placeholder:" * (6 )",required:!0,className:y})]}),n.jsxs("div",{className:"relative",children:[n.jsx(ll,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"password",name:"confirmPassword",value:e.confirmPassword,onChange:m,placeholder:"  *",required:!0,className:y})]}),n.jsx("div",{className:"border-t border-toss-gray-200 pt-4"}),n.jsxs("div",{className:"relative",children:[n.jsx(cl,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"text",name:"name",value:e.name,onChange:m,placeholder:" *",required:!0,className:y})]}),n.jsxs("div",{className:"relative",children:[n.jsx(I3,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"text",name:"team",value:e.team,onChange:m,placeholder:" (: , )",className:y})]}),n.jsxs("div",{className:"relative",children:[n.jsx(hF,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"text",name:"rank",value:e.rank,onChange:m,placeholder:" (: , )",className:y})]}),a&&n.jsx("p",{className:"text-sm text-red-500 bg-red-50 p-3 rounded-toss",children:a}),n.jsxs(Ye,{type:"submit",className:"w-full",loading:r,children:["",n.jsx(F3,{size:18})]})]})}),n.jsxs(Vs,{to:"/login",className:"flex items-center justify-center gap-2 text-sm text-toss-gray-500 hover:text-toss-blue transition-colors",children:[n.jsx(tf,{size:16})," "]})]})})},B7=()=>{const{profile:e,isAdmin:t}=Kr(),[r,s]=X.useState(0),[a,o]=X.useState([]),[l,u]=X.useState([]),[d,h]=X.useState(null),[m,x]=X.useState(!1),[y,v]=X.useState({daily:!1,weekly:!1,monthly:!1});X.useEffect(()=>{g(),N(),_(),e?.user_id&&b()},[e?.user_id]);const b=async()=>{if(!e?.user_id)return;const E=new Date,C=E.getHours(),L=E.getDay(),O=E.toISOString().split("T")[0],B={daily:!1,weekly:!1,monthly:!1};if(L>=1&&L<=5&&C>=15){const{data:q}=await Pe.from("work_logs").select("id").eq("user_id",e.user_id).eq("type","daily").eq("work_date",O).limit(1).maybeSingle();q||(B.daily=!0)}if(L===5&&C>=15){const q=new Date(E);q.setDate(E.getDate()-(L-1));const fe=q.toISOString().split("T")[0],V=new Date(E).toISOString().split("T")[0],{data:I}=await Pe.from("work_logs").select("id").eq("user_id",e.user_id).eq("type","weekly").gte("work_date",fe).lte("work_date",V).limit(1).maybeSingle();I||(B.weekly=!0)}const F=new Date(E.getFullYear(),E.getMonth()+1,0).getDate();if(E.getDate()===F&&C>=15){const q=new Date(E.getFullYear(),E.getMonth(),1).toISOString().split("T")[0],fe=O,{data:D}=await Pe.from("work_logs").select("id").eq("user_id",e.user_id).eq("type","monthly").gte("work_date",q).lte("work_date",fe).limit(1).maybeSingle();D||(B.monthly=!0)}v(B)},g=async()=>{try{const{count:E}=await Pe.from("rescue_situations").select("id",{count:"exact"}).eq("is_completed",!1);s(E||0)}catch(E){console.error("Error fetching rescue count:",E)}},_=async()=>{try{const{data:E}=await Pe.from("rescue_situations").select("*").eq("is_completed",!1).order("created_at",{ascending:!1}).limit(10);u(E||[])}catch(E){console.error("Error fetching rescues:",E)}},w=E=>{h(E),x(!0)},k=()=>{x(!1),h(null)},N=async()=>{try{const{data:E}=await Pe.from("notices").select("id, title, created_at, is_pinned").order("is_pinned",{ascending:!1}).order("created_at",{ascending:!1}).limit(5);o(E||[])}catch(E){console.error("Error fetching notices:",E)}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx("span",{className:"text-2xl font-bold",children:e?.name?.charAt(0)||"U"})}),n.jsxs("div",{children:[n.jsxs("h2",{className:"text-2xl font-bold mb-1",children:[", ",e?.name||"","!",t&&n.jsx("span",{className:"ml-2 text-xs bg-white/20 px-2 py-1 rounded-full",children:""})]}),n.jsxs("p",{className:"text-white/80",children:[e?.team&&`${e.team}  `,e?.position||" "]})]})]})}),(y.daily||y.weekly||y.monthly)&&n.jsx(Et,{className:"bg-amber-50 border border-amber-200",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0",children:n.jsx(Sn,{size:20,className:"text-amber-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-bold text-amber-800 mb-2",children:"  "}),n.jsxs("div",{className:"space-y-2",children:[y.daily&&n.jsxs(Vs,{to:"/worklogs/daily",className:"flex items-center justify-between p-2 bg-white rounded-lg hover:bg-amber-100 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(h0,{size:16,className:"text-amber-600"}),n.jsx("span",{className:"text-sm text-amber-800",children:"   "})]}),n.jsx("span",{className:"text-xs text-amber-600 font-medium",children:" "})]}),y.weekly&&n.jsxs(Vs,{to:"/worklogs/weekly",className:"flex items-center justify-between p-2 bg-white rounded-lg hover:bg-amber-100 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(h0,{size:16,className:"text-amber-600"}),n.jsx("span",{className:"text-sm text-amber-800",children:"    "})]}),n.jsx("span",{className:"text-xs text-amber-600 font-medium",children:" "})]}),y.monthly&&n.jsxs(Vs,{to:"/worklogs/monthly",className:"flex items-center justify-between p-2 bg-white rounded-lg hover:bg-amber-100 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(h0,{size:16,className:"text-amber-600"}),n.jsx("span",{className:"text-sm text-amber-800",children:"    "})]}),n.jsx("span",{className:"text-xs text-amber-600 font-medium",children:" "})]})]})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs(Et,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vl,{size:18,className:"text-orange-500"}),n.jsx("h3",{className:"text-base font-bold text-toss-gray-900",children:" "}),n.jsxs("span",{className:"text-xs bg-orange-100 text-orange-600 px-2 py-0.5 rounded-full font-medium",children:[r,""]})]}),n.jsx(Vs,{to:"/rescue",className:"text-sm text-toss-blue hover:underline",children:""})]}),l.length>0?n.jsx("div",{className:"space-y-2 max-h-[320px] overflow-y-auto",children:l.map(E=>n.jsxs("div",{onClick:()=>w(E),className:"block p-3 rounded-lg hover:bg-toss-gray-50 transition-colors border border-toss-gray-100 cursor-pointer",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("p",{className:"font-medium text-toss-gray-900 text-sm",children:E.name}),n.jsx("span",{className:"text-toss-gray-300",children:"|"}),n.jsx("p",{className:"text-sm text-toss-gray-600",children:E.location})]}),n.jsx("p",{className:"text-xs text-toss-gray-400",children:E.request_date||"-"})]}),n.jsx("p",{className:"text-sm text-toss-gray-700 line-clamp-2",children:E.status||"-"})]},E.id))}):n.jsx("p",{className:"text-center text-toss-gray-500 py-8 text-sm",children:"  "})]}),n.jsxs(Et,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-base font-bold text-toss-gray-900",children:" "}),n.jsx(Vs,{to:"/notices",className:"text-sm text-toss-blue hover:underline",children:""})]}),a.length>0?n.jsx("div",{className:"space-y-2 max-h-[320px] overflow-y-auto",children:a.map(E=>n.jsxs(Vs,{to:`/notices/${E.id}`,className:"block p-3 rounded-lg hover:bg-toss-gray-50 transition-colors border border-toss-gray-100",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[E.is_pinned&&n.jsx("span",{className:"text-xs bg-toss-blue text-white px-2 py-0.5 rounded-full",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900 flex-1 truncate text-sm",children:E.title})]}),n.jsx("p",{className:"text-xs text-toss-gray-400 mt-1",children:new Date(E.created_at).toLocaleDateString("ko-KR")})]},E.id))}):n.jsx("p",{className:"text-center text-toss-gray-500 py-8 text-sm",children:"  "})]})]}),n.jsx(dr,{isOpen:m,onClose:k,title:" ",children:d&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(cl,{size:16,className:"text-toss-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-toss-gray-500",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:d.name||"-"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ey,{size:16,className:"text-toss-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-toss-gray-500",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:d.location||"-"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(u7,{size:16,className:"text-toss-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-toss-gray-500",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:d.contact||"-"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ha,{size:16,className:"text-toss-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-toss-gray-500",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:d.request_date||"-"})]})]})]}),(d.animal_type||d.animal_count)&&n.jsxs("div",{className:"p-3 bg-toss-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-toss-gray-900",children:[d.animal_type||"-",d.animal_count&&` (${d.animal_count})`]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Gs,{size:16,className:"text-toss-gray-400"}),n.jsx("p",{className:"text-sm font-medium text-toss-gray-700",children:" "})]}),n.jsx("div",{className:"p-3 bg-orange-50 rounded-lg",children:n.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:d.status||"  "})})]}),d.notes&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("div",{className:"p-3 bg-toss-gray-50 rounded-lg",children:n.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:d.notes})})]}),n.jsx("div",{className:"pt-4 border-t border-toss-gray-100",children:n.jsx(Vs,{to:"/rescue",onClick:k,className:"block w-full text-center py-3 bg-toss-blue text-white rounded-lg hover:bg-blue-600 transition-colors",children:"  "})})]})})]})},rS=()=>{const{id:e}=e3(),t=ru(),{isAdmin:r,isSubAdmin:s,profile:a}=Kr(),[o,l]=X.useState([]),[u,d]=X.useState(null),[h,m]=X.useState(!1),[x,y]=X.useState(!1),[v,b]=X.useState(!0),[g,_]=X.useState({title:"",content:"",is_pinned:!1});X.useEffect(()=>{w()},[]),X.useEffect(()=>{e?k(e):d(null)},[e]);const w=async()=>{try{const{data:q,error:fe}=await Pe.from("notices").select("*, author:users(name)").order("is_pinned",{ascending:!1}).order("created_at",{ascending:!1});if(fe)throw fe;l(q||[])}catch(q){console.error("Error fetching notices:",q)}finally{b(!1)}},k=async q=>{try{const{data:fe,error:D}=await Pe.from("notices").select("*, author:users(name)").eq("id",q).single();if(D)throw D;d(fe)}catch(fe){console.error("Error fetching notice:",fe)}},N=async()=>{if(!g.title||!g.content){alert("  .");return}try{const{error:q}=await Pe.from("notices").insert({title:g.title,content:g.content,is_pinned:g.is_pinned,author_id:a.user_id});if(q)throw console.error("Notice insert error:",q),q;m(!1),_({title:"",content:"",is_pinned:!1}),w(),alert(" .")}catch(q){console.error("Error creating notice:",q),alert("  : "+q.message)}},E=async()=>{if(!L){alert("    .");return}try{const{error:q}=await Pe.from("notices").update({title:g.title,content:g.content,is_pinned:g.is_pinned,updated_at:new Date().toISOString()}).eq("id",L.id);if(q)throw q;m(!1),O(null),w(),u&&u.id===L.id&&k(L.id),alert(" .")}catch(q){console.error("Error updating notice:",q),alert("  .")}},C=async q=>{if(confirm(" ?"))try{const{error:fe}=await Pe.from("notices").delete().eq("id",q);if(fe)throw fe;t("/notices"),w()}catch(fe){console.error("Error deleting notice:",fe)}},[L,O]=X.useState(null),B=q=>{O(q),_({title:q.title,content:q.content,is_pinned:q.is_pinned}),y(!1),m(!0)},F=()=>{_({title:"",content:"",is_pinned:!1}),y(!0),m(!0)};return u?n.jsxs("div",{className:"space-y-6",children:[n.jsxs(Vs,{to:"/notices",className:"inline-flex items-center gap-2 text-toss-gray-500 hover:text-toss-gray-700",children:[n.jsx($a,{size:20}),""]}),n.jsxs(Et,{children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsx("div",{className:"flex items-center gap-2",children:u.is_pinned&&n.jsxs("span",{className:"bg-toss-blue text-white text-xs px-2 py-1 rounded-full flex items-center gap-1",children:[n.jsx(tS,{size:12})," "]})}),(r||s)&&n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:q=>{q.preventDefault(),q.stopPropagation(),B(u)},className:"p-2 text-toss-gray-500 hover:bg-toss-gray-100 rounded-toss",children:n.jsx(z3,{size:18})}),n.jsx("button",{onClick:q=>{q.preventDefault(),q.stopPropagation(),C(u.id)},className:"p-2 text-red-500 hover:bg-red-50 rounded-toss",children:n.jsx(Jt,{size:18})})]})]}),n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900 mb-2",children:u.title}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-toss-gray-500 mb-6 pb-6 border-b border-toss-gray-100",children:[n.jsx("span",{children:u.author?.name||""}),n.jsx("span",{children:new Date(u.created_at).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})})]}),n.jsx("div",{className:"prose max-w-none text-toss-gray-800 whitespace-pre-wrap leading-relaxed",children:u.content})]}),n.jsx(dr,{isOpen:h,onClose:()=>m(!1),title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",value:g.title,onChange:q=>_({...g,title:q.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue",placeholder:"  "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("textarea",{value:g.content,onChange:q=>_({...g,content:q.target.value}),rows:6,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:"  "})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:g.is_pinned,onChange:q=>_({...g,is_pinned:q.target.checked}),className:"w-5 h-5 rounded border-toss-gray-300 text-toss-blue focus:ring-toss-blue"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:" "})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>m(!1),className:"flex-1",children:""}),n.jsx(Ye,{onClick:E,className:"flex-1",children:""})]})]})})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:""}),(r||s)&&n.jsxs(Ye,{onClick:F,children:[n.jsx(ps,{size:18}),"  "]})]}),n.jsx(Et,{padding:"p-0",children:v?n.jsx("div",{className:"p-8 text-center text-toss-gray-500",children:" ..."}):o.length>0?n.jsx("div",{className:"divide-y divide-toss-gray-100",children:o.map(q=>n.jsxs(Vs,{to:`/notices/${q.id}`,className:"block p-4 hover:bg-toss-gray-50 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[q.is_pinned&&n.jsxs("span",{className:"bg-toss-blue text-white text-xs px-2 py-0.5 rounded-full flex items-center gap-1",children:[n.jsx(tS,{size:10})," "]}),n.jsx("h3",{className:"font-medium text-toss-gray-900 flex-1 truncate",children:q.title}),n.jsx("span",{className:"text-sm text-toss-gray-400 shrink-0",children:new Date(q.created_at).toLocaleDateString("ko-KR")})]}),n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1 truncate",children:q.content})]},q.id))}):n.jsx("div",{className:"p-8 text-center text-toss-gray-500",children:"  "})}),n.jsx(dr,{isOpen:h,onClose:()=>m(!1),title:x?"  ":" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",value:g.title,onChange:q=>_({...g,title:q.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue",placeholder:"  "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("textarea",{value:g.content,onChange:q=>_({...g,content:q.target.value}),rows:6,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:"  "})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:g.is_pinned,onChange:q=>_({...g,is_pinned:q.target.checked}),className:"w-5 h-5 rounded border-toss-gray-300 text-toss-blue focus:ring-toss-blue"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:" "})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>m(!1),className:"flex-1",children:""}),n.jsx(Ye,{onClick:x?N:E,className:"flex-1",children:x?"":""})]})]})})]})};var P7="rpc",U7="upload",z7="download",Jx="app",Zx="user",Qx="team",$7="noauth",q7="cookie",R0="dropboxapi.com",sS="dropbox.com",Ty={api:"api",notify:"bolt",content:"api-content"},Ce={};Ce.accountSetProfilePhoto=function(e){return this.request("account/set_profile_photo",e,"user","api","rpc","account_info.write")};Ce.authTokenFromOauth1=function(e){return this.request("auth/token/from_oauth1",e,"app","api","rpc",null)};Ce.authTokenRevoke=function(){return this.request("auth/token/revoke",null,"user","api","rpc",null)};Ce.checkApp=function(e){return this.request("check/app",e,"app","api","rpc",null)};Ce.checkUser=function(e){return this.request("check/user",e,"user","api","rpc","account_info.read")};Ce.contactsDeleteManualContacts=function(){return this.request("contacts/delete_manual_contacts",null,"user","api","rpc","contacts.write")};Ce.contactsDeleteManualContactsBatch=function(e){return this.request("contacts/delete_manual_contacts_batch",e,"user","api","rpc","contacts.write")};Ce.filePropertiesPropertiesAdd=function(e){return this.request("file_properties/properties/add",e,"user","api","rpc","files.metadata.write")};Ce.filePropertiesPropertiesOverwrite=function(e){return this.request("file_properties/properties/overwrite",e,"user","api","rpc","files.metadata.write")};Ce.filePropertiesPropertiesRemove=function(e){return this.request("file_properties/properties/remove",e,"user","api","rpc","files.metadata.write")};Ce.filePropertiesPropertiesSearch=function(e){return this.request("file_properties/properties/search",e,"user","api","rpc","files.metadata.read")};Ce.filePropertiesPropertiesSearchContinue=function(e){return this.request("file_properties/properties/search/continue",e,"user","api","rpc","files.metadata.read")};Ce.filePropertiesPropertiesUpdate=function(e){return this.request("file_properties/properties/update",e,"user","api","rpc","files.metadata.write")};Ce.filePropertiesTemplatesAddForTeam=function(e){return this.request("file_properties/templates/add_for_team",e,"team","api","rpc","files.team_metadata.write")};Ce.filePropertiesTemplatesAddForUser=function(e){return this.request("file_properties/templates/add_for_user",e,"user","api","rpc","files.metadata.write")};Ce.filePropertiesTemplatesGetForTeam=function(e){return this.request("file_properties/templates/get_for_team",e,"team","api","rpc","files.team_metadata.write")};Ce.filePropertiesTemplatesGetForUser=function(e){return this.request("file_properties/templates/get_for_user",e,"user","api","rpc","files.metadata.read")};Ce.filePropertiesTemplatesListForTeam=function(){return this.request("file_properties/templates/list_for_team",null,"team","api","rpc","files.team_metadata.write")};Ce.filePropertiesTemplatesListForUser=function(){return this.request("file_properties/templates/list_for_user",null,"user","api","rpc","files.metadata.read")};Ce.filePropertiesTemplatesRemoveForTeam=function(e){return this.request("file_properties/templates/remove_for_team",e,"team","api","rpc","files.team_metadata.write")};Ce.filePropertiesTemplatesRemoveForUser=function(e){return this.request("file_properties/templates/remove_for_user",e,"user","api","rpc","files.metadata.write")};Ce.filePropertiesTemplatesUpdateForTeam=function(e){return this.request("file_properties/templates/update_for_team",e,"team","api","rpc","files.team_metadata.write")};Ce.filePropertiesTemplatesUpdateForUser=function(e){return this.request("file_properties/templates/update_for_user",e,"user","api","rpc","files.metadata.write")};Ce.fileRequestsCount=function(){return this.request("file_requests/count",null,"user","api","rpc","file_requests.read")};Ce.fileRequestsCreate=function(e){return this.request("file_requests/create",e,"user","api","rpc","file_requests.write")};Ce.fileRequestsDelete=function(e){return this.request("file_requests/delete",e,"user","api","rpc","file_requests.write")};Ce.fileRequestsDeleteAllClosed=function(){return this.request("file_requests/delete_all_closed",null,"user","api","rpc","file_requests.write")};Ce.fileRequestsGet=function(e){return this.request("file_requests/get",e,"user","api","rpc","file_requests.read")};Ce.fileRequestsListV2=function(e){return this.request("file_requests/list_v2",e,"user","api","rpc","file_requests.read")};Ce.fileRequestsList=function(){return this.request("file_requests/list",null,"user","api","rpc","file_requests.read")};Ce.fileRequestsListContinue=function(e){return this.request("file_requests/list/continue",e,"user","api","rpc","file_requests.read")};Ce.fileRequestsUpdate=function(e){return this.request("file_requests/update",e,"user","api","rpc","file_requests.write")};Ce.filesAlphaGetMetadata=function(e){return this.request("files/alpha/get_metadata",e,"user","api","rpc","files.metadata.read")};Ce.filesAlphaUpload=function(e){return this.request("files/alpha/upload",e,"user","content","upload","files.content.write")};Ce.filesCopyV2=function(e){return this.request("files/copy_v2",e,"user","api","rpc","files.content.write")};Ce.filesCopy=function(e){return this.request("files/copy",e,"user","api","rpc","files.content.write")};Ce.filesCopyBatchV2=function(e){return this.request("files/copy_batch_v2",e,"user","api","rpc","files.content.write")};Ce.filesCopyBatch=function(e){return this.request("files/copy_batch",e,"user","api","rpc","files.content.write")};Ce.filesCopyBatchCheckV2=function(e){return this.request("files/copy_batch/check_v2",e,"user","api","rpc","files.content.write")};Ce.filesCopyBatchCheck=function(e){return this.request("files/copy_batch/check",e,"user","api","rpc","files.content.write")};Ce.filesCopyReferenceGet=function(e){return this.request("files/copy_reference/get",e,"user","api","rpc","files.content.write")};Ce.filesCopyReferenceSave=function(e){return this.request("files/copy_reference/save",e,"user","api","rpc","files.content.write")};Ce.filesCreateFolderV2=function(e){return this.request("files/create_folder_v2",e,"user","api","rpc","files.content.write")};Ce.filesCreateFolder=function(e){return this.request("files/create_folder",e,"user","api","rpc","files.content.write")};Ce.filesCreateFolderBatch=function(e){return this.request("files/create_folder_batch",e,"user","api","rpc","files.content.write")};Ce.filesCreateFolderBatchCheck=function(e){return this.request("files/create_folder_batch/check",e,"user","api","rpc","files.content.write")};Ce.filesDeleteV2=function(e){return this.request("files/delete_v2",e,"user","api","rpc","files.content.write")};Ce.filesDelete=function(e){return this.request("files/delete",e,"user","api","rpc","files.content.write")};Ce.filesDeleteBatch=function(e){return this.request("files/delete_batch",e,"user","api","rpc","files.content.write")};Ce.filesDeleteBatchCheck=function(e){return this.request("files/delete_batch/check",e,"user","api","rpc","files.content.write")};Ce.filesDownload=function(e){return this.request("files/download",e,"user","content","download","files.content.read")};Ce.filesDownloadZip=function(e){return this.request("files/download_zip",e,"user","content","download","files.content.read")};Ce.filesExport=function(e){return this.request("files/export",e,"user","content","download","files.content.read")};Ce.filesGetFileLockBatch=function(e){return this.request("files/get_file_lock_batch",e,"user","api","rpc","files.content.read")};Ce.filesGetMetadata=function(e){return this.request("files/get_metadata",e,"user","api","rpc","files.metadata.read")};Ce.filesGetPreview=function(e){return this.request("files/get_preview",e,"user","content","download","files.content.read")};Ce.filesGetTemporaryLink=function(e){return this.request("files/get_temporary_link",e,"user","api","rpc","files.content.read")};Ce.filesGetTemporaryUploadLink=function(e){return this.request("files/get_temporary_upload_link",e,"user","api","rpc","files.content.write")};Ce.filesGetThumbnail=function(e){return this.request("files/get_thumbnail",e,"user","content","download","files.content.read")};Ce.filesGetThumbnailV2=function(e){return this.request("files/get_thumbnail_v2",e,"app, user","content","download","files.content.read")};Ce.filesGetThumbnailBatch=function(e){return this.request("files/get_thumbnail_batch",e,"user","content","rpc","files.content.read")};Ce.filesListFolder=function(e){return this.request("files/list_folder",e,"app, user","api","rpc","files.metadata.read")};Ce.filesListFolderContinue=function(e){return this.request("files/list_folder/continue",e,"app, user","api","rpc","files.metadata.read")};Ce.filesListFolderGetLatestCursor=function(e){return this.request("files/list_folder/get_latest_cursor",e,"user","api","rpc","files.metadata.read")};Ce.filesListFolderLongpoll=function(e){return this.request("files/list_folder/longpoll",e,"noauth","notify","rpc","files.metadata.read")};Ce.filesListRevisions=function(e){return this.request("files/list_revisions",e,"user","api","rpc","files.metadata.read")};Ce.filesLockFileBatch=function(e){return this.request("files/lock_file_batch",e,"user","api","rpc","files.content.write")};Ce.filesMoveV2=function(e){return this.request("files/move_v2",e,"user","api","rpc","files.content.write")};Ce.filesMove=function(e){return this.request("files/move",e,"user","api","rpc","files.content.write")};Ce.filesMoveBatchV2=function(e){return this.request("files/move_batch_v2",e,"user","api","rpc","files.content.write")};Ce.filesMoveBatch=function(e){return this.request("files/move_batch",e,"user","api","rpc","files.content.write")};Ce.filesMoveBatchCheckV2=function(e){return this.request("files/move_batch/check_v2",e,"user","api","rpc","files.content.write")};Ce.filesMoveBatchCheck=function(e){return this.request("files/move_batch/check",e,"user","api","rpc","files.content.write")};Ce.filesPaperCreate=function(e){return this.request("files/paper/create",e,"user","api","upload","files.content.write")};Ce.filesPaperUpdate=function(e){return this.request("files/paper/update",e,"user","api","upload","files.content.write")};Ce.filesPermanentlyDelete=function(e){return this.request("files/permanently_delete",e,"user","api","rpc","files.permanent_delete")};Ce.filesPropertiesAdd=function(e){return this.request("files/properties/add",e,"user","api","rpc","files.metadata.write")};Ce.filesPropertiesOverwrite=function(e){return this.request("files/properties/overwrite",e,"user","api","rpc","files.metadata.write")};Ce.filesPropertiesRemove=function(e){return this.request("files/properties/remove",e,"user","api","rpc","files.metadata.write")};Ce.filesPropertiesTemplateGet=function(e){return this.request("files/properties/template/get",e,"user","api","rpc","files.metadata.read")};Ce.filesPropertiesTemplateList=function(){return this.request("files/properties/template/list",null,"user","api","rpc","files.metadata.read")};Ce.filesPropertiesUpdate=function(e){return this.request("files/properties/update",e,"user","api","rpc","files.metadata.write")};Ce.filesRestore=function(e){return this.request("files/restore",e,"user","api","rpc","files.content.write")};Ce.filesSaveUrl=function(e){return this.request("files/save_url",e,"user","api","rpc","files.content.write")};Ce.filesSaveUrlCheckJobStatus=function(e){return this.request("files/save_url/check_job_status",e,"user","api","rpc","files.content.write")};Ce.filesSearch=function(e){return this.request("files/search",e,"user","api","rpc","files.metadata.read")};Ce.filesSearchV2=function(e){return this.request("files/search_v2",e,"user","api","rpc","files.metadata.read")};Ce.filesSearchContinueV2=function(e){return this.request("files/search/continue_v2",e,"user","api","rpc","files.metadata.read")};Ce.filesTagsAdd=function(e){return this.request("files/tags/add",e,"user","api","rpc","files.metadata.write")};Ce.filesTagsGet=function(e){return this.request("files/tags/get",e,"user","api","rpc","files.metadata.read")};Ce.filesTagsRemove=function(e){return this.request("files/tags/remove",e,"user","api","rpc","files.metadata.write")};Ce.filesUnlockFileBatch=function(e){return this.request("files/unlock_file_batch",e,"user","api","rpc","files.content.write")};Ce.filesUpload=function(e){return this.request("files/upload",e,"user","content","upload","files.content.write")};Ce.filesUploadSessionAppendV2=function(e){return this.request("files/upload_session/append_v2",e,"user","content","upload","files.content.write")};Ce.filesUploadSessionAppend=function(e){return this.request("files/upload_session/append",e,"user","content","upload","files.content.write")};Ce.filesUploadSessionFinish=function(e){return this.request("files/upload_session/finish",e,"user","content","upload","files.content.write")};Ce.filesUploadSessionFinishBatch=function(e){return this.request("files/upload_session/finish_batch",e,"user","api","rpc","files.content.write")};Ce.filesUploadSessionFinishBatchV2=function(e){return this.request("files/upload_session/finish_batch_v2",e,"user","api","rpc","files.content.write")};Ce.filesUploadSessionFinishBatchCheck=function(e){return this.request("files/upload_session/finish_batch/check",e,"user","api","rpc","files.content.write")};Ce.filesUploadSessionStart=function(e){return this.request("files/upload_session/start",e,"user","content","upload","files.content.write")};Ce.filesUploadSessionStartBatch=function(e){return this.request("files/upload_session/start_batch",e,"user","api","rpc","files.content.write")};Ce.openidUserinfo=function(e){return this.request("openid/userinfo",e,"user","api","rpc","openid")};Ce.paperDocsArchive=function(e){return this.request("paper/docs/archive",e,"user","api","rpc","files.content.write")};Ce.paperDocsCreate=function(e){return this.request("paper/docs/create",e,"user","api","upload","files.content.write")};Ce.paperDocsDownload=function(e){return this.request("paper/docs/download",e,"user","api","download","files.content.read")};Ce.paperDocsFolderUsersList=function(e){return this.request("paper/docs/folder_users/list",e,"user","api","rpc","sharing.read")};Ce.paperDocsFolderUsersListContinue=function(e){return this.request("paper/docs/folder_users/list/continue",e,"user","api","rpc","sharing.read")};Ce.paperDocsGetFolderInfo=function(e){return this.request("paper/docs/get_folder_info",e,"user","api","rpc","sharing.read")};Ce.paperDocsList=function(e){return this.request("paper/docs/list",e,"user","api","rpc","files.metadata.read")};Ce.paperDocsListContinue=function(e){return this.request("paper/docs/list/continue",e,"user","api","rpc","files.metadata.read")};Ce.paperDocsPermanentlyDelete=function(e){return this.request("paper/docs/permanently_delete",e,"user","api","rpc","files.permanent_delete")};Ce.paperDocsSharingPolicyGet=function(e){return this.request("paper/docs/sharing_policy/get",e,"user","api","rpc","sharing.read")};Ce.paperDocsSharingPolicySet=function(e){return this.request("paper/docs/sharing_policy/set",e,"user","api","rpc","sharing.write")};Ce.paperDocsUpdate=function(e){return this.request("paper/docs/update",e,"user","api","upload","files.content.write")};Ce.paperDocsUsersAdd=function(e){return this.request("paper/docs/users/add",e,"user","api","rpc","sharing.write")};Ce.paperDocsUsersList=function(e){return this.request("paper/docs/users/list",e,"user","api","rpc","sharing.read")};Ce.paperDocsUsersListContinue=function(e){return this.request("paper/docs/users/list/continue",e,"user","api","rpc","sharing.read")};Ce.paperDocsUsersRemove=function(e){return this.request("paper/docs/users/remove",e,"user","api","rpc","sharing.write")};Ce.paperFoldersCreate=function(e){return this.request("paper/folders/create",e,"user","api","rpc","files.content.write")};Ce.sharingAddFileMember=function(e){return this.request("sharing/add_file_member",e,"user","api","rpc","sharing.write")};Ce.sharingAddFolderMember=function(e){return this.request("sharing/add_folder_member",e,"user","api","rpc","sharing.write")};Ce.sharingCheckJobStatus=function(e){return this.request("sharing/check_job_status",e,"user","api","rpc","sharing.write")};Ce.sharingCheckRemoveMemberJobStatus=function(e){return this.request("sharing/check_remove_member_job_status",e,"user","api","rpc","sharing.write")};Ce.sharingCheckShareJobStatus=function(e){return this.request("sharing/check_share_job_status",e,"user","api","rpc","sharing.write")};Ce.sharingCreateSharedLink=function(e){return this.request("sharing/create_shared_link",e,"user","api","rpc","sharing.write")};Ce.sharingCreateSharedLinkWithSettings=function(e){return this.request("sharing/create_shared_link_with_settings",e,"user","api","rpc","sharing.write")};Ce.sharingGetFileMetadata=function(e){return this.request("sharing/get_file_metadata",e,"user","api","rpc","sharing.read")};Ce.sharingGetFileMetadataBatch=function(e){return this.request("sharing/get_file_metadata/batch",e,"user","api","rpc","sharing.read")};Ce.sharingGetFolderMetadata=function(e){return this.request("sharing/get_folder_metadata",e,"user","api","rpc","sharing.read")};Ce.sharingGetSharedLinkFile=function(e){return this.request("sharing/get_shared_link_file",e,"user","content","download","sharing.read")};Ce.sharingGetSharedLinkMetadata=function(e){return this.request("sharing/get_shared_link_metadata",e,"app, user","api","rpc","sharing.read")};Ce.sharingGetSharedLinks=function(e){return this.request("sharing/get_shared_links",e,"user","api","rpc","sharing.read")};Ce.sharingListFileMembers=function(e){return this.request("sharing/list_file_members",e,"user","api","rpc","sharing.read")};Ce.sharingListFileMembersBatch=function(e){return this.request("sharing/list_file_members/batch",e,"user","api","rpc","sharing.read")};Ce.sharingListFileMembersContinue=function(e){return this.request("sharing/list_file_members/continue",e,"user","api","rpc","sharing.read")};Ce.sharingListFolderMembers=function(e){return this.request("sharing/list_folder_members",e,"user","api","rpc","sharing.read")};Ce.sharingListFolderMembersContinue=function(e){return this.request("sharing/list_folder_members/continue",e,"user","api","rpc","sharing.read")};Ce.sharingListFolders=function(e){return this.request("sharing/list_folders",e,"user","api","rpc","sharing.read")};Ce.sharingListFoldersContinue=function(e){return this.request("sharing/list_folders/continue",e,"user","api","rpc","sharing.read")};Ce.sharingListMountableFolders=function(e){return this.request("sharing/list_mountable_folders",e,"user","api","rpc","sharing.read")};Ce.sharingListMountableFoldersContinue=function(e){return this.request("sharing/list_mountable_folders/continue",e,"user","api","rpc","sharing.read")};Ce.sharingListReceivedFiles=function(e){return this.request("sharing/list_received_files",e,"user","api","rpc","sharing.read")};Ce.sharingListReceivedFilesContinue=function(e){return this.request("sharing/list_received_files/continue",e,"user","api","rpc","sharing.read")};Ce.sharingListSharedLinks=function(e){return this.request("sharing/list_shared_links",e,"user","api","rpc","sharing.read")};Ce.sharingModifySharedLinkSettings=function(e){return this.request("sharing/modify_shared_link_settings",e,"user","api","rpc","sharing.write")};Ce.sharingMountFolder=function(e){return this.request("sharing/mount_folder",e,"user","api","rpc","sharing.write")};Ce.sharingRelinquishFileMembership=function(e){return this.request("sharing/relinquish_file_membership",e,"user","api","rpc","sharing.write")};Ce.sharingRelinquishFolderMembership=function(e){return this.request("sharing/relinquish_folder_membership",e,"user","api","rpc","sharing.write")};Ce.sharingRemoveFileMember=function(e){return this.request("sharing/remove_file_member",e,"user","api","rpc","sharing.write")};Ce.sharingRemoveFileMember2=function(e){return this.request("sharing/remove_file_member_2",e,"user","api","rpc","sharing.write")};Ce.sharingRemoveFolderMember=function(e){return this.request("sharing/remove_folder_member",e,"user","api","rpc","sharing.write")};Ce.sharingRevokeSharedLink=function(e){return this.request("sharing/revoke_shared_link",e,"user","api","rpc","sharing.write")};Ce.sharingSetAccessInheritance=function(e){return this.request("sharing/set_access_inheritance",e,"user","api","rpc","sharing.write")};Ce.sharingShareFolder=function(e){return this.request("sharing/share_folder",e,"user","api","rpc","sharing.write")};Ce.sharingTransferFolder=function(e){return this.request("sharing/transfer_folder",e,"user","api","rpc","sharing.write")};Ce.sharingUnmountFolder=function(e){return this.request("sharing/unmount_folder",e,"user","api","rpc","sharing.write")};Ce.sharingUnshareFile=function(e){return this.request("sharing/unshare_file",e,"user","api","rpc","sharing.write")};Ce.sharingUnshareFolder=function(e){return this.request("sharing/unshare_folder",e,"user","api","rpc","sharing.write")};Ce.sharingUpdateFileMember=function(e){return this.request("sharing/update_file_member",e,"user","api","rpc","sharing.write")};Ce.sharingUpdateFolderMember=function(e){return this.request("sharing/update_folder_member",e,"user","api","rpc","sharing.write")};Ce.sharingUpdateFolderPolicy=function(e){return this.request("sharing/update_folder_policy",e,"user","api","rpc","sharing.write")};Ce.teamDevicesListMemberDevices=function(e){return this.request("team/devices/list_member_devices",e,"team","api","rpc","sessions.list")};Ce.teamDevicesListMembersDevices=function(e){return this.request("team/devices/list_members_devices",e,"team","api","rpc","sessions.list")};Ce.teamDevicesListTeamDevices=function(e){return this.request("team/devices/list_team_devices",e,"team","api","rpc","sessions.list")};Ce.teamDevicesRevokeDeviceSession=function(e){return this.request("team/devices/revoke_device_session",e,"team","api","rpc","sessions.modify")};Ce.teamDevicesRevokeDeviceSessionBatch=function(e){return this.request("team/devices/revoke_device_session_batch",e,"team","api","rpc","sessions.modify")};Ce.teamFeaturesGetValues=function(e){return this.request("team/features/get_values",e,"team","api","rpc","team_info.read")};Ce.teamGetInfo=function(){return this.request("team/get_info",null,"team","api","rpc","team_info.read")};Ce.teamGroupsCreate=function(e){return this.request("team/groups/create",e,"team","api","rpc","groups.write")};Ce.teamGroupsDelete=function(e){return this.request("team/groups/delete",e,"team","api","rpc","groups.write")};Ce.teamGroupsGetInfo=function(e){return this.request("team/groups/get_info",e,"team","api","rpc","groups.read")};Ce.teamGroupsJobStatusGet=function(e){return this.request("team/groups/job_status/get",e,"team","api","rpc","groups.write")};Ce.teamGroupsList=function(e){return this.request("team/groups/list",e,"team","api","rpc","groups.read")};Ce.teamGroupsListContinue=function(e){return this.request("team/groups/list/continue",e,"team","api","rpc","groups.read")};Ce.teamGroupsMembersAdd=function(e){return this.request("team/groups/members/add",e,"team","api","rpc","groups.write")};Ce.teamGroupsMembersList=function(e){return this.request("team/groups/members/list",e,"team","api","rpc","groups.read")};Ce.teamGroupsMembersListContinue=function(e){return this.request("team/groups/members/list/continue",e,"team","api","rpc","groups.read")};Ce.teamGroupsMembersRemove=function(e){return this.request("team/groups/members/remove",e,"team","api","rpc","groups.write")};Ce.teamGroupsMembersSetAccessType=function(e){return this.request("team/groups/members/set_access_type",e,"team","api","rpc","groups.write")};Ce.teamGroupsUpdate=function(e){return this.request("team/groups/update",e,"team","api","rpc","groups.write")};Ce.teamLegalHoldsCreatePolicy=function(e){return this.request("team/legal_holds/create_policy",e,"team","api","rpc","team_data.governance.write")};Ce.teamLegalHoldsGetPolicy=function(e){return this.request("team/legal_holds/get_policy",e,"team","api","rpc","team_data.governance.write")};Ce.teamLegalHoldsListHeldRevisions=function(e){return this.request("team/legal_holds/list_held_revisions",e,"team","api","rpc","team_data.governance.write")};Ce.teamLegalHoldsListHeldRevisionsContinue=function(e){return this.request("team/legal_holds/list_held_revisions_continue",e,"team","api","rpc","team_data.governance.write")};Ce.teamLegalHoldsListPolicies=function(e){return this.request("team/legal_holds/list_policies",e,"team","api","rpc","team_data.governance.write")};Ce.teamLegalHoldsReleasePolicy=function(e){return this.request("team/legal_holds/release_policy",e,"team","api","rpc","team_data.governance.write")};Ce.teamLegalHoldsUpdatePolicy=function(e){return this.request("team/legal_holds/update_policy",e,"team","api","rpc","team_data.governance.write")};Ce.teamLinkedAppsListMemberLinkedApps=function(e){return this.request("team/linked_apps/list_member_linked_apps",e,"team","api","rpc","sessions.list")};Ce.teamLinkedAppsListMembersLinkedApps=function(e){return this.request("team/linked_apps/list_members_linked_apps",e,"team","api","rpc","sessions.list")};Ce.teamLinkedAppsListTeamLinkedApps=function(e){return this.request("team/linked_apps/list_team_linked_apps",e,"team","api","rpc","sessions.list")};Ce.teamLinkedAppsRevokeLinkedApp=function(e){return this.request("team/linked_apps/revoke_linked_app",e,"team","api","rpc","sessions.modify")};Ce.teamLinkedAppsRevokeLinkedAppBatch=function(e){return this.request("team/linked_apps/revoke_linked_app_batch",e,"team","api","rpc","sessions.modify")};Ce.teamMemberSpaceLimitsExcludedUsersAdd=function(e){return this.request("team/member_space_limits/excluded_users/add",e,"team","api","rpc","members.write")};Ce.teamMemberSpaceLimitsExcludedUsersList=function(e){return this.request("team/member_space_limits/excluded_users/list",e,"team","api","rpc","members.read")};Ce.teamMemberSpaceLimitsExcludedUsersListContinue=function(e){return this.request("team/member_space_limits/excluded_users/list/continue",e,"team","api","rpc","members.read")};Ce.teamMemberSpaceLimitsExcludedUsersRemove=function(e){return this.request("team/member_space_limits/excluded_users/remove",e,"team","api","rpc","members.write")};Ce.teamMemberSpaceLimitsGetCustomQuota=function(e){return this.request("team/member_space_limits/get_custom_quota",e,"team","api","rpc","members.read")};Ce.teamMemberSpaceLimitsRemoveCustomQuota=function(e){return this.request("team/member_space_limits/remove_custom_quota",e,"team","api","rpc","members.write")};Ce.teamMemberSpaceLimitsSetCustomQuota=function(e){return this.request("team/member_space_limits/set_custom_quota",e,"team","api","rpc","members.read")};Ce.teamMembersAddV2=function(e){return this.request("team/members/add_v2",e,"team","api","rpc","members.write")};Ce.teamMembersAdd=function(e){return this.request("team/members/add",e,"team","api","rpc","members.write")};Ce.teamMembersAddJobStatusGetV2=function(e){return this.request("team/members/add/job_status/get_v2",e,"team","api","rpc","members.write")};Ce.teamMembersAddJobStatusGet=function(e){return this.request("team/members/add/job_status/get",e,"team","api","rpc","members.write")};Ce.teamMembersDeleteProfilePhotoV2=function(e){return this.request("team/members/delete_profile_photo_v2",e,"team","api","rpc","members.write")};Ce.teamMembersDeleteProfilePhoto=function(e){return this.request("team/members/delete_profile_photo",e,"team","api","rpc","members.write")};Ce.teamMembersGetAvailableTeamMemberRoles=function(){return this.request("team/members/get_available_team_member_roles",null,"team","api","rpc","members.read")};Ce.teamMembersGetInfoV2=function(e){return this.request("team/members/get_info_v2",e,"team","api","rpc","members.read")};Ce.teamMembersGetInfo=function(e){return this.request("team/members/get_info",e,"team","api","rpc","members.read")};Ce.teamMembersListV2=function(e){return this.request("team/members/list_v2",e,"team","api","rpc","members.read")};Ce.teamMembersList=function(e){return this.request("team/members/list",e,"team","api","rpc","members.read")};Ce.teamMembersListContinueV2=function(e){return this.request("team/members/list/continue_v2",e,"team","api","rpc","members.read")};Ce.teamMembersListContinue=function(e){return this.request("team/members/list/continue",e,"team","api","rpc","members.read")};Ce.teamMembersMoveFormerMemberFiles=function(e){return this.request("team/members/move_former_member_files",e,"team","api","rpc","members.write")};Ce.teamMembersMoveFormerMemberFilesJobStatusCheck=function(e){return this.request("team/members/move_former_member_files/job_status/check",e,"team","api","rpc","members.write")};Ce.teamMembersRecover=function(e){return this.request("team/members/recover",e,"team","api","rpc","members.delete")};Ce.teamMembersRemove=function(e){return this.request("team/members/remove",e,"team","api","rpc","members.delete")};Ce.teamMembersRemoveJobStatusGet=function(e){return this.request("team/members/remove/job_status/get",e,"team","api","rpc","members.delete")};Ce.teamMembersSecondaryEmailsAdd=function(e){return this.request("team/members/secondary_emails/add",e,"team","api","rpc","members.write")};Ce.teamMembersSecondaryEmailsDelete=function(e){return this.request("team/members/secondary_emails/delete",e,"team","api","rpc","members.write")};Ce.teamMembersSecondaryEmailsResendVerificationEmails=function(e){return this.request("team/members/secondary_emails/resend_verification_emails",e,"team","api","rpc","members.write")};Ce.teamMembersSendWelcomeEmail=function(e){return this.request("team/members/send_welcome_email",e,"team","api","rpc","members.write")};Ce.teamMembersSetAdminPermissionsV2=function(e){return this.request("team/members/set_admin_permissions_v2",e,"team","api","rpc","members.write")};Ce.teamMembersSetAdminPermissions=function(e){return this.request("team/members/set_admin_permissions",e,"team","api","rpc","members.write")};Ce.teamMembersSetProfileV2=function(e){return this.request("team/members/set_profile_v2",e,"team","api","rpc","members.write")};Ce.teamMembersSetProfile=function(e){return this.request("team/members/set_profile",e,"team","api","rpc","members.write")};Ce.teamMembersSetProfilePhotoV2=function(e){return this.request("team/members/set_profile_photo_v2",e,"team","api","rpc","members.write")};Ce.teamMembersSetProfilePhoto=function(e){return this.request("team/members/set_profile_photo",e,"team","api","rpc","members.write")};Ce.teamMembersSuspend=function(e){return this.request("team/members/suspend",e,"team","api","rpc","members.write")};Ce.teamMembersUnsuspend=function(e){return this.request("team/members/unsuspend",e,"team","api","rpc","members.write")};Ce.teamNamespacesList=function(e){return this.request("team/namespaces/list",e,"team","api","rpc","team_data.member")};Ce.teamNamespacesListContinue=function(e){return this.request("team/namespaces/list/continue",e,"team","api","rpc","team_data.member")};Ce.teamPropertiesTemplateAdd=function(e){return this.request("team/properties/template/add",e,"team","api","rpc","files.team_metadata.write")};Ce.teamPropertiesTemplateGet=function(e){return this.request("team/properties/template/get",e,"team","api","rpc","files.team_metadata.write")};Ce.teamPropertiesTemplateList=function(){return this.request("team/properties/template/list",null,"team","api","rpc","files.team_metadata.write")};Ce.teamPropertiesTemplateUpdate=function(e){return this.request("team/properties/template/update",e,"team","api","rpc","files.team_metadata.write")};Ce.teamReportsGetActivity=function(e){return this.request("team/reports/get_activity",e,"team","api","rpc","team_info.read")};Ce.teamReportsGetDevices=function(e){return this.request("team/reports/get_devices",e,"team","api","rpc","team_info.read")};Ce.teamReportsGetMembership=function(e){return this.request("team/reports/get_membership",e,"team","api","rpc","team_info.read")};Ce.teamReportsGetStorage=function(e){return this.request("team/reports/get_storage",e,"team","api","rpc","team_info.read")};Ce.teamSharingAllowlistAdd=function(e){return this.request("team/sharing_allowlist/add",e,"team","api","rpc","team_info.write")};Ce.teamSharingAllowlistList=function(e){return this.request("team/sharing_allowlist/list",e,"team","api","rpc","team_info.read")};Ce.teamSharingAllowlistListContinue=function(e){return this.request("team/sharing_allowlist/list/continue",e,"team","api","rpc","team_info.read")};Ce.teamSharingAllowlistRemove=function(e){return this.request("team/sharing_allowlist/remove",e,"team","api","rpc","team_info.write")};Ce.teamTeamFolderActivate=function(e){return this.request("team/team_folder/activate",e,"team","api","rpc","team_data.content.write")};Ce.teamTeamFolderArchive=function(e){return this.request("team/team_folder/archive",e,"team","api","rpc","team_data.content.write")};Ce.teamTeamFolderArchiveCheck=function(e){return this.request("team/team_folder/archive/check",e,"team","api","rpc","team_data.content.write")};Ce.teamTeamFolderCreate=function(e){return this.request("team/team_folder/create",e,"team","api","rpc","team_data.content.write")};Ce.teamTeamFolderGetInfo=function(e){return this.request("team/team_folder/get_info",e,"team","api","rpc","team_data.content.read")};Ce.teamTeamFolderList=function(e){return this.request("team/team_folder/list",e,"team","api","rpc","team_data.content.read")};Ce.teamTeamFolderListContinue=function(e){return this.request("team/team_folder/list/continue",e,"team","api","rpc","team_data.content.read")};Ce.teamTeamFolderPermanentlyDelete=function(e){return this.request("team/team_folder/permanently_delete",e,"team","api","rpc","team_data.content.write")};Ce.teamTeamFolderRename=function(e){return this.request("team/team_folder/rename",e,"team","api","rpc","team_data.content.write")};Ce.teamTeamFolderUpdateSyncSettings=function(e){return this.request("team/team_folder/update_sync_settings",e,"team","api","rpc","team_data.content.write")};Ce.teamTokenGetAuthenticatedAdmin=function(){return this.request("team/token/get_authenticated_admin",null,"team","api","rpc","team_info.read")};Ce.teamLogGetEvents=function(e){return this.request("team_log/get_events",e,"team","api","rpc","events.read")};Ce.teamLogGetEventsContinue=function(e){return this.request("team_log/get_events/continue",e,"team","api","rpc","events.read")};Ce.usersFeaturesGetValues=function(e){return this.request("users/features/get_values",e,"user","api","rpc","account_info.read")};Ce.usersGetAccount=function(e){return this.request("users/get_account",e,"user","api","rpc","sharing.read")};Ce.usersGetAccountBatch=function(e){return this.request("users/get_account_batch",e,"user","api","rpc","sharing.read")};Ce.usersGetCurrentAccount=function(){return this.request("users/get_current_account",null,"user","api","rpc","account_info.read")};Ce.usersGetSpaceUsage=function(){return this.request("users/get_space_usage",null,"user","api","rpc","account_info.read")};function H7(e){var t="000".concat(e.charCodeAt(0).toString(16)).slice(-4);return"\\u".concat(t)}var eg=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";return s?(r!==R0&&Ty[t]!==void 0&&(t=Ty[t],s="-"),"https://".concat(t).concat(s).concat(r,"/2/")):"https://".concat(r,"/2/")},W7=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sS;return t!==sS&&(t="meta-".concat(t)),"https://".concat(t,"/oauth2/authorize")},aS=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:R0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:".",s="api";return t!==R0&&(s=Ty[s],r="-"),"https://".concat(s).concat(r).concat(t,"/oauth2/token")};function nS(e){return JSON.stringify(e).replace(/[\u007f-\uffff]/g,H7)}function G7(e){return new Date(Date.now()+e*1e3)}function iS(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope||typeof module>"u"||typeof window<"u"}function tg(){return typeof window<"u"}function rg(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function Fh(e){var t=e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");return t}function m0(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?m0=function(r){return typeof r}:m0=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},m0(e)}function V7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K7(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Id(e,t)}function X7(e){var t=$3();return function(){var s=Md(e),a;if(t){var o=Md(this).constructor;a=Reflect.construct(s,arguments,o)}else a=s.apply(this,arguments);return Y7(this,a)}}function Y7(e,t){return t&&(m0(t)==="object"||typeof t=="function")?t:J7(e)}function J7(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ay(e){var t=typeof Map=="function"?new Map:void 0;return Ay=function(s){if(s===null||!Z7(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(s))return t.get(s);t.set(s,a)}function a(){return p0(s,arguments,Md(this).constructor)}return a.prototype=Object.create(s.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),Id(a,s)},Ay(e)}function p0(e,t,r){return $3()?p0=Reflect.construct:p0=function(a,o,l){var u=[null];u.push.apply(u,o);var d=Function.bind.apply(a,u),h=new d;return l&&Id(h,l.prototype),h},p0.apply(null,arguments)}function $3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Z7(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function Id(e,t){return Id=Object.setPrototypeOf||function(s,a){return s.__proto__=a,s},Id(e,t)}function Md(e){return Md=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Md(e)}var Q7=(function(e){K7(r,e);var t=X7(r);function r(s,a,o){var l;return V7(this,r),l=t.call(this,"Response failed with a ".concat(s," code")),l.name="DropboxResponseError",l.status=s,l.headers=a,l.error=o,l}return r})(Ay(Error));function e9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var q3=function e(t,r,s){e9(this,e),this.status=t,this.headers=r,this.result=s};function H3(e){return e.text().then(function(t){var r;try{r=JSON.parse(t)}catch{r=t}throw new Q7(e.status,e.headers,r)})}function D0(e){return e.ok?e.text().then(function(t){var r;try{r=JSON.parse(t)}catch{r=t}return new q3(e.status,e.headers,r)}):H3(e)}function t9(e){return e.ok?new Promise(function(t){iS()?e.blob().then(function(r){return t(r)}):e.buffer().then(function(r){return t(r)})}).then(function(t){var r=JSON.parse(e.headers.get("dropbox-api-result"));return iS()?r.fileBlob=t:r.fileBinary=t,new q3(e.status,e.headers,r)}):H3(e)}function r9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s9(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function a9(e,t,r){return t&&s9(e.prototype,t),e}var Lh,$o,sg,n9=300*1e3,oS=128,i9=["legacy","offline","online"],o9=["code","token"],l9=["none","user","team"],c9=(function(){function e(t){r9(this,e),t=t||{},tg()?(Lh=window.fetch.bind(window),$o=window.crypto||window.msCrypto):rg()?(Lh=self.fetch.bind(self),$o=self.crypto):(Lh=require("node-fetch"),$o=require("crypto")),typeof TextEncoder>"u"?sg=require("util").TextEncoder:sg=TextEncoder,this.fetch=t.fetch||Lh,this.accessToken=t.accessToken,this.accessTokenExpiresAt=t.accessTokenExpiresAt,this.refreshToken=t.refreshToken,this.clientId=t.clientId,this.clientSecret=t.clientSecret,this.domain=t.domain,this.domainDelimiter=t.domainDelimiter,this.customHeaders=t.customHeaders,this.dataOnBody=t.dataOnBody}return a9(e,[{key:"setAccessToken",value:function(r){this.accessToken=r}},{key:"getAccessToken",value:function(){return this.accessToken}},{key:"setClientId",value:function(r){this.clientId=r}},{key:"getClientId",value:function(){return this.clientId}},{key:"setClientSecret",value:function(r){this.clientSecret=r}},{key:"getClientSecret",value:function(){return this.clientSecret}},{key:"getRefreshToken",value:function(){return this.refreshToken}},{key:"setRefreshToken",value:function(r){this.refreshToken=r}},{key:"getAccessTokenExpiresAt",value:function(){return this.accessTokenExpiresAt}},{key:"setAccessTokenExpiresAt",value:function(r){this.accessTokenExpiresAt=r}},{key:"setCodeVerifier",value:function(r){this.codeVerifier=r}},{key:"getCodeVerifier",value:function(){return this.codeVerifier}},{key:"generateCodeChallenge",value:function(){var r=this,s=new sg,a=s.encode(this.codeVerifier),o;if(tg()||rg())return $o.subtle.digest("SHA-256",a).then(function(u){var d=btoa(String.fromCharCode.apply(null,new Uint8Array(u)));o=Fh(d).substr(0,128),r.codeChallenge=o});var l=$o.createHash("sha256").update(a).digest();return o=Fh(l),this.codeChallenge=o,Promise.resolve()}},{key:"generatePKCECodes",value:function(){var r;if(tg()||rg()){var s=new Uint8Array(oS),a=$o.getRandomValues(s),o=btoa(a);r=Fh(o).substr(0,128)}else{var l=$o.randomBytes(oS);r=Fh(l).substr(0,128)}return this.codeVerifier=r,this.generateCodeChallenge()}},{key:"getAuthenticationUrl",value:function(r,s){var a=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"token",l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,d=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"none",h=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,m=this.getClientId(),x=W7(this.domain);if(!m)throw new Error("A client id is required. You can set the client id using .setClientId().");if(o!=="code"&&!r)throw new Error("A redirect uri is required.");if(!o9.includes(o))throw new Error("Authorization type must be code or token");if(l&&!i9.includes(l))throw new Error("Token Access Type must be legacy, offline, or online");if(u&&!(u instanceof Array))throw new Error("Scope must be an array of strings");if(!l9.includes(d))throw new Error("includeGrantedScopes must be none, user, or team");var y;return o==="code"?y="".concat(x,"?response_type=code&client_id=").concat(m):y="".concat(x,"?response_type=token&client_id=").concat(m),r&&(y+="&redirect_uri=".concat(r)),s&&(y+="&state=".concat(s)),l&&(y+="&token_access_type=".concat(l)),u&&(y+="&scope=".concat(u.join(" "))),d!=="none"&&(y+="&include_granted_scopes=".concat(d)),h?this.generatePKCECodes().then(function(){return y+="&code_challenge_method=S256",y+="&code_challenge=".concat(a.codeChallenge),y}):Promise.resolve(y)}},{key:"getAccessTokenFromCode",value:function(r,s){var a=this.getClientId(),o=this.getClientSecret();if(!a)throw new Error("A client id is required. You can set the client id using .setClientId().");var l=aS(this.domain,this.domainDelimiter);if(l+="?grant_type=authorization_code",l+="&code=".concat(s),l+="&client_id=".concat(a),o)l+="&client_secret=".concat(o);else{if(!this.codeVerifier)throw new Error("You must use PKCE when generating the authorization URL to not include a client secret");l+="&code_verifier=".concat(this.codeVerifier)}r&&(l+="&redirect_uri=".concat(r));var u={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}};return this.fetch(l,u).then(function(d){return D0(d)})}},{key:"checkAndRefreshAccessToken",value:function(){var r=this.getRefreshToken()&&this.getClientId(),s=!this.getAccessTokenExpiresAt()||new Date(Date.now()+n9)>=this.getAccessTokenExpiresAt(),a=!this.getAccessToken();return(s||a)&&r?this.refreshAccessToken():Promise.resolve()}},{key:"refreshAccessToken",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,a=this.getClientId(),o=this.getClientSecret();if(!a)throw new Error("A client id is required. You can set the client id using .setClientId().");if(s&&!(s instanceof Array))throw new Error("Scope must be an array of strings");var l=aS(this.domain,this.domainDelimiter),u={headers:{"Content-Type":"application/json"},method:"POST"};if(this.dataOnBody){var d={grant_type:"refresh_token",client_id:a,refresh_token:this.getRefreshToken()};o&&(d.client_secret=o),s&&(d.scope=s.join(" ")),u.body=d}else l+="?grant_type=refresh_token&refresh_token=".concat(this.getRefreshToken()),l+="&client_id=".concat(a),o&&(l+="&client_secret=".concat(o)),s&&(l+="&scope=".concat(s.join(" ")));return this.fetch(l,u).then(function(h){return D0(h)}).then(function(h){r.setAccessToken(h.result.access_token),r.setAccessTokenExpiresAt(G7(h.result.expires_in))})}}]),e})();function u9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d9(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function f9(e,t,r){return t&&d9(e.prototype,t),e}var h9=typeof btoa>"u"?function(e){return Buffer.from(e).toString("base64")}:btoa,m9=(function(){function e(t){u9(this,e),t=t||{},t.auth?this.auth=t.auth:this.auth=new c9(t),this.fetch=t.fetch||this.auth.fetch,this.selectUser=t.selectUser,this.selectAdmin=t.selectAdmin,this.pathRoot=t.pathRoot,this.domain=t.domain||this.auth.domain,this.domainDelimiter=t.domainDelimiter||this.auth.domainDelimiter,this.customHeaders=t.customHeaders||this.auth.customHeaders,Object.assign(this,Ce)}return f9(e,[{key:"request",value:function(r,s,a,o,l){switch(l){case P7:return this.rpcRequest(r,s,a,o);case z7:return this.downloadRequest(r,s,a,o);case U7:return this.uploadRequest(r,s,a,o);default:throw new Error("Invalid request style: ".concat(l))}}},{key:"rpcRequest",value:function(r,s,a,o){var l=this;return this.auth.checkAndRefreshAccessToken().then(function(){var u={method:"POST",body:s?JSON.stringify(s):null,headers:{}};return s&&(u.headers["Content-Type"]="application/json"),l.setAuthHeaders(a,u),l.setCommonHeaders(u),u}).then(function(u){return l.fetch(eg(o,l.domain,l.domainDelimiter)+r,u)}).then(function(u){return D0(u)})}},{key:"downloadRequest",value:function(r,s,a,o){var l=this;return this.auth.checkAndRefreshAccessToken().then(function(){var u={method:"POST",headers:{"Dropbox-API-Arg":nS(s)}};return l.setAuthHeaders(a,u),l.setCommonHeaders(u),u}).then(function(u){return l.fetch(eg(o,l.domain,l.domainDelimiter)+r,u)}).then(function(u){return t9(u)})}},{key:"uploadRequest",value:function(r,s,a,o){var l=this;return this.auth.checkAndRefreshAccessToken().then(function(){var u=s.contents;delete s.contents;var d={body:u,method:"POST",headers:{"Content-Type":"application/octet-stream","Dropbox-API-Arg":nS(s)}};return l.setAuthHeaders(a,d),l.setCommonHeaders(d),d}).then(function(u){return l.fetch(eg(o,l.domain,l.domainDelimiter)+r,u)}).then(function(u){return D0(u)})}},{key:"setAuthHeaders",value:function(r,s){if(r.split(",").length>1){var a=r.replace(" ","").split(",");a.includes(Zx)&&this.auth.getAccessToken()?r=Zx:a.includes(Qx)&&this.auth.getAccessToken()?r=Qx:a.includes(Jx)&&(r=Jx)}switch(r){case Jx:if(this.auth.clientId&&this.auth.clientSecret){var o=h9("".concat(this.auth.clientId,":").concat(this.auth.clientSecret));s.headers.Authorization="Basic ".concat(o)}break;case Qx:case Zx:this.auth.getAccessToken()&&(s.headers.Authorization="Bearer ".concat(this.auth.getAccessToken()));break;case $7:case q7:break;default:throw new Error("Unhandled auth type: ".concat(r))}}},{key:"setCommonHeaders",value:function(r){var s=this;if(this.selectUser&&(r.headers["Dropbox-API-Select-User"]=this.selectUser),this.selectAdmin&&(r.headers["Dropbox-API-Select-Admin"]=this.selectAdmin),this.pathRoot&&(r.headers["Dropbox-API-Path-Root"]=this.pathRoot),this.customHeaders){var a=Object.keys(this.customHeaders);a.forEach(function(o){r.headers[o]=s.customHeaders[o]})}}}]),e})();const p9="fvr4cismfdje3d8",x9="ov7ykh1arjvag8q",g9="wCxiziVcNH0AAAAAAAAAATYQOTE7ajbAsA4aSyDz0_B0YMpZ5jqrelvDPamyPrf4";let Ih=null,ag=null;const y9=async()=>{if(Ih&&ag&&Date.now()<ag-6e5)return Ih;const e=await fetch("https://api.dropbox.com/oauth2/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:g9,client_id:p9,client_secret:x9})});if(!e.ok){const r=await e.json();throw console.error("Token refresh error:",r),new Error("Access Token  : "+(r.error_description||r.error))}const t=await e.json();return Ih=t.access_token,ag=Date.now()+t.expires_in*1e3,Ih},bl=async()=>{const e=await y9();return new m9({accessToken:e})},x0=async(e,t="/intranet")=>{try{const r=await bl(),a=`${Date.now()}_${e.name}`,o=`${t}/${a}`,l=await e.arrayBuffer(),u=await r.filesUpload({path:o,contents:l,mode:{".tag":"add"},autorename:!0});let d;try{d=(await r.sharingCreateSharedLinkWithSettings({path:u.result.path_display,settings:{requested_visibility:{".tag":"public"},audience:{".tag":"public"},access:{".tag":"viewer"}}})).result.url}catch(m){if(m.error?.error?.[".tag"]==="shared_link_already_exists")d=(await r.sharingListSharedLinks({path:u.result.path_display})).result.links[0]?.url;else throw m}return{url:d.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0",""),name:e.name,path:u.result.path_display,size:e.size}}catch(r){throw console.error("Dropbox upload error:",r),console.error("Error details:",JSON.stringify(r,null,2)),r.error&&console.error("Error response:",r.error),new Error("  : "+(r.error?.error_summary||r.message||"   "))}},rf=async(e,t="/intranet")=>{const r=[];for(const s of e){const a=await x0(s,t);r.push(a)}return r},v9=async e=>{try{return await(await bl()).filesDeleteV2({path:e}),!0}catch(t){return console.error("Dropbox delete error:",t),!1}},g0=async e=>{try{if(!e)return!1;let t=e.replace("dl.dropboxusercontent.com","www.dropbox.com");t.includes("dl=")||(t+=t.includes("?")?"&dl=0":"?dl=0");const r=await bl(),s=await r.sharingGetSharedLinkMetadata({url:t});return s.result?.path_lower?(await r.filesDeleteV2({path:s.result.path_lower}),!0):!1}catch(t){return console.error("Dropbox delete by URL error:",t),!!(t.error?.error?.[".tag"]==="path"||t.error?.error_summary?.includes("not_found"))}},sm=async e=>{if(!(!e||e.length===0))for(const t of e){const r=typeof t=="string"?t:t?.url;r&&await g0(r)}},b9=async(e="")=>{try{return(await(await bl()).filesListFolder({path:e})).result.entries.map(a=>({name:a.name,path:a.path_display,id:a.id,isFolder:a[".tag"]==="folder",size:a.size||0,modified:a.client_modified||a.server_modified}))}catch(t){throw console.error("Dropbox list files error:",t),new Error("   : "+(t.error?.error_summary||t.message))}},w9=async e=>{try{return(await(await bl()).filesGetTemporaryLink({path:e})).result.link}catch(t){throw console.error("Dropbox get download link error:",t),new Error("   .")}},_9=async(e,t="/")=>{try{const r=await bl(),s=`${t}/${e.name}`,a=await e.arrayBuffer();return{path:(await r.filesUpload({path:s,contents:a,mode:{".tag":"overwrite"},autorename:!1})).result.path_display,name:e.name,size:e.size}}catch(r){throw console.error("Dropbox upload error:",r),new Error("  : "+(r.error?.error_summary||r.message))}},lS=async e=>{try{return await(await bl()).filesCreateFolderV2({path:e,autorename:!1}),!0}catch(t){if(t.error?.error?.[".tag"]==="path"&&t.error?.error?.path?.[".tag"]==="conflict")return!0;throw console.error("Dropbox create folder error:",t),new Error("  : "+(t.error?.error_summary||t.message))}};var N9=Object.defineProperty,S9=Object.defineProperties,k9=Object.getOwnPropertyDescriptors,cS=Object.getOwnPropertySymbols,E9=Object.prototype.hasOwnProperty,j9=Object.prototype.propertyIsEnumerable,Cy=(e,t,r)=>t in e?N9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,rr=(e,t)=>{for(var r in t||(t={}))E9.call(t,r)&&Cy(e,r,t[r]);if(cS)for(var r of cS(t))j9.call(t,r)&&Cy(e,r,t[r]);return e},Ni=(e,t)=>S9(e,k9(t)),Je=(e,t,r)=>Cy(e,typeof t!="symbol"?t+"":t,r),T9=(e,t,r)=>new Promise((s,a)=>{var o=d=>{try{u(r.next(d))}catch(h){a(h)}},l=d=>{try{u(r.throw(d))}catch(h){a(h)}},u=d=>d.done?s(d.value):Promise.resolve(d.value).then(o,l);u((r=r.apply(e,t)).next())});class O0{constructor(t){Je(this,"rootKey"),this.rootKey=t}}const A9=Object.seal({});class Qe extends O0{constructor(t){super(t),Je(this,"root"),this.root=new Array}prepForXml(t){var r;t.stack.push(this);const s=this.root.map(a=>a instanceof O0?a.prepForXml(t):a).filter(a=>a!==void 0);return t.stack.pop(),{[this.rootKey]:s.length?s.length===1&&((r=s[0])!=null&&r._attr)?s[0]:s:A9}}addChildElement(t){return this.root.push(t),this}}class Ti extends Qe{prepForXml(t){const r=super.prepForXml(t);if(r&&(typeof r[this.rootKey]!="object"||Object.keys(r[this.rootKey]).length))return r}}class jt extends O0{constructor(t){super("_attr"),Je(this,"xmlKeys"),this.root=t}prepForXml(t){const r={};return Object.entries(this.root).forEach(([s,a])=>{if(a!==void 0){const o=this.xmlKeys&&this.xmlKeys[s]||s;r[o]=a}}),{_attr:r}}}class Ai extends O0{constructor(t){super("_attr"),this.root=t}prepForXml(t){return{_attr:Object.values(this.root).filter(({value:s})=>s!==void 0).reduce((s,{key:a,value:o})=>Ni(rr({},s),{[a]:o}),{})}}}class cs extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}}var Pn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ng={},Mh={exports:{}},uS;function mv(){if(uS)return Mh.exports;uS=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(C,L,O){return Function.prototype.apply.call(C,L,O)},r;e&&typeof e.ownKeys=="function"?r=e.ownKeys:Object.getOwnPropertySymbols?r=function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:r=function(C){return Object.getOwnPropertyNames(C)};function s(E){console&&console.warn&&console.warn(E)}var a=Number.isNaN||function(C){return C!==C};function o(){o.init.call(this)}Mh.exports=o,Mh.exports.once=w,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var l=10;function u(E){if(typeof E!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(E){if(typeof E!="number"||E<0||a(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");l=E}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(C){if(typeof C!="number"||C<0||a(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this};function d(E){return E._maxListeners===void 0?o.defaultMaxListeners:E._maxListeners}o.prototype.getMaxListeners=function(){return d(this)},o.prototype.emit=function(C){for(var L=[],O=1;O<arguments.length;O++)L.push(arguments[O]);var B=C==="error",F=this._events;if(F!==void 0)B=B&&F.error===void 0;else if(!B)return!1;if(B){var q;if(L.length>0&&(q=L[0]),q instanceof Error)throw q;var fe=new Error("Unhandled error."+(q?" ("+q.message+")":""));throw fe.context=q,fe}var D=F[C];if(D===void 0)return!1;if(typeof D=="function")t(D,this,L);else for(var V=D.length,I=b(D,V),O=0;O<V;++O)t(I[O],this,L);return!0};function h(E,C,L,O){var B,F,q;if(u(L),F=E._events,F===void 0?(F=E._events=Object.create(null),E._eventsCount=0):(F.newListener!==void 0&&(E.emit("newListener",C,L.listener?L.listener:L),F=E._events),q=F[C]),q===void 0)q=F[C]=L,++E._eventsCount;else if(typeof q=="function"?q=F[C]=O?[L,q]:[q,L]:O?q.unshift(L):q.push(L),B=d(E),B>0&&q.length>B&&!q.warned){q.warned=!0;var fe=new Error("Possible EventEmitter memory leak detected. "+q.length+" "+String(C)+" listeners added. Use emitter.setMaxListeners() to increase limit");fe.name="MaxListenersExceededWarning",fe.emitter=E,fe.type=C,fe.count=q.length,s(fe)}return E}o.prototype.addListener=function(C,L){return h(this,C,L,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(C,L){return h(this,C,L,!0)};function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function x(E,C,L){var O={fired:!1,wrapFn:void 0,target:E,type:C,listener:L},B=m.bind(O);return B.listener=L,O.wrapFn=B,B}o.prototype.once=function(C,L){return u(L),this.on(C,x(this,C,L)),this},o.prototype.prependOnceListener=function(C,L){return u(L),this.prependListener(C,x(this,C,L)),this},o.prototype.removeListener=function(C,L){var O,B,F,q,fe;if(u(L),B=this._events,B===void 0)return this;if(O=B[C],O===void 0)return this;if(O===L||O.listener===L)--this._eventsCount===0?this._events=Object.create(null):(delete B[C],B.removeListener&&this.emit("removeListener",C,O.listener||L));else if(typeof O!="function"){for(F=-1,q=O.length-1;q>=0;q--)if(O[q]===L||O[q].listener===L){fe=O[q].listener,F=q;break}if(F<0)return this;F===0?O.shift():g(O,F),O.length===1&&(B[C]=O[0]),B.removeListener!==void 0&&this.emit("removeListener",C,fe||L)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(C){var L,O,B;if(O=this._events,O===void 0)return this;if(O.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):O[C]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete O[C]),this;if(arguments.length===0){var F=Object.keys(O),q;for(B=0;B<F.length;++B)q=F[B],q!=="removeListener"&&this.removeAllListeners(q);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(L=O[C],typeof L=="function")this.removeListener(C,L);else if(L!==void 0)for(B=L.length-1;B>=0;B--)this.removeListener(C,L[B]);return this};function y(E,C,L){var O=E._events;if(O===void 0)return[];var B=O[C];return B===void 0?[]:typeof B=="function"?L?[B.listener||B]:[B]:L?_(B):b(B,B.length)}o.prototype.listeners=function(C){return y(this,C,!0)},o.prototype.rawListeners=function(C){return y(this,C,!1)},o.listenerCount=function(E,C){return typeof E.listenerCount=="function"?E.listenerCount(C):v.call(E,C)},o.prototype.listenerCount=v;function v(E){var C=this._events;if(C!==void 0){var L=C[E];if(typeof L=="function")return 1;if(L!==void 0)return L.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function b(E,C){for(var L=new Array(C),O=0;O<C;++O)L[O]=E[O];return L}function g(E,C){for(;C+1<E.length;C++)E[C]=E[C+1];E.pop()}function _(E){for(var C=new Array(E.length),L=0;L<C.length;++L)C[L]=E[L].listener||E[L];return C}function w(E,C){return new Promise(function(L,O){function B(q){E.removeListener(C,F),O(q)}function F(){typeof E.removeListener=="function"&&E.removeListener("error",B),L([].slice.call(arguments))}N(E,C,F,{once:!0}),C!=="error"&&k(E,B,{once:!0})})}function k(E,C,L){typeof E.on=="function"&&N(E,"error",C,L)}function N(E,C,L,O){if(typeof E.on=="function")O.once?E.once(C,L):E.on(C,L);else if(typeof E.addEventListener=="function")E.addEventListener(C,function B(F){O.once&&E.removeEventListener(C,B),L(F)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E)}return Mh.exports}var Bh={exports:{}},dS;function yo(){return dS||(dS=1,typeof Object.create=="function"?Bh.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Bh.exports=function(t,r){if(r){t.super_=r;var s=function(){};s.prototype=r.prototype,t.prototype=new s,t.prototype.constructor=t}}),Bh.exports}function C9(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var W3={exports:{}},gs=W3.exports={},Mn,Bn;function Ry(){throw new Error("setTimeout has not been defined")}function Dy(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Mn=setTimeout:Mn=Ry}catch{Mn=Ry}try{typeof clearTimeout=="function"?Bn=clearTimeout:Bn=Dy}catch{Bn=Dy}})();function G3(e){if(Mn===setTimeout)return setTimeout(e,0);if((Mn===Ry||!Mn)&&setTimeout)return Mn=setTimeout,setTimeout(e,0);try{return Mn(e,0)}catch{try{return Mn.call(null,e,0)}catch{return Mn.call(this,e,0)}}}function R9(e){if(Bn===clearTimeout)return clearTimeout(e);if((Bn===Dy||!Bn)&&clearTimeout)return Bn=clearTimeout,clearTimeout(e);try{return Bn(e)}catch{try{return Bn.call(null,e)}catch{return Bn.call(this,e)}}}var mi=[],Fc=!1,Qo,y0=-1;function D9(){!Fc||!Qo||(Fc=!1,Qo.length?mi=Qo.concat(mi):y0=-1,mi.length&&V3())}function V3(){if(!Fc){var e=G3(D9);Fc=!0;for(var t=mi.length;t;){for(Qo=mi,mi=[];++y0<t;)Qo&&Qo[y0].run();y0=-1,t=mi.length}Qo=null,Fc=!1,R9(e)}}gs.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];mi.push(new K3(e,t)),mi.length===1&&!Fc&&G3(V3)};function K3(e,t){this.fun=e,this.array=t}K3.prototype.run=function(){this.fun.apply(null,this.array)};gs.title="browser";gs.browser=!0;gs.env={};gs.argv=[];gs.version="";gs.versions={};function Ci(){}gs.on=Ci;gs.addListener=Ci;gs.once=Ci;gs.off=Ci;gs.removeListener=Ci;gs.removeAllListeners=Ci;gs.emit=Ci;gs.prependListener=Ci;gs.prependOnceListener=Ci;gs.listeners=function(e){return[]};gs.binding=function(e){throw new Error("process.binding is not supported")};gs.cwd=function(){return"/"};gs.chdir=function(e){throw new Error("process.chdir is not supported")};gs.umask=function(){return 0};var O9=W3.exports;const sr=C9(O9);var ig,fS;function X3(){return fS||(fS=1,ig=mv().EventEmitter),ig}var og={},Zu={},hS;function F9(){if(hS)return Zu;hS=1,Zu.byteLength=u,Zu.toByteArray=h,Zu.fromByteArray=y;for(var e=[],t=[],r=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,o=s.length;a<o;++a)e[a]=s[a],t[s.charCodeAt(a)]=a;t[45]=62,t[95]=63;function l(v){var b=v.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=v.indexOf("=");g===-1&&(g=b);var _=g===b?0:4-g%4;return[g,_]}function u(v){var b=l(v),g=b[0],_=b[1];return(g+_)*3/4-_}function d(v,b,g){return(b+g)*3/4-g}function h(v){var b,g=l(v),_=g[0],w=g[1],k=new r(d(v,_,w)),N=0,E=w>0?_-4:_,C;for(C=0;C<E;C+=4)b=t[v.charCodeAt(C)]<<18|t[v.charCodeAt(C+1)]<<12|t[v.charCodeAt(C+2)]<<6|t[v.charCodeAt(C+3)],k[N++]=b>>16&255,k[N++]=b>>8&255,k[N++]=b&255;return w===2&&(b=t[v.charCodeAt(C)]<<2|t[v.charCodeAt(C+1)]>>4,k[N++]=b&255),w===1&&(b=t[v.charCodeAt(C)]<<10|t[v.charCodeAt(C+1)]<<4|t[v.charCodeAt(C+2)]>>2,k[N++]=b>>8&255,k[N++]=b&255),k}function m(v){return e[v>>18&63]+e[v>>12&63]+e[v>>6&63]+e[v&63]}function x(v,b,g){for(var _,w=[],k=b;k<g;k+=3)_=(v[k]<<16&16711680)+(v[k+1]<<8&65280)+(v[k+2]&255),w.push(m(_));return w.join("")}function y(v){for(var b,g=v.length,_=g%3,w=[],k=16383,N=0,E=g-_;N<E;N+=k)w.push(x(v,N,N+k>E?E:N+k));return _===1?(b=v[g-1],w.push(e[b>>2]+e[b<<4&63]+"==")):_===2&&(b=(v[g-2]<<8)+v[g-1],w.push(e[b>>10]+e[b>>4&63]+e[b<<2&63]+"=")),w.join("")}return Zu}var Ph={};var mS;function L9(){return mS||(mS=1,Ph.read=function(e,t,r,s,a){var o,l,u=a*8-s-1,d=(1<<u)-1,h=d>>1,m=-7,x=r?a-1:0,y=r?-1:1,v=e[t+x];for(x+=y,o=v&(1<<-m)-1,v>>=-m,m+=u;m>0;o=o*256+e[t+x],x+=y,m-=8);for(l=o&(1<<-m)-1,o>>=-m,m+=s;m>0;l=l*256+e[t+x],x+=y,m-=8);if(o===0)o=1-h;else{if(o===d)return l?NaN:(v?-1:1)*(1/0);l=l+Math.pow(2,s),o=o-h}return(v?-1:1)*l*Math.pow(2,o-s)},Ph.write=function(e,t,r,s,a,o){var l,u,d,h=o*8-a-1,m=(1<<h)-1,x=m>>1,y=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=s?0:o-1,b=s?1:-1,g=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,l=m):(l=Math.floor(Math.log(t)/Math.LN2),t*(d=Math.pow(2,-l))<1&&(l--,d*=2),l+x>=1?t+=y/d:t+=y*Math.pow(2,1-x),t*d>=2&&(l++,d/=2),l+x>=m?(u=0,l=m):l+x>=1?(u=(t*d-1)*Math.pow(2,a),l=l+x):(u=t*Math.pow(2,x-1)*Math.pow(2,a),l=0));a>=8;e[r+v]=u&255,v+=b,u/=256,a-=8);for(l=l<<a|u,h+=a;h>0;e[r+v]=l&255,v+=b,l/=256,h-=8);e[r+v-b]|=g*128}),Ph}var pS;function am(){return pS||(pS=1,(function(e){var t=F9(),r=L9(),s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=k,e.INSPECT_MAX_BYTES=50;var a=2147483647;e.kMaxLength=a,u.TYPED_ARRAY_SUPPORT=o(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var z=new Uint8Array(1),T={foo:function(){return 42}};return Object.setPrototypeOf(T,Uint8Array.prototype),Object.setPrototypeOf(z,T),z.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function l(z){if(z>a)throw new RangeError('The value "'+z+'" is invalid for option "size"');var T=new Uint8Array(z);return Object.setPrototypeOf(T,u.prototype),T}function u(z,T,A){if(typeof z=="number"){if(typeof T=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return x(z)}return d(z,T,A)}u.poolSize=8192;function d(z,T,A){if(typeof z=="string")return y(z,T);if(ArrayBuffer.isView(z))return b(z);if(z==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z);if(K(z,ArrayBuffer)||z&&K(z.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(K(z,SharedArrayBuffer)||z&&K(z.buffer,SharedArrayBuffer)))return g(z,T,A);if(typeof z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var W=z.valueOf&&z.valueOf();if(W!=null&&W!==z)return u.from(W,T,A);var pe=_(z);if(pe)return pe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof z[Symbol.toPrimitive]=="function")return u.from(z[Symbol.toPrimitive]("string"),T,A);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z)}u.from=function(z,T,A){return d(z,T,A)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function h(z){if(typeof z!="number")throw new TypeError('"size" argument must be of type number');if(z<0)throw new RangeError('The value "'+z+'" is invalid for option "size"')}function m(z,T,A){return h(z),z<=0?l(z):T!==void 0?typeof A=="string"?l(z).fill(T,A):l(z).fill(T):l(z)}u.alloc=function(z,T,A){return m(z,T,A)};function x(z){return h(z),l(z<0?0:w(z)|0)}u.allocUnsafe=function(z){return x(z)},u.allocUnsafeSlow=function(z){return x(z)};function y(z,T){if((typeof T!="string"||T==="")&&(T="utf8"),!u.isEncoding(T))throw new TypeError("Unknown encoding: "+T);var A=N(z,T)|0,W=l(A),pe=W.write(z,T);return pe!==A&&(W=W.slice(0,pe)),W}function v(z){for(var T=z.length<0?0:w(z.length)|0,A=l(T),W=0;W<T;W+=1)A[W]=z[W]&255;return A}function b(z){if(K(z,Uint8Array)){var T=new Uint8Array(z);return g(T.buffer,T.byteOffset,T.byteLength)}return v(z)}function g(z,T,A){if(T<0||z.byteLength<T)throw new RangeError('"offset" is outside of buffer bounds');if(z.byteLength<T+(A||0))throw new RangeError('"length" is outside of buffer bounds');var W;return T===void 0&&A===void 0?W=new Uint8Array(z):A===void 0?W=new Uint8Array(z,T):W=new Uint8Array(z,T,A),Object.setPrototypeOf(W,u.prototype),W}function _(z){if(u.isBuffer(z)){var T=w(z.length)|0,A=l(T);return A.length===0||z.copy(A,0,0,T),A}if(z.length!==void 0)return typeof z.length!="number"||S(z.length)?l(0):v(z);if(z.type==="Buffer"&&Array.isArray(z.data))return v(z.data)}function w(z){if(z>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return z|0}function k(z){return+z!=z&&(z=0),u.alloc(+z)}u.isBuffer=function(T){return T!=null&&T._isBuffer===!0&&T!==u.prototype},u.compare=function(T,A){if(K(T,Uint8Array)&&(T=u.from(T,T.offset,T.byteLength)),K(A,Uint8Array)&&(A=u.from(A,A.offset,A.byteLength)),!u.isBuffer(T)||!u.isBuffer(A))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(T===A)return 0;for(var W=T.length,pe=A.length,_e=0,oe=Math.min(W,pe);_e<oe;++_e)if(T[_e]!==A[_e]){W=T[_e],pe=A[_e];break}return W<pe?-1:pe<W?1:0},u.isEncoding=function(T){switch(String(T).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(T,A){if(!Array.isArray(T))throw new TypeError('"list" argument must be an Array of Buffers');if(T.length===0)return u.alloc(0);var W;if(A===void 0)for(A=0,W=0;W<T.length;++W)A+=T[W].length;var pe=u.allocUnsafe(A),_e=0;for(W=0;W<T.length;++W){var oe=T[W];if(K(oe,Uint8Array))_e+oe.length>pe.length?u.from(oe).copy(pe,_e):Uint8Array.prototype.set.call(pe,oe,_e);else if(u.isBuffer(oe))oe.copy(pe,_e);else throw new TypeError('"list" argument must be an Array of Buffers');_e+=oe.length}return pe};function N(z,T){if(u.isBuffer(z))return z.length;if(ArrayBuffer.isView(z)||K(z,ArrayBuffer))return z.byteLength;if(typeof z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof z);var A=z.length,W=arguments.length>2&&arguments[2]===!0;if(!W&&A===0)return 0;for(var pe=!1;;)switch(T){case"ascii":case"latin1":case"binary":return A;case"utf8":case"utf-8":return U(z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A*2;case"hex":return A>>>1;case"base64":return ie(z).length;default:if(pe)return W?-1:U(z).length;T=(""+T).toLowerCase(),pe=!0}}u.byteLength=N;function E(z,T,A){var W=!1;if((T===void 0||T<0)&&(T=0),T>this.length||((A===void 0||A>this.length)&&(A=this.length),A<=0)||(A>>>=0,T>>>=0,A<=T))return"";for(z||(z="utf8");;)switch(z){case"hex":return ee(this,T,A);case"utf8":case"utf-8":return I(this,T,A);case"ascii":return te(this,T,A);case"latin1":case"binary":return ve(this,T,A);case"base64":return V(this,T,A);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Se(this,T,A);default:if(W)throw new TypeError("Unknown encoding: "+z);z=(z+"").toLowerCase(),W=!0}}u.prototype._isBuffer=!0;function C(z,T,A){var W=z[T];z[T]=z[A],z[A]=W}u.prototype.swap16=function(){var T=this.length;if(T%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var A=0;A<T;A+=2)C(this,A,A+1);return this},u.prototype.swap32=function(){var T=this.length;if(T%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var A=0;A<T;A+=4)C(this,A,A+3),C(this,A+1,A+2);return this},u.prototype.swap64=function(){var T=this.length;if(T%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var A=0;A<T;A+=8)C(this,A,A+7),C(this,A+1,A+6),C(this,A+2,A+5),C(this,A+3,A+4);return this},u.prototype.toString=function(){var T=this.length;return T===0?"":arguments.length===0?I(this,0,T):E.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(T){if(!u.isBuffer(T))throw new TypeError("Argument must be a Buffer");return this===T?!0:u.compare(this,T)===0},u.prototype.inspect=function(){var T="",A=e.INSPECT_MAX_BYTES;return T=this.toString("hex",0,A).replace(/(.{2})/g,"$1 ").trim(),this.length>A&&(T+=" ... "),"<Buffer "+T+">"},s&&(u.prototype[s]=u.prototype.inspect),u.prototype.compare=function(T,A,W,pe,_e){if(K(T,Uint8Array)&&(T=u.from(T,T.offset,T.byteLength)),!u.isBuffer(T))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof T);if(A===void 0&&(A=0),W===void 0&&(W=T?T.length:0),pe===void 0&&(pe=0),_e===void 0&&(_e=this.length),A<0||W>T.length||pe<0||_e>this.length)throw new RangeError("out of range index");if(pe>=_e&&A>=W)return 0;if(pe>=_e)return-1;if(A>=W)return 1;if(A>>>=0,W>>>=0,pe>>>=0,_e>>>=0,this===T)return 0;for(var oe=_e-pe,Te=W-A,Me=Math.min(oe,Te),Ae=this.slice(pe,_e),Re=T.slice(A,W),et=0;et<Me;++et)if(Ae[et]!==Re[et]){oe=Ae[et],Te=Re[et];break}return oe<Te?-1:Te<oe?1:0};function L(z,T,A,W,pe){if(z.length===0)return-1;if(typeof A=="string"?(W=A,A=0):A>2147483647?A=2147483647:A<-2147483648&&(A=-2147483648),A=+A,S(A)&&(A=pe?0:z.length-1),A<0&&(A=z.length+A),A>=z.length){if(pe)return-1;A=z.length-1}else if(A<0)if(pe)A=0;else return-1;if(typeof T=="string"&&(T=u.from(T,W)),u.isBuffer(T))return T.length===0?-1:O(z,T,A,W,pe);if(typeof T=="number")return T=T&255,typeof Uint8Array.prototype.indexOf=="function"?pe?Uint8Array.prototype.indexOf.call(z,T,A):Uint8Array.prototype.lastIndexOf.call(z,T,A):O(z,[T],A,W,pe);throw new TypeError("val must be string, number or Buffer")}function O(z,T,A,W,pe){var _e=1,oe=z.length,Te=T.length;if(W!==void 0&&(W=String(W).toLowerCase(),W==="ucs2"||W==="ucs-2"||W==="utf16le"||W==="utf-16le")){if(z.length<2||T.length<2)return-1;_e=2,oe/=2,Te/=2,A/=2}function Me(at,De){return _e===1?at[De]:at.readUInt16BE(De*_e)}var Ae;if(pe){var Re=-1;for(Ae=A;Ae<oe;Ae++)if(Me(z,Ae)===Me(T,Re===-1?0:Ae-Re)){if(Re===-1&&(Re=Ae),Ae-Re+1===Te)return Re*_e}else Re!==-1&&(Ae-=Ae-Re),Re=-1}else for(A+Te>oe&&(A=oe-Te),Ae=A;Ae>=0;Ae--){for(var et=!0,He=0;He<Te;He++)if(Me(z,Ae+He)!==Me(T,He)){et=!1;break}if(et)return Ae}return-1}u.prototype.includes=function(T,A,W){return this.indexOf(T,A,W)!==-1},u.prototype.indexOf=function(T,A,W){return L(this,T,A,W,!0)},u.prototype.lastIndexOf=function(T,A,W){return L(this,T,A,W,!1)};function B(z,T,A,W){A=Number(A)||0;var pe=z.length-A;W?(W=Number(W),W>pe&&(W=pe)):W=pe;var _e=T.length;W>_e/2&&(W=_e/2);for(var oe=0;oe<W;++oe){var Te=parseInt(T.substr(oe*2,2),16);if(S(Te))return oe;z[A+oe]=Te}return oe}function F(z,T,A,W){return H(U(T,z.length-A),z,A,W)}function q(z,T,A,W){return H(le(T),z,A,W)}function fe(z,T,A,W){return H(ie(T),z,A,W)}function D(z,T,A,W){return H(ne(T,z.length-A),z,A,W)}u.prototype.write=function(T,A,W,pe){if(A===void 0)pe="utf8",W=this.length,A=0;else if(W===void 0&&typeof A=="string")pe=A,W=this.length,A=0;else if(isFinite(A))A=A>>>0,isFinite(W)?(W=W>>>0,pe===void 0&&(pe="utf8")):(pe=W,W=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var _e=this.length-A;if((W===void 0||W>_e)&&(W=_e),T.length>0&&(W<0||A<0)||A>this.length)throw new RangeError("Attempt to write outside buffer bounds");pe||(pe="utf8");for(var oe=!1;;)switch(pe){case"hex":return B(this,T,A,W);case"utf8":case"utf-8":return F(this,T,A,W);case"ascii":case"latin1":case"binary":return q(this,T,A,W);case"base64":return fe(this,T,A,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,T,A,W);default:if(oe)throw new TypeError("Unknown encoding: "+pe);pe=(""+pe).toLowerCase(),oe=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function V(z,T,A){return T===0&&A===z.length?t.fromByteArray(z):t.fromByteArray(z.slice(T,A))}function I(z,T,A){A=Math.min(z.length,A);for(var W=[],pe=T;pe<A;){var _e=z[pe],oe=null,Te=_e>239?4:_e>223?3:_e>191?2:1;if(pe+Te<=A){var Me,Ae,Re,et;switch(Te){case 1:_e<128&&(oe=_e);break;case 2:Me=z[pe+1],(Me&192)===128&&(et=(_e&31)<<6|Me&63,et>127&&(oe=et));break;case 3:Me=z[pe+1],Ae=z[pe+2],(Me&192)===128&&(Ae&192)===128&&(et=(_e&15)<<12|(Me&63)<<6|Ae&63,et>2047&&(et<55296||et>57343)&&(oe=et));break;case 4:Me=z[pe+1],Ae=z[pe+2],Re=z[pe+3],(Me&192)===128&&(Ae&192)===128&&(Re&192)===128&&(et=(_e&15)<<18|(Me&63)<<12|(Ae&63)<<6|Re&63,et>65535&&et<1114112&&(oe=et))}}oe===null?(oe=65533,Te=1):oe>65535&&(oe-=65536,W.push(oe>>>10&1023|55296),oe=56320|oe&1023),W.push(oe),pe+=Te}return Q(W)}var ae=4096;function Q(z){var T=z.length;if(T<=ae)return String.fromCharCode.apply(String,z);for(var A="",W=0;W<T;)A+=String.fromCharCode.apply(String,z.slice(W,W+=ae));return A}function te(z,T,A){var W="";A=Math.min(z.length,A);for(var pe=T;pe<A;++pe)W+=String.fromCharCode(z[pe]&127);return W}function ve(z,T,A){var W="";A=Math.min(z.length,A);for(var pe=T;pe<A;++pe)W+=String.fromCharCode(z[pe]);return W}function ee(z,T,A){var W=z.length;(!T||T<0)&&(T=0),(!A||A<0||A>W)&&(A=W);for(var pe="",_e=T;_e<A;++_e)pe+=ue[z[_e]];return pe}function Se(z,T,A){for(var W=z.slice(T,A),pe="",_e=0;_e<W.length-1;_e+=2)pe+=String.fromCharCode(W[_e]+W[_e+1]*256);return pe}u.prototype.slice=function(T,A){var W=this.length;T=~~T,A=A===void 0?W:~~A,T<0?(T+=W,T<0&&(T=0)):T>W&&(T=W),A<0?(A+=W,A<0&&(A=0)):A>W&&(A=W),A<T&&(A=T);var pe=this.subarray(T,A);return Object.setPrototypeOf(pe,u.prototype),pe};function J(z,T,A){if(z%1!==0||z<0)throw new RangeError("offset is not uint");if(z+T>A)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(T,A,W){T=T>>>0,A=A>>>0,W||J(T,A,this.length);for(var pe=this[T],_e=1,oe=0;++oe<A&&(_e*=256);)pe+=this[T+oe]*_e;return pe},u.prototype.readUintBE=u.prototype.readUIntBE=function(T,A,W){T=T>>>0,A=A>>>0,W||J(T,A,this.length);for(var pe=this[T+--A],_e=1;A>0&&(_e*=256);)pe+=this[T+--A]*_e;return pe},u.prototype.readUint8=u.prototype.readUInt8=function(T,A){return T=T>>>0,A||J(T,1,this.length),this[T]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(T,A){return T=T>>>0,A||J(T,2,this.length),this[T]|this[T+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(T,A){return T=T>>>0,A||J(T,2,this.length),this[T]<<8|this[T+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(T,A){return T=T>>>0,A||J(T,4,this.length),(this[T]|this[T+1]<<8|this[T+2]<<16)+this[T+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(T,A){return T=T>>>0,A||J(T,4,this.length),this[T]*16777216+(this[T+1]<<16|this[T+2]<<8|this[T+3])},u.prototype.readIntLE=function(T,A,W){T=T>>>0,A=A>>>0,W||J(T,A,this.length);for(var pe=this[T],_e=1,oe=0;++oe<A&&(_e*=256);)pe+=this[T+oe]*_e;return _e*=128,pe>=_e&&(pe-=Math.pow(2,8*A)),pe},u.prototype.readIntBE=function(T,A,W){T=T>>>0,A=A>>>0,W||J(T,A,this.length);for(var pe=A,_e=1,oe=this[T+--pe];pe>0&&(_e*=256);)oe+=this[T+--pe]*_e;return _e*=128,oe>=_e&&(oe-=Math.pow(2,8*A)),oe},u.prototype.readInt8=function(T,A){return T=T>>>0,A||J(T,1,this.length),this[T]&128?(255-this[T]+1)*-1:this[T]},u.prototype.readInt16LE=function(T,A){T=T>>>0,A||J(T,2,this.length);var W=this[T]|this[T+1]<<8;return W&32768?W|4294901760:W},u.prototype.readInt16BE=function(T,A){T=T>>>0,A||J(T,2,this.length);var W=this[T+1]|this[T]<<8;return W&32768?W|4294901760:W},u.prototype.readInt32LE=function(T,A){return T=T>>>0,A||J(T,4,this.length),this[T]|this[T+1]<<8|this[T+2]<<16|this[T+3]<<24},u.prototype.readInt32BE=function(T,A){return T=T>>>0,A||J(T,4,this.length),this[T]<<24|this[T+1]<<16|this[T+2]<<8|this[T+3]},u.prototype.readFloatLE=function(T,A){return T=T>>>0,A||J(T,4,this.length),r.read(this,T,!0,23,4)},u.prototype.readFloatBE=function(T,A){return T=T>>>0,A||J(T,4,this.length),r.read(this,T,!1,23,4)},u.prototype.readDoubleLE=function(T,A){return T=T>>>0,A||J(T,8,this.length),r.read(this,T,!0,52,8)},u.prototype.readDoubleBE=function(T,A){return T=T>>>0,A||J(T,8,this.length),r.read(this,T,!1,52,8)};function M(z,T,A,W,pe,_e){if(!u.isBuffer(z))throw new TypeError('"buffer" argument must be a Buffer instance');if(T>pe||T<_e)throw new RangeError('"value" argument is out of bounds');if(A+W>z.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(T,A,W,pe){if(T=+T,A=A>>>0,W=W>>>0,!pe){var _e=Math.pow(2,8*W)-1;M(this,T,A,W,_e,0)}var oe=1,Te=0;for(this[A]=T&255;++Te<W&&(oe*=256);)this[A+Te]=T/oe&255;return A+W},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(T,A,W,pe){if(T=+T,A=A>>>0,W=W>>>0,!pe){var _e=Math.pow(2,8*W)-1;M(this,T,A,W,_e,0)}var oe=W-1,Te=1;for(this[A+oe]=T&255;--oe>=0&&(Te*=256);)this[A+oe]=T/Te&255;return A+W},u.prototype.writeUint8=u.prototype.writeUInt8=function(T,A,W){return T=+T,A=A>>>0,W||M(this,T,A,1,255,0),this[A]=T&255,A+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(T,A,W){return T=+T,A=A>>>0,W||M(this,T,A,2,65535,0),this[A]=T&255,this[A+1]=T>>>8,A+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(T,A,W){return T=+T,A=A>>>0,W||M(this,T,A,2,65535,0),this[A]=T>>>8,this[A+1]=T&255,A+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(T,A,W){return T=+T,A=A>>>0,W||M(this,T,A,4,4294967295,0),this[A+3]=T>>>24,this[A+2]=T>>>16,this[A+1]=T>>>8,this[A]=T&255,A+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(T,A,W){return T=+T,A=A>>>0,W||M(this,T,A,4,4294967295,0),this[A]=T>>>24,this[A+1]=T>>>16,this[A+2]=T>>>8,this[A+3]=T&255,A+4},u.prototype.writeIntLE=function(T,A,W,pe){if(T=+T,A=A>>>0,!pe){var _e=Math.pow(2,8*W-1);M(this,T,A,W,_e-1,-_e)}var oe=0,Te=1,Me=0;for(this[A]=T&255;++oe<W&&(Te*=256);)T<0&&Me===0&&this[A+oe-1]!==0&&(Me=1),this[A+oe]=(T/Te>>0)-Me&255;return A+W},u.prototype.writeIntBE=function(T,A,W,pe){if(T=+T,A=A>>>0,!pe){var _e=Math.pow(2,8*W-1);M(this,T,A,W,_e-1,-_e)}var oe=W-1,Te=1,Me=0;for(this[A+oe]=T&255;--oe>=0&&(Te*=256);)T<0&&Me===0&&this[A+oe+1]!==0&&(Me=1),this[A+oe]=(T/Te>>0)-Me&255;return A+W},u.prototype.writeInt8=function(T,A,W){return T=+T,A=A>>>0,W||M(this,T,A,1,127,-128),T<0&&(T=255+T+1),this[A]=T&255,A+1},u.prototype.writeInt16LE=function(T,A,W){return T=+T,A=A>>>0,W||M(this,T,A,2,32767,-32768),this[A]=T&255,this[A+1]=T>>>8,A+2},u.prototype.writeInt16BE=function(T,A,W){return T=+T,A=A>>>0,W||M(this,T,A,2,32767,-32768),this[A]=T>>>8,this[A+1]=T&255,A+2},u.prototype.writeInt32LE=function(T,A,W){return T=+T,A=A>>>0,W||M(this,T,A,4,2147483647,-2147483648),this[A]=T&255,this[A+1]=T>>>8,this[A+2]=T>>>16,this[A+3]=T>>>24,A+4},u.prototype.writeInt32BE=function(T,A,W){return T=+T,A=A>>>0,W||M(this,T,A,4,2147483647,-2147483648),T<0&&(T=4294967295+T+1),this[A]=T>>>24,this[A+1]=T>>>16,this[A+2]=T>>>8,this[A+3]=T&255,A+4};function Y(z,T,A,W,pe,_e){if(A+W>z.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("Index out of range")}function G(z,T,A,W,pe){return T=+T,A=A>>>0,pe||Y(z,T,A,4),r.write(z,T,A,W,23,4),A+4}u.prototype.writeFloatLE=function(T,A,W){return G(this,T,A,!0,W)},u.prototype.writeFloatBE=function(T,A,W){return G(this,T,A,!1,W)};function re(z,T,A,W,pe){return T=+T,A=A>>>0,pe||Y(z,T,A,8),r.write(z,T,A,W,52,8),A+8}u.prototype.writeDoubleLE=function(T,A,W){return re(this,T,A,!0,W)},u.prototype.writeDoubleBE=function(T,A,W){return re(this,T,A,!1,W)},u.prototype.copy=function(T,A,W,pe){if(!u.isBuffer(T))throw new TypeError("argument should be a Buffer");if(W||(W=0),!pe&&pe!==0&&(pe=this.length),A>=T.length&&(A=T.length),A||(A=0),pe>0&&pe<W&&(pe=W),pe===W||T.length===0||this.length===0)return 0;if(A<0)throw new RangeError("targetStart out of bounds");if(W<0||W>=this.length)throw new RangeError("Index out of range");if(pe<0)throw new RangeError("sourceEnd out of bounds");pe>this.length&&(pe=this.length),T.length-A<pe-W&&(pe=T.length-A+W);var _e=pe-W;return this===T&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(A,W,pe):Uint8Array.prototype.set.call(T,this.subarray(W,pe),A),_e},u.prototype.fill=function(T,A,W,pe){if(typeof T=="string"){if(typeof A=="string"?(pe=A,A=0,W=this.length):typeof W=="string"&&(pe=W,W=this.length),pe!==void 0&&typeof pe!="string")throw new TypeError("encoding must be a string");if(typeof pe=="string"&&!u.isEncoding(pe))throw new TypeError("Unknown encoding: "+pe);if(T.length===1){var _e=T.charCodeAt(0);(pe==="utf8"&&_e<128||pe==="latin1")&&(T=_e)}}else typeof T=="number"?T=T&255:typeof T=="boolean"&&(T=Number(T));if(A<0||this.length<A||this.length<W)throw new RangeError("Out of range index");if(W<=A)return this;A=A>>>0,W=W===void 0?this.length:W>>>0,T||(T=0);var oe;if(typeof T=="number")for(oe=A;oe<W;++oe)this[oe]=T;else{var Te=u.isBuffer(T)?T:u.from(T,pe),Me=Te.length;if(Me===0)throw new TypeError('The value "'+T+'" is invalid for argument "value"');for(oe=0;oe<W-A;++oe)this[oe+A]=Te[oe%Me]}return this};var ce=/[^+/0-9A-Za-z-_]/g;function P(z){if(z=z.split("=")[0],z=z.trim().replace(ce,""),z.length<2)return"";for(;z.length%4!==0;)z=z+"=";return z}function U(z,T){T=T||1/0;for(var A,W=z.length,pe=null,_e=[],oe=0;oe<W;++oe){if(A=z.charCodeAt(oe),A>55295&&A<57344){if(!pe){if(A>56319){(T-=3)>-1&&_e.push(239,191,189);continue}else if(oe+1===W){(T-=3)>-1&&_e.push(239,191,189);continue}pe=A;continue}if(A<56320){(T-=3)>-1&&_e.push(239,191,189),pe=A;continue}A=(pe-55296<<10|A-56320)+65536}else pe&&(T-=3)>-1&&_e.push(239,191,189);if(pe=null,A<128){if((T-=1)<0)break;_e.push(A)}else if(A<2048){if((T-=2)<0)break;_e.push(A>>6|192,A&63|128)}else if(A<65536){if((T-=3)<0)break;_e.push(A>>12|224,A>>6&63|128,A&63|128)}else if(A<1114112){if((T-=4)<0)break;_e.push(A>>18|240,A>>12&63|128,A>>6&63|128,A&63|128)}else throw new Error("Invalid code point")}return _e}function le(z){for(var T=[],A=0;A<z.length;++A)T.push(z.charCodeAt(A)&255);return T}function ne(z,T){for(var A,W,pe,_e=[],oe=0;oe<z.length&&!((T-=2)<0);++oe)A=z.charCodeAt(oe),W=A>>8,pe=A%256,_e.push(pe),_e.push(W);return _e}function ie(z){return t.toByteArray(P(z))}function H(z,T,A,W){for(var pe=0;pe<W&&!(pe+A>=T.length||pe>=z.length);++pe)T[pe+A]=z[pe];return pe}function K(z,T){return z instanceof T||z!=null&&z.constructor!=null&&z.constructor.name!=null&&z.constructor.name===T.name}function S(z){return z!==z}var ue=(function(){for(var z="0123456789abcdef",T=new Array(256),A=0;A<16;++A)for(var W=A*16,pe=0;pe<16;++pe)T[W+pe]=z[A]+z[pe];return T})()})(og)),og}var lg={},cg={},ug,xS;function Y3(){return xS||(xS=1,ug=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),s=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(s)!=="[object Symbol]")return!1;var a=42;t[r]=a;for(var o in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var l=Object.getOwnPropertySymbols(t);if(l.length!==1||l[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(t,r);if(u.value!==a||u.enumerable!==!0)return!1}return!0}),ug}var dg,gS;function pv(){if(gS)return dg;gS=1;var e=Y3();return dg=function(){return e()&&!!Symbol.toStringTag},dg}var fg,yS;function J3(){return yS||(yS=1,fg=Object),fg}var hg,vS;function I9(){return vS||(vS=1,hg=Error),hg}var mg,bS;function M9(){return bS||(bS=1,mg=EvalError),mg}var pg,wS;function B9(){return wS||(wS=1,pg=RangeError),pg}var xg,_S;function P9(){return _S||(_S=1,xg=ReferenceError),xg}var gg,NS;function Z3(){return NS||(NS=1,gg=SyntaxError),gg}var yg,SS;function sf(){return SS||(SS=1,yg=TypeError),yg}var vg,kS;function U9(){return kS||(kS=1,vg=URIError),vg}var bg,ES;function z9(){return ES||(ES=1,bg=Math.abs),bg}var wg,jS;function $9(){return jS||(jS=1,wg=Math.floor),wg}var _g,TS;function q9(){return TS||(TS=1,_g=Math.max),_g}var Ng,AS;function H9(){return AS||(AS=1,Ng=Math.min),Ng}var Sg,CS;function W9(){return CS||(CS=1,Sg=Math.pow),Sg}var kg,RS;function G9(){return RS||(RS=1,kg=Math.round),kg}var Eg,DS;function V9(){return DS||(DS=1,Eg=Number.isNaN||function(t){return t!==t}),Eg}var jg,OS;function K9(){if(OS)return jg;OS=1;var e=V9();return jg=function(r){return e(r)||r===0?r:r<0?-1:1},jg}var Tg,FS;function X9(){return FS||(FS=1,Tg=Object.getOwnPropertyDescriptor),Tg}var Ag,LS;function af(){if(LS)return Ag;LS=1;var e=X9();if(e)try{e([],"length")}catch{e=null}return Ag=e,Ag}var Cg,IS;function nm(){if(IS)return Cg;IS=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return Cg=e,Cg}var Rg,MS;function Y9(){if(MS)return Rg;MS=1;var e=typeof Symbol<"u"&&Symbol,t=Y3();return Rg=function(){return typeof e!="function"||typeof Symbol!="function"||typeof e("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},Rg}var Dg,BS;function Q3(){return BS||(BS=1,Dg=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Dg}var Og,PS;function ej(){if(PS)return Og;PS=1;var e=J3();return Og=e.getPrototypeOf||null,Og}var Fg,US;function J9(){if(US)return Fg;US=1;var e="Function.prototype.bind called on incompatible ",t=Object.prototype.toString,r=Math.max,s="[object Function]",a=function(d,h){for(var m=[],x=0;x<d.length;x+=1)m[x]=d[x];for(var y=0;y<h.length;y+=1)m[y+d.length]=h[y];return m},o=function(d,h){for(var m=[],x=h,y=0;x<d.length;x+=1,y+=1)m[y]=d[x];return m},l=function(u,d){for(var h="",m=0;m<u.length;m+=1)h+=u[m],m+1<u.length&&(h+=d);return h};return Fg=function(d){var h=this;if(typeof h!="function"||t.apply(h)!==s)throw new TypeError(e+h);for(var m=o(arguments,1),x,y=function(){if(this instanceof x){var w=h.apply(this,a(m,arguments));return Object(w)===w?w:this}return h.apply(d,a(m,arguments))},v=r(0,h.length-m.length),b=[],g=0;g<v;g++)b[g]="$"+g;if(x=Function("binder","return function ("+l(b,",")+"){ return binder.apply(this,arguments); }")(y),h.prototype){var _=function(){};_.prototype=h.prototype,x.prototype=new _,_.prototype=null}return x},Fg}var Lg,zS;function nf(){if(zS)return Lg;zS=1;var e=J9();return Lg=Function.prototype.bind||e,Lg}var Ig,$S;function xv(){return $S||($S=1,Ig=Function.prototype.call),Ig}var Mg,qS;function tj(){return qS||(qS=1,Mg=Function.prototype.apply),Mg}var Bg,HS;function Z9(){return HS||(HS=1,Bg=typeof Reflect<"u"&&Reflect&&Reflect.apply),Bg}var Pg,WS;function Q9(){if(WS)return Pg;WS=1;var e=nf(),t=tj(),r=xv(),s=Z9();return Pg=s||e.call(r,t),Pg}var Ug,GS;function eL(){if(GS)return Ug;GS=1;var e=nf(),t=sf(),r=xv(),s=Q9();return Ug=function(o){if(o.length<1||typeof o[0]!="function")throw new t("a function is required");return s(e,r,o)},Ug}var zg,VS;function tL(){if(VS)return zg;VS=1;var e=eL(),t=af(),r;try{r=[].__proto__===Array.prototype}catch(l){if(!l||typeof l!="object"||!("code"in l)||l.code!=="ERR_PROTO_ACCESS")throw l}var s=!!r&&t&&t(Object.prototype,"__proto__"),a=Object,o=a.getPrototypeOf;return zg=s&&typeof s.get=="function"?e([s.get]):typeof o=="function"?(function(u){return o(u==null?u:a(u))}):!1,zg}var $g,KS;function rL(){if(KS)return $g;KS=1;var e=Q3(),t=ej(),r=tL();return $g=e?function(a){return e(a)}:t?function(a){if(!a||typeof a!="object"&&typeof a!="function")throw new TypeError("getProto: not an object");return t(a)}:r?function(a){return r(a)}:null,$g}var qg,XS;function sL(){if(XS)return qg;XS=1;var e=Function.prototype.call,t=Object.prototype.hasOwnProperty,r=nf();return qg=r.call(e,t),qg}var Hg,YS;function gv(){if(YS)return Hg;YS=1;var e,t=J3(),r=I9(),s=M9(),a=B9(),o=P9(),l=Z3(),u=sf(),d=U9(),h=z9(),m=$9(),x=q9(),y=H9(),v=W9(),b=G9(),g=K9(),_=Function,w=function(le){try{return _('"use strict"; return ('+le+").constructor;")()}catch{}},k=af(),N=nm(),E=function(){throw new u},C=k?(function(){try{return arguments.callee,E}catch{try{return k(arguments,"callee").get}catch{return E}}})():E,L=Y9()(),O=rL(),B=ej(),F=Q3(),q=tj(),fe=xv(),D={},V=typeof Uint8Array>"u"||!O?e:O(Uint8Array),I={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?e:ArrayBuffer,"%ArrayIteratorPrototype%":L&&O?O([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":D,"%AsyncGenerator%":D,"%AsyncGeneratorFunction%":D,"%AsyncIteratorPrototype%":D,"%Atomics%":typeof Atomics>"u"?e:Atomics,"%BigInt%":typeof BigInt>"u"?e:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?e:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":s,"%Float16Array%":typeof Float16Array>"u"?e:Float16Array,"%Float32Array%":typeof Float32Array>"u"?e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?e:FinalizationRegistry,"%Function%":_,"%GeneratorFunction%":D,"%Int8Array%":typeof Int8Array>"u"?e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":L&&O?O(O([][Symbol.iterator]())):e,"%JSON%":typeof JSON=="object"?JSON:e,"%Map%":typeof Map>"u"?e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!L||!O?e:O(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":k,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?e:Promise,"%Proxy%":typeof Proxy>"u"?e:Proxy,"%RangeError%":a,"%ReferenceError%":o,"%Reflect%":typeof Reflect>"u"?e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!L||!O?e:O(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":L&&O?O(""[Symbol.iterator]()):e,"%Symbol%":L?Symbol:e,"%SyntaxError%":l,"%ThrowTypeError%":C,"%TypedArray%":V,"%TypeError%":u,"%Uint8Array%":typeof Uint8Array>"u"?e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?e:Uint32Array,"%URIError%":d,"%WeakMap%":typeof WeakMap>"u"?e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?e:WeakSet,"%Function.prototype.call%":fe,"%Function.prototype.apply%":q,"%Object.defineProperty%":N,"%Object.getPrototypeOf%":B,"%Math.abs%":h,"%Math.floor%":m,"%Math.max%":x,"%Math.min%":y,"%Math.pow%":v,"%Math.round%":b,"%Math.sign%":g,"%Reflect.getPrototypeOf%":F};if(O)try{null.error}catch(le){var ae=O(O(le));I["%Error.prototype%"]=ae}var Q=function le(ne){var ie;if(ne==="%AsyncFunction%")ie=w("async function () {}");else if(ne==="%GeneratorFunction%")ie=w("function* () {}");else if(ne==="%AsyncGeneratorFunction%")ie=w("async function* () {}");else if(ne==="%AsyncGenerator%"){var H=le("%AsyncGeneratorFunction%");H&&(ie=H.prototype)}else if(ne==="%AsyncIteratorPrototype%"){var K=le("%AsyncGenerator%");K&&O&&(ie=O(K.prototype))}return I[ne]=ie,ie},te={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ve=nf(),ee=sL(),Se=ve.call(fe,Array.prototype.concat),J=ve.call(q,Array.prototype.splice),M=ve.call(fe,String.prototype.replace),Y=ve.call(fe,String.prototype.slice),G=ve.call(fe,RegExp.prototype.exec),re=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ce=/\\(\\)?/g,P=function(ne){var ie=Y(ne,0,1),H=Y(ne,-1);if(ie==="%"&&H!=="%")throw new l("invalid intrinsic syntax, expected closing `%`");if(H==="%"&&ie!=="%")throw new l("invalid intrinsic syntax, expected opening `%`");var K=[];return M(ne,re,function(S,ue,z,T){K[K.length]=z?M(T,ce,"$1"):ue||S}),K},U=function(ne,ie){var H=ne,K;if(ee(te,H)&&(K=te[H],H="%"+K[0]+"%"),ee(I,H)){var S=I[H];if(S===D&&(S=Q(H)),typeof S>"u"&&!ie)throw new u("intrinsic "+ne+" exists, but is not available. Please file an issue!");return{alias:K,name:H,value:S}}throw new l("intrinsic "+ne+" does not exist!")};return Hg=function(ne,ie){if(typeof ne!="string"||ne.length===0)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof ie!="boolean")throw new u('"allowMissing" argument must be a boolean');if(G(/^%?[^%]*%?$/,ne)===null)throw new l("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var H=P(ne),K=H.length>0?H[0]:"",S=U("%"+K+"%",ie),ue=S.name,z=S.value,T=!1,A=S.alias;A&&(K=A[0],J(H,Se([0,1],A)));for(var W=1,pe=!0;W<H.length;W+=1){var _e=H[W],oe=Y(_e,0,1),Te=Y(_e,-1);if((oe==='"'||oe==="'"||oe==="`"||Te==='"'||Te==="'"||Te==="`")&&oe!==Te)throw new l("property names with quotes must have matching quotes");if((_e==="constructor"||!pe)&&(T=!0),K+="."+_e,ue="%"+K+"%",ee(I,ue))z=I[ue];else if(z!=null){if(!(_e in z)){if(!ie)throw new u("base intrinsic for "+ne+" exists, but the property is not available.");return}if(k&&W+1>=H.length){var Me=k(z,_e);pe=!!Me,pe&&"get"in Me&&!("originalValue"in Me.get)?z=Me.get:z=z[_e]}else pe=ee(z,_e),z=z[_e];pe&&!T&&(I[ue]=z)}}return z},Hg}var Wg={exports:{}},Gg,JS;function aL(){if(JS)return Gg;JS=1;var e=nm(),t=Z3(),r=sf(),s=af();return Gg=function(o,l,u){if(!o||typeof o!="object"&&typeof o!="function")throw new r("`obj` must be an object or a function`");if(typeof l!="string"&&typeof l!="symbol")throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new r("`loose`, if provided, must be a boolean");var d=arguments.length>3?arguments[3]:null,h=arguments.length>4?arguments[4]:null,m=arguments.length>5?arguments[5]:null,x=arguments.length>6?arguments[6]:!1,y=!!s&&s(o,l);if(e)e(o,l,{configurable:m===null&&y?y.configurable:!m,enumerable:d===null&&y?y.enumerable:!d,value:u,writable:h===null&&y?y.writable:!h});else if(x||!d&&!h&&!m)o[l]=u;else throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Gg}var Vg,ZS;function nL(){if(ZS)return Vg;ZS=1;var e=nm(),t=function(){return!!e};return t.hasArrayLengthDefineBug=function(){if(!e)return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},Vg=t,Vg}var Kg,QS;function iL(){if(QS)return Kg;QS=1;var e=gv(),t=aL(),r=nL()(),s=af(),a=sf(),o=e("%Math.floor%");return Kg=function(u,d){if(typeof u!="function")throw new a("`fn` is not a function");if(typeof d!="number"||d<0||d>4294967295||o(d)!==d)throw new a("`length` must be a positive 32-bit integer");var h=arguments.length>2&&!!arguments[2],m=!0,x=!0;if("length"in u&&s){var y=s(u,"length");y&&!y.configurable&&(m=!1),y&&!y.writable&&(x=!1)}return(m||x||!h)&&(r?t(u,"length",d,!0,!0):t(u,"length",d)),u},Kg}var e4;function rj(){return e4||(e4=1,(function(e){var t=nf(),r=gv(),s=iL(),a=sf(),o=r("%Function.prototype.apply%"),l=r("%Function.prototype.call%"),u=r("%Reflect.apply%",!0)||t.call(l,o),d=nm(),h=r("%Math.max%");e.exports=function(y){if(typeof y!="function")throw new a("a function is required");var v=u(t,l,arguments);return s(v,1+h(0,y.length-(arguments.length-1)),!0)};var m=function(){return u(t,o,arguments)};d?d(e.exports,"apply",{value:m}):e.exports.apply=m})(Wg)),Wg.exports}var Xg,t4;function sj(){if(t4)return Xg;t4=1;var e=gv(),t=rj(),r=t(e("String.prototype.indexOf"));return Xg=function(a,o){var l=e(a,!!o);return typeof l=="function"&&r(a,".prototype.")>-1?t(l):l},Xg}var Yg,r4;function oL(){if(r4)return Yg;r4=1;var e=pv()(),t=sj(),r=t("Object.prototype.toString"),s=function(u){return e&&u&&typeof u=="object"&&Symbol.toStringTag in u?!1:r(u)==="[object Arguments]"},a=function(u){return s(u)?!0:u!==null&&typeof u=="object"&&typeof u.length=="number"&&u.length>=0&&r(u)!=="[object Array]"&&r(u.callee)==="[object Function]"},o=(function(){return s(arguments)})();return s.isLegacyArguments=a,Yg=o?s:a,Yg}var Jg,s4;function lL(){if(s4)return Jg;s4=1;var e=Object.prototype.toString,t=Function.prototype.toString,r=/^\s*(?:function)?\*/,s=pv()(),a=Object.getPrototypeOf,o=function(){if(!s)return!1;try{return Function("return function*() {}")()}catch{}},l;return Jg=function(d){if(typeof d!="function")return!1;if(r.test(t.call(d)))return!0;if(!s){var h=e.call(d);return h==="[object GeneratorFunction]"}if(!a)return!1;if(typeof l>"u"){var m=o();l=m?a(m):!1}return a(d)===l},Jg}var Zg,a4;function cL(){if(a4)return Zg;a4=1;var e=Function.prototype.toString,t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,s;if(typeof t=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw s}}),s={},t(function(){throw 42},null,r)}catch(k){k!==s&&(t=null)}else t=null;var a=/^\s*class\b/,o=function(N){try{var E=e.call(N);return a.test(E)}catch{return!1}},l=function(N){try{return o(N)?!1:(e.call(N),!0)}catch{return!1}},u=Object.prototype.toString,d="[object Object]",h="[object Function]",m="[object GeneratorFunction]",x="[object HTMLAllCollection]",y="[object HTML document.all class]",v="[object HTMLCollection]",b=typeof Symbol=="function"&&!!Symbol.toStringTag,g=!(0 in[,]),_=function(){return!1};if(typeof document=="object"){var w=document.all;u.call(w)===u.call(document.all)&&(_=function(N){if((g||!N)&&(typeof N>"u"||typeof N=="object"))try{var E=u.call(N);return(E===x||E===y||E===v||E===d)&&N("")==null}catch{}return!1})}return Zg=t?function(N){if(_(N))return!0;if(!N||typeof N!="function"&&typeof N!="object")return!1;try{t(N,null,r)}catch(E){if(E!==s)return!1}return!o(N)&&l(N)}:function(N){if(_(N))return!0;if(!N||typeof N!="function"&&typeof N!="object")return!1;if(b)return l(N);if(o(N))return!1;var E=u.call(N);return E!==h&&E!==m&&!/^\[object HTML/.test(E)?!1:l(N)},Zg}var Qg,n4;function uL(){if(n4)return Qg;n4=1;var e=cL(),t=Object.prototype.toString,r=Object.prototype.hasOwnProperty,s=function(d,h,m){for(var x=0,y=d.length;x<y;x++)r.call(d,x)&&(m==null?h(d[x],x,d):h.call(m,d[x],x,d))},a=function(d,h,m){for(var x=0,y=d.length;x<y;x++)m==null?h(d.charAt(x),x,d):h.call(m,d.charAt(x),x,d)},o=function(d,h,m){for(var x in d)r.call(d,x)&&(m==null?h(d[x],x,d):h.call(m,d[x],x,d))},l=function(d,h,m){if(!e(h))throw new TypeError("iterator must be a function");var x;arguments.length>=3&&(x=m),t.call(d)==="[object Array]"?s(d,h,x):typeof d=="string"?a(d,h,x):o(d,h,x)};return Qg=l,Qg}var e1,i4;function dL(){return i4||(i4=1,e1=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),e1}var t1,o4;function fL(){if(o4)return t1;o4=1;var e=dL(),t=typeof globalThis>"u"?Pn:globalThis;return t1=function(){for(var s=[],a=0;a<e.length;a++)typeof t[e[a]]=="function"&&(s[s.length]=e[a]);return s},t1}var r1,l4;function aj(){if(l4)return r1;l4=1;var e=uL(),t=fL(),r=rj(),s=sj(),a=af(),o=s("Object.prototype.toString"),l=pv()(),u=typeof globalThis>"u"?Pn:globalThis,d=t(),h=s("String.prototype.slice"),m=Object.getPrototypeOf,x=s("Array.prototype.indexOf",!0)||function(_,w){for(var k=0;k<_.length;k+=1)if(_[k]===w)return k;return-1},y={__proto__:null};l&&a&&m?e(d,function(g){var _=new u[g];if(Symbol.toStringTag in _){var w=m(_),k=a(w,Symbol.toStringTag);if(!k){var N=m(w);k=a(N,Symbol.toStringTag)}y["$"+g]=r(k.get)}}):e(d,function(g){var _=new u[g],w=_.slice||_.set;w&&(y["$"+g]=r(w))});var v=function(_){var w=!1;return e(y,function(k,N){if(!w)try{"$"+k(_)===N&&(w=h(N,1))}catch{}}),w},b=function(_){var w=!1;return e(y,function(k,N){if(!w)try{k(_),w=h(N,1)}catch{}}),w};return r1=function(_){if(!_||typeof _!="object")return!1;if(!l){var w=h(o(_),8,-1);return x(d,w)>-1?w:w!=="Object"?!1:b(_)}return a?v(_):null},r1}var s1,c4;function hL(){if(c4)return s1;c4=1;var e=aj();return s1=function(r){return!!e(r)},s1}var u4;function mL(){return u4||(u4=1,(function(e){var t=oL(),r=lL(),s=aj(),a=hL();function o(W){return W.call.bind(W)}var l=typeof BigInt<"u",u=typeof Symbol<"u",d=o(Object.prototype.toString),h=o(Number.prototype.valueOf),m=o(String.prototype.valueOf),x=o(Boolean.prototype.valueOf);if(l)var y=o(BigInt.prototype.valueOf);if(u)var v=o(Symbol.prototype.valueOf);function b(W,pe){if(typeof W!="object")return!1;try{return pe(W),!0}catch{return!1}}e.isArgumentsObject=t,e.isGeneratorFunction=r,e.isTypedArray=a;function g(W){return typeof Promise<"u"&&W instanceof Promise||W!==null&&typeof W=="object"&&typeof W.then=="function"&&typeof W.catch=="function"}e.isPromise=g;function _(W){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(W):a(W)||Y(W)}e.isArrayBufferView=_;function w(W){return s(W)==="Uint8Array"}e.isUint8Array=w;function k(W){return s(W)==="Uint8ClampedArray"}e.isUint8ClampedArray=k;function N(W){return s(W)==="Uint16Array"}e.isUint16Array=N;function E(W){return s(W)==="Uint32Array"}e.isUint32Array=E;function C(W){return s(W)==="Int8Array"}e.isInt8Array=C;function L(W){return s(W)==="Int16Array"}e.isInt16Array=L;function O(W){return s(W)==="Int32Array"}e.isInt32Array=O;function B(W){return s(W)==="Float32Array"}e.isFloat32Array=B;function F(W){return s(W)==="Float64Array"}e.isFloat64Array=F;function q(W){return s(W)==="BigInt64Array"}e.isBigInt64Array=q;function fe(W){return s(W)==="BigUint64Array"}e.isBigUint64Array=fe;function D(W){return d(W)==="[object Map]"}D.working=typeof Map<"u"&&D(new Map);function V(W){return typeof Map>"u"?!1:D.working?D(W):W instanceof Map}e.isMap=V;function I(W){return d(W)==="[object Set]"}I.working=typeof Set<"u"&&I(new Set);function ae(W){return typeof Set>"u"?!1:I.working?I(W):W instanceof Set}e.isSet=ae;function Q(W){return d(W)==="[object WeakMap]"}Q.working=typeof WeakMap<"u"&&Q(new WeakMap);function te(W){return typeof WeakMap>"u"?!1:Q.working?Q(W):W instanceof WeakMap}e.isWeakMap=te;function ve(W){return d(W)==="[object WeakSet]"}ve.working=typeof WeakSet<"u"&&ve(new WeakSet);function ee(W){return ve(W)}e.isWeakSet=ee;function Se(W){return d(W)==="[object ArrayBuffer]"}Se.working=typeof ArrayBuffer<"u"&&Se(new ArrayBuffer);function J(W){return typeof ArrayBuffer>"u"?!1:Se.working?Se(W):W instanceof ArrayBuffer}e.isArrayBuffer=J;function M(W){return d(W)==="[object DataView]"}M.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&M(new DataView(new ArrayBuffer(1),0,1));function Y(W){return typeof DataView>"u"?!1:M.working?M(W):W instanceof DataView}e.isDataView=Y;var G=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function re(W){return d(W)==="[object SharedArrayBuffer]"}function ce(W){return typeof G>"u"?!1:(typeof re.working>"u"&&(re.working=re(new G)),re.working?re(W):W instanceof G)}e.isSharedArrayBuffer=ce;function P(W){return d(W)==="[object AsyncFunction]"}e.isAsyncFunction=P;function U(W){return d(W)==="[object Map Iterator]"}e.isMapIterator=U;function le(W){return d(W)==="[object Set Iterator]"}e.isSetIterator=le;function ne(W){return d(W)==="[object Generator]"}e.isGeneratorObject=ne;function ie(W){return d(W)==="[object WebAssembly.Module]"}e.isWebAssemblyCompiledModule=ie;function H(W){return b(W,h)}e.isNumberObject=H;function K(W){return b(W,m)}e.isStringObject=K;function S(W){return b(W,x)}e.isBooleanObject=S;function ue(W){return l&&b(W,y)}e.isBigIntObject=ue;function z(W){return u&&b(W,v)}e.isSymbolObject=z;function T(W){return H(W)||K(W)||S(W)||ue(W)||z(W)}e.isBoxedPrimitive=T;function A(W){return typeof Uint8Array<"u"&&(J(W)||ce(W))}e.isAnyArrayBuffer=A,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(W){Object.defineProperty(e,W,{enumerable:!1,value:function(){throw new Error(W+" is not supported in userland")}})})})(cg)),cg}var a1,d4;function pL(){return d4||(d4=1,a1=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}),a1}var f4;function nj(){return f4||(f4=1,(function(e){var t=Object.getOwnPropertyDescriptors||function(Y){for(var G=Object.keys(Y),re={},ce=0;ce<G.length;ce++)re[G[ce]]=Object.getOwnPropertyDescriptor(Y,G[ce]);return re},r=/%[sdj%]/g;e.format=function(M){if(!C(M)){for(var Y=[],G=0;G<arguments.length;G++)Y.push(l(arguments[G]));return Y.join(" ")}for(var G=1,re=arguments,ce=re.length,P=String(M).replace(r,function(le){if(le==="%%")return"%";if(G>=ce)return le;switch(le){case"%s":return String(re[G++]);case"%d":return Number(re[G++]);case"%j":try{return JSON.stringify(re[G++])}catch{return"[Circular]"}default:return le}}),U=re[G];G<ce;U=re[++G])k(U)||!F(U)?P+=" "+U:P+=" "+l(U);return P},e.deprecate=function(M,Y){if(typeof sr<"u"&&sr.noDeprecation===!0)return M;if(typeof sr>"u")return function(){return e.deprecate(M,Y).apply(this,arguments)};var G=!1;function re(){if(!G){if(sr.throwDeprecation)throw new Error(Y);sr.traceDeprecation?console.trace(Y):console.error(Y),G=!0}return M.apply(this,arguments)}return re};var s={},a=/^$/;if(sr.env.NODE_DEBUG){var o=sr.env.NODE_DEBUG;o=o.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),a=new RegExp("^"+o+"$","i")}e.debuglog=function(M){if(M=M.toUpperCase(),!s[M])if(a.test(M)){var Y=sr.pid;s[M]=function(){var G=e.format.apply(e,arguments);console.error("%s %d: %s",M,Y,G)}}else s[M]=function(){};return s[M]};function l(M,Y){var G={seen:[],stylize:d};return arguments.length>=3&&(G.depth=arguments[2]),arguments.length>=4&&(G.colors=arguments[3]),w(Y)?G.showHidden=Y:Y&&e._extend(G,Y),O(G.showHidden)&&(G.showHidden=!1),O(G.depth)&&(G.depth=2),O(G.colors)&&(G.colors=!1),O(G.customInspect)&&(G.customInspect=!0),G.colors&&(G.stylize=u),m(G,M,G.depth)}e.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function u(M,Y){var G=l.styles[Y];return G?"\x1B["+l.colors[G][0]+"m"+M+"\x1B["+l.colors[G][1]+"m":M}function d(M,Y){return M}function h(M){var Y={};return M.forEach(function(G,re){Y[G]=!0}),Y}function m(M,Y,G){if(M.customInspect&&Y&&D(Y.inspect)&&Y.inspect!==e.inspect&&!(Y.constructor&&Y.constructor.prototype===Y)){var re=Y.inspect(G,M);return C(re)||(re=m(M,re,G)),re}var ce=x(M,Y);if(ce)return ce;var P=Object.keys(Y),U=h(P);if(M.showHidden&&(P=Object.getOwnPropertyNames(Y)),fe(Y)&&(P.indexOf("message")>=0||P.indexOf("description")>=0))return y(Y);if(P.length===0){if(D(Y)){var le=Y.name?": "+Y.name:"";return M.stylize("[Function"+le+"]","special")}if(B(Y))return M.stylize(RegExp.prototype.toString.call(Y),"regexp");if(q(Y))return M.stylize(Date.prototype.toString.call(Y),"date");if(fe(Y))return y(Y)}var ne="",ie=!1,H=["{","}"];if(_(Y)&&(ie=!0,H=["[","]"]),D(Y)){var K=Y.name?": "+Y.name:"";ne=" [Function"+K+"]"}if(B(Y)&&(ne=" "+RegExp.prototype.toString.call(Y)),q(Y)&&(ne=" "+Date.prototype.toUTCString.call(Y)),fe(Y)&&(ne=" "+y(Y)),P.length===0&&(!ie||Y.length==0))return H[0]+ne+H[1];if(G<0)return B(Y)?M.stylize(RegExp.prototype.toString.call(Y),"regexp"):M.stylize("[Object]","special");M.seen.push(Y);var S;return ie?S=v(M,Y,G,U,P):S=P.map(function(ue){return b(M,Y,G,U,ue,ie)}),M.seen.pop(),g(S,ne,H)}function x(M,Y){if(O(Y))return M.stylize("undefined","undefined");if(C(Y)){var G="'"+JSON.stringify(Y).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return M.stylize(G,"string")}if(E(Y))return M.stylize(""+Y,"number");if(w(Y))return M.stylize(""+Y,"boolean");if(k(Y))return M.stylize("null","null")}function y(M){return"["+Error.prototype.toString.call(M)+"]"}function v(M,Y,G,re,ce){for(var P=[],U=0,le=Y.length;U<le;++U)ve(Y,String(U))?P.push(b(M,Y,G,re,String(U),!0)):P.push("");return ce.forEach(function(ne){ne.match(/^\d+$/)||P.push(b(M,Y,G,re,ne,!0))}),P}function b(M,Y,G,re,ce,P){var U,le,ne;if(ne=Object.getOwnPropertyDescriptor(Y,ce)||{value:Y[ce]},ne.get?ne.set?le=M.stylize("[Getter/Setter]","special"):le=M.stylize("[Getter]","special"):ne.set&&(le=M.stylize("[Setter]","special")),ve(re,ce)||(U="["+ce+"]"),le||(M.seen.indexOf(ne.value)<0?(k(G)?le=m(M,ne.value,null):le=m(M,ne.value,G-1),le.indexOf(`
`)>-1&&(P?le=le.split(`
`).map(function(ie){return"  "+ie}).join(`
`).slice(2):le=`
`+le.split(`
`).map(function(ie){return"   "+ie}).join(`
`))):le=M.stylize("[Circular]","special")),O(U)){if(P&&ce.match(/^\d+$/))return le;U=JSON.stringify(""+ce),U.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(U=U.slice(1,-1),U=M.stylize(U,"name")):(U=U.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),U=M.stylize(U,"string"))}return U+": "+le}function g(M,Y,G){var re=M.reduce(function(ce,P){return P.indexOf(`
`)>=0,ce+P.replace(/\u001b\[\d\d?m/g,"").length+1},0);return re>60?G[0]+(Y===""?"":Y+`
 `)+" "+M.join(`,
  `)+" "+G[1]:G[0]+Y+" "+M.join(", ")+" "+G[1]}e.types=mL();function _(M){return Array.isArray(M)}e.isArray=_;function w(M){return typeof M=="boolean"}e.isBoolean=w;function k(M){return M===null}e.isNull=k;function N(M){return M==null}e.isNullOrUndefined=N;function E(M){return typeof M=="number"}e.isNumber=E;function C(M){return typeof M=="string"}e.isString=C;function L(M){return typeof M=="symbol"}e.isSymbol=L;function O(M){return M===void 0}e.isUndefined=O;function B(M){return F(M)&&I(M)==="[object RegExp]"}e.isRegExp=B,e.types.isRegExp=B;function F(M){return typeof M=="object"&&M!==null}e.isObject=F;function q(M){return F(M)&&I(M)==="[object Date]"}e.isDate=q,e.types.isDate=q;function fe(M){return F(M)&&(I(M)==="[object Error]"||M instanceof Error)}e.isError=fe,e.types.isNativeError=fe;function D(M){return typeof M=="function"}e.isFunction=D;function V(M){return M===null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||typeof M=="symbol"||typeof M>"u"}e.isPrimitive=V,e.isBuffer=pL();function I(M){return Object.prototype.toString.call(M)}function ae(M){return M<10?"0"+M.toString(10):M.toString(10)}var Q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function te(){var M=new Date,Y=[ae(M.getHours()),ae(M.getMinutes()),ae(M.getSeconds())].join(":");return[M.getDate(),Q[M.getMonth()],Y].join(" ")}e.log=function(){console.log("%s - %s",te(),e.format.apply(e,arguments))},e.inherits=yo(),e._extend=function(M,Y){if(!Y||!F(Y))return M;for(var G=Object.keys(Y),re=G.length;re--;)M[G[re]]=Y[G[re]];return M};function ve(M,Y){return Object.prototype.hasOwnProperty.call(M,Y)}var ee=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;e.promisify=function(Y){if(typeof Y!="function")throw new TypeError('The "original" argument must be of type Function');if(ee&&Y[ee]){var G=Y[ee];if(typeof G!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(G,ee,{value:G,enumerable:!1,writable:!1,configurable:!0}),G}function G(){for(var re,ce,P=new Promise(function(ne,ie){re=ne,ce=ie}),U=[],le=0;le<arguments.length;le++)U.push(arguments[le]);U.push(function(ne,ie){ne?ce(ne):re(ie)});try{Y.apply(this,U)}catch(ne){ce(ne)}return P}return Object.setPrototypeOf(G,Object.getPrototypeOf(Y)),ee&&Object.defineProperty(G,ee,{value:G,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(G,t(Y))},e.promisify.custom=ee;function Se(M,Y){if(!M){var G=new Error("Promise was rejected with a falsy value");G.reason=M,M=G}return Y(M)}function J(M){if(typeof M!="function")throw new TypeError('The "original" argument must be of type Function');function Y(){for(var G=[],re=0;re<arguments.length;re++)G.push(arguments[re]);var ce=G.pop();if(typeof ce!="function")throw new TypeError("The last argument must be of type Function");var P=this,U=function(){return ce.apply(P,arguments)};M.apply(this,G).then(function(le){sr.nextTick(U.bind(null,null,le))},function(le){sr.nextTick(Se.bind(null,le,U))})}return Object.setPrototypeOf(Y,Object.getPrototypeOf(M)),Object.defineProperties(Y,t(M)),Y}e.callbackify=J})(lg)),lg}var n1,h4;function xL(){if(h4)return n1;h4=1;function e(y,v){var b=Object.keys(y);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(y);v&&(g=g.filter(function(_){return Object.getOwnPropertyDescriptor(y,_).enumerable})),b.push.apply(b,g)}return b}function t(y){for(var v=1;v<arguments.length;v++){var b=arguments[v]!=null?arguments[v]:{};v%2?e(Object(b),!0).forEach(function(g){r(y,g,b[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(b)):e(Object(b)).forEach(function(g){Object.defineProperty(y,g,Object.getOwnPropertyDescriptor(b,g))})}return y}function r(y,v,b){return v in y?Object.defineProperty(y,v,{value:b,enumerable:!0,configurable:!0,writable:!0}):y[v]=b,y}function s(y,v){if(!(y instanceof v))throw new TypeError("Cannot call a class as a function")}function a(y,v){for(var b=0;b<v.length;b++){var g=v[b];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(y,g.key,g)}}function o(y,v,b){return v&&a(y.prototype,v),y}var l=am(),u=l.Buffer,d=nj(),h=d.inspect,m=h&&h.custom||"inspect";function x(y,v,b){u.prototype.copy.call(y,v,b)}return n1=(function(){function y(){s(this,y),this.head=null,this.tail=null,this.length=0}return o(y,[{key:"push",value:function(b){var g={data:b,next:null};this.length>0?this.tail.next=g:this.head=g,this.tail=g,++this.length}},{key:"unshift",value:function(b){var g={data:b,next:this.head};this.length===0&&(this.tail=g),this.head=g,++this.length}},{key:"shift",value:function(){if(this.length!==0){var b=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,b}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(b){if(this.length===0)return"";for(var g=this.head,_=""+g.data;g=g.next;)_+=b+g.data;return _}},{key:"concat",value:function(b){if(this.length===0)return u.alloc(0);for(var g=u.allocUnsafe(b>>>0),_=this.head,w=0;_;)x(_.data,g,w),w+=_.data.length,_=_.next;return g}},{key:"consume",value:function(b,g){var _;return b<this.head.data.length?(_=this.head.data.slice(0,b),this.head.data=this.head.data.slice(b)):b===this.head.data.length?_=this.shift():_=g?this._getString(b):this._getBuffer(b),_}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(b){var g=this.head,_=1,w=g.data;for(b-=w.length;g=g.next;){var k=g.data,N=b>k.length?k.length:b;if(N===k.length?w+=k:w+=k.slice(0,b),b-=N,b===0){N===k.length?(++_,g.next?this.head=g.next:this.head=this.tail=null):(this.head=g,g.data=k.slice(N));break}++_}return this.length-=_,w}},{key:"_getBuffer",value:function(b){var g=u.allocUnsafe(b),_=this.head,w=1;for(_.data.copy(g),b-=_.data.length;_=_.next;){var k=_.data,N=b>k.length?k.length:b;if(k.copy(g,g.length-b,0,N),b-=N,b===0){N===k.length?(++w,_.next?this.head=_.next:this.head=this.tail=null):(this.head=_,_.data=k.slice(N));break}++w}return this.length-=w,g}},{key:m,value:function(b,g){return h(this,t({},g,{depth:0,customInspect:!1}))}}]),y})(),n1}var i1,m4;function ij(){if(m4)return i1;m4=1;function e(l,u){var d=this,h=this._readableState&&this._readableState.destroyed,m=this._writableState&&this._writableState.destroyed;return h||m?(u?u(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,sr.nextTick(a,this,l)):sr.nextTick(a,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(x){!u&&x?d._writableState?d._writableState.errorEmitted?sr.nextTick(r,d):(d._writableState.errorEmitted=!0,sr.nextTick(t,d,x)):sr.nextTick(t,d,x):u?(sr.nextTick(r,d),u(x)):sr.nextTick(r,d)}),this)}function t(l,u){a(l,u),r(l)}function r(l){l._writableState&&!l._writableState.emitClose||l._readableState&&!l._readableState.emitClose||l.emit("close")}function s(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function a(l,u){l.emit("error",u)}function o(l,u){var d=l._readableState,h=l._writableState;d&&d.autoDestroy||h&&h.autoDestroy?l.destroy(u):l.emit("error",u)}return i1={destroy:e,undestroy:s,errorOrDestroy:o},i1}var o1={},p4;function su(){if(p4)return o1;p4=1;function e(u,d){u.prototype=Object.create(d.prototype),u.prototype.constructor=u,u.__proto__=d}var t={};function r(u,d,h){h||(h=Error);function m(y,v,b){return typeof d=="string"?d:d(y,v,b)}var x=(function(y){e(v,y);function v(b,g,_){return y.call(this,m(b,g,_))||this}return v})(h);x.prototype.name=h.name,x.prototype.code=u,t[u]=x}function s(u,d){if(Array.isArray(u)){var h=u.length;return u=u.map(function(m){return String(m)}),h>2?"one of ".concat(d," ").concat(u.slice(0,h-1).join(", "),", or ")+u[h-1]:h===2?"one of ".concat(d," ").concat(u[0]," or ").concat(u[1]):"of ".concat(d," ").concat(u[0])}else return"of ".concat(d," ").concat(String(u))}function a(u,d,h){return u.substr(0,d.length)===d}function o(u,d,h){return(h===void 0||h>u.length)&&(h=u.length),u.substring(h-d.length,h)===d}function l(u,d,h){return typeof h!="number"&&(h=0),h+d.length>u.length?!1:u.indexOf(d,h)!==-1}return r("ERR_INVALID_OPT_VALUE",function(u,d){return'The value "'+d+'" is invalid for option "'+u+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(u,d,h){var m;typeof d=="string"&&a(d,"not ")?(m="must not be",d=d.replace(/^not /,"")):m="must be";var x;if(o(u," argument"))x="The ".concat(u," ").concat(m," ").concat(s(d,"type"));else{var y=l(u,".")?"property":"argument";x='The "'.concat(u,'" ').concat(y," ").concat(m," ").concat(s(d,"type"))}return x+=". Received type ".concat(typeof h),x},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),o1.codes=t,o1}var l1,x4;function oj(){if(x4)return l1;x4=1;var e=su().codes.ERR_INVALID_OPT_VALUE;function t(s,a,o){return s.highWaterMark!=null?s.highWaterMark:a?s[o]:null}function r(s,a,o,l){var u=t(a,l,o);if(u!=null){if(!(isFinite(u)&&Math.floor(u)===u)||u<0){var d=l?o:"highWaterMark";throw new e(d,u)}return Math.floor(u)}return s.objectMode?16:16*1024}return l1={getHighWaterMark:r},l1}var c1,g4;function gL(){if(g4)return c1;g4=1,c1=e;function e(r,s){if(t("noDeprecation"))return r;var a=!1;function o(){if(!a){if(t("throwDeprecation"))throw new Error(s);t("traceDeprecation")?console.trace(s):console.warn(s),a=!0}return r.apply(this,arguments)}return o}function t(r){try{if(!Pn.localStorage)return!1}catch{return!1}var s=Pn.localStorage[r];return s==null?!1:String(s).toLowerCase()==="true"}return c1}var u1,y4;function lj(){if(y4)return u1;y4=1,u1=B;function e(ce){var P=this;this.next=null,this.entry=null,this.finish=function(){re(P,ce)}}var t;B.WritableState=L;var r={deprecate:gL()},s=X3(),a=am().Buffer,o=Pn.Uint8Array||function(){};function l(ce){return a.from(ce)}function u(ce){return a.isBuffer(ce)||ce instanceof o}var d=ij(),h=oj(),m=h.getHighWaterMark,x=su().codes,y=x.ERR_INVALID_ARG_TYPE,v=x.ERR_METHOD_NOT_IMPLEMENTED,b=x.ERR_MULTIPLE_CALLBACK,g=x.ERR_STREAM_CANNOT_PIPE,_=x.ERR_STREAM_DESTROYED,w=x.ERR_STREAM_NULL_VALUES,k=x.ERR_STREAM_WRITE_AFTER_END,N=x.ERR_UNKNOWN_ENCODING,E=d.errorOrDestroy;yo()(B,s);function C(){}function L(ce,P,U){t=t||Hc(),ce=ce||{},typeof U!="boolean"&&(U=P instanceof t),this.objectMode=!!ce.objectMode,U&&(this.objectMode=this.objectMode||!!ce.writableObjectMode),this.highWaterMark=m(this,ce,"writableHighWaterMark",U),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var le=ce.decodeStrings===!1;this.decodeStrings=!le,this.defaultEncoding=ce.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ne){Q(P,ne)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=ce.emitClose!==!1,this.autoDestroy=!!ce.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}L.prototype.getBuffer=function(){for(var P=this.bufferedRequest,U=[];P;)U.push(P),P=P.next;return U},(function(){try{Object.defineProperty(L.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var O;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(O=Function.prototype[Symbol.hasInstance],Object.defineProperty(B,Symbol.hasInstance,{value:function(P){return O.call(this,P)?!0:this!==B?!1:P&&P._writableState instanceof L}})):O=function(P){return P instanceof this};function B(ce){t=t||Hc();var P=this instanceof t;if(!P&&!O.call(B,this))return new B(ce);this._writableState=new L(ce,this,P),this.writable=!0,ce&&(typeof ce.write=="function"&&(this._write=ce.write),typeof ce.writev=="function"&&(this._writev=ce.writev),typeof ce.destroy=="function"&&(this._destroy=ce.destroy),typeof ce.final=="function"&&(this._final=ce.final)),s.call(this)}B.prototype.pipe=function(){E(this,new g)};function F(ce,P){var U=new k;E(ce,U),sr.nextTick(P,U)}function q(ce,P,U,le){var ne;return U===null?ne=new w:typeof U!="string"&&!P.objectMode&&(ne=new y("chunk",["string","Buffer"],U)),ne?(E(ce,ne),sr.nextTick(le,ne),!1):!0}B.prototype.write=function(ce,P,U){var le=this._writableState,ne=!1,ie=!le.objectMode&&u(ce);return ie&&!a.isBuffer(ce)&&(ce=l(ce)),typeof P=="function"&&(U=P,P=null),ie?P="buffer":P||(P=le.defaultEncoding),typeof U!="function"&&(U=C),le.ending?F(this,U):(ie||q(this,le,ce,U))&&(le.pendingcb++,ne=D(this,le,ie,ce,P,U)),ne},B.prototype.cork=function(){this._writableState.corked++},B.prototype.uncork=function(){var ce=this._writableState;ce.corked&&(ce.corked--,!ce.writing&&!ce.corked&&!ce.bufferProcessing&&ce.bufferedRequest&&ee(this,ce))},B.prototype.setDefaultEncoding=function(P){if(typeof P=="string"&&(P=P.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((P+"").toLowerCase())>-1))throw new N(P);return this._writableState.defaultEncoding=P,this},Object.defineProperty(B.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function fe(ce,P,U){return!ce.objectMode&&ce.decodeStrings!==!1&&typeof P=="string"&&(P=a.from(P,U)),P}Object.defineProperty(B.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function D(ce,P,U,le,ne,ie){if(!U){var H=fe(P,le,ne);le!==H&&(U=!0,ne="buffer",le=H)}var K=P.objectMode?1:le.length;P.length+=K;var S=P.length<P.highWaterMark;if(S||(P.needDrain=!0),P.writing||P.corked){var ue=P.lastBufferedRequest;P.lastBufferedRequest={chunk:le,encoding:ne,isBuf:U,callback:ie,next:null},ue?ue.next=P.lastBufferedRequest:P.bufferedRequest=P.lastBufferedRequest,P.bufferedRequestCount+=1}else V(ce,P,!1,K,le,ne,ie);return S}function V(ce,P,U,le,ne,ie,H){P.writelen=le,P.writecb=H,P.writing=!0,P.sync=!0,P.destroyed?P.onwrite(new _("write")):U?ce._writev(ne,P.onwrite):ce._write(ne,ie,P.onwrite),P.sync=!1}function I(ce,P,U,le,ne){--P.pendingcb,U?(sr.nextTick(ne,le),sr.nextTick(Y,ce,P),ce._writableState.errorEmitted=!0,E(ce,le)):(ne(le),ce._writableState.errorEmitted=!0,E(ce,le),Y(ce,P))}function ae(ce){ce.writing=!1,ce.writecb=null,ce.length-=ce.writelen,ce.writelen=0}function Q(ce,P){var U=ce._writableState,le=U.sync,ne=U.writecb;if(typeof ne!="function")throw new b;if(ae(U),P)I(ce,U,le,P,ne);else{var ie=Se(U)||ce.destroyed;!ie&&!U.corked&&!U.bufferProcessing&&U.bufferedRequest&&ee(ce,U),le?sr.nextTick(te,ce,U,ie,ne):te(ce,U,ie,ne)}}function te(ce,P,U,le){U||ve(ce,P),P.pendingcb--,le(),Y(ce,P)}function ve(ce,P){P.length===0&&P.needDrain&&(P.needDrain=!1,ce.emit("drain"))}function ee(ce,P){P.bufferProcessing=!0;var U=P.bufferedRequest;if(ce._writev&&U&&U.next){var le=P.bufferedRequestCount,ne=new Array(le),ie=P.corkedRequestsFree;ie.entry=U;for(var H=0,K=!0;U;)ne[H]=U,U.isBuf||(K=!1),U=U.next,H+=1;ne.allBuffers=K,V(ce,P,!0,P.length,ne,"",ie.finish),P.pendingcb++,P.lastBufferedRequest=null,ie.next?(P.corkedRequestsFree=ie.next,ie.next=null):P.corkedRequestsFree=new e(P),P.bufferedRequestCount=0}else{for(;U;){var S=U.chunk,ue=U.encoding,z=U.callback,T=P.objectMode?1:S.length;if(V(ce,P,!1,T,S,ue,z),U=U.next,P.bufferedRequestCount--,P.writing)break}U===null&&(P.lastBufferedRequest=null)}P.bufferedRequest=U,P.bufferProcessing=!1}B.prototype._write=function(ce,P,U){U(new v("_write()"))},B.prototype._writev=null,B.prototype.end=function(ce,P,U){var le=this._writableState;return typeof ce=="function"?(U=ce,ce=null,P=null):typeof P=="function"&&(U=P,P=null),ce!=null&&this.write(ce,P),le.corked&&(le.corked=1,this.uncork()),le.ending||G(this,le,U),this},Object.defineProperty(B.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Se(ce){return ce.ending&&ce.length===0&&ce.bufferedRequest===null&&!ce.finished&&!ce.writing}function J(ce,P){ce._final(function(U){P.pendingcb--,U&&E(ce,U),P.prefinished=!0,ce.emit("prefinish"),Y(ce,P)})}function M(ce,P){!P.prefinished&&!P.finalCalled&&(typeof ce._final=="function"&&!P.destroyed?(P.pendingcb++,P.finalCalled=!0,sr.nextTick(J,ce,P)):(P.prefinished=!0,ce.emit("prefinish")))}function Y(ce,P){var U=Se(P);if(U&&(M(ce,P),P.pendingcb===0&&(P.finished=!0,ce.emit("finish"),P.autoDestroy))){var le=ce._readableState;(!le||le.autoDestroy&&le.endEmitted)&&ce.destroy()}return U}function G(ce,P,U){P.ending=!0,Y(ce,P),U&&(P.finished?sr.nextTick(U):ce.once("finish",U)),P.ended=!0,ce.writable=!1}function re(ce,P,U){var le=ce.entry;for(ce.entry=null;le;){var ne=le.callback;P.pendingcb--,ne(U),le=le.next}P.corkedRequestsFree.next=ce}return Object.defineProperty(B.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(P){this._writableState&&(this._writableState.destroyed=P)}}),B.prototype.destroy=d.destroy,B.prototype._undestroy=d.undestroy,B.prototype._destroy=function(ce,P){P(ce)},u1}var d1,v4;function Hc(){if(v4)return d1;v4=1;var e=Object.keys||function(h){var m=[];for(var x in h)m.push(x);return m};d1=l;var t=cj(),r=lj();yo()(l,t);for(var s=e(r.prototype),a=0;a<s.length;a++){var o=s[a];l.prototype[o]||(l.prototype[o]=r.prototype[o])}function l(h){if(!(this instanceof l))return new l(h);t.call(this,h),r.call(this,h),this.allowHalfOpen=!0,h&&(h.readable===!1&&(this.readable=!1),h.writable===!1&&(this.writable=!1),h.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",u)))}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function u(){this._writableState.ended||sr.nextTick(d,this)}function d(h){h.end()}return Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(m){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=m,this._writableState.destroyed=m)}}),d1}var f1={},Uh={exports:{}},b4;function yL(){return b4||(b4=1,(function(e,t){var r=am(),s=r.Buffer;function a(l,u){for(var d in l)u[d]=l[d]}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=r:(a(r,t),t.Buffer=o);function o(l,u,d){return s(l,u,d)}a(s,o),o.from=function(l,u,d){if(typeof l=="number")throw new TypeError("Argument must not be a number");return s(l,u,d)},o.alloc=function(l,u,d){if(typeof l!="number")throw new TypeError("Argument must be a number");var h=s(l);return u!==void 0?typeof d=="string"?h.fill(u,d):h.fill(u):h.fill(0),h},o.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return s(l)},o.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(l)}})(Uh,Uh.exports)),Uh.exports}var w4;function Oy(){if(w4)return f1;w4=1;var e=yL().Buffer,t=e.isEncoding||function(w){switch(w=""+w,w&&w.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(w){if(!w)return"utf8";for(var k;;)switch(w){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return w;default:if(k)return;w=(""+w).toLowerCase(),k=!0}}function s(w){var k=r(w);if(typeof k!="string"&&(e.isEncoding===t||!t(w)))throw new Error("Unknown encoding: "+w);return k||w}f1.StringDecoder=a;function a(w){this.encoding=s(w);var k;switch(this.encoding){case"utf16le":this.text=x,this.end=y,k=4;break;case"utf8":this.fillLast=d,k=4;break;case"base64":this.text=v,this.end=b,k=3;break;default:this.write=g,this.end=_;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(k)}a.prototype.write=function(w){if(w.length===0)return"";var k,N;if(this.lastNeed){if(k=this.fillLast(w),k===void 0)return"";N=this.lastNeed,this.lastNeed=0}else N=0;return N<w.length?k?k+this.text(w,N):this.text(w,N):k||""},a.prototype.end=m,a.prototype.text=h,a.prototype.fillLast=function(w){if(this.lastNeed<=w.length)return w.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);w.copy(this.lastChar,this.lastTotal-this.lastNeed,0,w.length),this.lastNeed-=w.length};function o(w){return w<=127?0:w>>5===6?2:w>>4===14?3:w>>3===30?4:w>>6===2?-1:-2}function l(w,k,N){var E=k.length-1;if(E<N)return 0;var C=o(k[E]);return C>=0?(C>0&&(w.lastNeed=C-1),C):--E<N||C===-2?0:(C=o(k[E]),C>=0?(C>0&&(w.lastNeed=C-2),C):--E<N||C===-2?0:(C=o(k[E]),C>=0?(C>0&&(C===2?C=0:w.lastNeed=C-3),C):0))}function u(w,k,N){if((k[0]&192)!==128)return w.lastNeed=0,"";if(w.lastNeed>1&&k.length>1){if((k[1]&192)!==128)return w.lastNeed=1,"";if(w.lastNeed>2&&k.length>2&&(k[2]&192)!==128)return w.lastNeed=2,""}}function d(w){var k=this.lastTotal-this.lastNeed,N=u(this,w);if(N!==void 0)return N;if(this.lastNeed<=w.length)return w.copy(this.lastChar,k,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);w.copy(this.lastChar,k,0,w.length),this.lastNeed-=w.length}function h(w,k){var N=l(this,w,k);if(!this.lastNeed)return w.toString("utf8",k);this.lastTotal=N;var E=w.length-(N-this.lastNeed);return w.copy(this.lastChar,0,E),w.toString("utf8",k,E)}function m(w){var k=w&&w.length?this.write(w):"";return this.lastNeed?k+"":k}function x(w,k){if((w.length-k)%2===0){var N=w.toString("utf16le",k);if(N){var E=N.charCodeAt(N.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=w[w.length-2],this.lastChar[1]=w[w.length-1],N.slice(0,-1)}return N}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=w[w.length-1],w.toString("utf16le",k,w.length-1)}function y(w){var k=w&&w.length?this.write(w):"";if(this.lastNeed){var N=this.lastTotal-this.lastNeed;return k+this.lastChar.toString("utf16le",0,N)}return k}function v(w,k){var N=(w.length-k)%3;return N===0?w.toString("base64",k):(this.lastNeed=3-N,this.lastTotal=3,N===1?this.lastChar[0]=w[w.length-1]:(this.lastChar[0]=w[w.length-2],this.lastChar[1]=w[w.length-1]),w.toString("base64",k,w.length-N))}function b(w){var k=w&&w.length?this.write(w):"";return this.lastNeed?k+this.lastChar.toString("base64",0,3-this.lastNeed):k}function g(w){return w.toString(this.encoding)}function _(w){return w&&w.length?this.write(w):""}return f1}var h1,_4;function yv(){if(_4)return h1;_4=1;var e=su().codes.ERR_STREAM_PREMATURE_CLOSE;function t(o){var l=!1;return function(){if(!l){l=!0;for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];o.apply(this,d)}}}function r(){}function s(o){return o.setHeader&&typeof o.abort=="function"}function a(o,l,u){if(typeof l=="function")return a(o,null,l);l||(l={}),u=t(u||r);var d=l.readable||l.readable!==!1&&o.readable,h=l.writable||l.writable!==!1&&o.writable,m=function(){o.writable||y()},x=o._writableState&&o._writableState.finished,y=function(){h=!1,x=!0,d||u.call(o)},v=o._readableState&&o._readableState.endEmitted,b=function(){d=!1,v=!0,h||u.call(o)},g=function(N){u.call(o,N)},_=function(){var N;if(d&&!v)return(!o._readableState||!o._readableState.ended)&&(N=new e),u.call(o,N);if(h&&!x)return(!o._writableState||!o._writableState.ended)&&(N=new e),u.call(o,N)},w=function(){o.req.on("finish",y)};return s(o)?(o.on("complete",y),o.on("abort",_),o.req?w():o.on("request",w)):h&&!o._writableState&&(o.on("end",m),o.on("close",m)),o.on("end",b),o.on("finish",y),l.error!==!1&&o.on("error",g),o.on("close",_),function(){o.removeListener("complete",y),o.removeListener("abort",_),o.removeListener("request",w),o.req&&o.req.removeListener("finish",y),o.removeListener("end",m),o.removeListener("close",m),o.removeListener("finish",y),o.removeListener("end",b),o.removeListener("error",g),o.removeListener("close",_)}}return h1=a,h1}var m1,N4;function vL(){if(N4)return m1;N4=1;var e;function t(w,k,N){return k in w?Object.defineProperty(w,k,{value:N,enumerable:!0,configurable:!0,writable:!0}):w[k]=N,w}var r=yv(),s=Symbol("lastResolve"),a=Symbol("lastReject"),o=Symbol("error"),l=Symbol("ended"),u=Symbol("lastPromise"),d=Symbol("handlePromise"),h=Symbol("stream");function m(w,k){return{value:w,done:k}}function x(w){var k=w[s];if(k!==null){var N=w[h].read();N!==null&&(w[u]=null,w[s]=null,w[a]=null,k(m(N,!1)))}}function y(w){sr.nextTick(x,w)}function v(w,k){return function(N,E){w.then(function(){if(k[l]){N(m(void 0,!0));return}k[d](N,E)},E)}}var b=Object.getPrototypeOf(function(){}),g=Object.setPrototypeOf((e={get stream(){return this[h]},next:function(){var k=this,N=this[o];if(N!==null)return Promise.reject(N);if(this[l])return Promise.resolve(m(void 0,!0));if(this[h].destroyed)return new Promise(function(O,B){sr.nextTick(function(){k[o]?B(k[o]):O(m(void 0,!0))})});var E=this[u],C;if(E)C=new Promise(v(E,this));else{var L=this[h].read();if(L!==null)return Promise.resolve(m(L,!1));C=new Promise(this[d])}return this[u]=C,C}},t(e,Symbol.asyncIterator,function(){return this}),t(e,"return",function(){var k=this;return new Promise(function(N,E){k[h].destroy(null,function(C){if(C){E(C);return}N(m(void 0,!0))})})}),e),b),_=function(k){var N,E=Object.create(g,(N={},t(N,h,{value:k,writable:!0}),t(N,s,{value:null,writable:!0}),t(N,a,{value:null,writable:!0}),t(N,o,{value:null,writable:!0}),t(N,l,{value:k._readableState.endEmitted,writable:!0}),t(N,d,{value:function(L,O){var B=E[h].read();B?(E[u]=null,E[s]=null,E[a]=null,L(m(B,!1))):(E[s]=L,E[a]=O)},writable:!0}),N));return E[u]=null,r(k,function(C){if(C&&C.code!=="ERR_STREAM_PREMATURE_CLOSE"){var L=E[a];L!==null&&(E[u]=null,E[s]=null,E[a]=null,L(C)),E[o]=C;return}var O=E[s];O!==null&&(E[u]=null,E[s]=null,E[a]=null,O(m(void 0,!0))),E[l]=!0}),k.on("readable",y.bind(null,E)),E};return m1=_,m1}var p1,S4;function bL(){return S4||(S4=1,p1=function(){throw new Error("Readable.from is not available in the browser")}),p1}var x1,k4;function cj(){if(k4)return x1;k4=1,x1=F;var e;F.ReadableState=B,mv().EventEmitter;var t=function(H,K){return H.listeners(K).length},r=X3(),s=am().Buffer,a=Pn.Uint8Array||function(){};function o(ie){return s.from(ie)}function l(ie){return s.isBuffer(ie)||ie instanceof a}var u=nj(),d;u&&u.debuglog?d=u.debuglog("stream"):d=function(){};var h=xL(),m=ij(),x=oj(),y=x.getHighWaterMark,v=su().codes,b=v.ERR_INVALID_ARG_TYPE,g=v.ERR_STREAM_PUSH_AFTER_EOF,_=v.ERR_METHOD_NOT_IMPLEMENTED,w=v.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,k,N,E;yo()(F,r);var C=m.errorOrDestroy,L=["error","close","destroy","pause","resume"];function O(ie,H,K){if(typeof ie.prependListener=="function")return ie.prependListener(H,K);!ie._events||!ie._events[H]?ie.on(H,K):Array.isArray(ie._events[H])?ie._events[H].unshift(K):ie._events[H]=[K,ie._events[H]]}function B(ie,H,K){e=e||Hc(),ie=ie||{},typeof K!="boolean"&&(K=H instanceof e),this.objectMode=!!ie.objectMode,K&&(this.objectMode=this.objectMode||!!ie.readableObjectMode),this.highWaterMark=y(this,ie,"readableHighWaterMark",K),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=ie.emitClose!==!1,this.autoDestroy=!!ie.autoDestroy,this.destroyed=!1,this.defaultEncoding=ie.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,ie.encoding&&(k||(k=Oy().StringDecoder),this.decoder=new k(ie.encoding),this.encoding=ie.encoding)}function F(ie){if(e=e||Hc(),!(this instanceof F))return new F(ie);var H=this instanceof e;this._readableState=new B(ie,this,H),this.readable=!0,ie&&(typeof ie.read=="function"&&(this._read=ie.read),typeof ie.destroy=="function"&&(this._destroy=ie.destroy)),r.call(this)}Object.defineProperty(F.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(H){this._readableState&&(this._readableState.destroyed=H)}}),F.prototype.destroy=m.destroy,F.prototype._undestroy=m.undestroy,F.prototype._destroy=function(ie,H){H(ie)},F.prototype.push=function(ie,H){var K=this._readableState,S;return K.objectMode?S=!0:typeof ie=="string"&&(H=H||K.defaultEncoding,H!==K.encoding&&(ie=s.from(ie,H),H=""),S=!0),q(this,ie,H,!1,S)},F.prototype.unshift=function(ie){return q(this,ie,null,!0,!1)};function q(ie,H,K,S,ue){d("readableAddChunk",H);var z=ie._readableState;if(H===null)z.reading=!1,Q(ie,z);else{var T;if(ue||(T=D(z,H)),T)C(ie,T);else if(z.objectMode||H&&H.length>0)if(typeof H!="string"&&!z.objectMode&&Object.getPrototypeOf(H)!==s.prototype&&(H=o(H)),S)z.endEmitted?C(ie,new w):fe(ie,z,H,!0);else if(z.ended)C(ie,new g);else{if(z.destroyed)return!1;z.reading=!1,z.decoder&&!K?(H=z.decoder.write(H),z.objectMode||H.length!==0?fe(ie,z,H,!1):ee(ie,z)):fe(ie,z,H,!1)}else S||(z.reading=!1,ee(ie,z))}return!z.ended&&(z.length<z.highWaterMark||z.length===0)}function fe(ie,H,K,S){H.flowing&&H.length===0&&!H.sync?(H.awaitDrain=0,ie.emit("data",K)):(H.length+=H.objectMode?1:K.length,S?H.buffer.unshift(K):H.buffer.push(K),H.needReadable&&te(ie)),ee(ie,H)}function D(ie,H){var K;return!l(H)&&typeof H!="string"&&H!==void 0&&!ie.objectMode&&(K=new b("chunk",["string","Buffer","Uint8Array"],H)),K}F.prototype.isPaused=function(){return this._readableState.flowing===!1},F.prototype.setEncoding=function(ie){k||(k=Oy().StringDecoder);var H=new k(ie);this._readableState.decoder=H,this._readableState.encoding=this._readableState.decoder.encoding;for(var K=this._readableState.buffer.head,S="";K!==null;)S+=H.write(K.data),K=K.next;return this._readableState.buffer.clear(),S!==""&&this._readableState.buffer.push(S),this._readableState.length=S.length,this};var V=1073741824;function I(ie){return ie>=V?ie=V:(ie--,ie|=ie>>>1,ie|=ie>>>2,ie|=ie>>>4,ie|=ie>>>8,ie|=ie>>>16,ie++),ie}function ae(ie,H){return ie<=0||H.length===0&&H.ended?0:H.objectMode?1:ie!==ie?H.flowing&&H.length?H.buffer.head.data.length:H.length:(ie>H.highWaterMark&&(H.highWaterMark=I(ie)),ie<=H.length?ie:H.ended?H.length:(H.needReadable=!0,0))}F.prototype.read=function(ie){d("read",ie),ie=parseInt(ie,10);var H=this._readableState,K=ie;if(ie!==0&&(H.emittedReadable=!1),ie===0&&H.needReadable&&((H.highWaterMark!==0?H.length>=H.highWaterMark:H.length>0)||H.ended))return d("read: emitReadable",H.length,H.ended),H.length===0&&H.ended?U(this):te(this),null;if(ie=ae(ie,H),ie===0&&H.ended)return H.length===0&&U(this),null;var S=H.needReadable;d("need readable",S),(H.length===0||H.length-ie<H.highWaterMark)&&(S=!0,d("length less than watermark",S)),H.ended||H.reading?(S=!1,d("reading or ended",S)):S&&(d("do read"),H.reading=!0,H.sync=!0,H.length===0&&(H.needReadable=!0),this._read(H.highWaterMark),H.sync=!1,H.reading||(ie=ae(K,H)));var ue;return ie>0?ue=P(ie,H):ue=null,ue===null?(H.needReadable=H.length<=H.highWaterMark,ie=0):(H.length-=ie,H.awaitDrain=0),H.length===0&&(H.ended||(H.needReadable=!0),K!==ie&&H.ended&&U(this)),ue!==null&&this.emit("data",ue),ue};function Q(ie,H){if(d("onEofChunk"),!H.ended){if(H.decoder){var K=H.decoder.end();K&&K.length&&(H.buffer.push(K),H.length+=H.objectMode?1:K.length)}H.ended=!0,H.sync?te(ie):(H.needReadable=!1,H.emittedReadable||(H.emittedReadable=!0,ve(ie)))}}function te(ie){var H=ie._readableState;d("emitReadable",H.needReadable,H.emittedReadable),H.needReadable=!1,H.emittedReadable||(d("emitReadable",H.flowing),H.emittedReadable=!0,sr.nextTick(ve,ie))}function ve(ie){var H=ie._readableState;d("emitReadable_",H.destroyed,H.length,H.ended),!H.destroyed&&(H.length||H.ended)&&(ie.emit("readable"),H.emittedReadable=!1),H.needReadable=!H.flowing&&!H.ended&&H.length<=H.highWaterMark,ce(ie)}function ee(ie,H){H.readingMore||(H.readingMore=!0,sr.nextTick(Se,ie,H))}function Se(ie,H){for(;!H.reading&&!H.ended&&(H.length<H.highWaterMark||H.flowing&&H.length===0);){var K=H.length;if(d("maybeReadMore read 0"),ie.read(0),K===H.length)break}H.readingMore=!1}F.prototype._read=function(ie){C(this,new _("_read()"))},F.prototype.pipe=function(ie,H){var K=this,S=this._readableState;switch(S.pipesCount){case 0:S.pipes=ie;break;case 1:S.pipes=[S.pipes,ie];break;default:S.pipes.push(ie);break}S.pipesCount+=1,d("pipe count=%d opts=%j",S.pipesCount,H);var ue=(!H||H.end!==!1)&&ie!==sr.stdout&&ie!==sr.stderr,z=ue?A:Re;S.endEmitted?sr.nextTick(z):K.once("end",z),ie.on("unpipe",T);function T(et,He){d("onunpipe"),et===K&&He&&He.hasUnpiped===!1&&(He.hasUnpiped=!0,_e())}function A(){d("onend"),ie.end()}var W=J(K);ie.on("drain",W);var pe=!1;function _e(){d("cleanup"),ie.removeListener("close",Me),ie.removeListener("finish",Ae),ie.removeListener("drain",W),ie.removeListener("error",Te),ie.removeListener("unpipe",T),K.removeListener("end",A),K.removeListener("end",Re),K.removeListener("data",oe),pe=!0,S.awaitDrain&&(!ie._writableState||ie._writableState.needDrain)&&W()}K.on("data",oe);function oe(et){d("ondata");var He=ie.write(et);d("dest.write",He),He===!1&&((S.pipesCount===1&&S.pipes===ie||S.pipesCount>1&&ne(S.pipes,ie)!==-1)&&!pe&&(d("false write response, pause",S.awaitDrain),S.awaitDrain++),K.pause())}function Te(et){d("onerror",et),Re(),ie.removeListener("error",Te),t(ie,"error")===0&&C(ie,et)}O(ie,"error",Te);function Me(){ie.removeListener("finish",Ae),Re()}ie.once("close",Me);function Ae(){d("onfinish"),ie.removeListener("close",Me),Re()}ie.once("finish",Ae);function Re(){d("unpipe"),K.unpipe(ie)}return ie.emit("pipe",K),S.flowing||(d("pipe resume"),K.resume()),ie};function J(ie){return function(){var K=ie._readableState;d("pipeOnDrain",K.awaitDrain),K.awaitDrain&&K.awaitDrain--,K.awaitDrain===0&&t(ie,"data")&&(K.flowing=!0,ce(ie))}}F.prototype.unpipe=function(ie){var H=this._readableState,K={hasUnpiped:!1};if(H.pipesCount===0)return this;if(H.pipesCount===1)return ie&&ie!==H.pipes?this:(ie||(ie=H.pipes),H.pipes=null,H.pipesCount=0,H.flowing=!1,ie&&ie.emit("unpipe",this,K),this);if(!ie){var S=H.pipes,ue=H.pipesCount;H.pipes=null,H.pipesCount=0,H.flowing=!1;for(var z=0;z<ue;z++)S[z].emit("unpipe",this,{hasUnpiped:!1});return this}var T=ne(H.pipes,ie);return T===-1?this:(H.pipes.splice(T,1),H.pipesCount-=1,H.pipesCount===1&&(H.pipes=H.pipes[0]),ie.emit("unpipe",this,K),this)},F.prototype.on=function(ie,H){var K=r.prototype.on.call(this,ie,H),S=this._readableState;return ie==="data"?(S.readableListening=this.listenerCount("readable")>0,S.flowing!==!1&&this.resume()):ie==="readable"&&!S.endEmitted&&!S.readableListening&&(S.readableListening=S.needReadable=!0,S.flowing=!1,S.emittedReadable=!1,d("on readable",S.length,S.reading),S.length?te(this):S.reading||sr.nextTick(Y,this)),K},F.prototype.addListener=F.prototype.on,F.prototype.removeListener=function(ie,H){var K=r.prototype.removeListener.call(this,ie,H);return ie==="readable"&&sr.nextTick(M,this),K},F.prototype.removeAllListeners=function(ie){var H=r.prototype.removeAllListeners.apply(this,arguments);return(ie==="readable"||ie===void 0)&&sr.nextTick(M,this),H};function M(ie){var H=ie._readableState;H.readableListening=ie.listenerCount("readable")>0,H.resumeScheduled&&!H.paused?H.flowing=!0:ie.listenerCount("data")>0&&ie.resume()}function Y(ie){d("readable nexttick read 0"),ie.read(0)}F.prototype.resume=function(){var ie=this._readableState;return ie.flowing||(d("resume"),ie.flowing=!ie.readableListening,G(this,ie)),ie.paused=!1,this};function G(ie,H){H.resumeScheduled||(H.resumeScheduled=!0,sr.nextTick(re,ie,H))}function re(ie,H){d("resume",H.reading),H.reading||ie.read(0),H.resumeScheduled=!1,ie.emit("resume"),ce(ie),H.flowing&&!H.reading&&ie.read(0)}F.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function ce(ie){var H=ie._readableState;for(d("flow",H.flowing);H.flowing&&ie.read()!==null;);}F.prototype.wrap=function(ie){var H=this,K=this._readableState,S=!1;ie.on("end",function(){if(d("wrapped end"),K.decoder&&!K.ended){var T=K.decoder.end();T&&T.length&&H.push(T)}H.push(null)}),ie.on("data",function(T){if(d("wrapped data"),K.decoder&&(T=K.decoder.write(T)),!(K.objectMode&&T==null)&&!(!K.objectMode&&(!T||!T.length))){var A=H.push(T);A||(S=!0,ie.pause())}});for(var ue in ie)this[ue]===void 0&&typeof ie[ue]=="function"&&(this[ue]=(function(A){return function(){return ie[A].apply(ie,arguments)}})(ue));for(var z=0;z<L.length;z++)ie.on(L[z],this.emit.bind(this,L[z]));return this._read=function(T){d("wrapped _read",T),S&&(S=!1,ie.resume())},this},typeof Symbol=="function"&&(F.prototype[Symbol.asyncIterator]=function(){return N===void 0&&(N=vL()),N(this)}),Object.defineProperty(F.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(F.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(F.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(H){this._readableState&&(this._readableState.flowing=H)}}),F._fromList=P,Object.defineProperty(F.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function P(ie,H){if(H.length===0)return null;var K;return H.objectMode?K=H.buffer.shift():!ie||ie>=H.length?(H.decoder?K=H.buffer.join(""):H.buffer.length===1?K=H.buffer.first():K=H.buffer.concat(H.length),H.buffer.clear()):K=H.buffer.consume(ie,H.decoder),K}function U(ie){var H=ie._readableState;d("endReadable",H.endEmitted),H.endEmitted||(H.ended=!0,sr.nextTick(le,H,ie))}function le(ie,H){if(d("endReadableNT",ie.endEmitted,ie.length),!ie.endEmitted&&ie.length===0&&(ie.endEmitted=!0,H.readable=!1,H.emit("end"),ie.autoDestroy)){var K=H._writableState;(!K||K.autoDestroy&&K.finished)&&H.destroy()}}typeof Symbol=="function"&&(F.from=function(ie,H){return E===void 0&&(E=bL()),E(F,ie,H)});function ne(ie,H){for(var K=0,S=ie.length;K<S;K++)if(ie[K]===H)return K;return-1}return x1}var g1,E4;function uj(){if(E4)return g1;E4=1,g1=u;var e=su().codes,t=e.ERR_METHOD_NOT_IMPLEMENTED,r=e.ERR_MULTIPLE_CALLBACK,s=e.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=e.ERR_TRANSFORM_WITH_LENGTH_0,o=Hc();yo()(u,o);function l(m,x){var y=this._transformState;y.transforming=!1;var v=y.writecb;if(v===null)return this.emit("error",new r);y.writechunk=null,y.writecb=null,x!=null&&this.push(x),v(m);var b=this._readableState;b.reading=!1,(b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}function u(m){if(!(this instanceof u))return new u(m);o.call(this,m),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,m&&(typeof m.transform=="function"&&(this._transform=m.transform),typeof m.flush=="function"&&(this._flush=m.flush)),this.on("prefinish",d)}function d(){var m=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(x,y){h(m,x,y)}):h(this,null,null)}u.prototype.push=function(m,x){return this._transformState.needTransform=!1,o.prototype.push.call(this,m,x)},u.prototype._transform=function(m,x,y){y(new t("_transform()"))},u.prototype._write=function(m,x,y){var v=this._transformState;if(v.writecb=y,v.writechunk=m,v.writeencoding=x,!v.transforming){var b=this._readableState;(v.needTransform||b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}},u.prototype._read=function(m){var x=this._transformState;x.writechunk!==null&&!x.transforming?(x.transforming=!0,this._transform(x.writechunk,x.writeencoding,x.afterTransform)):x.needTransform=!0},u.prototype._destroy=function(m,x){o.prototype._destroy.call(this,m,function(y){x(y)})};function h(m,x,y){if(x)return m.emit("error",x);if(y!=null&&m.push(y),m._writableState.length)throw new a;if(m._transformState.transforming)throw new s;return m.push(null)}return g1}var y1,j4;function wL(){if(j4)return y1;j4=1,y1=t;var e=uj();yo()(t,e);function t(r){if(!(this instanceof t))return new t(r);e.call(this,r)}return t.prototype._transform=function(r,s,a){a(null,r)},y1}var v1,T4;function _L(){if(T4)return v1;T4=1;var e;function t(y){var v=!1;return function(){v||(v=!0,y.apply(void 0,arguments))}}var r=su().codes,s=r.ERR_MISSING_ARGS,a=r.ERR_STREAM_DESTROYED;function o(y){if(y)throw y}function l(y){return y.setHeader&&typeof y.abort=="function"}function u(y,v,b,g){g=t(g);var _=!1;y.on("close",function(){_=!0}),e===void 0&&(e=yv()),e(y,{readable:v,writable:b},function(k){if(k)return g(k);_=!0,g()});var w=!1;return function(k){if(!_&&!w){if(w=!0,l(y))return y.abort();if(typeof y.destroy=="function")return y.destroy();g(k||new a("pipe"))}}}function d(y){y()}function h(y,v){return y.pipe(v)}function m(y){return!y.length||typeof y[y.length-1]!="function"?o:y.pop()}function x(){for(var y=arguments.length,v=new Array(y),b=0;b<y;b++)v[b]=arguments[b];var g=m(v);if(Array.isArray(v[0])&&(v=v[0]),v.length<2)throw new s("streams");var _,w=v.map(function(k,N){var E=N<v.length-1,C=N>0;return u(k,E,C,function(L){_||(_=L),L&&w.forEach(d),!E&&(w.forEach(d),g(_))})});return v.reduce(h)}return v1=x,v1}var b1,A4;function vv(){if(A4)return b1;A4=1,b1=r;var e=mv().EventEmitter,t=yo();t(r,e),r.Readable=cj(),r.Writable=lj(),r.Duplex=Hc(),r.Transform=uj(),r.PassThrough=wL(),r.finished=yv(),r.pipeline=_L(),r.Stream=r;function r(){e.call(this)}return r.prototype.pipe=function(s,a){var o=this;function l(v){s.writable&&s.write(v)===!1&&o.pause&&o.pause()}o.on("data",l);function u(){o.readable&&o.resume&&o.resume()}s.on("drain",u),!s._isStdio&&(!a||a.end!==!1)&&(o.on("end",h),o.on("close",m));var d=!1;function h(){d||(d=!0,s.end())}function m(){d||(d=!0,typeof s.destroy=="function"&&s.destroy())}function x(v){if(y(),e.listenerCount(this,"error")===0)throw v}o.on("error",x),s.on("error",x);function y(){o.removeListener("data",l),s.removeListener("drain",u),o.removeListener("end",h),o.removeListener("close",m),o.removeListener("error",x),s.removeListener("error",x),o.removeListener("end",y),o.removeListener("close",y),s.removeListener("close",y)}return o.on("end",y),o.on("close",y),s.on("close",y),s.emit("pipe",o),s},b1}var C4;function NL(){return C4||(C4=1,(function(e){(function(t){t.parser=function(P,U){return new s(P,U)},t.SAXParser=s,t.SAXStream=m,t.createStream=h,t.MAX_BUFFER_LENGTH=64*1024;var r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function s(P,U){if(!(this instanceof s))return new s(P,U);var le=this;o(le),le.q=le.c="",le.bufferCheckPosition=t.MAX_BUFFER_LENGTH,le.opt=U||{},le.opt.lowercase=le.opt.lowercase||le.opt.lowercasetags,le.looseCase=le.opt.lowercase?"toLowerCase":"toUpperCase",le.tags=[],le.closed=le.closedRoot=le.sawRoot=!1,le.tag=le.error=null,le.strict=!!P,le.noscript=!!(P||le.opt.noscript),le.state=F.BEGIN,le.strictEntities=le.opt.strictEntities,le.ENTITIES=le.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),le.attribList=[],le.opt.xmlns&&(le.ns=Object.create(g)),le.trackPosition=le.opt.position!==!1,le.trackPosition&&(le.position=le.line=le.column=0),fe(le,"onready")}Object.create||(Object.create=function(P){function U(){}U.prototype=P;var le=new U;return le}),Object.keys||(Object.keys=function(P){var U=[];for(var le in P)P.hasOwnProperty(le)&&U.push(le);return U});function a(P){for(var U=Math.max(t.MAX_BUFFER_LENGTH,10),le=0,ne=0,ie=r.length;ne<ie;ne++){var H=P[r[ne]].length;if(H>U)switch(r[ne]){case"textNode":V(P);break;case"cdata":D(P,"oncdata",P.cdata),P.cdata="";break;case"script":D(P,"onscript",P.script),P.script="";break;default:ae(P,"Max buffer length exceeded: "+r[ne])}le=Math.max(le,H)}var K=t.MAX_BUFFER_LENGTH-le;P.bufferCheckPosition=K+P.position}function o(P){for(var U=0,le=r.length;U<le;U++)P[r[U]]=""}function l(P){V(P),P.cdata!==""&&(D(P,"oncdata",P.cdata),P.cdata=""),P.script!==""&&(D(P,"onscript",P.script),P.script="")}s.prototype={end:function(){Q(this)},write:ce,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){l(this)}};var u;try{u=vv().Stream}catch{u=function(){}}var d=t.EVENTS.filter(function(P){return P!=="error"&&P!=="end"});function h(P,U){return new m(P,U)}function m(P,U){if(!(this instanceof m))return new m(P,U);u.apply(this),this._parser=new s(P,U),this.writable=!0,this.readable=!0;var le=this;this._parser.onend=function(){le.emit("end")},this._parser.onerror=function(ne){le.emit("error",ne),le._parser.error=null},this._decoder=null,d.forEach(function(ne){Object.defineProperty(le,"on"+ne,{get:function(){return le._parser["on"+ne]},set:function(ie){if(!ie)return le.removeAllListeners(ne),le._parser["on"+ne]=ie,ie;le.on(ne,ie)},enumerable:!0,configurable:!1})})}m.prototype=Object.create(u.prototype,{constructor:{value:m}}),m.prototype.write=function(P){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(P)){if(!this._decoder){var U=Oy().StringDecoder;this._decoder=new U("utf8")}P=this._decoder.write(P)}return this._parser.write(P.toString()),this.emit("data",P),!0},m.prototype.end=function(P){return P&&P.length&&this.write(P),this._parser.end(),!0},m.prototype.on=function(P,U){var le=this;return!le._parser["on"+P]&&d.indexOf(P)!==-1&&(le._parser["on"+P]=function(){var ne=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);ne.splice(0,0,P),le.emit.apply(le,ne)}),u.prototype.on.call(le,P,U)};var x="[CDATA[",y="DOCTYPE",v="http://www.w3.org/XML/1998/namespace",b="http://www.w3.org/2000/xmlns/",g={xml:v,xmlns:b},_=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,w=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,k=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,N=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function E(P){return P===" "||P===`
`||P==="\r"||P==="	"}function C(P){return P==='"'||P==="'"}function L(P){return P===">"||E(P)}function O(P,U){return P.test(U)}function B(P,U){return!O(P,U)}var F=0;t.STATE={BEGIN:F++,BEGIN_WHITESPACE:F++,TEXT:F++,TEXT_ENTITY:F++,OPEN_WAKA:F++,SGML_DECL:F++,SGML_DECL_QUOTED:F++,DOCTYPE:F++,DOCTYPE_QUOTED:F++,DOCTYPE_DTD:F++,DOCTYPE_DTD_QUOTED:F++,COMMENT_STARTING:F++,COMMENT:F++,COMMENT_ENDING:F++,COMMENT_ENDED:F++,CDATA:F++,CDATA_ENDING:F++,CDATA_ENDING_2:F++,PROC_INST:F++,PROC_INST_BODY:F++,PROC_INST_ENDING:F++,OPEN_TAG:F++,OPEN_TAG_SLASH:F++,ATTRIB:F++,ATTRIB_NAME:F++,ATTRIB_NAME_SAW_WHITE:F++,ATTRIB_VALUE:F++,ATTRIB_VALUE_QUOTED:F++,ATTRIB_VALUE_CLOSED:F++,ATTRIB_VALUE_UNQUOTED:F++,ATTRIB_VALUE_ENTITY_Q:F++,ATTRIB_VALUE_ENTITY_U:F++,CLOSE_TAG:F++,CLOSE_TAG_SAW_WHITE:F++,SCRIPT:F++,SCRIPT_ENDING:F++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(P){var U=t.ENTITIES[P],le=typeof U=="number"?String.fromCharCode(U):U;t.ENTITIES[P]=le});for(var q in t.STATE)t.STATE[t.STATE[q]]=q;F=t.STATE;function fe(P,U,le){P[U]&&P[U](le)}function D(P,U,le){P.textNode&&V(P),fe(P,U,le)}function V(P){P.textNode=I(P.opt,P.textNode),P.textNode&&fe(P,"ontext",P.textNode),P.textNode=""}function I(P,U){return P.trim&&(U=U.trim()),P.normalize&&(U=U.replace(/\s+/g," ")),U}function ae(P,U){return V(P),P.trackPosition&&(U+=`
Line: `+P.line+`
Column: `+P.column+`
Char: `+P.c),U=new Error(U),P.error=U,fe(P,"onerror",U),P}function Q(P){return P.sawRoot&&!P.closedRoot&&te(P,"Unclosed root tag"),P.state!==F.BEGIN&&P.state!==F.BEGIN_WHITESPACE&&P.state!==F.TEXT&&ae(P,"Unexpected end"),V(P),P.c="",P.closed=!0,fe(P,"onend"),s.call(P,P.strict,P.opt),P}function te(P,U){if(typeof P!="object"||!(P instanceof s))throw new Error("bad call to strictFail");P.strict&&ae(P,U)}function ve(P){P.strict||(P.tagName=P.tagName[P.looseCase]());var U=P.tags[P.tags.length-1]||P,le=P.tag={name:P.tagName,attributes:{}};P.opt.xmlns&&(le.ns=U.ns),P.attribList.length=0,D(P,"onopentagstart",le)}function ee(P,U){var le=P.indexOf(":"),ne=le<0?["",P]:P.split(":"),ie=ne[0],H=ne[1];return U&&P==="xmlns"&&(ie="xmlns",H=""),{prefix:ie,local:H}}function Se(P){if(P.strict||(P.attribName=P.attribName[P.looseCase]()),P.attribList.indexOf(P.attribName)!==-1||P.tag.attributes.hasOwnProperty(P.attribName)){P.attribName=P.attribValue="";return}if(P.opt.xmlns){var U=ee(P.attribName,!0),le=U.prefix,ne=U.local;if(le==="xmlns")if(ne==="xml"&&P.attribValue!==v)te(P,"xml: prefix must be bound to "+v+`
Actual: `+P.attribValue);else if(ne==="xmlns"&&P.attribValue!==b)te(P,"xmlns: prefix must be bound to "+b+`
Actual: `+P.attribValue);else{var ie=P.tag,H=P.tags[P.tags.length-1]||P;ie.ns===H.ns&&(ie.ns=Object.create(H.ns)),ie.ns[ne]=P.attribValue}P.attribList.push([P.attribName,P.attribValue])}else P.tag.attributes[P.attribName]=P.attribValue,D(P,"onattribute",{name:P.attribName,value:P.attribValue});P.attribName=P.attribValue=""}function J(P,U){if(P.opt.xmlns){var le=P.tag,ne=ee(P.tagName);le.prefix=ne.prefix,le.local=ne.local,le.uri=le.ns[ne.prefix]||"",le.prefix&&!le.uri&&(te(P,"Unbound namespace prefix: "+JSON.stringify(P.tagName)),le.uri=ne.prefix);var ie=P.tags[P.tags.length-1]||P;le.ns&&ie.ns!==le.ns&&Object.keys(le.ns).forEach(function(oe){D(P,"onopennamespace",{prefix:oe,uri:le.ns[oe]})});for(var H=0,K=P.attribList.length;H<K;H++){var S=P.attribList[H],ue=S[0],z=S[1],T=ee(ue,!0),A=T.prefix,W=T.local,pe=A===""?"":le.ns[A]||"",_e={name:ue,value:z,prefix:A,local:W,uri:pe};A&&A!=="xmlns"&&!pe&&(te(P,"Unbound namespace prefix: "+JSON.stringify(A)),_e.uri=A),P.tag.attributes[ue]=_e,D(P,"onattribute",_e)}P.attribList.length=0}P.tag.isSelfClosing=!!U,P.sawRoot=!0,P.tags.push(P.tag),D(P,"onopentag",P.tag),U||(!P.noscript&&P.tagName.toLowerCase()==="script"?P.state=F.SCRIPT:P.state=F.TEXT,P.tag=null,P.tagName=""),P.attribName=P.attribValue="",P.attribList.length=0}function M(P){if(!P.tagName){te(P,"Weird empty close tag."),P.textNode+="</>",P.state=F.TEXT;return}if(P.script){if(P.tagName!=="script"){P.script+="</"+P.tagName+">",P.tagName="",P.state=F.SCRIPT;return}D(P,"onscript",P.script),P.script=""}var U=P.tags.length,le=P.tagName;P.strict||(le=le[P.looseCase]());for(var ne=le;U--;){var ie=P.tags[U];if(ie.name!==ne)te(P,"Unexpected close tag");else break}if(U<0){te(P,"Unmatched closing tag: "+P.tagName),P.textNode+="</"+P.tagName+">",P.state=F.TEXT;return}P.tagName=le;for(var H=P.tags.length;H-- >U;){var K=P.tag=P.tags.pop();P.tagName=P.tag.name,D(P,"onclosetag",P.tagName);var S={};for(var ue in K.ns)S[ue]=K.ns[ue];var z=P.tags[P.tags.length-1]||P;P.opt.xmlns&&K.ns!==z.ns&&Object.keys(K.ns).forEach(function(T){var A=K.ns[T];D(P,"onclosenamespace",{prefix:T,uri:A})})}U===0&&(P.closedRoot=!0),P.tagName=P.attribValue=P.attribName="",P.attribList.length=0,P.state=F.TEXT}function Y(P){var U=P.entity,le=U.toLowerCase(),ne,ie="";return P.ENTITIES[U]?P.ENTITIES[U]:P.ENTITIES[le]?P.ENTITIES[le]:(U=le,U.charAt(0)==="#"&&(U.charAt(1)==="x"?(U=U.slice(2),ne=parseInt(U,16),ie=ne.toString(16)):(U=U.slice(1),ne=parseInt(U,10),ie=ne.toString(10))),U=U.replace(/^0+/,""),isNaN(ne)||ie.toLowerCase()!==U?(te(P,"Invalid character entity"),"&"+P.entity+";"):String.fromCodePoint(ne))}function G(P,U){U==="<"?(P.state=F.OPEN_WAKA,P.startTagPosition=P.position):E(U)||(te(P,"Non-whitespace before first tag."),P.textNode=U,P.state=F.TEXT)}function re(P,U){var le="";return U<P.length&&(le=P.charAt(U)),le}function ce(P){var U=this;if(this.error)throw this.error;if(U.closed)return ae(U,"Cannot write after close. Assign an onready handler.");if(P===null)return Q(U);typeof P=="object"&&(P=P.toString());for(var le=0,ne="";ne=re(P,le++),U.c=ne,!!ne;)switch(U.trackPosition&&(U.position++,ne===`
`?(U.line++,U.column=0):U.column++),U.state){case F.BEGIN:if(U.state=F.BEGIN_WHITESPACE,ne==="\uFEFF")continue;G(U,ne);continue;case F.BEGIN_WHITESPACE:G(U,ne);continue;case F.TEXT:if(U.sawRoot&&!U.closedRoot){for(var ie=le-1;ne&&ne!=="<"&&ne!=="&";)ne=re(P,le++),ne&&U.trackPosition&&(U.position++,ne===`
`?(U.line++,U.column=0):U.column++);U.textNode+=P.substring(ie,le-1)}ne==="<"&&!(U.sawRoot&&U.closedRoot&&!U.strict)?(U.state=F.OPEN_WAKA,U.startTagPosition=U.position):(!E(ne)&&(!U.sawRoot||U.closedRoot)&&te(U,"Text data outside of root node."),ne==="&"?U.state=F.TEXT_ENTITY:U.textNode+=ne);continue;case F.SCRIPT:ne==="<"?U.state=F.SCRIPT_ENDING:U.script+=ne;continue;case F.SCRIPT_ENDING:ne==="/"?U.state=F.CLOSE_TAG:(U.script+="<"+ne,U.state=F.SCRIPT);continue;case F.OPEN_WAKA:if(ne==="!")U.state=F.SGML_DECL,U.sgmlDecl="";else if(!E(ne))if(O(_,ne))U.state=F.OPEN_TAG,U.tagName=ne;else if(ne==="/")U.state=F.CLOSE_TAG,U.tagName="";else if(ne==="?")U.state=F.PROC_INST,U.procInstName=U.procInstBody="";else{if(te(U,"Unencoded <"),U.startTagPosition+1<U.position){var H=U.position-U.startTagPosition;ne=new Array(H).join(" ")+ne}U.textNode+="<"+ne,U.state=F.TEXT}continue;case F.SGML_DECL:(U.sgmlDecl+ne).toUpperCase()===x?(D(U,"onopencdata"),U.state=F.CDATA,U.sgmlDecl="",U.cdata=""):U.sgmlDecl+ne==="--"?(U.state=F.COMMENT,U.comment="",U.sgmlDecl=""):(U.sgmlDecl+ne).toUpperCase()===y?(U.state=F.DOCTYPE,(U.doctype||U.sawRoot)&&te(U,"Inappropriately located doctype declaration"),U.doctype="",U.sgmlDecl=""):ne===">"?(D(U,"onsgmldeclaration",U.sgmlDecl),U.sgmlDecl="",U.state=F.TEXT):(C(ne)&&(U.state=F.SGML_DECL_QUOTED),U.sgmlDecl+=ne);continue;case F.SGML_DECL_QUOTED:ne===U.q&&(U.state=F.SGML_DECL,U.q=""),U.sgmlDecl+=ne;continue;case F.DOCTYPE:ne===">"?(U.state=F.TEXT,D(U,"ondoctype",U.doctype),U.doctype=!0):(U.doctype+=ne,ne==="["?U.state=F.DOCTYPE_DTD:C(ne)&&(U.state=F.DOCTYPE_QUOTED,U.q=ne));continue;case F.DOCTYPE_QUOTED:U.doctype+=ne,ne===U.q&&(U.q="",U.state=F.DOCTYPE);continue;case F.DOCTYPE_DTD:U.doctype+=ne,ne==="]"?U.state=F.DOCTYPE:C(ne)&&(U.state=F.DOCTYPE_DTD_QUOTED,U.q=ne);continue;case F.DOCTYPE_DTD_QUOTED:U.doctype+=ne,ne===U.q&&(U.state=F.DOCTYPE_DTD,U.q="");continue;case F.COMMENT:ne==="-"?U.state=F.COMMENT_ENDING:U.comment+=ne;continue;case F.COMMENT_ENDING:ne==="-"?(U.state=F.COMMENT_ENDED,U.comment=I(U.opt,U.comment),U.comment&&D(U,"oncomment",U.comment),U.comment=""):(U.comment+="-"+ne,U.state=F.COMMENT);continue;case F.COMMENT_ENDED:ne!==">"?(te(U,"Malformed comment"),U.comment+="--"+ne,U.state=F.COMMENT):U.state=F.TEXT;continue;case F.CDATA:ne==="]"?U.state=F.CDATA_ENDING:U.cdata+=ne;continue;case F.CDATA_ENDING:ne==="]"?U.state=F.CDATA_ENDING_2:(U.cdata+="]"+ne,U.state=F.CDATA);continue;case F.CDATA_ENDING_2:ne===">"?(U.cdata&&D(U,"oncdata",U.cdata),D(U,"onclosecdata"),U.cdata="",U.state=F.TEXT):ne==="]"?U.cdata+="]":(U.cdata+="]]"+ne,U.state=F.CDATA);continue;case F.PROC_INST:ne==="?"?U.state=F.PROC_INST_ENDING:E(ne)?U.state=F.PROC_INST_BODY:U.procInstName+=ne;continue;case F.PROC_INST_BODY:if(!U.procInstBody&&E(ne))continue;ne==="?"?U.state=F.PROC_INST_ENDING:U.procInstBody+=ne;continue;case F.PROC_INST_ENDING:ne===">"?(D(U,"onprocessinginstruction",{name:U.procInstName,body:U.procInstBody}),U.procInstName=U.procInstBody="",U.state=F.TEXT):(U.procInstBody+="?"+ne,U.state=F.PROC_INST_BODY);continue;case F.OPEN_TAG:O(w,ne)?U.tagName+=ne:(ve(U),ne===">"?J(U):ne==="/"?U.state=F.OPEN_TAG_SLASH:(E(ne)||te(U,"Invalid character in tag name"),U.state=F.ATTRIB));continue;case F.OPEN_TAG_SLASH:ne===">"?(J(U,!0),M(U)):(te(U,"Forward-slash in opening tag not followed by >"),U.state=F.ATTRIB);continue;case F.ATTRIB:if(E(ne))continue;ne===">"?J(U):ne==="/"?U.state=F.OPEN_TAG_SLASH:O(_,ne)?(U.attribName=ne,U.attribValue="",U.state=F.ATTRIB_NAME):te(U,"Invalid attribute name");continue;case F.ATTRIB_NAME:ne==="="?U.state=F.ATTRIB_VALUE:ne===">"?(te(U,"Attribute without value"),U.attribValue=U.attribName,Se(U),J(U)):E(ne)?U.state=F.ATTRIB_NAME_SAW_WHITE:O(w,ne)?U.attribName+=ne:te(U,"Invalid attribute name");continue;case F.ATTRIB_NAME_SAW_WHITE:if(ne==="=")U.state=F.ATTRIB_VALUE;else{if(E(ne))continue;te(U,"Attribute without value"),U.tag.attributes[U.attribName]="",U.attribValue="",D(U,"onattribute",{name:U.attribName,value:""}),U.attribName="",ne===">"?J(U):O(_,ne)?(U.attribName=ne,U.state=F.ATTRIB_NAME):(te(U,"Invalid attribute name"),U.state=F.ATTRIB)}continue;case F.ATTRIB_VALUE:if(E(ne))continue;C(ne)?(U.q=ne,U.state=F.ATTRIB_VALUE_QUOTED):(te(U,"Unquoted attribute value"),U.state=F.ATTRIB_VALUE_UNQUOTED,U.attribValue=ne);continue;case F.ATTRIB_VALUE_QUOTED:if(ne!==U.q){ne==="&"?U.state=F.ATTRIB_VALUE_ENTITY_Q:U.attribValue+=ne;continue}Se(U),U.q="",U.state=F.ATTRIB_VALUE_CLOSED;continue;case F.ATTRIB_VALUE_CLOSED:E(ne)?U.state=F.ATTRIB:ne===">"?J(U):ne==="/"?U.state=F.OPEN_TAG_SLASH:O(_,ne)?(te(U,"No whitespace between attributes"),U.attribName=ne,U.attribValue="",U.state=F.ATTRIB_NAME):te(U,"Invalid attribute name");continue;case F.ATTRIB_VALUE_UNQUOTED:if(!L(ne)){ne==="&"?U.state=F.ATTRIB_VALUE_ENTITY_U:U.attribValue+=ne;continue}Se(U),ne===">"?J(U):U.state=F.ATTRIB;continue;case F.CLOSE_TAG:if(U.tagName)ne===">"?M(U):O(w,ne)?U.tagName+=ne:U.script?(U.script+="</"+U.tagName,U.tagName="",U.state=F.SCRIPT):(E(ne)||te(U,"Invalid tagname in closing tag"),U.state=F.CLOSE_TAG_SAW_WHITE);else{if(E(ne))continue;B(_,ne)?U.script?(U.script+="</"+ne,U.state=F.SCRIPT):te(U,"Invalid tagname in closing tag."):U.tagName=ne}continue;case F.CLOSE_TAG_SAW_WHITE:if(E(ne))continue;ne===">"?M(U):te(U,"Invalid characters in closing tag");continue;case F.TEXT_ENTITY:case F.ATTRIB_VALUE_ENTITY_Q:case F.ATTRIB_VALUE_ENTITY_U:var K,S;switch(U.state){case F.TEXT_ENTITY:K=F.TEXT,S="textNode";break;case F.ATTRIB_VALUE_ENTITY_Q:K=F.ATTRIB_VALUE_QUOTED,S="attribValue";break;case F.ATTRIB_VALUE_ENTITY_U:K=F.ATTRIB_VALUE_UNQUOTED,S="attribValue";break}ne===";"?(U[S]+=Y(U),U.entity="",U.state=K):O(U.entity.length?N:k,ne)?U.entity+=ne:(te(U,"Invalid character in entity name"),U[S]+="&"+U.entity+ne,U.entity="",U.state=K);continue;default:throw new Error(U,"Unknown state: "+U.state)}return U.position>=U.bufferCheckPosition&&a(U),U}String.fromCodePoint||(function(){var P=String.fromCharCode,U=Math.floor,le=function(){var ne=16384,ie=[],H,K,S=-1,ue=arguments.length;if(!ue)return"";for(var z="";++S<ue;){var T=Number(arguments[S]);if(!isFinite(T)||T<0||T>1114111||U(T)!==T)throw RangeError("Invalid code point: "+T);T<=65535?ie.push(T):(T-=65536,H=(T>>10)+55296,K=T%1024+56320,ie.push(H,K)),(S+1===ue||ie.length>ne)&&(z+=P.apply(null,ie),ie.length=0)}return z};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:le,configurable:!0,writable:!0}):String.fromCodePoint=le})()})(e)})(ng)),ng}var w1,R4;function bv(){return R4||(R4=1,w1={isArray:function(e){return Array.isArray?Array.isArray(e):Object.prototype.toString.call(e)==="[object Array]"}}),w1}var _1,D4;function wv(){if(D4)return _1;D4=1;var e=bv().isArray;return _1={copyOptions:function(t){var r,s={};for(r in t)t.hasOwnProperty(r)&&(s[r]=t[r]);return s},ensureFlagExists:function(t,r){(!(t in r)||typeof r[t]!="boolean")&&(r[t]=!1)},ensureSpacesExists:function(t){(!("spaces"in t)||typeof t.spaces!="number"&&typeof t.spaces!="string")&&(t.spaces=0)},ensureAlwaysArrayExists:function(t){(!("alwaysArray"in t)||typeof t.alwaysArray!="boolean"&&!e(t.alwaysArray))&&(t.alwaysArray=!1)},ensureKeyExists:function(t,r){(!(t+"Key"in r)||typeof r[t+"Key"]!="string")&&(r[t+"Key"]=r.compact?"_"+t:t)},checkFnExists:function(t,r){return t+"Fn"in r}},_1}var N1,O4;function dj(){if(O4)return N1;O4=1;var e=NL(),t=wv(),r=bv().isArray,s,a;function o(w){return s=t.copyOptions(w),t.ensureFlagExists("ignoreDeclaration",s),t.ensureFlagExists("ignoreInstruction",s),t.ensureFlagExists("ignoreAttributes",s),t.ensureFlagExists("ignoreText",s),t.ensureFlagExists("ignoreComment",s),t.ensureFlagExists("ignoreCdata",s),t.ensureFlagExists("ignoreDoctype",s),t.ensureFlagExists("compact",s),t.ensureFlagExists("alwaysChildren",s),t.ensureFlagExists("addParent",s),t.ensureFlagExists("trim",s),t.ensureFlagExists("nativeType",s),t.ensureFlagExists("nativeTypeAttributes",s),t.ensureFlagExists("sanitize",s),t.ensureFlagExists("instructionHasAttributes",s),t.ensureFlagExists("captureSpacesBetweenElements",s),t.ensureAlwaysArrayExists(s),t.ensureKeyExists("declaration",s),t.ensureKeyExists("instruction",s),t.ensureKeyExists("attributes",s),t.ensureKeyExists("text",s),t.ensureKeyExists("comment",s),t.ensureKeyExists("cdata",s),t.ensureKeyExists("doctype",s),t.ensureKeyExists("type",s),t.ensureKeyExists("name",s),t.ensureKeyExists("elements",s),t.ensureKeyExists("parent",s),t.checkFnExists("doctype",s),t.checkFnExists("instruction",s),t.checkFnExists("cdata",s),t.checkFnExists("comment",s),t.checkFnExists("text",s),t.checkFnExists("instructionName",s),t.checkFnExists("elementName",s),t.checkFnExists("attributeName",s),t.checkFnExists("attributeValue",s),t.checkFnExists("attributes",s),s}function l(w){var k=Number(w);if(!isNaN(k))return k;var N=w.toLowerCase();return N==="true"?!0:N==="false"?!1:w}function u(w,k){var N;if(s.compact){if(!a[s[w+"Key"]]&&(r(s.alwaysArray)?s.alwaysArray.indexOf(s[w+"Key"])!==-1:s.alwaysArray)&&(a[s[w+"Key"]]=[]),a[s[w+"Key"]]&&!r(a[s[w+"Key"]])&&(a[s[w+"Key"]]=[a[s[w+"Key"]]]),w+"Fn"in s&&typeof k=="string"&&(k=s[w+"Fn"](k,a)),w==="instruction"&&("instructionFn"in s||"instructionNameFn"in s)){for(N in k)if(k.hasOwnProperty(N))if("instructionFn"in s)k[N]=s.instructionFn(k[N],N,a);else{var E=k[N];delete k[N],k[s.instructionNameFn(N,E,a)]=E}}r(a[s[w+"Key"]])?a[s[w+"Key"]].push(k):a[s[w+"Key"]]=k}else{a[s.elementsKey]||(a[s.elementsKey]=[]);var C={};if(C[s.typeKey]=w,w==="instruction"){for(N in k)if(k.hasOwnProperty(N))break;C[s.nameKey]="instructionNameFn"in s?s.instructionNameFn(N,k,a):N,s.instructionHasAttributes?(C[s.attributesKey]=k[N][s.attributesKey],"instructionFn"in s&&(C[s.attributesKey]=s.instructionFn(C[s.attributesKey],N,a))):("instructionFn"in s&&(k[N]=s.instructionFn(k[N],N,a)),C[s.instructionKey]=k[N])}else w+"Fn"in s&&(k=s[w+"Fn"](k,a)),C[s[w+"Key"]]=k;s.addParent&&(C[s.parentKey]=a),a[s.elementsKey].push(C)}}function d(w){if("attributesFn"in s&&w&&(w=s.attributesFn(w,a)),(s.trim||"attributeValueFn"in s||"attributeNameFn"in s||s.nativeTypeAttributes)&&w){var k;for(k in w)if(w.hasOwnProperty(k)&&(s.trim&&(w[k]=w[k].trim()),s.nativeTypeAttributes&&(w[k]=l(w[k])),"attributeValueFn"in s&&(w[k]=s.attributeValueFn(w[k],k,a)),"attributeNameFn"in s)){var N=w[k];delete w[k],w[s.attributeNameFn(k,w[k],a)]=N}}return w}function h(w){var k={};if(w.body&&(w.name.toLowerCase()==="xml"||s.instructionHasAttributes)){for(var N=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,E;(E=N.exec(w.body))!==null;)k[E[1]]=E[2]||E[3]||E[4];k=d(k)}if(w.name.toLowerCase()==="xml"){if(s.ignoreDeclaration)return;a[s.declarationKey]={},Object.keys(k).length&&(a[s.declarationKey][s.attributesKey]=k),s.addParent&&(a[s.declarationKey][s.parentKey]=a)}else{if(s.ignoreInstruction)return;s.trim&&(w.body=w.body.trim());var C={};s.instructionHasAttributes&&Object.keys(k).length?(C[w.name]={},C[w.name][s.attributesKey]=k):C[w.name]=w.body,u("instruction",C)}}function m(w,k){var N;if(typeof w=="object"&&(k=w.attributes,w=w.name),k=d(k),"elementNameFn"in s&&(w=s.elementNameFn(w,a)),s.compact){if(N={},!s.ignoreAttributes&&k&&Object.keys(k).length){N[s.attributesKey]={};var E;for(E in k)k.hasOwnProperty(E)&&(N[s.attributesKey][E]=k[E])}!(w in a)&&(r(s.alwaysArray)?s.alwaysArray.indexOf(w)!==-1:s.alwaysArray)&&(a[w]=[]),a[w]&&!r(a[w])&&(a[w]=[a[w]]),r(a[w])?a[w].push(N):a[w]=N}else a[s.elementsKey]||(a[s.elementsKey]=[]),N={},N[s.typeKey]="element",N[s.nameKey]=w,!s.ignoreAttributes&&k&&Object.keys(k).length&&(N[s.attributesKey]=k),s.alwaysChildren&&(N[s.elementsKey]=[]),a[s.elementsKey].push(N);N[s.parentKey]=a,a=N}function x(w){s.ignoreText||!w.trim()&&!s.captureSpacesBetweenElements||(s.trim&&(w=w.trim()),s.nativeType&&(w=l(w)),s.sanitize&&(w=w.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),u("text",w))}function y(w){s.ignoreComment||(s.trim&&(w=w.trim()),u("comment",w))}function v(w){var k=a[s.parentKey];s.addParent||delete a[s.parentKey],a=k}function b(w){s.ignoreCdata||(s.trim&&(w=w.trim()),u("cdata",w))}function g(w){s.ignoreDoctype||(w=w.replace(/^ /,""),s.trim&&(w=w.trim()),u("doctype",w))}function _(w){w.note=w}return N1=function(w,k){var N=e.parser(!0,{}),E={};if(a=E,s=o(k),N.opt={strictEntities:!0},N.onopentag=m,N.ontext=x,N.oncomment=y,N.onclosetag=v,N.onerror=_,N.oncdata=b,N.ondoctype=g,N.onprocessinginstruction=h,N.write(w).close(),E[s.elementsKey]){var C=E[s.elementsKey];delete E[s.elementsKey],E[s.elementsKey]=C,delete E.text}return E},N1}var S1,F4;function SL(){if(F4)return S1;F4=1;var e=wv(),t=dj();function r(s){var a=e.copyOptions(s);return e.ensureSpacesExists(a),a}return S1=function(s,a){var o,l,u,d;return o=r(a),l=t(s,o),d="compact"in o&&o.compact?"_parent":"parent","addParent"in o&&o.addParent?u=JSON.stringify(l,function(h,m){return h===d?"_":m},o.spaces):u=JSON.stringify(l,null,o.spaces),u.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},S1}var k1,L4;function fj(){if(L4)return k1;L4=1;var e=wv(),t=bv().isArray,r,s;function a(N){var E=e.copyOptions(N);return e.ensureFlagExists("ignoreDeclaration",E),e.ensureFlagExists("ignoreInstruction",E),e.ensureFlagExists("ignoreAttributes",E),e.ensureFlagExists("ignoreText",E),e.ensureFlagExists("ignoreComment",E),e.ensureFlagExists("ignoreCdata",E),e.ensureFlagExists("ignoreDoctype",E),e.ensureFlagExists("compact",E),e.ensureFlagExists("indentText",E),e.ensureFlagExists("indentCdata",E),e.ensureFlagExists("indentAttributes",E),e.ensureFlagExists("indentInstruction",E),e.ensureFlagExists("fullTagEmptyElement",E),e.ensureFlagExists("noQuotesForNativeAttributes",E),e.ensureSpacesExists(E),typeof E.spaces=="number"&&(E.spaces=Array(E.spaces+1).join(" ")),e.ensureKeyExists("declaration",E),e.ensureKeyExists("instruction",E),e.ensureKeyExists("attributes",E),e.ensureKeyExists("text",E),e.ensureKeyExists("comment",E),e.ensureKeyExists("cdata",E),e.ensureKeyExists("doctype",E),e.ensureKeyExists("type",E),e.ensureKeyExists("name",E),e.ensureKeyExists("elements",E),e.checkFnExists("doctype",E),e.checkFnExists("instruction",E),e.checkFnExists("cdata",E),e.checkFnExists("comment",E),e.checkFnExists("text",E),e.checkFnExists("instructionName",E),e.checkFnExists("elementName",E),e.checkFnExists("attributeName",E),e.checkFnExists("attributeValue",E),e.checkFnExists("attributes",E),e.checkFnExists("fullTagEmptyElement",E),E}function o(N,E,C){return(!C&&N.spaces?`
`:"")+Array(E+1).join(N.spaces)}function l(N,E,C){if(E.ignoreAttributes)return"";"attributesFn"in E&&(N=E.attributesFn(N,s,r));var L,O,B,F,q=[];for(L in N)N.hasOwnProperty(L)&&N[L]!==null&&N[L]!==void 0&&(F=E.noQuotesForNativeAttributes&&typeof N[L]!="string"?"":'"',O=""+N[L],O=O.replace(/"/g,"&quot;"),B="attributeNameFn"in E?E.attributeNameFn(L,O,s,r):L,q.push(E.spaces&&E.indentAttributes?o(E,C+1,!1):" "),q.push(B+"="+F+("attributeValueFn"in E?E.attributeValueFn(O,L,s,r):O)+F));return N&&Object.keys(N).length&&E.spaces&&E.indentAttributes&&q.push(o(E,C,!1)),q.join("")}function u(N,E,C){return r=N,s="xml",E.ignoreDeclaration?"":"<?xml"+l(N[E.attributesKey],E,C)+"?>"}function d(N,E,C){if(E.ignoreInstruction)return"";var L;for(L in N)if(N.hasOwnProperty(L))break;var O="instructionNameFn"in E?E.instructionNameFn(L,N[L],s,r):L;if(typeof N[L]=="object")return r=N,s=O,"<?"+O+l(N[L][E.attributesKey],E,C)+"?>";var B=N[L]?N[L]:"";return"instructionFn"in E&&(B=E.instructionFn(B,L,s,r)),"<?"+O+(B?" "+B:"")+"?>"}function h(N,E){return E.ignoreComment?"":"<!--"+("commentFn"in E?E.commentFn(N,s,r):N)+"-->"}function m(N,E){return E.ignoreCdata?"":"<![CDATA["+("cdataFn"in E?E.cdataFn(N,s,r):N.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function x(N,E){return E.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in E?E.doctypeFn(N,s,r):N)+">"}function y(N,E){return E.ignoreText?"":(N=""+N,N=N.replace(/&amp;/g,"&"),N=N.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in E?E.textFn(N,s,r):N)}function v(N,E){var C;if(N.elements&&N.elements.length)for(C=0;C<N.elements.length;++C)switch(N.elements[C][E.typeKey]){case"text":if(E.indentText)return!0;break;case"cdata":if(E.indentCdata)return!0;break;case"instruction":if(E.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function b(N,E,C){r=N,s=N.name;var L=[],O="elementNameFn"in E?E.elementNameFn(N.name,N):N.name;L.push("<"+O),N[E.attributesKey]&&L.push(l(N[E.attributesKey],E,C));var B=N[E.elementsKey]&&N[E.elementsKey].length||N[E.attributesKey]&&N[E.attributesKey]["xml:space"]==="preserve";return B||("fullTagEmptyElementFn"in E?B=E.fullTagEmptyElementFn(N.name,N):B=E.fullTagEmptyElement),B?(L.push(">"),N[E.elementsKey]&&N[E.elementsKey].length&&(L.push(g(N[E.elementsKey],E,C+1)),r=N,s=N.name),L.push(E.spaces&&v(N,E)?`
`+Array(C+1).join(E.spaces):""),L.push("</"+O+">")):L.push("/>"),L.join("")}function g(N,E,C,L){return N.reduce(function(O,B){var F=o(E,C,L&&!O);switch(B.type){case"element":return O+F+b(B,E,C);case"comment":return O+F+h(B[E.commentKey],E);case"doctype":return O+F+x(B[E.doctypeKey],E);case"cdata":return O+(E.indentCdata?F:"")+m(B[E.cdataKey],E);case"text":return O+(E.indentText?F:"")+y(B[E.textKey],E);case"instruction":var q={};return q[B[E.nameKey]]=B[E.attributesKey]?B:B[E.instructionKey],O+(E.indentInstruction?F:"")+d(q,E,C)}},"")}function _(N,E,C){var L;for(L in N)if(N.hasOwnProperty(L))switch(L){case E.parentKey:case E.attributesKey:break;case E.textKey:if(E.indentText||C)return!0;break;case E.cdataKey:if(E.indentCdata||C)return!0;break;case E.instructionKey:if(E.indentInstruction||C)return!0;break;case E.doctypeKey:case E.commentKey:return!0;default:return!0}return!1}function w(N,E,C,L,O){r=N,s=E;var B="elementNameFn"in C?C.elementNameFn(E,N):E;if(typeof N>"u"||N===null||N==="")return"fullTagEmptyElementFn"in C&&C.fullTagEmptyElementFn(E,N)||C.fullTagEmptyElement?"<"+B+"></"+B+">":"<"+B+"/>";var F=[];if(E){if(F.push("<"+B),typeof N!="object")return F.push(">"+y(N,C)+"</"+B+">"),F.join("");N[C.attributesKey]&&F.push(l(N[C.attributesKey],C,L));var q=_(N,C,!0)||N[C.attributesKey]&&N[C.attributesKey]["xml:space"]==="preserve";if(q||("fullTagEmptyElementFn"in C?q=C.fullTagEmptyElementFn(E,N):q=C.fullTagEmptyElement),q)F.push(">");else return F.push("/>"),F.join("")}return F.push(k(N,C,L+1,!1)),r=N,s=E,E&&F.push((O?o(C,L,!1):"")+"</"+B+">"),F.join("")}function k(N,E,C,L){var O,B,F,q=[];for(B in N)if(N.hasOwnProperty(B))for(F=t(N[B])?N[B]:[N[B]],O=0;O<F.length;++O){switch(B){case E.declarationKey:q.push(u(F[O],E,C));break;case E.instructionKey:q.push((E.indentInstruction?o(E,C,L):"")+d(F[O],E,C));break;case E.attributesKey:case E.parentKey:break;case E.textKey:q.push((E.indentText?o(E,C,L):"")+y(F[O],E));break;case E.cdataKey:q.push((E.indentCdata?o(E,C,L):"")+m(F[O],E));break;case E.doctypeKey:q.push(o(E,C,L)+x(F[O],E));break;case E.commentKey:q.push(o(E,C,L)+h(F[O],E));break;default:q.push(o(E,C,L)+w(F[O],B,E,C,_(F[O],E)))}L=L&&!q.length}return q.join("")}return k1=function(N,E){E=a(E);var C=[];return r=N,s="_root_",E.compact?C.push(k(N,E,0,!0)):(N[E.declarationKey]&&C.push(u(N[E.declarationKey],E,0)),N[E.elementsKey]&&N[E.elementsKey].length&&C.push(g(N[E.elementsKey],E,0,!C.length))),C.join("")},k1}var E1,I4;function kL(){if(I4)return E1;I4=1;var e=fj();return E1=function(t,r){t instanceof Buffer&&(t=t.toString());var s=null;if(typeof t=="string")try{s=JSON.parse(t)}catch{throw new Error("The JSON structure is invalid")}else s=t;return e(s,r)},E1}var j1,M4;function EL(){if(M4)return j1;M4=1;var e=dj(),t=SL(),r=fj(),s=kL();return j1={xml2js:e,xml2json:t,js2xml:r,json2xml:s},j1}var hj=EL();const _v=e=>{switch(e.type){case void 0:case"element":const t=new TL(e.name,e.attributes),r=e.elements||[];for(const s of r){const a=_v(s);a!==void 0&&t.push(a)}return t;case"text":return e.text;default:return}};class jL extends jt{}class TL extends Qe{static fromXmlString(t){const r=hj.xml2js(t,{compact:!1});return _v(r)}constructor(t,r){super(t),r&&this.root.push(new jL(r))}push(t){this.root.push(t)}}class AL extends Qe{constructor(t){super(""),this._attr=t}prepForXml(t){return{_attr:this._attr}}}class mj extends Qe{constructor(t,r){super(t),r&&(this.root=r.root)}}const oa=e=>{if(isNaN(e))throw new Error(`Invalid value '${e}' specified. Must be an integer.`);return Math.floor(e)},im=e=>{const t=oa(e);if(t<0)throw new Error(`Invalid value '${e}' specified. Must be a positive integer.`);return t},pj=(e,t)=>{const r=t*2;if(e.length!==r||isNaN(+`0x${e}`))throw new Error(`Invalid hex value '${e}'. Expected ${r} digit hex value`);return e},B4=e=>pj(e,1),Nv=e=>{const t=e.slice(-2),r=e.substring(0,e.length-2);return`${Number(r)}${t}`},xj=e=>{const t=Nv(e);if(parseFloat(t)<0)throw new Error(`Invalid value '${t}' specified. Expected a positive number.`);return t},Wc=e=>{if(e==="auto")return e;const t=e.charAt(0)==="#"?e.substring(1):e;return pj(t,3)},pi=e=>typeof e=="string"?Nv(e):oa(e),CL=e=>typeof e=="string"?xj(e):im(e),Xs=e=>typeof e=="string"?xj(e):im(e),RL=e=>{const t=e.substring(0,e.length-1);return`${Number(t)}%`},gj=e=>typeof e=="number"?oa(e):e.slice(-1)==="%"?RL(e):Nv(e),DL=im,OL=im,FL=e=>e.toISOString();class ht extends Qe{constructor(t,r=!0){super(t),r!==!0&&this.root.push(new cs({val:r}))}}class T1 extends Qe{constructor(t,r){super(t),this.root.push(new cs({val:CL(r)}))}}class rl extends Qe{constructor(t,r){super(t),this.root.push(new cs({val:r}))}}const Qu=(e,t)=>new Rr({name:e,attributes:{value:{key:"w:val",value:t}}});class pd extends Qe{constructor(t,r){super(t),this.root.push(new cs({val:r}))}}class LL extends Qe{constructor(t,r){super(t),this.root.push(new cs({val:r}))}}class qo extends Qe{constructor(t,r){super(t),this.root.push(r)}}class Rr extends Qe{constructor({name:t,attributes:r,children:s}){super(t),r&&this.root.push(new Ai(r)),s&&this.root.push(...s)}}const Dt={START:"start",CENTER:"center",LEFT:"left",RIGHT:"right"};class IL extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{val:"w:val"})}}class yj extends Qe{constructor(t){super("w:jc"),this.root.push(new IL({val:t}))}}class Ir extends Qe{constructor(t,{color:r,size:s,space:a,style:o}){super(t),this.root.push(new ML({style:o,color:r===void 0?void 0:Wc(r),size:s===void 0?void 0:DL(s),space:a===void 0?void 0:OL(a)}))}}class ML extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}}const nr={SINGLE:"single",NONE:"none"};class BL extends Ti{constructor(t){super("w:pBdr"),t.top&&this.root.push(new Ir("w:top",t.top)),t.bottom&&this.root.push(new Ir("w:bottom",t.bottom)),t.left&&this.root.push(new Ir("w:left",t.left)),t.right&&this.root.push(new Ir("w:right",t.right))}}class PL extends Qe{constructor(){super("w:pBdr");const t=new Ir("w:bottom",{color:"auto",space:1,style:nr.SINGLE,size:6});this.root.push(t)}}class UL extends Qe{constructor({start:t,end:r,left:s,right:a,hanging:o,firstLine:l}){super("w:ind"),this.root.push(new Ai({start:{key:"w:start",value:t===void 0?void 0:pi(t)},end:{key:"w:end",value:r===void 0?void 0:pi(r)},left:{key:"w:left",value:s===void 0?void 0:pi(s)},right:{key:"w:right",value:a===void 0?void 0:pi(a)},hanging:{key:"w:hanging",value:o===void 0?void 0:Xs(o)},firstLine:{key:"w:firstLine",value:l===void 0?void 0:Xs(l)}}))}}let zL=class extends Qe{constructor(){super("w:br")}};const Sv={BEGIN:"begin",END:"end",SEPARATE:"separate"};class kv extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}}class zh extends Qe{constructor(t){super("w:fldChar"),this.root.push(new kv({type:Sv.BEGIN,dirty:t}))}}class $h extends Qe{constructor(t){super("w:fldChar"),this.root.push(new kv({type:Sv.SEPARATE,dirty:t}))}}class qh extends Qe{constructor(t){super("w:fldChar"),this.root.push(new kv({type:Sv.END,dirty:t}))}}const Gc={DEFAULT:"default",PRESERVE:"preserve"};class Vc extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{space:"xml:space"})}}class $L extends Qe{constructor(){super("w:instrText"),this.root.push(new Vc({space:Gc.PRESERVE})),this.root.push("PAGE")}}class qL extends Qe{constructor(){super("w:instrText"),this.root.push(new Vc({space:Gc.PRESERVE})),this.root.push("NUMPAGES")}}class HL extends Qe{constructor(){super("w:instrText"),this.root.push(new Vc({space:Gc.PRESERVE})),this.root.push("SECTIONPAGES")}}class WL extends Qe{constructor(){super("w:instrText"),this.root.push(new Vc({space:Gc.PRESERVE})),this.root.push("SECTION")}}class GL extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}}class om extends Qe{constructor({fill:t,color:r,type:s}){super("w:shd"),this.root.push(new GL({fill:t===void 0?void 0:Wc(t),color:r===void 0?void 0:Wc(r),type:s}))}}class VL extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}}const KL={DOT:"dot"};class XL extends Qe{constructor(t){super("w:em"),this.root.push(new cs({val:t}))}}class YL extends XL{constructor(t=KL.DOT){super(t)}}class JL extends Qe{constructor(t){super("w:spacing"),this.root.push(new cs({val:pi(t)}))}}class ZL extends Qe{constructor(t){super("w:color"),this.root.push(new cs({val:Wc(t)}))}}class QL extends Qe{constructor(t){super("w:highlight"),this.root.push(new cs({val:t}))}}class eI extends Qe{constructor(t){super("w:highlightCs"),this.root.push(new cs({val:t}))}}const tI=e=>new Rr({name:"w:lang",attributes:{value:{key:"w:val",value:e.value},eastAsia:{key:"w:eastAsia",value:e.eastAsia},bidirectional:{key:"w:bidi",value:e.bidirectional}}});class P4 extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}}class A1 extends Qe{constructor(t,r){if(super("w:rFonts"),typeof t=="string"){const s=t;this.root.push(new P4({ascii:s,cs:s,eastAsia:s,hAnsi:s,hint:r}))}else{const s=t;this.root.push(new P4(s))}}}let vj=class extends Qe{constructor(t){super("w:vertAlign"),this.root.push(new cs({val:t}))}};class rI extends vj{constructor(){super("superscript")}}class sI extends vj{constructor(){super("subscript")}}const bj={SINGLE:"single"};class aI extends Qe{constructor(t=bj.SINGLE,r){super("w:u"),this.root.push(new cs({val:t,color:r===void 0?void 0:Wc(r)}))}}class wl extends Ti{constructor(t){var r,s;if(super("w:rPr"),!t)return;t.style&&this.push(new rl("w:rStyle",t.style)),t.font&&(typeof t.font=="string"?this.push(new A1(t.font)):"name"in t.font?this.push(new A1(t.font.name,t.font.hint)):this.push(new A1(t.font))),t.bold!==void 0&&this.push(new ht("w:b",t.bold)),(t.boldComplexScript===void 0&&t.bold!==void 0||t.boldComplexScript)&&this.push(new ht("w:bCs",(r=t.boldComplexScript)!=null?r:t.bold)),t.italics!==void 0&&this.push(new ht("w:i",t.italics)),(t.italicsComplexScript===void 0&&t.italics!==void 0||t.italicsComplexScript)&&this.push(new ht("w:iCs",(s=t.italicsComplexScript)!=null?s:t.italics)),t.smallCaps!==void 0?this.push(new ht("w:smallCaps",t.smallCaps)):t.allCaps!==void 0&&this.push(new ht("w:caps",t.allCaps)),t.strike!==void 0&&this.push(new ht("w:strike",t.strike)),t.doubleStrike!==void 0&&this.push(new ht("w:dstrike",t.doubleStrike)),t.emboss!==void 0&&this.push(new ht("w:emboss",t.emboss)),t.imprint!==void 0&&this.push(new ht("w:imprint",t.imprint)),t.noProof!==void 0&&this.push(new ht("w:noProof",t.noProof)),t.snapToGrid!==void 0&&this.push(new ht("w:snapToGrid",t.snapToGrid)),t.vanish&&this.push(new ht("w:vanish",t.vanish)),t.color&&this.push(new ZL(t.color)),t.characterSpacing&&this.push(new JL(t.characterSpacing)),t.scale!==void 0&&this.push(new pd("w:w",t.scale)),t.kern&&this.push(new T1("w:kern",t.kern)),t.position&&this.push(new rl("w:position",t.position)),t.size!==void 0&&this.push(new T1("w:sz",t.size));const a=t.sizeComplexScript===void 0||t.sizeComplexScript===!0?t.size:t.sizeComplexScript;a&&this.push(new T1("w:szCs",a)),t.highlight&&this.push(new QL(t.highlight));const o=t.highlightComplexScript===void 0||t.highlightComplexScript===!0?t.highlight:t.highlightComplexScript;o&&this.push(new eI(o)),t.underline&&this.push(new aI(t.underline.type,t.underline.color)),t.effect&&this.push(new rl("w:effect",t.effect)),t.border&&this.push(new Ir("w:bdr",t.border)),t.shading&&this.push(new om(t.shading)),t.subScript&&this.push(new sI),t.superScript&&this.push(new rI),t.rightToLeft!==void 0&&this.push(new ht("w:rtl",t.rightToLeft)),t.emphasisMark&&this.push(new YL(t.emphasisMark.type)),t.language&&this.push(tI(t.language)),t.specVanish&&this.push(new ht("w:specVanish",t.vanish)),t.math&&this.push(new ht("w:oMath",t.math)),t.revision&&this.push(new nI(t.revision))}push(t){this.root.push(t)}}class nI extends Qe{constructor(t){super("w:rPrChange"),this.root.push(new VL({id:t.id,author:t.author,date:t.date})),this.addChildElement(new wl(t))}}class U4 extends Qe{constructor(t){var r;super("w:t"),typeof t=="string"?(this.root.push(new Vc({space:Gc.PRESERVE})),this.root.push(t)):(this.root.push(new Vc({space:(r=t.space)!=null?r:Gc.DEFAULT})),this.root.push(t.text))}}const Hh={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"};class of extends Qe{constructor(t){if(super("w:r"),Je(this,"properties"),this.properties=new wl(t),this.root.push(this.properties),t.break)for(let r=0;r<t.break;r++)this.root.push(new zL);if(t.children)for(const r of t.children){if(typeof r=="string"){switch(r){case Hh.CURRENT:this.root.push(new zh),this.root.push(new $L),this.root.push(new $h),this.root.push(new qh);break;case Hh.TOTAL_PAGES:this.root.push(new zh),this.root.push(new qL),this.root.push(new $h),this.root.push(new qh);break;case Hh.TOTAL_PAGES_IN_SECTION:this.root.push(new zh),this.root.push(new HL),this.root.push(new $h),this.root.push(new qh);break;case Hh.CURRENT_SECTION:this.root.push(new zh),this.root.push(new WL),this.root.push(new $h),this.root.push(new qh);break;default:this.root.push(new U4(r));break}continue}this.root.push(r)}else t.text!==void 0&&this.root.push(new U4(t.text))}}class Tt extends of{constructor(t){super(typeof t=="string"?{text:t}:t)}}var C1={},Lr={},R1,z4;function lf(){if(z4)return R1;z4=1,R1=e;function e(t,r){if(!t)throw new Error(r||"Assertion failed")}return e.equal=function(r,s,a){if(r!=s)throw new Error(a||"Assertion failed: "+r+" != "+s)},R1}var $4;function qn(){if($4)return Lr;$4=1;var e=lf(),t=yo();Lr.inherits=t;function r(D,V){return(D.charCodeAt(V)&64512)!==55296||V<0||V+1>=D.length?!1:(D.charCodeAt(V+1)&64512)===56320}function s(D,V){if(Array.isArray(D))return D.slice();if(!D)return[];var I=[];if(typeof D=="string")if(V){if(V==="hex")for(D=D.replace(/[^a-z0-9]+/ig,""),D.length%2!==0&&(D="0"+D),Q=0;Q<D.length;Q+=2)I.push(parseInt(D[Q]+D[Q+1],16))}else for(var ae=0,Q=0;Q<D.length;Q++){var te=D.charCodeAt(Q);te<128?I[ae++]=te:te<2048?(I[ae++]=te>>6|192,I[ae++]=te&63|128):r(D,Q)?(te=65536+((te&1023)<<10)+(D.charCodeAt(++Q)&1023),I[ae++]=te>>18|240,I[ae++]=te>>12&63|128,I[ae++]=te>>6&63|128,I[ae++]=te&63|128):(I[ae++]=te>>12|224,I[ae++]=te>>6&63|128,I[ae++]=te&63|128)}else for(Q=0;Q<D.length;Q++)I[Q]=D[Q]|0;return I}Lr.toArray=s;function a(D){for(var V="",I=0;I<D.length;I++)V+=u(D[I].toString(16));return V}Lr.toHex=a;function o(D){var V=D>>>24|D>>>8&65280|D<<8&16711680|(D&255)<<24;return V>>>0}Lr.htonl=o;function l(D,V){for(var I="",ae=0;ae<D.length;ae++){var Q=D[ae];V==="little"&&(Q=o(Q)),I+=d(Q.toString(16))}return I}Lr.toHex32=l;function u(D){return D.length===1?"0"+D:D}Lr.zero2=u;function d(D){return D.length===7?"0"+D:D.length===6?"00"+D:D.length===5?"000"+D:D.length===4?"0000"+D:D.length===3?"00000"+D:D.length===2?"000000"+D:D.length===1?"0000000"+D:D}Lr.zero8=d;function h(D,V,I,ae){var Q=I-V;e(Q%4===0);for(var te=new Array(Q/4),ve=0,ee=V;ve<te.length;ve++,ee+=4){var Se;ae==="big"?Se=D[ee]<<24|D[ee+1]<<16|D[ee+2]<<8|D[ee+3]:Se=D[ee+3]<<24|D[ee+2]<<16|D[ee+1]<<8|D[ee],te[ve]=Se>>>0}return te}Lr.join32=h;function m(D,V){for(var I=new Array(D.length*4),ae=0,Q=0;ae<D.length;ae++,Q+=4){var te=D[ae];V==="big"?(I[Q]=te>>>24,I[Q+1]=te>>>16&255,I[Q+2]=te>>>8&255,I[Q+3]=te&255):(I[Q+3]=te>>>24,I[Q+2]=te>>>16&255,I[Q+1]=te>>>8&255,I[Q]=te&255)}return I}Lr.split32=m;function x(D,V){return D>>>V|D<<32-V}Lr.rotr32=x;function y(D,V){return D<<V|D>>>32-V}Lr.rotl32=y;function v(D,V){return D+V>>>0}Lr.sum32=v;function b(D,V,I){return D+V+I>>>0}Lr.sum32_3=b;function g(D,V,I,ae){return D+V+I+ae>>>0}Lr.sum32_4=g;function _(D,V,I,ae,Q){return D+V+I+ae+Q>>>0}Lr.sum32_5=_;function w(D,V,I,ae){var Q=D[V],te=D[V+1],ve=ae+te>>>0,ee=(ve<ae?1:0)+I+Q;D[V]=ee>>>0,D[V+1]=ve}Lr.sum64=w;function k(D,V,I,ae){var Q=V+ae>>>0,te=(Q<V?1:0)+D+I;return te>>>0}Lr.sum64_hi=k;function N(D,V,I,ae){var Q=V+ae;return Q>>>0}Lr.sum64_lo=N;function E(D,V,I,ae,Q,te,ve,ee){var Se=0,J=V;J=J+ae>>>0,Se+=J<V?1:0,J=J+te>>>0,Se+=J<te?1:0,J=J+ee>>>0,Se+=J<ee?1:0;var M=D+I+Q+ve+Se;return M>>>0}Lr.sum64_4_hi=E;function C(D,V,I,ae,Q,te,ve,ee){var Se=V+ae+te+ee;return Se>>>0}Lr.sum64_4_lo=C;function L(D,V,I,ae,Q,te,ve,ee,Se,J){var M=0,Y=V;Y=Y+ae>>>0,M+=Y<V?1:0,Y=Y+te>>>0,M+=Y<te?1:0,Y=Y+ee>>>0,M+=Y<ee?1:0,Y=Y+J>>>0,M+=Y<J?1:0;var G=D+I+Q+ve+Se+M;return G>>>0}Lr.sum64_5_hi=L;function O(D,V,I,ae,Q,te,ve,ee,Se,J){var M=V+ae+te+ee+J;return M>>>0}Lr.sum64_5_lo=O;function B(D,V,I){var ae=V<<32-I|D>>>I;return ae>>>0}Lr.rotr64_hi=B;function F(D,V,I){var ae=D<<32-I|V>>>I;return ae>>>0}Lr.rotr64_lo=F;function q(D,V,I){return D>>>I}Lr.shr64_hi=q;function fe(D,V,I){var ae=D<<32-I|V>>>I;return ae>>>0}return Lr.shr64_lo=fe,Lr}var D1={},q4;function cf(){if(q4)return D1;q4=1;var e=qn(),t=lf();function r(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return D1.BlockHash=r,r.prototype.update=function(a,o){if(a=e.toArray(a,o),this.pending?this.pending=this.pending.concat(a):this.pending=a,this.pendingTotal+=a.length,this.pending.length>=this._delta8){a=this.pending;var l=a.length%this._delta8;this.pending=a.slice(a.length-l,a.length),this.pending.length===0&&(this.pending=null),a=e.join32(a,0,a.length-l,this.endian);for(var u=0;u<a.length;u+=this._delta32)this._update(a,u,u+this._delta32)}return this},r.prototype.digest=function(a){return this.update(this._pad()),t(this.pending===null),this._digest(a)},r.prototype._pad=function(){var a=this.pendingTotal,o=this._delta8,l=o-(a+this.padLength)%o,u=new Array(l+this.padLength);u[0]=128;for(var d=1;d<l;d++)u[d]=0;if(a<<=3,this.endian==="big"){for(var h=8;h<this.padLength;h++)u[d++]=0;u[d++]=0,u[d++]=0,u[d++]=0,u[d++]=0,u[d++]=a>>>24&255,u[d++]=a>>>16&255,u[d++]=a>>>8&255,u[d++]=a&255}else for(u[d++]=a&255,u[d++]=a>>>8&255,u[d++]=a>>>16&255,u[d++]=a>>>24&255,u[d++]=0,u[d++]=0,u[d++]=0,u[d++]=0,h=8;h<this.padLength;h++)u[d++]=0;return u},D1}var Ho={},On={},H4;function wj(){if(H4)return On;H4=1;var e=qn(),t=e.rotr32;function r(m,x,y,v){if(m===0)return s(x,y,v);if(m===1||m===3)return o(x,y,v);if(m===2)return a(x,y,v)}On.ft_1=r;function s(m,x,y){return m&x^~m&y}On.ch32=s;function a(m,x,y){return m&x^m&y^x&y}On.maj32=a;function o(m,x,y){return m^x^y}On.p32=o;function l(m){return t(m,2)^t(m,13)^t(m,22)}On.s0_256=l;function u(m){return t(m,6)^t(m,11)^t(m,25)}On.s1_256=u;function d(m){return t(m,7)^t(m,18)^m>>>3}On.g0_256=d;function h(m){return t(m,17)^t(m,19)^m>>>10}return On.g1_256=h,On}var O1,W4;function iI(){if(W4)return O1;W4=1;var e=qn(),t=cf(),r=wj(),s=e.rotl32,a=e.sum32,o=e.sum32_5,l=r.ft_1,u=t.BlockHash,d=[1518500249,1859775393,2400959708,3395469782];function h(){if(!(this instanceof h))return new h;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return e.inherits(h,u),O1=h,h.blockSize=512,h.outSize=160,h.hmacStrength=80,h.padLength=64,h.prototype._update=function(x,y){for(var v=this.W,b=0;b<16;b++)v[b]=x[y+b];for(;b<v.length;b++)v[b]=s(v[b-3]^v[b-8]^v[b-14]^v[b-16],1);var g=this.h[0],_=this.h[1],w=this.h[2],k=this.h[3],N=this.h[4];for(b=0;b<v.length;b++){var E=~~(b/20),C=o(s(g,5),l(E,_,w,k),N,v[b],d[E]);N=k,k=w,w=s(_,30),_=g,g=C}this.h[0]=a(this.h[0],g),this.h[1]=a(this.h[1],_),this.h[2]=a(this.h[2],w),this.h[3]=a(this.h[3],k),this.h[4]=a(this.h[4],N)},h.prototype._digest=function(x){return x==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")},O1}var F1,G4;function _j(){if(G4)return F1;G4=1;var e=qn(),t=cf(),r=wj(),s=lf(),a=e.sum32,o=e.sum32_4,l=e.sum32_5,u=r.ch32,d=r.maj32,h=r.s0_256,m=r.s1_256,x=r.g0_256,y=r.g1_256,v=t.BlockHash,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function g(){if(!(this instanceof g))return new g;v.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=b,this.W=new Array(64)}return e.inherits(g,v),F1=g,g.blockSize=512,g.outSize=256,g.hmacStrength=192,g.padLength=64,g.prototype._update=function(w,k){for(var N=this.W,E=0;E<16;E++)N[E]=w[k+E];for(;E<N.length;E++)N[E]=o(y(N[E-2]),N[E-7],x(N[E-15]),N[E-16]);var C=this.h[0],L=this.h[1],O=this.h[2],B=this.h[3],F=this.h[4],q=this.h[5],fe=this.h[6],D=this.h[7];for(s(this.k.length===N.length),E=0;E<N.length;E++){var V=l(D,m(F),u(F,q,fe),this.k[E],N[E]),I=a(h(C),d(C,L,O));D=fe,fe=q,q=F,F=a(B,V),B=O,O=L,L=C,C=a(V,I)}this.h[0]=a(this.h[0],C),this.h[1]=a(this.h[1],L),this.h[2]=a(this.h[2],O),this.h[3]=a(this.h[3],B),this.h[4]=a(this.h[4],F),this.h[5]=a(this.h[5],q),this.h[6]=a(this.h[6],fe),this.h[7]=a(this.h[7],D)},g.prototype._digest=function(w){return w==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")},F1}var L1,V4;function oI(){if(V4)return L1;V4=1;var e=qn(),t=_j();function r(){if(!(this instanceof r))return new r;t.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return e.inherits(r,t),L1=r,r.blockSize=512,r.outSize=224,r.hmacStrength=192,r.padLength=64,r.prototype._digest=function(a){return a==="hex"?e.toHex32(this.h.slice(0,7),"big"):e.split32(this.h.slice(0,7),"big")},L1}var I1,K4;function Nj(){if(K4)return I1;K4=1;var e=qn(),t=cf(),r=lf(),s=e.rotr64_hi,a=e.rotr64_lo,o=e.shr64_hi,l=e.shr64_lo,u=e.sum64,d=e.sum64_hi,h=e.sum64_lo,m=e.sum64_4_hi,x=e.sum64_4_lo,y=e.sum64_5_hi,v=e.sum64_5_lo,b=t.BlockHash,g=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function _(){if(!(this instanceof _))return new _;b.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=g,this.W=new Array(160)}e.inherits(_,b),I1=_,_.blockSize=1024,_.outSize=512,_.hmacStrength=192,_.padLength=128,_.prototype._prepareBlock=function(I,ae){for(var Q=this.W,te=0;te<32;te++)Q[te]=I[ae+te];for(;te<Q.length;te+=2){var ve=fe(Q[te-4],Q[te-3]),ee=D(Q[te-4],Q[te-3]),Se=Q[te-14],J=Q[te-13],M=F(Q[te-30],Q[te-29]),Y=q(Q[te-30],Q[te-29]),G=Q[te-32],re=Q[te-31];Q[te]=m(ve,ee,Se,J,M,Y,G,re),Q[te+1]=x(ve,ee,Se,J,M,Y,G,re)}},_.prototype._update=function(I,ae){this._prepareBlock(I,ae);var Q=this.W,te=this.h[0],ve=this.h[1],ee=this.h[2],Se=this.h[3],J=this.h[4],M=this.h[5],Y=this.h[6],G=this.h[7],re=this.h[8],ce=this.h[9],P=this.h[10],U=this.h[11],le=this.h[12],ne=this.h[13],ie=this.h[14],H=this.h[15];r(this.k.length===Q.length);for(var K=0;K<Q.length;K+=2){var S=ie,ue=H,z=O(re,ce),T=B(re,ce),A=w(re,ce,P,U,le),W=k(re,ce,P,U,le,ne),pe=this.k[K],_e=this.k[K+1],oe=Q[K],Te=Q[K+1],Me=y(S,ue,z,T,A,W,pe,_e,oe,Te),Ae=v(S,ue,z,T,A,W,pe,_e,oe,Te);S=C(te,ve),ue=L(te,ve),z=N(te,ve,ee,Se,J),T=E(te,ve,ee,Se,J,M);var Re=d(S,ue,z,T),et=h(S,ue,z,T);ie=le,H=ne,le=P,ne=U,P=re,U=ce,re=d(Y,G,Me,Ae),ce=h(G,G,Me,Ae),Y=J,G=M,J=ee,M=Se,ee=te,Se=ve,te=d(Me,Ae,Re,et),ve=h(Me,Ae,Re,et)}u(this.h,0,te,ve),u(this.h,2,ee,Se),u(this.h,4,J,M),u(this.h,6,Y,G),u(this.h,8,re,ce),u(this.h,10,P,U),u(this.h,12,le,ne),u(this.h,14,ie,H)},_.prototype._digest=function(I){return I==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")};function w(V,I,ae,Q,te){var ve=V&ae^~V&te;return ve<0&&(ve+=4294967296),ve}function k(V,I,ae,Q,te,ve){var ee=I&Q^~I&ve;return ee<0&&(ee+=4294967296),ee}function N(V,I,ae,Q,te){var ve=V&ae^V&te^ae&te;return ve<0&&(ve+=4294967296),ve}function E(V,I,ae,Q,te,ve){var ee=I&Q^I&ve^Q&ve;return ee<0&&(ee+=4294967296),ee}function C(V,I){var ae=s(V,I,28),Q=s(I,V,2),te=s(I,V,7),ve=ae^Q^te;return ve<0&&(ve+=4294967296),ve}function L(V,I){var ae=a(V,I,28),Q=a(I,V,2),te=a(I,V,7),ve=ae^Q^te;return ve<0&&(ve+=4294967296),ve}function O(V,I){var ae=s(V,I,14),Q=s(V,I,18),te=s(I,V,9),ve=ae^Q^te;return ve<0&&(ve+=4294967296),ve}function B(V,I){var ae=a(V,I,14),Q=a(V,I,18),te=a(I,V,9),ve=ae^Q^te;return ve<0&&(ve+=4294967296),ve}function F(V,I){var ae=s(V,I,1),Q=s(V,I,8),te=o(V,I,7),ve=ae^Q^te;return ve<0&&(ve+=4294967296),ve}function q(V,I){var ae=a(V,I,1),Q=a(V,I,8),te=l(V,I,7),ve=ae^Q^te;return ve<0&&(ve+=4294967296),ve}function fe(V,I){var ae=s(V,I,19),Q=s(I,V,29),te=o(V,I,6),ve=ae^Q^te;return ve<0&&(ve+=4294967296),ve}function D(V,I){var ae=a(V,I,19),Q=a(I,V,29),te=l(V,I,6),ve=ae^Q^te;return ve<0&&(ve+=4294967296),ve}return I1}var M1,X4;function lI(){if(X4)return M1;X4=1;var e=qn(),t=Nj();function r(){if(!(this instanceof r))return new r;t.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return e.inherits(r,t),M1=r,r.blockSize=1024,r.outSize=384,r.hmacStrength=192,r.padLength=128,r.prototype._digest=function(a){return a==="hex"?e.toHex32(this.h.slice(0,12),"big"):e.split32(this.h.slice(0,12),"big")},M1}var Y4;function cI(){return Y4||(Y4=1,Ho.sha1=iI(),Ho.sha224=oI(),Ho.sha256=_j(),Ho.sha384=lI(),Ho.sha512=Nj()),Ho}var B1={},J4;function uI(){if(J4)return B1;J4=1;var e=qn(),t=cf(),r=e.rotl32,s=e.sum32,a=e.sum32_3,o=e.sum32_4,l=t.BlockHash;function u(){if(!(this instanceof u))return new u;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}e.inherits(u,l),B1.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(_,w){for(var k=this.h[0],N=this.h[1],E=this.h[2],C=this.h[3],L=this.h[4],O=k,B=N,F=E,q=C,fe=L,D=0;D<80;D++){var V=s(r(o(k,d(D,N,E,C),_[x[D]+w],h(D)),v[D]),L);k=L,L=C,C=r(E,10),E=N,N=V,V=s(r(o(O,d(79-D,B,F,q),_[y[D]+w],m(D)),b[D]),fe),O=fe,fe=q,q=r(F,10),F=B,B=V}V=a(this.h[1],E,q),this.h[1]=a(this.h[2],C,fe),this.h[2]=a(this.h[3],L,O),this.h[3]=a(this.h[4],k,B),this.h[4]=a(this.h[0],N,F),this.h[0]=V},u.prototype._digest=function(_){return _==="hex"?e.toHex32(this.h,"little"):e.split32(this.h,"little")};function d(g,_,w,k){return g<=15?_^w^k:g<=31?_&w|~_&k:g<=47?(_|~w)^k:g<=63?_&k|w&~k:_^(w|~k)}function h(g){return g<=15?0:g<=31?1518500249:g<=47?1859775393:g<=63?2400959708:2840853838}function m(g){return g<=15?1352829926:g<=31?1548603684:g<=47?1836072691:g<=63?2053994217:0}var x=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],y=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],v=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],b=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return B1}var P1,Z4;function dI(){if(Z4)return P1;Z4=1;var e=qn(),t=lf();function r(s,a,o){if(!(this instanceof r))return new r(s,a,o);this.Hash=s,this.blockSize=s.blockSize/8,this.outSize=s.outSize/8,this.inner=null,this.outer=null,this._init(e.toArray(a,o))}return P1=r,r.prototype._init=function(a){a.length>this.blockSize&&(a=new this.Hash().update(a).digest()),t(a.length<=this.blockSize);for(var o=a.length;o<this.blockSize;o++)a.push(0);for(o=0;o<a.length;o++)a[o]^=54;for(this.inner=new this.Hash().update(a),o=0;o<a.length;o++)a[o]^=106;this.outer=new this.Hash().update(a)},r.prototype.update=function(a,o){return this.inner.update(a,o),this},r.prototype.digest=function(a){return this.outer.update(this.inner.digest()),this.outer.digest(a)},P1}var Q4;function fI(){return Q4||(Q4=1,(function(e){var t=e;t.utils=qn(),t.common=cf(),t.sha=cI(),t.ripemd=uI(),t.hmac=dI(),t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160})(C1)),C1}var hI=fI();const mI=hv(hI);let pI="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",xI=(e,t=21)=>(r=t)=>{let s="",a=r|0;for(;a--;)s+=e[Math.random()*e.length|0];return s},gI=(e=21)=>{let t="",r=e|0;for(;r--;)t+=pI[Math.random()*64|0];return t};const Sr=e=>Math.floor(e*72*20),lm=(e=0)=>{let t=e;return()=>++t},yI=()=>lm(),vI=()=>lm(1),bI=()=>lm(),wI=()=>lm(),_I=()=>gI().toLowerCase(),ek=e=>mI.sha1().update(e instanceof ArrayBuffer?new Uint8Array(e):e).digest("hex"),ed=e=>xI("1234567890abcdef",e)(),NI=()=>`${ed(8)}-${ed(4)}-${ed(4)}-${ed(4)}-${ed(12)}`,SI={PAGE:"page"},kI={PAGE:"page"},EI=()=>new Rr({name:"wp:simplePos",attributes:{x:{key:"x",value:0},y:{key:"y",value:0}}}),Sj=e=>new Rr({name:"wp:align",children:[e]}),kj=e=>new Rr({name:"wp:posOffset",children:[e.toString()]}),jI=({relative:e,align:t,offset:r})=>new Rr({name:"wp:positionH",attributes:{relativeFrom:{key:"relativeFrom",value:e??SI.PAGE}},children:[(()=>{if(t)return Sj(t);if(r!==void 0)return kj(r);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]}),TI=({relative:e,align:t,offset:r})=>new Rr({name:"wp:positionV",attributes:{relativeFrom:{key:"relativeFrom",value:e??kI.PAGE}},children:[(()=>{if(t)return Sj(t);if(r!==void 0)return kj(r);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]});class AI extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{uri:"uri"})}}const CI=e=>new Rr({name:"asvg:svgBlip",attributes:{asvg:{key:"xmlns:asvg",value:"http://schemas.microsoft.com/office/drawing/2016/SVG/main"},embed:{key:"r:embed",value:`rId{${e.fileName}}`}}}),RI=e=>new Rr({name:"a:ext",attributes:{uri:{key:"uri",value:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"}},children:[CI(e)]}),DI=e=>new Rr({name:"a:extLst",children:[RI(e)]}),OI=e=>new Rr({name:"a:blip",attributes:{embed:{key:"r:embed",value:`rId{${e.type==="svg"?e.fallback.fileName:e.fileName}}`},cstate:{key:"cstate",value:"none"}},children:e.type==="svg"?[DI(e)]:[]});class FI extends Qe{constructor(){super("a:srcRect")}}class LI extends Qe{constructor(){super("a:fillRect")}}class II extends Qe{constructor(){super("a:stretch"),this.root.push(new LI)}}class MI extends Qe{constructor(t){super("pic:blipFill"),this.root.push(OI(t)),this.root.push(new FI),this.root.push(new II)}}class BI extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{noChangeAspect:"noChangeAspect",noChangeArrowheads:"noChangeArrowheads"})}}class PI extends Qe{constructor(){super("a:picLocks"),this.root.push(new BI({noChangeAspect:1,noChangeArrowheads:1}))}}class UI extends Qe{constructor(){super("pic:cNvPicPr"),this.root.push(new PI)}}const Ej=(e,t)=>new Rr({name:"a:hlinkClick",attributes:Ni(rr({},t?{xmlns:{key:"xmlns:a",value:"http://schemas.openxmlformats.org/drawingml/2006/main"}}:{}),{id:{key:"r:id",value:`rId${e}`}})});class zI extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{id:"id",name:"name",descr:"descr"})}}class $I extends Qe{constructor(){super("pic:cNvPr"),this.root.push(new zI({id:0,name:"",descr:""}))}prepForXml(t){for(let r=t.stack.length-1;r>=0;r--){const s=t.stack[r];if(s instanceof Ev){this.root.push(Ej(s.linkId,!1));break}}return super.prepForXml(t)}}class qI extends Qe{constructor(){super("pic:nvPicPr"),this.root.push(new $I),this.root.push(new UI)}}class HI extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{xmlns:"xmlns:pic"})}}class WI extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{cx:"cx",cy:"cy"})}}class GI extends Qe{constructor(t,r){super("a:ext"),Je(this,"attributes"),this.attributes=new WI({cx:t,cy:r}),this.root.push(this.attributes)}}class VI extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{x:"x",y:"y"})}}class KI extends Qe{constructor(){super("a:off"),this.root.push(new VI({x:0,y:0}))}}class XI extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{flipVertical:"flipV",flipHorizontal:"flipH",rotation:"rot"})}}class YI extends Qe{constructor(t){var r,s;super("a:xfrm"),Je(this,"extents"),this.root.push(new XI({flipVertical:(r=t.flip)==null?void 0:r.vertical,flipHorizontal:(s=t.flip)==null?void 0:s.horizontal,rotation:t.rotation})),this.extents=new GI(t.emus.x,t.emus.y),this.root.push(new KI),this.root.push(this.extents)}}const jj=()=>new Rr({name:"a:noFill"}),JI=e=>new Rr({name:"a:srgbClr",attributes:{value:{key:"val",value:e.value}}}),ZI=e=>new Rr({name:"a:schemeClr",attributes:{value:{key:"val",value:e.value}}}),tk=e=>new Rr({name:"a:solidFill",children:[e.type==="rgb"?JI(e):ZI(e)]}),QI=e=>new Rr({name:"a:ln",attributes:{width:{key:"w",value:e.width},cap:{key:"cap",value:e.cap},compoundLine:{key:"cmpd",value:e.compoundLine},align:{key:"algn",value:e.align}},children:[e.type==="noFill"?jj():e.solidFillType==="rgb"?tk({type:"rgb",value:e.value}):tk({type:"scheme",value:e.value})]});class eM extends Qe{constructor(){super("a:avLst")}}class tM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{prst:"prst"})}}class rM extends Qe{constructor(){super("a:prstGeom"),this.root.push(new tM({prst:"rect"})),this.root.push(new eM)}}class sM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{bwMode:"bwMode"})}}class aM extends Qe{constructor({outline:t,transform:r}){super("pic:spPr"),Je(this,"form"),this.root.push(new sM({bwMode:"auto"})),this.form=new YI(r),this.root.push(this.form),this.root.push(new rM),t&&(this.root.push(jj()),this.root.push(QI(t)))}}class nM extends Qe{constructor({mediaData:t,transform:r,outline:s}){super("pic:pic"),this.root.push(new HI({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.root.push(new qI),this.root.push(new MI(t)),this.root.push(new aM({transform:r,outline:s}))}}class iM extends Qe{constructor({mediaData:t,transform:r,outline:s}){super("a:graphicData"),Je(this,"pic"),this.root.push(new AI({uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.pic=new nM({mediaData:t,transform:r,outline:s}),this.root.push(this.pic)}}class oM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{a:"xmlns:a"})}}class Tj extends Qe{constructor({mediaData:t,transform:r,outline:s}){super("a:graphic"),Je(this,"data"),this.root.push(new oM({a:"http://schemas.openxmlformats.org/drawingml/2006/main"})),this.data=new iM({mediaData:t,transform:r,outline:s}),this.root.push(this.data)}}const Wh={NONE:0,SQUARE:1,TIGHT:2,TOP_AND_BOTTOM:3},lM={BOTH_SIDES:"bothSides"};class rk extends Qe{constructor(){super("wp:wrapNone")}}class cM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",wrapText:"wrapText"})}}class uM extends Qe{constructor(t,r={top:0,bottom:0,left:0,right:0}){super("wp:wrapSquare"),this.root.push(new cM({wrapText:t.side||lM.BOTH_SIDES,distT:r.top,distB:r.bottom,distL:r.left,distR:r.right}))}}class dM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{distT:"distT",distB:"distB"})}}class fM extends Qe{constructor(t={top:0,bottom:0}){super("wp:wrapTight"),this.root.push(new dM({distT:t.top,distB:t.bottom}))}}class hM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{distT:"distT",distB:"distB"})}}class mM extends Qe{constructor(t={top:0,bottom:0}){super("wp:wrapTopAndBottom"),this.root.push(new hM({distT:t.top,distB:t.bottom}))}}class Aj extends Qe{constructor({name:t,description:r,title:s}={name:"",description:"",title:""}){super("wp:docPr"),Je(this,"docPropertiesUniqueNumericId",bI());const a={id:{key:"id",value:this.docPropertiesUniqueNumericId()},name:{key:"name",value:t}};r!=null&&(a.description={key:"descr",value:r}),s!=null&&(a.title={key:"title",value:s}),this.root.push(new Ai(a))}prepForXml(t){for(let r=t.stack.length-1;r>=0;r--){const s=t.stack[r];if(s instanceof Ev){this.root.push(Ej(s.linkId,!0));break}}return super.prepForXml(t)}}const Cj=({top:e,right:t,bottom:r,left:s})=>new Rr({name:"wp:effectExtent",attributes:{top:{key:"t",value:e},right:{key:"r",value:t},bottom:{key:"b",value:r},left:{key:"l",value:s}}}),Rj=({x:e,y:t})=>new Rr({name:"wp:extent",attributes:{x:{key:"cx",value:e},y:{key:"cy",value:t}}});class pM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{xmlns:"xmlns:a",noChangeAspect:"noChangeAspect"})}}class xM extends Qe{constructor(){super("a:graphicFrameLocks"),this.root.push(new pM({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:1}))}}const Dj=()=>new Rr({name:"wp:cNvGraphicFramePr",children:[new xM]});class gM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",allowOverlap:"allowOverlap",behindDoc:"behindDoc",layoutInCell:"layoutInCell",locked:"locked",relativeHeight:"relativeHeight",simplePos:"simplePos"})}}class yM extends Qe{constructor({mediaData:t,transform:r,drawingOptions:s}){super("wp:anchor");const a=rr({allowOverlap:!0,behindDocument:!1,lockAnchor:!1,layoutInCell:!0,verticalPosition:{},horizontalPosition:{}},s.floating);if(this.root.push(new gM({distT:a.margins&&a.margins.top||0,distB:a.margins&&a.margins.bottom||0,distL:a.margins&&a.margins.left||0,distR:a.margins&&a.margins.right||0,simplePos:"0",allowOverlap:a.allowOverlap===!0?"1":"0",behindDoc:a.behindDocument===!0?"1":"0",locked:a.lockAnchor===!0?"1":"0",layoutInCell:a.layoutInCell===!0?"1":"0",relativeHeight:a.zIndex?a.zIndex:r.emus.y})),this.root.push(EI()),this.root.push(jI(a.horizontalPosition)),this.root.push(TI(a.verticalPosition)),this.root.push(Rj({x:r.emus.x,y:r.emus.y})),this.root.push(Cj({top:0,right:0,bottom:0,left:0})),s.floating!==void 0&&s.floating.wrap!==void 0)switch(s.floating.wrap.type){case Wh.SQUARE:this.root.push(new uM(s.floating.wrap,s.floating.margins));break;case Wh.TIGHT:this.root.push(new fM(s.floating.margins));break;case Wh.TOP_AND_BOTTOM:this.root.push(new mM(s.floating.margins));break;case Wh.NONE:default:this.root.push(new rk)}else this.root.push(new rk);this.root.push(new Aj(s.docProperties)),this.root.push(Dj()),this.root.push(new Tj({mediaData:t,transform:r,outline:s.outline}))}}const vM=({mediaData:e,transform:t,docProperties:r,outline:s})=>{var a,o,l,u;return new Rr({name:"wp:inline",attributes:{distanceTop:{key:"distT",value:0},distanceBottom:{key:"distB",value:0},distanceLeft:{key:"distL",value:0},distanceRight:{key:"distR",value:0}},children:[Rj({x:t.emus.x,y:t.emus.y}),Cj(s?{top:((a=s.width)!=null?a:9525)*2,right:((o=s.width)!=null?o:9525)*2,bottom:((l=s.width)!=null?l:9525)*2,left:((u=s.width)!=null?u:9525)*2}:{top:0,right:0,bottom:0,left:0}),new Aj(r),Dj(),new Tj({mediaData:e,transform:t,outline:s})]})};class bM extends Qe{constructor(t,r={}){super("w:drawing"),r.floating?this.root.push(new yM({mediaData:t,transform:t.transformation,drawingOptions:r})):this.root.push(vM({mediaData:t,transform:t.transformation,docProperties:r.docProperties,outline:r.outline}))}}const wM=e=>{if(typeof atob=="function"){const t=";base64,",r=e.indexOf(t),s=r===-1?0:r+t.length;return new Uint8Array(atob(e.substring(s)).split("").map(a=>a.charCodeAt(0)))}else{const t=require("buffer");return new t.Buffer(e,"base64")}},_M=e=>typeof e=="string"?wM(e):e,U1=(e,t)=>({data:_M(e.data),fileName:t,transformation:{pixels:{x:Math.round(e.transformation.width),y:Math.round(e.transformation.height)},emus:{x:Math.round(e.transformation.width*9525),y:Math.round(e.transformation.height*9525)},flip:e.transformation.flip,rotation:e.transformation.rotation?e.transformation.rotation*6e4:void 0}});class sk extends of{constructor(t){super({}),Je(this,"imageData");const s=`${ek(t.data)}.${t.type}`;this.imageData=t.type==="svg"?Ni(rr({type:t.type},U1(t,s)),{fallback:rr({type:t.fallback.type},U1(Ni(rr({},t.fallback),{transformation:t.transformation}),`${ek(t.fallback.data)}.${t.fallback.type}`))}):rr({type:t.type},U1(t,s));const a=new bM(this.imageData,{floating:t.floating,docProperties:t.altText,outline:t.outline});this.root.push(a)}prepForXml(t){return t.file.Media.addImage(this.imageData.fileName,this.imageData),this.imageData.type==="svg"&&t.file.Media.addImage(this.imageData.fallback.fileName,this.imageData.fallback),super.prepForXml(t)}}class NM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{xmlns:"xmlns"})}}class SM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}}const kM={EXTERNAL:"External"};class EM extends Qe{constructor(t,r,s,a){super("Relationship"),this.root.push(new SM({id:t,type:r,target:s,targetMode:a}))}}class _l extends Qe{constructor(){super("Relationships"),this.root.push(new NM({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(t,r,s,a){const o=new EM(`rId${t}`,r,s,a);return this.root.push(o),o}get RelationshipCount(){return this.root.length-1}}class jM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}}class TM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}}class AM extends Qe{constructor({id:t,initials:r,author:s,date:a=new Date,children:o}){super("w:comment"),this.root.push(new jM({id:t,initials:r,author:s,date:a.toISOString()}));for(const l of o)this.root.push(l)}}class CM extends Qe{constructor({children:t}){super("w:comments"),Je(this,"relationships"),this.root.push(new TM({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(const r of t)this.root.push(new AM(r));this.relationships=new _l}get Relationships(){return this.relationships}}class RM extends Qe{constructor(){super("w:pageBreakBefore")}}const Fy={AUTO:"auto"};class DM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule",beforeAutoSpacing:"w:beforeAutospacing",afterAutoSpacing:"w:afterAutospacing"})}}class OM extends Qe{constructor(t){super("w:spacing"),this.root.push(new DM(t))}}let Gh=class extends Qe{constructor(t){super("w:pStyle"),this.root.push(new cs({val:t}))}};class FM extends Qe{constructor(t){super("w:tabs");for(const r of t)this.root.push(new IM(r))}}const ak={LEFT:"left",RIGHT:"right"};class LM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}}class IM extends Qe{constructor({type:t,position:r,leader:s}){super("w:tab"),this.root.push(new LM({val:t,pos:r,leader:s}))}}class z1 extends Qe{constructor(t,r){super("w:numPr"),this.root.push(new MM(r)),this.root.push(new BM(t))}}class MM extends Qe{constructor(t){if(super("w:ilvl"),t>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new cs({val:t}))}}class BM extends Qe{constructor(t){super("w:numId"),this.root.push(new cs({val:typeof t=="string"?`{${t}}`:t}))}}class Oj extends Qe{constructor(){super(...arguments),Je(this,"fileChild",Symbol())}}class PM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}}class Ev extends Qe{constructor(t,r,s){super("w:hyperlink"),Je(this,"linkId"),this.linkId=r;const a={history:1,anchor:s||void 0,id:s?void 0:`rId${this.linkId}`},o=new PM(a);this.root.push(o),t.forEach(l=>{this.root.push(l)})}}class UM extends Qe{constructor(t){super("w:externalHyperlink"),this.options=t}}class zM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{id:"w:id",name:"w:name"})}}class $M extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{id:"w:id"})}}class qM{constructor(t){Je(this,"bookmarkUniqueNumericId",wI()),Je(this,"start"),Je(this,"children"),Je(this,"end");const r=this.bookmarkUniqueNumericId();this.start=new HM(t.id,r),this.children=t.children,this.end=new WM(r)}}class HM extends Qe{constructor(t,r){super("w:bookmarkStart");const s=new zM({name:t,id:r});this.root.push(s)}}class WM extends Qe{constructor(t){super("w:bookmarkEnd");const r=new $M({id:t});this.root.push(r)}}class GM extends Qe{constructor(t){super("w:outlineLvl"),this.level=t,this.root.push(new cs({val:t}))}}const VM={TOP:"top",CENTER:"center",BOTTOM:"bottom"};Ni(rr({},VM),{BOTH:"both"});class KM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{verticalAlign:"w:val"})}}class Fj extends Qe{constructor(t){super("w:vAlign"),this.root.push(new KM({verticalAlign:t}))}}class XM extends Qe{constructor({space:t,count:r,separate:s,equalWidth:a,children:o}){super("w:cols"),this.root.push(new Ai({space:{key:"w:space",value:t===void 0?void 0:Xs(t)},count:{key:"w:num",value:r===void 0?void 0:oa(r)},separate:{key:"w:sep",value:s},equalWidth:{key:"w:equalWidth",value:a}})),!a&&o&&o.forEach(l=>this.addChildElement(l))}}const YM=({type:e,linePitch:t,charSpace:r})=>new Rr({name:"w:docGrid",attributes:{type:{key:"w:type",value:e},linePitch:{key:"w:linePitch",value:oa(t)},charSpace:{key:"w:charSpace",value:r?oa(r):void 0}}}),Lc={DEFAULT:"default",FIRST:"first",EVEN:"even"};class JM extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{type:"w:type",id:"r:id"})}}const nk={HEADER:"w:headerReference",FOOTER:"w:footerReference"};class $1 extends Qe{constructor(t,r){super(t),this.root.push(new JM({type:r.type||Lc.DEFAULT,id:`rId${r.id}`}))}}const ZM=({countBy:e,start:t,restart:r,distance:s})=>new Rr({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:e===void 0?void 0:oa(e)},start:{key:"w:start",value:t===void 0?void 0:oa(t)},restart:{key:"w:restart",value:r},distance:{key:"w:distance",value:s===void 0?void 0:Xs(s)}}});class ik extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}}class QM extends Ti{constructor(t){if(super("w:pgBorders"),!t)return this;t.pageBorders?this.root.push(new ik({display:t.pageBorders.display,offsetFrom:t.pageBorders.offsetFrom,zOrder:t.pageBorders.zOrder})):this.root.push(new ik({})),t.pageBorderTop&&this.root.push(new Ir("w:top",t.pageBorderTop)),t.pageBorderLeft&&this.root.push(new Ir("w:left",t.pageBorderLeft)),t.pageBorderBottom&&this.root.push(new Ir("w:bottom",t.pageBorderBottom)),t.pageBorderRight&&this.root.push(new Ir("w:right",t.pageBorderRight))}}class eB extends Qe{constructor(t,r,s,a,o,l,u){super("w:pgMar"),this.root.push(new Ai({top:{key:"w:top",value:pi(t)},right:{key:"w:right",value:Xs(r)},bottom:{key:"w:bottom",value:pi(s)},left:{key:"w:left",value:Xs(a)},header:{key:"w:header",value:Xs(o)},footer:{key:"w:footer",value:Xs(l)},gutter:{key:"w:gutter",value:Xs(u)}}))}}class tB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}}class rB extends Qe{constructor({start:t,formatType:r,separator:s}){super("w:pgNumType"),this.root.push(new tB({start:t===void 0?void 0:oa(t),formatType:r,separator:s}))}}const Ly={PORTRAIT:"portrait",LANDSCAPE:"landscape"},sB=({width:e,height:t,orientation:r,code:s})=>{const a=Xs(e),o=Xs(t);return new Rr({name:"w:pgSz",attributes:{width:{key:"w:w",value:r===Ly.LANDSCAPE?o:a},height:{key:"w:h",value:r===Ly.LANDSCAPE?a:o},orientation:{key:"w:orient",value:r},code:{key:"w:code",value:s}}})};class aB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{val:"w:val"})}}class nB extends Qe{constructor(t){super("w:textDirection"),this.root.push(new aB({val:t}))}}class iB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{val:"w:val"})}}class oB extends Qe{constructor(t){super("w:type"),this.root.push(new iB({val:t}))}}const Wo={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},q1={WIDTH:11906,HEIGHT:16838,ORIENTATION:Ly.PORTRAIT};class lB extends Qe{constructor({page:{size:{width:t=q1.WIDTH,height:r=q1.HEIGHT,orientation:s=q1.ORIENTATION}={},margin:{top:a=Wo.TOP,right:o=Wo.RIGHT,bottom:l=Wo.BOTTOM,left:u=Wo.LEFT,header:d=Wo.HEADER,footer:h=Wo.FOOTER,gutter:m=Wo.GUTTER}={},pageNumbers:x={},borders:y,textDirection:v}={},grid:{linePitch:b=360,charSpace:g,type:_}={},headerWrapperGroup:w={},footerWrapperGroup:k={},lineNumbers:N,titlePage:E,verticalAlign:C,column:L,type:O}={}){super("w:sectPr"),this.addHeaderFooterGroup(nk.HEADER,w),this.addHeaderFooterGroup(nk.FOOTER,k),O&&this.root.push(new oB(O)),this.root.push(sB({width:t,height:r,orientation:s})),this.root.push(new eB(a,o,l,u,d,h,m)),y&&this.root.push(new QM(y)),N&&this.root.push(ZM(N)),this.root.push(new rB(x)),L&&this.root.push(new XM(L)),C&&this.root.push(new Fj(C)),E!==void 0&&this.root.push(new ht("w:titlePg",E)),v&&this.root.push(new nB(v)),this.root.push(YM({linePitch:b,charSpace:g,type:_}))}addHeaderFooterGroup(t,r){r.default&&this.root.push(new $1(t,{type:Lc.DEFAULT,id:r.default.View.ReferenceId})),r.first&&this.root.push(new $1(t,{type:Lc.FIRST,id:r.first.View.ReferenceId})),r.even&&this.root.push(new $1(t,{type:Lc.EVEN,id:r.even.View.ReferenceId}))}}class cB extends Qe{constructor(){super("w:body"),Je(this,"sections",[])}addSection(t){const r=this.sections.pop();this.root.push(this.createSectionParagraph(r)),this.sections.push(new lB(t))}prepForXml(t){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(t)}push(t){this.root.push(t)}createSectionParagraph(t){const r=new ot({}),s=new Kc({});return s.push(t),r.addChildElement(s),r}}const ok={wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"};class cm extends jt{constructor(t,r){super(rr({Ignorable:r},Object.fromEntries(t.map(s=>[s,ok[s]])))),Je(this,"xmlKeys",rr({Ignorable:"mc:Ignorable"},Object.fromEntries(Object.keys(ok).map(s=>[s,`xmlns:${s}`]))))}}class uB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}}class dB extends Qe{constructor(t){super("w:background"),this.root.push(new uB({color:t.color===void 0?void 0:Wc(t.color),themeColor:t.themeColor,themeShade:t.themeShade===void 0?void 0:B4(t.themeShade),themeTint:t.themeTint===void 0?void 0:B4(t.themeTint)}))}}class fB extends Qe{constructor(t){super("w:document"),Je(this,"body"),this.root.push(new cm(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps","cx","cx1","cx2","cx3","cx4","cx5","cx6","cx7","cx8","aink","am3d","w16cex","w16cid","w16","w16sdtdh","w16se"],"w14 w15 wp14")),this.body=new cB,t.background&&this.root.push(new dB(t.background)),this.root.push(this.body)}add(t){return this.body.push(t),this}get Body(){return this.body}}class Lj{constructor(t){Je(this,"document"),Je(this,"relationships"),this.document=new fB(t),this.relationships=new _l}get View(){return this.document}get Relationships(){return this.relationships}}class hB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{val:"w:val"})}}class mB extends Qe{constructor(){super("w:wordWrap"),this.root.push(new hB({val:0}))}}const pB=e=>{var t,r;return new Rr({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:e.anchorLock},dropCap:{key:"w:dropCap",value:e.dropCap},width:{key:"w:w",value:e.width},height:{key:"w:h",value:e.height},x:{key:"w:x",value:e.position?e.position.x:void 0},y:{key:"w:y",value:e.position?e.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:e.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:e.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(t=e.space)==null?void 0:t.horizontal},spaceVertical:{key:"w:vSpace",value:(r=e.space)==null?void 0:r.vertical},rule:{key:"w:hRule",value:e.rule},alignmentX:{key:"w:xAlign",value:e.alignment?e.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:e.alignment?e.alignment.y:void 0},lines:{key:"w:lines",value:e.lines},wrap:{key:"w:wrap",value:e.wrap}}})};class Kc extends Ti{constructor(t){var r,s;if(super("w:pPr"),Je(this,"numberingReferences",[]),!t)return this;t.heading&&this.push(new Gh(t.heading)),t.bullet&&this.push(new Gh("ListParagraph")),t.numbering&&!t.style&&!t.heading&&(t.numbering.custom||this.push(new Gh("ListParagraph"))),t.style&&this.push(new Gh(t.style)),t.keepNext!==void 0&&this.push(new ht("w:keepNext",t.keepNext)),t.keepLines!==void 0&&this.push(new ht("w:keepLines",t.keepLines)),t.pageBreakBefore&&this.push(new RM),t.frame&&this.push(pB(t.frame)),t.widowControl!==void 0&&this.push(new ht("w:widowControl",t.widowControl)),t.bullet&&this.push(new z1(1,t.bullet.level)),t.numbering?(this.numberingReferences.push({reference:t.numbering.reference,instance:(r=t.numbering.instance)!=null?r:0}),this.push(new z1(`${t.numbering.reference}-${(s=t.numbering.instance)!=null?s:0}`,t.numbering.level))):t.numbering===!1&&this.push(new z1(0,0)),t.border&&this.push(new BL(t.border)),t.thematicBreak&&this.push(new PL),t.shading&&this.push(new om(t.shading)),t.wordWrap&&this.push(new mB),t.overflowPunctuation&&this.push(new ht("w:overflowPunct",t.overflowPunctuation));const a=[...t.rightTabStop!==void 0?[{type:ak.RIGHT,position:t.rightTabStop}]:[],...t.tabStops?t.tabStops:[],...t.leftTabStop!==void 0?[{type:ak.LEFT,position:t.leftTabStop}]:[]];a.length>0&&this.push(new FM(a)),t.bidirectional!==void 0&&this.push(new ht("w:bidi",t.bidirectional)),t.spacing&&this.push(new OM(t.spacing)),t.indent&&this.push(new UL(t.indent)),t.contextualSpacing!==void 0&&this.push(new ht("w:contextualSpacing",t.contextualSpacing)),t.alignment&&this.push(new yj(t.alignment)),t.outlineLevel!==void 0&&this.push(new GM(t.outlineLevel)),t.suppressLineNumbers!==void 0&&this.push(new ht("w:suppressLineNumbers",t.suppressLineNumbers)),t.autoSpaceEastAsianText!==void 0&&this.push(new ht("w:autoSpaceDN",t.autoSpaceEastAsianText)),t.run&&this.push(new wl(t.run))}push(t){this.root.push(t)}prepForXml(t){if(t.viewWrapper instanceof Lj)for(const r of this.numberingReferences)t.file.Numbering.createConcreteNumberingInstance(r.reference,r.instance);return super.prepForXml(t)}}class ot extends Oj{constructor(t){if(super("w:p"),Je(this,"properties"),typeof t=="string")return this.properties=new Kc({}),this.root.push(this.properties),this.root.push(new Tt(t)),this;if(this.properties=new Kc(t),this.root.push(this.properties),t.text&&this.root.push(new Tt(t.text)),t.children)for(const r of t.children){if(r instanceof qM){this.root.push(r.start);for(const s of r.children)this.root.push(s);this.root.push(r.end);continue}this.root.push(r)}}prepForXml(t){for(const r of this.root)if(r instanceof UM){const s=this.root.indexOf(r),a=new Ev(r.options.children,_I());t.viewWrapper.Relationships.createRelationship(a.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",r.options.link,kM.EXTERNAL),this.root[s]=a}return super.prepForXml(t)}addRunToFront(t){return this.root.splice(1,0,t),this}}class xB extends Qe{constructor(t){super("w:tblGrid");for(const r of t)this.root.push(new gB(r))}}class gB extends Qe{constructor(t){super("w:gridCol"),t!==void 0&&this.root.push(new Ai({width:{key:"w:w",value:Xs(t)}}))}}const Ij={TABLE:"w:tblCellMar",TABLE_CELL:"w:tcMar"};class Mj extends Ti{constructor(t,{marginUnitType:r=Bt.DXA,top:s,left:a,bottom:o,right:l}){super(t),s!==void 0&&this.root.push(new el("w:top",{type:r,size:s})),a!==void 0&&this.root.push(new el("w:left",{type:r,size:a})),o!==void 0&&this.root.push(new el("w:bottom",{type:r,size:o})),l!==void 0&&this.root.push(new el("w:right",{type:r,size:l}))}}const Bt={AUTO:"auto",DXA:"dxa",PERCENTAGE:"pct"};class el extends Qe{constructor(t,{type:r=Bt.AUTO,size:s}){super(t);let a=s;r===Bt.PERCENTAGE&&typeof s=="number"&&(a=`${s}%`),this.root.push(new Ai({type:{key:"w:type",value:r},size:{key:"w:w",value:gj(a)}}))}}class yB extends Ti{constructor(t){super("w:tcBorders"),t.top&&this.root.push(new Ir("w:top",t.top)),t.start&&this.root.push(new Ir("w:start",t.start)),t.left&&this.root.push(new Ir("w:left",t.left)),t.bottom&&this.root.push(new Ir("w:bottom",t.bottom)),t.end&&this.root.push(new Ir("w:end",t.end)),t.right&&this.root.push(new Ir("w:right",t.right))}}class vB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{val:"w:val"})}}class bB extends Qe{constructor(t){super("w:gridSpan"),this.root.push(new vB({val:oa(t)}))}}const Bj={CONTINUE:"continue",RESTART:"restart"};class wB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{val:"w:val"})}}class lk extends Qe{constructor(t){super("w:vMerge"),this.root.push(new wB({val:t}))}}class _B extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{val:"w:val"})}}class NB extends Qe{constructor(t){super("w:textDirection"),this.root.push(new _B({val:t}))}}class SB extends Ti{constructor(t){super("w:tcPr"),t.width&&this.root.push(new el("w:tcW",t.width)),t.columnSpan&&this.root.push(new bB(t.columnSpan)),t.verticalMerge?this.root.push(new lk(t.verticalMerge)):t.rowSpan&&t.rowSpan>1&&this.root.push(new lk(Bj.RESTART)),t.borders&&this.root.push(new yB(t.borders)),t.shading&&this.root.push(new om(t.shading)),t.margins&&this.root.push(new Mj(Ij.TABLE_CELL,t.margins)),t.textDirection&&this.root.push(new NB(t.textDirection)),t.verticalAlign&&this.root.push(new Fj(t.verticalAlign))}}class gt extends Qe{constructor(t){super("w:tc"),this.options=t,this.root.push(new SB(t));for(const r of t.children)this.root.push(r)}prepForXml(t){return this.root[this.root.length-1]instanceof ot||this.root.push(new ot({})),super.prepForXml(t)}}const pc={style:nr.NONE,size:0,color:"auto"},xc={style:nr.SINGLE,size:4,color:"auto"};class Pj extends Qe{constructor(t){super("w:tblBorders"),t.top?this.root.push(new Ir("w:top",t.top)):this.root.push(new Ir("w:top",xc)),t.left?this.root.push(new Ir("w:left",t.left)):this.root.push(new Ir("w:left",xc)),t.bottom?this.root.push(new Ir("w:bottom",t.bottom)):this.root.push(new Ir("w:bottom",xc)),t.right?this.root.push(new Ir("w:right",t.right)):this.root.push(new Ir("w:right",xc)),t.insideHorizontal?this.root.push(new Ir("w:insideH",t.insideHorizontal)):this.root.push(new Ir("w:insideH",xc)),t.insideVertical?this.root.push(new Ir("w:insideV",t.insideVertical)):this.root.push(new Ir("w:insideV",xc))}}Je(Pj,"NONE",{top:pc,bottom:pc,left:pc,right:pc,insideHorizontal:pc,insideVertical:pc});class kB extends Qe{constructor({horizontalAnchor:t,verticalAnchor:r,absoluteHorizontalPosition:s,relativeHorizontalPosition:a,absoluteVerticalPosition:o,relativeVerticalPosition:l,bottomFromText:u,topFromText:d,leftFromText:h,rightFromText:m,overlap:x}){super("w:tblpPr"),this.root.push(new Ai({leftFromText:{key:"w:leftFromText",value:h===void 0?void 0:Xs(h)},rightFromText:{key:"w:rightFromText",value:m===void 0?void 0:Xs(m)},topFromText:{key:"w:topFromText",value:d===void 0?void 0:Xs(d)},bottomFromText:{key:"w:bottomFromText",value:u===void 0?void 0:Xs(u)},absoluteHorizontalPosition:{key:"w:tblpX",value:s===void 0?void 0:pi(s)},absoluteVerticalPosition:{key:"w:tblpY",value:o===void 0?void 0:pi(o)},horizontalAnchor:{key:"w:horzAnchor",value:t===void 0?void 0:t},relativeHorizontalPosition:{key:"w:tblpXSpec",value:a},relativeVerticalPosition:{key:"w:tblpYSpec",value:l},verticalAnchor:{key:"w:vertAnchor",value:r}})),x&&this.root.push(new LL("w:tblOverlap",x))}}class EB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{type:"w:type"})}}class jB extends Qe{constructor(t){super("w:tblLayout"),this.root.push(new EB({type:t}))}}const TB={DXA:"dxa"};class Uj extends Qe{constructor({type:t=TB.DXA,value:r}){super("w:tblCellSpacing"),this.root.push(new Ai({type:{key:"w:type",value:t},value:{key:"w:w",value:gj(r)}}))}}class AB extends Ti{constructor(t){super("w:tblPr"),t.style&&this.root.push(new rl("w:tblStyle",t.style)),t.float&&this.root.push(new kB(t.float)),t.visuallyRightToLeft!==void 0&&this.root.push(new ht("w:bidiVisual",t.visuallyRightToLeft)),t.width&&this.root.push(new el("w:tblW",t.width)),t.alignment&&this.root.push(new yj(t.alignment)),t.indent&&this.root.push(new el("w:tblInd",t.indent)),t.borders&&this.root.push(new Pj(t.borders)),t.shading&&this.root.push(new om(t.shading)),t.layout&&this.root.push(new jB(t.layout)),t.cellMargin&&this.root.push(new Mj(Ij.TABLE,t.cellMargin)),t.cellSpacing&&this.root.push(new Uj(t.cellSpacing))}}class Sa extends Oj{constructor({rows:t,width:r,columnWidths:s=Array(Math.max(...t.map(v=>v.CellCount))).fill(100),margins:a,indent:o,float:l,layout:u,style:d,borders:h,alignment:m,visuallyRightToLeft:x,cellSpacing:y}){super("w:tbl"),this.root.push(new AB({borders:h??{},width:r??{size:100},indent:o,float:l,layout:u,style:d,alignment:m,cellMargin:a,visuallyRightToLeft:x,cellSpacing:y})),this.root.push(new xB(s));for(const v of t)this.root.push(v);t.forEach((v,b)=>{if(b===t.length-1)return;let g=0;v.cells.forEach(_=>{if(_.options.rowSpan&&_.options.rowSpan>1){const w=new gt({rowSpan:_.options.rowSpan-1,columnSpan:_.options.columnSpan,borders:_.options.borders,children:[],verticalMerge:Bj.CONTINUE});t[b+1].addCellToColumnIndex(w,g)}g+=_.options.columnSpan||1})})}}class CB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{value:"w:val",rule:"w:hRule"})}}class RB extends Qe{constructor(t,r){super("w:trHeight"),this.root.push(new CB({value:Xs(t),rule:r}))}}class DB extends Ti{constructor(t){super("w:trPr"),t.cantSplit!==void 0&&this.root.push(new ht("w:cantSplit",t.cantSplit)),t.tableHeader!==void 0&&this.root.push(new ht("w:tblHeader",t.tableHeader)),t.height&&this.root.push(new RB(t.height.value,t.height.rule)),t.cellSpacing&&this.root.push(new Uj(t.cellSpacing))}}class pr extends Qe{constructor(t){super("w:tr"),this.options=t,this.root.push(new DB(t));for(const r of t.children)this.root.push(r)}get CellCount(){return this.options.children.length}get cells(){return this.root.filter(t=>t instanceof gt)}addCellToIndex(t,r){this.root.splice(r+1,0,t)}addCellToColumnIndex(t,r){const s=this.columnIndexToRootIndex(r,!0);this.addCellToIndex(t,s-1)}rootIndexToColumnIndex(t){if(t<1||t>=this.root.length)throw new Error(`cell 'rootIndex' should between 1 to ${this.root.length-1}`);let r=0;for(let s=1;s<t;s++){const a=this.root[s];r+=a.options.columnSpan||1}return r}columnIndexToRootIndex(t,r=!1){if(t<0)throw new Error("cell 'columnIndex' should not less than zero");let s=0,a=1;for(;s<=t;){if(a>=this.root.length){if(r)return this.root.length;throw new Error(`cell 'columnIndex' should not great than ${s-1}`)}const o=this.root[a];a+=1,s+=o&&o.options.columnSpan||1}return a-1}}class OB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class FB extends Qe{constructor(){super("Properties"),this.root.push(new OB({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class LB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{xmlns:"xmlns"})}}class IB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}}class ui extends Qe{constructor(t,r){super("Default"),this.root.push(new IB({contentType:t,extension:r}))}}class MB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}}class sn extends Qe{constructor(t,r){super("Override"),this.root.push(new MB({contentType:t,partName:r}))}}class BB extends Qe{constructor(){super("Types"),this.root.push(new LB({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new ui("image/png","png")),this.root.push(new ui("image/jpeg","jpeg")),this.root.push(new ui("image/jpeg","jpg")),this.root.push(new ui("image/bmp","bmp")),this.root.push(new ui("image/gif","gif")),this.root.push(new ui("image/svg+xml","svg")),this.root.push(new ui("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new ui("application/xml","xml")),this.root.push(new ui("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new sn("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new sn("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new sn("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new sn("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new sn("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new sn("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new sn("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new sn("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new sn("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new sn("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(t){this.root.push(new sn("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${t}.xml`))}addHeader(t){this.root.push(new sn("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${t}.xml`))}}class PB extends Qe{constructor(t){super("cp:coreProperties"),this.root.push(new cm(["cp","dc","dcterms","dcmitype","xsi"])),t.title&&this.root.push(new qo("dc:title",t.title)),t.subject&&this.root.push(new qo("dc:subject",t.subject)),t.creator&&this.root.push(new qo("dc:creator",t.creator)),t.keywords&&this.root.push(new qo("cp:keywords",t.keywords)),t.description&&this.root.push(new qo("dc:description",t.description)),t.lastModifiedBy&&this.root.push(new qo("cp:lastModifiedBy",t.lastModifiedBy)),t.revision&&this.root.push(new qo("cp:revision",String(t.revision))),this.root.push(new ck("dcterms:created")),this.root.push(new ck("dcterms:modified"))}}class UB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{type:"xsi:type"})}}class ck extends Qe{constructor(t){super(t),this.root.push(new UB({type:"dcterms:W3CDTF"})),this.root.push(FL(new Date))}}class zB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class $B extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}}class qB extends Qe{constructor(t,r){super("property"),this.root.push(new $B({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t.toString(),name:r.name})),this.root.push(new HB(r.value))}}class HB extends Qe{constructor(t){super("vt:lpwstr"),this.root.push(t)}}class WB extends Qe{constructor(t){super("Properties"),Je(this,"nextId"),Je(this,"properties",[]),this.root.push(new zB({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const r of t)this.addCustomProperty(r)}prepForXml(t){return this.properties.forEach(r=>this.root.push(r)),super.prepForXml(t)}addCustomProperty(t){this.properties.push(new qB(this.nextId++,t))}}const Vh=({id:e,fontKey:t,subsetted:r},s)=>new Rr({name:s,attributes:rr({id:{key:"r:id",value:e}},t?{fontKey:{key:"w:fontKey",value:`{${t}}`}}:{}),children:[...r?[new ht("w:subsetted",r)]:[]]}),GB=({name:e,altName:t,panose1:r,charset:s,family:a,notTrueType:o,pitch:l,sig:u,embedRegular:d,embedBold:h,embedItalic:m,embedBoldItalic:x})=>new Rr({name:"w:font",attributes:{name:{key:"w:name",value:e}},children:[...t?[Qu("w:altName",t)]:[],...r?[Qu("w:panose1",r)]:[],...s?[Qu("w:charset",s)]:[],Qu("w:family",a),...o?[new ht("w:notTrueType",o)]:[],Qu("w:pitch",l),...u?[new Rr({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:u.usb0},usb1:{key:"w:usb1",value:u.usb1},usb2:{key:"w:usb2",value:u.usb2},usb3:{key:"w:usb3",value:u.usb3},csb0:{key:"w:csb0",value:u.csb0},csb1:{key:"w:csb1",value:u.csb1}}})]:[],...d?[Vh(d,"w:embedRegular")]:[],...h?[Vh(h,"w:embedBold")]:[],...m?[Vh(m,"w:embedItalic")]:[],...x?[Vh(x,"w:embedBoldItalic")]:[]]}),VB=({name:e,index:t,fontKey:r,characterSet:s})=>GB({name:e,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:s,family:"auto",pitch:"variable",embedRegular:{fontKey:r,id:`rId${t}`}}),KB=e=>new Rr({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:e.map((t,r)=>VB({name:t.name,index:r+1,fontKey:t.fontKey}))});class XB{constructor(t){Je(this,"fontTable"),Je(this,"relationships"),Je(this,"fontOptionsWithKey",[]),this.options=t,this.fontOptionsWithKey=t.map(r=>Ni(rr({},r),{fontKey:NI()})),this.fontTable=KB(this.fontOptionsWithKey),this.relationships=new _l;for(let r=0;r<t.length;r++)this.relationships.createRelationship(r+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${t[r].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}}class YB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}}let JB=class extends mj{constructor(t,r){super("w:ftr",r),Je(this,"refId"),this.refId=t,r||this.root.push(new YB({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(t){this.root.push(t)}};class ZB{constructor(t,r,s){Je(this,"footer"),Je(this,"relationships"),this.media=t,this.footer=new JB(r,s),this.relationships=new _l}add(t){this.footer.add(t)}addChildElement(t){this.footer.addChildElement(t)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class QB extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{type:"w:type",id:"w:id"})}}class eP extends Qe{constructor(){super("w:footnoteRef")}}class tP extends of{constructor(){super({style:"FootnoteReference"}),this.root.push(new eP)}}const uk={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"};class H1 extends Qe{constructor(t){super("w:footnote"),this.root.push(new QB({type:t.type,id:t.id}));for(let r=0;r<t.children.length;r++){const s=t.children[r];r===0&&s.addRunToFront(new tP),this.root.push(s)}}}class rP extends Qe{constructor(){super("w:continuationSeparator")}}class sP extends of{constructor(){super({}),this.root.push(new rP)}}class aP extends Qe{constructor(){super("w:separator")}}class nP extends of{constructor(){super({}),this.root.push(new aP)}}class iP extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class oP extends Qe{constructor(){super("w:footnotes"),this.root.push(new iP({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const t=new H1({id:-1,type:uk.SEPERATOR,children:[new ot({spacing:{after:0,line:240,lineRule:Fy.AUTO},children:[new nP]})]});this.root.push(t);const r=new H1({id:0,type:uk.CONTINUATION_SEPERATOR,children:[new ot({spacing:{after:0,line:240,lineRule:Fy.AUTO},children:[new sP]})]});this.root.push(r)}createFootNote(t,r){const s=new H1({id:t,children:r});this.root.push(s)}}class lP{constructor(){Je(this,"footnotess"),Je(this,"relationships"),this.footnotess=new oP,this.relationships=new _l}get View(){return this.footnotess}get Relationships(){return this.relationships}}class cP extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}}let uP=class extends mj{constructor(t,r){super("w:hdr",r),Je(this,"refId"),this.refId=t,r||this.root.push(new cP({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(t){this.root.push(t)}};class dP{constructor(t,r,s){Je(this,"header"),Je(this,"relationships"),this.media=t,this.header=new uP(r,s),this.relationships=new _l}add(t){return this.header.add(t),this}addChildElement(t){this.header.addChildElement(t)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class fP{constructor(){Je(this,"map"),this.map=new Map}addImage(t,r){this.map.set(t,r)}get Array(){return Array.from(this.map.values())}}const di={BULLET:"bullet"};class hP extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}}class mP extends Qe{constructor(t){super("w:numFmt"),this.root.push(new cs({val:t}))}}class pP extends Qe{constructor(t){super("w:lvlText"),this.root.push(new cs({val:t}))}}class xP extends Qe{constructor(t){super("w:lvlJc"),this.root.push(new cs({val:t}))}}class gP extends Qe{constructor(t){super("w:suff"),this.root.push(new cs({val:t}))}}class yP extends Qe{constructor(){super("w:isLgl")}}class vP extends Qe{constructor({level:t,format:r,text:s,alignment:a=Dt.START,start:o=1,style:l,suffix:u,isLegalNumberingStyle:d}){if(super("w:lvl"),Je(this,"paragraphProperties"),Je(this,"runProperties"),this.root.push(new pd("w:start",oa(o))),r&&this.root.push(new mP(r)),u&&this.root.push(new gP(u)),d&&this.root.push(new yP),s&&this.root.push(new pP(s)),this.root.push(new xP(a)),this.paragraphProperties=new Kc(l&&l.paragraph),this.runProperties=new wl(l&&l.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),t>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new hP({ilvl:oa(t),tentative:1}))}}class bP extends vP{}class wP extends Qe{constructor(t){super("w:multiLevelType"),this.root.push(new cs({val:t}))}}class _P extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}}class dk extends Qe{constructor(t,r){super("w:abstractNum"),Je(this,"id"),this.root.push(new _P({abstractNumId:oa(t),restartNumberingAfterBreak:0})),this.root.push(new wP("hybridMultilevel")),this.id=t;for(const s of r)this.root.push(new bP(s))}}class NP extends Qe{constructor(t){super("w:abstractNumId"),this.root.push(new cs({val:t}))}}class SP extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{numId:"w:numId"})}}class fk extends Qe{constructor(t){if(super("w:num"),Je(this,"numId"),Je(this,"reference"),Je(this,"instance"),this.numId=t.numId,this.reference=t.reference,this.instance=t.instance,this.root.push(new SP({numId:oa(t.numId)})),this.root.push(new NP(oa(t.abstractNumId))),t.overrideLevels&&t.overrideLevels.length)for(const r of t.overrideLevels)this.root.push(new EP(r.num,r.start))}}class kP extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{ilvl:"w:ilvl"})}}class EP extends Qe{constructor(t,r){super("w:lvlOverride"),this.root.push(new kP({ilvl:t})),r!==void 0&&this.root.push(new TP(r))}}class jP extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{val:"w:val"})}}class TP extends Qe{constructor(t){super("w:startOverride"),this.root.push(new jP({val:t}))}}class AP extends Qe{constructor(t){super("w:numbering"),Je(this,"abstractNumberingMap",new Map),Je(this,"concreteNumberingMap",new Map),Je(this,"referenceConfigMap",new Map),Je(this,"abstractNumUniqueNumericId",yI()),Je(this,"concreteNumUniqueNumericId",vI()),this.root.push(new cm(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps"],"w14 w15 wp14"));const r=new dk(this.abstractNumUniqueNumericId(),[{level:0,format:di.BULLET,text:"",alignment:Dt.LEFT,style:{paragraph:{indent:{left:Sr(.5),hanging:Sr(.25)}}}},{level:1,format:di.BULLET,text:"",alignment:Dt.LEFT,style:{paragraph:{indent:{left:Sr(1),hanging:Sr(.25)}}}},{level:2,format:di.BULLET,text:"",alignment:Dt.LEFT,style:{paragraph:{indent:{left:2160,hanging:Sr(.25)}}}},{level:3,format:di.BULLET,text:"",alignment:Dt.LEFT,style:{paragraph:{indent:{left:2880,hanging:Sr(.25)}}}},{level:4,format:di.BULLET,text:"",alignment:Dt.LEFT,style:{paragraph:{indent:{left:3600,hanging:Sr(.25)}}}},{level:5,format:di.BULLET,text:"",alignment:Dt.LEFT,style:{paragraph:{indent:{left:4320,hanging:Sr(.25)}}}},{level:6,format:di.BULLET,text:"",alignment:Dt.LEFT,style:{paragraph:{indent:{left:5040,hanging:Sr(.25)}}}},{level:7,format:di.BULLET,text:"",alignment:Dt.LEFT,style:{paragraph:{indent:{left:5760,hanging:Sr(.25)}}}},{level:8,format:di.BULLET,text:"",alignment:Dt.LEFT,style:{paragraph:{indent:{left:6480,hanging:Sr(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new fk({numId:1,abstractNumId:r.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",r);for(const s of t.config)this.abstractNumberingMap.set(s.reference,new dk(this.abstractNumUniqueNumericId(),s.levels)),this.referenceConfigMap.set(s.reference,s.levels)}prepForXml(t){for(const r of this.abstractNumberingMap.values())this.root.push(r);for(const r of this.concreteNumberingMap.values())this.root.push(r);return super.prepForXml(t)}createConcreteNumberingInstance(t,r){const s=this.abstractNumberingMap.get(t);if(!s)return;const a=`${t}-${r}`;if(this.concreteNumberingMap.has(a))return;const o=this.referenceConfigMap.get(t),l=o&&o[0].start,u={numId:this.concreteNumUniqueNumericId(),abstractNumId:s.id,reference:t,instance:r,overrideLevels:[l&&Number.isInteger(l)?{num:0,start:l}:{num:0,start:1}]};this.concreteNumberingMap.set(a,new fk(u))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class CP extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}}class RP extends Qe{constructor(t){super("w:compatSetting"),this.root.push(new CP({version:t,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class DP extends Qe{constructor(t){super("w:compat"),t.version&&this.root.push(new RP(t.version)),t.useSingleBorderforContiguousCells&&this.root.push(new ht("w:useSingleBorderforContiguousCells",t.useSingleBorderforContiguousCells)),t.wordPerfectJustification&&this.root.push(new ht("w:wpJustification",t.wordPerfectJustification)),t.noTabStopForHangingIndent&&this.root.push(new ht("w:noTabHangInd",t.noTabStopForHangingIndent)),t.noLeading&&this.root.push(new ht("w:noLeading",t.noLeading)),t.spaceForUnderline&&this.root.push(new ht("w:spaceForUL",t.spaceForUnderline)),t.noColumnBalance&&this.root.push(new ht("w:noColumnBalance",t.noColumnBalance)),t.balanceSingleByteDoubleByteWidth&&this.root.push(new ht("w:balanceSingleByteDoubleByteWidth",t.balanceSingleByteDoubleByteWidth)),t.noExtraLineSpacing&&this.root.push(new ht("w:noExtraLineSpacing",t.noExtraLineSpacing)),t.doNotLeaveBackslashAlone&&this.root.push(new ht("w:doNotLeaveBackslashAlone",t.doNotLeaveBackslashAlone)),t.underlineTrailingSpaces&&this.root.push(new ht("w:ulTrailSpace",t.underlineTrailingSpaces)),t.doNotExpandShiftReturn&&this.root.push(new ht("w:doNotExpandShiftReturn",t.doNotExpandShiftReturn)),t.spacingInWholePoints&&this.root.push(new ht("w:spacingInWholePoints",t.spacingInWholePoints)),t.lineWrapLikeWord6&&this.root.push(new ht("w:lineWrapLikeWord6",t.lineWrapLikeWord6)),t.printBodyTextBeforeHeader&&this.root.push(new ht("w:printBodyTextBeforeHeader",t.printBodyTextBeforeHeader)),t.printColorsBlack&&this.root.push(new ht("w:printColBlack",t.printColorsBlack)),t.spaceWidth&&this.root.push(new ht("w:wpSpaceWidth",t.spaceWidth)),t.showBreaksInFrames&&this.root.push(new ht("w:showBreaksInFrames",t.showBreaksInFrames)),t.subFontBySize&&this.root.push(new ht("w:subFontBySize",t.subFontBySize)),t.suppressBottomSpacing&&this.root.push(new ht("w:suppressBottomSpacing",t.suppressBottomSpacing)),t.suppressTopSpacing&&this.root.push(new ht("w:suppressTopSpacing",t.suppressTopSpacing)),t.suppressSpacingAtTopOfPage&&this.root.push(new ht("w:suppressSpacingAtTopOfPage",t.suppressSpacingAtTopOfPage)),t.suppressTopSpacingWP&&this.root.push(new ht("w:suppressTopSpacingWP",t.suppressTopSpacingWP)),t.suppressSpBfAfterPgBrk&&this.root.push(new ht("w:suppressSpBfAfterPgBrk",t.suppressSpBfAfterPgBrk)),t.swapBordersFacingPages&&this.root.push(new ht("w:swapBordersFacingPages",t.swapBordersFacingPages)),t.convertMailMergeEsc&&this.root.push(new ht("w:convMailMergeEsc",t.convertMailMergeEsc)),t.truncateFontHeightsLikeWP6&&this.root.push(new ht("w:truncateFontHeightsLikeWP6",t.truncateFontHeightsLikeWP6)),t.macWordSmallCaps&&this.root.push(new ht("w:mwSmallCaps",t.macWordSmallCaps)),t.usePrinterMetrics&&this.root.push(new ht("w:usePrinterMetrics",t.usePrinterMetrics)),t.doNotSuppressParagraphBorders&&this.root.push(new ht("w:doNotSuppressParagraphBorders",t.doNotSuppressParagraphBorders)),t.wrapTrailSpaces&&this.root.push(new ht("w:wrapTrailSpaces",t.wrapTrailSpaces)),t.footnoteLayoutLikeWW8&&this.root.push(new ht("w:footnoteLayoutLikeWW8",t.footnoteLayoutLikeWW8)),t.shapeLayoutLikeWW8&&this.root.push(new ht("w:shapeLayoutLikeWW8",t.shapeLayoutLikeWW8)),t.alignTablesRowByRow&&this.root.push(new ht("w:alignTablesRowByRow",t.alignTablesRowByRow)),t.forgetLastTabAlignment&&this.root.push(new ht("w:forgetLastTabAlignment",t.forgetLastTabAlignment)),t.adjustLineHeightInTable&&this.root.push(new ht("w:adjustLineHeightInTable",t.adjustLineHeightInTable)),t.autoSpaceLikeWord95&&this.root.push(new ht("w:autoSpaceLikeWord95",t.autoSpaceLikeWord95)),t.noSpaceRaiseLower&&this.root.push(new ht("w:noSpaceRaiseLower",t.noSpaceRaiseLower)),t.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new ht("w:doNotUseHTMLParagraphAutoSpacing",t.doNotUseHTMLParagraphAutoSpacing)),t.layoutRawTableWidth&&this.root.push(new ht("w:layoutRawTableWidth",t.layoutRawTableWidth)),t.layoutTableRowsApart&&this.root.push(new ht("w:layoutTableRowsApart",t.layoutTableRowsApart)),t.useWord97LineBreakRules&&this.root.push(new ht("w:useWord97LineBreakRules",t.useWord97LineBreakRules)),t.doNotBreakWrappedTables&&this.root.push(new ht("w:doNotBreakWrappedTables",t.doNotBreakWrappedTables)),t.doNotSnapToGridInCell&&this.root.push(new ht("w:doNotSnapToGridInCell",t.doNotSnapToGridInCell)),t.selectFieldWithFirstOrLastCharacter&&this.root.push(new ht("w:selectFldWithFirstOrLastChar",t.selectFieldWithFirstOrLastCharacter)),t.applyBreakingRules&&this.root.push(new ht("w:applyBreakingRules",t.applyBreakingRules)),t.doNotWrapTextWithPunctuation&&this.root.push(new ht("w:doNotWrapTextWithPunct",t.doNotWrapTextWithPunctuation)),t.doNotUseEastAsianBreakRules&&this.root.push(new ht("w:doNotUseEastAsianBreakRules",t.doNotUseEastAsianBreakRules)),t.useWord2002TableStyleRules&&this.root.push(new ht("w:useWord2002TableStyleRules",t.useWord2002TableStyleRules)),t.growAutofit&&this.root.push(new ht("w:growAutofit",t.growAutofit)),t.useFELayout&&this.root.push(new ht("w:useFELayout",t.useFELayout)),t.useNormalStyleForList&&this.root.push(new ht("w:useNormalStyleForList",t.useNormalStyleForList)),t.doNotUseIndentAsNumberingTabStop&&this.root.push(new ht("w:doNotUseIndentAsNumberingTabStop",t.doNotUseIndentAsNumberingTabStop)),t.useAlternateEastAsianLineBreakRules&&this.root.push(new ht("w:useAltKinsokuLineBreakRules",t.useAlternateEastAsianLineBreakRules)),t.allowSpaceOfSameStyleInTable&&this.root.push(new ht("w:allowSpaceOfSameStyleInTable",t.allowSpaceOfSameStyleInTable)),t.doNotSuppressIndentation&&this.root.push(new ht("w:doNotSuppressIndentation",t.doNotSuppressIndentation)),t.doNotAutofitConstrainedTables&&this.root.push(new ht("w:doNotAutofitConstrainedTables",t.doNotAutofitConstrainedTables)),t.autofitToFirstFixedWidthCell&&this.root.push(new ht("w:autofitToFirstFixedWidthCell",t.autofitToFirstFixedWidthCell)),t.underlineTabInNumberingList&&this.root.push(new ht("w:underlineTabInNumList",t.underlineTabInNumberingList)),t.displayHangulFixedWidth&&this.root.push(new ht("w:displayHangulFixedWidth",t.displayHangulFixedWidth)),t.splitPgBreakAndParaMark&&this.root.push(new ht("w:splitPgBreakAndParaMark",t.splitPgBreakAndParaMark)),t.doNotVerticallyAlignCellWithSp&&this.root.push(new ht("w:doNotVertAlignCellWithSp",t.doNotVerticallyAlignCellWithSp)),t.doNotBreakConstrainedForcedTable&&this.root.push(new ht("w:doNotBreakConstrainedForcedTable",t.doNotBreakConstrainedForcedTable)),t.ignoreVerticalAlignmentInTextboxes&&this.root.push(new ht("w:doNotVertAlignInTxbx",t.ignoreVerticalAlignmentInTextboxes)),t.useAnsiKerningPairs&&this.root.push(new ht("w:useAnsiKerningPairs",t.useAnsiKerningPairs)),t.cachedColumnBalance&&this.root.push(new ht("w:cachedColBalance",t.cachedColumnBalance))}}class OP extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class FP extends Qe{constructor(t){var r,s,a,o,l,u,d,h;super("w:settings"),this.root.push(new OP({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new ht("w:displayBackgroundShape",!0)),t.trackRevisions!==void 0&&this.root.push(new ht("w:trackRevisions",t.trackRevisions)),t.evenAndOddHeaders!==void 0&&this.root.push(new ht("w:evenAndOddHeaders",t.evenAndOddHeaders)),t.updateFields!==void 0&&this.root.push(new ht("w:updateFields",t.updateFields)),t.defaultTabStop!==void 0&&this.root.push(new pd("w:defaultTabStop",t.defaultTabStop)),((r=t.hyphenation)==null?void 0:r.autoHyphenation)!==void 0&&this.root.push(new ht("w:autoHyphenation",t.hyphenation.autoHyphenation)),((s=t.hyphenation)==null?void 0:s.hyphenationZone)!==void 0&&this.root.push(new pd("w:hyphenationZone",t.hyphenation.hyphenationZone)),((a=t.hyphenation)==null?void 0:a.consecutiveHyphenLimit)!==void 0&&this.root.push(new pd("w:consecutiveHyphenLimit",t.hyphenation.consecutiveHyphenLimit)),((o=t.hyphenation)==null?void 0:o.doNotHyphenateCaps)!==void 0&&this.root.push(new ht("w:doNotHyphenateCaps",t.hyphenation.doNotHyphenateCaps)),this.root.push(new DP(Ni(rr({},(l=t.compatibility)!=null?l:{}),{version:(h=(d=(u=t.compatibility)==null?void 0:u.version)!=null?d:t.compatibilityModeVersion)!=null?h:15})))}}class zj extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{val:"w:val"})}}class LP extends Qe{constructor(t){super("w:name"),this.root.push(new zj({val:t}))}}class IP extends Qe{constructor(t){super("w:uiPriority"),this.root.push(new zj({val:oa(t)}))}}class MP extends jt{constructor(){super(...arguments),Je(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}}class $j extends Qe{constructor(t,r){super("w:style"),this.root.push(new MP(t)),r.name&&this.root.push(new LP(r.name)),r.basedOn&&this.root.push(new rl("w:basedOn",r.basedOn)),r.next&&this.root.push(new rl("w:next",r.next)),r.link&&this.root.push(new rl("w:link",r.link)),r.uiPriority!==void 0&&this.root.push(new IP(r.uiPriority)),r.semiHidden!==void 0&&this.root.push(new ht("w:semiHidden",r.semiHidden)),r.unhideWhenUsed!==void 0&&this.root.push(new ht("w:unhideWhenUsed",r.unhideWhenUsed)),r.quickFormat!==void 0&&this.root.push(new ht("w:qFormat",r.quickFormat))}}class um extends $j{constructor(t){super({type:"paragraph",styleId:t.id},t),Je(this,"paragraphProperties"),Je(this,"runProperties"),this.paragraphProperties=new Kc(t.paragraph),this.runProperties=new wl(t.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class dm extends $j{constructor(t){super({type:"character",styleId:t.id},rr({uiPriority:99,unhideWhenUsed:!0},t)),Je(this,"runProperties"),this.runProperties=new wl(t.run),this.root.push(this.runProperties)}}class vo extends um{constructor(t){super(rr({basedOn:"Normal",next:"Normal",quickFormat:!0},t))}}class BP extends vo{constructor(t){super(rr({id:"Title",name:"Title"},t))}}class PP extends vo{constructor(t){super(rr({id:"Heading1",name:"Heading 1"},t))}}class UP extends vo{constructor(t){super(rr({id:"Heading2",name:"Heading 2"},t))}}class zP extends vo{constructor(t){super(rr({id:"Heading3",name:"Heading 3"},t))}}class $P extends vo{constructor(t){super(rr({id:"Heading4",name:"Heading 4"},t))}}class qP extends vo{constructor(t){super(rr({id:"Heading5",name:"Heading 5"},t))}}class HP extends vo{constructor(t){super(rr({id:"Heading6",name:"Heading 6"},t))}}class WP extends vo{constructor(t){super(rr({id:"Strong",name:"Strong"},t))}}class GP extends um{constructor(t){super(rr({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},t))}}class VP extends um{constructor(t){super(rr({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:Fy.AUTO}},run:{size:20}},t))}}class KP extends dm{constructor(t){super(rr({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},t))}}class XP extends dm{constructor(t){super(rr({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},t))}}class YP extends dm{constructor(t){super(rr({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:bj.SINGLE}}},t))}}class Iy extends Qe{constructor(t){if(super("w:styles"),t.initialStyles&&this.root.push(t.initialStyles),t.importedStyles)for(const r of t.importedStyles)this.root.push(r);if(t.paragraphStyles)for(const r of t.paragraphStyles)this.root.push(new um(r));if(t.characterStyles)for(const r of t.characterStyles)this.root.push(new dm(r))}}class JP extends Qe{constructor(t){super("w:pPrDefault"),this.root.push(new Kc(t))}}class ZP extends Qe{constructor(t){super("w:rPrDefault"),this.root.push(new wl(t))}}class QP extends Qe{constructor(t){super("w:docDefaults"),Je(this,"runPropertiesDefaults"),Je(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new ZP(t.run),this.paragraphPropertiesDefaults=new JP(t.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class eU{newInstance(t){const r=hj.xml2js(t,{compact:!1});let s;for(const l of r.elements||[])l.name==="w:styles"&&(s=l);if(s===void 0)throw new Error("can not find styles element");const a=s.elements||[];return new Iy({initialStyles:new AL(s.attributes),importedStyles:a.map(l=>_v(l))})}}class hk{newInstance(t={}){var r;return{initialStyles:new cm(["mc","r","w","w14","w15"],"w14 w15"),importedStyles:[new QP((r=t.document)!=null?r:{}),new BP(rr({run:{size:56}},t.title)),new PP(rr({run:{color:"2E74B5",size:32}},t.heading1)),new UP(rr({run:{color:"2E74B5",size:26}},t.heading2)),new zP(rr({run:{color:"1F4D78",size:24}},t.heading3)),new $P(rr({run:{color:"2E74B5",italics:!0}},t.heading4)),new qP(rr({run:{color:"2E74B5"}},t.heading5)),new HP(rr({run:{color:"1F4D78"}},t.heading6)),new WP(rr({run:{bold:!0}},t.strong)),new GP(t.listParagraph||{}),new YP(t.hyperlink||{}),new KP(t.footnoteReference||{}),new VP(t.footnoteText||{}),new XP(t.footnoteTextChar||{})]}}}let fm=class{constructor(t){Je(this,"currentRelationshipId",1),Je(this,"documentWrapper"),Je(this,"headers",[]),Je(this,"footers",[]),Je(this,"coreProperties"),Je(this,"numbering"),Je(this,"media"),Je(this,"fileRelationships"),Je(this,"footnotesWrapper"),Je(this,"settings"),Je(this,"contentTypes"),Je(this,"customProperties"),Je(this,"appProperties"),Je(this,"styles"),Je(this,"comments"),Je(this,"fontWrapper");var r,s,a,o,l,u,d,h,m,x,y,v;if(this.coreProperties=new PB(Ni(rr({},t),{creator:(r=t.creator)!=null?r:"Un-named",revision:(s=t.revision)!=null?s:1,lastModifiedBy:(a=t.lastModifiedBy)!=null?a:"Un-named"})),this.numbering=new AP(t.numbering?t.numbering:{config:[]}),this.comments=new CM((o=t.comments)!=null?o:{children:[]}),this.fileRelationships=new _l,this.customProperties=new WB((l=t.customProperties)!=null?l:[]),this.appProperties=new FB,this.footnotesWrapper=new lP,this.contentTypes=new BB,this.documentWrapper=new Lj({background:t.background}),this.settings=new FP({compatibilityModeVersion:t.compatabilityModeVersion,compatibility:t.compatibility,evenAndOddHeaders:!!t.evenAndOddHeaderAndFooters,trackRevisions:(u=t.features)==null?void 0:u.trackRevisions,updateFields:(d=t.features)==null?void 0:d.updateFields,defaultTabStop:t.defaultTabStop,hyphenation:{autoHyphenation:(h=t.hyphenation)==null?void 0:h.autoHyphenation,hyphenationZone:(m=t.hyphenation)==null?void 0:m.hyphenationZone,consecutiveHyphenLimit:(x=t.hyphenation)==null?void 0:x.consecutiveHyphenLimit,doNotHyphenateCaps:(y=t.hyphenation)==null?void 0:y.doNotHyphenateCaps}}),this.media=new fP,t.externalStyles!==void 0){const b=new eU;this.styles=b.newInstance(t.externalStyles)}else if(t.styles){const g=new hk().newInstance(t.styles.default);this.styles=new Iy(rr(rr({},g),t.styles))}else{const b=new hk;this.styles=new Iy(b.newInstance())}this.addDefaultRelationships();for(const b of t.sections)this.addSection(b);if(t.footnotes)for(const b in t.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(b),t.footnotes[b].children);this.fontWrapper=new XB((v=t.fonts)!=null?v:[])}addSection({headers:t={},footers:r={},children:s,properties:a}){this.documentWrapper.View.Body.addSection(Ni(rr({},a),{headerWrapperGroup:{default:t.default?this.createHeader(t.default):void 0,first:t.first?this.createHeader(t.first):void 0,even:t.even?this.createHeader(t.even):void 0},footerWrapperGroup:{default:r.default?this.createFooter(r.default):void 0,first:r.first?this.createFooter(r.first):void 0,even:r.even?this.createFooter(r.even):void 0}}));for(const o of s)this.documentWrapper.View.add(o)}createHeader(t){const r=new dP(this.media,this.currentRelationshipId++);for(const s of t.options.children)r.add(s);return this.addHeaderToDocument(r),r}createFooter(t){const r=new ZB(this.media,this.currentRelationshipId++);for(const s of t.options.children)r.add(s);return this.addFooterToDocument(r),r}addHeaderToDocument(t,r=Lc.DEFAULT){this.headers.push({header:t,type:r}),this.documentWrapper.Relationships.createRelationship(t.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(t,r=Lc.DEFAULT){this.footers.push({footer:t,type:r}),this.documentWrapper.Relationships.createRelationship(t.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(t=>t.header)}get Footers(){return this.footers.map(t=>t.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}};var tU=vv();function Kh(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var W1={exports:{}},mk;function rU(){return mk||(mk=1,(function(e,t){(function(r){e.exports=r()})(function(){return(function r(s,a,o){function l(h,m){if(!a[h]){if(!s[h]){var x=typeof Kh=="function"&&Kh;if(!m&&x)return x(h,!0);if(u)return u(h,!0);var y=new Error("Cannot find module '"+h+"'");throw y.code="MODULE_NOT_FOUND",y}var v=a[h]={exports:{}};s[h][0].call(v.exports,function(b){var g=s[h][1][b];return l(g||b)},v,v.exports,r,s,a,o)}return a[h].exports}for(var u=typeof Kh=="function"&&Kh,d=0;d<o.length;d++)l(o[d]);return l})({1:[function(r,s,a){var o=r("./utils"),l=r("./support"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(d){for(var h,m,x,y,v,b,g,_=[],w=0,k=d.length,N=k,E=o.getTypeOf(d)!=="string";w<d.length;)N=k-w,x=E?(h=d[w++],m=w<k?d[w++]:0,w<k?d[w++]:0):(h=d.charCodeAt(w++),m=w<k?d.charCodeAt(w++):0,w<k?d.charCodeAt(w++):0),y=h>>2,v=(3&h)<<4|m>>4,b=1<N?(15&m)<<2|x>>6:64,g=2<N?63&x:64,_.push(u.charAt(y)+u.charAt(v)+u.charAt(b)+u.charAt(g));return _.join("")},a.decode=function(d){var h,m,x,y,v,b,g=0,_=0,w="data:";if(d.substr(0,w.length)===w)throw new Error("Invalid base64 input, it looks like a data url.");var k,N=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===u.charAt(64)&&N--,d.charAt(d.length-2)===u.charAt(64)&&N--,N%1!=0)throw new Error("Invalid base64 input, bad content length.");for(k=l.uint8array?new Uint8Array(0|N):new Array(0|N);g<d.length;)h=u.indexOf(d.charAt(g++))<<2|(y=u.indexOf(d.charAt(g++)))>>4,m=(15&y)<<4|(v=u.indexOf(d.charAt(g++)))>>2,x=(3&v)<<6|(b=u.indexOf(d.charAt(g++))),k[_++]=h,v!==64&&(k[_++]=m),b!==64&&(k[_++]=x);return k}},{"./support":30,"./utils":32}],2:[function(r,s,a){var o=r("./external"),l=r("./stream/DataWorker"),u=r("./stream/Crc32Probe"),d=r("./stream/DataLengthProbe");function h(m,x,y,v,b){this.compressedSize=m,this.uncompressedSize=x,this.crc32=y,this.compression=v,this.compressedContent=b}h.prototype={getContentWorker:function(){var m=new l(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),x=this;return m.on("end",function(){if(this.streamInfo.data_length!==x.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),m},getCompressedWorker:function(){return new l(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(m,x,y){return m.pipe(new u).pipe(new d("uncompressedSize")).pipe(x.compressWorker(y)).pipe(new d("compressedSize")).withStreamInfo("compression",x)},s.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,s,a){var o=r("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},a.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,s,a){var o=r("./utils"),l=(function(){for(var u,d=[],h=0;h<256;h++){u=h;for(var m=0;m<8;m++)u=1&u?3988292384^u>>>1:u>>>1;d[h]=u}return d})();s.exports=function(u,d){return u!==void 0&&u.length?o.getTypeOf(u)!=="string"?(function(h,m,x,y){var v=l,b=y+x;h^=-1;for(var g=y;g<b;g++)h=h>>>8^v[255&(h^m[g])];return-1^h})(0|d,u,u.length,0):(function(h,m,x,y){var v=l,b=y+x;h^=-1;for(var g=y;g<b;g++)h=h>>>8^v[255&(h^m.charCodeAt(g))];return-1^h})(0|d,u,u.length,0):0}},{"./utils":32}],5:[function(r,s,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(r,s,a){var o=null;o=typeof Promise<"u"?Promise:r("lie"),s.exports={Promise:o}},{lie:37}],7:[function(r,s,a){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=r("pako"),u=r("./utils"),d=r("./stream/GenericWorker"),h=o?"uint8array":"array";function m(x,y){d.call(this,"FlateWorker/"+x),this._pako=null,this._pakoAction=x,this._pakoOptions=y,this.meta={}}a.magic="\b\0",u.inherits(m,d),m.prototype.processChunk=function(x){this.meta=x.meta,this._pako===null&&this._createPako(),this._pako.push(u.transformTo(h,x.data),!1)},m.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},m.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},m.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var x=this;this._pako.onData=function(y){x.push({data:y,meta:x.meta})}},a.compressWorker=function(x){return new m("Deflate",x)},a.uncompressWorker=function(){return new m("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,s,a){function o(v,b){var g,_="";for(g=0;g<b;g++)_+=String.fromCharCode(255&v),v>>>=8;return _}function l(v,b,g,_,w,k){var N,E,C=v.file,L=v.compression,O=k!==h.utf8encode,B=u.transformTo("string",k(C.name)),F=u.transformTo("string",h.utf8encode(C.name)),q=C.comment,fe=u.transformTo("string",k(q)),D=u.transformTo("string",h.utf8encode(q)),V=F.length!==C.name.length,I=D.length!==q.length,ae="",Q="",te="",ve=C.dir,ee=C.date,Se={crc32:0,compressedSize:0,uncompressedSize:0};b&&!g||(Se.crc32=v.crc32,Se.compressedSize=v.compressedSize,Se.uncompressedSize=v.uncompressedSize);var J=0;b&&(J|=8),O||!V&&!I||(J|=2048);var M=0,Y=0;ve&&(M|=16),w==="UNIX"?(Y=798,M|=(function(re,ce){var P=re;return re||(P=ce?16893:33204),(65535&P)<<16})(C.unixPermissions,ve)):(Y=20,M|=(function(re){return 63&(re||0)})(C.dosPermissions)),N=ee.getUTCHours(),N<<=6,N|=ee.getUTCMinutes(),N<<=5,N|=ee.getUTCSeconds()/2,E=ee.getUTCFullYear()-1980,E<<=4,E|=ee.getUTCMonth()+1,E<<=5,E|=ee.getUTCDate(),V&&(Q=o(1,1)+o(m(B),4)+F,ae+="up"+o(Q.length,2)+Q),I&&(te=o(1,1)+o(m(fe),4)+D,ae+="uc"+o(te.length,2)+te);var G="";return G+=`
\0`,G+=o(J,2),G+=L.magic,G+=o(N,2),G+=o(E,2),G+=o(Se.crc32,4),G+=o(Se.compressedSize,4),G+=o(Se.uncompressedSize,4),G+=o(B.length,2),G+=o(ae.length,2),{fileRecord:x.LOCAL_FILE_HEADER+G+B+ae,dirRecord:x.CENTRAL_FILE_HEADER+o(Y,2)+G+o(fe.length,2)+"\0\0\0\0"+o(M,4)+o(_,4)+B+ae+fe}}var u=r("../utils"),d=r("../stream/GenericWorker"),h=r("../utf8"),m=r("../crc32"),x=r("../signature");function y(v,b,g,_){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=g,this.encodeFileName=_,this.streamFiles=v,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}u.inherits(y,d),y.prototype.push=function(v){var b=v.meta.percent||0,g=this.entriesCount,_=this._sources.length;this.accumulate?this.contentBuffer.push(v):(this.bytesWritten+=v.data.length,d.prototype.push.call(this,{data:v.data,meta:{currentFile:this.currentFile,percent:g?(b+100*(g-_-1))/g:100}}))},y.prototype.openedSource=function(v){this.currentSourceOffset=this.bytesWritten,this.currentFile=v.file.name;var b=this.streamFiles&&!v.file.dir;if(b){var g=l(v,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(v){this.accumulate=!1;var b=this.streamFiles&&!v.file.dir,g=l(v,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),b)this.push({data:(function(_){return x.DATA_DESCRIPTOR+o(_.crc32,4)+o(_.compressedSize,4)+o(_.uncompressedSize,4)})(v),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var v=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var g=this.bytesWritten-v,_=(function(w,k,N,E,C){var L=u.transformTo("string",C(E));return x.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(w,2)+o(w,2)+o(k,4)+o(N,4)+o(L.length,2)+L})(this.dirRecords.length,g,v,this.zipComment,this.encodeFileName);this.push({data:_,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(v){this._sources.push(v);var b=this;return v.on("data",function(g){b.processChunk(g)}),v.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),v.on("error",function(g){b.error(g)}),this},y.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(v){var b=this._sources;if(!d.prototype.error.call(this,v))return!1;for(var g=0;g<b.length;g++)try{b[g].error(v)}catch{}return!0},y.prototype.lock=function(){d.prototype.lock.call(this);for(var v=this._sources,b=0;b<v.length;b++)v[b].lock()},s.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,s,a){var o=r("../compressions"),l=r("./ZipFileWorker");a.generateWorker=function(u,d,h){var m=new l(d.streamFiles,h,d.platform,d.encodeFileName),x=0;try{u.forEach(function(y,v){x++;var b=(function(k,N){var E=k||N,C=o[E];if(!C)throw new Error(E+" is not a valid compression method !");return C})(v.options.compression,d.compression),g=v.options.compressionOptions||d.compressionOptions||{},_=v.dir,w=v.date;v._compressWorker(b,g).withStreamInfo("file",{name:y,dir:_,date:w,comment:v.comment||"",unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions}).pipe(m)}),m.entriesCount=x}catch(y){m.error(y)}return m}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,s,a){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new o;for(var u in this)typeof this[u]!="function"&&(l[u]=this[u]);return l}}(o.prototype=r("./object")).loadAsync=r("./load"),o.support=r("./support"),o.defaults=r("./defaults"),o.version="3.10.1",o.loadAsync=function(l,u){return new o().loadAsync(l,u)},o.external=r("./external"),s.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,s,a){var o=r("./utils"),l=r("./external"),u=r("./utf8"),d=r("./zipEntries"),h=r("./stream/Crc32Probe"),m=r("./nodejsUtils");function x(y){return new l.Promise(function(v,b){var g=y.decompressed.getContentWorker().pipe(new h);g.on("error",function(_){b(_)}).on("end",function(){g.streamInfo.crc32!==y.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):v()}).resume()})}s.exports=function(y,v){var b=this;return v=o.extend(v||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:u.utf8decode}),m.isNode&&m.isStream(y)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",y,!0,v.optimizedBinaryString,v.base64).then(function(g){var _=new d(v);return _.load(g),_}).then(function(g){var _=[l.Promise.resolve(g)],w=g.files;if(v.checkCRC32)for(var k=0;k<w.length;k++)_.push(x(w[k]));return l.Promise.all(_)}).then(function(g){for(var _=g.shift(),w=_.files,k=0;k<w.length;k++){var N=w[k],E=N.fileNameStr,C=o.resolve(N.fileNameStr);b.file(C,N.decompressed,{binary:!0,optimizedBinaryString:!0,date:N.date,dir:N.dir,comment:N.fileCommentStr.length?N.fileCommentStr:null,unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions,createFolders:v.createFolders}),N.dir||(b.file(C).unsafeOriginalName=E)}return _.zipComment.length&&(b.comment=_.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,s,a){var o=r("../utils"),l=r("../stream/GenericWorker");function u(d,h){l.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(h)}o.inherits(u,l),u.prototype._bindStream=function(d){var h=this;(this._stream=d).pause(),d.on("data",function(m){h.push({data:m,meta:{percent:0}})}).on("error",function(m){h.isPaused?this.generatedError=m:h.error(m)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},u.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=u},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,s,a){var o=r("readable-stream").Readable;function l(u,d,h){o.call(this,d),this._helper=u;var m=this;u.on("data",function(x,y){m.push(x)||m._helper.pause(),h&&h(y)}).on("error",function(x){m.emit("error",x)}).on("end",function(){m.push(null)})}r("../utils").inherits(l,o),l.prototype._read=function(){this._helper.resume()},s.exports=l},{"../utils":32,"readable-stream":16}],14:[function(r,s,a){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,l);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,l)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var l=new Buffer(o);return l.fill(0),l},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(r,s,a){function o(C,L,O){var B,F=u.getTypeOf(L),q=u.extend(O||{},m);q.date=q.date||new Date,q.compression!==null&&(q.compression=q.compression.toUpperCase()),typeof q.unixPermissions=="string"&&(q.unixPermissions=parseInt(q.unixPermissions,8)),q.unixPermissions&&16384&q.unixPermissions&&(q.dir=!0),q.dosPermissions&&16&q.dosPermissions&&(q.dir=!0),q.dir&&(C=w(C)),q.createFolders&&(B=_(C))&&k.call(this,B,!0);var fe=F==="string"&&q.binary===!1&&q.base64===!1;O&&O.binary!==void 0||(q.binary=!fe),(L instanceof x&&L.uncompressedSize===0||q.dir||!L||L.length===0)&&(q.base64=!1,q.binary=!0,L="",q.compression="STORE",F="string");var D=null;D=L instanceof x||L instanceof d?L:b.isNode&&b.isStream(L)?new g(C,L):u.prepareContent(C,L,q.binary,q.optimizedBinaryString,q.base64);var V=new y(C,D,q);this.files[C]=V}var l=r("./utf8"),u=r("./utils"),d=r("./stream/GenericWorker"),h=r("./stream/StreamHelper"),m=r("./defaults"),x=r("./compressedObject"),y=r("./zipObject"),v=r("./generate"),b=r("./nodejsUtils"),g=r("./nodejs/NodejsStreamInputAdapter"),_=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var L=C.lastIndexOf("/");return 0<L?C.substring(0,L):""},w=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},k=function(C,L){return L=L!==void 0?L:m.createFolders,C=w(C),this.files[C]||o.call(this,C,null,{dir:!0,createFolders:L}),this.files[C]};function N(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var L,O,B;for(L in this.files)B=this.files[L],(O=L.slice(this.root.length,L.length))&&L.slice(0,this.root.length)===this.root&&C(O,B)},filter:function(C){var L=[];return this.forEach(function(O,B){C(O,B)&&L.push(B)}),L},file:function(C,L,O){if(arguments.length!==1)return C=this.root+C,o.call(this,C,L,O),this;if(N(C)){var B=C;return this.filter(function(q,fe){return!fe.dir&&B.test(q)})}var F=this.files[this.root+C];return F&&!F.dir?F:null},folder:function(C){if(!C)return this;if(N(C))return this.filter(function(F,q){return q.dir&&C.test(F)});var L=this.root+C,O=k.call(this,L),B=this.clone();return B.root=O.name,B},remove:function(C){C=this.root+C;var L=this.files[C];if(L||(C.slice(-1)!=="/"&&(C+="/"),L=this.files[C]),L&&!L.dir)delete this.files[C];else for(var O=this.filter(function(F,q){return q.name.slice(0,C.length)===C}),B=0;B<O.length;B++)delete this.files[O[B].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var L,O={};try{if((O=u.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");u.checkSupport(O.type),O.platform!=="darwin"&&O.platform!=="freebsd"&&O.platform!=="linux"&&O.platform!=="sunos"||(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var B=O.comment||this.comment||"";L=v.generateWorker(this,O,B)}catch(F){(L=new d("error")).error(F)}return new h(L,O.type||"string",O.mimeType)},generateAsync:function(C,L){return this.generateInternalStream(C).accumulate(L)},generateNodeStream:function(C,L){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(L)}};s.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,s,a){s.exports=r("stream")},{stream:void 0}],17:[function(r,s,a){var o=r("./DataReader");function l(u){o.call(this,u);for(var d=0;d<this.data.length;d++)u[d]=255&u[d]}r("../utils").inherits(l,o),l.prototype.byteAt=function(u){return this.data[this.zero+u]},l.prototype.lastIndexOfSignature=function(u){for(var d=u.charCodeAt(0),h=u.charCodeAt(1),m=u.charCodeAt(2),x=u.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===d&&this.data[y+1]===h&&this.data[y+2]===m&&this.data[y+3]===x)return y-this.zero;return-1},l.prototype.readAndCheckSignature=function(u){var d=u.charCodeAt(0),h=u.charCodeAt(1),m=u.charCodeAt(2),x=u.charCodeAt(3),y=this.readData(4);return d===y[0]&&h===y[1]&&m===y[2]&&x===y[3]},l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},s.exports=l},{"../utils":32,"./DataReader":18}],18:[function(r,s,a){var o=r("../utils");function l(u){this.data=u,this.length=u.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(u){this.checkIndex(this.index+u)},checkIndex:function(u){if(this.length<this.zero+u||u<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+u+"). Corrupted zip ?")},setIndex:function(u){this.checkIndex(u),this.index=u},skip:function(u){this.setIndex(this.index+u)},byteAt:function(){},readInt:function(u){var d,h=0;for(this.checkOffset(u),d=this.index+u-1;d>=this.index;d--)h=(h<<8)+this.byteAt(d);return this.index+=u,h},readString:function(u){return o.transformTo("string",this.readData(u))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var u=this.readInt(4);return new Date(Date.UTC(1980+(u>>25&127),(u>>21&15)-1,u>>16&31,u>>11&31,u>>5&63,(31&u)<<1))}},s.exports=l},{"../utils":32}],19:[function(r,s,a){var o=r("./Uint8ArrayReader");function l(u){o.call(this,u)}r("../utils").inherits(l,o),l.prototype.readData=function(u){this.checkOffset(u);var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},s.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,s,a){var o=r("./DataReader");function l(u){o.call(this,u)}r("../utils").inherits(l,o),l.prototype.byteAt=function(u){return this.data.charCodeAt(this.zero+u)},l.prototype.lastIndexOfSignature=function(u){return this.data.lastIndexOf(u)-this.zero},l.prototype.readAndCheckSignature=function(u){return u===this.readData(4)},l.prototype.readData=function(u){this.checkOffset(u);var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},s.exports=l},{"../utils":32,"./DataReader":18}],21:[function(r,s,a){var o=r("./ArrayReader");function l(u){o.call(this,u)}r("../utils").inherits(l,o),l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},s.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(r,s,a){var o=r("../utils"),l=r("../support"),u=r("./ArrayReader"),d=r("./StringReader"),h=r("./NodeBufferReader"),m=r("./Uint8ArrayReader");s.exports=function(x){var y=o.getTypeOf(x);return o.checkSupport(y),y!=="string"||l.uint8array?y==="nodebuffer"?new h(x):l.uint8array?new m(o.transformTo("uint8array",x)):new u(o.transformTo("array",x)):new d(x)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,s,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,s,a){var o=r("./GenericWorker"),l=r("../utils");function u(d){o.call(this,"ConvertWorker to "+d),this.destType=d}l.inherits(u,o),u.prototype.processChunk=function(d){this.push({data:l.transformTo(this.destType,d.data),meta:d.meta})},s.exports=u},{"../utils":32,"./GenericWorker":28}],25:[function(r,s,a){var o=r("./GenericWorker"),l=r("../crc32");function u(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(u,o),u.prototype.processChunk=function(d){this.streamInfo.crc32=l(d.data,this.streamInfo.crc32||0),this.push(d)},s.exports=u},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,s,a){var o=r("../utils"),l=r("./GenericWorker");function u(d){l.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}o.inherits(u,l),u.prototype.processChunk=function(d){if(d){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+d.data.length}l.prototype.processChunk.call(this,d)},s.exports=u},{"../utils":32,"./GenericWorker":28}],27:[function(r,s,a){var o=r("../utils"),l=r("./GenericWorker");function u(d){l.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(m){h.dataIsReady=!0,h.data=m,h.max=m&&m.length||0,h.type=o.getTypeOf(m),h.isPaused||h._tickAndRepeat()},function(m){h.error(m)})}o.inherits(u,l),u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},u.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},u.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,h);break;case"uint8array":d=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":d=this.data.slice(this.index,h)}return this.index=h,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=u},{"../utils":32,"./GenericWorker":28}],28:[function(r,s,a){function o(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,u){return this._listeners[l].push(u),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,u){if(this._listeners[l])for(var d=0;d<this._listeners[l].length;d++)this._listeners[l][d].call(this,u)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var u=this;return l.on("data",function(d){u.processChunk(d)}),l.on("end",function(){u.end()}),l.on("error",function(d){u.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,u){return this.extraStreamInfo[l]=u,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},s.exports=o},{}],29:[function(r,s,a){var o=r("../utils"),l=r("./ConvertWorker"),u=r("./GenericWorker"),d=r("../base64"),h=r("../support"),m=r("../external"),x=null;if(h.nodestream)try{x=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(b,g){return new m.Promise(function(_,w){var k=[],N=b._internalType,E=b._outputType,C=b._mimeType;b.on("data",function(L,O){k.push(L),g&&g(O)}).on("error",function(L){k=[],w(L)}).on("end",function(){try{var L=(function(O,B,F){switch(O){case"blob":return o.newBlob(o.transformTo("arraybuffer",B),F);case"base64":return d.encode(B);default:return o.transformTo(O,B)}})(E,(function(O,B){var F,q=0,fe=null,D=0;for(F=0;F<B.length;F++)D+=B[F].length;switch(O){case"string":return B.join("");case"array":return Array.prototype.concat.apply([],B);case"uint8array":for(fe=new Uint8Array(D),F=0;F<B.length;F++)fe.set(B[F],q),q+=B[F].length;return fe;case"nodebuffer":return Buffer.concat(B);default:throw new Error("concat : unsupported type '"+O+"'")}})(N,k),C);_(L)}catch(O){w(O)}k=[]}).resume()})}function v(b,g,_){var w=g;switch(g){case"blob":case"arraybuffer":w="uint8array";break;case"base64":w="string"}try{this._internalType=w,this._outputType=g,this._mimeType=_,o.checkSupport(w),this._worker=b.pipe(new l(w)),b.lock()}catch(k){this._worker=new u("error"),this._worker.error(k)}}v.prototype={accumulate:function(b){return y(this,b)},on:function(b,g){var _=this;return b==="data"?this._worker.on(b,function(w){g.call(_,w.data,w.meta)}):this._worker.on(b,function(){o.delay(g,arguments,_)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new x(this,{objectMode:this._outputType!=="nodebuffer"},b)}},s.exports=v},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,s,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var o=new ArrayBuffer(0);try{a.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(o),a.blob=l.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!r("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(r,s,a){for(var o=r("./utils"),l=r("./support"),u=r("./nodejsUtils"),d=r("./stream/GenericWorker"),h=new Array(256),m=0;m<256;m++)h[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;h[254]=h[254]=1;function x(){d.call(this,"utf-8 decode"),this.leftOver=null}function y(){d.call(this,"utf-8 encode")}a.utf8encode=function(v){return l.nodebuffer?u.newBufferFrom(v,"utf-8"):(function(b){var g,_,w,k,N,E=b.length,C=0;for(k=0;k<E;k++)(64512&(_=b.charCodeAt(k)))==55296&&k+1<E&&(64512&(w=b.charCodeAt(k+1)))==56320&&(_=65536+(_-55296<<10)+(w-56320),k++),C+=_<128?1:_<2048?2:_<65536?3:4;for(g=l.uint8array?new Uint8Array(C):new Array(C),k=N=0;N<C;k++)(64512&(_=b.charCodeAt(k)))==55296&&k+1<E&&(64512&(w=b.charCodeAt(k+1)))==56320&&(_=65536+(_-55296<<10)+(w-56320),k++),_<128?g[N++]=_:(_<2048?g[N++]=192|_>>>6:(_<65536?g[N++]=224|_>>>12:(g[N++]=240|_>>>18,g[N++]=128|_>>>12&63),g[N++]=128|_>>>6&63),g[N++]=128|63&_);return g})(v)},a.utf8decode=function(v){return l.nodebuffer?o.transformTo("nodebuffer",v).toString("utf-8"):(function(b){var g,_,w,k,N=b.length,E=new Array(2*N);for(g=_=0;g<N;)if((w=b[g++])<128)E[_++]=w;else if(4<(k=h[w]))E[_++]=65533,g+=k-1;else{for(w&=k===2?31:k===3?15:7;1<k&&g<N;)w=w<<6|63&b[g++],k--;1<k?E[_++]=65533:w<65536?E[_++]=w:(w-=65536,E[_++]=55296|w>>10&1023,E[_++]=56320|1023&w)}return E.length!==_&&(E.subarray?E=E.subarray(0,_):E.length=_),o.applyFromCharCode(E)})(v=o.transformTo(l.uint8array?"uint8array":"array",v))},o.inherits(x,d),x.prototype.processChunk=function(v){var b=o.transformTo(l.uint8array?"uint8array":"array",v.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var g=b;(b=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),b.set(g,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var _=(function(k,N){var E;for((N=N||k.length)>k.length&&(N=k.length),E=N-1;0<=E&&(192&k[E])==128;)E--;return E<0||E===0?N:E+h[k[E]]>N?E:N})(b),w=b;_!==b.length&&(l.uint8array?(w=b.subarray(0,_),this.leftOver=b.subarray(_,b.length)):(w=b.slice(0,_),this.leftOver=b.slice(_,b.length))),this.push({data:a.utf8decode(w),meta:v.meta})},x.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=x,o.inherits(y,d),y.prototype.processChunk=function(v){this.push({data:a.utf8encode(v.data),meta:v.meta})},a.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,s,a){var o=r("./support"),l=r("./base64"),u=r("./nodejsUtils"),d=r("./external");function h(g){return g}function m(g,_){for(var w=0;w<g.length;++w)_[w]=255&g.charCodeAt(w);return _}r("setimmediate"),a.newBlob=function(g,_){a.checkSupport("blob");try{return new Blob([g],{type:_})}catch{try{var w=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return w.append(g),w.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};var x={stringifyByChunk:function(g,_,w){var k=[],N=0,E=g.length;if(E<=w)return String.fromCharCode.apply(null,g);for(;N<E;)_==="array"||_==="nodebuffer"?k.push(String.fromCharCode.apply(null,g.slice(N,Math.min(N+w,E)))):k.push(String.fromCharCode.apply(null,g.subarray(N,Math.min(N+w,E)))),N+=w;return k.join("")},stringifyByChar:function(g){for(var _="",w=0;w<g.length;w++)_+=String.fromCharCode(g[w]);return _},applyCanBeUsed:{uint8array:(function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,u.allocBuffer(1)).length===1}catch{return!1}})()}};function y(g){var _=65536,w=a.getTypeOf(g),k=!0;if(w==="uint8array"?k=x.applyCanBeUsed.uint8array:w==="nodebuffer"&&(k=x.applyCanBeUsed.nodebuffer),k)for(;1<_;)try{return x.stringifyByChunk(g,w,_)}catch{_=Math.floor(_/2)}return x.stringifyByChar(g)}function v(g,_){for(var w=0;w<g.length;w++)_[w]=g[w];return _}a.applyFromCharCode=y;var b={};b.string={string:h,array:function(g){return m(g,new Array(g.length))},arraybuffer:function(g){return b.string.uint8array(g).buffer},uint8array:function(g){return m(g,new Uint8Array(g.length))},nodebuffer:function(g){return m(g,u.allocBuffer(g.length))}},b.array={string:y,array:h,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return u.newBufferFrom(g)}},b.arraybuffer={string:function(g){return y(new Uint8Array(g))},array:function(g){return v(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:h,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return u.newBufferFrom(new Uint8Array(g))}},b.uint8array={string:y,array:function(g){return v(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:h,nodebuffer:function(g){return u.newBufferFrom(g)}},b.nodebuffer={string:y,array:function(g){return v(g,new Array(g.length))},arraybuffer:function(g){return b.nodebuffer.uint8array(g).buffer},uint8array:function(g){return v(g,new Uint8Array(g.length))},nodebuffer:h},a.transformTo=function(g,_){if(_=_||"",!g)return _;a.checkSupport(g);var w=a.getTypeOf(_);return b[w][g](_)},a.resolve=function(g){for(var _=g.split("/"),w=[],k=0;k<_.length;k++){var N=_[k];N==="."||N===""&&k!==0&&k!==_.length-1||(N===".."?w.pop():w.push(N))}return w.join("/")},a.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":o.nodebuffer&&u.isBuffer(g)?"nodebuffer":o.uint8array&&g instanceof Uint8Array?"uint8array":o.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(g){if(!o[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(g){var _,w,k="";for(w=0;w<(g||"").length;w++)k+="\\x"+((_=g.charCodeAt(w))<16?"0":"")+_.toString(16).toUpperCase();return k},a.delay=function(g,_,w){setImmediate(function(){g.apply(w||null,_||[])})},a.inherits=function(g,_){function w(){}w.prototype=_.prototype,g.prototype=new w},a.extend=function(){var g,_,w={};for(g=0;g<arguments.length;g++)for(_ in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],_)&&w[_]===void 0&&(w[_]=arguments[g][_]);return w},a.prepareContent=function(g,_,w,k,N){return d.Promise.resolve(_).then(function(E){return o.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new d.Promise(function(C,L){var O=new FileReader;O.onload=function(B){C(B.target.result)},O.onerror=function(B){L(B.target.error)},O.readAsArrayBuffer(E)}):E}).then(function(E){var C=a.getTypeOf(E);return C?(C==="arraybuffer"?E=a.transformTo("uint8array",E):C==="string"&&(N?E=l.decode(E):w&&k!==!0&&(E=(function(L){return m(L,o.uint8array?new Uint8Array(L.length):new Array(L.length))})(E))),E):d.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,s,a){var o=r("./reader/readerFor"),l=r("./utils"),u=r("./signature"),d=r("./zipEntry"),h=r("./support");function m(x){this.files=[],this.loadOptions=x}m.prototype={checkSignature:function(x){if(!this.reader.readAndCheckSignature(x)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(y)+", expected "+l.pretty(x)+")")}},isSignature:function(x,y){var v=this.reader.index;this.reader.setIndex(x);var b=this.reader.readString(4)===y;return this.reader.setIndex(v),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var x=this.reader.readData(this.zipCommentLength),y=h.uint8array?"uint8array":"array",v=l.transformTo(y,x);this.zipComment=this.loadOptions.decodeFileName(v)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var x,y,v,b=this.zip64EndOfCentralSize-44;0<b;)x=this.reader.readInt(2),y=this.reader.readInt(4),v=this.reader.readData(y),this.zip64ExtensibleData[x]={id:x,length:y,value:v}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var x,y;for(x=0;x<this.files.length;x++)y=this.files[x],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var x;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(u.CENTRAL_FILE_HEADER);)(x=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(x);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var x=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if(x<0)throw this.isSignature(0,u.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(x);var y=x;if(this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(x=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(x),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,u.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var b=y-v;if(0<b)this.isSignature(y,u.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(x){this.reader=o(x)},load:function(x){this.prepareReader(x),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=m},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,s,a){var o=r("./reader/readerFor"),l=r("./utils"),u=r("./compressedObject"),d=r("./crc32"),h=r("./utf8"),m=r("./compressions"),x=r("./support");function y(v,b){this.options=v,this.loadOptions=b}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(v){var b,g;if(v.skip(22),this.fileNameLength=v.readInt(2),g=v.readInt(2),this.fileName=v.readData(this.fileNameLength),v.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=(function(_){for(var w in m)if(Object.prototype.hasOwnProperty.call(m,w)&&m[w].magic===_)return m[w];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new u(this.compressedSize,this.uncompressedSize,this.crc32,b,v.readData(this.compressedSize))},readCentralPart:function(v){this.versionMadeBy=v.readInt(2),v.skip(2),this.bitFlag=v.readInt(2),this.compressionMethod=v.readString(2),this.date=v.readDate(),this.crc32=v.readInt(4),this.compressedSize=v.readInt(4),this.uncompressedSize=v.readInt(4);var b=v.readInt(2);if(this.extraFieldsLength=v.readInt(2),this.fileCommentLength=v.readInt(2),this.diskNumberStart=v.readInt(2),this.internalFileAttributes=v.readInt(2),this.externalFileAttributes=v.readInt(4),this.localHeaderOffset=v.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");v.skip(b),this.readExtraFields(v),this.parseZIP64ExtraField(v),this.fileComment=v.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var v=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),v==0&&(this.dosPermissions=63&this.externalFileAttributes),v==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var v=o(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=v.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=v.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=v.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=v.readInt(4))}},readExtraFields:function(v){var b,g,_,w=v.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});v.index+4<w;)b=v.readInt(2),g=v.readInt(2),_=v.readData(g),this.extraFields[b]={id:b,length:g,value:_};v.setIndex(w)},handleUTF8:function(){var v=x.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var g=l.transformTo(v,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var _=this.findExtraFieldUnicodeComment();if(_!==null)this.fileCommentStr=_;else{var w=l.transformTo(v,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(w)}}},findExtraFieldUnicodePath:function(){var v=this.extraFields[28789];if(v){var b=o(v.value);return b.readInt(1)!==1||d(this.fileName)!==b.readInt(4)?null:h.utf8decode(b.readData(v.length-5))}return null},findExtraFieldUnicodeComment:function(){var v=this.extraFields[25461];if(v){var b=o(v.value);return b.readInt(1)!==1||d(this.fileComment)!==b.readInt(4)?null:h.utf8decode(b.readData(v.length-5))}return null}},s.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,s,a){function o(b,g,_){this.name=b,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=g,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}}var l=r("./stream/StreamHelper"),u=r("./stream/DataWorker"),d=r("./utf8"),h=r("./compressedObject"),m=r("./stream/GenericWorker");o.prototype={internalStream:function(b){var g=null,_="string";try{if(!b)throw new Error("No output type specified.");var w=(_=b.toLowerCase())==="string"||_==="text";_!=="binarystring"&&_!=="text"||(_="string"),g=this._decompressWorker();var k=!this._dataBinary;k&&!w&&(g=g.pipe(new d.Utf8EncodeWorker)),!k&&w&&(g=g.pipe(new d.Utf8DecodeWorker))}catch(N){(g=new m("error")).error(N)}return new l(g,_,"")},async:function(b,g){return this.internalStream(b).accumulate(g)},nodeStream:function(b,g){return this.internalStream(b||"nodebuffer").toNodejsStream(g)},_compressWorker:function(b,g){if(this._data instanceof h&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new d.Utf8EncodeWorker)),h.createWorkerFrom(_,b,g)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof m?this._data:new u(this._data)}};for(var x=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},v=0;v<x.length;v++)o.prototype[x[v]]=y;s.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,s,a){(function(o){var l,u,d=o.MutationObserver||o.WebKitMutationObserver;if(d){var h=0,m=new d(b),x=o.document.createTextNode("");m.observe(x,{characterData:!0}),l=function(){x.data=h=++h%2}}else if(o.setImmediate||o.MessageChannel===void 0)l="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var g=o.document.createElement("script");g.onreadystatechange=function(){b(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},o.document.documentElement.appendChild(g)}:function(){setTimeout(b,0)};else{var y=new o.MessageChannel;y.port1.onmessage=b,l=function(){y.port2.postMessage(0)}}var v=[];function b(){var g,_;u=!0;for(var w=v.length;w;){for(_=v,v=[],g=-1;++g<w;)_[g]();w=v.length}u=!1}s.exports=function(g){v.push(g)!==1||u||l()}}).call(this,typeof Pn<"u"?Pn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,s,a){var o=r("immediate");function l(){}var u={},d=["REJECTED"],h=["FULFILLED"],m=["PENDING"];function x(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,w!==l&&g(this,w)}function y(w,k,N){this.promise=w,typeof k=="function"&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}function v(w,k,N){o(function(){var E;try{E=k(N)}catch(C){return u.reject(w,C)}E===w?u.reject(w,new TypeError("Cannot resolve promise with itself")):u.resolve(w,E)})}function b(w){var k=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof k=="function")return function(){k.apply(w,arguments)}}function g(w,k){var N=!1;function E(O){N||(N=!0,u.reject(w,O))}function C(O){N||(N=!0,u.resolve(w,O))}var L=_(function(){k(C,E)});L.status==="error"&&E(L.value)}function _(w,k){var N={};try{N.value=w(k),N.status="success"}catch(E){N.status="error",N.value=E}return N}(s.exports=x).prototype.finally=function(w){if(typeof w!="function")return this;var k=this.constructor;return this.then(function(N){return k.resolve(w()).then(function(){return N})},function(N){return k.resolve(w()).then(function(){throw N})})},x.prototype.catch=function(w){return this.then(null,w)},x.prototype.then=function(w,k){if(typeof w!="function"&&this.state===h||typeof k!="function"&&this.state===d)return this;var N=new this.constructor(l);return this.state!==m?v(N,this.state===h?w:k,this.outcome):this.queue.push(new y(N,w,k)),N},y.prototype.callFulfilled=function(w){u.resolve(this.promise,w)},y.prototype.otherCallFulfilled=function(w){v(this.promise,this.onFulfilled,w)},y.prototype.callRejected=function(w){u.reject(this.promise,w)},y.prototype.otherCallRejected=function(w){v(this.promise,this.onRejected,w)},u.resolve=function(w,k){var N=_(b,k);if(N.status==="error")return u.reject(w,N.value);var E=N.value;if(E)g(w,E);else{w.state=h,w.outcome=k;for(var C=-1,L=w.queue.length;++C<L;)w.queue[C].callFulfilled(k)}return w},u.reject=function(w,k){w.state=d,w.outcome=k;for(var N=-1,E=w.queue.length;++N<E;)w.queue[N].callRejected(k);return w},x.resolve=function(w){return w instanceof this?w:u.resolve(new this(l),w)},x.reject=function(w){var k=new this(l);return u.reject(k,w)},x.all=function(w){var k=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=w.length,E=!1;if(!N)return this.resolve([]);for(var C=new Array(N),L=0,O=-1,B=new this(l);++O<N;)F(w[O],O);return B;function F(q,fe){k.resolve(q).then(function(D){C[fe]=D,++L!==N||E||(E=!0,u.resolve(B,C))},function(D){E||(E=!0,u.reject(B,D))})}},x.race=function(w){var k=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=w.length,E=!1;if(!N)return this.resolve([]);for(var C=-1,L=new this(l);++C<N;)O=w[C],k.resolve(O).then(function(B){E||(E=!0,u.resolve(L,B))},function(B){E||(E=!0,u.reject(L,B))});var O;return L}},{immediate:36}],38:[function(r,s,a){var o={};(0,r("./lib/utils/common").assign)(o,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),s.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,s,a){var o=r("./zlib/deflate"),l=r("./utils/common"),u=r("./utils/strings"),d=r("./zlib/messages"),h=r("./zlib/zstream"),m=Object.prototype.toString,x=0,y=-1,v=0,b=8;function g(w){if(!(this instanceof g))return new g(w);this.options=l.assign({level:y,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},w||{});var k=this.options;k.raw&&0<k.windowBits?k.windowBits=-k.windowBits:k.gzip&&0<k.windowBits&&k.windowBits<16&&(k.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var N=o.deflateInit2(this.strm,k.level,k.method,k.windowBits,k.memLevel,k.strategy);if(N!==x)throw new Error(d[N]);if(k.header&&o.deflateSetHeader(this.strm,k.header),k.dictionary){var E;if(E=typeof k.dictionary=="string"?u.string2buf(k.dictionary):m.call(k.dictionary)==="[object ArrayBuffer]"?new Uint8Array(k.dictionary):k.dictionary,(N=o.deflateSetDictionary(this.strm,E))!==x)throw new Error(d[N]);this._dict_set=!0}}function _(w,k){var N=new g(k);if(N.push(w,!0),N.err)throw N.msg||d[N.err];return N.result}g.prototype.push=function(w,k){var N,E,C=this.strm,L=this.options.chunkSize;if(this.ended)return!1;E=k===~~k?k:k===!0?4:0,typeof w=="string"?C.input=u.string2buf(w):m.call(w)==="[object ArrayBuffer]"?C.input=new Uint8Array(w):C.input=w,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new l.Buf8(L),C.next_out=0,C.avail_out=L),(N=o.deflate(C,E))!==1&&N!==x)return this.onEnd(N),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(u.buf2binstring(l.shrinkBuf(C.output,C.next_out))):this.onData(l.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&N!==1);return E===4?(N=o.deflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===x):E!==2||(this.onEnd(x),!(C.avail_out=0))},g.prototype.onData=function(w){this.chunks.push(w)},g.prototype.onEnd=function(w){w===x&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},a.Deflate=g,a.deflate=_,a.deflateRaw=function(w,k){return(k=k||{}).raw=!0,_(w,k)},a.gzip=function(w,k){return(k=k||{}).gzip=!0,_(w,k)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,s,a){var o=r("./zlib/inflate"),l=r("./utils/common"),u=r("./utils/strings"),d=r("./zlib/constants"),h=r("./zlib/messages"),m=r("./zlib/zstream"),x=r("./zlib/gzheader"),y=Object.prototype.toString;function v(g){if(!(this instanceof v))return new v(g);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},g||{});var _=this.options;_.raw&&0<=_.windowBits&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),!(0<=_.windowBits&&_.windowBits<16)||g&&g.windowBits||(_.windowBits+=32),15<_.windowBits&&_.windowBits<48&&(15&_.windowBits)==0&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var w=o.inflateInit2(this.strm,_.windowBits);if(w!==d.Z_OK)throw new Error(h[w]);this.header=new x,o.inflateGetHeader(this.strm,this.header)}function b(g,_){var w=new v(_);if(w.push(g,!0),w.err)throw w.msg||h[w.err];return w.result}v.prototype.push=function(g,_){var w,k,N,E,C,L,O=this.strm,B=this.options.chunkSize,F=this.options.dictionary,q=!1;if(this.ended)return!1;k=_===~~_?_:_===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof g=="string"?O.input=u.binstring2buf(g):y.call(g)==="[object ArrayBuffer]"?O.input=new Uint8Array(g):O.input=g,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new l.Buf8(B),O.next_out=0,O.avail_out=B),(w=o.inflate(O,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&F&&(L=typeof F=="string"?u.string2buf(F):y.call(F)==="[object ArrayBuffer]"?new Uint8Array(F):F,w=o.inflateSetDictionary(this.strm,L)),w===d.Z_BUF_ERROR&&q===!0&&(w=d.Z_OK,q=!1),w!==d.Z_STREAM_END&&w!==d.Z_OK)return this.onEnd(w),!(this.ended=!0);O.next_out&&(O.avail_out!==0&&w!==d.Z_STREAM_END&&(O.avail_in!==0||k!==d.Z_FINISH&&k!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(N=u.utf8border(O.output,O.next_out),E=O.next_out-N,C=u.buf2string(O.output,N),O.next_out=E,O.avail_out=B-E,E&&l.arraySet(O.output,O.output,N,E,0),this.onData(C)):this.onData(l.shrinkBuf(O.output,O.next_out)))),O.avail_in===0&&O.avail_out===0&&(q=!0)}while((0<O.avail_in||O.avail_out===0)&&w!==d.Z_STREAM_END);return w===d.Z_STREAM_END&&(k=d.Z_FINISH),k===d.Z_FINISH?(w=o.inflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===d.Z_OK):k!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(O.avail_out=0))},v.prototype.onData=function(g){this.chunks.push(g)},v.prototype.onEnd=function(g){g===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},a.Inflate=v,a.inflate=b,a.inflateRaw=function(g,_){return(_=_||{}).raw=!0,b(g,_)},a.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,s,a){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(d){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var m=h.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var x in m)m.hasOwnProperty(x)&&(d[x]=m[x])}}return d},a.shrinkBuf=function(d,h){return d.length===h?d:d.subarray?d.subarray(0,h):(d.length=h,d)};var l={arraySet:function(d,h,m,x,y){if(h.subarray&&d.subarray)d.set(h.subarray(m,m+x),y);else for(var v=0;v<x;v++)d[y+v]=h[m+v]},flattenChunks:function(d){var h,m,x,y,v,b;for(h=x=0,m=d.length;h<m;h++)x+=d[h].length;for(b=new Uint8Array(x),h=y=0,m=d.length;h<m;h++)v=d[h],b.set(v,y),y+=v.length;return b}},u={arraySet:function(d,h,m,x,y){for(var v=0;v<x;v++)d[y+v]=h[m+v]},flattenChunks:function(d){return[].concat.apply([],d)}};a.setTyped=function(d){d?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,l)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,u))},a.setTyped(o)},{}],42:[function(r,s,a){var o=r("./common"),l=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var d=new o.Buf8(256),h=0;h<256;h++)d[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function m(x,y){if(y<65537&&(x.subarray&&u||!x.subarray&&l))return String.fromCharCode.apply(null,o.shrinkBuf(x,y));for(var v="",b=0;b<y;b++)v+=String.fromCharCode(x[b]);return v}d[254]=d[254]=1,a.string2buf=function(x){var y,v,b,g,_,w=x.length,k=0;for(g=0;g<w;g++)(64512&(v=x.charCodeAt(g)))==55296&&g+1<w&&(64512&(b=x.charCodeAt(g+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),g++),k+=v<128?1:v<2048?2:v<65536?3:4;for(y=new o.Buf8(k),g=_=0;_<k;g++)(64512&(v=x.charCodeAt(g)))==55296&&g+1<w&&(64512&(b=x.charCodeAt(g+1)))==56320&&(v=65536+(v-55296<<10)+(b-56320),g++),v<128?y[_++]=v:(v<2048?y[_++]=192|v>>>6:(v<65536?y[_++]=224|v>>>12:(y[_++]=240|v>>>18,y[_++]=128|v>>>12&63),y[_++]=128|v>>>6&63),y[_++]=128|63&v);return y},a.buf2binstring=function(x){return m(x,x.length)},a.binstring2buf=function(x){for(var y=new o.Buf8(x.length),v=0,b=y.length;v<b;v++)y[v]=x.charCodeAt(v);return y},a.buf2string=function(x,y){var v,b,g,_,w=y||x.length,k=new Array(2*w);for(v=b=0;v<w;)if((g=x[v++])<128)k[b++]=g;else if(4<(_=d[g]))k[b++]=65533,v+=_-1;else{for(g&=_===2?31:_===3?15:7;1<_&&v<w;)g=g<<6|63&x[v++],_--;1<_?k[b++]=65533:g<65536?k[b++]=g:(g-=65536,k[b++]=55296|g>>10&1023,k[b++]=56320|1023&g)}return m(k,b)},a.utf8border=function(x,y){var v;for((y=y||x.length)>x.length&&(y=x.length),v=y-1;0<=v&&(192&x[v])==128;)v--;return v<0||v===0?y:v+d[x[v]]>y?v:y}},{"./common":41}],43:[function(r,s,a){s.exports=function(o,l,u,d){for(var h=65535&o|0,m=o>>>16&65535|0,x=0;u!==0;){for(u-=x=2e3<u?2e3:u;m=m+(h=h+l[d++]|0)|0,--x;);h%=65521,m%=65521}return h|m<<16|0}},{}],44:[function(r,s,a){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,s,a){var o=(function(){for(var l,u=[],d=0;d<256;d++){l=d;for(var h=0;h<8;h++)l=1&l?3988292384^l>>>1:l>>>1;u[d]=l}return u})();s.exports=function(l,u,d,h){var m=o,x=h+d;l^=-1;for(var y=h;y<x;y++)l=l>>>8^m[255&(l^u[y])];return-1^l}},{}],46:[function(r,s,a){var o,l=r("../utils/common"),u=r("./trees"),d=r("./adler32"),h=r("./crc32"),m=r("./messages"),x=0,y=4,v=0,b=-2,g=-1,_=4,w=2,k=8,N=9,E=286,C=30,L=19,O=2*E+1,B=15,F=3,q=258,fe=q+F+1,D=42,V=113,I=1,ae=2,Q=3,te=4;function ve(S,ue){return S.msg=m[ue],ue}function ee(S){return(S<<1)-(4<S?9:0)}function Se(S){for(var ue=S.length;0<=--ue;)S[ue]=0}function J(S){var ue=S.state,z=ue.pending;z>S.avail_out&&(z=S.avail_out),z!==0&&(l.arraySet(S.output,ue.pending_buf,ue.pending_out,z,S.next_out),S.next_out+=z,ue.pending_out+=z,S.total_out+=z,S.avail_out-=z,ue.pending-=z,ue.pending===0&&(ue.pending_out=0))}function M(S,ue){u._tr_flush_block(S,0<=S.block_start?S.block_start:-1,S.strstart-S.block_start,ue),S.block_start=S.strstart,J(S.strm)}function Y(S,ue){S.pending_buf[S.pending++]=ue}function G(S,ue){S.pending_buf[S.pending++]=ue>>>8&255,S.pending_buf[S.pending++]=255&ue}function re(S,ue){var z,T,A=S.max_chain_length,W=S.strstart,pe=S.prev_length,_e=S.nice_match,oe=S.strstart>S.w_size-fe?S.strstart-(S.w_size-fe):0,Te=S.window,Me=S.w_mask,Ae=S.prev,Re=S.strstart+q,et=Te[W+pe-1],He=Te[W+pe];S.prev_length>=S.good_match&&(A>>=2),_e>S.lookahead&&(_e=S.lookahead);do if(Te[(z=ue)+pe]===He&&Te[z+pe-1]===et&&Te[z]===Te[W]&&Te[++z]===Te[W+1]){W+=2,z++;do;while(Te[++W]===Te[++z]&&Te[++W]===Te[++z]&&Te[++W]===Te[++z]&&Te[++W]===Te[++z]&&Te[++W]===Te[++z]&&Te[++W]===Te[++z]&&Te[++W]===Te[++z]&&Te[++W]===Te[++z]&&W<Re);if(T=q-(Re-W),W=Re-q,pe<T){if(S.match_start=ue,_e<=(pe=T))break;et=Te[W+pe-1],He=Te[W+pe]}}while((ue=Ae[ue&Me])>oe&&--A!=0);return pe<=S.lookahead?pe:S.lookahead}function ce(S){var ue,z,T,A,W,pe,_e,oe,Te,Me,Ae=S.w_size;do{if(A=S.window_size-S.lookahead-S.strstart,S.strstart>=Ae+(Ae-fe)){for(l.arraySet(S.window,S.window,Ae,Ae,0),S.match_start-=Ae,S.strstart-=Ae,S.block_start-=Ae,ue=z=S.hash_size;T=S.head[--ue],S.head[ue]=Ae<=T?T-Ae:0,--z;);for(ue=z=Ae;T=S.prev[--ue],S.prev[ue]=Ae<=T?T-Ae:0,--z;);A+=Ae}if(S.strm.avail_in===0)break;if(pe=S.strm,_e=S.window,oe=S.strstart+S.lookahead,Te=A,Me=void 0,Me=pe.avail_in,Te<Me&&(Me=Te),z=Me===0?0:(pe.avail_in-=Me,l.arraySet(_e,pe.input,pe.next_in,Me,oe),pe.state.wrap===1?pe.adler=d(pe.adler,_e,Me,oe):pe.state.wrap===2&&(pe.adler=h(pe.adler,_e,Me,oe)),pe.next_in+=Me,pe.total_in+=Me,Me),S.lookahead+=z,S.lookahead+S.insert>=F)for(W=S.strstart-S.insert,S.ins_h=S.window[W],S.ins_h=(S.ins_h<<S.hash_shift^S.window[W+1])&S.hash_mask;S.insert&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[W+F-1])&S.hash_mask,S.prev[W&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=W,W++,S.insert--,!(S.lookahead+S.insert<F)););}while(S.lookahead<fe&&S.strm.avail_in!==0)}function P(S,ue){for(var z,T;;){if(S.lookahead<fe){if(ce(S),S.lookahead<fe&&ue===x)return I;if(S.lookahead===0)break}if(z=0,S.lookahead>=F&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+F-1])&S.hash_mask,z=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),z!==0&&S.strstart-z<=S.w_size-fe&&(S.match_length=re(S,z)),S.match_length>=F)if(T=u._tr_tally(S,S.strstart-S.match_start,S.match_length-F),S.lookahead-=S.match_length,S.match_length<=S.max_lazy_match&&S.lookahead>=F){for(S.match_length--;S.strstart++,S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+F-1])&S.hash_mask,z=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart,--S.match_length!=0;);S.strstart++}else S.strstart+=S.match_length,S.match_length=0,S.ins_h=S.window[S.strstart],S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+1])&S.hash_mask;else T=u._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++;if(T&&(M(S,!1),S.strm.avail_out===0))return I}return S.insert=S.strstart<F-1?S.strstart:F-1,ue===y?(M(S,!0),S.strm.avail_out===0?Q:te):S.last_lit&&(M(S,!1),S.strm.avail_out===0)?I:ae}function U(S,ue){for(var z,T,A;;){if(S.lookahead<fe){if(ce(S),S.lookahead<fe&&ue===x)return I;if(S.lookahead===0)break}if(z=0,S.lookahead>=F&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+F-1])&S.hash_mask,z=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),S.prev_length=S.match_length,S.prev_match=S.match_start,S.match_length=F-1,z!==0&&S.prev_length<S.max_lazy_match&&S.strstart-z<=S.w_size-fe&&(S.match_length=re(S,z),S.match_length<=5&&(S.strategy===1||S.match_length===F&&4096<S.strstart-S.match_start)&&(S.match_length=F-1)),S.prev_length>=F&&S.match_length<=S.prev_length){for(A=S.strstart+S.lookahead-F,T=u._tr_tally(S,S.strstart-1-S.prev_match,S.prev_length-F),S.lookahead-=S.prev_length-1,S.prev_length-=2;++S.strstart<=A&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+F-1])&S.hash_mask,z=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),--S.prev_length!=0;);if(S.match_available=0,S.match_length=F-1,S.strstart++,T&&(M(S,!1),S.strm.avail_out===0))return I}else if(S.match_available){if((T=u._tr_tally(S,0,S.window[S.strstart-1]))&&M(S,!1),S.strstart++,S.lookahead--,S.strm.avail_out===0)return I}else S.match_available=1,S.strstart++,S.lookahead--}return S.match_available&&(T=u._tr_tally(S,0,S.window[S.strstart-1]),S.match_available=0),S.insert=S.strstart<F-1?S.strstart:F-1,ue===y?(M(S,!0),S.strm.avail_out===0?Q:te):S.last_lit&&(M(S,!1),S.strm.avail_out===0)?I:ae}function le(S,ue,z,T,A){this.good_length=S,this.max_lazy=ue,this.nice_length=z,this.max_chain=T,this.func=A}function ne(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=k,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*O),this.dyn_dtree=new l.Buf16(2*(2*C+1)),this.bl_tree=new l.Buf16(2*(2*L+1)),Se(this.dyn_ltree),Se(this.dyn_dtree),Se(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(B+1),this.heap=new l.Buf16(2*E+1),Se(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*E+1),Se(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ie(S){var ue;return S&&S.state?(S.total_in=S.total_out=0,S.data_type=w,(ue=S.state).pending=0,ue.pending_out=0,ue.wrap<0&&(ue.wrap=-ue.wrap),ue.status=ue.wrap?D:V,S.adler=ue.wrap===2?0:1,ue.last_flush=x,u._tr_init(ue),v):ve(S,b)}function H(S){var ue=ie(S);return ue===v&&(function(z){z.window_size=2*z.w_size,Se(z.head),z.max_lazy_match=o[z.level].max_lazy,z.good_match=o[z.level].good_length,z.nice_match=o[z.level].nice_length,z.max_chain_length=o[z.level].max_chain,z.strstart=0,z.block_start=0,z.lookahead=0,z.insert=0,z.match_length=z.prev_length=F-1,z.match_available=0,z.ins_h=0})(S.state),ue}function K(S,ue,z,T,A,W){if(!S)return b;var pe=1;if(ue===g&&(ue=6),T<0?(pe=0,T=-T):15<T&&(pe=2,T-=16),A<1||N<A||z!==k||T<8||15<T||ue<0||9<ue||W<0||_<W)return ve(S,b);T===8&&(T=9);var _e=new ne;return(S.state=_e).strm=S,_e.wrap=pe,_e.gzhead=null,_e.w_bits=T,_e.w_size=1<<_e.w_bits,_e.w_mask=_e.w_size-1,_e.hash_bits=A+7,_e.hash_size=1<<_e.hash_bits,_e.hash_mask=_e.hash_size-1,_e.hash_shift=~~((_e.hash_bits+F-1)/F),_e.window=new l.Buf8(2*_e.w_size),_e.head=new l.Buf16(_e.hash_size),_e.prev=new l.Buf16(_e.w_size),_e.lit_bufsize=1<<A+6,_e.pending_buf_size=4*_e.lit_bufsize,_e.pending_buf=new l.Buf8(_e.pending_buf_size),_e.d_buf=1*_e.lit_bufsize,_e.l_buf=3*_e.lit_bufsize,_e.level=ue,_e.strategy=W,_e.method=z,H(S)}o=[new le(0,0,0,0,function(S,ue){var z=65535;for(z>S.pending_buf_size-5&&(z=S.pending_buf_size-5);;){if(S.lookahead<=1){if(ce(S),S.lookahead===0&&ue===x)return I;if(S.lookahead===0)break}S.strstart+=S.lookahead,S.lookahead=0;var T=S.block_start+z;if((S.strstart===0||S.strstart>=T)&&(S.lookahead=S.strstart-T,S.strstart=T,M(S,!1),S.strm.avail_out===0)||S.strstart-S.block_start>=S.w_size-fe&&(M(S,!1),S.strm.avail_out===0))return I}return S.insert=0,ue===y?(M(S,!0),S.strm.avail_out===0?Q:te):(S.strstart>S.block_start&&(M(S,!1),S.strm.avail_out),I)}),new le(4,4,8,4,P),new le(4,5,16,8,P),new le(4,6,32,32,P),new le(4,4,16,16,U),new le(8,16,32,32,U),new le(8,16,128,128,U),new le(8,32,128,256,U),new le(32,128,258,1024,U),new le(32,258,258,4096,U)],a.deflateInit=function(S,ue){return K(S,ue,k,15,8,0)},a.deflateInit2=K,a.deflateReset=H,a.deflateResetKeep=ie,a.deflateSetHeader=function(S,ue){return S&&S.state?S.state.wrap!==2?b:(S.state.gzhead=ue,v):b},a.deflate=function(S,ue){var z,T,A,W;if(!S||!S.state||5<ue||ue<0)return S?ve(S,b):b;if(T=S.state,!S.output||!S.input&&S.avail_in!==0||T.status===666&&ue!==y)return ve(S,S.avail_out===0?-5:b);if(T.strm=S,z=T.last_flush,T.last_flush=ue,T.status===D)if(T.wrap===2)S.adler=0,Y(T,31),Y(T,139),Y(T,8),T.gzhead?(Y(T,(T.gzhead.text?1:0)+(T.gzhead.hcrc?2:0)+(T.gzhead.extra?4:0)+(T.gzhead.name?8:0)+(T.gzhead.comment?16:0)),Y(T,255&T.gzhead.time),Y(T,T.gzhead.time>>8&255),Y(T,T.gzhead.time>>16&255),Y(T,T.gzhead.time>>24&255),Y(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),Y(T,255&T.gzhead.os),T.gzhead.extra&&T.gzhead.extra.length&&(Y(T,255&T.gzhead.extra.length),Y(T,T.gzhead.extra.length>>8&255)),T.gzhead.hcrc&&(S.adler=h(S.adler,T.pending_buf,T.pending,0)),T.gzindex=0,T.status=69):(Y(T,0),Y(T,0),Y(T,0),Y(T,0),Y(T,0),Y(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),Y(T,3),T.status=V);else{var pe=k+(T.w_bits-8<<4)<<8;pe|=(2<=T.strategy||T.level<2?0:T.level<6?1:T.level===6?2:3)<<6,T.strstart!==0&&(pe|=32),pe+=31-pe%31,T.status=V,G(T,pe),T.strstart!==0&&(G(T,S.adler>>>16),G(T,65535&S.adler)),S.adler=1}if(T.status===69)if(T.gzhead.extra){for(A=T.pending;T.gzindex<(65535&T.gzhead.extra.length)&&(T.pending!==T.pending_buf_size||(T.gzhead.hcrc&&T.pending>A&&(S.adler=h(S.adler,T.pending_buf,T.pending-A,A)),J(S),A=T.pending,T.pending!==T.pending_buf_size));)Y(T,255&T.gzhead.extra[T.gzindex]),T.gzindex++;T.gzhead.hcrc&&T.pending>A&&(S.adler=h(S.adler,T.pending_buf,T.pending-A,A)),T.gzindex===T.gzhead.extra.length&&(T.gzindex=0,T.status=73)}else T.status=73;if(T.status===73)if(T.gzhead.name){A=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>A&&(S.adler=h(S.adler,T.pending_buf,T.pending-A,A)),J(S),A=T.pending,T.pending===T.pending_buf_size)){W=1;break}W=T.gzindex<T.gzhead.name.length?255&T.gzhead.name.charCodeAt(T.gzindex++):0,Y(T,W)}while(W!==0);T.gzhead.hcrc&&T.pending>A&&(S.adler=h(S.adler,T.pending_buf,T.pending-A,A)),W===0&&(T.gzindex=0,T.status=91)}else T.status=91;if(T.status===91)if(T.gzhead.comment){A=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>A&&(S.adler=h(S.adler,T.pending_buf,T.pending-A,A)),J(S),A=T.pending,T.pending===T.pending_buf_size)){W=1;break}W=T.gzindex<T.gzhead.comment.length?255&T.gzhead.comment.charCodeAt(T.gzindex++):0,Y(T,W)}while(W!==0);T.gzhead.hcrc&&T.pending>A&&(S.adler=h(S.adler,T.pending_buf,T.pending-A,A)),W===0&&(T.status=103)}else T.status=103;if(T.status===103&&(T.gzhead.hcrc?(T.pending+2>T.pending_buf_size&&J(S),T.pending+2<=T.pending_buf_size&&(Y(T,255&S.adler),Y(T,S.adler>>8&255),S.adler=0,T.status=V)):T.status=V),T.pending!==0){if(J(S),S.avail_out===0)return T.last_flush=-1,v}else if(S.avail_in===0&&ee(ue)<=ee(z)&&ue!==y)return ve(S,-5);if(T.status===666&&S.avail_in!==0)return ve(S,-5);if(S.avail_in!==0||T.lookahead!==0||ue!==x&&T.status!==666){var _e=T.strategy===2?(function(oe,Te){for(var Me;;){if(oe.lookahead===0&&(ce(oe),oe.lookahead===0)){if(Te===x)return I;break}if(oe.match_length=0,Me=u._tr_tally(oe,0,oe.window[oe.strstart]),oe.lookahead--,oe.strstart++,Me&&(M(oe,!1),oe.strm.avail_out===0))return I}return oe.insert=0,Te===y?(M(oe,!0),oe.strm.avail_out===0?Q:te):oe.last_lit&&(M(oe,!1),oe.strm.avail_out===0)?I:ae})(T,ue):T.strategy===3?(function(oe,Te){for(var Me,Ae,Re,et,He=oe.window;;){if(oe.lookahead<=q){if(ce(oe),oe.lookahead<=q&&Te===x)return I;if(oe.lookahead===0)break}if(oe.match_length=0,oe.lookahead>=F&&0<oe.strstart&&(Ae=He[Re=oe.strstart-1])===He[++Re]&&Ae===He[++Re]&&Ae===He[++Re]){et=oe.strstart+q;do;while(Ae===He[++Re]&&Ae===He[++Re]&&Ae===He[++Re]&&Ae===He[++Re]&&Ae===He[++Re]&&Ae===He[++Re]&&Ae===He[++Re]&&Ae===He[++Re]&&Re<et);oe.match_length=q-(et-Re),oe.match_length>oe.lookahead&&(oe.match_length=oe.lookahead)}if(oe.match_length>=F?(Me=u._tr_tally(oe,1,oe.match_length-F),oe.lookahead-=oe.match_length,oe.strstart+=oe.match_length,oe.match_length=0):(Me=u._tr_tally(oe,0,oe.window[oe.strstart]),oe.lookahead--,oe.strstart++),Me&&(M(oe,!1),oe.strm.avail_out===0))return I}return oe.insert=0,Te===y?(M(oe,!0),oe.strm.avail_out===0?Q:te):oe.last_lit&&(M(oe,!1),oe.strm.avail_out===0)?I:ae})(T,ue):o[T.level].func(T,ue);if(_e!==Q&&_e!==te||(T.status=666),_e===I||_e===Q)return S.avail_out===0&&(T.last_flush=-1),v;if(_e===ae&&(ue===1?u._tr_align(T):ue!==5&&(u._tr_stored_block(T,0,0,!1),ue===3&&(Se(T.head),T.lookahead===0&&(T.strstart=0,T.block_start=0,T.insert=0))),J(S),S.avail_out===0))return T.last_flush=-1,v}return ue!==y?v:T.wrap<=0?1:(T.wrap===2?(Y(T,255&S.adler),Y(T,S.adler>>8&255),Y(T,S.adler>>16&255),Y(T,S.adler>>24&255),Y(T,255&S.total_in),Y(T,S.total_in>>8&255),Y(T,S.total_in>>16&255),Y(T,S.total_in>>24&255)):(G(T,S.adler>>>16),G(T,65535&S.adler)),J(S),0<T.wrap&&(T.wrap=-T.wrap),T.pending!==0?v:1)},a.deflateEnd=function(S){var ue;return S&&S.state?(ue=S.state.status)!==D&&ue!==69&&ue!==73&&ue!==91&&ue!==103&&ue!==V&&ue!==666?ve(S,b):(S.state=null,ue===V?ve(S,-3):v):b},a.deflateSetDictionary=function(S,ue){var z,T,A,W,pe,_e,oe,Te,Me=ue.length;if(!S||!S.state||(W=(z=S.state).wrap)===2||W===1&&z.status!==D||z.lookahead)return b;for(W===1&&(S.adler=d(S.adler,ue,Me,0)),z.wrap=0,Me>=z.w_size&&(W===0&&(Se(z.head),z.strstart=0,z.block_start=0,z.insert=0),Te=new l.Buf8(z.w_size),l.arraySet(Te,ue,Me-z.w_size,z.w_size,0),ue=Te,Me=z.w_size),pe=S.avail_in,_e=S.next_in,oe=S.input,S.avail_in=Me,S.next_in=0,S.input=ue,ce(z);z.lookahead>=F;){for(T=z.strstart,A=z.lookahead-(F-1);z.ins_h=(z.ins_h<<z.hash_shift^z.window[T+F-1])&z.hash_mask,z.prev[T&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=T,T++,--A;);z.strstart=T,z.lookahead=F-1,ce(z)}return z.strstart+=z.lookahead,z.block_start=z.strstart,z.insert=z.lookahead,z.lookahead=0,z.match_length=z.prev_length=F-1,z.match_available=0,S.next_in=_e,S.input=oe,S.avail_in=pe,z.wrap=W,v},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,s,a){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,s,a){s.exports=function(o,l){var u,d,h,m,x,y,v,b,g,_,w,k,N,E,C,L,O,B,F,q,fe,D,V,I,ae;u=o.state,d=o.next_in,I=o.input,h=d+(o.avail_in-5),m=o.next_out,ae=o.output,x=m-(l-o.avail_out),y=m+(o.avail_out-257),v=u.dmax,b=u.wsize,g=u.whave,_=u.wnext,w=u.window,k=u.hold,N=u.bits,E=u.lencode,C=u.distcode,L=(1<<u.lenbits)-1,O=(1<<u.distbits)-1;e:do{N<15&&(k+=I[d++]<<N,N+=8,k+=I[d++]<<N,N+=8),B=E[k&L];t:for(;;){if(k>>>=F=B>>>24,N-=F,(F=B>>>16&255)===0)ae[m++]=65535&B;else{if(!(16&F)){if((64&F)==0){B=E[(65535&B)+(k&(1<<F)-1)];continue t}if(32&F){u.mode=12;break e}o.msg="invalid literal/length code",u.mode=30;break e}q=65535&B,(F&=15)&&(N<F&&(k+=I[d++]<<N,N+=8),q+=k&(1<<F)-1,k>>>=F,N-=F),N<15&&(k+=I[d++]<<N,N+=8,k+=I[d++]<<N,N+=8),B=C[k&O];r:for(;;){if(k>>>=F=B>>>24,N-=F,!(16&(F=B>>>16&255))){if((64&F)==0){B=C[(65535&B)+(k&(1<<F)-1)];continue r}o.msg="invalid distance code",u.mode=30;break e}if(fe=65535&B,N<(F&=15)&&(k+=I[d++]<<N,(N+=8)<F&&(k+=I[d++]<<N,N+=8)),v<(fe+=k&(1<<F)-1)){o.msg="invalid distance too far back",u.mode=30;break e}if(k>>>=F,N-=F,(F=m-x)<fe){if(g<(F=fe-F)&&u.sane){o.msg="invalid distance too far back",u.mode=30;break e}if(V=w,(D=0)===_){if(D+=b-F,F<q){for(q-=F;ae[m++]=w[D++],--F;);D=m-fe,V=ae}}else if(_<F){if(D+=b+_-F,(F-=_)<q){for(q-=F;ae[m++]=w[D++],--F;);if(D=0,_<q){for(q-=F=_;ae[m++]=w[D++],--F;);D=m-fe,V=ae}}}else if(D+=_-F,F<q){for(q-=F;ae[m++]=w[D++],--F;);D=m-fe,V=ae}for(;2<q;)ae[m++]=V[D++],ae[m++]=V[D++],ae[m++]=V[D++],q-=3;q&&(ae[m++]=V[D++],1<q&&(ae[m++]=V[D++]))}else{for(D=m-fe;ae[m++]=ae[D++],ae[m++]=ae[D++],ae[m++]=ae[D++],2<(q-=3););q&&(ae[m++]=ae[D++],1<q&&(ae[m++]=ae[D++]))}break}}break}}while(d<h&&m<y);d-=q=N>>3,k&=(1<<(N-=q<<3))-1,o.next_in=d,o.next_out=m,o.avail_in=d<h?h-d+5:5-(d-h),o.avail_out=m<y?y-m+257:257-(m-y),u.hold=k,u.bits=N}},{}],49:[function(r,s,a){var o=r("../utils/common"),l=r("./adler32"),u=r("./crc32"),d=r("./inffast"),h=r("./inftrees"),m=1,x=2,y=0,v=-2,b=1,g=852,_=592;function w(D){return(D>>>24&255)+(D>>>8&65280)+((65280&D)<<8)+((255&D)<<24)}function k(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function N(D){var V;return D&&D.state?(V=D.state,D.total_in=D.total_out=V.total=0,D.msg="",V.wrap&&(D.adler=1&V.wrap),V.mode=b,V.last=0,V.havedict=0,V.dmax=32768,V.head=null,V.hold=0,V.bits=0,V.lencode=V.lendyn=new o.Buf32(g),V.distcode=V.distdyn=new o.Buf32(_),V.sane=1,V.back=-1,y):v}function E(D){var V;return D&&D.state?((V=D.state).wsize=0,V.whave=0,V.wnext=0,N(D)):v}function C(D,V){var I,ae;return D&&D.state?(ae=D.state,V<0?(I=0,V=-V):(I=1+(V>>4),V<48&&(V&=15)),V&&(V<8||15<V)?v:(ae.window!==null&&ae.wbits!==V&&(ae.window=null),ae.wrap=I,ae.wbits=V,E(D))):v}function L(D,V){var I,ae;return D?(ae=new k,(D.state=ae).window=null,(I=C(D,V))!==y&&(D.state=null),I):v}var O,B,F=!0;function q(D){if(F){var V;for(O=new o.Buf32(512),B=new o.Buf32(32),V=0;V<144;)D.lens[V++]=8;for(;V<256;)D.lens[V++]=9;for(;V<280;)D.lens[V++]=7;for(;V<288;)D.lens[V++]=8;for(h(m,D.lens,0,288,O,0,D.work,{bits:9}),V=0;V<32;)D.lens[V++]=5;h(x,D.lens,0,32,B,0,D.work,{bits:5}),F=!1}D.lencode=O,D.lenbits=9,D.distcode=B,D.distbits=5}function fe(D,V,I,ae){var Q,te=D.state;return te.window===null&&(te.wsize=1<<te.wbits,te.wnext=0,te.whave=0,te.window=new o.Buf8(te.wsize)),ae>=te.wsize?(o.arraySet(te.window,V,I-te.wsize,te.wsize,0),te.wnext=0,te.whave=te.wsize):(ae<(Q=te.wsize-te.wnext)&&(Q=ae),o.arraySet(te.window,V,I-ae,Q,te.wnext),(ae-=Q)?(o.arraySet(te.window,V,I-ae,ae,0),te.wnext=ae,te.whave=te.wsize):(te.wnext+=Q,te.wnext===te.wsize&&(te.wnext=0),te.whave<te.wsize&&(te.whave+=Q))),0}a.inflateReset=E,a.inflateReset2=C,a.inflateResetKeep=N,a.inflateInit=function(D){return L(D,15)},a.inflateInit2=L,a.inflate=function(D,V){var I,ae,Q,te,ve,ee,Se,J,M,Y,G,re,ce,P,U,le,ne,ie,H,K,S,ue,z,T,A=0,W=new o.Buf8(4),pe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!D||!D.state||!D.output||!D.input&&D.avail_in!==0)return v;(I=D.state).mode===12&&(I.mode=13),ve=D.next_out,Q=D.output,Se=D.avail_out,te=D.next_in,ae=D.input,ee=D.avail_in,J=I.hold,M=I.bits,Y=ee,G=Se,ue=y;e:for(;;)switch(I.mode){case b:if(I.wrap===0){I.mode=13;break}for(;M<16;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}if(2&I.wrap&&J===35615){W[I.check=0]=255&J,W[1]=J>>>8&255,I.check=u(I.check,W,2,0),M=J=0,I.mode=2;break}if(I.flags=0,I.head&&(I.head.done=!1),!(1&I.wrap)||(((255&J)<<8)+(J>>8))%31){D.msg="incorrect header check",I.mode=30;break}if((15&J)!=8){D.msg="unknown compression method",I.mode=30;break}if(M-=4,S=8+(15&(J>>>=4)),I.wbits===0)I.wbits=S;else if(S>I.wbits){D.msg="invalid window size",I.mode=30;break}I.dmax=1<<S,D.adler=I.check=1,I.mode=512&J?10:12,M=J=0;break;case 2:for(;M<16;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}if(I.flags=J,(255&I.flags)!=8){D.msg="unknown compression method",I.mode=30;break}if(57344&I.flags){D.msg="unknown header flags set",I.mode=30;break}I.head&&(I.head.text=J>>8&1),512&I.flags&&(W[0]=255&J,W[1]=J>>>8&255,I.check=u(I.check,W,2,0)),M=J=0,I.mode=3;case 3:for(;M<32;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}I.head&&(I.head.time=J),512&I.flags&&(W[0]=255&J,W[1]=J>>>8&255,W[2]=J>>>16&255,W[3]=J>>>24&255,I.check=u(I.check,W,4,0)),M=J=0,I.mode=4;case 4:for(;M<16;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}I.head&&(I.head.xflags=255&J,I.head.os=J>>8),512&I.flags&&(W[0]=255&J,W[1]=J>>>8&255,I.check=u(I.check,W,2,0)),M=J=0,I.mode=5;case 5:if(1024&I.flags){for(;M<16;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}I.length=J,I.head&&(I.head.extra_len=J),512&I.flags&&(W[0]=255&J,W[1]=J>>>8&255,I.check=u(I.check,W,2,0)),M=J=0}else I.head&&(I.head.extra=null);I.mode=6;case 6:if(1024&I.flags&&(ee<(re=I.length)&&(re=ee),re&&(I.head&&(S=I.head.extra_len-I.length,I.head.extra||(I.head.extra=new Array(I.head.extra_len)),o.arraySet(I.head.extra,ae,te,re,S)),512&I.flags&&(I.check=u(I.check,ae,re,te)),ee-=re,te+=re,I.length-=re),I.length))break e;I.length=0,I.mode=7;case 7:if(2048&I.flags){if(ee===0)break e;for(re=0;S=ae[te+re++],I.head&&S&&I.length<65536&&(I.head.name+=String.fromCharCode(S)),S&&re<ee;);if(512&I.flags&&(I.check=u(I.check,ae,re,te)),ee-=re,te+=re,S)break e}else I.head&&(I.head.name=null);I.length=0,I.mode=8;case 8:if(4096&I.flags){if(ee===0)break e;for(re=0;S=ae[te+re++],I.head&&S&&I.length<65536&&(I.head.comment+=String.fromCharCode(S)),S&&re<ee;);if(512&I.flags&&(I.check=u(I.check,ae,re,te)),ee-=re,te+=re,S)break e}else I.head&&(I.head.comment=null);I.mode=9;case 9:if(512&I.flags){for(;M<16;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}if(J!==(65535&I.check)){D.msg="header crc mismatch",I.mode=30;break}M=J=0}I.head&&(I.head.hcrc=I.flags>>9&1,I.head.done=!0),D.adler=I.check=0,I.mode=12;break;case 10:for(;M<32;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}D.adler=I.check=w(J),M=J=0,I.mode=11;case 11:if(I.havedict===0)return D.next_out=ve,D.avail_out=Se,D.next_in=te,D.avail_in=ee,I.hold=J,I.bits=M,2;D.adler=I.check=1,I.mode=12;case 12:if(V===5||V===6)break e;case 13:if(I.last){J>>>=7&M,M-=7&M,I.mode=27;break}for(;M<3;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}switch(I.last=1&J,M-=1,3&(J>>>=1)){case 0:I.mode=14;break;case 1:if(q(I),I.mode=20,V!==6)break;J>>>=2,M-=2;break e;case 2:I.mode=17;break;case 3:D.msg="invalid block type",I.mode=30}J>>>=2,M-=2;break;case 14:for(J>>>=7&M,M-=7&M;M<32;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}if((65535&J)!=(J>>>16^65535)){D.msg="invalid stored block lengths",I.mode=30;break}if(I.length=65535&J,M=J=0,I.mode=15,V===6)break e;case 15:I.mode=16;case 16:if(re=I.length){if(ee<re&&(re=ee),Se<re&&(re=Se),re===0)break e;o.arraySet(Q,ae,te,re,ve),ee-=re,te+=re,Se-=re,ve+=re,I.length-=re;break}I.mode=12;break;case 17:for(;M<14;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}if(I.nlen=257+(31&J),J>>>=5,M-=5,I.ndist=1+(31&J),J>>>=5,M-=5,I.ncode=4+(15&J),J>>>=4,M-=4,286<I.nlen||30<I.ndist){D.msg="too many length or distance symbols",I.mode=30;break}I.have=0,I.mode=18;case 18:for(;I.have<I.ncode;){for(;M<3;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}I.lens[pe[I.have++]]=7&J,J>>>=3,M-=3}for(;I.have<19;)I.lens[pe[I.have++]]=0;if(I.lencode=I.lendyn,I.lenbits=7,z={bits:I.lenbits},ue=h(0,I.lens,0,19,I.lencode,0,I.work,z),I.lenbits=z.bits,ue){D.msg="invalid code lengths set",I.mode=30;break}I.have=0,I.mode=19;case 19:for(;I.have<I.nlen+I.ndist;){for(;le=(A=I.lencode[J&(1<<I.lenbits)-1])>>>16&255,ne=65535&A,!((U=A>>>24)<=M);){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}if(ne<16)J>>>=U,M-=U,I.lens[I.have++]=ne;else{if(ne===16){for(T=U+2;M<T;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}if(J>>>=U,M-=U,I.have===0){D.msg="invalid bit length repeat",I.mode=30;break}S=I.lens[I.have-1],re=3+(3&J),J>>>=2,M-=2}else if(ne===17){for(T=U+3;M<T;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}M-=U,S=0,re=3+(7&(J>>>=U)),J>>>=3,M-=3}else{for(T=U+7;M<T;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}M-=U,S=0,re=11+(127&(J>>>=U)),J>>>=7,M-=7}if(I.have+re>I.nlen+I.ndist){D.msg="invalid bit length repeat",I.mode=30;break}for(;re--;)I.lens[I.have++]=S}}if(I.mode===30)break;if(I.lens[256]===0){D.msg="invalid code -- missing end-of-block",I.mode=30;break}if(I.lenbits=9,z={bits:I.lenbits},ue=h(m,I.lens,0,I.nlen,I.lencode,0,I.work,z),I.lenbits=z.bits,ue){D.msg="invalid literal/lengths set",I.mode=30;break}if(I.distbits=6,I.distcode=I.distdyn,z={bits:I.distbits},ue=h(x,I.lens,I.nlen,I.ndist,I.distcode,0,I.work,z),I.distbits=z.bits,ue){D.msg="invalid distances set",I.mode=30;break}if(I.mode=20,V===6)break e;case 20:I.mode=21;case 21:if(6<=ee&&258<=Se){D.next_out=ve,D.avail_out=Se,D.next_in=te,D.avail_in=ee,I.hold=J,I.bits=M,d(D,G),ve=D.next_out,Q=D.output,Se=D.avail_out,te=D.next_in,ae=D.input,ee=D.avail_in,J=I.hold,M=I.bits,I.mode===12&&(I.back=-1);break}for(I.back=0;le=(A=I.lencode[J&(1<<I.lenbits)-1])>>>16&255,ne=65535&A,!((U=A>>>24)<=M);){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}if(le&&(240&le)==0){for(ie=U,H=le,K=ne;le=(A=I.lencode[K+((J&(1<<ie+H)-1)>>ie)])>>>16&255,ne=65535&A,!(ie+(U=A>>>24)<=M);){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}J>>>=ie,M-=ie,I.back+=ie}if(J>>>=U,M-=U,I.back+=U,I.length=ne,le===0){I.mode=26;break}if(32&le){I.back=-1,I.mode=12;break}if(64&le){D.msg="invalid literal/length code",I.mode=30;break}I.extra=15&le,I.mode=22;case 22:if(I.extra){for(T=I.extra;M<T;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}I.length+=J&(1<<I.extra)-1,J>>>=I.extra,M-=I.extra,I.back+=I.extra}I.was=I.length,I.mode=23;case 23:for(;le=(A=I.distcode[J&(1<<I.distbits)-1])>>>16&255,ne=65535&A,!((U=A>>>24)<=M);){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}if((240&le)==0){for(ie=U,H=le,K=ne;le=(A=I.distcode[K+((J&(1<<ie+H)-1)>>ie)])>>>16&255,ne=65535&A,!(ie+(U=A>>>24)<=M);){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}J>>>=ie,M-=ie,I.back+=ie}if(J>>>=U,M-=U,I.back+=U,64&le){D.msg="invalid distance code",I.mode=30;break}I.offset=ne,I.extra=15&le,I.mode=24;case 24:if(I.extra){for(T=I.extra;M<T;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}I.offset+=J&(1<<I.extra)-1,J>>>=I.extra,M-=I.extra,I.back+=I.extra}if(I.offset>I.dmax){D.msg="invalid distance too far back",I.mode=30;break}I.mode=25;case 25:if(Se===0)break e;if(re=G-Se,I.offset>re){if((re=I.offset-re)>I.whave&&I.sane){D.msg="invalid distance too far back",I.mode=30;break}ce=re>I.wnext?(re-=I.wnext,I.wsize-re):I.wnext-re,re>I.length&&(re=I.length),P=I.window}else P=Q,ce=ve-I.offset,re=I.length;for(Se<re&&(re=Se),Se-=re,I.length-=re;Q[ve++]=P[ce++],--re;);I.length===0&&(I.mode=21);break;case 26:if(Se===0)break e;Q[ve++]=I.length,Se--,I.mode=21;break;case 27:if(I.wrap){for(;M<32;){if(ee===0)break e;ee--,J|=ae[te++]<<M,M+=8}if(G-=Se,D.total_out+=G,I.total+=G,G&&(D.adler=I.check=I.flags?u(I.check,Q,G,ve-G):l(I.check,Q,G,ve-G)),G=Se,(I.flags?J:w(J))!==I.check){D.msg="incorrect data check",I.mode=30;break}M=J=0}I.mode=28;case 28:if(I.wrap&&I.flags){for(;M<32;){if(ee===0)break e;ee--,J+=ae[te++]<<M,M+=8}if(J!==(4294967295&I.total)){D.msg="incorrect length check",I.mode=30;break}M=J=0}I.mode=29;case 29:ue=1;break e;case 30:ue=-3;break e;case 31:return-4;default:return v}return D.next_out=ve,D.avail_out=Se,D.next_in=te,D.avail_in=ee,I.hold=J,I.bits=M,(I.wsize||G!==D.avail_out&&I.mode<30&&(I.mode<27||V!==4))&&fe(D,D.output,D.next_out,G-D.avail_out)?(I.mode=31,-4):(Y-=D.avail_in,G-=D.avail_out,D.total_in+=Y,D.total_out+=G,I.total+=G,I.wrap&&G&&(D.adler=I.check=I.flags?u(I.check,Q,G,D.next_out-G):l(I.check,Q,G,D.next_out-G)),D.data_type=I.bits+(I.last?64:0)+(I.mode===12?128:0)+(I.mode===20||I.mode===15?256:0),(Y==0&&G===0||V===4)&&ue===y&&(ue=-5),ue)},a.inflateEnd=function(D){if(!D||!D.state)return v;var V=D.state;return V.window&&(V.window=null),D.state=null,y},a.inflateGetHeader=function(D,V){var I;return D&&D.state?(2&(I=D.state).wrap)==0?v:((I.head=V).done=!1,y):v},a.inflateSetDictionary=function(D,V){var I,ae=V.length;return D&&D.state?(I=D.state).wrap!==0&&I.mode!==11?v:I.mode===11&&l(1,V,ae,0)!==I.check?-3:fe(D,V,ae,ae)?(I.mode=31,-4):(I.havedict=1,y):v},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,s,a){var o=r("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(m,x,y,v,b,g,_,w){var k,N,E,C,L,O,B,F,q,fe=w.bits,D=0,V=0,I=0,ae=0,Q=0,te=0,ve=0,ee=0,Se=0,J=0,M=null,Y=0,G=new o.Buf16(16),re=new o.Buf16(16),ce=null,P=0;for(D=0;D<=15;D++)G[D]=0;for(V=0;V<v;V++)G[x[y+V]]++;for(Q=fe,ae=15;1<=ae&&G[ae]===0;ae--);if(ae<Q&&(Q=ae),ae===0)return b[g++]=20971520,b[g++]=20971520,w.bits=1,0;for(I=1;I<ae&&G[I]===0;I++);for(Q<I&&(Q=I),D=ee=1;D<=15;D++)if(ee<<=1,(ee-=G[D])<0)return-1;if(0<ee&&(m===0||ae!==1))return-1;for(re[1]=0,D=1;D<15;D++)re[D+1]=re[D]+G[D];for(V=0;V<v;V++)x[y+V]!==0&&(_[re[x[y+V]]++]=V);if(O=m===0?(M=ce=_,19):m===1?(M=l,Y-=257,ce=u,P-=257,256):(M=d,ce=h,-1),D=I,L=g,ve=V=J=0,E=-1,C=(Se=1<<(te=Q))-1,m===1&&852<Se||m===2&&592<Se)return 1;for(;;){for(B=D-ve,q=_[V]<O?(F=0,_[V]):_[V]>O?(F=ce[P+_[V]],M[Y+_[V]]):(F=96,0),k=1<<D-ve,I=N=1<<te;b[L+(J>>ve)+(N-=k)]=B<<24|F<<16|q|0,N!==0;);for(k=1<<D-1;J&k;)k>>=1;if(k!==0?(J&=k-1,J+=k):J=0,V++,--G[D]==0){if(D===ae)break;D=x[y+_[V]]}if(Q<D&&(J&C)!==E){for(ve===0&&(ve=Q),L+=I,ee=1<<(te=D-ve);te+ve<ae&&!((ee-=G[te+ve])<=0);)te++,ee<<=1;if(Se+=1<<te,m===1&&852<Se||m===2&&592<Se)return 1;b[E=J&C]=Q<<24|te<<16|L-g|0}}return J!==0&&(b[L+J]=D-ve<<24|64<<16|0),w.bits=Q,0}},{"../utils/common":41}],51:[function(r,s,a){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,s,a){var o=r("../utils/common"),l=0,u=1;function d(A){for(var W=A.length;0<=--W;)A[W]=0}var h=0,m=29,x=256,y=x+1+m,v=30,b=19,g=2*y+1,_=15,w=16,k=7,N=256,E=16,C=17,L=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],B=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],fe=new Array(2*(y+2));d(fe);var D=new Array(2*v);d(D);var V=new Array(512);d(V);var I=new Array(256);d(I);var ae=new Array(m);d(ae);var Q,te,ve,ee=new Array(v);function Se(A,W,pe,_e,oe){this.static_tree=A,this.extra_bits=W,this.extra_base=pe,this.elems=_e,this.max_length=oe,this.has_stree=A&&A.length}function J(A,W){this.dyn_tree=A,this.max_code=0,this.stat_desc=W}function M(A){return A<256?V[A]:V[256+(A>>>7)]}function Y(A,W){A.pending_buf[A.pending++]=255&W,A.pending_buf[A.pending++]=W>>>8&255}function G(A,W,pe){A.bi_valid>w-pe?(A.bi_buf|=W<<A.bi_valid&65535,Y(A,A.bi_buf),A.bi_buf=W>>w-A.bi_valid,A.bi_valid+=pe-w):(A.bi_buf|=W<<A.bi_valid&65535,A.bi_valid+=pe)}function re(A,W,pe){G(A,pe[2*W],pe[2*W+1])}function ce(A,W){for(var pe=0;pe|=1&A,A>>>=1,pe<<=1,0<--W;);return pe>>>1}function P(A,W,pe){var _e,oe,Te=new Array(_+1),Me=0;for(_e=1;_e<=_;_e++)Te[_e]=Me=Me+pe[_e-1]<<1;for(oe=0;oe<=W;oe++){var Ae=A[2*oe+1];Ae!==0&&(A[2*oe]=ce(Te[Ae]++,Ae))}}function U(A){var W;for(W=0;W<y;W++)A.dyn_ltree[2*W]=0;for(W=0;W<v;W++)A.dyn_dtree[2*W]=0;for(W=0;W<b;W++)A.bl_tree[2*W]=0;A.dyn_ltree[2*N]=1,A.opt_len=A.static_len=0,A.last_lit=A.matches=0}function le(A){8<A.bi_valid?Y(A,A.bi_buf):0<A.bi_valid&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0}function ne(A,W,pe,_e){var oe=2*W,Te=2*pe;return A[oe]<A[Te]||A[oe]===A[Te]&&_e[W]<=_e[pe]}function ie(A,W,pe){for(var _e=A.heap[pe],oe=pe<<1;oe<=A.heap_len&&(oe<A.heap_len&&ne(W,A.heap[oe+1],A.heap[oe],A.depth)&&oe++,!ne(W,_e,A.heap[oe],A.depth));)A.heap[pe]=A.heap[oe],pe=oe,oe<<=1;A.heap[pe]=_e}function H(A,W,pe){var _e,oe,Te,Me,Ae=0;if(A.last_lit!==0)for(;_e=A.pending_buf[A.d_buf+2*Ae]<<8|A.pending_buf[A.d_buf+2*Ae+1],oe=A.pending_buf[A.l_buf+Ae],Ae++,_e===0?re(A,oe,W):(re(A,(Te=I[oe])+x+1,W),(Me=O[Te])!==0&&G(A,oe-=ae[Te],Me),re(A,Te=M(--_e),pe),(Me=B[Te])!==0&&G(A,_e-=ee[Te],Me)),Ae<A.last_lit;);re(A,N,W)}function K(A,W){var pe,_e,oe,Te=W.dyn_tree,Me=W.stat_desc.static_tree,Ae=W.stat_desc.has_stree,Re=W.stat_desc.elems,et=-1;for(A.heap_len=0,A.heap_max=g,pe=0;pe<Re;pe++)Te[2*pe]!==0?(A.heap[++A.heap_len]=et=pe,A.depth[pe]=0):Te[2*pe+1]=0;for(;A.heap_len<2;)Te[2*(oe=A.heap[++A.heap_len]=et<2?++et:0)]=1,A.depth[oe]=0,A.opt_len--,Ae&&(A.static_len-=Me[2*oe+1]);for(W.max_code=et,pe=A.heap_len>>1;1<=pe;pe--)ie(A,Te,pe);for(oe=Re;pe=A.heap[1],A.heap[1]=A.heap[A.heap_len--],ie(A,Te,1),_e=A.heap[1],A.heap[--A.heap_max]=pe,A.heap[--A.heap_max]=_e,Te[2*oe]=Te[2*pe]+Te[2*_e],A.depth[oe]=(A.depth[pe]>=A.depth[_e]?A.depth[pe]:A.depth[_e])+1,Te[2*pe+1]=Te[2*_e+1]=oe,A.heap[1]=oe++,ie(A,Te,1),2<=A.heap_len;);A.heap[--A.heap_max]=A.heap[1],(function(He,at){var De,mt,At,wt,Ct,It,Le=at.dyn_tree,tt=at.max_code,ct=at.stat_desc.static_tree,se=at.stat_desc.has_stree,Ne=at.stat_desc.extra_bits,xe=at.stat_desc.extra_base,je=at.stat_desc.max_length,de=0;for(wt=0;wt<=_;wt++)He.bl_count[wt]=0;for(Le[2*He.heap[He.heap_max]+1]=0,De=He.heap_max+1;De<g;De++)je<(wt=Le[2*Le[2*(mt=He.heap[De])+1]+1]+1)&&(wt=je,de++),Le[2*mt+1]=wt,tt<mt||(He.bl_count[wt]++,Ct=0,xe<=mt&&(Ct=Ne[mt-xe]),It=Le[2*mt],He.opt_len+=It*(wt+Ct),se&&(He.static_len+=It*(ct[2*mt+1]+Ct)));if(de!==0){do{for(wt=je-1;He.bl_count[wt]===0;)wt--;He.bl_count[wt]--,He.bl_count[wt+1]+=2,He.bl_count[je]--,de-=2}while(0<de);for(wt=je;wt!==0;wt--)for(mt=He.bl_count[wt];mt!==0;)tt<(At=He.heap[--De])||(Le[2*At+1]!==wt&&(He.opt_len+=(wt-Le[2*At+1])*Le[2*At],Le[2*At+1]=wt),mt--)}})(A,W),P(Te,et,A.bl_count)}function S(A,W,pe){var _e,oe,Te=-1,Me=W[1],Ae=0,Re=7,et=4;for(Me===0&&(Re=138,et=3),W[2*(pe+1)+1]=65535,_e=0;_e<=pe;_e++)oe=Me,Me=W[2*(_e+1)+1],++Ae<Re&&oe===Me||(Ae<et?A.bl_tree[2*oe]+=Ae:oe!==0?(oe!==Te&&A.bl_tree[2*oe]++,A.bl_tree[2*E]++):Ae<=10?A.bl_tree[2*C]++:A.bl_tree[2*L]++,Te=oe,et=(Ae=0)===Me?(Re=138,3):oe===Me?(Re=6,3):(Re=7,4))}function ue(A,W,pe){var _e,oe,Te=-1,Me=W[1],Ae=0,Re=7,et=4;for(Me===0&&(Re=138,et=3),_e=0;_e<=pe;_e++)if(oe=Me,Me=W[2*(_e+1)+1],!(++Ae<Re&&oe===Me)){if(Ae<et)for(;re(A,oe,A.bl_tree),--Ae!=0;);else oe!==0?(oe!==Te&&(re(A,oe,A.bl_tree),Ae--),re(A,E,A.bl_tree),G(A,Ae-3,2)):Ae<=10?(re(A,C,A.bl_tree),G(A,Ae-3,3)):(re(A,L,A.bl_tree),G(A,Ae-11,7));Te=oe,et=(Ae=0)===Me?(Re=138,3):oe===Me?(Re=6,3):(Re=7,4)}}d(ee);var z=!1;function T(A,W,pe,_e){G(A,(h<<1)+(_e?1:0),3),(function(oe,Te,Me,Ae){le(oe),Y(oe,Me),Y(oe,~Me),o.arraySet(oe.pending_buf,oe.window,Te,Me,oe.pending),oe.pending+=Me})(A,W,pe)}a._tr_init=function(A){z||((function(){var W,pe,_e,oe,Te,Me=new Array(_+1);for(oe=_e=0;oe<m-1;oe++)for(ae[oe]=_e,W=0;W<1<<O[oe];W++)I[_e++]=oe;for(I[_e-1]=oe,oe=Te=0;oe<16;oe++)for(ee[oe]=Te,W=0;W<1<<B[oe];W++)V[Te++]=oe;for(Te>>=7;oe<v;oe++)for(ee[oe]=Te<<7,W=0;W<1<<B[oe]-7;W++)V[256+Te++]=oe;for(pe=0;pe<=_;pe++)Me[pe]=0;for(W=0;W<=143;)fe[2*W+1]=8,W++,Me[8]++;for(;W<=255;)fe[2*W+1]=9,W++,Me[9]++;for(;W<=279;)fe[2*W+1]=7,W++,Me[7]++;for(;W<=287;)fe[2*W+1]=8,W++,Me[8]++;for(P(fe,y+1,Me),W=0;W<v;W++)D[2*W+1]=5,D[2*W]=ce(W,5);Q=new Se(fe,O,x+1,y,_),te=new Se(D,B,0,v,_),ve=new Se(new Array(0),F,0,b,k)})(),z=!0),A.l_desc=new J(A.dyn_ltree,Q),A.d_desc=new J(A.dyn_dtree,te),A.bl_desc=new J(A.bl_tree,ve),A.bi_buf=0,A.bi_valid=0,U(A)},a._tr_stored_block=T,a._tr_flush_block=function(A,W,pe,_e){var oe,Te,Me=0;0<A.level?(A.strm.data_type===2&&(A.strm.data_type=(function(Ae){var Re,et=4093624447;for(Re=0;Re<=31;Re++,et>>>=1)if(1&et&&Ae.dyn_ltree[2*Re]!==0)return l;if(Ae.dyn_ltree[18]!==0||Ae.dyn_ltree[20]!==0||Ae.dyn_ltree[26]!==0)return u;for(Re=32;Re<x;Re++)if(Ae.dyn_ltree[2*Re]!==0)return u;return l})(A)),K(A,A.l_desc),K(A,A.d_desc),Me=(function(Ae){var Re;for(S(Ae,Ae.dyn_ltree,Ae.l_desc.max_code),S(Ae,Ae.dyn_dtree,Ae.d_desc.max_code),K(Ae,Ae.bl_desc),Re=b-1;3<=Re&&Ae.bl_tree[2*q[Re]+1]===0;Re--);return Ae.opt_len+=3*(Re+1)+5+5+4,Re})(A),oe=A.opt_len+3+7>>>3,(Te=A.static_len+3+7>>>3)<=oe&&(oe=Te)):oe=Te=pe+5,pe+4<=oe&&W!==-1?T(A,W,pe,_e):A.strategy===4||Te===oe?(G(A,2+(_e?1:0),3),H(A,fe,D)):(G(A,4+(_e?1:0),3),(function(Ae,Re,et,He){var at;for(G(Ae,Re-257,5),G(Ae,et-1,5),G(Ae,He-4,4),at=0;at<He;at++)G(Ae,Ae.bl_tree[2*q[at]+1],3);ue(Ae,Ae.dyn_ltree,Re-1),ue(Ae,Ae.dyn_dtree,et-1)})(A,A.l_desc.max_code+1,A.d_desc.max_code+1,Me+1),H(A,A.dyn_ltree,A.dyn_dtree)),U(A),_e&&le(A)},a._tr_tally=function(A,W,pe){return A.pending_buf[A.d_buf+2*A.last_lit]=W>>>8&255,A.pending_buf[A.d_buf+2*A.last_lit+1]=255&W,A.pending_buf[A.l_buf+A.last_lit]=255&pe,A.last_lit++,W===0?A.dyn_ltree[2*pe]++:(A.matches++,W--,A.dyn_ltree[2*(I[pe]+x+1)]++,A.dyn_dtree[2*M(W)]++),A.last_lit===A.lit_bufsize-1},a._tr_align=function(A){G(A,2,3),re(A,N,fe),(function(W){W.bi_valid===16?(Y(W,W.bi_buf),W.bi_buf=0,W.bi_valid=0):8<=W.bi_valid&&(W.pending_buf[W.pending++]=255&W.bi_buf,W.bi_buf>>=8,W.bi_valid-=8)})(A)}},{"../utils/common":41}],53:[function(r,s,a){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,s,a){(function(o){(function(l,u){if(!l.setImmediate){var d,h,m,x,y=1,v={},b=!1,g=l.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(l);_=_&&_.setTimeout?_:l,d={}.toString.call(l.process)==="[object process]"?function(E){sr.nextTick(function(){k(E)})}:(function(){if(l.postMessage&&!l.importScripts){var E=!0,C=l.onmessage;return l.onmessage=function(){E=!1},l.postMessage("","*"),l.onmessage=C,E}})()?(x="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",N,!1):l.attachEvent("onmessage",N),function(E){l.postMessage(x+E,"*")}):l.MessageChannel?((m=new MessageChannel).port1.onmessage=function(E){k(E.data)},function(E){m.port2.postMessage(E)}):g&&"onreadystatechange"in g.createElement("script")?(h=g.documentElement,function(E){var C=g.createElement("script");C.onreadystatechange=function(){k(E),C.onreadystatechange=null,h.removeChild(C),C=null},h.appendChild(C)}):function(E){setTimeout(k,0,E)},_.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var C=new Array(arguments.length-1),L=0;L<C.length;L++)C[L]=arguments[L+1];var O={callback:E,args:C};return v[y]=O,d(y),y++},_.clearImmediate=w}function w(E){delete v[E]}function k(E){if(b)setTimeout(k,0,E);else{var C=v[E];if(C){b=!0;try{(function(L){var O=L.callback,B=L.args;switch(B.length){case 0:O();break;case 1:O(B[0]);break;case 2:O(B[0],B[1]);break;case 3:O(B[0],B[1],B[2]);break;default:O.apply(u,B)}})(C)}finally{w(E),b=!1}}}}function N(E){E.source===l&&typeof E.data=="string"&&E.data.indexOf(x)===0&&k(+E.data.slice(x.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof Pn<"u"?Pn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(W1)),W1.exports}var sU=rU();const aU=hv(sU);var td={exports:{}},G1,pk;function nU(){if(pk)return G1;pk=1;var e={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function t(r){return r&&r.replace?r.replace(/([&"<>'])/g,function(s,a){return e[a]}):r}return G1=t,G1}var xk;function iU(){if(xk)return td.exports;xk=1;var e=nU(),t=vv().Stream,r="    ";function s(h,m){typeof m!="object"&&(m={indent:m});var x=m.stream?new t:null,y="",v=!1,b=m.indent?m.indent===!0?r:m.indent:"",g=!0;function _(C){g?sr.nextTick(C):C()}function w(C,L){if(L!==void 0&&(y+=L),C&&!v&&(x=x||new t,v=!0),C&&v){var O=y;_(function(){x.emit("data",O)}),y=""}}function k(C,L){u(w,l(C,b,b?1:0),L)}function N(){if(x){var C=y;_(function(){x.emit("data",C),x.emit("end"),x.readable=!1,x.emit("close")})}}function E(C){var L=C.encoding||"UTF-8",O={version:"1.0",encoding:L};C.standalone&&(O.standalone=C.standalone),k({"?xml":{_attr:O}}),y=y.replace("/>","?>")}return _(function(){g=!1}),m.declaration&&E(m.declaration),h&&h.forEach?h.forEach(function(C,L){var O;L+1===h.length&&(O=N),k(C,O)}):k(h,N),x?(x.readable=!0,x):y}function a(){var h=Array.prototype.slice.call(arguments),m={_elem:l(h)};return m.push=function(x){if(!this.append)throw new Error("not assigned to a parent!");var y=this,v=this._elem.indent;u(this.append,l(x,v,this._elem.icount+(v?1:0)),function(){y.append(!0)})},m.close=function(x){x!==void 0&&this.push(x),this.end&&this.end()},m}function o(h,m){return new Array(m||0).join(h||"")}function l(h,m,x){x=x||0;var y=o(m,x),v,b=h,g=!1;if(typeof h=="object"){var _=Object.keys(h);if(v=_[0],b=h[v],b&&b._elem)return b._elem.name=v,b._elem.icount=x,b._elem.indent=m,b._elem.indents=y,b._elem.interrupt=b,b._elem}var w=[],k=[],N;function E(C){var L=Object.keys(C);L.forEach(function(O){w.push(d(O,C[O]))})}switch(typeof b){case"object":if(b===null)break;b._attr&&E(b._attr),b._cdata&&k.push(("<![CDATA["+b._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),b.forEach&&(N=!1,k.push(""),b.forEach(function(C){if(typeof C=="object"){var L=Object.keys(C)[0];L=="_attr"?E(C._attr):k.push(l(C,m,x+1))}else k.pop(),N=!0,k.push(e(C))}),N||k.push(""));break;default:k.push(e(b))}return{name:v,interrupt:g,attributes:w,content:k,icount:x,indents:y,indent:m}}function u(h,m,x){if(typeof m!="object")return h(!1,m);var y=m.interrupt?1:m.content.length;function v(){for(;m.content.length;){var g=m.content.shift();if(g!==void 0){if(b(g))return;u(h,g)}}h(!1,(y>1?m.indents:"")+(m.name?"</"+m.name+">":"")+(m.indent&&!x?`
`:"")),x&&x()}function b(g){return g.interrupt?(g.interrupt.append=h,g.interrupt.end=v,g.interrupt=!1,h(!0),!0):!1}if(h(!1,m.indents+(m.name?"<"+m.name:"")+(m.attributes.length?" "+m.attributes.join(" "):"")+(y?m.name?">":"":m.name?"/>":"")+(m.indent&&y>1?`
`:"")),!y)return h(!1,m.indent?`
`:"");b(m)||v()}function d(h,m){return h+'="'+e(m)+'"'}return td.exports=s,td.exports.element=td.exports.Element=a,td.exports}var oU=iU();const as=hv(oU),rd=0,V1=32,lU=32,cU=(e,t)=>{const r=t.replace(/-/g,"");if(r.length!==lU)throw new Error(`Error: Cannot extract GUID from font filename: ${t}`);const a=r.replace(/(..)/g,"$1 ").trim().split(" ").map(d=>parseInt(d,16));a.reverse();const l=e.slice(rd,V1).map((d,h)=>d^a[h%a.length]),u=new Uint8Array(rd+l.length+Math.max(0,e.length-V1));return u.set(e.slice(0,rd)),u.set(l,rd),u.set(e.slice(V1),rd+l.length),u};class uU{format(t,r={stack:[]}){const s=t.prepForXml(r);if(s)return s;throw Error("XMLComponent did not format correctly")}}class dU{replace(t,r,s){let a=t;return r.forEach((o,l)=>{a=a.replace(new RegExp(`{${o.fileName}}`,"g"),(s+l).toString())}),a}getMediaData(t,r){return r.Array.filter(s=>t.search(`{${s.fileName}}`)>0)}}class fU{replace(t,r){let s=t;for(const a of r)s=s.replace(new RegExp(`{${a.reference}-${a.instance}}`,"g"),a.numId.toString());return s}}class hU{constructor(){Je(this,"formatter"),Je(this,"imageReplacer"),Je(this,"numberingReplacer"),this.formatter=new uU,this.imageReplacer=new dU,this.numberingReplacer=new fU}compile(t,r,s=[]){const a=new aU,o=this.xmlifyFile(t,r),l=new Map(Object.entries(o));for(const[,u]of l)if(Array.isArray(u))for(const d of u)a.file(d.path,d.data);else a.file(u.path,u.data);for(const u of s)a.file(u.path,u.data);for(const u of t.Media.Array)u.type!=="svg"?a.file(`word/media/${u.fileName}`,u.data):(a.file(`word/media/${u.fileName}`,u.data),a.file(`word/media/${u.fallback.fileName}`,u.fallback.data));for(const{data:u,name:d,fontKey:h}of t.FontTable.fontOptionsWithKey){const[m]=d.split(".");a.file(`word/fonts/${m}.odttf`,cU(u,h))}return a}xmlifyFile(t,r){const s=t.Document.Relationships.RelationshipCount+1,a=as(this.formatter.format(t.Document.View,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),o=t.Comments.Relationships.RelationshipCount+1,l=as(this.formatter.format(t.Comments,{viewWrapper:{View:t.Comments,Relationships:t.Comments.Relationships},file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),u=this.imageReplacer.getMediaData(a,t.Media),d=this.imageReplacer.getMediaData(l,t.Media);return{Relationships:{data:(u.forEach((h,m)=>{t.Document.Relationships.createRelationship(s+m,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${h.fileName}`)}),t.Document.Relationships.createRelationship(t.Document.Relationships.RelationshipCount+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable","fontTable.xml"),as(this.formatter.format(t.Document.Relationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const h=this.imageReplacer.replace(a,u,s);return this.numberingReplacer.replace(h,t.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const h=as(this.formatter.format(t.Styles,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(h,t.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:as(this.formatter.format(t.CoreProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:as(this.formatter.format(t.Numbering,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:as(this.formatter.format(t.FileRelationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:t.Headers.map((h,m)=>{const x=as(this.formatter.format(h.View,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(x,t.Media).forEach((v,b)=>{h.Relationships.createRelationship(b,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${v.fileName}`)}),{data:as(this.formatter.format(h.Relationships,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${m+1}.xml.rels`}}),FooterRelationships:t.Footers.map((h,m)=>{const x=as(this.formatter.format(h.View,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(x,t.Media).forEach((v,b)=>{h.Relationships.createRelationship(b,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${v.fileName}`)}),{data:as(this.formatter.format(h.Relationships,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${m+1}.xml.rels`}}),Headers:t.Headers.map((h,m)=>{const x=as(this.formatter.format(h.View,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),y=this.imageReplacer.getMediaData(x,t.Media),v=this.imageReplacer.replace(x,y,0);return{data:this.numberingReplacer.replace(v,t.Numbering.ConcreteNumbering),path:`word/header${m+1}.xml`}}),Footers:t.Footers.map((h,m)=>{const x=as(this.formatter.format(h.View,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),y=this.imageReplacer.getMediaData(x,t.Media),v=this.imageReplacer.replace(x,y,0);return{data:this.numberingReplacer.replace(v,t.Numbering.ConcreteNumbering),path:`word/footer${m+1}.xml`}}),ContentTypes:{data:as(this.formatter.format(t.ContentTypes,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:as(this.formatter.format(t.CustomProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:as(this.formatter.format(t.AppProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:as(this.formatter.format(t.FootNotes.View,{viewWrapper:t.FootNotes,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:as(this.formatter.format(t.FootNotes.Relationships,{viewWrapper:t.FootNotes,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:as(this.formatter.format(t.Settings,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:(()=>{const h=this.imageReplacer.replace(l,d,o);return this.numberingReplacer.replace(h,t.Numbering.ConcreteNumbering)})(),path:"word/comments.xml"},CommentsRelationships:{data:(d.forEach((h,m)=>{t.Comments.Relationships.createRelationship(o+m,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${h.fileName}`)}),as(this.formatter.format(t.Comments.Relationships,{viewWrapper:{View:t.Comments,Relationships:t.Comments.Relationships},file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/comments.xml.rels"},FontTable:{data:as(this.formatter.format(t.FontTable.View,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:as(this.formatter.format(t.FontTable.Relationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}}const mU={WITH_2_BLANKS:"  "},gk=e=>e===!0?mU.WITH_2_BLANKS:e===!1?void 0:e,qj=class kc{static pack(t,r,s){return T9(this,arguments,function*(a,o,l,u=[]){return this.compiler.compile(a,gk(l),u).generateAsync({type:o,mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toString(t,r,s=[]){return kc.pack(t,"string",r,s)}static toBuffer(t,r,s=[]){return kc.pack(t,"nodebuffer",r,s)}static toBase64String(t,r,s=[]){return kc.pack(t,"base64",r,s)}static toBlob(t,r,s=[]){return kc.pack(t,"blob",r,s)}static toArrayBuffer(t,r,s=[]){return kc.pack(t,"arraybuffer",r,s)}static toStream(t,r,s=[]){const a=new tU.Stream;return this.compiler.compile(t,gk(r),s).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(l=>{a.emit("data",l),a.emit("end")}),a}};Je(qj,"compiler",new hU);let hm=qj;var v0={exports:{}},pU=v0.exports,yk;function xU(){return yk||(yk=1,(function(e,t){(function(r,s){s()})(pU,function(){function r(h,m){return typeof m>"u"?m={autoBom:!1}:typeof m!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),m={autoBom:!m}),m.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function s(h,m,x){var y=new XMLHttpRequest;y.open("GET",h),y.responseType="blob",y.onload=function(){d(y.response,m,x)},y.onerror=function(){console.error("could not download file")},y.send()}function a(h){var m=new XMLHttpRequest;m.open("HEAD",h,!1);try{m.send()}catch{}return 200<=m.status&&299>=m.status}function o(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var m=document.createEvent("MouseEvents");m.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(m)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Th=="object"&&Th.global===Th?Th:void 0,u=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(h,m,x){var y=l.URL||l.webkitURL,v=document.createElement("a");m=m||h.name||"download",v.download=m,v.rel="noopener",typeof h=="string"?(v.href=h,v.origin===location.origin?o(v):a(v.href)?s(h,m,x):o(v,v.target="_blank")):(v.href=y.createObjectURL(h),setTimeout(function(){y.revokeObjectURL(v.href)},4e4),setTimeout(function(){o(v)},0))}:"msSaveOrOpenBlob"in navigator?function(h,m,x){if(m=m||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(r(h,x),m);else if(a(h))s(h,m,x);else{var y=document.createElement("a");y.href=h,y.target="_blank",setTimeout(function(){o(y)})}}:function(h,m,x,y){if(y=y||open("","_blank"),y&&(y.document.title=y.document.body.innerText="downloading..."),typeof h=="string")return s(h,m,x);var v=h.type==="application/octet-stream",b=/constructor/i.test(l.HTMLElement)||l.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||v&&b||u)&&typeof FileReader<"u"){var _=new FileReader;_.onloadend=function(){var N=_.result;N=g?N:N.replace(/^data:[^;]*;/,"data:attachment/file;"),y?y.location.href=N:location=N,y=null},_.readAsDataURL(h)}else{var w=l.URL||l.webkitURL,k=w.createObjectURL(h);y?y.location=k:location.href=k,y=null,setTimeout(function(){w.revokeObjectURL(k)},4e4)}});l.saveAs=d.saveAs=d,e.exports=d})})(v0)),v0.exports}var mm=xU();const jv=e=>{const t=new Date(e),r=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${r}${s}${a}`},gU=(e,t,r)=>{const s=l=>l?l.split(`
`).map(u=>`<p style="margin: 0 0 8px 0; line-height: 1.8;">${u.replace(/</g,"&lt;").replace(/>/g,"&gt;")||"&nbsp;"}</p>`).join(""):'<p style="color: #666;">-</p>',a=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>  - ${t(e.work_date)}</title>
    <style>
        @page {
            size: A4;
            margin: 25mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', 'Apple SD Gothic Neo', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #000;
            background: #fff;
        }

        .date-header {
            text-align: right;
            font-size: 13px;
            color: #666;
            margin-bottom: 10px;
        }

        .title-section {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #333;
        }
        .main-title {
            font-size: 26px;
            font-weight: bold;
            letter-spacing: 12px;
            color: #1a1a1a;
        }

        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .info-table td {
            border: 1px solid #333;
            padding: 10px 15px;
            font-size: 14px;
        }
        .info-table .label {
            background-color: #f8f9fa;
            font-weight: 600;
            text-align: center;
            width: 15%;
        }
        .info-table .value {
            width: 35%;
        }

        .content-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .content-table td {
            border: 1px solid #333;
            padding: 0;
            font-size: 14px;
            vertical-align: top;
        }
        .content-table .section-title {
            background-color: #f8f9fa;
            font-weight: 600;
            padding: 12px 15px;
        }
        .content-table .section-body {
            padding: 20px;
            min-height: 50px;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            p {
                page-break-inside: avoid;
                orphans: 2;
                widows: 2;
            }
        }
    </style>
</head>
<body>
    <div class="date-header">
        : ${jv(e.work_date)}
    </div>

    <div class="title-section">
        <h1 class="main-title">      </h1>
    </div>

    <table class="info-table">
        <tr>
            <td class="label"></td>
            <td class="value">${t(e.work_date)}</td>
            <td class="label"></td>
            <td class="value">${e.user?.team||"-"}</td>
        </tr>
        <tr>
            <td class="label"></td>
            <td class="value">${e.user?.rank||"-"}</td>
            <td class="label"></td>
            <td class="value">${e.user?.name||"-"}</td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.    </td>
        </tr>
        <tr>
            <td class="section-body">
                ${s(e.morning_work)}
            </td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.  </td>
        </tr>
        <tr>
            <td class="section-body">
                ${s(e.this_week_work)}
            </td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.   </td>
        </tr>
        <tr>
            <td class="section-body">
                ${s(e.special_notes)}
            </td>
        </tr>
    </table>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,o=window.open("","_blank","width=900,height=700");o.document.write(a),o.document.close()},yU=(e,t,r)=>{const s=l=>l?l.split(`
`).map(u=>`<p style="margin: 0 0 8px 0; line-height: 1.8;">${u.replace(/</g,"&lt;").replace(/>/g,"&gt;")||"&nbsp;"}</p>`).join(""):'<p style="color: #666;">-</p>',a=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>  - ${t(e.work_date)}</title>
    <style>
        @page {
            size: A4;
            margin: 25mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', 'Apple SD Gothic Neo', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #000;
            background: #fff;
        }

        .date-header {
            text-align: right;
            font-size: 13px;
            color: #666;
            margin-bottom: 10px;
        }

        .title-section {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #333;
        }
        .main-title {
            font-size: 26px;
            font-weight: bold;
            letter-spacing: 12px;
            color: #1a1a1a;
        }

        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .info-table td {
            border: 1px solid #333;
            padding: 10px 15px;
            font-size: 14px;
        }
        .info-table .label {
            background-color: #f8f9fa;
            font-weight: 600;
            text-align: center;
            width: 15%;
        }
        .info-table .value {
            width: 35%;
        }

        .content-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .content-table td {
            border: 1px solid #333;
            padding: 0;
            font-size: 14px;
            vertical-align: top;
        }
        .content-table .section-title {
            background-color: #f8f9fa;
            font-weight: 600;
            padding: 12px 15px;
        }
        .content-table .section-body {
            padding: 20px;
            min-height: 50px;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            p {
                page-break-inside: avoid;
                orphans: 2;
                widows: 2;
            }
        }
    </style>
</head>
<body>
    <div class="date-header">
        : ${jv(e.work_date)}
    </div>

    <div class="title-section">
        <h1 class="main-title">      </h1>
    </div>

    <table class="info-table">
        <tr>
            <td class="label"></td>
            <td class="value">${t(e.work_date)}</td>
            <td class="label"></td>
            <td class="value">${e.user?.team||"-"}</td>
        </tr>
        <tr>
            <td class="label"></td>
            <td class="value">${e.user?.rank||"-"}</td>
            <td class="label"></td>
            <td class="value">${e.user?.name||"-"}</td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.    </td>
        </tr>
        <tr>
            <td class="section-body">
                ${s(e.morning_work)}
            </td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.   </td>
        </tr>
        <tr>
            <td class="section-body">
                ${s(e.special_notes)}
            </td>
        </tr>
    </table>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,o=window.open("","_blank","width=900,height=700");o.document.write(a),o.document.close()},vU=(e,t)=>{const r=`
---TASK---
`,s=u=>{if(!u)return'<tr><td colspan="3" style="text-align: center; color: #666; padding: 15px;">-</td></tr>';const h=u.includes("---TASK---")?u.split(r).filter(m=>m.trim()):u.split(`
`).filter(m=>m.trim());return h.length===0?'<tr><td colspan="3" style="text-align: center; color: #666; padding: 15px;">-</td></tr>':h.map((m,x)=>{const y=m.trim().split(`
`),b=y[y.length-1].match(/^(.+?)\s*\((\d+)%\)$/);let g=m.trim(),_="-";b&&y.length===1?(g=b[1].trim(),_=b[2]+"%"):b&&y.length>1&&(y[y.length-1]=b[1].trim(),g=y.join(`
`),_=b[2]+"%");const w=g.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>");return`
                <tr>
                    <td style="width: 40px; text-align: center; padding: 8px; border: 1px solid #333;">${x+1}</td>
                    <td style="padding: 8px 10px; border: 1px solid #333;">${w}</td>
                    <td style="width: 60px; text-align: center; padding: 8px; border: 1px solid #333;">${_}</td>
                </tr>
            `}).join("")},a=u=>u?u.split(`
`).map(d=>`<p style="margin: 0 0 8px 0; line-height: 1.8;">${d.replace(/</g,"&lt;").replace(/>/g,"&gt;")||"&nbsp;"}</p>`).join(""):'<p style="color: #666;">-</p>',o=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>  - ${t(e.work_date)}</title>
    <style>
        @page {
            size: A4;
            margin: 25mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', 'Apple SD Gothic Neo', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #000;
            background: #fff;
        }

        .date-header {
            text-align: right;
            font-size: 13px;
            color: #666;
            margin-bottom: 10px;
        }

        .title-section {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #333;
        }
        .main-title {
            font-size: 26px;
            font-weight: bold;
            letter-spacing: 12px;
            color: #1a1a1a;
        }

        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .info-table td {
            border: 1px solid #333;
            padding: 10px 15px;
            font-size: 14px;
        }
        .info-table .label {
            background-color: #f8f9fa;
            font-weight: 600;
            text-align: center;
            width: 15%;
        }
        .info-table .value {
            width: 35%;
        }

        .content-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .content-table td, .content-table th {
            border: 1px solid #333;
            padding: 0;
            font-size: 13px;
            vertical-align: top;
        }
        .content-table .section-title {
            background-color: #f8f9fa;
            font-weight: 600;
            padding: 12px 15px;
            text-align: left;
        }
        .content-table .section-body {
            padding: 15px;
            min-height: 30px;
        }
        .content-table .subheader {
            background-color: #fafafa;
            font-weight: 600;
            padding: 8px;
            text-align: center;
        }

        .task-table {
            width: 100%;
            border-collapse: collapse;
        }
        .task-table td, .task-table th {
            border: 1px solid #333;
            font-size: 13px;
        }
        .task-table th {
            background-color: #fafafa;
            font-weight: 600;
            padding: 8px;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            tr {
                page-break-inside: avoid;
            }
            p {
                page-break-inside: avoid;
                orphans: 2;
                widows: 2;
            }
        }
    </style>
</head>
<body>
    <div class="date-header">
        : ${jv(e.work_date)}
    </div>

    <div class="title-section">
        <h1 class="main-title">      </h1>
    </div>

    <table class="info-table">
        <tr>
            <td class="label"></td>
            <td class="value">${t(e.work_date)}</td>
            <td class="label"></td>
            <td class="value">${e.user?.team||"-"}</td>
        </tr>
        <tr>
            <td class="label"></td>
            <td class="value">${e.user?.rank||"-"}</td>
            <td class="label"></td>
            <td class="value">${e.user?.name||"-"}</td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title" colspan="3">.  </td>
        </tr>
    </table>
    <table class="task-table">
        <thead>
            <tr>
                <th style="width: 40px;">No</th>
                <th> </th>
                <th style="width: 60px;"></th>
            </tr>
        </thead>
        <tbody>
            ${s(e.morning_work)}
        </tbody>
    </table>

    <table class="content-table" style="margin-top: 15px;">
        <tr>
            <td class="section-title" colspan="3">.  </td>
        </tr>
    </table>
    <table class="task-table">
        <thead>
            <tr>
                <th style="width: 40px;">No</th>
                <th> </th>
                <th style="width: 60px;"></th>
            </tr>
        </thead>
        <tbody>
            ${s(e.afternoon_work)}
        </tbody>
    </table>

    <table class="content-table" style="margin-top: 15px;">
        <tr>
            <td class="section-title">.  </td>
        </tr>
        <tr>
            <td class="section-body">
                ${a(e.next_day_work)}
            </td>
        </tr>
    </table>

    <table class="content-table" style="margin-top: 15px;">
        <tr>
            <td class="section-title">.   </td>
        </tr>
        <tr>
            <td class="section-body">
                ${a(e.special_notes)}
            </td>
        </tr>
    </table>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,l=window.open("","_blank","width=900,height=700");l.document.write(o),l.document.close()},bU=e=>e?e.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0","").replace("?dl=1","").replace("&dl=1",""):"",Ic=e=>{let t="";return typeof e=="string"?t=e:e&&e.url&&(t=e.url),bU(t)},My=e=>{const t=Ic(e);if(!t)return!1;const r=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],s=t.toLowerCase();return r.some(a=>s.includes(a))},wU=({urls:e})=>{const t=X.useRef(null),[r,s]=X.useState(!1),[a,o]=X.useState(!1),[l,u]=X.useState(null),[d,h]=X.useState(!1),[m,x]=X.useState(0),[y,v]=X.useState(0),b=e.filter(My),g=e.filter(D=>!My(D)),_=()=>{if(t.current){const{scrollLeft:D,scrollWidth:V,clientWidth:I}=t.current;s(D>0),o(D<V-I-10)}};X.useEffect(()=>(_(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)),[e]),X.useEffect(()=>{const D=V=>{l!==null&&(V.key==="ArrowLeft"&&E(),V.key==="ArrowRight"&&C(),V.key==="Escape"&&N())};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[l,b.length]);const w=D=>{t.current&&(t.current.scrollBy({left:D==="left"?-200:200,behavior:"smooth"}),setTimeout(_,300))},k=D=>{u(D),v(0)},N=()=>{u(null),v(0)},E=()=>{v(0),u(D=>D>0?D-1:b.length-1)},C=()=>{v(0),u(D=>D<b.length-1?D+1:0)},L=D=>{b.length<=1||(h(!0),x(D.clientX))},O=D=>{b.length<=1||(h(!0),x(D.touches[0].clientX))},B=D=>{if(!d)return;const V=D-m;v(V)},F=D=>{B(D.clientX)},q=D=>{B(D.touches[0].clientX)},fe=()=>{if(!d)return;h(!1);const D=100;y>D?E():y<-D?C():v(0)};return b.length===0&&g.length===0?null:n.jsxs("div",{className:"space-y-3",children:[b.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:[" (",b.length,")"]}),n.jsxs("div",{className:"relative",children:[r&&n.jsx("button",{onClick:()=>w("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx($a,{size:20})}),n.jsx("div",{ref:t,onScroll:_,className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:b.map((D,V)=>{const I=Ic(D);return n.jsx("div",{className:"flex-shrink-0 cursor-pointer w-24 h-24 sm:w-32 sm:h-32 rounded-xl overflow-hidden bg-toss-gray-100",onClick:()=>k(V),children:n.jsx("img",{src:I,alt:`  ${V+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:ae=>{ae.target.style.display="none"}})},V)})}),a&&n.jsx("button",{onClick:()=>w("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx(pa,{size:20})})]})]}),g.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:["  (",g.length,")"]}),n.jsx("div",{className:"space-y-2",children:g.map((D,V)=>{const I=Ic(D),ae=typeof D=="string"?I.split("/").pop():D.name||I.split("/").pop();return n.jsxs("a",{href:I,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-blue hover:underline flex-1 truncate",children:ae}),n.jsx(ts,{size:16,className:"text-toss-gray-500"})]},V)})})]}),l!==null&&n.jsxs("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center select-none",style:{zIndex:9999},onClick:N,onMouseUp:fe,onMouseLeave:fe,onTouchEnd:fe,children:[n.jsx("button",{className:"absolute top-4 right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors",onClick:N,children:n.jsx(mr,{size:24})}),n.jsxs("div",{className:"absolute top-4 left-4 z-10 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm font-medium",children:[l+1," / ",b.length]}),n.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[b.length>1&&n.jsx("button",{onClick:D=>{D.stopPropagation(),E()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:n.jsx($a,{size:36,strokeWidth:3})}),n.jsx("div",{onClick:D=>D.stopPropagation(),onMouseDown:L,onMouseMove:F,onTouchStart:O,onTouchMove:q,className:"max-w-[70vw] sm:max-w-[80vw] max-h-[90vh] relative cursor-grab active:cursor-grabbing",style:{transform:`translateX(${y}px)`,transition:d?"none":"transform 0.3s ease-out"},children:n.jsx("img",{src:Ic(b[l]),alt:`  ${l+1}`,className:"max-w-full max-h-[90vh] object-contain rounded-lg pointer-events-none",draggable:!1})}),b.length>1&&n.jsx("button",{onClick:D=>{D.stopPropagation(),C()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:n.jsx(pa,{size:36,strokeWidth:3})})]}),b.length>1&&n.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2",children:b.map((D,V)=>n.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${V===l?"bg-white":"bg-white/30"}`},V))})]})]})},_U=()=>{const{profile:e,isAdmin:t}=Kr(),[r,s]=X.useState([]),[a,o]=X.useState([]),[l,u]=X.useState(!1),[d,h]=X.useState(!1),[m,x]=X.useState(!0),[y,v]=X.useState(!1),[b,g]=X.useState(null),[_,w]=X.useState(new Date().getFullYear()),[k,N]=X.useState(new Date().getMonth()+1),[E,C]=X.useState("all"),[L,O]=X.useState(1),B=15,F=X.useRef(null),[q,fe]=X.useState({isOpen:!1,message:"",type:"info"}),D=(se,Ne="info")=>{fe({isOpen:!0,message:se,type:Ne})},[V,I]=X.useState({isOpen:!1,worklog:null}),ae=()=>{const se=new Date,Ne=se.getFullYear(),xe=String(se.getMonth()+1).padStart(2,"0"),je=String(se.getDate()).padStart(2,"0");return`${Ne}-${xe}-${je}`},[Q,te]=X.useState({work_date:ae(),morning_tasks:[{content:"",progress:""}],afternoon_tasks:[{content:"",progress:""}],next_day_work:"",special_notes:"",files:[],existingFileUrls:[]}),ve=e?.name==="",[ee,Se]=X.useState({work_date:ae(),morning_work:"",afternoon_work:"",next_day_work:"",special_notes:"",files:[],existingFileUrls:[]}),J=se=>{te(Ne=>({...Ne,[se]:[...Ne[se],{content:"",progress:""}]}))},M=(se,Ne)=>{te(xe=>({...xe,[se]:xe[se].filter((je,de)=>de!==Ne)}))},Y=(se,Ne,xe,je)=>{te(de=>({...de,[se]:de[se].map((Oe,Ue)=>Ue===Ne?{...Oe,[xe]:je}:Oe)}))},G=`
---TASK---
`,re=se=>se.filter(Ne=>Ne.content.trim()).map(Ne=>Ne.progress?`${Ne.content} (${Ne.progress}%)`:Ne.content).join(G),ce=se=>{if(!se)return[{content:"",progress:""}];const Ne=se.includes("---TASK---");let xe;return Ne?xe=se.split(G).filter(je=>je.trim()):/^\d+\.\s*/m.test(se)?(xe=se.split(/\n(?=\d+\.\s*)/).filter(de=>de.trim()),xe=xe.map(de=>de.replace(/^\d+\.\s*/,"").trim())):xe=[se],xe.length===0||xe.length===1&&!xe[0].trim()?[{content:"",progress:""}]:xe.map(je=>{const de=je.trim().split(`
`),Ue=de[de.length-1].match(/^(.+?)\s*\((\d+)%\)$/);return Ue&&de.length===1?{content:Ue[1].trim(),progress:Ue[2]}:Ue&&de.length>1?(de[de.length-1]=Ue[1].trim(),{content:de.join(`
`),progress:Ue[2]}):{content:je.trim(),progress:""}})},P=se=>se?se.replace(/\n---TASK---\n/g,", ").replace(/\n/g," "):"-",U=2026,le=new Date().getFullYear(),ne=Array.from({length:le-U+1},(se,Ne)=>U+Ne),ie=Array.from({length:12},(se,Ne)=>Ne+1);X.useEffect(()=>{S()},[]),X.useEffect(()=>{H()},[r,_,k,E]);const H=()=>{const se=r.filter(Ne=>{const xe=new Date(Ne.work_date),je=xe.getFullYear()===_&&xe.getMonth()+1===k,de=E==="all"||Ne.user_id===E;return je&&de});o(se),O(1)},K=Array.from(new Set(r.map(se=>se.user_id))).map(se=>{const Ne=r.find(xe=>xe.user_id===se);return{user_id:se,name:Ne?.user?.name||"  "}}).sort((se,Ne)=>se.name.localeCompare(Ne.name)),S=async()=>{try{let se=Pe.from("work_logs").select("*").not("type","in",'("weekly","monthly","rescue")').order("work_date",{ascending:!1});!t&&e&&(se=se.eq("user_id",e.user_id));const{data:Ne,error:xe}=await se;if(xe)throw xe;const{data:je,error:de}=await Pe.from("users").select("user_id, name, team, rank");if(de)throw de;const Oe=Ne.map(Ue=>{const rt=je.find(pt=>pt.user_id===Ue.user_id);return{...Ue,user:rt||{name:"  ",team:"-",rank:"-"}}});s(Oe||[])}catch(se){console.error("Error fetching worklogs:",se)}finally{x(!1)}},ue=se=>{const xe=Array.from(se.target.files).map(je=>({file:je,name:je.name,size:(je.size/1024).toFixed(0)+"KB"}));ve?Se(je=>({...je,files:[...je.files,...xe]})):te(je=>({...je,files:[...je.files,...xe]}))},z=se=>{ve?Se(Ne=>({...Ne,files:Ne.files.filter((xe,je)=>je!==se)})):te(Ne=>({...Ne,files:Ne.files.filter((xe,je)=>je!==se)}))},T=se=>{te(Ne=>({...Ne,existingFileUrls:Ne.existingFileUrls.filter((xe,je)=>je!==se)}))},A=async se=>{const Ne=`/intranet/worklogs/${e.user_id}`;return(await rf(se.map(je=>je.file),Ne)).map(je=>je.url)},W=async()=>{if(ve){const de=ee.morning_work.trim(),Oe=ee.afternoon_work.trim();if(!de&&!Oe){D("      .","error");return}try{v(!0);let Ue=[];ee.files.length>0&&(Ue=await A(ee.files));const{error:rt}=await Pe.from("work_logs").insert({work_date:ee.work_date,morning_work:de,afternoon_work:Oe,next_day_work:ee.next_day_work,special_notes:ee.special_notes,file_urls:Ue,user_id:e.user_id,type:"daily",is_read:!1});if(rt)throw rt;u(!1),_e(),S(),D(" .","success")}catch(Ue){console.error("Error creating worklog:",Ue),D("  : "+Ue.message,"error")}finally{v(!1)}return}const se=re(Q.morning_tasks),Ne=re(Q.afternoon_tasks);if(!se&&!Ne){D("      .","error");return}const xe=Q.morning_tasks.filter(de=>de.content.trim()),je=Q.afternoon_tasks.filter(de=>de.content.trim());if(xe.some(de=>!de.progress)||je.some(de=>!de.progress)){D("   (%) .","error");return}try{v(!0);let de=[];Q.files.length>0&&(de=await A(Q.files));const{error:Oe}=await Pe.from("work_logs").insert({work_date:Q.work_date,morning_work:se,afternoon_work:Ne,next_day_work:Q.next_day_work,special_notes:Q.special_notes,file_urls:de,user_id:e.user_id,type:"daily",is_read:!1});if(Oe)throw Oe;u(!1),_e(),S(),D(" .","success")}catch(de){console.error("Error creating worklog:",de),D("  : "+de.message,"error")}finally{v(!1)}},pe=async()=>{if(!b?.id){D("    .  .","error");return}const se=b.id;if(ve){const Oe=ee.morning_work.trim(),Ue=ee.afternoon_work.trim();if(!Oe&&!Ue){D("      .","error");return}try{v(!0);let rt=[];ee.files.length>0&&(rt=await A(ee.files));const pt=[...ee.existingFileUrls,...rt],{error:_t}=await Pe.from("work_logs").update({work_date:ee.work_date,morning_work:Oe,afternoon_work:Ue,next_day_work:ee.next_day_work,special_notes:ee.special_notes,file_urls:pt}).eq("id",se);if(_t)throw _t;u(!1),_e(),S(),D(" .","success")}catch(rt){console.error("Error updating worklog:",rt),D("  : "+rt.message,"error")}finally{v(!1)}return}const Ne=re(Q.morning_tasks),xe=re(Q.afternoon_tasks);if(!Ne&&!xe){D("      .","error");return}const je=Q.morning_tasks.filter(Oe=>Oe.content.trim()),de=Q.afternoon_tasks.filter(Oe=>Oe.content.trim());if(je.some(Oe=>!Oe.progress)||de.some(Oe=>!Oe.progress)){D("   (%) .","error");return}try{v(!0);let Oe=[];Q.files.length>0&&(Oe=await A(Q.files));const Ue=[...Q.existingFileUrls,...Oe],{error:rt}=await Pe.from("work_logs").update({work_date:Q.work_date,morning_work:Ne,afternoon_work:xe,next_day_work:Q.next_day_work,special_notes:Q.special_notes,file_urls:Ue}).eq("id",se);if(rt)throw rt;u(!1),_e(),S(),D(" .","success")}catch(Oe){console.error("Error updating worklog:",Oe),D("  : "+Oe.message,"error")}finally{v(!1)}},_e=()=>{te({work_date:ae(),morning_tasks:[{content:"",progress:""}],afternoon_tasks:[{content:"",progress:""}],next_day_work:"",special_notes:"",files:[],existingFileUrls:[]}),Se({work_date:ae(),morning_work:"",afternoon_work:"",next_day_work:"",special_notes:"",files:[],existingFileUrls:[]}),h(!1),g(null)},oe=se=>{Se({work_date:se.work_date,morning_work:se.morning_work||"",afternoon_work:se.afternoon_work||"",next_day_work:se.next_day_work||"",special_notes:se.special_notes||"",files:[],existingFileUrls:se.file_urls||[]}),te({work_date:se.work_date,morning_tasks:ce(se.morning_work),afternoon_tasks:ce(se.afternoon_work),next_day_work:se.next_day_work||"",special_notes:se.special_notes||"",files:[],existingFileUrls:se.file_urls||[]}),g(se),h(!0),u(!0)},Te=()=>{_e(),u(!0)},Me=()=>{const se=r.filter(xe=>xe.user_id===e?.user_id);if(se.length===0){D("   .","info");return}const Ne=se[0];ve?Se(xe=>({...xe,morning_work:Ne.morning_work||"",afternoon_work:Ne.afternoon_work||"",next_day_work:Ne.next_day_work||"",special_notes:""})):te(xe=>({...xe,morning_tasks:ce(Ne.morning_work),afternoon_tasks:ce(Ne.afternoon_work),next_day_work:Ne.next_day_work||"",special_notes:""})),D("  .","success")},Ae=(se,Ne,xe)=>{const je=Q[Ne],de=xe===je.length-1;se.key==="Tab"&&!se.shiftKey&&de&&(se.preventDefault(),J(Ne),setTimeout(()=>{const Oe=Ne==="morning_tasks"?`[data-morning-task="${xe+1}"]`:`[data-afternoon-task="${xe+1}"]`;document.querySelector(Oe)?.focus()},0))},Re=se=>{I({isOpen:!0,worklog:se})},et=async()=>{const se=V.worklog;if(se){I({isOpen:!1,worklog:null});try{se.file_urls&&se.file_urls.length>0&&await sm(se.file_urls);const{error:Ne}=await Pe.from("work_logs").delete().eq("id",se.id);if(Ne)throw Ne;S(),D(".","success")}catch(Ne){console.error("Error deleting worklog:",Ne),D(" .","error")}}},He=async se=>{g(se),t&&!se.is_read&&(await Pe.from("work_logs").update({is_read:!0}).eq("id",se.id),S())},at=se=>{vU(se,wt)},De=async se=>{const Ne=`https://khwzdwewgadvpglptvua.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(se)}`,xe=await fetch(Ne);if(!xe.ok)throw new Error(`  : ${xe.status}`);return await xe.arrayBuffer()},mt=async se=>{const Ne={top:{style:nr.SINGLE,size:1,color:"000000"},bottom:{style:nr.SINGLE,size:1,color:"000000"},left:{style:nr.SINGLE,size:1,color:"000000"},right:{style:nr.SINGLE,size:1,color:"000000"}},xe=pt=>{if(!pt)return[new pr({children:[new gt({children:[new ot({text:"-",alignment:Dt.CENTER})],width:{size:600,type:Bt.DXA},borders:Ne}),new gt({children:[new ot({text:""})],borders:Ne}),new gt({children:[new ot({text:"-",alignment:Dt.CENTER})],width:{size:1e3,type:Bt.DXA},borders:Ne})]})];const Vt=pt.includes("---TASK---")?pt.split(G).filter(yr=>yr.trim()):pt.split(`
`).filter(yr=>yr.trim());return Vt.length===0?[new pr({children:[new gt({children:[new ot({text:"-",alignment:Dt.CENTER})],width:{size:600,type:Bt.DXA},borders:Ne}),new gt({children:[new ot({text:""})],borders:Ne}),new gt({children:[new ot({text:"-",alignment:Dt.CENTER})],width:{size:1e3,type:Bt.DXA},borders:Ne})]})]:Vt.map((yr,_r)=>{const zt=yr.trim().split(`
`),kr=zt[zt.length-1].match(/^(.+?)\s*\((\d+)%\)$/);let Jr=yr.trim(),he="-";kr&&zt.length===1?(Jr=kr[1].trim(),he=kr[2]+"%"):kr&&zt.length>1&&(zt[zt.length-1]=kr[1].trim(),Jr=zt.join(`
`),he=kr[2]+"%");const we=Jr.split(`
`).map(ye=>new ot({text:ye}));return new pr({children:[new gt({children:[new ot({text:String(_r+1),alignment:Dt.CENTER})],width:{size:600,type:Bt.DXA},borders:Ne}),new gt({children:we,borders:Ne}),new gt({children:[new ot({text:he,alignment:Dt.CENTER})],width:{size:1e3,type:Bt.DXA},borders:Ne})]})})},je=[],de=[];if(se.file_urls&&se.file_urls.length>0){const pt=se.file_urls.filter(_t=>{const Vt=Ic(_t);return My({url:Vt})});for(const _t of pt)try{const Vt=Ic(_t),yr=await De(Vt),_r=new Blob([yr]),zt=URL.createObjectURL(_r),fr=new Image;fr.src=zt,await new Promise((qe,Ke)=>{fr.onload=qe,fr.onerror=Ke});const kr=240,Jr=320;let he=fr.width,we=fr.height;const ye=Math.min(kr/he,Jr/we,1);he=Math.round(he*ye),we=Math.round(we*ye);const be=document.createElement("canvas"),ke=be.getContext("2d");be.width=he,be.height=we,ke.drawImage(fr,0,0,he,we);let Ee=.7,We=await new Promise(qe=>{be.toBlob(qe,"image/jpeg",Ee)});const st=300*1024;for(;We.size>st&&Ee>.3;)Ee-=.1,We=await new Promise(qe=>{be.toBlob(qe,"image/jpeg",Ee)});const $e=await We.arrayBuffer();URL.revokeObjectURL(zt),je.push({data:$e,width:he,height:we})}catch(Vt){console.error("  :",Vt);const yr=typeof _t=="string"?_t.split("/").pop():_t.name||"";de.push(yr)}}const Oe=[];for(let pt=0;pt<je.length;pt+=2){const _t=[];_t.push(new gt({children:[new ot({children:[new sk({data:je[pt].data,transformation:{width:je[pt].width,height:je[pt].height},type:"jpg"})],alignment:Dt.CENTER})],width:{size:50,type:Bt.PERCENTAGE},borders:{top:{style:nr.NONE},bottom:{style:nr.NONE},left:{style:nr.NONE},right:{style:nr.NONE}}})),pt+1<je.length?_t.push(new gt({children:[new ot({children:[new sk({data:je[pt+1].data,transformation:{width:je[pt+1].width,height:je[pt+1].height},type:"jpg"})],alignment:Dt.CENTER})],width:{size:50,type:Bt.PERCENTAGE},borders:{top:{style:nr.NONE},bottom:{style:nr.NONE},left:{style:nr.NONE},right:{style:nr.NONE}}})):_t.push(new gt({children:[new ot({text:""})],width:{size:50,type:Bt.PERCENTAGE},borders:{top:{style:nr.NONE},bottom:{style:nr.NONE},left:{style:nr.NONE},right:{style:nr.NONE}}})),Oe.push(new pr({children:_t}))}const Ue=new fm({sections:[{properties:{},children:[new ot({children:[new Tt({text:"      ",bold:!0,size:48})],alignment:Dt.CENTER,spacing:{after:400},border:{bottom:{style:nr.SINGLE,size:12,color:"333333"}}}),new ot({text:"",spacing:{after:200}}),new Sa({rows:[new pr({children:[new gt({children:[new ot({text:"",alignment:Dt.CENTER})],width:{size:1500,type:Bt.DXA},shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:wt(se.work_date)})],width:{size:3e3,type:Bt.DXA},borders:Ne}),new gt({children:[new ot({text:"",alignment:Dt.CENTER})],width:{size:1500,type:Bt.DXA},shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:se.user?.team||"-"})],width:{size:3e3,type:Bt.DXA},borders:Ne})]}),new pr({children:[new gt({children:[new ot({text:"",alignment:Dt.CENTER})],shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:se.user?.rank||"-"})],borders:Ne}),new gt({children:[new ot({text:"",alignment:Dt.CENTER})],shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:se.user?.name||"-"})],borders:Ne})]})],width:{size:100,type:Bt.PERCENTAGE}}),new ot({text:"",spacing:{after:300}}),new Sa({rows:[new pr({children:[new gt({children:[new ot({children:[new Tt({text:".  ",bold:!0})]})],columnSpan:3,shading:{fill:"F8F9FA"},borders:Ne})]}),new pr({children:[new gt({children:[new ot({text:"No",alignment:Dt.CENTER})],width:{size:600,type:Bt.DXA},shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:" ",alignment:Dt.CENTER})],shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:"",alignment:Dt.CENTER})],width:{size:1e3,type:Bt.DXA},shading:{fill:"F8F9FA"},borders:Ne})]}),...xe(se.morning_work)],width:{size:100,type:Bt.PERCENTAGE}}),new ot({text:"",spacing:{after:200}}),new Sa({rows:[new pr({children:[new gt({children:[new ot({children:[new Tt({text:".  ",bold:!0})]})],columnSpan:3,shading:{fill:"F8F9FA"},borders:Ne})]}),new pr({children:[new gt({children:[new ot({text:"No",alignment:Dt.CENTER})],width:{size:600,type:Bt.DXA},shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:" ",alignment:Dt.CENTER})],shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:"",alignment:Dt.CENTER})],width:{size:1e3,type:Bt.DXA},shading:{fill:"F8F9FA"},borders:Ne})]}),...xe(se.afternoon_work)],width:{size:100,type:Bt.PERCENTAGE}}),new ot({text:"",spacing:{after:200}}),new Sa({rows:[new pr({children:[new gt({children:[new ot({children:[new Tt({text:".  ",bold:!0})]})],shading:{fill:"F8F9FA"},borders:Ne})]}),new pr({children:[new gt({children:[new ot({text:se.next_day_work||"-"})],borders:Ne})]})],width:{size:100,type:Bt.PERCENTAGE}}),new ot({text:"",spacing:{after:200}}),new Sa({rows:[new pr({children:[new gt({children:[new ot({children:[new Tt({text:".   ",bold:!0})]})],shading:{fill:"F8F9FA"},borders:Ne})]}),new pr({children:[new gt({children:[new ot({text:se.special_notes||"-"})],borders:Ne})]})],width:{size:100,type:Bt.PERCENTAGE}}),new ot({text:"",spacing:{after:400}}),new ot({children:[new Tt({text:"",bold:!0,size:28})],alignment:Dt.CENTER}),...je.length>0?[new ot({text:"",spacing:{after:300}}),new ot({children:[new Tt({text:" ",bold:!0,size:24})]}),new Sa({rows:Oe,width:{size:100,type:Bt.PERCENTAGE}})]:[],...de.length>0?[new ot({text:""}),new ot({children:[new Tt({text:"(   )",italics:!0,color:"666666"})]}),...de.map((pt,_t)=>new ot({children:[new Tt({text:`${_t+1}. ${pt}`,color:"0066CC"})]}))]:[]]}]}),rt=await hm.toBlob(Ue);mm.saveAs(rt,`_${se.work_date}_${se.user?.name||""}.docx`)},At=se=>{const Ne=["","","","","","",""],xe=new Date(se);return Ne[xe.getDay()]},wt=se=>new Date(se).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})+` (${At(se)})`,Ct=L*B,It=Ct-B,Le=a.slice(It,Ct),tt=Math.ceil(a.length/B),ct=se=>{O(se)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(Gs,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:t?"  ":`${e?.name||""}  `}),n.jsx("p",{className:"text-white/90",children:t?"        ":`${e?.team?`${e.team}  `:""}${e?.rank||" "}`})]})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),n.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[n.jsx("select",{value:_,onChange:se=>w(Number(se.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:ne.map(se=>n.jsxs("option",{value:se,children:[se,""]},se))}),n.jsx("select",{value:k,onChange:se=>N(Number(se.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:ie.map(se=>n.jsxs("option",{value:se,children:[se,""]},se))}),t&&K.length>0&&n.jsxs("select",{value:E,onChange:se=>C(se.target.value),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:[n.jsx("option",{value:"all",children:" "}),K.map(se=>n.jsx("option",{value:se.user_id,children:se.name},se.user_id))]}),n.jsxs(Ye,{onClick:Te,children:[n.jsx(ps,{size:18}),"  "]})]})]}),n.jsx(Et,{padding:"p-0 sm:p-6",children:m?n.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:" ..."}):Le.length>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full min-w-[800px]",children:[n.jsx("thead",{className:"bg-toss-gray-100 border-b-2 border-toss-gray-300",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),t&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700",children:" "}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700",children:" "}),n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:Le.map((se,Ne)=>n.jsxs("tr",{className:`hover:bg-toss-gray-50 transition-colors ${t&&!se.is_read?"bg-blue-50":""}`,children:[n.jsx("td",{className:"px-3 py-3 text-sm text-center text-toss-gray-600 whitespace-nowrap",children:It+Ne+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 cursor-pointer hover:text-toss-blue whitespace-nowrap",onClick:()=>He(se),children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ha,{size:14,className:"text-toss-gray-400 flex-shrink-0"}),n.jsx("span",{children:new Date(se.work_date).toLocaleDateString("ko-KR")}),t&&!se.is_read&&n.jsx("span",{className:"inline-block bg-red-500 text-white px-1.5 py-0.5 rounded-full text-xs font-medium flex-shrink-0",children:"N"})]})}),t&&n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 cursor-pointer hover:text-toss-blue hover:underline whitespace-nowrap",onClick:xe=>{xe.stopPropagation(),C(se.user_id)},children:se.user?.name||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-600 whitespace-nowrap",children:se.user?.team||"-"})]}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 cursor-pointer max-w-[200px] truncate",onClick:()=>He(se),children:P(se.morning_work)}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 cursor-pointer max-w-[200px] truncate",onClick:()=>He(se),children:P(se.afternoon_work)}),n.jsx("td",{className:"px-3 py-3 text-center whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:xe=>{xe.stopPropagation(),at(se)},className:"p-2 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"PDF ",children:n.jsx(na,{size:16})}),n.jsx("button",{onClick:xe=>{xe.stopPropagation(),mt(se)},className:"p-2 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"Word ",children:n.jsx(ts,{size:16})}),(e?.user_id===se.user_id||t)&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>oe(se),className:"p-2 text-blue-500 hover:bg-blue-100 rounded-lg transition-colors",title:"",children:n.jsx(js,{size:16})}),n.jsx("button",{onClick:()=>Re(se),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(Jt,{size:16})})]})]})})]},se.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:Le.map((se,Ne)=>n.jsxs("div",{className:`p-4 ${t&&!se.is_read?"bg-blue-50":""}`,onClick:()=>He(se),children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["#",It+Ne+1]}),n.jsx(ha,{size:14,className:"text-toss-gray-400"}),n.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:new Date(se.work_date).toLocaleDateString("ko-KR")}),t&&!se.is_read&&n.jsx("span",{className:"bg-red-500 text-white px-2 py-0.5 rounded-full text-xs font-medium",children:"NEW"})]}),n.jsxs("div",{className:"flex items-center gap-1",onClick:xe=>xe.stopPropagation(),children:[n.jsx("button",{onClick:()=>at(se),className:"p-1.5 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg",title:"PDF ",children:n.jsx(na,{size:14})}),n.jsx("button",{onClick:()=>mt(se),className:"p-1.5 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg",title:"Word ",children:n.jsx(ts,{size:14})}),(e?.user_id===se.user_id||t)&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>oe(se),className:"p-1.5 text-blue-500 hover:bg-blue-100 rounded-lg",children:n.jsx(js,{size:14})}),n.jsx("button",{onClick:()=>Re(se),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:n.jsx(Jt,{size:14})})]})]})]}),t&&n.jsxs("div",{className:"text-xs text-toss-gray-600 mb-2",children:[n.jsx("span",{className:"font-medium",children:se.user?.name||"-"}),n.jsx("span",{className:"mx-1",children:""}),n.jsx("span",{children:se.user?.team||"-"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("p",{className:"text-sm text-toss-gray-700 line-clamp-1",children:[n.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),P(se.morning_work)]}),n.jsxs("p",{className:"text-sm text-toss-gray-700 line-clamp-1",children:[n.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),P(se.afternoon_work)]})]})]},se.id))}),tt>1&&n.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-toss-gray-200",children:[n.jsx("button",{onClick:()=>ct(L-1),disabled:L===1,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),[...Array(tt)].map((se,Ne)=>n.jsx("button",{onClick:()=>ct(Ne+1),className:`px-3 py-1 rounded-lg text-sm font-medium ${L===Ne+1?"bg-toss-blue text-white":"text-toss-gray-700 hover:bg-toss-gray-100"}`,children:Ne+1},Ne+1)),n.jsx("button",{onClick:()=>ct(L+1),disabled:L===tt,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]}):n.jsxs("div",{className:"text-center text-toss-gray-500 py-8",children:[_," ",k,"   "]})}),n.jsx(dr,{isOpen:l,onClose:()=>{u(!1),_e()},title:d?"  ":"   ",children:n.jsxs("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto pr-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),n.jsx("input",{type:"date",value:ve?ee.work_date:Q.work_date,onChange:se=>ve?Se({...ee,work_date:se.target.value}):te({...Q,work_date:se.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all"}),n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:wt(ve?ee.work_date:Q.work_date)})]}),!d&&n.jsxs("button",{type:"button",onClick:Me,className:"flex items-center gap-2 px-4 py-2.5 bg-toss-gray-100 text-toss-gray-700 rounded-xl hover:bg-toss-gray-200 transition-colors text-sm font-medium w-full justify-center",children:[n.jsx(em,{size:16}),"  "]}),ve?n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:ee.morning_work,onChange:se=>Se({...ee,morning_work:se.target.value}),rows:4,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"    "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:ee.afternoon_work,onChange:se=>Se({...ee,afternoon_work:se.target.value}),rows:4,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"    "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:ee.next_day_work,onChange:se=>Se({...ee,next_day_work:se.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"   "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"()"}),n.jsx("textarea",{value:ee.special_notes,onChange:se=>Se({...ee,special_notes:se.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),d&&ee.existingFileUrls.length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("div",{className:"space-y-2",children:ee.existingFileUrls.map((se,Ne)=>{const xe=se.split("/").pop();return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:xe})]}),n.jsx("button",{onClick:()=>{Se(je=>({...je,existingFileUrls:je.existingFileUrls.filter((de,Oe)=>Oe!==Ne)}))},className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(mr,{size:16})})]},Ne)})})]})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsxs("div",{className:"space-y-2",children:[Q.morning_tasks.map((se,Ne)=>n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"w-6 text-center text-sm font-medium text-toss-gray-500 pt-3",children:Ne+1}),n.jsx("textarea",{value:se.content,onChange:xe=>Y("morning_tasks",Ne,"content",xe.target.value),onKeyDown:xe=>Ae(xe,"morning_tasks",Ne),"data-morning-task":Ne,rows:2,className:"flex-1 px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all resize-none leading-relaxed",placeholder:"   (Enter , Tab  )"}),n.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:se.progress,onChange:xe=>{const je=xe.target.value.replace(/[^0-9]/g,"");(je===""||parseInt(je)>=0&&parseInt(je)<=100)&&Y("morning_tasks",Ne,"progress",je)},className:"w-16 px-2 self-stretch bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all text-center",placeholder:"%"}),Q.morning_tasks.length>1&&n.jsx("button",{type:"button",onClick:()=>M("morning_tasks",Ne),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:n.jsx(Jt,{size:18})})]},Ne)),n.jsxs("button",{type:"button",onClick:()=>J("morning_tasks"),className:"flex items-center gap-2 px-4 py-2 text-toss-blue hover:bg-toss-blue/10 rounded-xl transition-colors text-sm font-medium",children:[n.jsx(C0,{size:16})," "]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsxs("div",{className:"space-y-2",children:[Q.afternoon_tasks.map((se,Ne)=>n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"w-6 text-center text-sm font-medium text-toss-gray-500 pt-3",children:Ne+1}),n.jsx("textarea",{value:se.content,onChange:xe=>Y("afternoon_tasks",Ne,"content",xe.target.value),onKeyDown:xe=>Ae(xe,"afternoon_tasks",Ne),"data-afternoon-task":Ne,rows:2,className:"flex-1 px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all resize-none leading-relaxed",placeholder:"   (Enter , Tab  )"}),n.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:se.progress,onChange:xe=>{const je=xe.target.value.replace(/[^0-9]/g,"");(je===""||parseInt(je)>=0&&parseInt(je)<=100)&&Y("afternoon_tasks",Ne,"progress",je)},className:"w-16 px-2 self-stretch bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all text-center",placeholder:"%"}),Q.afternoon_tasks.length>1&&n.jsx("button",{type:"button",onClick:()=>M("afternoon_tasks",Ne),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:n.jsx(Jt,{size:18})})]},Ne)),n.jsxs("button",{type:"button",onClick:()=>J("afternoon_tasks"),className:"flex items-center gap-2 px-4 py-2 text-toss-blue hover:bg-toss-blue/10 rounded-xl transition-colors text-sm font-medium",children:[n.jsx(C0,{size:16})," "]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:Q.next_day_work,onChange:se=>te({...Q,next_day_work:se.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"   "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"()"}),n.jsx("textarea",{value:Q.special_notes,onChange:se=>te({...Q,special_notes:se.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),d&&Q.existingFileUrls.length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("div",{className:"space-y-2",children:Q.existingFileUrls.map((se,Ne)=>{const xe=se.split("/").pop();return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:xe})]}),n.jsx("button",{onClick:()=>T(Ne),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(mr,{size:16})})]},Ne)})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  (  )"}),n.jsx("input",{type:"file",ref:F,multiple:!0,onChange:ue,className:"hidden"}),n.jsx("button",{type:"button",onClick:()=>F.current?.click(),className:"w-full p-6 border-2 border-dashed border-toss-gray-300 rounded-2xl hover:border-toss-blue hover:bg-toss-blue/5 transition-all",children:n.jsxs("div",{className:"flex flex-col items-center gap-2 text-toss-gray-600",children:[n.jsx(ji,{size:28}),n.jsx("span",{className:"font-medium",children:" "}),n.jsx("span",{className:"text-xs text-toss-gray-500",children:"   "})]})}),(ve?ee.files:Q.files).length>0&&n.jsx("div",{className:"mt-4 space-y-2",children:(ve?ee.files:Q.files).map((se,Ne)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:se.name}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["(",se.size,")"]})]}),n.jsx("button",{onClick:()=>z(Ne),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(mr,{size:16})})]},Ne))})]}),n.jsxs("div",{className:"flex gap-3 pt-4 sticky bottom-0 bg-white",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{u(!1),_e()},className:"flex-1",children:""}),n.jsx(Ye,{onClick:d?pe:W,className:"flex-1",loading:y,disabled:y,children:y?" ...":d?"":""})]})]})}),n.jsx(dr,{isOpen:!!b&&!l,onClose:()=>g(null),title:"  ",children:b&&n.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto -mx-2 px-2",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900",children:wt(b.work_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 font-medium",children:b.user?`${b.user.name}  ${b.user.team||" "}`:"-"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[80px]",children:b.morning_work?n.jsx("div",{className:"space-y-2",children:ce(b.morning_work).map((se,Ne)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("span",{className:"w-6 text-center text-sm font-medium text-toss-gray-500 flex-shrink-0",children:Ne+1}),n.jsx("span",{className:"flex-1 text-toss-gray-900 whitespace-pre-wrap",children:se.content}),se.progress&&n.jsxs("span",{className:"text-sm font-medium text-toss-blue flex-shrink-0",children:[se.progress,"%"]})]},Ne))}):n.jsx("span",{className:"text-toss-gray-500",children:"-"})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[80px]",children:b.afternoon_work?n.jsx("div",{className:"space-y-2",children:ce(b.afternoon_work).map((se,Ne)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("span",{className:"w-6 text-center text-sm font-medium text-toss-gray-500 flex-shrink-0",children:Ne+1}),n.jsx("span",{className:"flex-1 text-toss-gray-900 whitespace-pre-wrap",children:se.content}),se.progress&&n.jsxs("span",{className:"text-sm font-medium text-toss-blue flex-shrink-0",children:[se.progress,"%"]})]},Ne))}):n.jsx("span",{className:"text-toss-gray-500",children:"-"})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[80px] whitespace-pre-wrap text-toss-gray-900",children:b.next_day_work||"-"})]}),b.special_notes&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:"()"}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 whitespace-pre-wrap text-toss-gray-900",children:b.special_notes})]}),b.file_urls&&b.file_urls.length>0&&n.jsx(wU,{urls:b.file_urls}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[n.jsxs("button",{onClick:()=>at(b),className:"flex items-center gap-2 px-4 py-2 bg-toss-gray-100 text-toss-gray-700 rounded-xl hover:bg-toss-gray-200 transition-colors text-sm font-medium",children:[n.jsx(na,{size:16}),"PDF "]}),n.jsxs("button",{onClick:()=>mt(b),className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 rounded-xl hover:bg-blue-100 transition-colors text-sm font-medium",children:[n.jsx(MF,{size:16}),"Word "]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>g(null),className:"flex-1",children:""}),n.jsx(Ye,{onClick:()=>oe(b),className:"flex-1",children:""})]})]})}),q.isOpen&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:1e4},onClick:()=>fe({...q,isOpen:!1}),children:n.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl animate-in fade-in zoom-in duration-200",onClick:se=>se.stopPropagation(),children:n.jsxs("div",{className:"flex flex-col items-center text-center",children:[n.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center mb-4 ${q.type==="success"?"bg-green-100":q.type==="error"?"bg-red-100":"bg-blue-100"}`,children:q.type==="success"?n.jsx(Ws,{className:"w-7 h-7 text-green-600"}):q.type==="error"?n.jsx(Sn,{className:"w-7 h-7 text-red-600"}):n.jsx(Sn,{className:"w-7 h-7 text-blue-600"})}),n.jsx("p",{className:"text-toss-gray-900 font-medium mb-6 leading-relaxed",children:q.message}),n.jsx("button",{onClick:()=>fe({...q,isOpen:!1}),className:`w-full py-3 rounded-xl font-medium transition-colors ${q.type==="success"?"bg-green-500 hover:bg-green-600 text-white":q.type==="error"?"bg-red-500 hover:bg-red-600 text-white":"bg-toss-blue hover:bg-blue-600 text-white"}`,children:""})]})})}),V.isOpen&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:1e4},onClick:()=>I({isOpen:!1,worklog:null}),children:n.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl animate-in fade-in zoom-in duration-200",onClick:se=>se.stopPropagation(),children:n.jsxs("div",{className:"flex flex-col items-center text-center",children:[n.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center mb-4 bg-red-100",children:n.jsx(Jt,{className:"w-7 h-7 text-red-600"})}),n.jsx("p",{className:"text-toss-gray-900 font-medium mb-6 leading-relaxed",children:" ?"}),n.jsxs("div",{className:"flex gap-3 w-full",children:[n.jsx("button",{onClick:()=>I({isOpen:!1,worklog:null}),className:"flex-1 py-3 rounded-xl font-medium transition-colors bg-gray-100 hover:bg-gray-200 text-toss-gray-700",children:""}),n.jsx("button",{onClick:et,className:"flex-1 py-3 rounded-xl font-medium transition-colors bg-red-500 hover:bg-red-600 text-white",children:""})]})]})})})]})};function ul({title:e,date:t,content:r}){const s=t||new Date().toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}),a=`
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>${e}</title>
  <style>
    @page {
      size: A4;
      margin: 15mm 15mm 20mm 15mm;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      color: #1a1a1a;
      line-height: 1.5;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }
    .report-header {
      text-align: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 3px solid #2c6eb6;
    }
    .report-header h1 {
      font-size: 24px;
      font-weight: 800;
      color: #1a1a1a;
      margin-bottom: 8px;
    }
    .report-header .org-name {
      font-size: 14px;
      color: #2c6eb6;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .report-header .date {
      font-size: 13px;
      color: #666;
    }
    .stats-grid {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
    }
    .stat-box {
      flex: 1;
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 10px;
      text-align: center;
    }
    .stat-box .label {
      font-size: 11px;
      color: #888;
      margin-bottom: 2px;
    }
    .stat-box .value {
      font-size: 22px;
      font-weight: 700;
      color: #1a1a1a;
    }
    .stat-box .unit {
      font-size: 12px;
      font-weight: 400;
      color: #888;
    }
    .stat-box.highlight {
      border-color: #2c6eb6;
      background: #f0f6ff;
    }
    .stat-box.highlight .value {
      color: #2c6eb6;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 16px;
      font-size: 12px;
    }
    table th {
      background: #2c6eb6;
      color: white;
      font-weight: 600;
      padding: 8px 10px;
      text-align: center;
      font-size: 12px;
    }
    table td {
      padding: 7px 10px;
      border-bottom: 1px solid #e5e5e5;
      font-size: 12px;
    }
    table tr:nth-child(even) {
      background: #f8f9fa;
    }
    .section-title {
      font-size: 15px;
      font-weight: 700;
      color: #333;
      margin: 16px 0 8px;
      padding-left: 8px;
      border-left: 3px solid #2c6eb6;
    }
  </style>
</head>
<body>
  <div class="report-header">
    <div class="org-name"></div>
    <h1>${e}</h1>
    <div class="date">: ${s}</div>
  </div>
  ${r}
</body>
</html>`,o=document.getElementById("print-report-frame");o&&o.remove();const l=document.createElement("iframe");l.id="print-report-frame",l.style.position="fixed",l.style.top="-10000px",l.style.left="-10000px",l.style.width="0",l.style.height="0",l.style.border="none",document.body.appendChild(l);const u=l.contentDocument||l.contentWindow?.document;u&&(u.open(),u.write(a),u.close(),l.onload=()=>{l.contentWindow?.focus(),l.contentWindow?.print()})}const Tv=()=>({content:"",progress:"",remark:""}),Un=()=>({title:"",details:[Tv()]}),F0=e=>{const t=e.filter(r=>r.title.trim()||r.details.some(s=>s.content.trim()));return t.length>0?JSON.stringify(t):""},hi=e=>{if(!e)return[Un()];const t=r=>{if(!r.length)return[Un()];if(typeof r[0]=="object"){if("details"in r[0])return r;if("content"in r[0])return r.map(s=>({title:s.title||"",details:[{content:s.content||"",progress:s.progress||"",remark:s.remark||""}]}))}return[Un()]};if(Array.isArray(e))return t(e);if(typeof e=="string"){try{const r=JSON.parse(e);if(Array.isArray(r)&&r.length>0)return t(r)}catch{}return[{title:"",details:[{content:e,progress:"",remark:""}]}]}return[Un()]},L0=e=>{if(!e)return"-";const t=r=>{if(!r.length)return"-";const s=r[0],a=r.length>1?`  ${r.length-1}`:"";return s&&"details"in s?((s.title||s.details?.[0]?.content||"-")+a).substring(0,80):s&&"content"in s?((s.title||s.content)+a).substring(0,80):"-"};if(Array.isArray(e))return t(e);if(typeof e=="string"){try{const s=JSON.parse(e);if(Array.isArray(s))return t(s)}catch{}return(e.split(`
`).filter(s=>s.trim()&&!s.startsWith("---"))[0]||e).substring(0,80)}return"-"},NU=e=>e?e.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0","").replace("?dl=1","").replace("&dl=1",""):"",b0=e=>{let t="";return typeof e=="string"?t=e:e&&e.url&&(t=e.url),NU(t)},vk=e=>{const t=b0(e);if(!t)return!1;const r=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],s=t.toLowerCase();return r.some(a=>s.includes(a))},SU=({urls:e})=>{const t=X.useRef(null),[r,s]=X.useState(!1),[a,o]=X.useState(!1),[l,u]=X.useState(null),[d,h]=X.useState(!1),[m,x]=X.useState(0),[y,v]=X.useState(0),b=e.filter(vk),g=e.filter(D=>!vk(D)),_=()=>{if(t.current){const{scrollLeft:D,scrollWidth:V,clientWidth:I}=t.current;s(D>0),o(D<V-I-10)}};X.useEffect(()=>(_(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)),[e]),X.useEffect(()=>{const D=V=>{l!==null&&(V.key==="ArrowLeft"&&E(),V.key==="ArrowRight"&&C(),V.key==="Escape"&&N())};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[l,b.length]);const w=D=>{t.current&&(t.current.scrollBy({left:D==="left"?-200:200,behavior:"smooth"}),setTimeout(_,300))},k=D=>{u(D),v(0)},N=()=>{u(null),v(0)},E=()=>{v(0),u(D=>D!==null&&D>0?D-1:b.length-1)},C=()=>{v(0),u(D=>D!==null&&D<b.length-1?D+1:0)},L=D=>{b.length<=1||(h(!0),x(D.clientX))},O=D=>{b.length<=1||(h(!0),x(D.touches[0].clientX))},B=D=>{if(!d)return;const V=D-m;v(V)},F=D=>{B(D.clientX)},q=D=>{B(D.touches[0].clientX)},fe=()=>{if(!d)return;h(!1);const D=100;y>D?E():y<-D?C():v(0)};return b.length===0&&g.length===0?null:n.jsxs("div",{className:"space-y-3",children:[b.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:[" (",b.length,")"]}),n.jsxs("div",{className:"relative",children:[r&&n.jsx("button",{onClick:()=>w("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx($a,{size:20})}),n.jsx("div",{ref:t,onScroll:_,className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:b.map((D,V)=>{const I=b0(D);return n.jsx("div",{className:"flex-shrink-0 cursor-pointer w-24 h-24 sm:w-32 sm:h-32 rounded-xl overflow-hidden bg-toss-gray-100",onClick:()=>k(V),children:n.jsx("img",{src:I,alt:`  ${V+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:ae=>{ae.target.style.display="none"}})},V)})}),a&&n.jsx("button",{onClick:()=>w("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx(pa,{size:20})})]})]}),g.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:["  (",g.length,")"]}),n.jsx("div",{className:"space-y-2",children:g.map((D,V)=>{const I=b0(D),ae=typeof D=="string"?I.split("/").pop():D.name||I.split("/").pop();return n.jsxs("a",{href:I,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-blue hover:underline flex-1 truncate",children:ae}),n.jsx(ts,{size:16,className:"text-toss-gray-500"})]},V)})})]}),l!==null&&n.jsxs("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center select-none",style:{zIndex:9999},onClick:N,onMouseUp:fe,onMouseLeave:fe,onTouchEnd:fe,children:[n.jsx("button",{className:"absolute top-4 right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors",onClick:N,children:n.jsx(mr,{size:24})}),n.jsxs("div",{className:"absolute top-4 left-4 z-10 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm font-medium",children:[l+1," / ",b.length]}),n.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[b.length>1&&n.jsx("button",{onClick:D=>{D.stopPropagation(),E()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:n.jsx($a,{size:36,strokeWidth:3})}),n.jsx("div",{onClick:D=>D.stopPropagation(),onMouseDown:L,onMouseMove:F,onTouchStart:O,onTouchMove:q,className:"max-w-[70vw] sm:max-w-[80vw] max-h-[90vh] relative cursor-grab active:cursor-grabbing",style:{transform:`translateX(${y}px)`,transition:d?"none":"transform 0.3s ease-out"},children:n.jsx("img",{src:b0(b[l]),alt:`  ${l+1}`,className:"max-w-full max-h-[90vh] object-contain rounded-lg pointer-events-none",draggable:!1})}),b.length>1&&n.jsx("button",{onClick:D=>{D.stopPropagation(),C()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:n.jsx(pa,{size:36,strokeWidth:3})})]}),b.length>1&&n.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2",children:b.map((D,V)=>n.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${V===l?"bg-white":"bg-white/30"}`},V))})]})]})},kU=()=>{const{profile:e,isAdmin:t}=Kr(),[r,s]=X.useState([]),[a,o]=X.useState([]),[l,u]=X.useState(!1),[d,h]=X.useState(!1),[m,x]=X.useState(!0),[y,v]=X.useState(!1),[b,g]=X.useState(null),[_,w]=X.useState(new Date().getFullYear()),[k,N]=X.useState(new Date().getMonth()+1),[E,C]=X.useState("all"),[L,O]=X.useState(1),B=15,F=X.useRef(null),[q,fe]=X.useState(new Set),[D,V]=X.useState(!1),[I,ae]=X.useState(!1),[Q,te]=X.useState([]),ve=()=>{const xe=new Date;return xe.getDay()===1&&xe.setDate(xe.getDate()-3),xe.toISOString().split("T")[0]},[ee,Se]=X.useState({work_date:ve(),weekly_tasks:[Un()],this_week_work:"",special_notes:"",files:[],existingFileUrls:[]}),J=2026,M=new Date().getFullYear(),Y=Array.from({length:M-J+1},(xe,je)=>J+je),G=Array.from({length:12},(xe,je)=>je+1);X.useEffect(()=>{P()},[]),X.useEffect(()=>{re()},[r,_,k,E]);const re=()=>{const xe=r.filter(je=>{const de=new Date(je.work_date),Oe=de.getFullYear()===_&&de.getMonth()+1===k,Ue=E==="all"||je.user_id===E;return Oe&&Ue});o(xe),O(1)},ce=Array.from(new Set(r.map(xe=>xe.user_id))).map(xe=>{const je=r.find(de=>de.user_id===xe);return{user_id:xe,name:je?.user?.name||"  "}}).sort((xe,je)=>xe.name.localeCompare(je.name)),P=async()=>{try{let xe=Pe.from("work_logs").select("*").eq("type","weekly").order("work_date",{ascending:!1});!t&&e&&(xe=xe.eq("user_id",e.user_id));const{data:je,error:de}=await xe;if(de)throw de;const{data:Oe,error:Ue}=await Pe.from("users").select("user_id, name, team, rank");if(Ue)throw Ue;const rt=(je||[]).map(pt=>{const _t=(Oe||[]).find(Vt=>Vt.user_id===pt.user_id);return{...pt,user:_t||{name:"  ",team:"-",rank:"-"}}});s(rt)}catch(xe){console.error("Error fetching worklogs:",xe)}finally{x(!1)}},U=()=>{Se(xe=>({...xe,weekly_tasks:[...xe.weekly_tasks,Un()]}))},le=xe=>{Se(je=>({...je,weekly_tasks:je.weekly_tasks.filter((de,Oe)=>Oe!==xe)}))},ne=(xe,je)=>{Se(de=>({...de,weekly_tasks:de.weekly_tasks.map((Oe,Ue)=>Ue===xe?{...Oe,title:je}:Oe)}))},ie=xe=>{Se(je=>({...je,weekly_tasks:je.weekly_tasks.map((de,Oe)=>Oe===xe?{...de,details:[...de.details,Tv()]}:de)}))},H=(xe,je)=>{Se(de=>({...de,weekly_tasks:de.weekly_tasks.map((Oe,Ue)=>Ue===xe?{...Oe,details:Oe.details.filter((rt,pt)=>pt!==je)}:Oe)}))},K=(xe,je,de,Oe)=>{Se(Ue=>({...Ue,weekly_tasks:Ue.weekly_tasks.map((rt,pt)=>pt===xe?{...rt,details:rt.details.map((_t,Vt)=>Vt===je?{..._t,[de]:Oe}:_t)}:rt)}))},S=xe=>{const de=Array.from(xe.target.files||[]).map(Oe=>({file:Oe,name:Oe.name,size:(Oe.size/1024).toFixed(0)+"KB"}));Se(Oe=>({...Oe,files:[...Oe.files,...de]}))},ue=xe=>{Se(je=>({...je,files:je.files.filter((de,Oe)=>Oe!==xe)}))},z=xe=>{Se(je=>({...je,existingFileUrls:je.existingFileUrls.filter((de,Oe)=>Oe!==xe)}))},T=async xe=>{const je=`/intranet/worklogs/weekly/${e.user_id}`;return(await rf(xe.map(Oe=>Oe.file),je)).map(Oe=>Oe.url)},A=async()=>{const xe=F0(ee.weekly_tasks);if(!xe){alert("    .");return}try{v(!0);let je=[];ee.files.length>0&&(je=await T(ee.files));const{error:de}=await Pe.from("work_logs").insert({work_date:ee.work_date,morning_work:xe,this_week_work:ee.this_week_work,special_notes:ee.special_notes,file_urls:je,user_id:e.user_id,type:"weekly",is_read:!1});if(de)throw de;u(!1),Te(),P(),alert("  .")}catch(je){console.error("Error creating worklog:",je),alert("   : "+je.message)}finally{v(!1)}},W=async()=>{const xe=F0(ee.weekly_tasks);if(!xe){alert("    .");return}if(!b?.id){alert("    .");return}const je=b.id;try{v(!0);let de=[];ee.files.length>0&&(de=await T(ee.files));const Oe=[...ee.existingFileUrls,...de],{error:Ue}=await Pe.from("work_logs").update({work_date:ee.work_date,morning_work:xe,this_week_work:ee.this_week_work,special_notes:ee.special_notes,file_urls:Oe}).eq("id",je);if(Ue)throw Ue;u(!1),Te(),P(),alert("  .")}catch(de){console.error("Error updating worklog:",de),alert("   : "+de.message)}finally{v(!1)}},pe=xe=>{const je=new Date(xe),de=je.getDay(),Oe=new Date(je),Ue=de===0?-6:1-de;Oe.setDate(je.getDate()+Ue);const rt=new Date(Oe);return rt.setDate(Oe.getDate()+4),{start:Oe.toISOString().split("T")[0],end:rt.toISOString().split("T")[0]}},_e=xe=>{if(!xe)return"";let je=xe.replace(/\n---TASK---\n/g,`
`);return je=je.replace(/\s*\(\d+%\)/g,""),je.trim()},oe=async()=>{if(e?.user_id){V(!0);try{const{start:xe,end:je}=pe(ee.work_date),{data:de,error:Oe}=await Pe.from("work_logs").select("work_date, morning_work, afternoon_work").eq("user_id",e.user_id).eq("type","daily").gte("work_date",xe).lte("work_date",je).order("work_date",{ascending:!0});if(Oe)throw Oe;if(!de||de.length===0){alert("     .");return}const Ue=["","","","","","",""],rt=[];if(de.forEach(pt=>{const _t=new Date(pt.work_date),Vt=Ue[_t.getDay()],yr=`${_t.getMonth()+1}/${_t.getDate()}`,_r=_e(pt.morning_work),zt=_e(pt.afternoon_work);if(_r||zt){const fr=[];_r&&_r.split(`
`).forEach(kr=>{kr.trim()&&fr.push(kr.trim())}),zt&&zt.split(`
`).forEach(kr=>{kr.trim()&&fr.push(kr.trim())}),fr.length>0&&rt.push({title:`${Vt}(${yr})`,details:fr.map(kr=>({content:kr,progress:"",remark:""}))})}}),rt.length===0){alert("      .");return}te(rt),ae(!0)}catch(xe){console.error("Error fetching daily worklogs:",xe),alert("   .")}finally{V(!1)}}},Te=()=>{Se({work_date:ve(),weekly_tasks:[Un()],this_week_work:"",special_notes:"",files:[],existingFileUrls:[]}),h(!1),g(null)},Me=xe=>{Se({work_date:xe.work_date,weekly_tasks:hi(xe.morning_work||""),this_week_work:xe.this_week_work||"",special_notes:xe.special_notes||"",files:[],existingFileUrls:xe.file_urls||[]}),g(xe),h(!0),u(!0)},Ae=()=>{Te(),u(!0)},Re=async xe=>{if(confirm(" ?"))try{xe.file_urls&&xe.file_urls.length>0&&await sm(xe.file_urls);const{error:je}=await Pe.from("work_logs").delete().eq("id",xe.id);if(je)throw je;P(),alert(".")}catch(je){console.error("Error deleting worklog:",je),alert(" .")}},et=async xe=>{g(xe),t&&!xe.is_read&&(await Pe.from("work_logs").update({is_read:!0}).eq("id",xe.id),P())},He=xe=>{const je=new Date(xe),de=new Date(je.getFullYear(),je.getMonth(),1),Oe=Math.ceil((je.getDate()+de.getDay())/7);return`${je.getMonth()+1} ${Oe}`},at=xe=>new Date(xe).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}),De=async xe=>{const je={top:{style:nr.SINGLE,size:1,color:"333333"},bottom:{style:nr.SINGLE,size:1,color:"333333"},left:{style:nr.SINGLE,size:1,color:"333333"},right:{style:nr.SINGLE,size:1,color:"333333"}},de={shading:{fill:"F8F9FA"},borders:je,verticalAlign:"center"},Oe=zt=>zt?zt.split(`
`).map(fr=>new ot({children:[new Tt({text:fr||" ",size:24})],spacing:{line:360}})):[new ot({text:""})],Ue=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:24})],alignment:Dt.CENTER})],width:{size:15,type:Bt.PERCENTAGE},...de}),new gt({children:[new ot({children:[new Tt({text:He(xe.work_date),size:24})]})],width:{size:35,type:Bt.PERCENTAGE},borders:je}),new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:24})],alignment:Dt.CENTER})],width:{size:15,type:Bt.PERCENTAGE},...de}),new gt({children:[new ot({children:[new Tt({text:xe.user?.team||"-",size:24})]})],width:{size:35,type:Bt.PERCENTAGE},borders:je})]}),new pr({children:[new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:24})],alignment:Dt.CENTER})],...de}),new gt({children:[new ot({children:[new Tt({text:xe.user?.rank||"-",size:24})]})],borders:je}),new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:24})],alignment:Dt.CENTER})],...de}),new gt({children:[new ot({children:[new Tt({text:xe.user?.name||"-",size:24})]})],borders:je})]})]}),rt=hi(xe.morning_work),pt=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Tt({text:".    ",bold:!0,size:24})]})],columnSpan:4,...de})]}),new pr({children:[new gt({children:[new ot({children:[new Tt({text:"No",bold:!0,size:22})],alignment:Dt.CENTER})],width:{size:7,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:je}),new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:22})],alignment:Dt.CENTER})],width:{size:58,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:je}),new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:22})],alignment:Dt.CENTER})],width:{size:12,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:je}),new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:22})],alignment:Dt.CENTER})],width:{size:23,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:je})]}),...rt.flatMap((zt,fr)=>{const kr=(zt.title?1:0)+zt.details.length,Jr={top:{style:nr.SINGLE,size:1,color:"CCCCCC"},bottom:{style:nr.SINGLE,size:1,color:"CCCCCC"},left:{style:nr.SINGLE,size:1,color:"333333"},right:{style:nr.SINGLE,size:1,color:"333333"}},he=[];return zt.title&&he.push(new pr({children:[new gt({children:[new ot({children:[new Tt({text:String(fr+1),size:22})],alignment:Dt.CENTER})],borders:je,verticalAlign:"top",rowSpan:kr}),new gt({children:[new ot({children:[new Tt({text:`[${zt.title}]`,bold:!0,size:22})]})],borders:Jr,margins:{top:100,bottom:100,left:100,right:100}}),new gt({children:[new ot({text:""})],borders:Jr}),new gt({children:[new ot({text:""})],borders:Jr})]})),zt.details.forEach((we,ye)=>{const be=[];we.content.split(`
`).forEach(We=>{We.trim()&&be.push(new ot({children:[new Tt({text:`- ${We}`,size:22})]}))});const Ee=ye===zt.details.length-1?je:Jr;he.push(new pr({children:[...!zt.title&&ye===0?[new gt({children:[new ot({children:[new Tt({text:String(fr+1),size:22})],alignment:Dt.CENTER})],borders:je,verticalAlign:"top",rowSpan:kr})]:[],new gt({children:be,borders:Ee,margins:{top:100,bottom:100,left:100,right:100}}),new gt({children:[new ot({children:[new Tt({text:we.progress?we.progress+"%":"-",size:22})],alignment:Dt.CENTER})],borders:Ee,verticalAlign:"top"}),new gt({children:[new ot({children:[new Tt({text:we.remark||"-",size:22})]})],borders:Ee,margins:{left:100,right:100},verticalAlign:"top"})]}))}),he})]}),_t=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Tt({text:".  ",bold:!0,size:24})]})],...de})]}),new pr({children:[new gt({children:Oe(xe.this_week_work||" "),borders:je,margins:{top:Sr(.15),bottom:Sr(.15),left:Sr(.15),right:Sr(.15)}})]})]}),Vt=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Tt({text:".   ",bold:!0,size:24})]})],...de})]}),new pr({children:[new gt({children:Oe(xe.special_notes||" "),borders:je,margins:{top:Sr(.15),bottom:Sr(.15),left:Sr(.15),right:Sr(.15)}})]})]}),yr=new fm({sections:[{properties:{page:{margin:{top:Sr(.6),bottom:Sr(.8),left:Sr(.8),right:Sr(.8)}}},children:[new ot({children:[new Tt({text:`: ${at(xe.work_date)}`,size:22,color:"666666"})],alignment:Dt.RIGHT,spacing:{after:200}}),new ot({children:[new Tt({text:"      ",bold:!0,size:44})],alignment:Dt.CENTER,spacing:{after:200},border:{bottom:{style:nr.SINGLE,size:12,color:"333333"}}}),new ot({text:"",spacing:{after:300}}),Ue,new ot({text:"",spacing:{after:300}}),pt,new ot({text:"",spacing:{after:300}}),_t,new ot({text:"",spacing:{after:300}}),Vt,new ot({text:"",spacing:{after:400}}),new ot({children:[new Tt({text:"",bold:!0,size:26})],alignment:Dt.CENTER})]}]}),_r=await hm.toBlob(yr);mm.saveAs(_r,`_${He(xe.work_date)}_${xe.user?.name||""}.docx`)},mt=xe=>{gU(xe,He)},At=L*B,wt=At-B,Ct=a.slice(wt,At),It=Math.ceil(a.length/B),Le=xe=>{O(xe)},tt=xe=>{fe(je=>{const de=new Set(je);return de.has(xe)?de.delete(xe):de.add(xe),de})},ct=()=>{Ct.length>0&&Ct.every(xe=>q.has(xe.id))?fe(xe=>{const je=new Set(xe);return Ct.forEach(de=>je.delete(de.id)),je}):fe(xe=>{const je=new Set(xe);return Ct.forEach(de=>je.add(de.id)),je})},se=()=>{const xe=q.size>0?a.filter(Ue=>q.has(Ue.id)):a,je=q.size>0?`  (${xe.length})`:` (${xe.length})`,de=Ue=>Ue.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>"),Oe=`
            <div class="section-title">  - ${je}</div>
            ${xe.map((Ue,rt)=>{const pt=hi(Ue.morning_work);return`
                    <div style="margin-bottom: 24px; page-break-inside: avoid;">
                        <div style="font-weight: bold; font-size: 13px; margin-bottom: 6px; color: #333;">
                            ${rt+1}. ${He(Ue.work_date)} - ${Ue.user?.name||"-"} (${Ue.user?.team||"-"})
                        </div>
                        <table>
                            <colgroup><col style="width:5%"/><col style="width:58%"/><col style="width:10%"/><col style="width:27%"/></colgroup>
                            <thead><tr><th>No</th><th></th><th></th><th></th></tr></thead>
                            <tbody>
                                ${pt.map((_t,Vt)=>{const yr=(_t.title?1:0)+_t.details.length,_r=[];return _t.title&&_r.push(`<tr>
                                            <td style="text-align:center;vertical-align:top" rowspan="${yr}">${Vt+1}</td>
                                            <td style="text-align:left;font-weight:bold;border-bottom:1px solid #ccc">[${de(_t.title)}]</td>
                                            <td style="border-bottom:1px solid #ccc"></td>
                                            <td style="border-bottom:1px solid #ccc"></td>
                                        </tr>`),_t.details.forEach((zt,fr)=>{const kr=(zt.content||"-").split(`
`).map(ye=>ye.trim()?`- ${de(ye)}`:"").filter(Boolean).join("<br/>"),he=fr===_t.details.length-1?"":"border-bottom:1px solid #ccc",we=!_t.title&&fr===0?`<td style="text-align:center;vertical-align:top" rowspan="${yr}">${Vt+1}</td>`:"";_r.push(`<tr>
                                            ${we}
                                            <td style="text-align:left;white-space:pre-line;${he}">${kr}</td>
                                            <td style="text-align:center;vertical-align:top;${he}">${zt.progress?zt.progress+"%":"-"}</td>
                                            <td style="text-align:left;vertical-align:top;${he}">${de(zt.remark||"")||"-"}</td>
                                        </tr>`)}),_r.join("")}).join("")}
                            </tbody>
                        </table>
                    </div>
                `}).join("")}
        `;ul({title:" ",content:Oe})},Ne=xe=>{const je=hi(xe);return n.jsx("div",{className:"bg-toss-gray-50 rounded-xl overflow-hidden",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-toss-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-center font-semibold text-toss-gray-700 whitespace-nowrap w-10",children:"No"}),n.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700",children:""}),n.jsx("th",{className:"px-3 py-2 text-center font-semibold text-toss-gray-700 whitespace-nowrap w-16",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:je.map((de,Oe)=>de.details.map((Ue,rt)=>n.jsxs("tr",{children:[rt===0&&n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-2 text-center text-toss-gray-500",rowSpan:de.details.length,children:Oe+1}),n.jsx("td",{className:"px-3 py-2 text-toss-gray-900 font-medium whitespace-nowrap",rowSpan:de.details.length,children:de.title||"-"})]}),n.jsx("td",{className:"px-3 py-2 text-toss-gray-900 whitespace-pre-wrap",children:Ue.content}),n.jsx("td",{className:"px-3 py-2 text-center",children:Ue.progress?n.jsxs("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium ${Number(Ue.progress)>=100?"bg-green-100 text-green-700":Number(Ue.progress)>=50?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:[Ue.progress,"%"]}):"-"}),n.jsx("td",{className:"px-3 py-2 text-toss-gray-600",children:Ue.remark||"-"})]},`${Oe}-${rt}`)))})]})})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{className:"bg-gradient-to-r from-green-500 to-green-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(Gs,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:t?"  ":`${e?.name||""}  `}),n.jsx("p",{className:"text-white/90",children:t?"        ":`${e?.team?`${e.team}  `:""}${e?.rank||" "}`})]})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),n.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[n.jsx("select",{value:_,onChange:xe=>w(Number(xe.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:Y.map(xe=>n.jsxs("option",{value:xe,children:[xe,""]},xe))}),n.jsx("select",{value:k,onChange:xe=>N(Number(xe.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:G.map(xe=>n.jsxs("option",{value:xe,children:[xe,""]},xe))}),t&&ce.length>0&&n.jsxs("select",{value:E,onChange:xe=>C(xe.target.value),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:[n.jsx("option",{value:"all",children:" "}),ce.map(xe=>n.jsx("option",{value:xe.user_id,children:xe.name},xe.user_id))]}),n.jsxs(Ye,{variant:"secondary",onClick:se,children:[n.jsx(na,{size:18})," ",q.size>0&&`(${q.size})`]}),n.jsxs(Ye,{onClick:Ae,className:"bg-green-500 hover:bg-green-600",children:[n.jsx(ps,{size:18}),"  "]})]})]}),n.jsx(Et,{padding:"p-0 sm:p-6",children:m?n.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:" ..."}):Ct.length>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full min-w-[700px]",children:[n.jsx("thead",{className:"bg-toss-gray-100 border-b-2 border-toss-gray-300",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 w-10",children:n.jsx("input",{type:"checkbox",checked:Ct.length>0&&Ct.every(xe=>q.has(xe.id)),onChange:ct,className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),t&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700",children:" "}),n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:Ct.map((xe,je)=>n.jsxs("tr",{className:`hover:bg-toss-gray-50 transition-colors ${t&&!xe.is_read?"bg-green-50":""}`,children:[n.jsx("td",{className:"px-3 py-3 text-center w-10",onClick:de=>de.stopPropagation(),children:n.jsx("input",{type:"checkbox",checked:q.has(xe.id),onChange:()=>tt(xe.id),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("td",{className:"px-3 py-3 text-sm text-center text-toss-gray-600 whitespace-nowrap",children:wt+je+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 cursor-pointer hover:text-green-600 whitespace-nowrap",onClick:()=>et(xe),children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ha,{size:14,className:"text-toss-gray-400 flex-shrink-0"}),n.jsx("span",{children:He(xe.work_date)}),t&&!xe.is_read&&n.jsx("span",{className:"inline-block bg-green-500 text-white px-1.5 py-0.5 rounded-full text-xs font-medium flex-shrink-0",children:"N"})]})}),t&&n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 whitespace-nowrap",children:xe.user?.name||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-600 whitespace-nowrap",children:xe.user?.team||"-"})]}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 cursor-pointer max-w-xs truncate",onClick:()=>et(xe),children:L0(xe.morning_work)}),n.jsx("td",{className:"px-3 py-3 text-center whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:de=>{de.stopPropagation(),mt(xe)},className:"p-2 text-green-600 hover:bg-green-100 rounded-lg transition-colors",title:"",children:n.jsx(na,{size:16})}),n.jsx("button",{onClick:de=>{de.stopPropagation(),De(xe)},className:"p-2 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"Word ",children:n.jsx(ts,{size:16})}),(e?.user_id===xe.user_id||t)&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>Me(xe),className:"p-2 text-green-500 hover:bg-green-100 rounded-lg transition-colors",title:"",children:n.jsx(js,{size:16})}),n.jsx("button",{onClick:()=>Re(xe),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(Jt,{size:16})})]})]})})]},xe.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:Ct.map((xe,je)=>n.jsxs("div",{className:`p-4 ${t&&!xe.is_read?"bg-green-50":""}`,onClick:()=>et(xe),children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",checked:q.has(xe.id),onChange:()=>tt(xe.id),onClick:de=>de.stopPropagation(),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["#",wt+je+1]}),n.jsx(ha,{size:14,className:"text-toss-gray-400"}),n.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:He(xe.work_date)}),t&&!xe.is_read&&n.jsx("span",{className:"bg-green-500 text-white px-2 py-0.5 rounded-full text-xs font-medium",children:"NEW"})]}),n.jsxs("div",{className:"flex items-center gap-1",onClick:de=>de.stopPropagation(),children:[n.jsx("button",{onClick:()=>De(xe),className:"p-1.5 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg",children:n.jsx(ts,{size:14})}),(e?.user_id===xe.user_id||t)&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>Me(xe),className:"p-1.5 text-green-500 hover:bg-green-100 rounded-lg",children:n.jsx(js,{size:14})}),n.jsx("button",{onClick:()=>Re(xe),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:n.jsx(Jt,{size:14})})]})]})]}),t&&n.jsxs("div",{className:"text-xs text-toss-gray-600 mb-2",children:[n.jsx("span",{className:"font-medium",children:xe.user?.name||"-"}),n.jsx("span",{className:"mx-1",children:""}),n.jsx("span",{children:xe.user?.team||"-"})]}),n.jsx("p",{className:"text-sm text-toss-gray-700 line-clamp-2",children:L0(xe.morning_work)})]},xe.id))}),It>1&&n.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-toss-gray-200",children:[n.jsx("button",{onClick:()=>Le(L-1),disabled:L===1,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),[...Array(It)].map((xe,je)=>n.jsx("button",{onClick:()=>Le(je+1),className:`px-3 py-1 rounded-lg text-sm font-medium ${L===je+1?"bg-green-500 text-white":"text-toss-gray-700 hover:bg-toss-gray-100"}`,children:je+1},je+1)),n.jsx("button",{onClick:()=>Le(L+1),disabled:L===It,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]}):n.jsxs("div",{className:"text-center text-toss-gray-500 py-8",children:[_," ",k,"    "]})}),n.jsx(dr,{isOpen:l,onClose:()=>{u(!1),Te(),ae(!1),te([])},title:d?"  ":"   ",size:I?"xl":"default",children:n.jsxs("div",{className:"flex gap-6 ",children:[n.jsxs("div",{className:`space-y-6 max-h-[70vh] overflow-y-auto pr-2 ${I?"flex-1 min-w-0":"w-full"}`,children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),n.jsx("input",{type:"date",value:ee.work_date,onChange:xe=>Se({...ee,work_date:xe.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"}),n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:He(ee.work_date)})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700",children:"  *"}),n.jsxs("button",{type:"button",onClick:oe,disabled:D,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors disabled:opacity-50",children:[n.jsx(Oc,{size:14,className:D?"animate-spin":""}),D?" ...":"  "]})]}),n.jsxs("div",{className:"space-y-3",children:[ee.weekly_tasks.map((xe,je)=>n.jsxs("div",{className:"bg-toss-gray-50 rounded-xl p-3 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"text",value:xe.title,onChange:de=>ne(je,de.target.value),className:"flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm font-medium focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:""}),ee.weekly_tasks.length>1&&n.jsx("button",{type:"button",onClick:()=>le(je),className:"p-1.5 text-red-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors flex-shrink-0 w-[28px] flex items-center justify-center",title:" ",children:n.jsx(Jt,{size:14})}),ee.weekly_tasks.length<=1&&n.jsx("div",{className:"w-[28px] flex-shrink-0"})]}),n.jsxs("div",{className:"hidden sm:grid sm:grid-cols-[1fr_50px_100px_28px] gap-2 px-1",children:[n.jsx("span",{className:"text-xs font-medium text-toss-gray-500",children:""}),n.jsx("span",{className:"text-xs font-medium text-toss-gray-500 text-center",children:""}),n.jsx("span",{className:"text-xs font-medium text-toss-gray-500",children:""}),n.jsx("span",{})]}),xe.details.map((de,Oe)=>n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_50px_100px_28px] gap-2 items-stretch",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:""}),n.jsx("textarea",{value:de.content,onChange:Ue=>K(je,Oe,"content",Ue.target.value),rows:2,className:"w-full flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all resize-none leading-relaxed",placeholder:"  "})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:"(%)"}),n.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:de.progress,onChange:Ue=>{const rt=Ue.target.value.replace(/[^0-9]/g,"");(rt===""||parseInt(rt)>=0&&parseInt(rt)<=100)&&K(je,Oe,"progress",rt)},className:"w-full flex-1 px-2 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm text-center focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"%"})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:""}),n.jsx("input",{type:"text",value:de.remark,onChange:Ue=>K(je,Oe,"remark",Ue.target.value),className:"w-full flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:""})]}),n.jsx("div",{className:"flex items-center justify-center",children:xe.details.length>1&&n.jsx("button",{type:"button",onClick:()=>H(je,Oe),className:"p-1 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:" ",children:n.jsx(mr,{size:14})})})]},Oe)),n.jsxs("button",{type:"button",onClick:()=>ie(je),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[n.jsx(ps,{size:14})," "]})]},je)),n.jsxs("button",{type:"button",onClick:U,className:"flex items-center gap-2 px-4 py-2 text-green-600 hover:bg-green-50 rounded-xl transition-colors text-sm font-medium",children:[n.jsx(C0,{size:16})," "]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:ee.this_week_work,onChange:xe=>Se({...ee,this_week_work:xe.target.value}),rows:5,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"   "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"()"}),n.jsx("textarea",{value:ee.special_notes,onChange:xe=>Se({...ee,special_notes:xe.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),d&&ee.existingFileUrls.length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("div",{className:"space-y-2",children:ee.existingFileUrls.map((xe,je)=>{const de=xe.split("/").pop();return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:de})]}),n.jsx("button",{onClick:()=>z(je),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(mr,{size:16})})]},je)})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"file",ref:F,multiple:!0,onChange:S,className:"hidden"}),n.jsx("button",{type:"button",onClick:()=>F.current?.click(),className:"w-full p-6 border-2 border-dashed border-toss-gray-300 rounded-2xl hover:border-green-500 hover:bg-green-50/50 transition-all",children:n.jsxs("div",{className:"flex flex-col items-center gap-2 text-toss-gray-600",children:[n.jsx(ji,{size:28}),n.jsx("span",{className:"font-medium",children:" "}),n.jsx("span",{className:"text-xs text-toss-gray-500",children:"   "})]})}),ee.files.length>0&&n.jsx("div",{className:"mt-4 space-y-2",children:ee.files.map((xe,je)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:xe.name}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["(",xe.size,")"]})]}),n.jsx("button",{onClick:()=>ue(je),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(mr,{size:16})})]},je))})]}),n.jsxs("div",{className:"flex gap-3 pt-4 sticky bottom-0 bg-white",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{u(!1),Te()},className:"flex-1",children:""}),n.jsx(Ye,{onClick:d?W:A,className:"flex-1 bg-green-500 hover:bg-green-600",loading:y,disabled:y,children:y?" ...":d?"":""})]})]}),I&&n.jsxs("div",{className:"flex-1 min-w-0 flex flex-col max-h-[70vh]",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-green-50 border border-green-200 rounded-t-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ha,{size:16,className:"text-green-600"}),n.jsx("span",{className:"text-sm font-semibold text-green-800",children:"  "})]}),n.jsx("button",{type:"button",onClick:()=>{ae(!1),te([])},className:"p-1.5 text-green-600 hover:bg-green-100 rounded-lg transition-colors",children:n.jsx(mr,{size:16})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto border-x border-green-200 bg-white px-4 py-3",children:Q.length>0?n.jsx("div",{className:"space-y-3",children:Q.map((xe,je)=>n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-3",children:[n.jsxs("div",{className:"text-sm font-semibold text-green-800 mb-1",children:["[",xe.title,"]"]}),xe.details.map((de,Oe)=>n.jsxs("div",{className:"text-sm text-toss-gray-700 ml-2 mb-0.5",children:["- ",de.content||"-"]},Oe))]},je))}):n.jsx("div",{className:"flex items-center justify-center h-full text-toss-gray-400 text-sm",children:" ..."})}),Q.length>0&&n.jsx("div",{className:"border-x border-b border-green-200 rounded-b-xl bg-green-50/30 px-4 py-2",children:n.jsxs("button",{type:"button",onClick:()=>{const xe=Q.map(je=>{const de=[`[${je.title}]`];return je.details.forEach(Oe=>{de.push(`- ${Oe.content||"-"}`)}),de.join(`
`)}).join(`

`);navigator.clipboard.writeText(xe).then(()=>{alert(" .")})},className:"w-full flex items-center justify-center gap-2 py-2 text-sm font-medium text-green-700 hover:bg-green-100 rounded-lg transition-colors",children:[n.jsx(em,{size:15}),""]})})]})]})}),n.jsx(dr,{isOpen:!!b&&!l,onClose:()=>g(null),title:"  ",children:b&&n.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto -mx-2 px-2",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900",children:He(b.work_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 font-medium",children:b.user?`${b.user.name}  ${b.user.team||" "}`:"-"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),Ne(b.morning_work)]}),b.this_week_work&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 whitespace-pre-wrap text-toss-gray-900",children:b.this_week_work})]}),b.special_notes&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:"()"}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 whitespace-pre-wrap text-toss-gray-900",children:b.special_notes})]}),b.file_urls&&b.file_urls.length>0&&n.jsx(SU,{urls:b.file_urls}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[n.jsxs("button",{onClick:()=>mt(b),className:"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-600 rounded-xl hover:bg-green-100 transition-colors text-sm font-medium",children:[n.jsx(na,{size:16}),""]}),n.jsxs("button",{onClick:()=>De(b),className:"flex items-center gap-2 px-4 py-2 bg-toss-gray-100 text-toss-gray-700 rounded-xl hover:bg-toss-gray-200 transition-colors text-sm font-medium",children:[n.jsx(ts,{size:16}),"Word "]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>g(null),className:"flex-1",children:""}),n.jsx(Ye,{onClick:()=>Me(b),className:"flex-1 bg-green-500 hover:bg-green-600",children:""})]})]})})]})},EU=e=>e?e.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0","").replace("?dl=1","").replace("&dl=1",""):"",w0=e=>{let t="";return typeof e=="string"?t=e:e&&e.url&&(t=e.url),EU(t)},bk=e=>{const t=w0(e);if(!t)return!1;const r=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],s=t.toLowerCase();return r.some(a=>s.includes(a))},jU=({urls:e})=>{const t=X.useRef(null),[r,s]=X.useState(!1),[a,o]=X.useState(!1),[l,u]=X.useState(null),[d,h]=X.useState(!1),[m,x]=X.useState(0),[y,v]=X.useState(0),b=e.filter(bk),g=e.filter(D=>!bk(D)),_=()=>{if(t.current){const{scrollLeft:D,scrollWidth:V,clientWidth:I}=t.current;s(D>0),o(D<V-I-10)}};X.useEffect(()=>(_(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)),[e]),X.useEffect(()=>{const D=V=>{l!==null&&(V.key==="ArrowLeft"&&E(),V.key==="ArrowRight"&&C(),V.key==="Escape"&&N())};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[l,b.length]);const w=D=>{t.current&&(t.current.scrollBy({left:D==="left"?-200:200,behavior:"smooth"}),setTimeout(_,300))},k=D=>{u(D),v(0)},N=()=>{u(null),v(0)},E=()=>{v(0),u(D=>D!==null&&D>0?D-1:b.length-1)},C=()=>{v(0),u(D=>D!==null&&D<b.length-1?D+1:0)},L=D=>{b.length<=1||(h(!0),x(D.clientX))},O=D=>{b.length<=1||(h(!0),x(D.touches[0].clientX))},B=D=>{if(!d)return;const V=D-m;v(V)},F=D=>{B(D.clientX)},q=D=>{B(D.touches[0].clientX)},fe=()=>{if(!d)return;h(!1);const D=100;y>D?E():y<-D?C():v(0)};return b.length===0&&g.length===0?null:n.jsxs("div",{className:"space-y-3",children:[b.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:[" (",b.length,")"]}),n.jsxs("div",{className:"relative",children:[r&&n.jsx("button",{onClick:()=>w("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx($a,{size:20})}),n.jsx("div",{ref:t,onScroll:_,className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:b.map((D,V)=>{const I=w0(D);return n.jsx("div",{className:"flex-shrink-0 cursor-pointer w-24 h-24 sm:w-32 sm:h-32 rounded-xl overflow-hidden bg-toss-gray-100",onClick:()=>k(V),children:n.jsx("img",{src:I,alt:`  ${V+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:ae=>{ae.target.style.display="none"}})},V)})}),a&&n.jsx("button",{onClick:()=>w("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx(pa,{size:20})})]})]}),g.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:["  (",g.length,")"]}),n.jsx("div",{className:"space-y-2",children:g.map((D,V)=>{const I=w0(D),ae=typeof D=="string"?I.split("/").pop():D.name||I.split("/").pop();return n.jsxs("a",{href:I,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-blue hover:underline flex-1 truncate",children:ae}),n.jsx(ts,{size:16,className:"text-toss-gray-500"})]},V)})})]}),l!==null&&n.jsxs("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center select-none",style:{zIndex:9999},onClick:N,onMouseUp:fe,onMouseLeave:fe,onTouchEnd:fe,children:[n.jsx("button",{className:"absolute top-4 right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors",onClick:N,children:n.jsx(mr,{size:24})}),n.jsxs("div",{className:"absolute top-4 left-4 z-10 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm font-medium",children:[l+1," / ",b.length]}),n.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[b.length>1&&n.jsx("button",{onClick:D=>{D.stopPropagation(),E()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:n.jsx($a,{size:36,strokeWidth:3})}),n.jsx("div",{onClick:D=>D.stopPropagation(),onMouseDown:L,onMouseMove:F,onTouchStart:O,onTouchMove:q,className:"max-w-[70vw] sm:max-w-[80vw] max-h-[90vh] relative cursor-grab active:cursor-grabbing",style:{transform:`translateX(${y}px)`,transition:d?"none":"transform 0.3s ease-out"},children:n.jsx("img",{src:w0(b[l]),alt:`  ${l+1}`,className:"max-w-full max-h-[90vh] object-contain rounded-lg pointer-events-none",draggable:!1})}),b.length>1&&n.jsx("button",{onClick:D=>{D.stopPropagation(),C()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:n.jsx(pa,{size:36,strokeWidth:3})})]}),b.length>1&&n.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2",children:b.map((D,V)=>n.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${V===l?"bg-white":"bg-white/30"}`},V))})]})]})},TU=()=>{const{profile:e,isAdmin:t}=Kr(),[r,s]=X.useState([]),[a,o]=X.useState([]),[l,u]=X.useState(!1),[d,h]=X.useState(!1),[m,x]=X.useState(!0),[y,v]=X.useState(!1),[b,g]=X.useState(null),[_,w]=X.useState(new Date().getFullYear()),[k,N]=X.useState("all"),[E,C]=X.useState(1),L=15,O=X.useRef(null),[B,F]=X.useState(new Set),[q,fe]=X.useState(!1),[D,V]=X.useState(!1),[I,ae]=X.useState([]),[Q,te]=X.useState({work_date:new Date().toISOString().split("T")[0],monthly_tasks:[Un()],special_notes:"",files:[],existingFileUrls:[]}),ve=2026,ee=new Date().getFullYear(),Se=Array.from({length:ee-ve+1},(Le,tt)=>ve+tt);X.useEffect(()=>{Y()},[]),X.useEffect(()=>{J()},[r,_,k]);const J=()=>{const Le=r.filter(tt=>{const se=new Date(tt.work_date).getFullYear()===_,Ne=k==="all"||tt.user_id===k;return se&&Ne});o(Le),C(1)},M=Array.from(new Set(r.map(Le=>Le.user_id))).map(Le=>{const tt=r.find(ct=>ct.user_id===Le);return{user_id:Le,name:tt?.user?.name||"  "}}).sort((Le,tt)=>Le.name.localeCompare(tt.name)),Y=async()=>{try{let Le=Pe.from("work_logs").select("*").eq("type","monthly").order("work_date",{ascending:!1});!t&&e&&(Le=Le.eq("user_id",e.user_id));const{data:tt,error:ct}=await Le;if(ct)throw ct;const{data:se,error:Ne}=await Pe.from("users").select("user_id, name, team, rank");if(Ne)throw Ne;const xe=(tt||[]).map(je=>{const de=(se||[]).find(Oe=>Oe.user_id===je.user_id);return{...je,user:de||{name:"  ",team:"-",rank:"-"}}});s(xe)}catch(Le){console.error("Error fetching worklogs:",Le)}finally{x(!1)}},G=()=>{te(Le=>({...Le,monthly_tasks:[...Le.monthly_tasks,Un()]}))},re=Le=>{te(tt=>({...tt,monthly_tasks:tt.monthly_tasks.filter((ct,se)=>se!==Le)}))},ce=(Le,tt)=>{te(ct=>({...ct,monthly_tasks:ct.monthly_tasks.map((se,Ne)=>Ne===Le?{...se,title:tt}:se)}))},P=Le=>{te(tt=>({...tt,monthly_tasks:tt.monthly_tasks.map((ct,se)=>se===Le?{...ct,details:[...ct.details,Tv()]}:ct)}))},U=(Le,tt)=>{te(ct=>({...ct,monthly_tasks:ct.monthly_tasks.map((se,Ne)=>Ne===Le?{...se,details:se.details.filter((xe,je)=>je!==tt)}:se)}))},le=(Le,tt,ct,se)=>{te(Ne=>({...Ne,monthly_tasks:Ne.monthly_tasks.map((xe,je)=>je===Le?{...xe,details:xe.details.map((de,Oe)=>Oe===tt?{...de,[ct]:se}:de)}:xe)}))},ne=Le=>{const ct=Array.from(Le.target.files||[]).map(se=>({file:se,name:se.name,size:(se.size/1024).toFixed(0)+"KB"}));te(se=>({...se,files:[...se.files,...ct]}))},ie=Le=>{te(tt=>({...tt,files:tt.files.filter((ct,se)=>se!==Le)}))},H=Le=>{te(tt=>({...tt,existingFileUrls:tt.existingFileUrls.filter((ct,se)=>se!==Le)}))},K=async Le=>{const tt=`/intranet/worklogs/monthly/${e.user_id}`;return(await rf(Le.map(se=>se.file),tt)).map(se=>se.url)},S=async()=>{const Le=F0(Q.monthly_tasks);if(!Le){alert("    .");return}try{v(!0);let tt=[];Q.files.length>0&&(tt=await K(Q.files));const{error:ct}=await Pe.from("work_logs").insert({work_date:Q.work_date,morning_work:Le,special_notes:Q.special_notes,file_urls:tt,user_id:e.user_id,type:"monthly",is_read:!1});if(ct)throw ct;u(!1),A(),Y(),alert("  .")}catch(tt){console.error("Error creating worklog:",tt),alert("   : "+tt.message)}finally{v(!1)}},ue=async()=>{const Le=F0(Q.monthly_tasks);if(!Le){alert("    .");return}if(!b?.id){alert("    .");return}const tt=b.id;try{v(!0);let ct=[];Q.files.length>0&&(ct=await K(Q.files));const se=[...Q.existingFileUrls,...ct],{error:Ne}=await Pe.from("work_logs").update({work_date:Q.work_date,morning_work:Le,special_notes:Q.special_notes,file_urls:se}).eq("id",tt);if(Ne)throw Ne;u(!1),A(),Y(),alert("  .")}catch(ct){console.error("Error updating worklog:",ct),alert("   : "+ct.message)}finally{v(!1)}},z=Le=>{const tt=new Date(Le),ct=tt.getFullYear(),se=tt.getMonth(),Ne=new Date(ct,se,1).toISOString().split("T")[0],xe=new Date(ct,se+1,0).toISOString().split("T")[0];return{start:Ne,end:xe}},T=async()=>{if(e?.user_id){fe(!0);try{const{start:Le,end:tt}=z(Q.work_date),{data:ct,error:se}=await Pe.from("work_logs").select("work_date, morning_work").eq("user_id",e.user_id).eq("type","weekly").gte("work_date",Le).lte("work_date",tt).order("work_date",{ascending:!0});if(se)throw se;if(!ct||ct.length===0){alert("     .");return}const Ne=[];if(ct.forEach(xe=>{const je=new Date(xe.work_date),de=new Date(je.getFullYear(),je.getMonth(),1),Ue=`${Math.ceil((je.getDate()+de.getDay())/7)}`;hi(xe.morning_work).forEach(pt=>{Ne.push({title:pt.title?`[${Ue}] ${pt.title}`:`[${Ue}]`,details:pt.details})})}),Ne.length===0){alert("      .");return}ae(Ne),V(!0)}catch(Le){console.error("Error fetching weekly worklogs:",Le),alert("   .")}finally{fe(!1)}}},A=()=>{te({work_date:new Date().toISOString().split("T")[0],monthly_tasks:[Un()],special_notes:"",files:[],existingFileUrls:[]}),h(!1),g(null),V(!1),ae([])},W=Le=>{te({work_date:Le.work_date,monthly_tasks:hi(Le.morning_work||""),special_notes:Le.special_notes||"",files:[],existingFileUrls:Le.file_urls||[]}),g(Le),h(!0),u(!0)},pe=()=>{A(),u(!0)},_e=async Le=>{if(confirm(" ?"))try{Le.file_urls&&Le.file_urls.length>0&&await sm(Le.file_urls);const{error:tt}=await Pe.from("work_logs").delete().eq("id",Le.id);if(tt)throw tt;Y(),alert(".")}catch(tt){console.error("Error deleting worklog:",tt),alert(" .")}},oe=async Le=>{g(Le),t&&!Le.is_read&&(await Pe.from("work_logs").update({is_read:!0}).eq("id",Le.id),Y())},Te=Le=>{const tt=new Date(Le);return`${tt.getFullYear()} ${tt.getMonth()+1}`},Me=Le=>new Date(Le).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}),Ae=async Le=>{const tt={top:{style:nr.SINGLE,size:1,color:"333333"},bottom:{style:nr.SINGLE,size:1,color:"333333"},left:{style:nr.SINGLE,size:1,color:"333333"},right:{style:nr.SINGLE,size:1,color:"333333"}},ct={shading:{fill:"F8F9FA"},borders:tt,verticalAlign:"center"},se=rt=>rt.split(`
`).map(pt=>new ot({children:[new Tt({text:pt||" ",size:24})],spacing:{line:360}})),Ne=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:24})],alignment:Dt.CENTER})],width:{size:15,type:Bt.PERCENTAGE},...ct}),new gt({children:[new ot({children:[new Tt({text:Te(Le.work_date),size:24})]})],width:{size:35,type:Bt.PERCENTAGE},borders:tt}),new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:24})],alignment:Dt.CENTER})],width:{size:15,type:Bt.PERCENTAGE},...ct}),new gt({children:[new ot({children:[new Tt({text:Le.user?.team||"-",size:24})]})],width:{size:35,type:Bt.PERCENTAGE},borders:tt})]}),new pr({children:[new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:24})],alignment:Dt.CENTER})],...ct}),new gt({children:[new ot({children:[new Tt({text:Le.user?.rank||"-",size:24})]})],borders:tt}),new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:24})],alignment:Dt.CENTER})],...ct}),new gt({children:[new ot({children:[new Tt({text:Le.user?.name||"-",size:24})]})],borders:tt})]})]}),xe=hi(Le.morning_work),je=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Tt({text:".    ",bold:!0,size:24})]})],columnSpan:4,...ct})]}),new pr({children:[new gt({children:[new ot({children:[new Tt({text:"No",bold:!0,size:22})],alignment:Dt.CENTER})],width:{size:7,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:tt}),new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:22})],alignment:Dt.CENTER})],width:{size:58,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:tt}),new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:22})],alignment:Dt.CENTER})],width:{size:12,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:tt}),new gt({children:[new ot({children:[new Tt({text:"",bold:!0,size:22})],alignment:Dt.CENTER})],width:{size:23,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:tt})]}),...xe.flatMap((rt,pt)=>{const _t=(rt.title?1:0)+rt.details.length,Vt={top:{style:nr.SINGLE,size:1,color:"CCCCCC"},bottom:{style:nr.SINGLE,size:1,color:"CCCCCC"},left:{style:nr.SINGLE,size:1,color:"333333"},right:{style:nr.SINGLE,size:1,color:"333333"}},yr=[];return rt.title&&yr.push(new pr({children:[new gt({children:[new ot({children:[new Tt({text:String(pt+1),size:22})],alignment:Dt.CENTER})],borders:tt,verticalAlign:"top",rowSpan:_t}),new gt({children:[new ot({children:[new Tt({text:`[${rt.title}]`,bold:!0,size:22})]})],borders:Vt,margins:{top:100,bottom:100,left:100,right:100}}),new gt({children:[new ot({text:""})],borders:Vt}),new gt({children:[new ot({text:""})],borders:Vt})]})),rt.details.forEach((_r,zt)=>{const fr=[];_r.content.split(`
`).forEach(he=>{he.trim()&&fr.push(new ot({children:[new Tt({text:`- ${he}`,size:22})]}))});const Jr=zt===rt.details.length-1?tt:Vt;yr.push(new pr({children:[...!rt.title&&zt===0?[new gt({children:[new ot({children:[new Tt({text:String(pt+1),size:22})],alignment:Dt.CENTER})],borders:tt,verticalAlign:"top",rowSpan:_t})]:[],new gt({children:fr,borders:Jr,margins:{top:100,bottom:100,left:100,right:100}}),new gt({children:[new ot({children:[new Tt({text:_r.progress?_r.progress+"%":"-",size:22})],alignment:Dt.CENTER})],borders:Jr,verticalAlign:"top"}),new gt({children:[new ot({children:[new Tt({text:_r.remark||"-",size:22})]})],borders:Jr,margins:{left:100,right:100},verticalAlign:"top"})]}))}),yr})]}),de=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Tt({text:".   ",bold:!0,size:24})]})],...ct})]}),new pr({children:[new gt({children:se(Le.special_notes||" "),borders:tt,margins:{top:Sr(.15),bottom:Sr(.15),left:Sr(.15),right:Sr(.15)}})]})]}),Oe=new fm({sections:[{properties:{page:{margin:{top:Sr(.6),bottom:Sr(.8),left:Sr(.8),right:Sr(.8)}}},children:[new ot({children:[new Tt({text:`: ${Me(Le.work_date)}`,size:22,color:"666666"})],alignment:Dt.RIGHT,spacing:{after:200}}),new ot({children:[new Tt({text:"      ",bold:!0,size:44})],alignment:Dt.CENTER,spacing:{after:200},border:{bottom:{style:nr.SINGLE,size:12,color:"333333"}}}),new ot({text:"",spacing:{after:300}}),Ne,new ot({text:"",spacing:{after:300}}),je,new ot({text:"",spacing:{after:300}}),de,new ot({text:"",spacing:{after:400}}),new ot({children:[new Tt({text:"",bold:!0,size:26})],alignment:Dt.CENTER})]}]}),Ue=await hm.toBlob(Oe);mm.saveAs(Ue,`_${Te(Le.work_date)}_${Le.user?.name||""}.docx`)},Re=Le=>{yU(Le,Te)},et=E*L,He=et-L,at=a.slice(He,et),De=Math.ceil(a.length/L),mt=Le=>{C(Le)},At=Le=>{F(tt=>{const ct=new Set(tt);return ct.has(Le)?ct.delete(Le):ct.add(Le),ct})},wt=()=>{at.length>0&&at.every(Le=>B.has(Le.id))?F(Le=>{const tt=new Set(Le);return at.forEach(ct=>tt.delete(ct.id)),tt}):F(Le=>{const tt=new Set(Le);return at.forEach(ct=>tt.add(ct.id)),tt})},Ct=()=>{const Le=B.size>0?a.filter(Ne=>B.has(Ne.id)):a,tt=B.size>0?`  (${Le.length})`:` (${Le.length})`,ct=Ne=>Ne.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>"),se=`
            <div class="section-title">  - ${tt}</div>
            ${Le.map((Ne,xe)=>{const je=hi(Ne.morning_work);return`
                    <div style="margin-bottom: 24px; page-break-inside: avoid;">
                        <div style="font-weight: bold; font-size: 13px; margin-bottom: 6px; color: #333;">
                            ${xe+1}. ${Te(Ne.work_date)} - ${Ne.user?.name||"-"} (${Ne.user?.team||"-"})
                        </div>
                        <table>
                            <colgroup><col style="width:5%"/><col style="width:58%"/><col style="width:10%"/><col style="width:27%"/></colgroup>
                            <thead><tr><th>No</th><th></th><th></th><th></th></tr></thead>
                            <tbody>
                                ${je.map((de,Oe)=>{const Ue=(de.title?1:0)+de.details.length,rt=[];return de.title&&rt.push(`<tr>
                                            <td style="text-align:center;vertical-align:top" rowspan="${Ue}">${Oe+1}</td>
                                            <td style="text-align:left;font-weight:bold;border-bottom:1px solid #ccc">[${ct(de.title)}]</td>
                                            <td style="border-bottom:1px solid #ccc"></td>
                                            <td style="border-bottom:1px solid #ccc"></td>
                                        </tr>`),de.details.forEach((pt,_t)=>{const Vt=(pt.content||"-").split(`
`).map(fr=>fr.trim()?`- ${ct(fr)}`:"").filter(Boolean).join("<br/>"),_r=_t===de.details.length-1?"":"border-bottom:1px solid #ccc",zt=!de.title&&_t===0?`<td style="text-align:center;vertical-align:top" rowspan="${Ue}">${Oe+1}</td>`:"";rt.push(`<tr>
                                            ${zt}
                                            <td style="text-align:left;white-space:pre-line;${_r}">${Vt}</td>
                                            <td style="text-align:center;vertical-align:top;${_r}">${pt.progress?pt.progress+"%":"-"}</td>
                                            <td style="text-align:left;vertical-align:top;${_r}">${ct(pt.remark||"")||"-"}</td>
                                        </tr>`)}),rt.join("")}).join("")}
                            </tbody>
                        </table>
                    </div>
                `}).join("")}
        `;ul({title:" ",content:se})},It=Le=>{const tt=hi(Le);return n.jsx("div",{className:"bg-toss-gray-50 rounded-xl overflow-hidden",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-toss-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-center font-semibold text-toss-gray-700 whitespace-nowrap w-10",children:"No"}),n.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700",children:""}),n.jsx("th",{className:"px-3 py-2 text-center font-semibold text-toss-gray-700 whitespace-nowrap w-16",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:tt.map((ct,se)=>ct.details.map((Ne,xe)=>n.jsxs("tr",{children:[xe===0&&n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-2 text-center text-toss-gray-500",rowSpan:ct.details.length,children:se+1}),n.jsx("td",{className:"px-3 py-2 text-toss-gray-900 font-medium whitespace-nowrap",rowSpan:ct.details.length,children:ct.title||"-"})]}),n.jsx("td",{className:"px-3 py-2 text-toss-gray-900 whitespace-pre-wrap",children:Ne.content}),n.jsx("td",{className:"px-3 py-2 text-center",children:Ne.progress?n.jsxs("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium ${Number(Ne.progress)>=100?"bg-green-100 text-green-700":Number(Ne.progress)>=50?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:[Ne.progress,"%"]}):"-"}),n.jsx("td",{className:"px-3 py-2 text-toss-gray-600",children:Ne.remark||"-"})]},`${se}-${xe}`)))})]})})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(Gs,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:t?"  ":`${e?.name||""}  `}),n.jsx("p",{className:"text-white/90",children:t?"        ":`${e?.team?`${e.team}  `:""}${e?.rank||" "}`})]})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),n.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[n.jsx("select",{value:_,onChange:Le=>w(Number(Le.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:Se.map(Le=>n.jsxs("option",{value:Le,children:[Le,""]},Le))}),t&&M.length>0&&n.jsxs("select",{value:k,onChange:Le=>N(Le.target.value),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:[n.jsx("option",{value:"all",children:" "}),M.map(Le=>n.jsx("option",{value:Le.user_id,children:Le.name},Le.user_id))]}),n.jsxs(Ye,{variant:"secondary",onClick:Ct,children:[n.jsx(na,{size:18})," ",B.size>0&&`(${B.size})`]}),n.jsxs(Ye,{onClick:pe,className:"bg-purple-500 hover:bg-purple-600",children:[n.jsx(ps,{size:18}),"  "]})]})]}),n.jsx(Et,{padding:"p-0 sm:p-6",children:m?n.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:" ..."}):at.length>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full min-w-[700px]",children:[n.jsx("thead",{className:"bg-toss-gray-100 border-b-2 border-toss-gray-300",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 w-10",children:n.jsx("input",{type:"checkbox",checked:at.length>0&&at.every(Le=>B.has(Le.id)),onChange:wt,className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:" "}),t&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700",children:" "}),n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:at.map((Le,tt)=>n.jsxs("tr",{className:`hover:bg-toss-gray-50 transition-colors ${t&&!Le.is_read?"bg-purple-50":""}`,children:[n.jsx("td",{className:"px-3 py-3 text-center w-10",onClick:ct=>ct.stopPropagation(),children:n.jsx("input",{type:"checkbox",checked:B.has(Le.id),onChange:()=>At(Le.id),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("td",{className:"px-3 py-3 text-sm text-center text-toss-gray-600 whitespace-nowrap",children:He+tt+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 cursor-pointer hover:text-purple-600 whitespace-nowrap",onClick:()=>oe(Le),children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ha,{size:14,className:"text-toss-gray-400 flex-shrink-0"}),n.jsx("span",{children:Te(Le.work_date)}),t&&!Le.is_read&&n.jsx("span",{className:"inline-block bg-purple-500 text-white px-1.5 py-0.5 rounded-full text-xs font-medium flex-shrink-0",children:"N"})]})}),t&&n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 whitespace-nowrap",children:Le.user?.name||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-600 whitespace-nowrap",children:Le.user?.team||"-"})]}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 cursor-pointer max-w-xs truncate",onClick:()=>oe(Le),children:L0(Le.morning_work)}),n.jsx("td",{className:"px-3 py-3 text-center whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:ct=>{ct.stopPropagation(),Re(Le)},className:"p-2 text-purple-500 hover:bg-purple-100 rounded-lg transition-colors",title:"",children:n.jsx(na,{size:16})}),n.jsx("button",{onClick:ct=>{ct.stopPropagation(),Ae(Le)},className:"p-2 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"Word ",children:n.jsx(ts,{size:16})}),(e?.user_id===Le.user_id||t)&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>W(Le),className:"p-2 text-purple-500 hover:bg-purple-100 rounded-lg transition-colors",title:"",children:n.jsx(js,{size:16})}),n.jsx("button",{onClick:()=>_e(Le),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(Jt,{size:16})})]})]})})]},Le.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:at.map((Le,tt)=>n.jsxs("div",{className:`p-4 ${t&&!Le.is_read?"bg-purple-50":""}`,onClick:()=>oe(Le),children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",checked:B.has(Le.id),onChange:()=>At(Le.id),onClick:ct=>ct.stopPropagation(),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["#",He+tt+1]}),n.jsx(ha,{size:14,className:"text-toss-gray-400"}),n.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:Te(Le.work_date)}),t&&!Le.is_read&&n.jsx("span",{className:"bg-purple-500 text-white px-2 py-0.5 rounded-full text-xs font-medium",children:"NEW"})]}),n.jsxs("div",{className:"flex items-center gap-1",onClick:ct=>ct.stopPropagation(),children:[n.jsx("button",{onClick:()=>Re(Le),className:"p-1.5 text-purple-500 hover:bg-purple-100 rounded-lg",children:n.jsx(na,{size:14})}),n.jsx("button",{onClick:()=>Ae(Le),className:"p-1.5 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg",children:n.jsx(ts,{size:14})}),(e?.user_id===Le.user_id||t)&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>W(Le),className:"p-1.5 text-purple-500 hover:bg-purple-100 rounded-lg",children:n.jsx(js,{size:14})}),n.jsx("button",{onClick:()=>_e(Le),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:n.jsx(Jt,{size:14})})]})]})]}),t&&n.jsxs("div",{className:"text-xs text-toss-gray-600 mb-2",children:[n.jsx("span",{className:"font-medium",children:Le.user?.name||"-"}),n.jsx("span",{className:"mx-1",children:""}),n.jsx("span",{children:Le.user?.team||"-"})]}),n.jsx("p",{className:"text-sm text-toss-gray-700 line-clamp-2",children:L0(Le.morning_work)})]},Le.id))}),De>1&&n.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-toss-gray-200",children:[n.jsx("button",{onClick:()=>mt(E-1),disabled:E===1,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),[...Array(De)].map((Le,tt)=>n.jsx("button",{onClick:()=>mt(tt+1),className:`px-3 py-1 rounded-lg text-sm font-medium ${E===tt+1?"bg-purple-500 text-white":"text-toss-gray-700 hover:bg-toss-gray-100"}`,children:tt+1},tt+1)),n.jsx("button",{onClick:()=>mt(E+1),disabled:E===De,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]}):n.jsxs("div",{className:"text-center text-toss-gray-500 py-8",children:[_,"    "]})}),n.jsx(dr,{isOpen:l,onClose:()=>{u(!1),A()},title:d?"  ":"   ",size:D?"xl":"default",children:n.jsxs("div",{className:"flex gap-6",children:[n.jsxs("div",{className:`space-y-6 max-h-[70vh] overflow-y-auto pr-2 ${D?"flex-1 min-w-0":"w-full"}`,children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),n.jsx("input",{type:"date",value:Q.work_date,onChange:Le=>te({...Q,work_date:Le.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"}),n.jsxs("p",{className:"text-sm text-toss-gray-500 mt-1",children:[Te(Q.work_date)," "]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700",children:"  *"}),n.jsxs("button",{type:"button",onClick:T,disabled:q,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-purple-600 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors disabled:opacity-50",children:[n.jsx(Oc,{size:14,className:q?"animate-spin":""}),q?" ...":"  "]})]}),n.jsxs("div",{className:"space-y-3",children:[Q.monthly_tasks.map((Le,tt)=>n.jsxs("div",{className:"bg-toss-gray-50 rounded-xl p-3 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"text",value:Le.title,onChange:ct=>ce(tt,ct.target.value),className:"flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm font-medium focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:""}),Q.monthly_tasks.length>1&&n.jsx("button",{type:"button",onClick:()=>re(tt),className:"p-1.5 text-red-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors flex-shrink-0 w-[28px] flex items-center justify-center",title:" ",children:n.jsx(Jt,{size:14})}),Q.monthly_tasks.length<=1&&n.jsx("div",{className:"w-[28px] flex-shrink-0"})]}),n.jsxs("div",{className:"hidden sm:grid sm:grid-cols-[1fr_50px_100px_28px] gap-2 px-1",children:[n.jsx("span",{className:"text-xs font-medium text-toss-gray-500",children:""}),n.jsx("span",{className:"text-xs font-medium text-toss-gray-500 text-center",children:""}),n.jsx("span",{className:"text-xs font-medium text-toss-gray-500",children:""}),n.jsx("span",{})]}),Le.details.map((ct,se)=>n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_50px_100px_28px] gap-2 items-stretch",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:""}),n.jsx("textarea",{value:ct.content,onChange:Ne=>le(tt,se,"content",Ne.target.value),rows:2,className:"w-full flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all resize-none leading-relaxed",placeholder:"  "})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:"(%)"}),n.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:ct.progress,onChange:Ne=>{const xe=Ne.target.value.replace(/[^0-9]/g,"");(xe===""||parseInt(xe)>=0&&parseInt(xe)<=100)&&le(tt,se,"progress",xe)},className:"w-full flex-1 px-2 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm text-center focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"%"})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:""}),n.jsx("input",{type:"text",value:ct.remark,onChange:Ne=>le(tt,se,"remark",Ne.target.value),className:"w-full flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:""})]}),n.jsx("div",{className:"flex items-center justify-center",children:Le.details.length>1&&n.jsx("button",{type:"button",onClick:()=>U(tt,se),className:"p-1 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:" ",children:n.jsx(mr,{size:14})})})]},se)),n.jsxs("button",{type:"button",onClick:()=>P(tt),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-purple-600 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[n.jsx(ps,{size:14}),"  "]})]},tt)),n.jsxs("button",{type:"button",onClick:G,className:"flex items-center gap-2 px-4 py-2 text-purple-600 hover:bg-purple-50 rounded-xl transition-colors text-sm font-medium",children:[n.jsx(C0,{size:16}),"  "]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"()"}),n.jsx("textarea",{value:Q.special_notes,onChange:Le=>te({...Q,special_notes:Le.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),d&&Q.existingFileUrls.length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("div",{className:"space-y-2",children:Q.existingFileUrls.map((Le,tt)=>{const ct=Le.split("/").pop();return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:ct})]}),n.jsx("button",{onClick:()=>H(tt),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(mr,{size:16})})]},tt)})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"file",ref:O,multiple:!0,onChange:ne,className:"hidden"}),n.jsx("button",{type:"button",onClick:()=>O.current?.click(),className:"w-full p-6 border-2 border-dashed border-toss-gray-300 rounded-2xl hover:border-purple-500 hover:bg-purple-50/50 transition-all",children:n.jsxs("div",{className:"flex flex-col items-center gap-2 text-toss-gray-600",children:[n.jsx(ji,{size:28}),n.jsx("span",{className:"font-medium",children:" "}),n.jsx("span",{className:"text-xs text-toss-gray-500",children:"   "})]})}),Q.files.length>0&&n.jsx("div",{className:"mt-4 space-y-2",children:Q.files.map((Le,tt)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:Le.name}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["(",Le.size,")"]})]}),n.jsx("button",{onClick:()=>ie(tt),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(mr,{size:16})})]},tt))})]}),n.jsxs("div",{className:"flex gap-3 pt-4 sticky bottom-0 bg-white",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{u(!1),A()},className:"flex-1",children:""}),n.jsx(Ye,{onClick:d?ue:S,className:"flex-1 bg-purple-500 hover:bg-purple-600",loading:y,disabled:y,children:y?" ...":d?"":""})]})]}),D&&n.jsxs("div",{className:"flex-1 min-w-0 flex flex-col max-h-[70vh]",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-50 border border-purple-200 rounded-t-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ha,{size:16,className:"text-purple-600"}),n.jsx("span",{className:"text-sm font-semibold text-purple-800",children:"  "})]}),n.jsx("button",{type:"button",onClick:()=>{V(!1),ae([])},className:"p-1.5 text-purple-600 hover:bg-purple-100 rounded-lg transition-colors",children:n.jsx(mr,{size:16})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto border-x border-purple-200 bg-white px-4 py-3",children:I.length>0?n.jsx("div",{className:"space-y-3",children:I.map((Le,tt)=>{const ct=(Le.title||"").match(/^\[(\d+)\]\s*(.*)$/),se=ct?ct[1]:"",Ne=ct?ct[2]:Le.title||"";return n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-3",children:[se&&n.jsxs("div",{className:"text-sm font-semibold text-purple-600 mb-0.5",children:["[",se,"]"]}),Ne&&n.jsxs("div",{className:"text-sm font-semibold text-purple-800 mb-1",children:["[",Ne,"]"]}),!se&&!Ne&&n.jsx("div",{className:"text-sm font-semibold text-purple-800 mb-1",children:"[-]"}),Le.details.map((xe,je)=>n.jsx("div",{className:"text-sm text-toss-gray-700 ml-2 mb-1",children:(xe.content||"-").split(`
`).map((de,Oe)=>n.jsx("div",{children:de.trim()?`- ${de.trim()}`:""},Oe))},je))]},tt)})}):n.jsx("div",{className:"flex items-center justify-center h-full text-toss-gray-400 text-sm",children:" ..."})}),I.length>0&&n.jsx("div",{className:"border-x border-b border-purple-200 rounded-b-xl bg-purple-50/30 px-4 py-2",children:n.jsxs("button",{type:"button",onClick:()=>{const Le=I.map(tt=>{const ct=(tt.title||"").match(/^\[(\d+)\]\s*(.*)$/),se=ct?ct[1]:"",Ne=ct?ct[2]:tt.title||"",xe=[];return se&&xe.push(`[${se}]`),Ne&&xe.push(`[${Ne}]`),tt.details.forEach(je=>{(je.content||"-").split(`
`).forEach(de=>{de.trim()&&xe.push(`- ${de.trim()}`)})}),xe.join(`
`)}).join(`

`);navigator.clipboard.writeText(Le).then(()=>{alert(" .")})},className:"w-full flex items-center justify-center gap-2 py-2 text-sm font-medium text-purple-700 hover:bg-purple-100 rounded-lg transition-colors",children:[n.jsx(em,{size:15}),""]})})]})]})}),n.jsx(dr,{isOpen:!!b&&!l,onClose:()=>g(null),title:"  ",children:b&&n.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto -mx-2 px-2",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),n.jsx("p",{className:"text-toss-gray-900",children:Te(b.work_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 font-medium",children:b.user?`${b.user.name}  ${b.user.team||" "}`:"-"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),It(b.morning_work)]}),b.special_notes&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:"()"}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 whitespace-pre-wrap text-toss-gray-900",children:b.special_notes})]}),b.file_urls&&b.file_urls.length>0&&n.jsx(jU,{urls:b.file_urls}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[n.jsxs("button",{onClick:()=>Re(b),className:"flex items-center gap-2 px-4 py-2 bg-purple-50 text-purple-600 rounded-xl hover:bg-purple-100 transition-colors text-sm font-medium",children:[n.jsx(na,{size:16}),""]}),n.jsxs("button",{onClick:()=>Ae(b),className:"flex items-center gap-2 px-4 py-2 bg-toss-gray-100 text-toss-gray-700 rounded-xl hover:bg-toss-gray-200 transition-colors text-sm font-medium",children:[n.jsx(ts,{size:16}),"Word "]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>g(null),className:"flex-1",children:""}),n.jsx(Ye,{onClick:()=>W(b),className:"flex-1 bg-purple-500 hover:bg-purple-600",children:""})]})]})})]})},wk={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""},_k={PH:"",KH:"",VN:"",GT:"",US:"",BR:"",CL:"",NL:"",CN:"",TH:"",AU:"",SG:"",JP:"",MY:"",ID:"",IN:"",MX:"",PE:"",CO:"",EC:"",MM:"",LA:"",BD:"",NP:"",PK:"",AE:"",SA:"",QA:"",KW:"",RU:"",UA:"",PL:"",DE:"",FR:"",GB:"",IT:"",ES:"",CA:"",NZ:"",ZA:"",KE:"",NG:"",EG:"",MA:"",TR:""},tr={statsTop:245,statsHeight:114,statsBoxes:[{left:330,width:310},{left:647,width:310},{left:964,width:315},{left:1282,width:310}],tableDataTop:457,rowHeight:57,leftTable:{left:330},rightTable:{left:965},columnWidth:313};function AU({isOpen:e,onClose:t,summaryStats:r,countryStats:s}){const a=X.useRef(null),o=X.useRef(null),[l,u]=X.useState(!1),[d,h]=X.useState(!0),[m,x]=X.useState(null);X.useEffect(()=>{const g=()=>{u(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",g),()=>document.removeEventListener("fullscreenchange",g)},[]),X.useEffect(()=>{const g=_=>{_.key==="Escape"&&!l&&t()};return e&&document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[e,l,t]);const y=X.useCallback(async()=>{const g=a.current;if(!g)return;h(!0);const _=2;g.width=1920*_,g.height=1080*_;const w=g.getContext("2d");w.imageSmoothingEnabled=!0,w.imageSmoothingQuality="high",w.scale(_,_);const k="/company-intranet/",N=new Image;N.crossOrigin="anonymous",N.src=`${k}back.jpg`,await new Promise(B=>{N.onload=B,N.onerror=B}),w.drawImage(N,0,0,1920,1080);const E=new Image;E.crossOrigin="anonymous",E.src=`${k}template.png`,await new Promise(B=>{E.onload=B,E.onerror=B}),w.drawImage(E,0,0,1920,1080),w.textBaseline="middle";const C=tr.statsTop+tr.statsHeight/2;w.font="bold 48px Pretendard, -apple-system, sans-serif",w.fillStyle="#1f2937",w.textAlign="center",w.fillText(`${r?.this_week||0}`,tr.statsBoxes[0].left+tr.statsBoxes[0].width/2-15,C),w.font="24px Pretendard, -apple-system, sans-serif",w.fillText("",tr.statsBoxes[0].left+tr.statsBoxes[0].width/2+35,C),w.font="bold 48px Pretendard, -apple-system, sans-serif",w.fillText(`${r?.this_month||0}`,tr.statsBoxes[1].left+tr.statsBoxes[1].width/2-15,C),w.font="24px Pretendard, -apple-system, sans-serif",w.fillText("",tr.statsBoxes[1].left+tr.statsBoxes[1].width/2+35,C),w.font="bold 48px Pretendard, -apple-system, sans-serif",w.fillText(`${r?.this_year||0}`,tr.statsBoxes[2].left+tr.statsBoxes[2].width/2-15,C),w.font="24px Pretendard, -apple-system, sans-serif",w.fillText("",tr.statsBoxes[2].left+tr.statsBoxes[2].width/2+35,C),w.font="bold 48px Pretendard, -apple-system, sans-serif",w.fillStyle="#2c6eb6",w.fillText(`${r?.total||0}`,tr.statsBoxes[3].left+tr.statsBoxes[3].width/2-20,C),w.font="24px Pretendard, -apple-system, sans-serif",w.fillText("",tr.statsBoxes[3].left+tr.statsBoxes[3].width/2+45,C),(s?.in_progress||[]).forEach((B,F)=>{const q=tr.tableDataTop+F*tr.rowHeight+tr.rowHeight/2,fe=B.country_name||_k[B.country_code]||B.country_code,D=wk[fe]||"";w.font="32px Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji, sans-serif",w.textAlign="left",w.fillText(D,tr.leftTable.left+25,q),w.font="600 24px Pretendard, -apple-system, sans-serif",w.fillStyle="#374151",w.fillText(fe,tr.leftTable.left+70,q),w.font="bold 28px Pretendard, -apple-system, sans-serif",w.fillStyle="#1f2937",w.textAlign="center",w.fillText(`${B.rescue_count||0}`,tr.leftTable.left+tr.columnWidth+tr.columnWidth/2-20,q),w.font="24px Pretendard, -apple-system, sans-serif",w.fillStyle="#374151",w.fillText("",tr.leftTable.left+tr.columnWidth+tr.columnWidth/2+25,q)}),(s?.completed||[]).forEach((B,F)=>{const q=tr.tableDataTop+F*tr.rowHeight+tr.rowHeight/2,fe=B.country_name||_k[B.country_code]||B.country_code,D=wk[fe]||"";w.font="32px Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji, sans-serif",w.textAlign="left",w.fillText(D,tr.rightTable.left+25,q),w.font="600 24px Pretendard, -apple-system, sans-serif",w.fillStyle="#374151",w.fillText(fe,tr.rightTable.left+70,q),w.font="bold 28px Pretendard, -apple-system, sans-serif",w.fillStyle="#1f2937",w.textAlign="center",w.fillText(`${B.rescue_count||0}`,tr.rightTable.left+tr.columnWidth+tr.columnWidth/2-20,q),w.font="24px Pretendard, -apple-system, sans-serif",w.fillStyle="#374151",w.fillText("",tr.rightTable.left+tr.columnWidth+tr.columnWidth/2+25,q)}),x(g.toDataURL("image/png")),h(!1)},[r,s]);X.useEffect(()=>{if(e){const g=setTimeout(()=>{y()},100);return()=>clearTimeout(g)}},[e,y]);const v=X.useCallback(()=>{document.fullscreenElement?document.exitFullscreen():o.current?.requestFullscreen()},[]),b=X.useCallback(()=>{const g=a.current;g&&g.toBlob(_=>{if(_){const w=URL.createObjectURL(_),k=document.createElement("a");k.download=`_${new Date().toISOString().split("T")[0]}.png`,k.href=w,k.click(),URL.revokeObjectURL(w)}},"image/png")},[]);return e?n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90",children:[n.jsx("canvas",{ref:a,width:1920,height:1080,style:{display:"none"}}),!l&&n.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-[60] p-3 bg-white rounded-full shadow-lg hover:bg-gray-100 transition-colors",title:" (ESC)",children:n.jsx(mr,{size:28})}),n.jsx("div",{ref:o,className:"relative flex items-center justify-center w-full h-full",children:d?n.jsx("div",{className:"text-white text-xl",children:" ..."}):m?n.jsxs(n.Fragment,{children:[n.jsx("img",{src:m,alt:"",className:`max-w-full max-h-full object-contain ${l?"w-full h-full":""}`,style:{maxWidth:l?"100%":"90vw",maxHeight:l?"100%":"90vh"}}),!l&&n.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-3 z-50",children:[n.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-4 py-2 bg-white/90 hover:bg-white rounded-lg shadow-lg transition-all text-gray-800",title:" ",children:[n.jsx(ts,{size:20}),n.jsx("span",{className:"font-medium",children:""})]}),n.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-white/90 hover:bg-white rounded-lg shadow-lg transition-all text-gray-800",title:"",children:[n.jsx(U3,{size:20}),n.jsx("span",{className:"font-medium",children:""})]})]})]}):n.jsx("div",{className:"text-white text-xl",children:"   ."})})]}):null}const ao={KR:"",KP:"",JP:"",CN:"",TW:"",HK:"",MO:"",MN:"",VN:"",TH:"",PH:"",KH:"",LA:"",MM:"",MY:"",SG:"",ID:"",BN:"",TL:"",IN:"",PK:"",BD:"",LK:"",NP:"",BT:"",MV:"",AF:"",KZ:"",UZ:"",KG:"",TJ:"",TM:"",IR:"",IQ:"",SY:"",LB:"",JO:"",IL:"",PS:"",SA:"",AE:"",QA:"",KW:"",BH:"",OM:"",YE:"",TR:"",GB:"",FR:"",DE:"",IT:"",ES:"",PT:"",NL:"",BE:"",LU:"",CH:"",AT:"",PL:"",CZ:"",SK:"",HU:"",RO:"",BG:"",GR:"",HR:"",RS:"",SI:"",BA:"",ME:"",MK:"",AL:"",XK:"",UA:"",BY:"",MD:"",RU:"",EE:"",LV:"",LT:"",FI:"",SE:"",NO:"",DK:"",IS:"",IE:"",MT:"",CY:"",GE:"",AM:"",AZ:"",MC:"",AD:"",SM:"",VA:"",US:"",CA:"",MX:"",GT:"",BZ:"",SV:"",HN:"",NI:"",CR:"",PA:"",CU:"",JM:"",HT:"",DO:"",PR:"",BS:"",TT:"",BB:"",BR:"",AR:"",CL:"",PE:"",CO:"",VE:"",EC:"",BO:"",PY:"",UY:"",GY:"",SR:"",AU:"",NZ:"",PG:"",FJ:"",WS:"",TO:"",VU:"",SB:"",GU:"",EG:"",LY:"",TN:"",DZ:"",MA:"",ZA:"",NG:"",KE:"",ET:"",GH:"",TZ:"",UG:"",ZW:"",MZ:"",AO:"",CM:"",CI:"",SN:"",CD:"",CG:"",SD:"",SS:"",SO:"",RW:"",MG:"",MU:"",NA:"",BW:"",ZM:"",MW:"",MR:"",ML:"",NE:"",TD:"",BF:"",TG:"",BJ:"",LR:"",SL:"",GN:"",GM:"",CV:"",DJ:"",ER:""},Nk=[{code:"KR",name:""},{code:"KP",name:""},{code:"JP",name:""},{code:"CN",name:""},{code:"TW",name:""},{code:"HK",name:""},{code:"MO",name:""},{code:"MN",name:""},{code:"VN",name:""},{code:"TH",name:""},{code:"PH",name:""},{code:"KH",name:""},{code:"LA",name:""},{code:"MM",name:""},{code:"MY",name:""},{code:"SG",name:""},{code:"ID",name:""},{code:"BN",name:""},{code:"TL",name:""},{code:"IN",name:""},{code:"PK",name:""},{code:"BD",name:""},{code:"LK",name:""},{code:"NP",name:""},{code:"BT",name:""},{code:"MV",name:""},{code:"AF",name:""},{code:"KZ",name:""},{code:"UZ",name:""},{code:"KG",name:""},{code:"TJ",name:""},{code:"TM",name:""},{code:"IR",name:""},{code:"IQ",name:""},{code:"SY",name:""},{code:"LB",name:""},{code:"JO",name:""},{code:"IL",name:""},{code:"PS",name:""},{code:"SA",name:""},{code:"AE",name:""},{code:"QA",name:""},{code:"KW",name:""},{code:"BH",name:""},{code:"OM",name:""},{code:"YE",name:""},{code:"TR",name:""},{code:"GB",name:""},{code:"FR",name:""},{code:"DE",name:""},{code:"IT",name:""},{code:"ES",name:""},{code:"PT",name:""},{code:"NL",name:""},{code:"BE",name:""},{code:"LU",name:""},{code:"CH",name:""},{code:"AT",name:""},{code:"PL",name:""},{code:"CZ",name:""},{code:"SK",name:""},{code:"HU",name:""},{code:"RO",name:""},{code:"BG",name:""},{code:"GR",name:""},{code:"HR",name:""},{code:"RS",name:""},{code:"SI",name:""},{code:"BA",name:""},{code:"ME",name:""},{code:"MK",name:""},{code:"AL",name:""},{code:"XK",name:""},{code:"UA",name:""},{code:"BY",name:""},{code:"MD",name:""},{code:"RU",name:""},{code:"EE",name:""},{code:"LV",name:""},{code:"LT",name:""},{code:"FI",name:""},{code:"SE",name:""},{code:"NO",name:""},{code:"DK",name:""},{code:"IS",name:""},{code:"IE",name:""},{code:"MT",name:""},{code:"CY",name:""},{code:"GE",name:""},{code:"AM",name:""},{code:"AZ",name:""},{code:"MC",name:""},{code:"AD",name:""},{code:"SM",name:""},{code:"VA",name:""},{code:"US",name:""},{code:"CA",name:""},{code:"MX",name:""},{code:"GT",name:""},{code:"BZ",name:""},{code:"SV",name:""},{code:"HN",name:""},{code:"NI",name:""},{code:"CR",name:""},{code:"PA",name:""},{code:"CU",name:""},{code:"JM",name:""},{code:"HT",name:""},{code:"DO",name:""},{code:"PR",name:""},{code:"BS",name:""},{code:"TT",name:""},{code:"BB",name:""},{code:"BR",name:""},{code:"AR",name:""},{code:"CL",name:""},{code:"PE",name:""},{code:"CO",name:""},{code:"VE",name:""},{code:"EC",name:""},{code:"BO",name:""},{code:"PY",name:""},{code:"UY",name:""},{code:"GY",name:""},{code:"SR",name:""},{code:"AU",name:""},{code:"NZ",name:""},{code:"PG",name:""},{code:"FJ",name:""},{code:"WS",name:""},{code:"TO",name:""},{code:"VU",name:""},{code:"SB",name:""},{code:"GU",name:""},{code:"EG",name:""},{code:"LY",name:""},{code:"TN",name:""},{code:"DZ",name:""},{code:"MA",name:""},{code:"ZA",name:""},{code:"NG",name:""},{code:"KE",name:""},{code:"ET",name:""},{code:"GH",name:""},{code:"TZ",name:""},{code:"UG",name:""},{code:"ZW",name:""},{code:"MZ",name:""},{code:"AO",name:""},{code:"CM",name:""},{code:"CI",name:""},{code:"SN",name:""},{code:"CD",name:""},{code:"CG",name:""},{code:"SD",name:""},{code:"SS",name:""},{code:"SO",name:""},{code:"RW",name:""},{code:"MG",name:""},{code:"MU",name:""},{code:"NA",name:""},{code:"BW",name:""},{code:"ZM",name:""},{code:"MW",name:""},{code:"MR",name:""},{code:"ML",name:""},{code:"NE",name:""},{code:"TD",name:""},{code:"BF",name:""},{code:"TG",name:""},{code:"BJ",name:""},{code:"LR",name:""},{code:"SL",name:""},{code:"GN",name:""},{code:"GM",name:""},{code:"CV",name:""},{code:"DJ",name:""},{code:"ER",name:""}].sort((e,t)=>e.name.localeCompare(t.name,"ko")),CU=()=>{const{profile:e,isAdmin:t}=Kr(),[r,s]=X.useState([]),[a,o]=X.useState(!1),[l,u]=X.useState(!1),[d,h]=X.useState(!1),[m,x]=X.useState(null),[y,v]=X.useState(!0),[b,g]=X.useState(1),_=15,[w,k]=X.useState(new Set),[N,E]=X.useState(!1),C=X.useRef(null),[L,O]=X.useState({in_progress:[],completed:[]}),[B,F]=X.useState({this_week:0,this_month:0,this_year:0,total:0}),[q,fe]=X.useState(null),[D,V]=X.useState(!1),[I,ae]=X.useState(!1),[Q,te]=X.useState(!0),ve=X.useRef(null),[ee,Se]=X.useState(!1),[J,M]=X.useState({this_week:0,this_month:0,this_year:0,total:0,in_progress:[],completed:[]}),[Y,G]=X.useState({location:"",name:"",request_date:"",status:"",details:"",is_completed:!1,photo_url:"",photo_file:null});X.useEffect(()=>{re(),ce(),P()},[]);const re=async()=>{try{const{data:de,error:Oe}=await Pe.from("rescue_situations").select("*").order("created_at",{ascending:!1});if(Oe)throw Oe;s(de||[])}catch(de){console.error("Error fetching rescue situations:",de),alert("  : "+de.message)}finally{v(!1)}},ce=async()=>{try{const{data:de,error:Oe}=await Pe.from("rescue_summary_stats").select("*");if(!Oe&&de&&de.length>0){const pt={};de.forEach(_t=>{pt[_t.stat_key]=_t.stat_value}),F(pt)}const{data:Ue,error:rt}=await Pe.from("rescue_country_stats").select("*").order("display_order",{ascending:!0});if(!rt&&Ue){const pt=Ue.filter(Vt=>Vt.stat_type==="in_progress"),_t=Ue.filter(Vt=>Vt.stat_type==="completed");O({in_progress:pt,completed:_t})}}catch(de){console.error("Error fetching rescue stats:",de)}},P=async()=>{try{const{data:de}=await Pe.from("rescue_reference_images").select("*").order("created_at",{ascending:!1}).limit(1).single();de&&fe(de)}catch{}},U=()=>{G({location:"",name:"",request_date:"",status:"",details:"",is_completed:!1,photo_url:"",photo_file:null}),h(!1),x(null)},le=de=>{const Oe=de.target.files[0];if(Oe){if(!Oe.type.startsWith("image/")){alert("   .");return}G({...Y,photo_file:Oe})}},ne=()=>{G({...Y,photo_file:null,photo_url:""}),C.current&&(C.current.value="")},ie=async()=>{if(!Y.name||!Y.location){alert("    .");return}try{E(!0);let de="";Y.photo_file&&(de=(await x0(Y.photo_file,"/rescue")).url);const{error:Oe}=await Pe.from("rescue_situations").insert({location:Y.location,name:Y.name,request_date:Y.request_date,status:Y.status,details:Y.details,is_completed:Y.is_completed,photo_url:de,user_id:e.user_id});if(Oe)throw Oe;o(!1),U(),re(),alert(" .")}catch(de){console.error("Error creating rescue situation:",de),alert("  : "+de.message)}finally{E(!1)}},H=async()=>{if(!Y.name||!Y.location){alert("    .");return}try{E(!0);let de=Y.photo_url;Y.photo_file&&(de=(await x0(Y.photo_file,"/rescue")).url);const{error:Oe}=await Pe.from("rescue_situations").update({location:Y.location,name:Y.name,request_date:Y.request_date,status:Y.status,details:Y.details,is_completed:Y.is_completed,photo_url:de}).eq("id",m.id);if(Oe)throw Oe;o(!1),U(),re(),alert(" .")}catch(de){console.error("Error updating rescue situation:",de),alert("  : "+de.message)}finally{E(!1)}},K=async de=>{if(confirm(" ?"))try{de.photo_url&&await g0(de.photo_url);const{error:Oe}=await Pe.from("rescue_situations").delete().eq("id",de.id);if(Oe)throw Oe;re(),alert(".")}catch(Oe){console.error("Error deleting rescue situation:",Oe),alert(" .")}},S=async de=>{try{const{error:Oe}=await Pe.from("rescue_situations").update({is_completed:!de.is_completed}).eq("id",de.id);if(Oe)throw Oe;re()}catch(Oe){console.error("Error toggling complete:",Oe),alert("  .")}},ue=de=>{G({location:de.location||"",name:de.name||"",request_date:de.request_date||"",status:de.status||"",details:de.details||"",is_completed:de.is_completed||!1,photo_url:de.photo_url||"",photo_file:null}),x(de),h(!0),o(!0)},z=()=>{U(),o(!0)},T=de=>{x(de),u(!0)},A=[...r].sort((de,Oe)=>de.is_completed!==Oe.is_completed?de.is_completed?1:-1:new Date(Oe.created_at)-new Date(de.created_at)),W=b*_,pe=W-_,_e=A.slice(pe,W),oe=Math.ceil(A.length/_),Te=de=>{g(de)},Me=de=>{k(Oe=>{const Ue=new Set(Oe);return Ue.has(de)?Ue.delete(de):Ue.add(de),Ue})},Ae=()=>{const de=_e.map(Ue=>Ue.id),Oe=de.every(Ue=>w.has(Ue));k(Ue=>{const rt=new Set(Ue);return Oe?de.forEach(pt=>rt.delete(pt)):de.forEach(pt=>rt.add(pt)),rt})},Re=async()=>{if(w.size===0){alert("  .");return}const de=r.filter(_t=>w.has(_t.id)),Oe=[new pr({tableHeader:!0,children:[new gt({width:{size:800,type:Bt.DXA},shading:{fill:"E8F0FE"},children:[new ot({children:[new Tt({text:"No",bold:!0})],alignment:Dt.CENTER})]}),new gt({width:{size:2e3,type:Bt.DXA},shading:{fill:"E8F0FE"},children:[new ot({children:[new Tt({text:"",bold:!0})],alignment:Dt.CENTER})]}),new gt({width:{size:1500,type:Bt.DXA},shading:{fill:"E8F0FE"},children:[new ot({children:[new Tt({text:"",bold:!0})],alignment:Dt.CENTER})]}),new gt({width:{size:1500,type:Bt.DXA},shading:{fill:"E8F0FE"},children:[new ot({children:[new Tt({text:"",bold:!0})],alignment:Dt.CENTER})]}),new gt({width:{size:4200,type:Bt.DXA},shading:{fill:"E8F0FE"},children:[new ot({children:[new Tt({text:" ",bold:!0})],alignment:Dt.CENTER})]})]}),...de.map((_t,Vt)=>new pr({children:[new gt({children:[new ot({text:String(Vt+1),alignment:Dt.CENTER})]}),new gt({children:[new ot({text:_t.location||"-"})]}),new gt({children:[new ot({text:_t.name||"-"})]}),new gt({children:[new ot({text:_t.request_date||"-"})]}),new gt({children:[new ot({text:_t.details||"-"})]})]}))],Ue=new fm({sections:[{properties:{},children:[new ot({children:[new Tt({text:"",bold:!0,size:32})],alignment:Dt.CENTER}),new ot({text:""}),new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:Oe})]}]}),rt=await hm.toBlob(Ue),pt=new Date().toISOString().split("T")[0];mm.saveAs(rt,`_${pt}.docx`),k(new Set)},et=()=>{M({this_week:B.this_week||0,this_month:B.this_month||0,this_year:B.this_year||0,total:B.total||0,in_progress:L.in_progress.map(de=>({...de})),completed:L.completed.map(de=>({...de}))}),V(!0)},[He,at]=X.useState({in_progress:"",completed:""}),[De,mt]=X.useState({in_progress:null,completed:null}),At=de=>{if(!de)return Nk;const Oe=de.toLowerCase();return Nk.filter(Ue=>Ue.name.toLowerCase().includes(Oe)||Ue.code.toLowerCase().includes(Oe))},wt=(de,Oe)=>{M(Ue=>({...Ue,[de]:[...Ue[de],{country_code:Oe.code,country_name:Oe.name,rescue_count:0,stat_type:de}]})),at(Ue=>({...Ue,[de]:""}))},Ct=(de,Oe)=>{M(Ue=>({...Ue,[de]:Ue[de].filter((rt,pt)=>pt!==Oe)}))},It=(de,Oe,Ue,rt)=>{M(pt=>{const _t=[...pt[de]];return _t[Oe]={..._t[Oe],[Ue]:parseInt(rt)||0},{...pt,[de]:_t}})},Le=(de,Oe,Ue)=>{M(rt=>{const pt=[...rt[de]],_t=Ue==="up"?Oe-1:Oe+1;if(_t<0||_t>=pt.length)return rt;const Vt=pt[Oe];return pt[Oe]=pt[_t],pt[_t]=Vt,{...rt,[de]:pt}})},tt=(de,Oe)=>{if(de.key==="Enter"){if(de.preventDefault(),de.stopPropagation(),de.nativeEvent?.isComposing||de.isComposing)return;const Ue=He[Oe];if(!Ue)return;const rt=At(Ue);rt.length>0&&wt(Oe,rt[0])}},ct=async()=>{try{E(!0);for(const Ue of["this_week","this_month","this_year","total"]){const{error:rt}=await Pe.from("rescue_summary_stats").upsert({stat_key:Ue,stat_value:J[Ue]||0,updated_at:new Date().toISOString()},{onConflict:"stat_key"});if(rt)throw rt}const{error:de}=await Pe.from("rescue_country_stats").delete().in("stat_type",["in_progress","completed"]);if(de)throw de;const Oe=[...J.in_progress.map((Ue,rt)=>({...Ue,stat_type:"in_progress",display_order:rt})),...J.completed.map((Ue,rt)=>({...Ue,stat_type:"completed",display_order:rt}))];if(Oe.length>0){const{error:Ue}=await Pe.from("rescue_country_stats").insert(Oe.map(rt=>({country_code:rt.country_code,country_name:rt.country_name,rescue_count:rt.rescue_count,stat_type:rt.stat_type,display_order:rt.display_order})));if(Ue)throw Ue}V(!1),await ce(),alert(" .")}catch(de){console.error("Error saving stats:",de),alert("  : "+de.message)}finally{E(!1)}},se=async de=>{const Oe=de.target.files[0];if(Oe)try{E(!0);const Ue=await x0(Oe,"/rescue/reference");q?.image_url&&(await g0(q.image_url),await Pe.from("rescue_reference_images").delete().eq("id",q.id));const{data:rt,error:pt}=await Pe.from("rescue_reference_images").insert({image_url:Ue.url,title:"  "}).select().single();if(pt)throw pt;fe(rt),ae(!1),alert(" .")}catch(Ue){console.error("Error uploading reference image:",Ue),alert("  : "+Ue.message)}finally{E(!1)}},Ne=async()=>{if(q&&confirm("  ?"))try{await g0(q.image_url),await Pe.from("rescue_reference_images").delete().eq("id",q.id),fe(null),alert(" .")}catch(de){console.error("Error deleting reference image:",de),alert("  .")}},xe=()=>{const de=[...L.in_progress.map(Ue=>({name:Ue.country_name,flag:ao[Ue.country_code]||"",count:Ue.rescue_count,type:" "})),...L.completed.map(Ue=>({name:Ue.country_name,flag:ao[Ue.country_code]||"",count:Ue.rescue_count,type:" "}))],Oe=`
            <div class="stats-grid">
                <div class="stat-box"><div class="label"> </div><div class="value">${B.this_week||0}<span class="unit"> </span></div></div>
                <div class="stat-box"><div class="label"> </div><div class="value">${B.this_month||0}<span class="unit"> </span></div></div>
                <div class="stat-box"><div class="label">2026</div><div class="value">${B.this_year||0}<span class="unit"> </span></div></div>
                <div class="stat-box highlight"><div class="label"> </div><div class="value">${B.total||0}<span class="unit"> </span></div></div>
            </div>
            ${de.length>0?`
            <div class="section-title">  </div>
            <table>
                <thead><tr><th></th><th></th><th></th></tr></thead>
                <tbody>
                    ${de.map(Ue=>`<tr><td style="text-align:center">${Ue.type}</td><td style="text-align:center">${Ue.flag} ${Ue.name}</td><td style="text-align:center">${Ue.count}</td></tr>`).join("")}
                </tbody>
            </table>`:""}
        `;ul({title:"  ",content:Oe})},je=()=>{const de=w.size>0?r.filter(rt=>w.has(rt.id)):r,Ue=`
            <div class="section-title">  - ${w.size>0?`  (${de.length})`:` (${de.length})`}</div>
            <table>
                <colgroup>
                    <col style="width:5%"/>
                    <col style="width:12%"/>
                    <col style="width:8%"/>
                    <col style="width:10%"/>
                    <col style="width:55%"/>
                    <col style="width:10%"/>
                </colgroup>
                <thead><tr><th>No</th><th></th><th></th><th></th><th> </th><th></th></tr></thead>
                <tbody>
                    ${de.map((rt,pt)=>`
                        <tr>
                            <td>${pt+1}</td>
                            <td>${rt.location||"-"}</td>
                            <td>${rt.name||"-"}</td>
                            <td>${rt.request_date||"-"}</td>
                            <td class="left" style="word-break:keep-all">${rt.status||"-"}</td>
                            <td>${rt.is_completed?"":""}</td>
                        </tr>
                    `).join("")}
                </tbody>
            </table>
        `;ul({title:" ",content:Ue})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(vl,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:" "}),n.jsx("p",{className:"text-white/90",children:t?"    ":"  "})]})]})}),n.jsxs(Et,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-amber-50 border-b border-amber-100 cursor-pointer",onClick:()=>te(!Q),children:[n.jsx("div",{className:"flex items-center gap-3",children:n.jsx("div",{children:n.jsx("h3",{className:"font-bold text-toss-gray-900",children:"26   "})})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:de=>{de.stopPropagation(),Se(!0)},className:"p-2 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:n.jsx(tm,{size:18})}),n.jsx("button",{onClick:de=>{de.stopPropagation(),xe()},className:"p-2 text-toss-gray-600 hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:n.jsx(na,{size:18})}),n.jsx("button",{onClick:de=>{de.stopPropagation(),et()},className:"p-2 text-toss-gray-600 hover:bg-amber-100 rounded-lg transition-colors",title:" ",children:n.jsx(yl,{size:18})}),n.jsx("button",{onClick:de=>{de.stopPropagation(),ae(!0)},className:"p-2 text-toss-gray-600 hover:bg-amber-100 rounded-lg transition-colors",title:" ",children:n.jsx(P3,{size:18})}),Q?n.jsx(_i,{size:20,className:"text-toss-gray-500"}):n.jsx($n,{size:20,className:"text-toss-gray-500"})]})]}),Q&&n.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[B.this_week||0,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[B.this_month||0,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:"2026"}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[B.this_year||0,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-amber-50 border-2 border-amber-300 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-amber-600 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-amber-600",children:[B.total||0,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]})]}),(L.in_progress.length>0||L.completed.length>0)&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[L.in_progress.length>0&&n.jsxs("div",{className:"border rounded-xl overflow-hidden",children:[n.jsxs("div",{className:"bg-blue-50 px-4 py-2 border-b",children:[n.jsx("span",{className:"font-semibold text-blue-700",children:" "}),n.jsx("span",{className:"text-sm text-blue-500 ml-2",children:" "})]}),n.jsx("div",{className:"divide-y",children:L.in_progress.map((de,Oe)=>n.jsxs("div",{className:"flex items-center justify-between px-4 py-2 hover:bg-toss-gray-50",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-lg",children:ao[de.country_code]||""}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:de.country_name})]}),n.jsxs("span",{className:"font-semibold text-toss-gray-900",children:[de.rescue_count," "]})]},Oe))})]}),L.completed.length>0&&n.jsxs("div",{className:"border rounded-xl overflow-hidden",children:[n.jsxs("div",{className:"bg-orange-50 px-4 py-2 border-b",children:[n.jsx("span",{className:"font-semibold text-orange-700",children:" "}),n.jsx("span",{className:"text-sm text-orange-500 ml-2",children:" "})]}),n.jsx("div",{className:"divide-y",children:L.completed.map((de,Oe)=>n.jsxs("div",{className:"flex items-center justify-between px-4 py-2 hover:bg-toss-gray-50",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-lg",children:ao[de.country_code]||""}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:de.country_name})]}),n.jsxs("span",{className:"font-semibold text-toss-gray-900",children:[de.rescue_count," "]})]},Oe))})]})]}),q&&n.jsxs("div",{className:"mt-4",children:[n.jsx("p",{className:"text-sm font-medium text-toss-gray-500 mb-2",children:" ()"}),n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:q.image_url,alt:"  ",className:"w-full max-h-96 object-contain rounded-xl border bg-toss-gray-50 cursor-pointer",onClick:()=>window.open(q.image_url,"_blank")}),t&&n.jsx("button",{onClick:Ne,className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",title:" ",children:n.jsx(mr,{size:14})})]})]}),L.in_progress.length===0&&L.completed.length===0&&!q&&n.jsx("div",{className:"text-center text-toss-gray-500 py-4",children:t?"      .":"   ."})]})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:""}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Ye,{variant:"secondary",onClick:je,children:[n.jsx(na,{size:18}),""]}),n.jsxs(Ye,{variant:"secondary",onClick:Re,disabled:w.size===0,children:[n.jsx(ts,{size:18}),"Word  ",w.size>0&&`(${w.size})`]}),n.jsxs(Ye,{onClick:z,children:[n.jsx(ps,{size:18}),"  "]})]})]}),n.jsx(Et,{padding:"p-0 sm:p-6",children:y?n.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:" ..."}):_e.length>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full table-fixed",children:[n.jsx("thead",{className:"bg-toss-blue/10 border-b-2 border-toss-blue/20",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-toss-gray-900 w-10",children:n.jsx("input",{type:"checkbox",checked:_e.length>0&&_e.every(de=>w.has(de.id)),onChange:Ae,className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-toss-gray-900 w-14",children:"No"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-toss-gray-900 w-28",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-toss-gray-900 w-20",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-toss-gray-900 w-24",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-toss-gray-900",children:" "}),n.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-toss-gray-900 w-20",children:""}),n.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-toss-gray-900 w-24",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-100",children:_e.map((de,Oe)=>n.jsxs("tr",{className:`transition-colors cursor-pointer ${de.is_completed?"bg-toss-gray-50 hover:bg-toss-gray-100":"bg-orange-50/50 hover:bg-orange-100/50"} ${w.has(de.id)?"!bg-blue-50":""}`,onClick:()=>T(de),children:[n.jsx("td",{className:"px-4 py-3 text-center w-10",onClick:Ue=>Ue.stopPropagation(),children:n.jsx("input",{type:"checkbox",checked:w.has(de.id),onChange:()=>Me(de.id),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("td",{className:"px-4 py-3 text-sm text-center text-toss-gray-600 w-14",children:pe+Oe+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-900 w-28 truncate",children:de.location||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-900 font-medium w-20 truncate",children:de.name||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-700 w-24 truncate",children:de.request_date||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-700 truncate",children:de.status||"-"}),n.jsx("td",{className:"px-4 py-3 text-center w-20",onClick:Ue=>Ue.stopPropagation(),children:n.jsx("button",{onClick:()=>S(de),className:`px-3 py-1 text-xs font-medium rounded-full transition-colors whitespace-nowrap ${de.is_completed?"bg-green-100 text-green-600 hover:bg-green-200":"bg-orange-100 text-orange-600 hover:bg-orange-200"}`,children:de.is_completed?"":""})}),n.jsx("td",{className:"px-4 py-3 text-center w-24",onClick:Ue=>Ue.stopPropagation(),children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:()=>ue(de),className:"p-2 text-blue-500 hover:bg-blue-100 rounded-lg transition-colors",title:"",children:n.jsx(js,{size:16})}),n.jsx("button",{onClick:()=>K(de),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(Jt,{size:16})})]})})]},de.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:_e.map((de,Oe)=>n.jsxs("div",{className:`p-4 ${de.is_completed?"bg-toss-gray-50":"bg-orange-50/50"} ${w.has(de.id)?"!bg-blue-50":""}`,onClick:()=>T(de),children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",checked:w.has(de.id),onChange:()=>Me(de.id),onClick:Ue=>Ue.stopPropagation(),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["#",pe+Oe+1]}),n.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:de.name||"-"})]}),n.jsxs("div",{className:"flex items-center gap-1",onClick:Ue=>Ue.stopPropagation(),children:[n.jsx("button",{onClick:()=>S(de),className:`px-2 py-0.5 text-xs font-medium rounded-full transition-colors whitespace-nowrap ${de.is_completed?"bg-green-100 text-green-600 hover:bg-green-200":"bg-orange-100 text-orange-600 hover:bg-orange-200"}`,children:de.is_completed?"":""}),n.jsx("button",{onClick:()=>ue(de),className:"p-1.5 text-blue-500 hover:bg-blue-100 rounded-lg",children:n.jsx(js,{size:14})}),n.jsx("button",{onClick:()=>K(de),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:n.jsx(Jt,{size:14})})]})]}),n.jsxs("div",{className:"space-y-1 text-sm",children:[n.jsxs("p",{className:"text-toss-gray-700",children:[n.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),de.location||"-"]}),n.jsxs("p",{className:"text-toss-gray-700",children:[n.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),de.request_date||"-"]}),n.jsxs("p",{className:"text-toss-gray-700 line-clamp-1",children:[n.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),de.status||"-"]})]})]},de.id))}),oe>1&&n.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-toss-gray-200",children:[n.jsx("button",{onClick:()=>Te(b-1),disabled:b===1,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),[...Array(oe)].map((de,Oe)=>n.jsx("button",{onClick:()=>Te(Oe+1),className:`px-3 py-1 rounded-lg text-sm font-medium ${b===Oe+1?"bg-toss-blue text-white":"text-toss-gray-700 hover:bg-toss-gray-100"}`,children:Oe+1},Oe+1)),n.jsx("button",{onClick:()=>Te(b+1),disabled:b===oe,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]}):n.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:"  "})}),n.jsx(dr,{isOpen:a,onClose:()=>{o(!1),U()},title:d?" ":"  ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),n.jsx("input",{type:"text",value:Y.location,onChange:de=>G({...Y,location:de.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:" "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),n.jsx("input",{type:"text",value:Y.name,onChange:de=>G({...Y,name:de.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:" "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"text",value:Y.request_date,onChange:de=>G({...Y,request_date:de.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:": 25.01.13"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  ()"}),n.jsx("input",{type:"text",value:Y.status,onChange:de=>G({...Y,status:de.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"   "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:Y.details,onChange:de=>G({...Y,details:de.target.value}),rows:8,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",id:"is_completed",checked:Y.is_completed||!1,onChange:de=>G({...Y,is_completed:de.target.checked}),className:"w-5 h-5 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),n.jsx("label",{htmlFor:"is_completed",className:"text-sm font-medium text-toss-gray-700 cursor-pointer",children:" "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  (1)"}),n.jsx("input",{type:"file",ref:C,accept:"image/*",onChange:le,className:"hidden"}),Y.photo_file||Y.photo_url?n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:Y.photo_file?URL.createObjectURL(Y.photo_file):Y.photo_url,alt:" ",className:"w-full max-h-48 object-contain rounded-xl bg-toss-gray-50"}),n.jsx("button",{type:"button",onClick:ne,className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",children:n.jsx(mr,{size:16})})]}):n.jsxs("button",{type:"button",onClick:()=>C.current?.click(),className:"w-full py-8 border-2 border-dashed border-toss-gray-300 rounded-xl text-toss-gray-500 hover:border-toss-blue hover:text-toss-blue transition-colors flex flex-col items-center justify-center gap-2",children:[n.jsx(bF,{size:24}),n.jsx("span",{className:"text-sm",children:"  "})]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{o(!1),U()},className:"flex-1",disabled:N,children:""}),n.jsx(Ye,{onClick:d?H:ie,className:"flex-1",disabled:N,children:N?" ...":d?"":""})]})]})}),n.jsx(dr,{isOpen:l,onClose:()=>{u(!1),x(null)},title:" ",children:m&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("div",{className:"flex-1 space-y-3",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900",children:m.location||"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 font-medium",children:m.name||"-"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),n.jsx("p",{className:"text-toss-gray-900",children:m.request_date||"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),n.jsx("p",{className:`font-medium ${m.is_completed?"text-green-600":"text-orange-500"}`,children:m.is_completed?"":""})]})]})]}),m.photo_url&&n.jsx("div",{className:"w-32 h-32 flex-shrink-0",children:n.jsx("img",{src:m.photo_url,alt:" ",className:"w-full h-full object-cover rounded-xl cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(m.photo_url,"_blank")})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:"  ()"}),n.jsx("p",{className:"text-toss-gray-900",children:m.status||"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[150px] whitespace-pre-wrap text-toss-gray-900",children:m.details||"  ."})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{u(!1),x(null)},className:"flex-1",children:""}),n.jsx(Ye,{onClick:()=>{u(!1),ue(m)},className:"flex-1",children:""})]})]})}),n.jsx(dr,{isOpen:D,onClose:()=>V(!1),title:"  ",children:n.jsxs("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-toss-gray-700 mb-3",children:" "}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:" "}),n.jsx("input",{type:"number",value:J.this_week,onChange:de=>M({...J,this_week:parseInt(de.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:" "}),n.jsx("input",{type:"number",value:J.this_month,onChange:de=>M({...J,this_month:parseInt(de.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:"2026"}),n.jsx("input",{type:"number",value:J.this_year,onChange:de=>M({...J,this_year:parseInt(de.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:" "}),n.jsx("input",{type:"number",value:J.total,onChange:de=>M({...J,total:parseInt(de.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-blue-700 mb-3",children:" "}),n.jsxs("div",{className:"relative mb-3",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("div",{className:"relative flex-1",children:[n.jsx(ho,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),n.jsx("input",{type:"text",value:He.in_progress,onChange:de=>at(Oe=>({...Oe,in_progress:de.target.value})),onKeyDown:de=>tt(de,"in_progress"),onFocus:()=>mt(de=>({...de,in_progress:!0})),onBlur:()=>setTimeout(()=>mt(de=>({...de,in_progress:!1})),200),className:"w-full pl-9 pr-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-blue-300",placeholder:" "})]})}),De.in_progress&&He.in_progress&&n.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-40 overflow-y-auto",children:[At(He.in_progress).slice(0,8).map(de=>n.jsxs("button",{onClick:()=>wt("in_progress",de),className:"w-full px-3 py-2 text-left hover:bg-blue-50 flex items-center gap-2 text-sm",children:[n.jsx("span",{children:ao[de.code]}),n.jsx("span",{children:de.name})]},de.code)),At(He.in_progress).length===0&&n.jsx("div",{className:"px-3 py-2 text-sm text-toss-gray-400",children:"  "})]})]}),n.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[J.in_progress.map((de,Oe)=>n.jsxs("div",{className:"flex items-center gap-1 bg-blue-50 rounded-lg px-2 py-1.5",children:[n.jsxs("div",{className:"flex flex-col gap-0.5",children:[n.jsx("button",{onClick:()=>Le("in_progress",Oe,"up"),disabled:Oe===0,className:"p-0.5 text-toss-gray-400 hover:text-toss-gray-700 disabled:opacity-30",children:n.jsx(QN,{size:10})}),n.jsx("button",{onClick:()=>Le("in_progress",Oe,"down"),disabled:Oe===J.in_progress.length-1,className:"p-0.5 text-toss-gray-400 hover:text-toss-gray-700 disabled:opacity-30",children:n.jsx(ZN,{size:10})})]}),n.jsx("span",{className:"text-base",children:ao[de.country_code]}),n.jsx("span",{className:"flex-1 text-xs font-medium truncate",children:de.country_name}),n.jsx("input",{type:"number",value:de.rescue_count,onChange:Ue=>It("in_progress",Oe,"rescue_count",Ue.target.value),className:"w-12 px-1 py-0.5 border rounded text-xs text-center",placeholder:"0"}),n.jsx("button",{onClick:()=>Ct("in_progress",Oe),className:"p-0.5 text-red-500 hover:bg-red-100 rounded",children:n.jsx(Jt,{size:12})})]},Oe)),J.in_progress.length===0&&n.jsx("p",{className:"text-xs text-toss-gray-400 text-center py-3 bg-toss-gray-50 rounded-lg",children:"  "})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-orange-700 mb-3",children:" "}),n.jsxs("div",{className:"relative mb-3",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("div",{className:"relative flex-1",children:[n.jsx(ho,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),n.jsx("input",{type:"text",value:He.completed,onChange:de=>at(Oe=>({...Oe,completed:de.target.value})),onKeyDown:de=>tt(de,"completed"),onFocus:()=>mt(de=>({...de,completed:!0})),onBlur:()=>setTimeout(()=>mt(de=>({...de,completed:!1})),200),className:"w-full pl-9 pr-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-orange-300",placeholder:" "})]})}),De.completed&&He.completed&&n.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-40 overflow-y-auto",children:[At(He.completed).slice(0,8).map(de=>n.jsxs("button",{onClick:()=>wt("completed",de),className:"w-full px-3 py-2 text-left hover:bg-orange-50 flex items-center gap-2 text-sm",children:[n.jsx("span",{children:ao[de.code]}),n.jsx("span",{children:de.name})]},de.code)),At(He.completed).length===0&&n.jsx("div",{className:"px-3 py-2 text-sm text-toss-gray-400",children:"  "})]})]}),n.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[J.completed.map((de,Oe)=>n.jsxs("div",{className:"flex items-center gap-1 bg-orange-50 rounded-lg px-2 py-1.5",children:[n.jsxs("div",{className:"flex flex-col gap-0.5",children:[n.jsx("button",{onClick:()=>Le("completed",Oe,"up"),disabled:Oe===0,className:"p-0.5 text-toss-gray-400 hover:text-toss-gray-700 disabled:opacity-30",children:n.jsx(QN,{size:10})}),n.jsx("button",{onClick:()=>Le("completed",Oe,"down"),disabled:Oe===J.completed.length-1,className:"p-0.5 text-toss-gray-400 hover:text-toss-gray-700 disabled:opacity-30",children:n.jsx(ZN,{size:10})})]}),n.jsx("span",{className:"text-base",children:ao[de.country_code]}),n.jsx("span",{className:"flex-1 text-xs font-medium truncate",children:de.country_name}),n.jsx("input",{type:"number",value:de.rescue_count,onChange:Ue=>It("completed",Oe,"rescue_count",Ue.target.value),className:"w-12 px-1 py-0.5 border rounded text-xs text-center",placeholder:"0"}),n.jsx("button",{onClick:()=>Ct("completed",Oe),className:"p-0.5 text-red-500 hover:bg-red-100 rounded",children:n.jsx(Jt,{size:12})})]},Oe)),J.completed.length===0&&n.jsx("p",{className:"text-xs text-toss-gray-400 text-center py-3 bg-toss-gray-50 rounded-lg",children:"  "})]})]})]}),n.jsxs("div",{className:"flex gap-3 pt-4 sticky bottom-0 bg-white",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>V(!1),className:"flex-1",children:""}),n.jsx(Ye,{onClick:ct,className:"flex-1",disabled:N,children:N?" ...":""})]})]})}),n.jsx(dr,{isOpen:I,onClose:()=>ae(!1),title:"  ",children:n.jsxs("div",{className:"space-y-4",children:[q?n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-2",children:" "}),n.jsx("img",{src:q.image_url,alt:" ",className:"w-full max-h-64 object-contain rounded-xl border bg-toss-gray-50"})]}):n.jsx("div",{className:"text-center text-toss-gray-500 py-8 bg-toss-gray-50 rounded-xl",children:"  ."}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  "}),n.jsx("input",{type:"file",accept:"image/*",onChange:se,ref:ve,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),n.jsx("div",{className:"flex gap-3",children:n.jsx(Ye,{variant:"secondary",onClick:()=>ae(!1),className:"flex-1",children:""})})]})}),n.jsx(AU,{isOpen:ee,onClose:()=>Se(!1),summaryStats:B,countryStats:L})]})},Sk=e=>e?e.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0","").replace("?dl=1","").replace("&dl=1",""):"",kk=e=>{const t=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],r=e.toLowerCase();return t.some(s=>r.includes(s))},RU=({files:e})=>{const t=X.useRef(null),[r,s]=X.useState(!1),[a,o]=X.useState(!1),[l,u]=X.useState(null),d=e.filter(y=>kk(y.url)).map(y=>({...y,url:Sk(y.url)})),h=e.filter(y=>!kk(y.url)).map(y=>({...y,url:Sk(y.url)})),m=()=>{if(t.current){const{scrollLeft:y,scrollWidth:v,clientWidth:b}=t.current;s(y>0),o(y<v-b-10)}};X.useEffect(()=>(m(),window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)),[e]);const x=y=>{t.current&&(t.current.scrollBy({left:y==="left"?-200:200,behavior:"smooth"}),setTimeout(m,300))};return d.length===0&&h.length===0?null:n.jsxs("div",{className:"space-y-3",children:[d.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:[" (",d.length,")"]}),n.jsxs("div",{className:"relative",children:[r&&n.jsx("button",{onClick:()=>x("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx($a,{size:20})}),n.jsx("div",{ref:t,onScroll:m,className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:d.map((y,v)=>n.jsx("div",{className:"flex-shrink-0 cursor-pointer w-24 h-24 sm:w-32 sm:h-32 rounded-xl overflow-hidden bg-toss-gray-100",onClick:()=>u(y.url),children:n.jsx("img",{src:y.url,alt:y.name||`  ${v+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:b=>{b.target.style.display="none"}})},v))}),a&&n.jsx("button",{onClick:()=>x("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx(pa,{size:20})})]})]}),h.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:["  (",h.length,")"]}),n.jsx("div",{className:"space-y-2",children:h.map((y,v)=>n.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-blue hover:underline flex-1 truncate",children:y.name||""}),n.jsx(ts,{size:16,className:"text-toss-gray-500"})]},v))})]}),l&&n.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4",style:{zIndex:9999},onClick:()=>u(null),children:[n.jsx("button",{className:"absolute top-4 right-4 text-white hover:text-gray-300",style:{zIndex:1e4},onClick:()=>u(null),children:n.jsx(mr,{size:32})}),n.jsx("img",{src:l,alt:" ",className:"max-h-[85vh] max-w-[95vw] object-contain rounded-lg",onClick:y=>y.stopPropagation()})]})]})},DU=()=>{const{profile:e}=Kr(),[t,r]=X.useState(new Date),[s,a]=X.useState(null),[o,l]=X.useState(null),[u,d]=X.useState(!1),[h,m]=X.useState(!1),[x,y]=X.useState([]),[v,b]=X.useState([]),[g,_]=X.useState(!1),[w,k]=X.useState({title:"",content:"",participants:"",files:[],existingFileUrls:[]}),[N,E]=X.useState(!1),C=X.useRef(null);X.useEffect(()=>{L(),O()},[t]);const L=async()=>{try{const G=t.getFullYear(),re=t.getMonth(),ce=new Date(G,re,1).toISOString().split("T")[0],P=new Date(G,re+1,0).toISOString().split("T")[0],{data:U}=await Pe.from("meetings").select("*").gte("meeting_date",ce).lte("meeting_date",P).order("meeting_date",{ascending:!0});y(U||[])}catch(G){console.error("Error fetching meetings:",G)}},O=async()=>{try{const{data:G}=await Pe.from("meetings").select("*").order("meeting_date",{ascending:!1}).limit(10);b(G||[])}catch(G){console.error("Error fetching recent meetings:",G)}},B=G=>{a(G);const re=x.find(ce=>ce.meeting_date===G);re?(l(re),m(!0)):(k({title:"",content:"",participants:"",files:[],existingFileUrls:[]}),d(!0))},F=G=>{const ce=Array.from(G.target.files).map(P=>({file:P,name:P.name,size:(P.size/1024).toFixed(0)+"KB"}));k(P=>({...P,files:[...P.files,...ce]}))},q=G=>{k(re=>({...re,files:re.files.filter((ce,P)=>P!==G)}))},fe=G=>{k(re=>({...re,existingFileUrls:re.existingFileUrls.filter((ce,P)=>P!==G)}))},D=G=>{l(G),m(!0)},V=async()=>{if(!w.content.trim()){alert("  .");return}_(!0),E(!0);try{let G=[];if(w.files.length>0){const P=`/intranet/meetings/${s}`;G=(await rf(w.files.map(le=>le.file),P)).map(le=>({url:le.url,name:le.name,size:le.size}))}const re=[...w.existingFileUrls,...G],ce=x.find(P=>P.meeting_date===s);if(ce){const{error:P}=await Pe.from("meetings").update({title:w.title,content:w.content,participants:w.participants,file_urls:re,updated_at:new Date().toISOString()}).eq("id",ce.id);if(P)throw P}else{const{error:P}=await Pe.from("meetings").insert([{meeting_date:s,title:w.title,content:w.content,participants:w.participants,file_urls:re}]).select();if(P)throw P}await L(),await O(),d(!1)}catch(G){console.error("Error saving meeting:",G),alert("   : "+(G.message||JSON.stringify(G)))}finally{_(!1),E(!1)}},I=async()=>{if(confirm("  ?")){_(!0);try{const G=x.find(re=>re.meeting_date===s);G&&(G.file_urls&&G.file_urls.length>0&&await sm(G.file_urls),await Pe.from("meetings").delete().eq("id",G.id),await L(),await O()),d(!1)}catch(G){console.error("Error deleting meeting:",G),alert("   .")}finally{_(!1)}}},ae=G=>{const re=G.getFullYear(),ce=G.getMonth(),P=new Date(re,ce,1),le=new Date(re,ce+1,0).getDate(),ne=P.getDay(),ie=[];for(let K=0;K<ne;K++){const S=new Date(re,ce,-ne+K+1);ie.push({date:S,isCurrentMonth:!1})}for(let K=1;K<=le;K++)ie.push({date:new Date(re,ce,K),isCurrentMonth:!0});const H=42-ie.length;for(let K=1;K<=H;K++)ie.push({date:new Date(re,ce+1,K),isCurrentMonth:!1});return ie},Q=G=>G.toISOString().split("T")[0],te=G=>{const re=new Date(G);return`${re.getFullYear()}. ${re.getMonth()+1}. ${re.getDate()}.`},ve=G=>{const re=Q(G);return x.some(ce=>ce.meeting_date===re)},ee=G=>{const re=new Date;return G.toDateString()===re.toDateString()},Se=()=>{r(new Date(t.getFullYear(),t.getMonth()-1,1))},J=()=>{r(new Date(t.getFullYear(),t.getMonth()+1,1))},M=ae(t),Y=["","","","","","",""];return n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(Gs,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:""}),n.jsx("p",{className:"text-white/90",children:"    "})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs(Et,{className:"lg:col-span-2",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("button",{onClick:Se,className:"p-1.5 hover:bg-toss-gray-100 rounded-lg transition-colors",children:n.jsx($a,{size:20,className:"text-toss-gray-600"})}),n.jsxs("h3",{className:"text-lg font-bold text-toss-gray-900",children:[t.getFullYear()," ",t.getMonth()+1,""]}),n.jsx("button",{onClick:J,className:"p-1.5 hover:bg-toss-gray-100 rounded-lg transition-colors",children:n.jsx(pa,{size:20,className:"text-toss-gray-600"})})]}),n.jsx("div",{className:"grid grid-cols-7 mb-1",children:Y.map((G,re)=>n.jsx("div",{className:`text-center py-1 text-xs font-semibold ${re===0?"text-red-500":re===6?"text-blue-500":"text-toss-gray-600"}`,children:G},G))}),n.jsx("div",{className:"grid grid-cols-7",children:M.map((G,re)=>{const ce=Q(G.date),P=ve(G.date),U=ee(G.date),le=G.date.getDay();return n.jsxs("button",{onClick:()=>G.isCurrentMonth&&B(ce),disabled:!G.isCurrentMonth,className:`
                                        py-2 rounded transition-all relative
                                        ${G.isCurrentMonth?"hover:bg-toss-gray-100 cursor-pointer":"opacity-30 cursor-default"}
                                        ${U?"bg-toss-blue/10 ring-1 ring-toss-blue":""}
                                    `,children:[n.jsx("span",{className:`
                                        text-sm font-medium
                                        ${G.isCurrentMonth?"":"text-toss-gray-300"}
                                        ${le===0?"text-red-500":le===6?"text-blue-500":"text-toss-gray-900"}
                                        ${P&&G.isCurrentMonth?"text-red-600 font-bold":""}
                                    `,children:G.date.getDate()}),P&&G.isCurrentMonth&&n.jsx("div",{className:"absolute bottom-0.5 left-1/2 transform -translate-x-1/2",children:n.jsx("div",{className:"w-1 h-1 bg-red-500 rounded-full"})})]},re)})}),n.jsxs("div",{className:"mt-3 pt-3 border-t border-toss-gray-100 flex items-center gap-4 text-xs text-toss-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),n.jsx("span",{children:" "})]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("div",{className:"w-2 h-2 bg-toss-blue/30 rounded-full ring-1 ring-toss-blue"}),n.jsx("span",{children:""})]})]})]}),n.jsxs(Et,{className:"lg:col-span-1",children:[n.jsx("h3",{className:"text-base font-bold text-toss-gray-900 mb-4",children:" "}),v.length>0?n.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:v.map(G=>n.jsxs("button",{onClick:()=>D(G),className:"block w-full text-left p-3 rounded-lg hover:bg-toss-gray-50 transition-colors border border-toss-gray-100",children:[n.jsx("p",{className:"font-medium text-toss-gray-900 text-sm truncate",children:G.title||" "}),n.jsx("p",{className:"text-xs text-toss-gray-400 mt-1",children:te(G.meeting_date)})]},G.id))}):n.jsx("p",{className:"text-center text-toss-gray-500 py-8 text-sm",children:"  "})]})]}),n.jsx(dr,{isOpen:u,onClose:()=>d(!1),title:` - ${s}`,children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"text",value:w.title,onChange:G=>k({...w,title:G.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"  "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",value:w.participants,onChange:G=>k({...w,participants:G.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"  (: , )"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  *"}),n.jsx("textarea",{value:w.content,onChange:G=>k({...w,content:G.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all min-h-[200px] resize-none leading-relaxed",placeholder:"  "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"file",ref:C,onChange:F,multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx",className:"hidden"}),n.jsxs("button",{type:"button",onClick:()=>C.current?.click(),className:"w-full px-4 py-3 bg-toss-gray-50 border border-dashed border-toss-gray-300 rounded-xl hover:bg-toss-gray-100 transition-colors flex items-center justify-center gap-2 text-toss-gray-600",children:[n.jsx(ji,{size:18}),n.jsx("span",{children:"  (, )"})]}),w.existingFileUrls.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-xs text-toss-gray-500",children:" "}),w.existingFileUrls.map((G,re)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-toss-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-400"}),n.jsx("span",{className:"text-sm text-toss-gray-700 truncate max-w-[200px]",children:G.name||""})]}),n.jsx("button",{type:"button",onClick:()=>fe(re),className:"p-1 hover:bg-toss-gray-200 rounded",children:n.jsx(mr,{size:14,className:"text-toss-gray-500"})})]},re))]}),w.files.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-xs text-toss-gray-500",children:" "}),w.files.map((G,re)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-blue-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-blue-400"}),n.jsx("span",{className:"text-sm text-toss-gray-700 truncate max-w-[180px]",children:G.name}),n.jsx("span",{className:"text-xs text-toss-gray-400",children:G.size})]}),n.jsx("button",{type:"button",onClick:()=>q(re),className:"p-1 hover:bg-blue-100 rounded",children:n.jsx(mr,{size:14,className:"text-toss-gray-500"})})]},re))]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[x.find(G=>G.meeting_date===s)&&n.jsx(Ye,{variant:"secondary",onClick:I,disabled:g,className:"text-red-500 hover:bg-red-50",children:""}),n.jsx(Ye,{variant:"secondary",onClick:()=>d(!1),className:"flex-1",children:""}),n.jsx(Ye,{onClick:V,disabled:g||N,className:"flex-1",children:N?" ...":g?" ...":""})]})]})}),n.jsx(dr,{isOpen:h,onClose:()=>{m(!1),l(null)},title:" ",children:o&&n.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto -mx-2 px-2",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),n.jsx("p",{className:"text-toss-gray-900",children:te(o.meeting_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900",children:o.participants||"-"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),n.jsx("p",{className:"text-toss-gray-900 font-medium",children:o.title||" "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[150px] whitespace-pre-wrap text-toss-gray-900",children:o.content||"-"})]}),o.file_urls&&o.file_urls.length>0&&n.jsx(RU,{files:o.file_urls}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{m(!1),l(null)},className:"flex-1",children:""}),n.jsx(Ye,{onClick:()=>{m(!1),a(o.meeting_date),k({title:o.title||"",content:o.content||"",participants:o.participants||"",files:[],existingFileUrls:o.file_urls||[]}),d(!0),l(null)},className:"flex-1",children:""})]})]})})]})},Xh=[{key:"blue",bg:"bg-blue-100",text:"text-blue-700",dot:"bg-blue-500"},{key:"purple",bg:"bg-purple-100",text:"text-purple-700",dot:"bg-purple-500"},{key:"green",bg:"bg-green-100",text:"text-green-700",dot:"bg-green-500"},{key:"amber",bg:"bg-amber-100",text:"text-amber-700",dot:"bg-amber-500"},{key:"red",bg:"bg-red-100",text:"text-red-700",dot:"bg-red-500"},{key:"orange",bg:"bg-orange-100",text:"text-orange-700",dot:"bg-orange-500"},{key:"gray",bg:"bg-gray-100",text:"text-gray-700",dot:"bg-gray-500"},{key:"pink",bg:"bg-pink-100",text:"text-pink-700",dot:"bg-pink-500"},{key:"teal",bg:"bg-teal-100",text:"text-teal-700",dot:"bg-teal-500"},{key:"indigo",bg:"bg-indigo-100",text:"text-indigo-700",dot:"bg-indigo-500"}],OU={general:{bg:"bg-blue-100",text:"text-blue-700",dot:"bg-blue-500",label:""},meeting:{bg:"bg-purple-100",text:"text-purple-700",dot:"bg-purple-500",label:""},training:{bg:"bg-green-100",text:"text-green-700",dot:"bg-green-500",label:""},rescue:{bg:"bg-amber-100",text:"text-amber-700",dot:"bg-amber-500",label:""},holiday:{bg:"bg-red-100",text:"text-red-700",dot:"bg-red-500",label:""},event:{bg:"bg-orange-100",text:"text-orange-700",dot:"bg-orange-500",label:""},leave:{bg:"bg-pink-100",text:"text-pink-700",dot:"bg-pink-500",label:""},other:{bg:"bg-gray-100",text:"text-gray-700",dot:"bg-gray-500",label:""}},FU=()=>{const{user:e,isAdmin:t}=Kr(),[r,s]=X.useState(new Date),[a,o]=X.useState(null),[l,u]=X.useState(null),[d,h]=X.useState(!1),[m,x]=X.useState(!1),[y,v]=X.useState(!1),[b,g]=X.useState([]),[_,w]=X.useState([]),[k,N]=X.useState({}),[E,C]=X.useState(!1),[L,O]=X.useState({title:"",location:"",description:"",event_type:"general",start_time:"",end_time:""}),[B,F]=X.useState(OU),[q,fe]=X.useState(!1),[D,V]=X.useState({key:"",label:"",color:"blue"}),[I,ae]=X.useState(null),[Q,te]=X.useState({isOpen:!1,message:"",type:"info"}),ve=(oe,Te="info")=>{te({isOpen:!0,message:oe,type:Te})},ee=async()=>{try{const{data:oe}=await Pe.from("event_types").select("*").order("created_at");if(oe&&oe.length>0){const Te={};oe.forEach(Me=>{const Ae=Xh.find(Re=>Re.key===Me.color)||Xh[0];Te[Me.key]={bg:Ae.bg,text:Ae.text,dot:Ae.dot,label:Me.label}}),F(Te)}}catch(oe){console.error("Error fetching event types:",oe)}},Se=async()=>{if(!D.key.trim()||!D.label.trim()){ve("   .","error");return}try{I?await Pe.from("event_types").update({label:D.label,color:D.color,updated_at:new Date().toISOString()}).eq("key",I):await Pe.from("event_types").insert({key:D.key.toLowerCase().replace(/\s/g,"_"),label:D.label,color:D.color}),await ee(),fe(!1),V({key:"",label:"",color:"blue"}),ae(null),ve(I?"  .":"  .","success")}catch(oe){console.error("Error saving event type:",oe),ve(" .","error")}},J=async oe=>{if(confirm("   ?"))try{await Pe.from("event_types").delete().eq("key",oe),await ee(),ve("  .","success")}catch(Te){console.error("Error deleting event type:",Te),ve(" .","error")}},M=oe=>{const Te=B[oe],Me=Xh.find(Ae=>Ae.bg===Te.bg)?.key||"blue";V({key:oe,label:Te.label,color:Me}),ae(oe),fe(!0)};X.useEffect(()=>{(async()=>{try{const Me=await(await fetch("https://holidays.hyunbin.page/basic.json")).json();N(Me)}catch(Te){console.error("Error fetching holidays:",Te)}})()},[]),X.useEffect(()=>{ee(),Y(),G()},[r]);const Y=async()=>{try{const oe=r.getFullYear(),Te=r.getMonth(),Me=new Date(oe,Te,1).toISOString().split("T")[0],Ae=new Date(oe,Te+1,0).toISOString().split("T")[0],{data:Re}=await Pe.from("events").select("*").gte("event_date",Me).lte("event_date",Ae).neq("event_type","leave").order("event_date",{ascending:!0});g(Re||[])}catch(oe){console.error("Error fetching events:",oe)}},G=async()=>{try{const oe=new Date().toISOString().split("T")[0],{data:Te}=await Pe.from("events").select("*").gte("event_date",oe).neq("event_type","leave").order("event_date",{ascending:!0}).limit(10);w(Te||[])}catch(oe){console.error("Error fetching recent events:",oe)}},re=oe=>{o(oe);const Te=b.filter(Me=>Me.event_date===oe);Te.length>0?(u(Te[0]),x(!0)):(U(),v(!1),h(!0))},ce=()=>{a||o(new Date().toISOString().split("T")[0]),U(),v(!1),h(!0)},P=()=>{l&&(O({title:l.title||"",location:l.location||"",description:l.description||"",event_type:l.event_type||"general",start_time:l.start_time||"",end_time:l.end_time||""}),o(l.event_date),v(!0),x(!1),h(!0))},U=()=>{O({title:"",location:"",description:"",event_type:"general",start_time:"",end_time:""})},le=async()=>{if(!L.title.trim()){alert(" .");return}C(!0);try{if(y&&l){const{error:oe}=await Pe.from("events").update({title:L.title,location:L.location||null,description:L.description||null,event_type:L.event_type,start_time:L.start_time||null,end_time:L.end_time||null,updated_at:new Date().toISOString()}).eq("id",l.id);if(oe)throw oe}else{const{error:oe}=await Pe.from("events").insert([{event_date:a,title:L.title,location:L.location||null,description:L.description||null,event_type:L.event_type,start_time:L.start_time||null,end_time:L.end_time||null,created_by:e?.user_id}]);if(oe)throw oe}await Y(),await G(),h(!1),u(null)}catch(oe){console.error("Error saving event:",oe),alert("   : "+(oe.message||JSON.stringify(oe)))}finally{C(!1)}},ne=async()=>{if(confirm("  ?")){C(!0);try{l&&(await Pe.from("events").delete().eq("id",l.id),await Y(),await G()),x(!1),u(null)}catch(oe){console.error("Error deleting event:",oe),alert("   .")}finally{C(!1)}}},ie=oe=>{const Te=oe.getFullYear(),Me=oe.getMonth(),Ae=new Date(Te,Me,1),et=new Date(Te,Me+1,0).getDate(),He=Ae.getDay(),at=[];for(let mt=0;mt<He;mt++){const At=new Date(Te,Me,-He+mt+1);at.push({date:At,isCurrentMonth:!1})}for(let mt=1;mt<=et;mt++)at.push({date:new Date(Te,Me,mt),isCurrentMonth:!0});const De=42-at.length;for(let mt=1;mt<=De;mt++)at.push({date:new Date(Te,Me+1,mt),isCurrentMonth:!1});return at},H=oe=>{const Te=oe.getFullYear(),Me=String(oe.getMonth()+1).padStart(2,"0"),Ae=String(oe.getDate()).padStart(2,"0");return`${Te}-${Me}-${Ae}`},K=oe=>{const Te=new Date(oe);return`${Te.getFullYear()}. ${Te.getMonth()+1}. ${Te.getDate()}.`},S=oe=>{const Te=H(oe);return b.filter(Me=>Me.event_date===Te)},ue=oe=>{const Te=oe.getFullYear().toString(),Me=H(oe);return k[Te]&&k[Te][Me]?k[Te][Me]:null},z=oe=>{const Te=new Date;return oe.toDateString()===Te.toDateString()},T=()=>{s(new Date(r.getFullYear(),r.getMonth()-1,1))},A=()=>{s(new Date(r.getFullYear(),r.getMonth()+1,1))},W=ie(r),pe=["","","","","","",""],_e=(oe,Te)=>{Te.stopPropagation(),u(oe),o(oe.event_date),x(!0)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{className:"bg-gradient-to-r from-orange-500 to-amber-500 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(M3,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:""}),n.jsx("p",{className:"text-white/90",children:"   "})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs(Et,{className:"lg:col-span-2",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("button",{onClick:T,className:"p-2 hover:bg-toss-gray-100 rounded-full transition-colors",children:n.jsx($a,{size:20})}),n.jsxs("h3",{className:"text-lg font-bold",children:[r.getFullYear()," ",r.getMonth()+1,""]}),n.jsx("button",{onClick:A,className:"p-2 hover:bg-toss-gray-100 rounded-full transition-colors",children:n.jsx(pa,{size:20})})]}),n.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[pe.map((oe,Te)=>n.jsx("div",{className:`text-center text-sm font-medium py-2 ${Te===0?"text-red-500":Te===6?"text-blue-500":"text-toss-gray-500"}`,children:oe},oe)),W.map((oe,Te)=>{const Me=H(oe.date),Ae=S(oe.date);Ae.length>0;const Re=oe.date.getDay(),et=ue(oe.date),He=et!==null;return n.jsxs("div",{onClick:()=>oe.isCurrentMonth&&re(Me),className:`
                                        min-h-[80px] p-1 border border-toss-gray-100 rounded-lg cursor-pointer
                                        transition-all hover:bg-toss-gray-50
                                        ${!oe.isCurrentMonth&&"opacity-40"}
                                        ${z(oe.date)&&"ring-2 ring-toss-blue ring-inset"}
                                        ${He&&oe.isCurrentMonth&&"bg-red-50"}
                                    `,children:[n.jsx("div",{className:`text-sm font-medium mb-1 ${He||Re===0?"text-red-500":Re===6?"text-blue-500":""}`,children:oe.date.getDate()}),He&&n.jsx("div",{className:"text-xs px-1 py-0.5 rounded truncate bg-red-100 text-red-600 mb-0.5",children:et.join(", ")}),n.jsxs("div",{className:"space-y-0.5",children:[Ae.slice(0,He?1:2).map((at,De)=>{const mt=B[at.event_type]||B.general;return n.jsx("div",{onClick:At=>_e(at,At),className:`text-xs px-1 py-0.5 rounded truncate ${mt.bg} ${mt.text}`,children:at.title},De)}),Ae.length>(He?1:2)&&n.jsxs("div",{className:"text-xs text-toss-gray-500 pl-1",children:["+",Ae.length-(He?1:2)," "]})]})]},Te)})]}),n.jsx("div",{className:"mt-4 pt-4 border-t border-toss-gray-100",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex flex-wrap gap-3 text-xs",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),n.jsx("span",{className:"text-toss-gray-600",children:""})]}),Object.entries(B).map(([oe,Te])=>n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${Te.dot}`}),n.jsx("span",{className:"text-toss-gray-600",children:Te.label})]},oe))]}),t&&n.jsxs("button",{onClick:()=>{V({key:"",label:"",color:"blue"}),ae(null),fe(!0)},className:"flex items-center gap-1 text-xs text-toss-gray-500 hover:text-toss-blue transition-colors",children:[n.jsx(yl,{size:14})," "]})]})})]}),n.jsxs(Et,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-bold",children:" "}),n.jsxs(Ye,{variant:"secondary",size:"sm",onClick:ce,className:"flex items-center gap-1",children:[n.jsx(ps,{size:16})," "]})]}),n.jsx("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:_.length===0?n.jsx("p",{className:"text-toss-gray-500 text-center py-8",children:"  ."}):_.map(oe=>{const Te=B[oe.event_type]||B.general;return n.jsx("div",{onClick:()=>{u(oe),o(oe.event_date),x(!0)},className:"p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors cursor-pointer",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:`w-1 h-full min-h-[40px] rounded-full ${Te.dot}`}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${Te.bg} ${Te.text}`,children:Te.label}),n.jsx("span",{className:"text-xs text-toss-gray-500",children:K(oe.event_date)})]}),n.jsx("h4",{className:"font-medium text-toss-gray-900 truncate",children:oe.title}),oe.location&&n.jsxs("p",{className:"text-sm text-toss-gray-500 flex items-center gap-1 mt-1",children:[n.jsx(Ey,{size:12}),oe.location]}),oe.start_time&&n.jsxs("p",{className:"text-sm text-toss-gray-500 flex items-center gap-1 mt-1",children:[n.jsx(ta,{size:12}),oe.start_time,oe.end_time&&` ~ ${oe.end_time}`]})]})]})},oe.id)})})]})]}),n.jsx(dr,{isOpen:d,onClose:()=>h(!1),title:y?" ":"  ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"date",value:a||"",onChange:oe=>o(oe.target.value),className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),n.jsx("input",{type:"text",value:L.title,onChange:oe=>O({...L,title:oe.target.value}),placeholder:" ",className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("select",{value:L.event_type,onChange:oe=>O({...L,event_type:oe.target.value}),className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue",children:Object.entries(B).map(([oe,Te])=>n.jsx("option",{value:oe,children:Te.label},oe))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",value:L.location,onChange:oe=>O({...L,location:oe.target.value}),placeholder:" ",className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"time",value:L.start_time,onChange:oe=>O({...L,start_time:oe.target.value}),className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"time",value:L.end_time,onChange:oe=>O({...L,end_time:oe.target.value}),className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:L.description,onChange:oe=>O({...L,description:oe.target.value}),placeholder:"  ",rows:4,className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue resize-none"})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>h(!1),children:""}),n.jsx(Ye,{className:"flex-1",onClick:le,disabled:E,children:E?" ...":y?"":""})]})]})}),n.jsx(dr,{isOpen:m,onClose:()=>{x(!1),u(null)},title:" ",children:l&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{children:n.jsx("span",{className:`inline-block text-xs px-2 py-1 rounded ${B[l.event_type]?.bg||"bg-gray-100"} ${B[l.event_type]?.text||"text-gray-700"}`,children:B[l.event_type]?.label||""})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900",children:K(l.event_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-lg font-bold text-toss-gray-900",children:l.title})]}),l.location&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-toss-gray-900 flex items-center gap-2",children:[n.jsx(Ey,{size:16,className:"text-toss-gray-400"}),l.location]})]}),(l.start_time||l.end_time)&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-toss-gray-900 flex items-center gap-2",children:[n.jsx(ta,{size:16,className:"text-toss-gray-400"}),l.start_time,l.end_time&&` ~ ${l.end_time}`]})]}),l.description&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),n.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap bg-toss-gray-50 p-3 rounded-xl",children:l.description})]}),a&&b.filter(oe=>oe.event_date===a&&oe.id!==l.id).length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:"   "}),n.jsx("div",{className:"space-y-2",children:b.filter(oe=>oe.event_date===a&&oe.id!==l.id).map(oe=>{const Te=B[oe.event_type]||B.general;return n.jsx("div",{onClick:()=>u(oe),className:"p-2 bg-toss-gray-50 rounded-lg cursor-pointer hover:bg-toss-gray-100 transition-colors",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${Te.dot}`}),n.jsx("span",{className:"text-sm font-medium",children:oe.title})]})},oe.id)})})]}),n.jsxs("div",{className:"flex gap-3 pt-4 border-t border-toss-gray-100",children:[n.jsxs(Ye,{variant:"secondary",className:"flex-1 flex items-center justify-center gap-2",onClick:P,children:[n.jsx(qc,{size:16}),""]}),n.jsxs(Ye,{variant:"secondary",className:"flex-1 flex items-center justify-center gap-2 text-red-500 hover:bg-red-50",onClick:ne,disabled:E,children:[n.jsx(Jt,{size:16}),""]})]})]})}),n.jsx(dr,{isOpen:q,onClose:()=>{fe(!1),ae(null),V({key:"",label:"",color:"blue"})},title:"  ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:Object.entries(B).map(([oe,Te])=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-toss-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${Te.dot}`}),n.jsx("span",{className:"text-sm font-medium",children:Te.label}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["(",oe,")"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>M(oe),className:"p-1 text-toss-gray-500 hover:text-toss-blue transition-colors",children:n.jsx(qc,{size:14})}),n.jsx("button",{onClick:()=>J(oe),className:"p-1 text-toss-gray-500 hover:text-red-500 transition-colors",children:n.jsx(Jt,{size:14})})]})]},oe))})]}),n.jsxs("div",{className:"border-t border-toss-gray-100 pt-4",children:[n.jsx("h4",{className:"text-sm font-medium text-toss-gray-700 mb-3",children:I?" ":"  "}),!I&&n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:"  ()"}),n.jsx("input",{type:"text",value:D.key,onChange:oe=>V({...D,key:oe.target.value}),placeholder:": workshop",className:"w-full px-3 py-2 border border-toss-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue text-sm"})]}),n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:" "}),n.jsx("input",{type:"text",value:D.label,onChange:oe=>V({...D,label:oe.target.value}),placeholder:": ",className:"w-full px-3 py-2 border border-toss-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue text-sm"})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:""}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Xh.map(oe=>n.jsx("button",{onClick:()=>V({...D,color:oe.key}),className:`w-8 h-8 rounded-full ${oe.dot} ${D.color===oe.key?"ring-2 ring-offset-2 ring-toss-blue":""}`},oe.key))})]}),n.jsxs("div",{className:"flex gap-2",children:[I&&n.jsx(Ye,{variant:"secondary",size:"sm",onClick:()=>{ae(null),V({key:"",label:"",color:"blue"})},className:"flex-1",children:""}),n.jsx(Ye,{size:"sm",onClick:Se,className:"flex-1",children:I?"":""})]})]})]})}),Q.isOpen&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:1e4},onClick:()=>te({...Q,isOpen:!1}),children:n.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl animate-in fade-in zoom-in duration-200",onClick:oe=>oe.stopPropagation(),children:n.jsxs("div",{className:"flex flex-col items-center text-center",children:[n.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center mb-4 ${Q.type==="success"?"bg-green-100":Q.type==="error"?"bg-red-100":"bg-blue-100"}`,children:Q.type==="success"?n.jsx(Ws,{className:"w-7 h-7 text-green-600"}):Q.type==="error"?n.jsx(Sn,{className:"w-7 h-7 text-red-600"}):n.jsx(Sn,{className:"w-7 h-7 text-blue-600"})}),n.jsx("p",{className:"text-toss-gray-900 font-medium mb-6 leading-relaxed",children:Q.message}),n.jsx("button",{onClick:()=>te({...Q,isOpen:!1}),className:`w-full py-3 rounded-xl font-medium transition-colors ${Q.type==="success"?"bg-green-500 hover:bg-green-600 text-white":Q.type==="error"?"bg-red-500 hover:bg-red-600 text-white":"bg-toss-blue hover:bg-blue-600 text-white"}`,children:""})]})})})]})},By={full:1,half_am:.5,half_pm:.5,out_1h:.125,out_2h:.25,out_3h:.375,comp:1},_0=15,xd=4,Av=()=>{const{user:e,isAdmin:t,isSubAdmin:r}=Kr(),s=t||r,[a,o]=X.useState(null),[l,u]=X.useState(null),[d,h]=X.useState([]),[m,x]=X.useState([]),[y,v]=X.useState(!0),b=new Date().getFullYear(),g=X.useCallback(async()=>{if(!e?.user_id)return;let{data:q,error:fe}=await Pe.from("annual_leaves").select("*").eq("user_id",e.user_id).eq("year",b).single();if(fe&&fe.code!=="PGRST116"&&console.error("Error fetching annual leave:",fe),!q){const{data:Q,error:te}=await Pe.from("annual_leaves").insert([{user_id:e.user_id,year:b,total_days:_0,used_days:0}]).select().single();te||(q=Q)}const D=`${b}-01-01`,V=`${b}-12-31`,{data:I}=await Pe.from("document_labels").select("id").eq("code",xd).single();let ae=0;if(I){const{data:Q}=await Pe.from("documents").select("leave_days, leave_type").eq("drafter_id",e.user_id).eq("label_id",I.id).eq("attendance_type","leave").eq("status","approved").gte("leave_start_date",D).lte("leave_start_date",V).not("leave_type","is",null).neq("leave_type","comp");ae=(Q||[]).reduce((te,ve)=>te+(ve.leave_days||0),0)}q&&o({...q,used_days:ae})},[e?.user_id,b]),_=X.useCallback(async()=>{if(!e?.user_id)return;const{data:q,error:fe}=await Pe.from("comp_leaves").select("*").eq("user_id",e.user_id).eq("year",b).single();fe&&fe.code!=="PGRST116"&&console.error("Error fetching comp leave:",fe),u(q||null)},[e?.user_id,b]),w=X.useCallback(async()=>{if(!e?.user_id)return;const{data:q,error:fe}=await Pe.from("leave_requests").select("*").eq("user_id",e.user_id).order("created_at",{ascending:!1});fe?console.error("Error fetching leave requests:",fe):h(q||[])},[e?.user_id]),k=X.useCallback(async()=>{if(!s)return;const{data:q,error:fe}=await Pe.from("leave_requests").select("*").eq("status","pending").order("created_at",{ascending:!0});fe?console.error("Error fetching pending requests:",fe):x(q||[])},[s]),N=async({startDate:q,endDate:fe,leaveType:D,reason:V})=>{if(!e?.user_id)return{error:{message:" ."}};let I=0;if(D==="full"||D==="comp"){const te=new Date(q),ve=new Date(fe);I=Math.ceil((ve-te)/(1e3*60*60*24))+1}else I=By[D]||.5;if(D!=="comp"&&a){const te=a.total_days-a.used_days;if(I>te)return{error:{message:`  . (: ${te})`}}}const{data:ae,error:Q}=await Pe.from("leave_requests").insert([{user_id:e.user_id,start_date:q,end_date:fe,leave_type:D,days:I,reason:V,status:"pending"}]).select().single();return Q?console.error("Submit leave request error:",Q):await w(),{data:ae,error:Q}},E=async q=>{const{error:fe}=await Pe.from("leave_requests").delete().eq("id",q).eq("user_id",e.user_id).eq("status","pending");return fe||await w(),{error:fe}},C=async(q,{startDate:fe,endDate:D,leaveType:V,reason:I})=>{if(!e?.user_id)return{error:{message:" ."}};let ae=0;if(V==="full"||V==="comp"){const ve=new Date(fe),ee=new Date(D);ae=Math.ceil((ee-ve)/(1e3*60*60*24))+1}else ae=By[V]||.5;if(V!=="comp"&&a){const ve=a.total_days-a.used_days;if(ae>ve)return{error:{message:`  . (: ${ve})`}}}const{data:Q,error:te}=await Pe.from("leave_requests").update({start_date:fe,end_date:D,leave_type:V,days:ae,reason:I,updated_at:new Date().toISOString()}).eq("id",q).eq("user_id",e.user_id).eq("status","pending").select().single();return te?console.error("Update leave request error:",te):await w(),{data:Q,error:te}},L=async q=>{if(!s)return{error:{message:" ."}};const{data:fe}=await Pe.from("leave_requests").select("*").eq("id",q).single();if(!fe)return{error:{message:"    ."}};const{error:D}=await Pe.from("leave_requests").update({status:"approved",approved_by:e.user_id,updated_at:new Date().toISOString()}).eq("id",q);if(D)return{error:D};if(fe.leave_type==="comp"){const V=fe.days*8,{data:I}=await Pe.from("comp_leaves").select("*").eq("user_id",fe.user_id).eq("year",b).single();I&&await Pe.from("comp_leaves").update({used_hours:I.used_hours+V,updated_at:new Date().toISOString()}).eq("id",I.id)}else{const{data:V}=await Pe.from("annual_leaves").select("*").eq("user_id",fe.user_id).eq("year",b).single();V&&await Pe.from("annual_leaves").update({used_days:V.used_days+fe.days,updated_at:new Date().toISOString()}).eq("id",V.id)}return await k(),{error:null}},O=async(q,fe)=>{if(!s)return{error:{message:" ."}};const{error:D}=await Pe.from("leave_requests").update({status:"rejected",rejected_reason:fe,approved_by:e.user_id,updated_at:new Date().toISOString()}).eq("id",q);return D||await k(),{error:D}},B=async()=>{if(!s)return{data:null,error:{message:" ."}};const{data:q,error:fe}=await Pe.from("annual_leaves").select("*").eq("year",b).order("user_id");return{data:q,error:fe}},F=async(q,fe)=>{if(!s)return{error:{message:" ."}};const{data:D,error:V}=await Pe.from("annual_leaves").upsert({user_id:q,year:b,total_days:fe,updated_at:new Date().toISOString()},{onConflict:"user_id,year"}).select().single();return{data:D,error:V}};return X.useEffect(()=>{const q=async()=>{v(!0),await Promise.all([g(),_(),w(),k()]),v(!1)};e?.user_id?q():v(!1)},[e?.user_id,g,_,w,k]),{annualLeave:a,compLeave:l,leaveRequests:d,pendingRequests:m,loading:y,canManage:s,submitLeaveRequest:N,cancelLeaveRequest:E,updateLeaveRequest:C,approveLeaveRequest:L,rejectLeaveRequest:O,fetchAllAnnualLeaves:B,updateUserAnnualLeave:F,refresh:()=>{g(),_(),w(),k()}}},LU=()=>{const{profile:e,updateProfile:t}=Kr(),{annualLeave:r,compLeave:s,loading:a}=Av(),[o,l]=X.useState(!1),[u,d]=X.useState(!1),[h,m]=X.useState({name:"",rank:"",team:""});X.useEffect(()=>{e&&m({name:e.name||"",rank:e.rank||"",team:e.team||""})},[e]);const x=async y=>{if(y.preventDefault(),!h.name.trim()){alert(" .");return}l(!0),d(!1);try{const{error:v}=await t(h);v?alert("  ."):(d(!0),setTimeout(()=>d(!1),3e3))}catch(v){console.error("Profile update error:",v),alert("    .")}finally{l(!1)}};return n.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[n.jsxs(Vs,{to:"/",className:"inline-flex items-center gap-2 text-toss-gray-500 hover:text-toss-gray-700 transition-colors",children:[n.jsx(tf,{size:20})," "]}),n.jsx(Et,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsx("div",{className:"w-20 h-20 bg-white/20 rounded-full flex items-center justify-center flex-shrink-0",children:n.jsx("span",{className:"text-3xl font-bold",children:h.name?.charAt(0)||e?.name?.charAt(0)||"U"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-2xl font-bold mb-1",children:""}),n.jsxs("p",{className:"text-white/90 flex items-center gap-2",children:[n.jsx(t7,{size:16}),e?.team?`${e.team}  ${e.rank||""}`:e?.user_id||" ..."]})]})]})}),n.jsxs(Et,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:n.jsx(ha,{className:"text-emerald-600",size:20})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-bold text-toss-gray-900",children:" "}),n.jsxs("p",{className:"text-sm text-toss-gray-500",children:[new Date().getFullYear(),""]})]})]}),n.jsxs(Vs,{to:"/leave",className:"flex items-center gap-1 text-sm text-toss-blue hover:text-blue-700 transition-colors",children:[" ",n.jsx(pa,{size:16})]})]}),a?n.jsx("div",{className:"h-20 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-toss-blue border-t-transparent"})}):r?n.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[n.jsxs("div",{className:"text-center p-4 bg-toss-gray-50 rounded-xl",children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[r.total_days,n.jsx("span",{className:"text-sm font-normal text-toss-gray-500",children:""})]})]}),n.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-xl",children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold text-toss-blue",children:[r.used_days,n.jsx("span",{className:"text-sm font-normal text-toss-gray-500",children:""})]})]}),n.jsxs("div",{className:"text-center p-4 bg-emerald-50 rounded-xl",children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:[r.total_days-r.used_days,n.jsx("span",{className:"text-sm font-normal text-toss-gray-500",children:""})]})]}),n.jsxs("div",{className:"text-center p-4 bg-amber-50 rounded-xl",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold text-amber-600",children:[s?Math.floor((s.total_hours-s.used_hours)/8):0,n.jsx("span",{className:"text-sm font-normal text-toss-gray-500",children:""})]})]})]}):n.jsx("div",{className:"text-center py-6 text-toss-gray-500",children:"    "}),r&&n.jsxs("div",{className:"mt-4",children:[n.jsxs("div",{className:"flex justify-between text-xs text-toss-gray-500 mb-2",children:[n.jsx("span",{children:""}),n.jsxs("span",{children:[Math.round(r.used_days/r.total_days*100),"%"]})]}),n.jsx("div",{className:"h-2 bg-toss-gray-100 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-gradient-to-r from-toss-blue to-emerald-500 rounded-full transition-all duration-500",style:{width:`${r.used_days/r.total_days*100}%`}})})]})]}),n.jsxs(Et,{children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:" "}),n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:"       "})]}),n.jsxs("form",{onSubmit:x,className:"space-y-5",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-toss-gray-700 mb-2",children:[n.jsx(cl,{size:16})," *"]}),n.jsx("input",{type:"text",value:h.name,onChange:y=>m({...h,name:y.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl text-toss-gray-900 focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:" ",required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-toss-gray-700 mb-2",children:[n.jsx(Ld,{size:16}),""]}),n.jsx("input",{type:"text",value:h.team,onChange:y=>m({...h,team:y.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl text-toss-gray-900 focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"  (: , )"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-toss-gray-700 mb-2",children:[n.jsx(I3,{size:16}),""]}),n.jsx("input",{type:"text",value:h.rank,onChange:y=>m({...h,rank:y.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl text-toss-gray-900 focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"  (: , , )"})]}),u&&n.jsxs("div",{className:"flex items-center gap-2 text-emerald-700 bg-emerald-50 p-4 rounded-xl border border-emerald-100",children:[n.jsx(A0,{size:20}),n.jsx("span",{className:"font-medium",children:"  "})]}),n.jsx(Ye,{type:"submit",className:"w-full",loading:o,disabled:o||!h.name.trim(),children:o?" ...":""})]})]}),n.jsx(Et,{className:"bg-toss-gray-50",children:n.jsxs("div",{className:"space-y-2",children:[n.jsx("h3",{className:"font-bold text-toss-gray-900 mb-3",children:""}),n.jsx("p",{className:"text-sm text-toss-gray-600 leading-relaxed",children:"   "}),n.jsx("p",{className:"text-sm text-toss-gray-600 leading-relaxed",children:"    ,    "})]})})]})},Hj=()=>{const{user:e,isAdmin:t,isSubAdmin:r}=Kr(),[s,a]=X.useState([]),[o,l]=X.useState([]),[u,d]=X.useState([]),[h,m]=X.useState([]),[x,y]=X.useState([]),[v,b]=X.useState(!0),[g,_]=X.useState(null),w=t||r,k=X.useCallback(async()=>{try{const{data:V,error:I}=await Pe.from("document_labels").select("*").order("code");if(I)throw I;m(V||[])}catch{_("   .")}},[]),N=X.useCallback(async()=>{try{const{data:V,error:I}=await Pe.from("users").select("user_id, name, rank, team").order("name");if(I)throw I;y(V||[])}catch{_("   .")}},[]),E=X.useCallback(async()=>{if(e){b(!0),_(null);try{const{data:V,error:I}=await Pe.from("documents").select("*, document_labels(*)").eq("drafter_id",e.user_id).order("created_at",{ascending:!1});if(I)throw I;a(V||[]);const{data:ae,error:Q}=await Pe.from("documents").select("*, document_labels(*)").order("created_at",{ascending:!1});if(Q)throw Q;if(l(ae||[]),w){const{data:te,error:ve}=await Pe.from("documents").select("*, document_labels(*)").in("status",["pending","chairman_approved"]).order("created_at",{ascending:!1});if(ve)throw ve;d(te||[])}}catch{_("   .")}finally{b(!1)}}},[e,w]);return X.useEffect(()=>{k(),E(),N()},[k,E,N]),{documents:s,allDocuments:o,pendingDocuments:u,labels:h,users:x,loading:v,error:g,canManage:w,createDocument:async V=>{if(!e)return{error:" ."};const I=new Date,ae=`${I.getFullYear()}/${String(I.getMonth()+1).padStart(2,"0")}/${String(I.getDate()).padStart(2,"0")}`,Q=new Date(I.setHours(0,0,0,0)).toISOString(),{count:te}=await Pe.from("documents").select("*",{count:"exact",head:!0}).gte("created_at",Q),ve=`${ae}-${(te||0)+1}`,{data:ee,error:Se}=await Pe.from("documents").insert({label_id:V.label_id,title:V.title,content:V.content,extra_work_hours:V.extra_work_hours||0,doc_number:ve,drafter_id:e.user_id,status:"pending",execution_date:V.execution_date||null,payment_method:V.payment_method||null,expense_items:V.expense_items||null,attachments:V.attachments||null,attendance_type:V.attendance_type||null,leave_type:V.leave_type||null,leave_start_date:V.leave_start_date||null,leave_end_date:V.leave_end_date||null,leave_days:V.leave_days||null,is_private:V.is_private||!1}).select().single();return Se?console.error("Create document error:",Se):E(),{data:ee,error:Se}},updateDocument:async(V,I)=>{if(!e)return{error:" ."};const{data:ae,error:Q}=await Pe.from("documents").update({label_id:I.label_id,title:I.title,content:I.content,extra_work_hours:I.extra_work_hours||0,execution_date:I.execution_date||null,payment_method:I.payment_method||null,expense_items:I.expense_items||null,attachments:I.attachments||null,attendance_type:I.attendance_type||null,leave_type:I.leave_type||null,leave_start_date:I.leave_start_date||null,leave_end_date:I.leave_end_date||null,leave_days:I.leave_days||null,is_private:I.is_private||!1,updated_at:new Date().toISOString()}).eq("id",V).eq("drafter_id",e.user_id).eq("status","pending").select().single();return Q?console.error("Update document error:",Q):E(),{data:ae,error:Q}},approveDocument:async(V,I="chairman")=>{if(!w)return{error:" ."};const{data:ae}=await Pe.from("documents").select("*").eq("id",V).single();if(!ae)return{error:"   ."};if((ae.expense_items||[]).reduce((Se,J)=>Se+(Number(J.amount)||0),0)>=1e6&&I==="chairman"){const{error:Se}=await Pe.from("documents").update({status:"chairman_approved",approver_id:e.user_id,updated_at:new Date().toISOString()}).eq("id",V);return Se?{error:Se}:(E(),{error:null})}const ve={status:"approved",approver_id:e.user_id,approved_at:new Date().toISOString(),updated_at:new Date().toISOString()},{error:ee}=await Pe.from("documents").update(ve).eq("id",V);if(ee)return{error:ee};if(ae.label_id){const{data:Se}=await Pe.from("document_labels").select("code").eq("id",ae.label_id).single();if(Se?.code===4){const J=new Date().getFullYear();if(ae.attendance_type==="overtime"&&ae.extra_work_hours>0){const{data:M}=await Pe.from("comp_leaves").select("*").eq("user_id",ae.drafter_id).eq("year",J).single();M?await Pe.from("comp_leaves").update({total_hours:M.total_hours+ae.extra_work_hours,updated_at:new Date().toISOString()}).eq("id",M.id):await Pe.from("comp_leaves").insert({user_id:ae.drafter_id,document_id:V,total_hours:ae.extra_work_hours,used_hours:0,year:J,description:ae.title})}if(ae.attendance_type==="leave"&&ae.leave_type){if(ae.leave_days>0)if(ae.leave_type==="comp"){const Y=ae.leave_days*8,{data:G}=await Pe.from("comp_leaves").select("*").eq("user_id",ae.drafter_id).eq("year",J).single();G&&await Pe.from("comp_leaves").update({used_hours:G.used_hours+Y,updated_at:new Date().toISOString()}).eq("id",G.id)}else{const{data:Y}=await Pe.from("annual_leaves").select("*").eq("user_id",ae.drafter_id).eq("year",J).single();Y&&await Pe.from("annual_leaves").update({used_days:Y.used_days+ae.leave_days,updated_at:new Date().toISOString()}).eq("id",Y.id)}const{data:M}=await Pe.from("users").select("name, rank").eq("user_id",ae.drafter_id).single();if(M){const Y={full:"",half_am:"",half_pm:"",out_1h:"",out_2h:"",out_3h:"",comp:""};let G="";ae.title?ae.title.includes("")?G="":ae.title.includes("")?G="":ae.title.includes("")?G="":ae.title.includes("")?G="":ae.title.includes("")?G="":ae.title.includes("")?G="":ae.title.includes("")?G="":ae.title.includes("")?G="":ae.leave_type&&(G=Y[ae.leave_type]||""):ae.leave_type&&(G=Y[ae.leave_type]||"");const re=`[${G}] ${M.name}${M.rank?" "+M.rank:""}`;let ce=[];if(ae.leave_start_date){const P=ae.leave_start_date,U=ae.leave_end_date||ae.leave_start_date,le=new Date(P+"T00:00:00"),ne=new Date(U+"T00:00:00");for(let ie=new Date(le);ie<=ne;ie.setDate(ie.getDate()+1)){const H=ie.getFullYear(),K=String(ie.getMonth()+1).padStart(2,"0"),S=String(ie.getDate()).padStart(2,"0");ce.push(`${H}-${K}-${S}`)}}else{const P=new Date(ae.created_at).getFullYear(),U=/(\d{4})/g,le=ae.title.match(U);if(le)for(const ne of le){const ie=ne.substring(0,2),H=ne.substring(2,4);parseInt(ie)>=1&&parseInt(ie)<=12&&parseInt(H)>=1&&parseInt(H)<=31&&ce.push(`${P}-${ie}-${H}`)}}for(const P of ce)await Pe.from("events").insert({event_date:P,title:re,event_type:"leave",description:ae.title,created_by:ae.drafter_id})}}}}return E(),{error:null}},rejectDocument:async(V,I)=>{if(!w)return{error:" ."};const{error:ae}=await Pe.from("documents").update({status:"rejected",approver_id:e.user_id,rejected_reason:I,updated_at:new Date().toISOString()}).eq("id",V);return ae||E(),{error:ae}},deleteDocument:async(V,I=!1)=>{if(I){const{error:Q}=await Pe.from("documents").delete().eq("id",V).eq("drafter_id",e.user_id).eq("status","pending");return Q?console.error("Delete document error:",Q):E(),{error:Q}}if(!w)return{error:" ."};await Pe.from("comp_leaves").delete().eq("document_id",V);const{error:ae}=await Pe.from("documents").delete().eq("id",V);return ae?console.error("Delete document error:",ae):E(),{error:ae}},addLabel:async(V,I)=>{if(!w)return{error:" ."};const{data:ae}=await Pe.from("document_labels").select("code").order("code",{ascending:!1}).limit(1).single(),Q=(ae?.code||0)+1,{error:te}=await Pe.from("document_labels").insert({code:Q,name:V,color:I});return te||k(),{error:te}},updateLabel:async(V,I,ae)=>{if(!w)return{error:" ."};const{error:Q}=await Pe.from("document_labels").update({name:I,color:ae}).eq("id",V);return Q||k(),{error:Q}},deleteLabel:async V=>{if(!w)return{error:" ."};const{error:I}=await Pe.from("document_labels").delete().eq("id",V);return I||k(),{error:I}},refresh:E}},IU=({formData:e,setFormData:t,editingDoc:r,onSubmit:s,onClose:a,submitting:o,attachments:l,setAttachments:u,expenseItems:d,setExpenseItems:h,isAttendanceLabel:m=!0,isExpenseLabel:x=!1,leaveTypes:y,remainingAnnualDays:v,compLeaveDays:b})=>{const[g,_]=X.useState(!1),w=()=>{h([...d,{item:"",category:"",vendor:"",amount:"",note:""}])},k=O=>{d.length!==1&&h(d.filter((B,F)=>F!==O))},N=(O,B,F)=>{const q=[...d];q[O][B]=F,h(q)},E=d.reduce((O,B)=>O+(Number(B.amount)||0),0),C=async O=>{const B=Array.from(O.target.files);if(B.length!==0){_(!0);try{const F=await rf(B,"/intranet/documents");u(q=>[...q,...F])}catch(F){alert("  : "+F.message)}finally{_(!1),O.target.value=""}}},L=O=>{u(B=>B.filter((F,q)=>q!==O))};return n.jsxs(Et,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-lg font-bold text-toss-gray-900",children:r?" ":"  "}),n.jsx("button",{onClick:a,className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",children:n.jsx(mr,{size:20,className:"text-toss-gray-500"})})]}),n.jsxs("form",{onSubmit:s,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:e.title,onChange:O=>t({...e,title:O.target.value}),placeholder:" ",className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("button",{type:"button",onClick:()=>t({...e,is_private:!e.is_private}),className:`flex items-center gap-2 px-4 py-2 rounded-xl border-2 transition-all ${e.is_private?"border-red-400 bg-red-50 text-red-700":"border-toss-gray-200 bg-white text-toss-gray-600 hover:border-toss-gray-300"}`,children:[e.is_private?n.jsx(ll,{size:16}):n.jsx(JF,{size:16}),n.jsx("span",{className:"text-sm font-medium",children:e.is_private?"":""})]}),n.jsx("span",{className:"text-xs text-toss-gray-500",children:e.is_private?"   ":"   "})]}),m&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("button",{type:"button",onClick:()=>t({...e,attendance_type:"overtime",leave_type:"",leave_start_date:"",leave_end_date:""}),className:`p-4 rounded-xl border-2 transition-all text-left ${e.attendance_type==="overtime"?"border-toss-blue bg-blue-50":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(ta,{size:18,className:e.attendance_type==="overtime"?"text-toss-blue":"text-toss-gray-500"}),n.jsx("span",{className:`font-medium ${e.attendance_type==="overtime"?"text-toss-blue":"text-toss-gray-700"}`,children:" "})]}),n.jsx("p",{className:"text-xs text-toss-gray-500",children:",  "})]}),n.jsxs("button",{type:"button",onClick:()=>t({...e,attendance_type:"leave",extra_work_hours:0}),className:`p-4 rounded-xl border-2 transition-all text-left ${e.attendance_type==="leave"?"border-toss-blue bg-blue-50":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(ha,{size:18,className:e.attendance_type==="leave"?"text-toss-blue":"text-toss-gray-500"}),n.jsx("span",{className:`font-medium ${e.attendance_type==="leave"?"text-toss-blue":"text-toss-gray-700"}`,children:" "})]}),n.jsx("p",{className:"text-xs text-toss-gray-500",children:", , "})]})]})]}),e.attendance_type==="overtime"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" ()"}),n.jsx("input",{type:"number",value:e.extra_work_hours,onChange:O=>t({...e,extra_work_hours:O.target.value}),placeholder:"0",step:"0.5",min:"0",className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"}),n.jsx("p",{className:"mt-1 text-xs text-toss-gray-500",children:"* 8 =  1"})]}),e.attendance_type==="leave"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"p-3 bg-toss-gray-50 rounded-xl",children:n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsxs("span",{className:"text-toss-gray-600",children:[" : ",n.jsxs("strong",{className:"text-toss-blue",children:[v,""]})]}),n.jsxs("span",{className:"text-toss-gray-600",children:[" : ",n.jsxs("strong",{className:"text-amber-600",children:[b,""]})]})]})}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:y.map(O=>n.jsxs("button",{type:"button",disabled:O.disabled,onClick:()=>t({...e,leave_type:O.value}),className:`p-3 rounded-xl border transition-all text-left ${O.disabled?"border-toss-gray-100 bg-toss-gray-50 text-toss-gray-400 cursor-not-allowed":e.leave_type===O.value?"border-toss-blue bg-blue-50":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[n.jsx("p",{className:`font-medium text-sm ${O.disabled?"text-toss-gray-400":e.leave_type===O.value?"text-toss-blue":"text-toss-gray-700"}`,children:O.label}),n.jsx("p",{className:"text-xs text-toss-gray-500",children:O.description})]},O.value))})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:e.leave_start_date,onChange:O=>t({...e,leave_start_date:O.target.value,leave_end_date:e.leave_end_date||O.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"date",value:e.leave_end_date,min:e.leave_start_date,onChange:O=>t({...e,leave_end_date:O.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]})]})]})]}),x&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",value:e.execution_date,onChange:O=>t({...e,execution_date:O.target.value}),placeholder:": 2025 1",className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",value:e.payment_method,onChange:O=>t({...e,payment_method:O.target.value}),placeholder:": ",className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700",children:""}),n.jsxs("button",{type:"button",onClick:w,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-toss-blue text-white rounded-lg hover:bg-toss-blue-dark transition-colors",children:[n.jsx(ps,{size:14})," "]})]}),n.jsx("div",{className:"overflow-x-auto border border-toss-gray-200 rounded-xl",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-toss-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/4",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/6",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/6",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/6",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/6",children:""}),n.jsx("th",{className:"px-3 py-2 w-10"})]})}),n.jsxs("tbody",{children:[d.map((O,B)=>n.jsxs("tr",{className:"border-t border-toss-gray-100",children:[n.jsx("td",{className:"p-2",children:n.jsx("input",{type:"text",value:O.item,onChange:F=>N(B,"item",F.target.value),placeholder:"",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm"})}),n.jsx("td",{className:"p-2",children:n.jsx("input",{type:"text",value:O.category,onChange:F=>N(B,"category",F.target.value),placeholder:"",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm"})}),n.jsx("td",{className:"p-2",children:n.jsx("input",{type:"text",value:O.vendor,onChange:F=>N(B,"vendor",F.target.value),placeholder:"",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm"})}),n.jsx("td",{className:"p-2",children:n.jsx("input",{type:"number",value:O.amount,onChange:F=>N(B,"amount",F.target.value),placeholder:"0",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm text-right"})}),n.jsx("td",{className:"p-2",children:n.jsx("input",{type:"text",value:O.note,onChange:F=>N(B,"note",F.target.value),placeholder:"",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm"})}),n.jsx("td",{className:"p-2",children:n.jsx("button",{type:"button",onClick:()=>k(B),disabled:d.length===1,className:`p-1.5 rounded-lg transition-colors ${d.length===1?"text-toss-gray-300 cursor-not-allowed":"text-red-500 hover:bg-red-50"}`,children:n.jsx(Jt,{size:16})})})]},B)),n.jsxs("tr",{className:"border-t-2 border-toss-gray-300 bg-toss-gray-50",children:[n.jsx("td",{colSpan:3,className:"px-3 py-2 text-right font-medium text-toss-gray-700",children:" "}),n.jsxs("td",{className:"px-3 py-2 text-right font-bold text-toss-blue",children:[E.toLocaleString(),""]}),n.jsx("td",{colSpan:2})]})]})]})})]})]}),!x&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("textarea",{value:e.content,onChange:O=>t({...e,content:O.target.value}),placeholder:"  ",rows:4,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 px-4 py-3 bg-toss-gray-50 border border-dashed border-toss-gray-300 rounded-xl cursor-pointer hover:bg-toss-gray-100 transition-colors ${g?"opacity-50 cursor-not-allowed":""}`,children:[g?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-5 h-5 border-2 border-toss-blue border-t-transparent rounded-full animate-spin"}),n.jsx("span",{className:"text-toss-gray-500",children:" ..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(ji,{size:20,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-toss-gray-500",children:" "})]}),n.jsx("input",{type:"file",multiple:!0,onChange:C,disabled:g,className:"hidden"})]}),l.length>0&&n.jsx("div",{className:"space-y-2",children:l.map((O,B)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n.jsx($c,{size:16,className:"text-toss-blue flex-shrink-0"}),n.jsx("span",{className:"text-sm text-toss-gray-700 truncate",children:O.name}),n.jsxs("span",{className:"text-xs text-toss-gray-500 flex-shrink-0",children:["(",(O.size/1024).toFixed(1)," KB)"]})]}),n.jsx("button",{type:"button",onClick:()=>L(B),className:"p-1 hover:bg-blue-100 rounded transition-colors flex-shrink-0",children:n.jsx(mr,{size:16,className:"text-toss-gray-500"})})]},B))})]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Ye,{type:"submit",loading:o,disabled:o,className:"flex-1",children:o?r?" ...":" ...":r?"":" "}),n.jsx(Ye,{type:"button",variant:"secondary",onClick:a,className:"flex-1",children:""})]})]})]})},MU=({documents:e,users:t,labels:r,loading:s,searchTerm:a,setSearchTerm:o,searchFilters:l,setSearchFilters:u,showAdvancedSearch:d,setShowAdvancedSearch:h,onDocClick:m,canManage:x,currentUserId:y})=>{const v=X.useMemo(()=>{const C=new Date().getFullYear();return Array.from({length:5},(L,O)=>C-O)},[]),b=Array.from({length:12},(C,L)=>L+1),g=X.useMemo(()=>e.filter(C=>!(a&&!C.title.toLowerCase().includes(a.toLowerCase())||l.year&&new Date(C.created_at).getFullYear()!==parseInt(l.year)||l.month&&new Date(C.created_at).getMonth()+1!==parseInt(l.month)||l.label_id&&C.label_id!==parseInt(l.label_id)||l.drafter_id&&C.drafter_id!==l.drafter_id||l.status&&C.status!==l.status)),[e,a,l]),_=C=>t.find(O=>O.user_id===C)||{name:"  "},w=C=>{switch(C){case"approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[n.jsx(Ws,{size:12}),""]});case"rejected":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[n.jsx(co,{size:12}),""]});case"chairman_approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium",children:[n.jsx(ta,{size:12})," "]});default:return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[n.jsx(Sn,{size:12}),""]})}},k=C=>new Date(C).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"/").replace(".",""),N=()=>{o(""),u({year:new Date().getFullYear().toString(),month:"",label_id:"",drafter_id:"",status:""})},E=C=>{C.is_private&&!x&&C.drafter_id!==y||m(C)};return n.jsxs(Et,{children:[n.jsxs("div",{className:"flex gap-3 mb-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ho,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),n.jsx("input",{type:"text",value:a,onChange:C=>o(C.target.value),placeholder:" ...",className:"w-full pl-10 pr-4 py-2.5 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>h(!d),className:`flex items-center gap-2 px-4 py-2.5 rounded-xl border transition-colors ${d?"bg-toss-blue text-white border-toss-blue":"bg-white border-toss-gray-200 text-toss-gray-700 hover:bg-toss-gray-50"}`,children:[n.jsx(GF,{size:16}),"",d?n.jsx(_i,{size:16}):n.jsx($n,{size:16})]})]}),d&&n.jsxs("div",{className:"p-4 bg-toss-gray-50 rounded-xl mb-4 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),n.jsxs("select",{value:l.year,onChange:C=>u({...l,year:C.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:""}),v.map(C=>n.jsxs("option",{value:C,children:[C,""]},C))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),n.jsxs("select",{value:l.month,onChange:C=>u({...l,month:C.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:""}),b.map(C=>n.jsxs("option",{value:C,children:[C,""]},C))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),n.jsxs("select",{value:l.label_id,onChange:C=>u({...l,label_id:C.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:""}),r.map(C=>n.jsx("option",{value:C.id,children:C.name},C.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),n.jsxs("select",{value:l.drafter_id,onChange:C=>u({...l,drafter_id:C.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:""}),t.map(C=>n.jsx("option",{value:C.user_id,children:C.name},C.user_id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),n.jsxs("select",{value:l.status,onChange:C=>u({...l,status:C.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"pending",children:""}),n.jsx("option",{value:"chairman_approved",children:" "}),n.jsx("option",{value:"approved",children:""}),n.jsx("option",{value:"rejected",children:""})]})]})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{onClick:N,className:"text-sm text-toss-gray-500 hover:text-toss-gray-700",children:" "})})]}),n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-lg font-bold text-toss-gray-900",children:" "}),n.jsxs("span",{className:"text-sm text-toss-gray-500",children:[" ",g.length,""]})]}),s?n.jsx("div",{className:"py-12 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-toss-blue border-t-transparent"})}):g.length===0?n.jsxs("div",{className:"py-12 text-center text-toss-gray-500",children:[n.jsx(Gs,{className:"mx-auto mb-3 text-toss-gray-300",size:48}),n.jsx("p",{children:"  "})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),n.jsx("tbody",{children:g.map(C=>{const L=C.is_private&&!x&&C.drafter_id!==y,O=_(C.drafter_id);return n.jsxs("tr",{onClick:()=>E(C),className:`border-b border-toss-gray-100 ${L?"bg-toss-gray-50 cursor-not-allowed":"hover:bg-toss-gray-50 cursor-pointer"}`,children:[n.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:k(C.created_at)}),n.jsx("td",{className:"py-3 px-4",children:C.document_labels&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:C.document_labels.color+"20",color:C.document_labels.color},children:C.document_labels.name})}),n.jsxs("td",{className:"py-3 px-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[C.is_private&&n.jsx(ll,{size:14,className:L?"text-red-400":"text-toss-gray-400"}),n.jsx("p",{className:`font-medium truncate max-w-xs ${L?"text-toss-gray-400":"text-toss-gray-900"}`,children:L?" ":C.title})]}),!L&&C.attachments&&C.attachments.length>0&&n.jsxs("p",{className:"text-xs text-toss-gray-500 flex items-center gap-1",children:[n.jsx($c,{size:12})," ",C.attachments.length,""]})]}),n.jsxs("td",{className:"py-3 px-4",children:[n.jsx("span",{className:"text-sm text-toss-gray-700",children:O.name}),O.rank&&n.jsx("span",{className:"text-xs text-toss-gray-500 ml-1",children:O.rank})]}),n.jsx("td",{className:"py-3 px-4 text-center",children:w(C.status)})]},C.id)})})]})}),n.jsx("div",{className:"md:hidden space-y-3",children:g.map(C=>{const L=C.is_private&&!x&&C.drafter_id!==y,O=_(C.drafter_id);return n.jsxs("div",{onClick:()=>E(C),className:`p-4 rounded-xl ${L?"bg-toss-gray-100 cursor-not-allowed":"bg-toss-gray-50 cursor-pointer active:bg-toss-gray-100"}`,children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[C.document_labels&&n.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium",style:{backgroundColor:C.document_labels.color+"20",color:C.document_labels.color},children:C.document_labels.name}),w(C.status)]}),n.jsx("span",{className:"text-xs text-toss-gray-400",children:k(C.created_at)})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[C.is_private&&n.jsx(ll,{size:14,className:L?"text-red-400":"text-toss-gray-400"}),n.jsx("p",{className:`font-medium ${L?"text-toss-gray-400":"text-toss-gray-900"}`,children:L?" ":C.title})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm text-toss-gray-600",children:[O.name,O.rank&&n.jsx("span",{className:"text-toss-gray-400 ml-1",children:O.rank})]}),!L&&C.attachments&&C.attachments.length>0&&n.jsxs("span",{className:"text-xs text-toss-gray-500 flex items-center gap-1",children:[n.jsx($c,{size:12}),C.attachments.length]})]})]},C.id)})})]})]})},BU=({doc:e,onClose:t,onApprove:r,onReject:s,onEdit:a,onDelete:o,canManage:l,currentUserId:u,processing:d,showRejectModal:h,setShowRejectModal:m,rejectReason:x,setRejectReason:y,showDeleteModal:v,setShowDeleteModal:b,users:g,leaveTypes:_})=>{if(!e)return null;const w=E=>g.find(L=>L.user_id===E)||{name:"  "},k=E=>{const C=_.find(L=>L.value===E);return C?C.label:E},N=E=>{switch(E){case"approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[n.jsx(Ws,{size:12}),""]});case"rejected":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[n.jsx(co,{size:12}),""]});case"chairman_approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium",children:[n.jsx(ta,{size:12})," "]});default:return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[n.jsx(Sn,{size:12}),""]})}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:t,children:n.jsx("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:E=>E.stopPropagation(),children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:" "}),n.jsx("button",{onClick:t,className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",children:n.jsx(mr,{size:20,className:"text-toss-gray-500"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[N(e.status),e.document_labels&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:e.document_labels.color+"20",color:e.document_labels.color},children:e.document_labels.name}),e.is_private&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[n.jsx(ll,{size:12}),""]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.doc_number&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:e.doc_number})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"font-medium text-toss-gray-900",children:[w(e.drafter_id).name,w(e.drafter_id).rank&&n.jsx("span",{className:"text-toss-gray-500 font-normal ml-1",children:w(e.drafter_id).rank})]})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"font-bold text-toss-gray-900 text-lg",children:e.title})]}),e.content&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:e.content})]}),e.extra_work_hours>0&&n.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:n.jsxs("p",{className:"text-sm text-toss-blue font-medium",children:[": ",e.extra_work_hours," ( ",(e.extra_work_hours/8).toFixed(1),")"]})}),e.attendance_type==="leave"&&e.leave_type&&n.jsxs("div",{className:"p-3 bg-emerald-50 rounded-lg",children:[n.jsxs("p",{className:"text-sm text-emerald-700 font-medium mb-1",children:[k(e.leave_type)," "]}),n.jsxs("p",{className:"text-sm text-emerald-600",children:[e.leave_start_date===e.leave_end_date?new Date(e.leave_start_date).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}):`${new Date(e.leave_start_date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})} ~ ${new Date(e.leave_end_date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})}`,e.leave_days&&` (${e.leave_days})`]})]}),e.attachments&&e.attachments.length>0&&n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-toss-gray-500 mb-2",children:[" (",e.attachments.length,")"]}),n.jsx("div",{className:"space-y-2",children:e.attachments.map((E,C)=>n.jsxs("a",{href:E.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-lg hover:bg-toss-gray-100 transition-colors",children:[n.jsx($c,{size:16,className:"text-toss-blue"}),n.jsx("span",{className:"text-sm text-toss-gray-700 flex-1",children:E.name}),n.jsx(Tc,{size:14,className:"text-toss-gray-400"})]},C))})]}),e.status==="rejected"&&e.rejected_reason&&n.jsxs("div",{className:"p-3 bg-red-50 rounded-lg",children:[n.jsx("p",{className:"text-sm text-red-600 font-medium mb-1",children:" "}),n.jsx("p",{className:"text-red-700",children:e.rejected_reason})]}),n.jsxs("div",{className:"pt-4 border-t border-toss-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500",children:[n.jsx(ta,{size:14}),new Date(e.created_at).toLocaleString("ko-KR")," "]}),e.approved_at&&n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500 mt-1",children:[n.jsx(ta,{size:14}),new Date(e.approved_at).toLocaleString("ko-KR")," "]})]})]}),n.jsxs("div",{className:"mt-6 space-y-3",children:[e.status==="pending"&&l&&!h&&n.jsxs("div",{className:"flex gap-3",children:[n.jsxs(Ye,{onClick:r,className:"flex-1 bg-emerald-500 hover:bg-emerald-600",disabled:d,children:[d?n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-1"}):n.jsx(Ws,{size:16,className:"mr-1"}),""]}),n.jsxs(Ye,{onClick:()=>m(!0),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",disabled:d,children:[n.jsx(co,{size:16,className:"mr-1"}),""]})]}),h&&n.jsxs("div",{className:"p-4 bg-red-50 rounded-lg space-y-3",children:[n.jsx("p",{className:"text-sm font-medium text-red-700",children:"  "}),n.jsx("textarea",{value:x,onChange:E=>y(E.target.value),placeholder:"  ",rows:2,className:"w-full px-3 py-2 bg-white border border-red-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Ye,{onClick:s,className:"flex-1 bg-red-500 hover:bg-red-600",disabled:d||!x.trim(),children:d?" ...":" "}),n.jsx(Ye,{onClick:()=>{m(!1),y("")},variant:"secondary",className:"flex-1",disabled:d,children:""})]})]}),e.status==="pending"&&e.drafter_id===u&&!h&&!v&&n.jsxs("div",{className:"flex gap-3",children:[n.jsxs(Ye,{onClick:()=>a(e),variant:"secondary",className:"flex-1",children:[n.jsx(qc,{size:16,className:"mr-1"}),""]}),n.jsxs(Ye,{onClick:()=>b(!0),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",children:[n.jsx(Jt,{size:16,className:"mr-1"}),""]})]}),e.status!=="pending"&&l&&!h&&!v&&n.jsxs(Ye,{onClick:()=>b(!0),variant:"secondary",className:"w-full text-red-500 border-red-200 hover:bg-red-50",children:[n.jsx(Jt,{size:16,className:"mr-1"}),""]}),v&&n.jsxs("div",{className:"p-4 bg-red-50 rounded-lg space-y-3",children:[n.jsx("p",{className:"text-sm font-medium text-red-700",children:e.status==="pending"?"  ?":`  ?
    .`}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Ye,{onClick:o,className:"flex-1 bg-red-500 hover:bg-red-600",disabled:d,children:d?" ...":""}),n.jsx(Ye,{onClick:()=>b(!1),variant:"secondary",className:"flex-1",disabled:d,children:""})]})]}),!h&&!v&&n.jsx(Ye,{onClick:t,variant:"secondary",className:"w-full",children:""})]})]})})})},PU=({users:e,allLeaves:t,onSaveTotalDays:r})=>{const[s,a]=X.useState(""),[o,l]=X.useState(null),[u,d]=X.useState(""),[h,m]=X.useState(null),x=g=>t.find(_=>_.user_id===g),y=X.useMemo(()=>s?e.filter(g=>g.name?.toLowerCase().includes(s.toLowerCase())||g.team?.toLowerCase().includes(s.toLowerCase())):e,[e,s]),v=(g,_)=>{l(g),d(_.toString())},b=async g=>{const _=parseFloat(u);if(isNaN(_)||_<0){alert("   ");return}m(g);try{await r(g,_),l(null)}catch{alert("   ")}finally{m(null)}};return n.jsxs(Et,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 flex items-center gap-2",children:[n.jsx(Ld,{className:"text-toss-blue",size:20}),"  "]}),n.jsxs("div",{className:"relative",children:[n.jsx(ho,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400",size:16}),n.jsx("input",{type:"text",value:s,onChange:g=>a(g.target.value),placeholder:"   ",className:"pl-9 pr-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:" "}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),n.jsx("tbody",{children:y.map(g=>{const _=x(g.user_id),w=_?.total_days||15,k=_?.used_days||0,N=w-k,E=o===g.user_id,C=h===g.user_id;return n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50",children:[n.jsxs("td",{className:"py-3 px-4",children:[n.jsx("p",{className:"font-medium text-toss-gray-900",children:g.name}),g.rank&&n.jsx("p",{className:"text-xs text-toss-gray-500",children:g.rank})]}),n.jsx("td",{className:"py-3 px-4 text-toss-gray-600",children:g.team||"-"}),n.jsx("td",{className:"py-3 px-4 text-center",children:E?n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("input",{type:"number",value:u,onChange:L=>d(L.target.value),step:"0.5",min:"0",className:"w-16 px-2 py-1 text-center bg-white border border-toss-gray-300 rounded-lg text-sm",autoFocus:!0}),n.jsx("button",{onClick:()=>b(g.user_id),disabled:C,className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded",children:C?n.jsx("div",{className:"w-4 h-4 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin"}):n.jsx(jy,{size:16})}),n.jsx("button",{onClick:()=>l(null),disabled:C,className:"p-1 text-toss-gray-500 hover:bg-toss-gray-100 rounded",children:n.jsx(mr,{size:16})})]}):n.jsxs("button",{onClick:()=>v(g.user_id,w),className:"inline-flex items-center gap-1 text-toss-gray-900 hover:text-toss-blue transition-colors group",children:[w,"",n.jsx(qc,{size:14,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})}),n.jsxs("td",{className:"py-3 px-4 text-center text-toss-blue font-medium",children:[k,""]}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("span",{className:`font-bold ${N<=3?"text-red-500":"text-emerald-600"}`,children:[N,""]})})]},g.user_id)})})]})}),y.length===0&&n.jsx("div",{className:"py-12 text-center text-toss-gray-500",children:"  "})]})},UU=()=>{const{user:e,isAdmin:t,isSubAdmin:r}=Kr(),s=t||r,{allDocuments:a,labels:o,users:l,loading:u,createDocument:d,updateDocument:h,deleteDocument:m,approveDocument:x,rejectDocument:y,refresh:v}=Hj(),{annualLeave:b,compLeave:g}=Av(),[_,w]=X.useState(!1),[k,N]=X.useState(!1),[E,C]=X.useState([]),[L,O]=X.useState(null),[B,F]=X.useState(null),[q,fe]=X.useState({label_id:"",title:"",content:"",extra_work_hours:0,execution_date:"",payment_method:"",attendance_type:"",leave_type:"",leave_start_date:"",leave_end_date:"",is_private:!1}),[D,V]=X.useState([{item:"",category:"",vendor:"",amount:"",note:""}]),[I,ae]=X.useState(""),[Q,te]=X.useState(!1),[ve,ee]=X.useState({year:new Date().getFullYear().toString(),month:"",label_id:"",drafter_id:"",status:""}),[Se,J]=X.useState("list"),[M,Y]=X.useState([]),[G,re]=X.useState(!1),[ce,P]=X.useState(!1),[U,le]=X.useState(""),[ne,ie]=X.useState(!1),H=o.find(Ae=>Ae.code===4),K=g&&g.total_hours-g.used_hours>=8,S=g?Math.floor((g.total_hours-g.used_hours)/8):0,ue=b?b.total_days-b.used_days:0,z=[{value:"full",label:"",description:"1 ",days:1},{value:"half_am",label:" ",description:"0.5 ",days:.5},{value:"half_pm",label:" ",description:"0.5 ",days:.5},{value:"out_1h",label:"/ 1",description:"0.125 ",days:.125},{value:"out_2h",label:"/ 2",description:"0.25 ",days:.25},{value:"out_3h",label:"/ 3",description:"0.375 ",days:.375},{value:"comp",label:"",description:K?`${S} `:" ",days:1,disabled:!K}],T=X.useCallback(async()=>{if(s)try{const Ae=new Date().getFullYear(),Re=`${Ae}-01-01`,et=`${Ae}-12-31`,{data:He,error:at}=await Pe.from("annual_leaves").select("*").eq("year",Ae);if(at)throw at;const{data:De}=await Pe.from("document_labels").select("id").eq("code",xd).single();let mt=[];if(De){const{data:Ct}=await Pe.from("documents").select("drafter_id, leave_days, leave_type").eq("label_id",De.id).eq("attendance_type","leave").eq("status","approved").gte("leave_start_date",Re).lte("leave_start_date",et).not("leave_type","is",null).neq("leave_type","comp");mt=Ct||[]}const At={};mt.forEach(Ct=>{At[Ct.drafter_id]=(At[Ct.drafter_id]||0)+(Ct.leave_days||0)});const wt=(He||[]).map(Ct=>({...Ct,used_days:At[Ct.user_id]||0}));Y(wt)}catch(Ae){console.error("   :",Ae)}},[s]);X.useEffect(()=>{Se==="leaveSettings"&&s&&T()},[Se,s,T]);const A=async(Ae,Re)=>{const et=new Date().getFullYear(),He=M.find(at=>at.user_id===Ae);He?await Pe.from("annual_leaves").update({total_days:Re,updated_at:new Date().toISOString()}).eq("id",He.id):await Pe.from("annual_leaves").insert({user_id:Ae,year:et,total_days:Re,used_days:0}),await T()},W=async()=>{if(!(!L||!s)){re(!0);try{const{error:Ae}=await x(L.id);Ae?alert(" : "+Ae):(alert("."),O(null),v())}catch(Ae){console.error(" :",Ae),alert("   ")}finally{re(!1)}}},pe=async()=>{if(!L||!s||!U.trim()){alert("  ");return}re(!0);try{const{error:Ae}=await y(L.id,U);Ae?alert(" : "+Ae):(alert("."),O(null),P(!1),le(""),v())}catch(Ae){console.error(" :",Ae),alert("   ")}finally{re(!1)}},_e=async()=>{if(L){re(!0);try{const{error:Ae}=await m(L.id,!0);Ae?alert(" ."):(O(null),ie(!1))}catch(Ae){console.error(" :",Ae),alert("   ")}finally{re(!1)}}},oe=async Ae=>{if(Ae.preventDefault(),!H){alert("    .");return}if(!q.title.trim()){alert(" .");return}if(!q.attendance_type){alert("  .");return}if(q.attendance_type==="leave"){if(!q.leave_type){alert("  .");return}if(!q.leave_start_date){alert(" .");return}}N(!0);let Re=0;if(q.attendance_type==="leave"){const at=z.find(De=>De.value===q.leave_type);if(q.leave_type==="full"||q.leave_type==="comp"){const De=new Date(q.leave_start_date),mt=new Date(q.leave_end_date||q.leave_start_date);Re=Math.ceil((mt-De)/(1e3*60*60*24))+1}else Re=at?.days||.5}const et={label_id:H.id,title:q.title.trim(),content:q.content.trim(),extra_work_hours:q.attendance_type==="overtime"&&parseFloat(q.extra_work_hours)||0,attachments:E.length>0?E:null,execution_date:null,payment_method:null,expense_items:null,attendance_type:q.attendance_type,leave_type:q.attendance_type==="leave"?q.leave_type:null,leave_start_date:q.attendance_type==="leave"?q.leave_start_date:null,leave_end_date:q.attendance_type==="leave"?q.leave_end_date||q.leave_start_date:null,leave_days:q.attendance_type==="leave"?Re:null,is_private:q.is_private};let He;if(B?He=(await h(B.id,et)).error:He=(await d(et)).error,N(!1),He){console.error("Document error:",He);const at=typeof He=="string"?He:He.message||JSON.stringify(He);alert((B?" : ":"  : ")+at)}else Me()},Te=Ae=>{F(Ae),fe({label_id:Ae.label_id||"",title:Ae.title||"",content:Ae.content||"",extra_work_hours:Ae.extra_work_hours||0,execution_date:Ae.execution_date||"",payment_method:Ae.payment_method||"",attendance_type:Ae.attendance_type||"",leave_type:Ae.leave_type||"",leave_start_date:Ae.leave_start_date||"",leave_end_date:Ae.leave_end_date||"",is_private:Ae.is_private||!1}),C(Ae.attachments||[]),V(Ae.expense_items?.length>0?Ae.expense_items:[{item:"",category:"",vendor:"",amount:"",note:""}]),w(!0),O(null)},Me=()=>{w(!1),F(null),fe({label_id:"",title:"",content:"",extra_work_hours:0,execution_date:"",payment_method:"",attendance_type:"",leave_type:"",leave_start_date:"",leave_end_date:"",is_private:!1}),C([]),V([{item:"",category:"",vendor:"",amount:"",note:""}])};return n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[n.jsxs(Vs,{to:"/",className:"inline-flex items-center gap-2 text-toss-gray-500 hover:text-toss-gray-700 transition-colors",children:[n.jsx(tf,{size:20})," "]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-700 rounded-2xl flex items-center justify-center",children:n.jsx(Gs,{className:"text-white",size:28})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),n.jsx("p",{className:"text-toss-gray-500",children:" "})]})]}),Se==="list"&&n.jsxs(Ye,{onClick:()=>w(!_),children:[n.jsx(ps,{size:18,className:"mr-1"}),""]})]}),s&&n.jsxs("div",{className:"flex gap-2 border-b border-toss-gray-200",children:[n.jsx("button",{onClick:()=>J("list"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${Se==="list"?"border-toss-blue text-toss-blue":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "}),n.jsxs("button",{onClick:()=>J("leaveSettings"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${Se==="leaveSettings"?"border-toss-blue text-toss-blue":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:[n.jsx(yl,{size:16,className:"inline mr-1"})," "]})]}),Se==="list"&&n.jsxs(n.Fragment,{children:[_&&n.jsx(IU,{formData:q,setFormData:fe,editingDoc:B,onSubmit:oe,onClose:Me,submitting:k,attachments:E,setAttachments:C,expenseItems:D,setExpenseItems:V,isAttendanceLabel:!0,isExpenseLabel:!1,leaveTypes:z,remainingAnnualDays:ue,compLeaveDays:S}),n.jsx(MU,{documents:a,users:l,labels:o,loading:u,searchTerm:I,setSearchTerm:ae,searchFilters:ve,setSearchFilters:ee,showAdvancedSearch:Q,setShowAdvancedSearch:te,onDocClick:O,canManage:s,currentUserId:e?.user_id})]}),Se==="leaveSettings"&&s&&n.jsx(PU,{users:l,allLeaves:M,onSaveTotalDays:A}),n.jsx(BU,{doc:L,onClose:()=>O(null),onApprove:W,onReject:pe,onEdit:Te,onDelete:_e,canManage:s,currentUserId:e?.user_id,processing:G,showRejectModal:ce,setShowRejectModal:P,rejectReason:U,setRejectReason:le,showDeleteModal:ne,setShowDeleteModal:ie,users:l,leaveTypes:z})]})},zU={full:"",half_am:" ",half_pm:" ",out_1h:"/ 1",out_2h:"/ 2",out_3h:"/ 3"},Ek=(e,t,r="",s=1)=>{const a=new Date(e.start_date),o=new Date(e.end_date),l=new Date(e.created_at),u=g=>`${g.getFullYear()} ${g.getMonth()+1} ${g.getDate()}`,d=g=>{const _=g.getFullYear(),w=String(g.getMonth()+1).padStart(2,"0"),k=String(g.getDate()).padStart(2,"0");return`${_}/${w}/${k}`},h=g=>{const _=String(g.getMonth()+1).padStart(2,"0"),w=String(g.getDate()).padStart(2,"0");return`${_}${w}`},x=`${d(l)} -${s} `,y=zU[e.leave_type]||"",v=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title> - ${t.name}</title>
    <style>
        @page {
            size: A4;
            margin: 20mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', sans-serif;
            font-size: 14px;
            line-height: 1.5;
            color: #000;
            background: #fff;
        }
        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 15mm 20mm;
            margin: 0 auto;
            background: #fff;
        }

        /*   */
        .header {
            position: relative;
            margin-bottom: 15px;
            padding-top: 10px;
        }
        .title {
            text-align: center;
            font-size: 22px;
            font-weight: bold;
            text-decoration: underline;
            padding-bottom: 15px;
        }

        /*  -   */
        .approval-box {
            position: absolute;
            top: 0;
            right: 0;
        }
        .approval-table {
            border-collapse: collapse;
            font-size: 11px;
        }
        .approval-table td {
            border: 1px solid #000;
            text-align: center;
            padding: 4px 12px;
            height: 22px;
        }
        .approval-table .label-cell {
            width: 30px;
            padding: 4px 6px;
        }
        .approval-table .name-cell {
            width: 55px;
        }

        /*  */
        .doc-number {
            font-size: 12px;
            margin-bottom: 10px;
        }

        /*   */
        .main-box {
            border: 1px solid #000;
            padding: 20px 25px;
            min-height: 200mm;
            position: relative;
        }

        /* // */
        .info-line {
            font-size: 14px;
            margin-bottom: 12px;
        }

        /*  */
        .statement {
            font-size: 14px;
            margin: 25px 0;
        }

        /*   */
        .inner-box {
            border: 1px solid #000;
            width: 65%;
            margin: 30px auto;
            padding: 15px 20px;
        }
        .inner-line {
            font-size: 13px;
            margin-bottom: 10px;
        }
        .date-line {
            font-size: 13px;
            margin-bottom: 5px;
        }
        .date-line span {
            margin-left: 20px;
        }
        .date-sub {
            font-size: 13px;
            margin-left: 65px;
            margin-bottom: 5px;
        }
        .total-days {
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            margin-top: 20px;
        }

        /*  / */
        .footer-area {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            text-align: center;
        }
        .footer-date {
            font-size: 14px;
            margin-bottom: 15px;
        }
        .org-name {
            font-size: 20px;
            font-weight: bold;
            color: #1a4ed8;
        }

        /*   */
        .page-num {
            position: absolute;
            bottom: 10px;
            left: 20px;
            font-size: 12px;
        }

        @media print {
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .page { margin: 0; padding: 15mm 20mm; }
        }
    </style>
</head>
<body>
    <div class="page">
        <div class="header">
            <div class="title">(${h(l)})</div>

            <div class="approval-box">
                <table class="approval-table">
                    <tr>
                        <td rowspan="3" class="label-cell"><br></td>
                        <td class="name-cell"></td>
                        <td class="name-cell"></td>
                    </tr>
                    <tr>
                        <td class="name-cell">${t.name||""}</td>
                        <td class="name-cell">${r}</td>
                    </tr>
                    <tr>
                        <td class="name-cell">${d(l)}</td>
                        <td class="name-cell">${d(l)}</td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="doc-number"> : ${x}</div>

        <div class="main-box">
            <div class="info-line"> : ${t.team||"-"}</div>
            <div class="info-line"> : ${t.rank||"-"}</div>
            <div class="info-line"> : ${t.name||"-"}</div>

            <div class="statement">
                     (${y}) .
            </div>

            <div class="inner-box">
                <div class="inner-line"> : ${e.reason||""}</div>
                <div class="inner-line"> :</div>
                <div class="date-line"> :<span>1. ${u(a)}</span></div>
                <div class="date-sub">${u(o)}</div>
                <div class="total-days">( ${e.days})</div>
            </div>

            <div class="footer-area">
                <div class="footer-date">${u(l)}</div>
                <div class="org-name"> </div>
            </div>
        </div>

        <div class="page-num">7</div>
    </div>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,b=window.open("","_blank","width=900,height=700");b.document.write(v),b.document.close()},K1=(e,t,r="",s="")=>{const a=new Date(e.created_at),o=e.approved_at?new Date(e.approved_at):a,l=b=>`${b.getFullYear()} ${String(b.getMonth()+1).padStart(2,"0")} ${String(b.getDate()).padStart(2,"0")}`,u=b=>{const g=b.getFullYear(),_=String(b.getMonth()+1).padStart(2,"0"),w=String(b.getDate()).padStart(2,"0");return`${g}/${_}/${w}`},d=()=>{const b=e.expense_items||[];return b.length===0?`
                <tr>
                    <td colspan="5" style="padding: 20px; text-align: center; color: #666;"> </td>
                </tr>
            `:b.map(g=>`
            <tr>
                <td style="padding: 10px 8px; text-align: center; border: 1px solid #000; vertical-align: middle;">${g.item||""}</td>
                <td style="padding: 10px 8px; text-align: center; border: 1px solid #000; vertical-align: middle;">${g.category||""}</td>
                <td style="padding: 10px 8px; text-align: center; border: 1px solid #000; vertical-align: middle;">${g.vendor||""}</td>
                <td style="padding: 10px 8px; text-align: right; border: 1px solid #000; vertical-align: middle;">${g.amount?Number(g.amount).toLocaleString():""}</td>
                <td style="padding: 10px 8px; text-align: center; border: 1px solid #000; vertical-align: middle;">${g.note||""}</td>
            </tr>
        `).join("")},h=(e.expense_items||[]).reduce((b,g)=>b+(Number(g.amount)||0),0),m=b=>{const g=["","","",""],_=["","","",""],w=["","","","","","","","","",""];if(b===0)return"";let k="",N=0;for(;b>0;){const E=b%1e4;if(E>0){let C="",L=E,O=0;for(;L>0;){const B=L%10;B>0&&(O===0?C=w[B]+C:C=(B===1?"":w[B])+_[O]+C),L=Math.floor(L/10),O++}k=C+g[N]+k}b=Math.floor(b/1e4),N++}return" "+k+""},x=h>=1e6,y=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title> - ${e.title}</title>
    <style>
        @page {
            size: A4;
            margin: 15mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', sans-serif;
            font-size: 13px;
            line-height: 1.4;
            color: #000;
            background: #fff;
        }
        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 10mm 15mm;
            margin: 0 auto;
            background: #fff;
        }

        /*   */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        /*  */
        .main-title {
            font-size: 22px;
            font-weight: bold;
            text-decoration: underline;
            padding-top: 10px;
        }

        /*  */
        .approval-box {
            border-collapse: collapse;
        }
        .approval-box td {
            border: 1px solid #000;
            text-align: center;
            font-size: 11px;
        }
        .approval-box .header-row td {
            padding: 4px 8px;
            background: #fff;
        }
        .approval-box .label-cell {
            width: 30px;
            writing-mode: vertical-lr;
            text-orientation: upright;
            letter-spacing: 2px;
            padding: 8px 4px;
            font-weight: normal;
        }
        .approval-box .position-cell {
            width: 55px;
            padding: 3px 5px;
        }
        .approval-box .name-cell {
            width: 55px;
            padding: 3px 5px;
        }
        .approval-box .date-cell {
            width: 55px;
            padding: 3px 5px;
            font-size: 10px;
        }

        /*  */
        .doc-number {
            font-size: 11px;
            margin-bottom: 8px;
        }

        /*   */
        .main-box {
            border: 1px solid #000;
        }

        /*    */
        .info-table {
            width: 100%;
            border-collapse: collapse;
        }
        .info-table td {
            border: 1px solid #000;
            padding: 6px 12px;
            font-size: 13px;
        }
        .info-table .label {
            width: 80px;
            text-align: center;
            font-weight: normal;
        }

        /*   */
        .content-area {
            padding: 20px;
            min-height: 50mm;
            border-top: 1px solid #000;
        }
        .content-statement {
            text-align: center;
            font-size: 14px;
            margin-bottom: 25px;
            line-height: 1.8;
        }
        .content-list {
            font-size: 13px;
        }
        .content-list p {
            margin-bottom: 6px;
        }

        /*  */
        .expense-section {
            margin-top: 15px;
        }
        .expense-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }
        .expense-table th {
            background: #f0f0f0;
            border: 1px solid #000;
            padding: 10px 8px;
            font-weight: bold;
            text-align: center;
        }
        .expense-table td {
            border: 1px solid #000;
            padding: 10px 8px;
        }
        .expense-table .total-row td {
            font-weight: bold;
            background: #fff;
        }

        /*  */
        .attachment {
            margin-top: 20px;
            font-size: 12px;
        }

        @media print {
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .page { margin: 0; padding: 10mm 15mm; }
        }
    </style>
</head>
<body>
    <div class="page">
        <div class="header">
            <div class="main-title">(${e.title})</div>
            <table class="approval-box">
                <tr class="header-row">
                    <td rowspan="3" class="label-cell"><br></td>
                    <td class="position-cell"></td>
                    <td class="position-cell"></td>
                    ${x?'<td class="position-cell"></td>':""}
                </tr>
                <tr>
                    <td class="name-cell">${t.name||""}</td>
                    <td class="name-cell">${r}</td>
                    ${x?`<td class="name-cell">${s}</td>`:""}
                </tr>
                <tr>
                    <td class="date-cell">${u(a)}</td>
                    <td class="date-cell">${u(o)}</td>
                    ${x?`<td class="date-cell">${e.approved_at?u(o):""}</td>`:""}
                </tr>
            </table>
        </div>

        <div class="doc-number"> : ${e.doc_number||""}</div>

        <div class="main-box">
            <table class="info-table">
                <tr>
                    <td class="label">  </td>
                    <td>${l(a).replace(" ","-").replace(" ","-").replace("","")}</td>
                </tr>
                <tr>
                    <td class="label">  </td>
                    <td>${t.name||""}</td>
                </tr>
                <tr>
                    <td class="label"></td>
                    <td>${t.team||""}</td>
                </tr>
                <tr>
                    <td class="label"> </td>
                    <td>${t.rank||""}</td>
                </tr>
                <tr>
                    <td class="label"> </td>
                    <td>${e.document_labels?.name||""} (${e.title})</td>
                </tr>
            </table>

            <div class="content-area">
                <p class="content-statement">      .</p>

                <p style="text-align: center; margin: 20px 0;">-</p>

                <div class="content-list">
                    ${e.execution_date?`<p>1. : ${e.execution_date}</p>`:""}
                    ${h>0?`<p>${e.execution_date?"2":"1"}. : ${h.toLocaleString()}  (${m(h)})</p>`:""}
                    ${e.payment_method?`<p>${e.execution_date?"3":"2"}. : ${e.payment_method}</p>`:""}
                    ${(e.expense_items||[]).length>0?`<p>${e.execution_date?"4":"3"}. </p>`:""}
                </div>

                ${(e.expense_items||[]).length>0?`
                <div class="expense-section">
                    <table class="expense-table">
                        <thead>
                            <tr>
                                <th style="width: 25%;"> </th>
                                <th style="width: 15%;"></th>
                                <th style="width: 15%;"></th>
                                <th style="width: 18%;"></th>
                                <th style="width: 12%;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            ${d()}
                            <tr class="total-row">
                                <td colspan="3" style="text-align: center; border: 1px solid #000;"> </td>
                                <td style="text-align: right; border: 1px solid #000;">${h.toLocaleString()}</td>
                                <td style="border: 1px solid #000;"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                `:`
                <div style="margin-top: 20px;">
                    <p style="white-space: pre-wrap;">${e.content||""}</p>
                </div>
                `}

                ${(e.expense_items||[]).length>0?`
                <div class="attachment">
                    <p>. 1.  ${(e.expense_items||[]).length} .</p>
                </div>
                `:""}
            </div>
        </div>
    </div>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,v=window.open("","_blank","width=900,height=700");v.document.write(y),v.document.close()},Go={full:{label:"",days:1},half_am:{label:" ",days:.5},half_pm:{label:" ",days:.5},out_1h:{label:"/ 1",days:.125},out_2h:{label:"/ 2",days:.25},out_3h:{label:"/ 3",days:.375},comp:{label:"",days:1}},$U=()=>{const{isAdmin:e,isSubAdmin:t,user:r}=Kr(),s=r?.user_id==="admin"||(e||t)&&r?.user_id!=="admin2",a=r?.user_id==="admin2",{pendingRequests:o,loading:l,approveLeaveRequest:u,rejectLeaveRequest:d,refresh:h}=Av(),{pendingDocuments:m,labels:x,loading:y,approveDocument:v,rejectDocument:b,deleteDocument:g,addLabel:_,updateLabel:w,deleteLabel:k}=Hj(),[N,E]=X.useState([]),[C,L]=X.useState("document"),[O,B]=X.useState("pending"),[F,q]=X.useState([]),[fe,D]=X.useState(""),[V,I]=X.useState(null),[ae,Q]=X.useState(""),[te,ve]=X.useState(null),[ee,Se]=X.useState(null),[J,M]=X.useState(""),[Y,G]=X.useState("#3B82F6"),[re,ce]=X.useState(null),[P,U]=X.useState(""),[le,ne]=X.useState(""),[ie,H]=X.useState("pending"),[K,S]=X.useState([]),[ue,z]=X.useState([]),[T,A]=X.useState([]),[W,pe]=X.useState(""),[_e,oe]=X.useState(""),[Te,Me]=X.useState(null),[Ae,Re]=X.useState(""),[et,He]=X.useState(null),[at,De]=X.useState(null),[mt,At]=X.useState(null),[wt,Ct]=X.useState(""),[It,Le]=X.useState(null),[tt,ct]=X.useState(!1),[se,Ne]=X.useState([]),[xe,je]=X.useState(0);if(!e&&!t)return n.jsx(Cc,{to:"/",replace:!0});X.useEffect(()=>{(async()=>{const{data:Ie}=await Pe.from("users").select("user_id, name, team, rank").order("name");Ie&&E(Ie);const{data:bt}=await Pe.from("documents").select("*, document_labels(*)").order("created_at",{ascending:!1});bt&&q(bt);const{data:yt}=await Pe.from("annual_leaves").select("*").eq("year",new Date().getFullYear());yt&&S(yt);const{data:Ut}=await Pe.from("leave_requests").select("*").in("status",["approved","rejected"]).order("updated_at",{ascending:!1});Ut&&z(Ut);const{data:Br}=await Pe.from("documents").select("*, document_labels(*)").eq("document_labels.code",4).in("status",["approved","rejected"]).order("updated_at",{ascending:!1});Br&&A(Br.filter(us=>us.document_labels?.code===4))})()},[m,o]);const de=me=>N.find(Ie=>Ie.user_id===me)||{name:me,team:"",rank:""},Oe=me=>K.find(Ie=>Ie.user_id===me),Ue=async(me,Ie="chairman")=>{ve(me);const{error:bt}=await v(me,Ie);ve(null),bt&&alert(" .")},rt=me=>(me.expense_items||[]).reduce((Ie,bt)=>Ie+(Number(bt.amount)||0),0),pt=async me=>{if(!ae.trim()){alert("  .");return}ve(me);const{error:Ie}=await b(me,ae);ve(null),I(null),Q(""),Ie&&alert(" .")},_t=async me=>{if(!confirm(" ?"))return;ve(me);const{error:Ie}=await g(me);if(ve(null),Ie){console.error("Delete document error:",Ie);const bt=typeof Ie=="string"?Ie:Ie.message||JSON.stringify(Ie);alert(" : "+bt)}else q(bt=>bt.filter(yt=>yt.id!==me))},Vt=async()=>{if(!J.trim()){alert("  .");return}const{error:me}=await _(J.trim(),Y);me?alert("  ."):(M(""),G("#3B82F6"))},yr=async me=>{if(!P.trim()){alert("  .");return}const{error:Ie}=await w(me,P.trim(),le);Ie?alert("  ."):ce(null)},_r=async me=>{if(!confirm(" ?"))return;const{error:Ie}=await k(me);Ie&&alert("  .")},zt=async me=>{He(me);const{error:Ie}=await u(me);He(null),Ie&&alert(" .")},fr=async me=>{if(!Ae.trim()){alert("  .");return}He(me);const{error:Ie}=await d(me,Ae);He(null),Me(null),Re(""),Ie&&alert(" .")},kr=async me=>{if(!confirm(`${de(me.user_id).name}   ?${me.status==="approved"?`
(  )`:""}`))return;if(He(me.id),me.status==="approved"){const{data:bt}=await Pe.from("annual_leaves").select("*").eq("user_id",me.user_id).eq("year",new Date().getFullYear()).single();bt&&await Pe.from("annual_leaves").update({used_days:Math.max(0,bt.used_days-me.days),updated_at:new Date().toISOString()}).eq("id",bt.id)}const{error:Ie}=await Pe.from("leave_requests").delete().eq("id",me.id);if(He(null),Ie){console.error("Delete leave request error:",Ie);const bt=typeof Ie=="string"?Ie:Ie.message||JSON.stringify(Ie);alert(" : "+bt)}else z(bt=>bt.filter(yt=>yt.id!==me.id)),h()},Jr=(me,Ie)=>{At(me),Ct(Ie.toString())},he=async me=>{const Ie=parseFloat(wt);if(isNaN(Ie)||Ie<0){alert("   .");return}Le(me);const bt=K.find(yt=>yt.user_id===me);if(bt){const{error:yt}=await Pe.from("annual_leaves").update({total_days:Ie,updated_at:new Date().toISOString()}).eq("id",bt.id);if(yt){alert(" ."),Le(null);return}}else{const{error:yt}=await Pe.from("annual_leaves").insert({user_id:me,year:new Date().getFullYear(),total_days:Ie,used_days:0});if(yt){alert(" ."),Le(null);return}}S(bt?yt=>yt.map(Ut=>Ut.user_id===me?{...Ut,total_days:Ie}:Ut):yt=>[...yt,{user_id:me,year:new Date().getFullYear(),total_days:Ie,used_days:0}]),Le(null),At(null)},we=me=>new Date(me).toLocaleDateString("ko-KR",{month:"short",day:"numeric",weekday:"short"}),ye=me=>new Date(me).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"/").replace(".",""),be=me=>{switch(me){case"approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[n.jsx(Ws,{size:12}),""]});case"chairman_approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium",children:[n.jsx(Ws,{size:12}),""]});case"rejected":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[n.jsx(co,{size:12}),""]});default:return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[n.jsx(Sn,{size:12}),""]})}},ke=me=>me==="approved"?n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[n.jsx(Ws,{size:12}),""]}):me==="rejected"?n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[n.jsx(co,{size:12}),""]}):n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[n.jsx(Sn,{size:12}),""]}),Ee=F.filter(me=>me.document_labels?.code===4?!1:de(me.drafter_id).name?.toLowerCase().includes(fe.toLowerCase())||me.title?.toLowerCase().includes(fe.toLowerCase())),We=N.filter(me=>me.name?.toLowerCase().includes(W.toLowerCase())||me.team?.toLowerCase().includes(W.toLowerCase())),st=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899","#06B6D4","#6B7280"],$e=m.filter(me=>me.document_labels?.code===4),qe=m.filter(me=>me.document_labels?.code!==4),Ke=qe.length+o.length+$e.length,ft=me=>{const Ie=me.split(".").pop().toLowerCase();return["jpg","jpeg","png","gif","webp","bmp"].includes(Ie)},vt=(me,Ie=0)=>{const bt=me.filter(yt=>ft(yt.name));bt.length>0&&(Ne(bt),je(Ie),ct(!0))},kt=async me=>{try{const bt=await(await fetch(me.url)).blob(),yt=window.URL.createObjectURL(bt),Ut=document.createElement("a");Ut.href=yt,Ut.download=me.name,document.body.appendChild(Ut),Ut.click(),window.URL.revokeObjectURL(yt),document.body.removeChild(Ut)}catch(Ie){console.error("Download failed:",Ie),window.open(me.url,"_blank")}},xt=async me=>{for(const Ie of me)await kt(Ie),await new Promise(bt=>setTimeout(bt,500))};return n.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[n.jsxs(Vs,{to:"/",className:"inline-flex items-center gap-2 text-toss-gray-500 hover:text-toss-gray-700 transition-colors",children:[n.jsx(tf,{size:20})," "]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl flex items-center justify-center",children:n.jsx(yl,{className:"text-white",size:28})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:""}),n.jsxs("p",{className:"text-toss-gray-500",children:["  ",Ke>0&&n.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:[Ke," "]})]})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>L("document"),className:`flex-1 py-4 rounded-xl font-medium transition-all ${C==="document"?"bg-indigo-500 text-white":"bg-toss-gray-100 text-toss-gray-600 hover:bg-toss-gray-200"}`,children:[n.jsx(Gs,{size:20,className:"inline mr-2"})," ",qe.length>0&&n.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${C==="document"?"bg-white/20":"bg-red-500 text-white"}`,children:qe.length})]}),n.jsxs("button",{onClick:()=>L("leave"),className:`flex-1 py-4 rounded-xl font-medium transition-all ${C==="leave"?"bg-purple-500 text-white":"bg-toss-gray-100 text-toss-gray-600 hover:bg-toss-gray-200"}`,children:[n.jsx(ha,{size:20,className:"inline mr-2"})," ",o.length+$e.length>0&&n.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${C==="leave"?"bg-white/20":"bg-red-500 text-white"}`,children:o.length+$e.length})]})]}),C==="document"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex gap-2 border-b border-toss-gray-200",children:[n.jsxs("button",{onClick:()=>B("pending"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${O==="pending"?"border-indigo-500 text-indigo-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:[" ",qe.length>0&&n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:qe.length})]}),n.jsx("button",{onClick:()=>B("all"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${O==="all"?"border-indigo-500 text-indigo-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "}),n.jsx("button",{onClick:()=>B("labels"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${O==="labels"?"border-indigo-500 text-indigo-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "})]}),O==="pending"&&n.jsxs(Et,{children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 mb-4 flex items-center gap-2",children:[n.jsx(Sn,{className:"text-amber-500",size:20}),"  "]}),y?n.jsx("div",{className:"py-12 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-indigo-500 border-t-transparent"})}):qe.length===0?n.jsxs("div",{className:"py-12 text-center text-toss-gray-500",children:[n.jsx(Ws,{className:"mx-auto mb-3 text-emerald-400",size:48}),n.jsx("p",{children:"  "})]}):n.jsx("div",{className:"space-y-4",children:qe.map(me=>{const Ie=de(me.drafter_id),bt=V===me.id,yt=te===me.id,Ut=rt(me),Br=Ut>=1e6,us=me.status==="chairman_approved";return n.jsxs("div",{className:"p-5 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{onClick:()=>Se({...me,userInfo:Ie}),className:"cursor-pointer hover:bg-toss-gray-100 -mx-5 -mt-5 px-5 pt-5 pb-3 rounded-t-xl transition-colors",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[me.document_labels&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:me.document_labels.color+"20",color:me.document_labels.color},children:me.document_labels.name}),us&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:""}),n.jsx("span",{className:"text-sm text-toss-gray-500",children:me.doc_number})]}),n.jsx("p",{className:"font-bold text-toss-gray-900",children:me.title})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-base font-semibold text-toss-gray-900",children:[Ie.name," ",n.jsx("span",{className:"font-normal text-toss-gray-600",children:Ie.rank})]}),n.jsx("p",{className:"text-sm text-toss-gray-500",children:Ie.team})]})]}),me.content&&n.jsx("p",{className:"text-sm text-toss-gray-600 mb-3 line-clamp-2",children:me.content}),Ut>0&&n.jsxs("p",{className:`text-sm font-medium mb-2 ${Br?"text-orange-600":"text-indigo-600"}`,children:[": ",Ut.toLocaleString(),"",Br&&" (  )"]}),me.extra_work_hours>0&&n.jsxs("p",{className:"text-sm text-toss-blue mb-3",children:[": ",me.extra_work_hours," ( ",(me.extra_work_hours/8).toFixed(1),")"]}),me.attendance_type==="leave"&&me.leave_type&&n.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg mb-3",children:n.jsxs("p",{className:"text-sm text-emerald-700 font-medium",children:[Go[me.leave_type]?.label||me.leave_type," ",n.jsxs("span",{className:"ml-2",children:[me.leave_start_date===me.leave_end_date?we(me.leave_start_date):`${we(me.leave_start_date)} ~ ${we(me.leave_end_date)}`,me.leave_days&&` (${me.leave_days})`]})]})}),me.attachments&&me.attachments.length>0&&n.jsxs("div",{className:"mb-3",children:[n.jsxs("p",{className:"text-xs text-toss-gray-500 mb-2 flex items-center gap-1",children:[n.jsx($c,{size:12})," (",me.attachments.length,")"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:me.attachments.map((ds,Wa)=>{const No=ft(ds.name),Js=me.attachments.filter(Ga=>ft(Ga.name)).findIndex(Ga=>Ga.name===ds.name);return n.jsx("div",{className:"relative group",children:No?n.jsx("button",{onClick:Ga=>{Ga.stopPropagation(),vt(me.attachments,Js)},className:"w-16 h-16 rounded-lg overflow-hidden border border-toss-gray-200 hover:border-toss-blue transition-colors",children:n.jsx("img",{src:ds.url,alt:ds.name,className:"w-full h-full object-cover"})}):n.jsxs("a",{href:ds.url,target:"_blank",rel:"noopener noreferrer",onClick:Ga=>Ga.stopPropagation(),className:"flex items-center gap-1 px-2 py-1 bg-toss-gray-100 rounded-lg text-xs text-toss-gray-700 hover:bg-toss-gray-200 transition-colors",children:[n.jsx(Gs,{size:12}),n.jsx("span",{className:"max-w-[100px] truncate",children:ds.name})]})},Wa)})})]}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-toss-gray-400",children:[n.jsx(ta,{size:12}),new Date(me.created_at).toLocaleString("ko-KR")," "]})]}),n.jsx("div",{className:"mt-4 pt-4 border-t border-toss-gray-200",children:bt?n.jsxs("div",{className:"space-y-3",children:[n.jsx("textarea",{value:ae,onChange:ds=>Q(ds.target.value),placeholder:"  ",rows:2,className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Ye,{onClick:()=>pt(me.id),className:"flex-1 bg-red-500 hover:bg-red-600",loading:yt,disabled:yt,children:" "}),n.jsx(Ye,{onClick:()=>{I(null),Q("")},variant:"secondary",className:"flex-1",disabled:yt,children:""})]})]}):n.jsxs("div",{className:"flex gap-2",children:[Br?n.jsxs(n.Fragment,{children:[!us&&n.jsxs(Ye,{onClick:()=>Ue(me.id,"chairman"),className:"flex-1 bg-blue-500 hover:bg-blue-600",loading:yt,disabled:yt,children:[n.jsx(Ws,{size:16,className:"mr-1"})," "]}),us&&n.jsxs(Ye,{onClick:()=>Ue(me.id,"director"),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:yt,disabled:yt,children:[n.jsx(Ws,{size:16,className:"mr-1"})," "]})]}):n.jsxs(Ye,{onClick:()=>Ue(me.id,"chairman"),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:yt,disabled:yt,children:[n.jsx(Ws,{size:16,className:"mr-1"}),""]}),n.jsxs(Ye,{onClick:()=>I(me.id),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",disabled:yt,children:[n.jsx(co,{size:16,className:"mr-1"}),""]})]})})]},me.id)})})]}),O==="all"&&n.jsxs(Et,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-lg font-bold text-toss-gray-900",children:" "}),n.jsxs("div",{className:"relative",children:[n.jsx(ho,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400",size:16}),n.jsx("input",{type:"text",value:fe,onChange:me=>D(me.target.value),placeholder:"   ",className:"pl-9 pr-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),n.jsx("tbody",{children:Ee.map(me=>{const Ie=de(me.drafter_id),bt=te===me.id;return n.jsxs("tr",{onClick:()=>Se({...me,userInfo:Ie}),className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 cursor-pointer",children:[n.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:ye(me.created_at)}),n.jsx("td",{className:"py-3 px-4",children:me.document_labels&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:me.document_labels.color+"20",color:me.document_labels.color},children:me.document_labels.name})}),n.jsx("td",{className:"py-3 px-4",children:n.jsx("p",{className:"font-medium text-toss-gray-900 truncate max-w-xs",children:me.title})}),n.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:Ie.name}),n.jsx("td",{className:"py-3 px-4 text-center",children:be(me.status)}),n.jsx("td",{className:"py-3 px-4 text-center",onClick:yt=>yt.stopPropagation(),children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[me.status==="approved"&&n.jsx("button",{onClick:()=>{const Ut=rt(me)>=1e6?"":"";K1(me,Ie,"",Ut)},className:"p-1.5 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:" PDF ",children:n.jsx(Gs,{size:18})}),n.jsx("button",{onClick:()=>_t(me.id),disabled:bt,className:"p-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"",children:bt?n.jsx("div",{className:"w-4 h-4 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}):n.jsx(Jt,{size:18})})]})})]},me.id)})})]})})]}),O==="labels"&&n.jsxs(Et,{children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 mb-4 flex items-center gap-2",children:[n.jsx(Fd,{className:"text-purple-500",size:20})," "]}),n.jsxs("div",{className:"p-4 bg-toss-gray-50 rounded-xl mb-6",children:[n.jsx("h3",{className:"font-medium text-toss-gray-900 mb-3",children:"  "}),n.jsxs("div",{className:"flex gap-3 items-end flex-wrap",children:[n.jsxs("div",{className:"flex-1 min-w-[200px]",children:[n.jsx("label",{className:"block text-sm text-toss-gray-500 mb-1",children:" "}),n.jsx("input",{type:"text",value:J,onChange:me=>M(me.target.value),placeholder:" ",className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("div",{className:"flex gap-1",children:st.map(me=>n.jsx("button",{onClick:()=>G(me),className:`w-8 h-8 rounded-lg transition-all ${Y===me?"ring-2 ring-offset-2 ring-gray-400":""}`,style:{backgroundColor:me}},me))})]}),n.jsxs(Ye,{onClick:Vt,children:[n.jsx(ps,{size:16,className:"mr-1"}),""]})]})]}),n.jsx("div",{className:"space-y-3",children:x.map(me=>{const Ie=re===me.id;return n.jsx("div",{className:"flex items-center justify-between p-4 bg-toss-gray-50 rounded-xl",children:Ie?n.jsxs("div",{className:"flex gap-3 items-center flex-1 flex-wrap",children:[n.jsx("input",{type:"text",value:P,onChange:bt=>U(bt.target.value),className:"flex-1 min-w-[150px] px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}),n.jsx("div",{className:"flex gap-1",children:st.map(bt=>n.jsx("button",{onClick:()=>ne(bt),className:`w-6 h-6 rounded transition-all ${le===bt?"ring-2 ring-offset-1 ring-gray-400":""}`,style:{backgroundColor:bt}},bt))}),n.jsx("button",{onClick:()=>yr(me.id),className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-lg",children:n.jsx(jy,{size:18})}),n.jsx("button",{onClick:()=>ce(null),className:"p-2 text-toss-gray-500 hover:bg-toss-gray-100 rounded-lg",children:n.jsx(mr,{size:18})})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-sm text-toss-gray-500",children:me.code}),n.jsx("span",{className:"px-3 py-1.5 rounded-full text-sm font-medium",style:{backgroundColor:me.color+"20",color:me.color},children:me.name})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>{ce(me.id),U(me.name),ne(me.color)},className:"p-2 text-toss-gray-500 hover:bg-toss-gray-100 rounded-lg",children:n.jsx(qc,{size:18})}),n.jsx("button",{onClick:()=>_r(me.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg",children:n.jsx(Jt,{size:18})})]})]})},me.id)})})]})]}),C==="leave"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex gap-2 border-b border-toss-gray-200",children:[n.jsxs("button",{onClick:()=>H("pending"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${ie==="pending"?"border-purple-500 text-purple-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:[" ",o.length+$e.length>0&&n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:o.length+$e.length})]}),n.jsx("button",{onClick:()=>H("history"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${ie==="history"?"border-purple-500 text-purple-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "}),n.jsx("button",{onClick:()=>H("overview"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${ie==="overview"?"border-purple-500 text-purple-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "})]}),ie==="pending"&&n.jsxs("div",{className:"space-y-6",children:[$e.length>0&&n.jsxs(Et,{children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 mb-4 flex items-center gap-2",children:[n.jsx(Gs,{className:"text-purple-500",size:20}),"   ",n.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 text-xs rounded-full",children:$e.length})]}),n.jsx("div",{className:"space-y-4",children:$e.map(me=>{const Ie=de(me.drafter_id),bt=V===me.id,yt=te===me.id,Br=rt(me)>=1e6,us=me.status==="chairman_approved";return n.jsxs("div",{className:"p-5 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{onClick:()=>Se({...me,userInfo:Ie}),className:"cursor-pointer hover:bg-toss-gray-100 -mx-5 -mt-5 px-5 pt-5 pb-3 rounded-t-xl transition-colors",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[me.document_labels&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:me.document_labels.color+"20",color:me.document_labels.color},children:me.document_labels.name}),me.attendance_type&&n.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium ${me.attendance_type==="overtime"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:me.attendance_type==="overtime"?"":""}),us&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:""}),n.jsx("span",{className:"text-sm text-toss-gray-500",children:me.doc_number})]}),n.jsx("p",{className:"font-bold text-toss-gray-900",children:me.title})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-base font-semibold text-toss-gray-900",children:[Ie.name," ",n.jsx("span",{className:"font-normal text-toss-gray-600",children:Ie.rank})]}),n.jsx("p",{className:"text-sm text-toss-gray-500",children:Ie.team})]})]}),me.leave_type&&n.jsxs("div",{className:"mb-3 p-3 bg-green-50 rounded-lg",children:[n.jsxs("p",{className:"text-sm text-green-800",children:[n.jsx("span",{className:"font-medium",children:" :"})," ",Go[me.leave_type]?.label||me.leave_type]}),me.leave_start_date&&n.jsxs("p",{className:"text-sm text-green-800",children:[n.jsx("span",{className:"font-medium",children:":"})," ",we(me.leave_start_date),me.leave_end_date&&me.leave_start_date!==me.leave_end_date&&n.jsxs(n.Fragment,{children:[" ~ ",we(me.leave_end_date)]})]}),me.leave_days&&n.jsxs("p",{className:"text-sm text-green-800",children:[n.jsx("span",{className:"font-medium",children:":"})," ",me.leave_days,""]})]}),me.content&&n.jsx("p",{className:"text-sm text-toss-gray-600 mb-3 line-clamp-2",children:me.content}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-toss-gray-400",children:[n.jsx(ta,{size:12}),new Date(me.created_at).toLocaleString("ko-KR")," "]})]}),bt?n.jsxs("div",{className:"space-y-3 mt-4",children:[n.jsx("textarea",{value:ae,onChange:ds=>Q(ds.target.value),placeholder:"  ",rows:2,className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Ye,{onClick:()=>pt(me.id),className:"flex-1 bg-red-500 hover:bg-red-600",loading:yt,disabled:yt,children:" "}),n.jsx(Ye,{onClick:()=>{I(null),Q("")},variant:"secondary",className:"flex-1",disabled:yt,children:""})]})]}):n.jsxs("div",{className:"flex gap-2 mt-4",children:[Br&&!us&&s&&n.jsxs(Ye,{onClick:()=>Ue(me.id,"chairman"),className:"flex-1 bg-blue-500 hover:bg-blue-600",loading:yt,disabled:yt,children:[n.jsx(Ws,{size:16,className:"mr-1"})," "]}),Br&&us&&a&&n.jsxs(Ye,{onClick:()=>Ue(me.id,"director"),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:yt,disabled:yt,children:[n.jsx(Ws,{size:16,className:"mr-1"})," "]}),!Br&&n.jsxs(Ye,{onClick:()=>Ue(me.id,"chairman"),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:yt,disabled:yt,children:[n.jsx(Ws,{size:16,className:"mr-1"}),""]}),n.jsxs(Ye,{onClick:()=>I(me.id),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",disabled:yt,children:[n.jsx(co,{size:16,className:"mr-1"}),""]})]})]},me.id)})})]}),n.jsxs(Et,{children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 mb-4 flex items-center gap-2",children:[n.jsx(Sn,{className:"text-amber-500",size:20}),"   ",o.length>0&&n.jsx("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 text-xs rounded-full",children:o.length})]}),l?n.jsx("div",{className:"py-12 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-purple-500 border-t-transparent"})}):o.length===0?n.jsxs("div",{className:"py-12 text-center text-toss-gray-500",children:[n.jsx(Ws,{className:"mx-auto mb-3 text-emerald-400",size:48}),n.jsx("p",{children:"   "})]}):n.jsx("div",{className:"space-y-4",children:o.map(me=>{const Ie=de(me.user_id),bt=Te===me.id,yt=et===me.id;return n.jsxs("div",{className:"p-5 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"text-lg font-bold text-toss-gray-900",children:[Ie.name,Ie.rank&&n.jsx("span",{className:"text-base font-normal text-toss-gray-600 ml-1",children:Ie.rank})]}),Ie.team&&n.jsx("p",{className:"text-sm text-toss-gray-500",children:Ie.team})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("span",{className:"px-3 py-1 bg-amber-100 text-amber-700 rounded-full text-sm font-medium",children:[me.days,""]}),n.jsx("p",{className:"text-xs text-toss-gray-500 mt-1",children:Go[me.leave_type]?.label||me.leave_type})]})]}),n.jsxs("div",{className:"mb-3",children:[n.jsxs("p",{className:"text-toss-gray-900",children:[we(me.start_date),me.start_date!==me.end_date&&n.jsxs(n.Fragment,{children:[" ~ ",we(me.end_date)]})]}),me.reason&&n.jsxs("p",{className:"text-sm text-toss-gray-500 mt-1",children:[": ",me.reason]})]}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-toss-gray-400 mb-4",children:[n.jsx(ta,{size:12}),new Date(me.created_at).toLocaleString("ko-KR")," "]}),bt?n.jsxs("div",{className:"space-y-3",children:[n.jsx("textarea",{value:Ae,onChange:Ut=>Re(Ut.target.value),placeholder:"  ",rows:2,className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Ye,{onClick:()=>fr(me.id),className:"flex-1 bg-red-500 hover:bg-red-600",loading:yt,disabled:yt,children:" "}),n.jsx(Ye,{onClick:()=>{Me(null),Re("")},variant:"secondary",className:"flex-1",disabled:yt,children:""})]})]}):n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(Ye,{onClick:()=>zt(me.id),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:yt,disabled:yt,children:[n.jsx(Ws,{size:16,className:"mr-1"}),""]}),n.jsxs(Ye,{onClick:()=>Me(me.id),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",disabled:yt,children:[n.jsx(co,{size:16,className:"mr-1"}),""]})]})]},me.id)})})]})]}),ie==="history"&&n.jsxs(Et,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 flex items-center gap-2",children:[n.jsx(eS,{className:"text-purple-500",size:20})," "]}),n.jsxs("div",{className:"relative",children:[n.jsx(ho,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400",size:16}),n.jsx("input",{type:"text",value:_e,onChange:me=>oe(me.target.value),placeholder:" ",className:"pl-9 pr-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),ue.length===0&&T.length===0?n.jsxs("div",{className:"py-12 text-center text-toss-gray-500",children:[n.jsx(eS,{className:"mx-auto mb-3 text-toss-gray-300",size:48}),n.jsx("p",{children:"  "})]}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:"/"}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),n.jsx("tbody",{children:[...ue.map(me=>({...me,_type:"leave",_sortDate:new Date(me.updated_at)})),...T.map(me=>({...me,_type:"document",_sortDate:new Date(me.updated_at||me.approved_at||me.created_at)}))].sort((me,Ie)=>Ie._sortDate-me._sortDate).filter(me=>{const Ie=me._type==="leave"?me.user_id:me.drafter_id;return de(Ie).name?.toLowerCase().includes(_e.toLowerCase())}).map(me=>{if(me._type==="leave"){const Ie=me,bt=de(Ie.user_id),yt=et===Ie.id;return n.jsxs("tr",{onClick:()=>De({...Ie,userInfo:bt}),className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 cursor-pointer",children:[n.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:ye(Ie.updated_at)}),n.jsxs("td",{className:"py-3 px-4",children:[n.jsx("p",{className:"text-sm font-medium text-toss-gray-900",children:bt.name}),bt.rank&&n.jsx("p",{className:"text-xs text-toss-gray-500",children:bt.rank})]}),n.jsx("td",{className:"py-3 px-4",children:n.jsx("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full text-xs font-medium",children:""})}),n.jsxs("td",{className:"py-3 px-4 text-sm text-toss-gray-900",children:[Go[Ie.leave_type]?.label,Ie.days&&n.jsxs("span",{className:"text-purple-600 ml-1",children:["(",Ie.days,")"]})]}),n.jsx("td",{className:"py-3 px-4",children:n.jsxs("p",{className:"text-sm text-toss-gray-900",children:[ye(Ie.start_date),Ie.start_date!==Ie.end_date&&n.jsxs(n.Fragment,{children:[" ~ ",ye(Ie.end_date)]})]})}),n.jsx("td",{className:"py-3 px-4 text-center",children:ke(Ie.status)}),n.jsx("td",{className:"py-3 px-4 text-center",onClick:Ut=>Ut.stopPropagation(),children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[Ie.status==="approved"&&n.jsx("button",{onClick:()=>Ek(Ie,bt),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",title:" PDF ",children:n.jsx(Gs,{size:18})}),n.jsx("button",{onClick:()=>kr(Ie),disabled:yt,className:"p-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"",children:yt?n.jsx("div",{className:"w-4 h-4 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}):n.jsx(Jt,{size:18})})]})})]},`leave-${Ie.id}`)}else{const Ie=me,bt=de(Ie.drafter_id),yt=te===Ie.id;return n.jsxs("tr",{onClick:()=>Se({...Ie,userInfo:bt}),className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 cursor-pointer",children:[n.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:ye(Ie.updated_at||Ie.approved_at||Ie.created_at)}),n.jsxs("td",{className:"py-3 px-4",children:[n.jsx("p",{className:"text-sm font-medium text-toss-gray-900",children:bt.name}),bt.rank&&n.jsx("p",{className:"text-xs text-toss-gray-500",children:bt.rank})]}),n.jsx("td",{className:"py-3 px-4",children:n.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Ie.attendance_type==="overtime"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:Ie.attendance_type==="overtime"?"":""})}),n.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-900",children:Ie.attendance_type==="leave"?n.jsxs(n.Fragment,{children:[Go[Ie.leave_type]?.label||Ie.leave_type,Ie.leave_days&&n.jsxs("span",{className:"text-purple-600 ml-1",children:["(",Ie.leave_days,")"]})]}):n.jsxs(n.Fragment,{children:[Ie.title,Ie.extra_work_hours>0&&n.jsxs("span",{className:"text-blue-600 ml-1",children:["(",Ie.extra_work_hours,")"]})]})}),n.jsx("td",{className:"py-3 px-4",children:Ie.leave_start_date?n.jsxs("p",{className:"text-sm text-toss-gray-900",children:[ye(Ie.leave_start_date),Ie.leave_start_date!==Ie.leave_end_date&&Ie.leave_end_date&&n.jsxs(n.Fragment,{children:[" ~ ",ye(Ie.leave_end_date)]})]}):n.jsx("span",{className:"text-sm text-toss-gray-400",children:"-"})}),n.jsx("td",{className:"py-3 px-4 text-center",children:be(Ie.status)}),n.jsx("td",{className:"py-3 px-4 text-center",onClick:Ut=>Ut.stopPropagation(),children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[Ie.status==="approved"&&n.jsx("button",{onClick:()=>{const Br=rt(Ie)>=1e6?"":"";K1(Ie,bt,"",Br)},className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",title:" PDF ",children:n.jsx(Gs,{size:18})}),n.jsx("button",{onClick:()=>_t(Ie.id),disabled:yt,className:"p-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"",children:yt?n.jsx("div",{className:"w-4 h-4 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}):n.jsx(Jt,{size:18})})]})})]},`doc-${Ie.id}`)}})})]})})]}),ie==="overview"&&n.jsxs(Et,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 flex items-center gap-2",children:[n.jsx(Ld,{className:"text-purple-600",size:20}),"  "]}),n.jsxs("div",{className:"relative",children:[n.jsx(ho,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400",size:16}),n.jsx("input",{type:"text",value:W,onChange:me=>pe(me.target.value),placeholder:"   ",className:"pl-9 pr-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:" "}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),n.jsx("tbody",{children:We.map(me=>{const Ie=Oe(me.user_id),bt=Ie?.total_days||15,yt=Ie?.used_days||0,Ut=bt-yt,Br=mt===me.user_id,us=It===me.user_id;return n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50",children:[n.jsxs("td",{className:"py-3 px-4",children:[n.jsx("p",{className:"font-medium text-toss-gray-900",children:me.name}),me.rank&&n.jsx("p",{className:"text-xs text-toss-gray-500",children:me.rank})]}),n.jsx("td",{className:"py-3 px-4 text-toss-gray-600",children:me.team||"-"}),n.jsx("td",{className:"py-3 px-4 text-center",children:Br?n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("input",{type:"number",value:wt,onChange:ds=>Ct(ds.target.value),step:"0.5",min:"0",className:"w-16 px-2 py-1 text-center bg-white border border-toss-gray-300 rounded-lg text-sm",autoFocus:!0}),n.jsx("button",{onClick:()=>he(me.user_id),disabled:us,className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded",children:us?n.jsx("div",{className:"w-4 h-4 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin"}):n.jsx(jy,{size:16})}),n.jsx("button",{onClick:()=>At(null),disabled:us,className:"p-1 text-toss-gray-500 hover:bg-toss-gray-100 rounded",children:n.jsx(mr,{size:16})})]}):n.jsxs("button",{onClick:()=>Jr(me.user_id,bt),className:"inline-flex items-center gap-1 text-toss-gray-900 hover:text-purple-600 transition-colors group",children:[bt,"",n.jsx(qc,{size:14,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})}),n.jsxs("td",{className:"py-3 px-4 text-center text-purple-600 font-medium",children:[yt,""]}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("span",{className:`font-bold ${Ut<=3?"text-red-500":"text-emerald-600"}`,children:[Ut,""]})})]},me.user_id)})})]})}),We.length===0&&n.jsx("div",{className:"py-12 text-center text-toss-gray-500",children:"  "})]})]}),ee&&n.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>Se(null),children:n.jsx("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:me=>me.stopPropagation(),children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:" "}),n.jsx("button",{onClick:()=>Se(null),className:"p-2 hover:bg-toss-gray-100 rounded-lg",children:n.jsx(mr,{size:20,className:"text-toss-gray-500"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[be(ee.status),ee.document_labels&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:ee.document_labels.color+"20",color:ee.document_labels.color},children:ee.document_labels.name})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"font-bold text-toss-gray-900",children:[ee.userInfo?.name,ee.userInfo?.rank&&n.jsx("span",{className:"font-normal text-toss-gray-500 ml-1",children:ee.userInfo.rank})]}),ee.userInfo?.team&&n.jsx("p",{className:"text-sm text-toss-gray-500",children:ee.userInfo.team})]}),ee.doc_number&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:ee.doc_number})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"font-bold text-toss-gray-900 text-lg",children:ee.title})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:ee.content||"( )"})]}),ee.expense_items&&ee.expense_items.length>0&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-2",children:""}),n.jsx("div",{className:"overflow-x-auto border border-toss-gray-200 rounded-lg",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-toss-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700",children:""}),n.jsx("th",{className:"px-3 py-2 text-right font-medium text-toss-gray-700",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700",children:""})]})}),n.jsxs("tbody",{children:[ee.expense_items.map((me,Ie)=>n.jsxs("tr",{className:"border-t border-toss-gray-100",children:[n.jsx("td",{className:"px-3 py-2",children:me.item}),n.jsx("td",{className:"px-3 py-2",children:me.category}),n.jsx("td",{className:"px-3 py-2",children:me.vendor}),n.jsxs("td",{className:"px-3 py-2 text-right",children:[Number(me.amount).toLocaleString(),""]}),n.jsx("td",{className:"px-3 py-2",children:me.note})]},Ie)),n.jsxs("tr",{className:"border-t-2 border-toss-gray-300 bg-toss-gray-50 font-medium",children:[n.jsx("td",{colSpan:3,className:"px-3 py-2 text-right",children:" "}),n.jsxs("td",{className:"px-3 py-2 text-right text-indigo-600",children:[ee.expense_items.reduce((me,Ie)=>me+(Number(Ie.amount)||0),0).toLocaleString(),""]}),n.jsx("td",{})]})]})]})})]}),ee.extra_work_hours>0&&n.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:n.jsxs("p",{className:"text-sm text-toss-blue font-medium",children:[": ",ee.extra_work_hours," ( ",(ee.extra_work_hours/8).toFixed(1),")"]})}),ee.attendance_type==="leave"&&ee.leave_type&&n.jsxs("div",{className:"p-3 bg-emerald-50 rounded-lg",children:[n.jsxs("p",{className:"text-sm text-emerald-700 font-medium mb-1",children:[Go[ee.leave_type]?.label||ee.leave_type," "]}),n.jsxs("p",{className:"text-sm text-emerald-600",children:[ee.leave_start_date===ee.leave_end_date?new Date(ee.leave_start_date).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}):`${new Date(ee.leave_start_date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})} ~ ${new Date(ee.leave_end_date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})}`,ee.leave_days&&` (${ee.leave_days})`]})]}),ee.attachments&&ee.attachments.length>0&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("p",{className:"text-sm text-toss-gray-500 flex items-center gap-1",children:[n.jsx($c,{size:14})," (",ee.attachments.length,")"]}),n.jsxs("button",{onClick:()=>xt(ee.attachments),className:"flex items-center gap-1 text-xs text-toss-blue hover:underline",children:[n.jsx(ts,{size:12})," "]})]}),n.jsxs("div",{className:"space-y-2",children:[ee.attachments.filter(me=>ft(me.name)).length>0&&n.jsx("div",{className:"grid grid-cols-4 gap-2 mb-2",children:ee.attachments.filter(me=>ft(me.name)).map((me,Ie)=>n.jsxs("button",{onClick:()=>vt(ee.attachments,Ie),className:"aspect-square rounded-lg overflow-hidden border border-toss-gray-200 hover:border-toss-blue transition-colors relative group",children:[n.jsx("img",{src:me.url,alt:me.name,className:"w-full h-full object-cover"}),n.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center",children:n.jsx(P3,{size:20,className:"text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]},Ie))}),ee.attachments.filter(me=>!ft(me.name)).map((me,Ie)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-toss-gray-50 rounded-lg",children:[n.jsxs("a",{href:me.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-toss-gray-700 hover:text-toss-blue transition-colors flex-1 min-w-0",children:[n.jsx(Gs,{size:16,className:"flex-shrink-0"}),n.jsx("span",{className:"truncate",children:me.name}),n.jsx(Tc,{size:12,className:"flex-shrink-0"})]}),n.jsx("button",{onClick:()=>kt(me),className:"p-1.5 text-toss-gray-500 hover:text-toss-blue hover:bg-toss-gray-100 rounded-lg transition-colors",children:n.jsx(ts,{size:14})})]},Ie))]})]}),ee.status==="rejected"&&ee.rejected_reason&&n.jsxs("div",{className:"p-3 bg-red-50 rounded-lg",children:[n.jsx("p",{className:"text-sm text-red-600 font-medium mb-1",children:" "}),n.jsx("p",{className:"text-red-700",children:ee.rejected_reason})]}),n.jsxs("div",{className:"pt-4 border-t border-toss-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500",children:[n.jsx(ta,{size:14}),new Date(ee.created_at).toLocaleString("ko-KR")," "]}),ee.approved_at&&n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500 mt-1",children:[n.jsx(ta,{size:14}),new Date(ee.approved_at).toLocaleString("ko-KR")," "]})]})]}),n.jsxs("div",{className:"mt-6 flex gap-2",children:[ee.status==="approved"&&n.jsxs(Ye,{onClick:()=>{const Ie=rt(ee)>=1e6?"":"";K1(ee,ee.userInfo,"",Ie)},className:"flex-1",children:[n.jsx(Gs,{size:16,className:"mr-1"}),"PDF "]}),n.jsx(Ye,{onClick:()=>Se(null),variant:"secondary",className:ee.status==="approved"?"flex-1":"w-full",children:""})]})]})})}),at&&n.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>De(null),children:n.jsx("div",{className:"bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",onClick:me=>me.stopPropagation(),children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:" "}),n.jsx("button",{onClick:()=>De(null),className:"p-2 hover:bg-toss-gray-100 rounded-lg",children:n.jsx(mr,{size:20,className:"text-toss-gray-500"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"flex items-center gap-2",children:ke(at.status)}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"font-bold text-toss-gray-900",children:[at.userInfo?.name,at.userInfo?.rank&&n.jsx("span",{className:"font-normal text-toss-gray-500 ml-1",children:at.userInfo.rank})]}),at.userInfo?.team&&n.jsx("p",{className:"text-sm text-toss-gray-500",children:at.userInfo.team})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"font-medium text-toss-gray-900",children:[Go[at.leave_type]?.label||at.leave_type,n.jsxs("span",{className:"text-purple-600 ml-2",children:["(",at.days,")"]})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"font-medium text-toss-gray-900",children:[we(at.start_date),at.start_date!==at.end_date&&n.jsxs(n.Fragment,{children:[" ~ ",we(at.end_date)]})]})]}),at.reason&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:at.reason})]}),at.status==="rejected"&&at.rejected_reason&&n.jsxs("div",{className:"p-3 bg-red-50 rounded-lg",children:[n.jsx("p",{className:"text-sm text-red-600 font-medium mb-1",children:" "}),n.jsx("p",{className:"text-red-700",children:at.rejected_reason})]}),n.jsxs("div",{className:"pt-4 border-t border-toss-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500",children:[n.jsx(ta,{size:14}),new Date(at.created_at).toLocaleString("ko-KR")," "]}),at.updated_at&&at.status!=="pending"&&n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500 mt-1",children:[n.jsx(ta,{size:14}),new Date(at.updated_at).toLocaleString("ko-KR")," "]})]})]}),n.jsxs("div",{className:"mt-6 flex gap-2",children:[at.status==="approved"&&n.jsxs(Ye,{onClick:()=>Ek(at,at.userInfo),className:"flex-1",children:[n.jsx(Gs,{size:16,className:"mr-1"}),"PDF "]}),n.jsx(Ye,{onClick:()=>De(null),variant:"secondary",className:"flex-1",children:""})]})]})})}),tt&&se.length>0&&n.jsxs("div",{className:"fixed inset-0 bg-black/90 z-[60] flex items-center justify-center",onClick:()=>ct(!1),children:[n.jsx("button",{onClick:()=>ct(!1),className:"absolute top-4 right-4 p-2 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors z-10",children:n.jsx(mr,{size:28})}),n.jsx("button",{onClick:me=>{me.stopPropagation(),kt(se[xe])},className:"absolute top-4 right-16 p-2 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors z-10",children:n.jsx(ts,{size:24})}),se.length>1&&n.jsx("button",{onClick:me=>{me.stopPropagation(),je(Ie=>Ie===0?se.length-1:Ie-1)},className:"absolute left-4 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors",children:n.jsx($a,{size:32})}),n.jsx("div",{className:"max-w-[90vw] max-h-[85vh]",onClick:me=>me.stopPropagation(),children:n.jsx("img",{src:se[xe].url,alt:se[xe].name,className:"max-w-full max-h-[85vh] object-contain"})}),se.length>1&&n.jsx("button",{onClick:me=>{me.stopPropagation(),je(Ie=>Ie===se.length-1?0:Ie+1)},className:"absolute right-4 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors",children:n.jsx(pa,{size:32})}),se.length>1&&n.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 px-4 py-2 bg-black/50 rounded-full text-white text-sm",children:[xe+1," / ",se.length]}),n.jsx("div",{className:"absolute bottom-4 left-4 px-3 py-1.5 bg-black/50 rounded-lg text-white/80 text-sm",children:se[xe].name})]})]})},qU=/([A-Z]{2,4}[-_]?\d{3,5})/gi,X1="archive_labels",jk={forms:["","","",""],rescue:["","","",""]},HU=()=>{const{type:e}=e3(),[t,r]=X.useState([]),[s,a]=X.useState([]),[o,l]=X.useState(!0),[u,d]=X.useState(!1),[h,m]=X.useState(""),[x,y]=X.useState(""),[v,b]=X.useState([]),[g,_]=X.useState([]),w=X.useRef(null),[k,N]=X.useState([]),[E,C]=X.useState(!1),[L,O]=X.useState(!1),[B,F]=X.useState(""),[q,fe]=X.useState(""),[D,V]=X.useState([]);X.useEffect(()=>{const K=localStorage.getItem(X1);if(K){const S=JSON.parse(K);N(S[e]||jk[e]||[])}else N(jk[e]||[])},[e]);const I=K=>{const S=localStorage.getItem(X1),ue=S?JSON.parse(S):{};ue[e]=K,localStorage.setItem(X1,JSON.stringify(ue)),N(K)},ae=async()=>{if(!B.trim())return;if(k.includes(B.trim())){alert("  .");return}const K=B.trim(),S=[...k,K];I(S);try{const ue=te();await lS(`${ue}/${K}`)}catch(ue){console.error("  :",ue)}F(""),ee(x)},Q=K=>{if(!confirm(`"${K}"  ?
(Dropbox   )`))return;const S=k.filter(ue=>ue!==K);I(S)},te=()=>e==="forms"?"//":e==="rescue"?"//":"/",ve=()=>e==="forms"?"":e==="rescue"?"":"";X.useEffect(()=>{const K=te();y(K),b([K]),ee(K)},[e]),X.useEffect(()=>{J()},[h,t]);const ee=async K=>{l(!0);try{const ue=(await b9(K)).sort((z,T)=>z.isFolder&&!T.isFolder?-1:!z.isFolder&&T.isFolder?1:z.name.localeCompare(T.name,"ko"));r(ue),Se(ue)}catch(S){console.error("   :",S),r([])}finally{l(!1)}},Se=K=>{const S=[];K.forEach(ue=>{if(!ue.isFolder){const z=ue.name.match(qU);z&&z.forEach(T=>{S.push({documentNumber:T.toUpperCase(),fileName:ue.name,path:ue.path})})}}),_(S)},J=()=>{if(!h.trim()){a(t);return}const K=h.toLowerCase().trim(),S=g.filter(ue=>ue.documentNumber.toLowerCase().includes(K));if(S.length>0){const ue=new Set(S.map(T=>T.path)),z=t.filter(T=>ue.has(T.path));a(z)}else{const ue=t.filter(z=>z.name.toLowerCase().includes(K));a(ue)}},M=K=>{const S=K.path;b(ue=>[...ue,S]),y(S),ee(S),m("")},Y=()=>{if(v.length>1){const K=[...v];K.pop();const S=K[K.length-1];b(K),y(S),ee(S),m("")}},G=async K=>{try{const S=await w9(K.path);window.open(S,"_blank")}catch(S){console.error(" :",S),alert("  .")}},re=K=>{const S=Array.from(K.target.files);S.length!==0&&(V(S),fe(""),O(!0),w.current&&(w.current.value=""))},ce=async()=>{if(D.length===0)return;const K=q?`${te()}/${q}`:x;d(!0),O(!1);try{q&&await lS(K);for(const S of D)await _9(S,K);alert(`${D.length}  .`),q&&x!==K&&(y(K),b(S=>[...S,K])),ee(K)}catch(S){console.error(" :",S),alert("  : "+S.message)}finally{d(!1),V([])}},P=async K=>{if(confirm(`"${K.name}"() ?`))try{await v9(K.path),alert("."),ee(x)}catch(S){console.error(" :",S),alert("  .")}},U=()=>{ee(x)},le=K=>{if(K.isFolder)return n.jsx(HF,{size:20,className:"text-yellow-500"});const S=K.name.split(".").pop().toLowerCase();return["xlsx","xls","csv"].includes(S)?n.jsx(rm,{size:20,className:"text-green-600"}):n.jsx(ka,{size:20,className:"text-toss-gray-500"})},ne=K=>K?K<1024?K+" B":K<1024*1024?(K/1024).toFixed(1)+" KB":(K/(1024*1024)).toFixed(1)+" MB":"-",ie=()=>x===te()?ve():x.split("/").pop()||ve(),H=()=>{const K=te();if(x===K)return[];const ue=x.replace(K,"").split("/").filter(Boolean);return ue.map((z,T)=>{const A=K+"/"+ue.slice(0,T+1).join("/");return{name:z,path:A}})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{className:"bg-gradient-to-r from-amber-500 to-orange-500 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx($F,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:ve()}),n.jsx("p",{className:"text-white/90",children:"    "})]})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[v.length>1&&n.jsx("button",{onClick:Y,className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",title:" ",children:n.jsx(tf,{size:20})}),n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:ie()})]}),n.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[n.jsxs("div",{className:"relative flex-1 sm:w-64",children:[n.jsx(ho,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),n.jsx("input",{type:"text",value:h,onChange:K=>m(K.target.value),placeholder:"...",className:"w-full pl-10 pr-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all"})]}),n.jsx("input",{type:"file",ref:w,multiple:!0,onChange:re,className:"hidden"}),n.jsxs(Ye,{onClick:()=>w.current?.click(),disabled:u,className:"whitespace-nowrap",children:[u?n.jsx(Oc,{size:18,className:"animate-spin"}):n.jsx(ps,{size:18}),u?" ...":" "]}),n.jsx("button",{onClick:()=>C(!0),className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",title:" ",children:n.jsx(yl,{size:20})}),n.jsx("button",{onClick:U,className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"",children:n.jsx(Oc,{size:20,className:o?"animate-spin":""})})]})]}),H().length>0&&n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-600 overflow-x-auto",children:[n.jsx("button",{onClick:()=>{const K=te();y(K),b([K]),ee(K)},className:"hover:text-toss-blue transition-colors whitespace-nowrap",children:ve()}),H().map(K=>n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(pa,{size:14,className:"text-toss-gray-400"}),n.jsx("button",{onClick:()=>{y(K.path),b(S=>S.slice(0,S.indexOf(K.path)+1)||[K.path]),ee(K.path)},className:"hover:text-toss-blue transition-colors whitespace-nowrap",children:K.name})]},K.path))]}),n.jsx(Et,{padding:"p-0",children:o?n.jsxs("div",{className:"text-center text-toss-gray-500 py-12",children:[n.jsx(Oc,{size:24,className:"animate-spin mx-auto mb-2"})," ..."]}):s.length>0?n.jsx("div",{className:"divide-y divide-toss-gray-100",children:s.map(K=>n.jsxs("div",{className:`flex items-center justify-between p-4 hover:bg-toss-gray-50 transition-colors ${K.isFolder?"cursor-pointer":""}`,onClick:()=>K.isFolder&&M(K),children:[n.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[le(K),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-toss-gray-900 truncate",children:K.name}),!K.isFolder&&n.jsx("p",{className:"text-xs text-toss-gray-500",children:ne(K.size)})]})]}),K.isFolder?n.jsx(pa,{size:20,className:"text-toss-gray-400"}):n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:S=>{S.stopPropagation(),G(K)},className:"p-2 text-toss-blue hover:bg-toss-blue/10 rounded-lg transition-colors",title:"",children:n.jsx(ts,{size:18})}),n.jsx("button",{onClick:S=>{S.stopPropagation(),P(K)},className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"",children:n.jsx(Jt,{size:18})})]})]},K.id||K.path))}):n.jsx("div",{className:"text-center text-toss-gray-500 py-12",children:h?"  ":"   "})}),g.length>0&&!h&&n.jsxs("p",{className:"text-sm text-toss-gray-500 text-center",children:[g.length,"  "]}),n.jsx(dr,{isOpen:E,onClose:()=>C(!1),title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-sm text-toss-gray-600",children:"  Dropbox     ."}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:B,onChange:K=>F(K.target.value),placeholder:"  ",className:"flex-1 px-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent",onKeyDown:K=>K.key==="Enter"&&ae()}),n.jsxs(Ye,{onClick:ae,children:[n.jsx(ps,{size:18}),""]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"text-sm font-medium text-toss-gray-700",children:" "}),k.length>0?n.jsx("div",{className:"flex flex-wrap gap-2",children:k.map(K=>n.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-toss-gray-100 rounded-full",children:[n.jsx(Fd,{size:14,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:K}),n.jsx("button",{onClick:()=>Q(K),className:"p-0.5 hover:bg-toss-gray-200 rounded-full transition-colors",children:n.jsx(mr,{size:14,className:"text-toss-gray-500"})})]},K))}):n.jsx("p",{className:"text-sm text-toss-gray-500",children:"  ."})]}),n.jsx("div",{className:"flex justify-end pt-4",children:n.jsx(Ye,{variant:"secondary",onClick:()=>C(!1),children:""})})]})}),n.jsx(dr,{isOpen:L,onClose:()=>{O(!1),V([])},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-toss-gray-600 mb-2",children:[" : ",n.jsxs("span",{className:"font-medium",children:[D.length,""]})]}),n.jsx("div",{className:"max-h-32 overflow-y-auto bg-toss-gray-50 rounded-xl p-3",children:D.map((K,S)=>n.jsx("p",{className:"text-sm text-toss-gray-700 truncate",children:K.name},S))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  ()"}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("button",{onClick:()=>fe(""),className:`px-4 py-2 rounded-xl text-sm font-medium transition-colors ${q===""?"bg-toss-blue text-white":"bg-toss-gray-100 text-toss-gray-700 hover:bg-toss-gray-200"}`,children:"  "}),k.map(K=>n.jsxs("button",{onClick:()=>fe(K),className:`flex items-center gap-1.5 px-4 py-2 rounded-xl text-sm font-medium transition-colors ${q===K?"bg-toss-blue text-white":"bg-toss-gray-100 text-toss-gray-700 hover:bg-toss-gray-200"}`,children:[n.jsx(Fd,{size:14}),K]},K))]}),q&&n.jsxs("p",{className:"mt-2 text-xs text-toss-gray-500",children:[' "',te(),"/",q,'"  .']})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{O(!1),V([])},children:""}),n.jsx(Ye,{onClick:ce,children:""})]})]})})]})};function WU(){const{profile:e,isAdmin:t,isSubAdmin:r}=Kr(),[s,a]=X.useState([]),[o,l]=X.useState([]),[u,d]=X.useState(null),[h,m]=X.useState(!1),[x,y]=X.useState(null),v=X.useCallback(async()=>{try{m(!0);const{data:L,error:O}=await Pe.from("document_ledger_labels").select("*").order("created_at",{ascending:!0});if(O)throw O;if(a(L||[]),L&&L.length>0&&!u){const B=L.find(F=>F.name===e?.team);d(B||L[0])}}catch(L){y(L.message),console.error("  :",L)}finally{m(!1)}},[u,e?.team]),b=async L=>{try{m(!0);const{data:O,error:B}=await Pe.from("document_ledger_labels").insert([{name:L}]).select().single();if(B)throw B;return a(F=>[...F,O]),{success:!0,data:O}}catch(O){return y(O.message),console.error("  :",O),{success:!1,error:O.message}}finally{m(!1)}},g=async(L,O)=>{try{m(!0);const{data:B,error:F}=await Pe.from("document_ledger_labels").update({name:O}).eq("id",L).select().single();if(F)throw F;return a(q=>q.map(fe=>fe.id===L?B:fe)),u?.id===L&&d(B),{success:!0,data:B}}catch(B){return y(B.message),console.error("  :",B),{success:!1,error:B.message}}finally{m(!1)}},_=async L=>{try{m(!0);const{error:O}=await Pe.from("document_ledger_labels").delete().eq("id",L);if(O)throw O;if(a(B=>B.filter(F=>F.id!==L)),u?.id===L){const B=s.filter(F=>F.id!==L);d(B.length>0?B[0]:null)}return{success:!0}}catch(O){return y(O.message),console.error("  :",O),{success:!1,error:O.message}}finally{m(!1)}},w=X.useCallback(async L=>{if(L)try{m(!0);const{data:O,error:B}=await Pe.from("document_ledger").select("*").eq("label_id",L).order("row_number",{ascending:!0});if(B)throw B;l(O||[])}catch(O){y(O.message),console.error("   :",O)}finally{m(!1)}},[]),k=async L=>{try{m(!0);const{data:O,error:B}=await Pe.from("document_ledger").insert([L]).select().single();if(B)throw B;return l(F=>[...F,O].sort((q,fe)=>q.row_number-fe.row_number)),{success:!0,data:O}}catch(O){return y(O.message),console.error("  :",O),{success:!1,error:O.message}}finally{m(!1)}},N=async(L,O)=>{try{m(!0);const{data:B,error:F}=await Pe.from("document_ledger").update(O).eq("id",L).select().single();if(F)throw F;return l(q=>q.map(fe=>fe.id===L?B:fe)),{success:!0,data:B}}catch(B){return y(B.message),console.error("  :",B),{success:!1,error:B.message}}finally{m(!1)}},E=async L=>{try{m(!0);const{error:O}=await Pe.from("document_ledger").delete().eq("id",L);if(O)throw O;const B=o.filter(q=>q.id!==L).sort((q,fe)=>q.row_number-fe.row_number),F=B.map((q,fe)=>({id:q.id,row_number:fe+1}));for(const q of F)q.row_number!==B.find(fe=>fe.id===q.id)?.row_number&&await Pe.from("document_ledger").update({row_number:q.row_number}).eq("id",q.id);return l(B.map((q,fe)=>({...q,row_number:fe+1}))),{success:!0}}catch(O){return y(O.message),console.error("  :",O),{success:!1,error:O.message}}finally{m(!1)}},C=()=>o.length===0?1:Math.max(...o.map(L=>L.row_number))+1;return X.useEffect(()=>{e&&v()},[e?.team,t,r]),X.useEffect(()=>{u?.id&&w(u.id)},[u?.id,w]),{labels:s,ledgerData:o,selectedLabel:u,loading:h,error:x,setSelectedLabel:d,addLabel:b,updateLabel:g,deleteLabel:_,fetchLabels:v,fetchLedgerData:w,addLedgerItem:k,updateLedgerItem:N,deleteLedgerItem:E,getNextRowNumber:C}}var I0={};I0.version="0.18.5";var Wj=1252,GU=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Cv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Rv=function(e){GU.indexOf(e)!=-1&&(Wj=Cv[0]=e)};function VU(){Rv(1252)}var kn=function(e){Rv(e)};function Dv(){kn(1200),VU()}function Tk(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function KU(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Gj(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ud=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?KU(e.slice(2)):t==254&&r==255?Gj(e.slice(2)):t==65279?e.slice(1):e},Yh=function(t){return String.fromCharCode(t)},Ak=function(t){return String.fromCharCode(t)},Bd,uo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Pd(e){for(var t="",r=0,s=0,a=0,o=0,l=0,u=0,d=0,h=0;h<e.length;)r=e.charCodeAt(h++),o=r>>2,s=e.charCodeAt(h++),l=(r&3)<<4|s>>4,a=e.charCodeAt(h++),u=(s&15)<<2|a>>6,d=a&63,isNaN(s)?u=d=64:isNaN(a)&&(d=64),t+=uo.charAt(o)+uo.charAt(l)+uo.charAt(u)+uo.charAt(d);return t}function qa(e){var t="",r=0,s=0,a=0,o=0,l=0,u=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=uo.indexOf(e.charAt(h++)),l=uo.indexOf(e.charAt(h++)),r=o<<2|l>>4,t+=String.fromCharCode(r),u=uo.indexOf(e.charAt(h++)),s=(l&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(s)),d=uo.indexOf(e.charAt(h++)),a=(u&3)<<6|d,d!==64&&(t+=String.fromCharCode(a));return t}var ar=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ri=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function mo(e){return ar?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Ck(e){return ar?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ua=function(t){return ar?Ri(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function pm(e){if(typeof ArrayBuffer>"u")return Ua(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function bo(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function XU(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Ov(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ov(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Is=ar?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ri(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function YU(e){for(var t=[],r=0,s=e.length+250,a=mo(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=e.charCodeAt(++o)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|u>>6&15|(l&3)<<4,a[r++]=128|u&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>s&&(t.push(a.slice(0,r)),r=0,a=mo(65535),s=65530)}return t.push(a.slice(0,r)),Is(t)}var ma=/\u0000/g,dd=/[\u0001-\u0006]/g;function Mc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function En(e,t){var r=""+e;return r.length>=t?r:is("0",t-r.length)+r}function Fv(e,t){var r=""+e;return r.length>=t?r:is(" ",t-r.length)+r}function M0(e,t){var r=""+e;return r.length>=t?r:r+is(" ",t-r.length)}function JU(e,t){var r=""+Math.round(e);return r.length>=t?r:is("0",t-r.length)+r}function ZU(e,t){var r=""+e;return r.length>=t?r:is("0",t-r.length)+r}var Rk=Math.pow(2,32);function gc(e,t){if(e>Rk||e<-Rk)return JU(e,t);var r=Math.round(e);return ZU(r,t)}function B0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Dk=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Y1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function QU(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Wt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ok={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ez={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function P0(e,t,r){for(var s=e<0?-1:1,a=e*s,o=0,l=1,u=0,d=1,h=0,m=0,x=Math.floor(a);h<t&&(x=Math.floor(a),u=x*l+o,m=x*h+d,!(a-x<5e-8));)a=1/(a-x),o=l,l=u,d=h,h=m;if(m>t&&(h>t?(m=d,u=o):(m=h,u=l)),!r)return[0,s*u,m];var y=Math.floor(s*u/m);return[y,s*u-y*m,m]}function tl(e,t,r){if(e>2958465||e<0)return null;var s=e|0,a=Math.floor(86400*(e-s)),o=0,l=[],u={D:s,T:a,u:86400*(e-s)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(s+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++s,++u.D)),s===60)l=r?[1317,10,29]:[1900,2,29],o=3;else if(s===0)l=r?[1317,8,29]:[1900,1,0],o=6;else{s>60&&--s;var d=new Date(1900,0,1);d.setDate(d.getDate()+s-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],o=d.getDay(),s<60&&(o=(o+6)%7),r&&(o=iz(d,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var Vj=new Date(1899,11,31,0,0,0),tz=Vj.getTime(),rz=new Date(1900,2,1,0,0,0);function Kj(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=rz&&(r+=1440*60*1e3),(r-(tz+(e.getTimezoneOffset()-Vj.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Lv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function sz(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function az(e){var t=e<0?12:11,r=Lv(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function nz(e){var t=Lv(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Ud(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=az(e):t===10?r=e.toFixed(10).substr(0,12):r=nz(e),Lv(sz(r.toUpperCase()))}function dl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ud(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return hn(14,Kj(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function iz(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function oz(e,t,r,s){var a="",o=0,l=0,u=r.y,d,h=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:d=u%100,h=2;break;default:d=u%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,h=t.length;break;case 3:return Y1[r.m-1][1];case 5:return Y1[r.m-1][0];default:return Y1[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,h=t.length;break;case 3:return Dk[r.q][0];default:return Dk[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?En(r.S,t.length):(s>=2?l=s===3?1e3:100:l=s===1?10:1,o=Math.round(l*(r.S+r.u)),o>=60*l&&(o=0),t==="s"?o===0?"0":""+o/l:(a=En(o,2+s),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:d=u,h=1;break}var m=h>0?En(d,h):"";return m}function fo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var Xj=/%/g;function lz(e,t,r){var s=t.replace(Xj,""),a=t.length-s.length;return yi(e,s,r*Math.pow(10,2*a))+is("%",a)}function cz(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return yi(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function Yj(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Yj(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(t/Math.pow(10,o)).toPrecision(s+1+(a+o)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,h,m){return d+h+m.substr(0,(a+o)%a)+"."+m.substr(o)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Jj=/# (\?+)( ?)\/( ?)(\d+)/;function uz(e,t,r){var s=parseInt(e[4],10),a=Math.round(t*s),o=Math.floor(a/s),l=a-o*s,u=s;return r+(o===0?"":""+o)+" "+(l===0?is(" ",e[1].length+1+e[4].length):Fv(l,e[1].length)+e[2]+"/"+e[3]+En(u,e[4].length))}function dz(e,t,r){return r+(t===0?"":""+t)+is(" ",e[1].length+2+e[4].length)}var Zj=/^#*0*\.([0#]+)/,Qj=/\).*[0#]/,e5=/\(###\) ###\\?-####/;function da(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Fk(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Lk(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function fz(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function hz(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function nn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Qj)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?nn("n",s,r):"("+nn("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return cz(e,t,r);if(t.indexOf("%")!==-1)return lz(e,t,r);if(t.indexOf("E")!==-1)return Yj(t,r);if(t.charCodeAt(0)===36)return"$"+nn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,o,l,u,d=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+gc(d,t.length);if(t.match(/^[#?]+$/))return a=gc(r,0),a==="0"&&(a=""),a.length>t.length?a:da(t.substr(0,t.length-a.length))+a;if(o=t.match(Jj))return uz(o,d,h);if(t.match(/^#+0+$/))return h+gc(d,t.length-t.indexOf("0"));if(o=t.match(Zj))return a=Fk(r,o[1].length).replace(/^([^\.]+)$/,"$1."+da(o[1])).replace(/\.$/,"."+da(o[1])).replace(/\.(\d*)$/,function(b,g){return"."+g+is("0",da(o[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return h+Fk(d,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return h+fo(gc(d,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+nn(e,t,-r):fo(""+(Math.floor(r)+fz(r,o[1].length)))+"."+En(Lk(r,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return nn(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Mc(nn(e,t.replace(/[\\-]/g,""),r)),l=0,Mc(Mc(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<a.length?a.charAt(l++):b==="0"?"0":""}));if(t.match(e5))return a=nn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=P0(d,Math.pow(10,l)-1,!1),a=""+h,m=yi("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+o[2]+"/"+o[3],m=M0(u[2],l),m.length<o[4].length&&(m=da(o[4].substr(o[4].length-m.length))+m),a+=m,a;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=P0(d,Math.pow(10,l)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Fv(u[1],l)+o[2]+"/"+o[3]+M0(u[2],l):is(" ",2*l+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return a=gc(r,0),t.length<=a.length?a:da(t.substr(0,t.length-a.length))+a;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=t.indexOf(".")-l,y=t.length-a.length-x;return da(t.substr(0,x)+a+t.substr(t.length-y))}if(o=t.match(/^00,000\.([#0]*0)$/))return l=Lk(r,o[1].length),r<0?"-"+nn(e,t,-r):fo(hz(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?En(0,3-b.length):"")+b})+"."+En(l,o[1].length);switch(t){case"###,##0.00":return nn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=fo(gc(d,0));return v!=="0"?h+v:"";case"###,###.00":return nn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return nn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function mz(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return yi(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function pz(e,t,r){var s=t.replace(Xj,""),a=t.length-s.length;return yi(e,s,r*Math.pow(10,2*a))+is("%",a)}function t5(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+t5(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(t/Math.pow(10,o)).toPrecision(s+1+(a+o)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,h,m){return d+h+m.substr(0,(a+o)%a)+"."+m.substr(o)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ln(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Qj)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ln("n",s,r):"("+Ln("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return mz(e,t,r);if(t.indexOf("%")!==-1)return pz(e,t,r);if(t.indexOf("E")!==-1)return t5(t,r);if(t.charCodeAt(0)===36)return"$"+Ln(e,t.substr(t.charAt(1)==" "?2:1),r);var a,o,l,u,d=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+En(d,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:da(t.substr(0,t.length-a.length))+a;if(o=t.match(Jj))return dz(o,d,h);if(t.match(/^#+0+$/))return h+En(d,t.length-t.indexOf("0"));if(o=t.match(Zj))return a=(""+r).replace(/^([^\.]+)$/,"$1."+da(o[1])).replace(/\.$/,"."+da(o[1])),a=a.replace(/\.(\d*)$/,function(b,g){return"."+g+is("0",da(o[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return h+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return h+fo(""+d);if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ln(e,t,-r):fo(""+r)+"."+is("0",o[1].length);if(o=t.match(/^#,#*,#0/))return Ln(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Mc(Ln(e,t.replace(/[\\-]/g,""),r)),l=0,Mc(Mc(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<a.length?a.charAt(l++):b==="0"?"0":""}));if(t.match(e5))return a=Ln(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=P0(d,Math.pow(10,l)-1,!1),a=""+h,m=yi("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+o[2]+"/"+o[3],m=M0(u[2],l),m.length<o[4].length&&(m=da(o[4].substr(o[4].length-m.length))+m),a+=m,a;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=P0(d,Math.pow(10,l)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Fv(u[1],l)+o[2]+"/"+o[3]+M0(u[2],l):is(" ",2*l+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:da(t.substr(0,t.length-a.length))+a;if(o=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=t.indexOf(".")-l,y=t.length-a.length-x;return da(t.substr(0,x)+a+t.substr(t.length-y))}if(o=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ln(e,t,-r):fo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?En(0,3-b.length):"")+b})+"."+En(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=fo(""+d);return v!=="0"?h+v:"";default:if(t.match(/\.[0#?]*$/))return Ln(e,t.slice(0,t.lastIndexOf(".")),r)+da(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function yi(e,t,r){return(r|0)===r?Ln(e,t,r):nn(e,t,r)}function xz(e){for(var t=[],r=!1,s=0,a=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(a,s-a),a=s+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var r5=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function au(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":B0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(r5))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function gz(e,t,r,s){for(var a=[],o="",l=0,u="",d="t",h,m,x,y="H";l<e.length;)switch(u=e.charAt(l)){case"G":if(!B0(e,l))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(x=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(x);a[a.length]={t:"t",v:o},++l;break;case"\\":var v=e.charAt(++l),b=v==="("||v===")"?v:"t";a[a.length]={t:b,v},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(h==null&&(h=tl(t,r,e.charAt(l+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},d=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=tl(t,r),h==null))return"";for(o=u;++l<e.length&&e.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&d.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),a[a.length]={t:u,v:o},d=u;break;case"A":case"a":case"":var g={t:u,v:u};if(h==null&&(h=tl(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(h!=null&&(g.v=h.H>=12?"P":"A"),g.t="T",y="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(h!=null&&(g.v=h.H>=12?"PM":"AM"),g.t="T",l+=5,y="h"):e.substr(l,5).toUpperCase()==="/"?(h!=null&&(g.v=h.H>=12?"":""),g.t="T",l+=5,y="h"):(g.t="t",++l),h==null&&g.t==="T")return"";a[a.length]=g,d=u;break;case"[":for(o=u;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(r5)){if(h==null&&(h=tl(t,r),h==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},d=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",au(e)||(a[a.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=u;++l<e.length&&(u=e.charAt(l))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(l))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;e.charAt(++l)===u;)o+=u;a[a.length]={t:u,v:o},d=u;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:s===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++l;break}var _=0,w=0,k;for(l=a.length-1,d="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=y,d="h",_<1&&(_=1);break;case"s":(k=a[l].v.match(/\.0+$/))&&(w=Math.max(w,k[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":d=a[l].t;break;case"m":d==="s"&&(a[l].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[l].v.match(/[Hh]/)&&(_=1),_<2&&a[l].v.match(/[Mm]/)&&(_=2),_<3&&a[l].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var N="",E;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=oz(a[l].t.charCodeAt(0),a[l].v,h,w),a[l].t="t";break;case"n":case"?":for(E=l+1;a[E]!=null&&((u=a[E].t)==="?"||u==="D"||(u===" "||u==="t")&&a[E+1]!=null&&(a[E+1].t==="?"||a[E+1].t==="t"&&a[E+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[E].v==="/"||a[E].v===" "&&a[E+1]!=null&&a[E+1].t=="?"));)a[l].v+=a[E].v,a[E]={v:"",t:";"},++E;N+=a[l].v,l=E-1;break;case"G":a[l].t="t",a[l].v=dl(t,r);break}var C="",L,O;if(N.length>0){N.charCodeAt(0)==40?(L=t<0&&N.charCodeAt(0)===45?-t:t,O=yi("n",N,L)):(L=t<0&&s>1?-t:t,O=yi("n",N,L),L<0&&a[0]&&a[0].t=="t"&&(O=O.substr(1),a[0].v="-"+a[0].v)),E=O.length-1;var B=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){B=l;break}var F=a.length;if(B===a.length&&O.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(E>=a[l].v.length-1?(E-=a[l].v.length,a[l].v=O.substr(E+1,a[l].v.length)):E<0?a[l].v="":(a[l].v=O.substr(0,E+1),E=-1),a[l].t="t",F=l);E>=0&&F<a.length&&(a[F].v=O.substr(0,E+1)+a[F].v)}else if(B!==a.length&&O.indexOf("E")===-1){for(E=O.indexOf(".")-1,l=B;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(m=a[l].v.indexOf(".")>-1&&l===B?a[l].v.indexOf(".")-1:a[l].v.length-1,C=a[l].v.substr(m+1);m>=0;--m)E>=0&&(a[l].v.charAt(m)==="0"||a[l].v.charAt(m)==="#")&&(C=O.charAt(E--)+C);a[l].v=C,a[l].t="t",F=l}for(E>=0&&F<a.length&&(a[F].v=O.substr(0,E+1)+a[F].v),E=O.indexOf(".")+1,l=B;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==B)){for(m=a[l].v.indexOf(".")>-1&&l===B?a[l].v.indexOf(".")+1:0,C=a[l].v.substr(0,m);m<a[l].v.length;++m)E<O.length&&(C+=O.charAt(E++));a[l].v=C,a[l].t="t",F=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(L=s>1&&t<0&&l>0&&a[l-1].v==="-"?-t:t,a[l].v=yi(a[l].t,a[l].v,L),a[l].t="t");var q="";for(l=0;l!==a.length;++l)a[l]!=null&&(q+=a[l].v);return q}var Ik=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Mk(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function yz(e,t){var r=xz(e),s=r.length,a=r[s-1].indexOf("@");if(s<4&&a>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(Ik),u=r[1].match(Ik);return Mk(t,l)?[s,r[0]]:Mk(t,u)?[s,r[1]]:[s,r[l!=null&&u!=null?2:1]]}return[s,o]}function hn(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:Wt)[e],s==null&&(s=r.table&&r.table[Ok[e]]||Wt[Ok[e]]),s==null&&(s=ez[e]||"General");break}if(B0(s,0))return dl(t,r);t instanceof Date&&(t=Kj(t,r.date1904));var a=yz(s,t);if(B0(a[1]))return dl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return gz(a[1],t,r,a[0])}function vi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Wt[r]==null){t<0&&(t=r);continue}if(Wt[r]==e){t=r;break}}t<0&&(t=391)}return Wt[t]=e,t}function xm(e){for(var t=0;t!=392;++t)e[t]!==void 0&&vi(e[t],t)}function nu(){Wt=QU()}var vz={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},s5=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function bz(e){var t=typeof e=="number"?Wt[e]:e;return t=t.replace(s5,"(\\d+)"),new RegExp("^"+t+"$")}function wz(e,t,r){var s=-1,a=-1,o=-1,l=-1,u=-1,d=-1;(t.match(s5)||[]).forEach(function(x,y){var v=parseInt(r[y+1],10);switch(x.toLowerCase().charAt(0)){case"y":s=v;break;case"d":o=v;break;case"h":l=v;break;case"s":d=v;break;case"m":l>=0?u=v:a=v;break}}),d>=0&&u==-1&&a>=0&&(u=a,a=-1);var h=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&u==-1&&d==-1?h:s==-1&&a==-1&&o==-1?m:h+"T"+m}var _z=(function(){var e={};e.version="1.2.0";function t(){for(var O=0,B=new Array(256),F=0;F!=256;++F)O=F,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,B[F]=O;return typeof Int32Array<"u"?new Int32Array(B):B}var r=t();function s(O){var B=0,F=0,q=0,fe=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(q=0;q!=256;++q)fe[q]=O[q];for(q=0;q!=256;++q)for(F=O[q],B=256+q;B<4096;B+=256)F=fe[B]=F>>>8^O[F&255];var D=[];for(q=1;q!=16;++q)D[q-1]=typeof Int32Array<"u"?fe.subarray(q*256,q*256+256):fe.slice(q*256,q*256+256);return D}var a=s(r),o=a[0],l=a[1],u=a[2],d=a[3],h=a[4],m=a[5],x=a[6],y=a[7],v=a[8],b=a[9],g=a[10],_=a[11],w=a[12],k=a[13],N=a[14];function E(O,B){for(var F=B^-1,q=0,fe=O.length;q<fe;)F=F>>>8^r[(F^O.charCodeAt(q++))&255];return~F}function C(O,B){for(var F=B^-1,q=O.length-15,fe=0;fe<q;)F=N[O[fe++]^F&255]^k[O[fe++]^F>>8&255]^w[O[fe++]^F>>16&255]^_[O[fe++]^F>>>24]^g[O[fe++]]^b[O[fe++]]^v[O[fe++]]^y[O[fe++]]^x[O[fe++]]^m[O[fe++]]^h[O[fe++]]^d[O[fe++]]^u[O[fe++]]^l[O[fe++]]^o[O[fe++]]^r[O[fe++]];for(q+=15;fe<q;)F=F>>>8^r[(F^O[fe++])&255];return~F}function L(O,B){for(var F=B^-1,q=0,fe=O.length,D=0,V=0;q<fe;)D=O.charCodeAt(q++),D<128?F=F>>>8^r[(F^D)&255]:D<2048?(F=F>>>8^r[(F^(192|D>>6&31))&255],F=F>>>8^r[(F^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,V=O.charCodeAt(q++)&1023,F=F>>>8^r[(F^(240|D>>8&7))&255],F=F>>>8^r[(F^(128|D>>2&63))&255],F=F>>>8^r[(F^(128|V>>6&15|(D&3)<<4))&255],F=F>>>8^r[(F^(128|V&63))&255]):(F=F>>>8^r[(F^(224|D>>12&15))&255],F=F>>>8^r[(F^(128|D>>6&63))&255],F=F>>>8^r[(F^(128|D&63))&255]);return~F}return e.table=r,e.bstr=E,e.buf=C,e.str=L,e})(),Pt=(function(){var t={};t.version="1.2.1";function r(he,we){for(var ye=he.split("/"),be=we.split("/"),ke=0,Ee=0,We=Math.min(ye.length,be.length);ke<We;++ke){if(Ee=ye[ke].length-be[ke].length)return Ee;if(ye[ke]!=be[ke])return ye[ke]<be[ke]?-1:1}return ye.length-be.length}function s(he){if(he.charAt(he.length-1)=="/")return he.slice(0,-1).indexOf("/")===-1?he:s(he.slice(0,-1));var we=he.lastIndexOf("/");return we===-1?he:he.slice(0,we+1)}function a(he){if(he.charAt(he.length-1)=="/")return a(he.slice(0,-1));var we=he.lastIndexOf("/");return we===-1?he:he.slice(we+1)}function o(he,we){typeof we=="string"&&(we=new Date(we));var ye=we.getHours();ye=ye<<6|we.getMinutes(),ye=ye<<5|we.getSeconds()>>>1,he.write_shift(2,ye);var be=we.getFullYear()-1980;be=be<<4|we.getMonth()+1,be=be<<5|we.getDate(),he.write_shift(2,be)}function l(he){var we=he.read_shift(2)&65535,ye=he.read_shift(2)&65535,be=new Date,ke=ye&31;ye>>>=5;var Ee=ye&15;ye>>>=4,be.setMilliseconds(0),be.setFullYear(ye+1980),be.setMonth(Ee-1),be.setDate(ke);var We=we&31;we>>>=5;var st=we&63;return we>>>=6,be.setHours(we),be.setMinutes(st),be.setSeconds(We<<1),be}function u(he){Ks(he,0);for(var we={},ye=0;he.l<=he.length-4;){var be=he.read_shift(2),ke=he.read_shift(2),Ee=he.l+ke,We={};be===21589&&(ye=he.read_shift(1),ye&1&&(We.mtime=he.read_shift(4)),ke>5&&(ye&2&&(We.atime=he.read_shift(4)),ye&4&&(We.ctime=he.read_shift(4))),We.mtime&&(We.mt=new Date(We.mtime*1e3))),he.l=Ee,we[be]=We}return we}var d;function h(){return d||(d={})}function m(he,we){if(he[0]==80&&he[1]==75)return Ne(he,we);if((he[0]|32)==109&&(he[1]|32)==105)return Vt(he,we);if(he.length<512)throw new Error("CFB file size "+he.length+" < 512");var ye=3,be=512,ke=0,Ee=0,We=0,st=0,$e=0,qe=[],Ke=he.slice(0,512);Ks(Ke,0);var ft=x(Ke);switch(ye=ft[0],ye){case 3:be=512;break;case 4:be=4096;break;case 0:if(ft[1]==0)return Ne(he,we);default:throw new Error("Major Version: Expected 3 or 4 saw "+ye)}be!==512&&(Ke=he.slice(0,be),Ks(Ke,28));var vt=he.slice(0,be);y(Ke,ye);var kt=Ke.read_shift(4,"i");if(ye===3&&kt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+kt);Ke.l+=4,We=Ke.read_shift(4,"i"),Ke.l+=4,Ke.chk("00100000","Mini Stream Cutoff Size: "),st=Ke.read_shift(4,"i"),ke=Ke.read_shift(4,"i"),$e=Ke.read_shift(4,"i"),Ee=Ke.read_shift(4,"i");for(var xt=-1,me=0;me<109&&(xt=Ke.read_shift(4,"i"),!(xt<0));++me)qe[me]=xt;var Ie=v(he,be);_($e,Ee,Ie,be,qe);var bt=k(Ie,We,qe,be);bt[We].name="!Directory",ke>0&&st!==V&&(bt[st].name="!MiniFAT"),bt[qe[0]].name="!FAT",bt.fat_addrs=qe,bt.ssz=be;var yt={},Ut=[],Br=[],us=[];N(We,bt,Ie,Ut,ke,yt,Br,st),b(Br,us,Ut),Ut.shift();var ds={FileIndex:Br,FullPaths:us};return we&&we.raw&&(ds.raw={header:vt,sectors:Ie}),ds}function x(he){if(he[he.l]==80&&he[he.l+1]==75)return[0,0];he.chk(I,"Header Signature: "),he.l+=16;var we=he.read_shift(2,"u");return[he.read_shift(2,"u"),we]}function y(he,we){var ye=9;switch(he.l+=2,ye=he.read_shift(2)){case 9:if(we!=3)throw new Error("Sector Shift: Expected 9 saw "+ye);break;case 12:if(we!=4)throw new Error("Sector Shift: Expected 12 saw "+ye);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ye)}he.chk("0600","Mini Sector Shift: "),he.chk("000000000000","Reserved: ")}function v(he,we){for(var ye=Math.ceil(he.length/we)-1,be=[],ke=1;ke<ye;++ke)be[ke-1]=he.slice(ke*we,(ke+1)*we);return be[ye-1]=he.slice(ye*we),be}function b(he,we,ye){for(var be=0,ke=0,Ee=0,We=0,st=0,$e=ye.length,qe=[],Ke=[];be<$e;++be)qe[be]=Ke[be]=be,we[be]=ye[be];for(;st<Ke.length;++st)be=Ke[st],ke=he[be].L,Ee=he[be].R,We=he[be].C,qe[be]===be&&(ke!==-1&&qe[ke]!==ke&&(qe[be]=qe[ke]),Ee!==-1&&qe[Ee]!==Ee&&(qe[be]=qe[Ee])),We!==-1&&(qe[We]=be),ke!==-1&&be!=qe[be]&&(qe[ke]=qe[be],Ke.lastIndexOf(ke)<st&&Ke.push(ke)),Ee!==-1&&be!=qe[be]&&(qe[Ee]=qe[be],Ke.lastIndexOf(Ee)<st&&Ke.push(Ee));for(be=1;be<$e;++be)qe[be]===be&&(Ee!==-1&&qe[Ee]!==Ee?qe[be]=qe[Ee]:ke!==-1&&qe[ke]!==ke&&(qe[be]=qe[ke]));for(be=1;be<$e;++be)if(he[be].type!==0){if(st=be,st!=qe[st])do st=qe[st],we[be]=we[st]+"/"+we[be];while(st!==0&&qe[st]!==-1&&st!=qe[st]);qe[be]=-1}for(we[0]+="/",be=1;be<$e;++be)he[be].type!==2&&(we[be]+="/")}function g(he,we,ye){for(var be=he.start,ke=he.size,Ee=[],We=be;ye&&ke>0&&We>=0;)Ee.push(we.slice(We*D,We*D+D)),ke-=D,We=Jo(ye,We*4);return Ee.length===0?nt(0):Is(Ee).slice(0,he.size)}function _(he,we,ye,be,ke){var Ee=V;if(he===V){if(we!==0)throw new Error("DIFAT chain shorter than expected")}else if(he!==-1){var We=ye[he],st=(be>>>2)-1;if(!We)return;for(var $e=0;$e<st&&(Ee=Jo(We,$e*4))!==V;++$e)ke.push(Ee);_(Jo(We,be-4),we-1,ye,be,ke)}}function w(he,we,ye,be,ke){var Ee=[],We=[];ke||(ke=[]);var st=be-1,$e=0,qe=0;for($e=we;$e>=0;){ke[$e]=!0,Ee[Ee.length]=$e,We.push(he[$e]);var Ke=ye[Math.floor($e*4/be)];if(qe=$e*4&st,be<4+qe)throw new Error("FAT boundary crossed: "+$e+" 4 "+be);if(!he[Ke])break;$e=Jo(he[Ke],qe)}return{nodes:Ee,data:Xk([We])}}function k(he,we,ye,be){var ke=he.length,Ee=[],We=[],st=[],$e=[],qe=be-1,Ke=0,ft=0,vt=0,kt=0;for(Ke=0;Ke<ke;++Ke)if(st=[],vt=Ke+we,vt>=ke&&(vt-=ke),!We[vt]){$e=[];var xt=[];for(ft=vt;ft>=0;){xt[ft]=!0,We[ft]=!0,st[st.length]=ft,$e.push(he[ft]);var me=ye[Math.floor(ft*4/be)];if(kt=ft*4&qe,be<4+kt)throw new Error("FAT boundary crossed: "+ft+" 4 "+be);if(!he[me]||(ft=Jo(he[me],kt),xt[ft]))break}Ee[vt]={nodes:st,data:Xk([$e])}}return Ee}function N(he,we,ye,be,ke,Ee,We,st){for(var $e=0,qe=be.length?2:0,Ke=we[he].data,ft=0,vt=0,kt;ft<Ke.length;ft+=128){var xt=Ke.slice(ft,ft+128);Ks(xt,64),vt=xt.read_shift(2),kt=$v(xt,0,vt-qe),be.push(kt);var me={name:kt,type:xt.read_shift(1),color:xt.read_shift(1),L:xt.read_shift(4,"i"),R:xt.read_shift(4,"i"),C:xt.read_shift(4,"i"),clsid:xt.read_shift(16),state:xt.read_shift(4,"i"),start:0,size:0},Ie=xt.read_shift(2)+xt.read_shift(2)+xt.read_shift(2)+xt.read_shift(2);Ie!==0&&(me.ct=E(xt,xt.l-8));var bt=xt.read_shift(2)+xt.read_shift(2)+xt.read_shift(2)+xt.read_shift(2);bt!==0&&(me.mt=E(xt,xt.l-8)),me.start=xt.read_shift(4,"i"),me.size=xt.read_shift(4,"i"),me.size<0&&me.start<0&&(me.size=me.type=0,me.start=V,me.name=""),me.type===5?($e=me.start,ke>0&&$e!==V&&(we[$e].name="!StreamData")):me.size>=4096?(me.storage="fat",we[me.start]===void 0&&(we[me.start]=w(ye,me.start,we.fat_addrs,we.ssz)),we[me.start].name=me.name,me.content=we[me.start].data.slice(0,me.size)):(me.storage="minifat",me.size<0?me.size=0:$e!==V&&me.start!==V&&we[$e]&&(me.content=g(me,we[$e].data,(we[st]||{}).data))),me.content&&Ks(me.content,0),Ee[kt]=me,We.push(me)}}function E(he,we){return new Date((Ma(he,we+4)/1e7*Math.pow(2,32)+Ma(he,we)/1e7-11644473600)*1e3)}function C(he,we){return h(),m(d.readFileSync(he),we)}function L(he,we){var ye=we&&we.type;switch(ye||ar&&Buffer.isBuffer(he)&&(ye="buffer"),ye||"base64"){case"file":return C(he,we);case"base64":return m(Ua(qa(he)),we);case"binary":return m(Ua(he),we)}return m(he,we)}function O(he,we){var ye=we||{},be=ye.root||"Root Entry";if(he.FullPaths||(he.FullPaths=[]),he.FileIndex||(he.FileIndex=[]),he.FullPaths.length!==he.FileIndex.length)throw new Error("inconsistent CFB structure");he.FullPaths.length===0&&(he.FullPaths[0]=be+"/",he.FileIndex[0]={name:be,type:5}),ye.CLSID&&(he.FileIndex[0].clsid=ye.CLSID),B(he)}function B(he){var we="Sh33tJ5";if(!Pt.find(he,"/"+we)){var ye=nt(4);ye[0]=55,ye[1]=ye[3]=50,ye[2]=54,he.FileIndex.push({name:we,type:2,content:ye,size:4,L:69,R:69,C:69}),he.FullPaths.push(he.FullPaths[0]+we),F(he)}}function F(he,we){O(he);for(var ye=!1,be=!1,ke=he.FullPaths.length-1;ke>=0;--ke){var Ee=he.FileIndex[ke];switch(Ee.type){case 0:be?ye=!0:(he.FileIndex.pop(),he.FullPaths.pop());break;case 1:case 2:case 5:be=!0,isNaN(Ee.R*Ee.L*Ee.C)&&(ye=!0),Ee.R>-1&&Ee.L>-1&&Ee.R==Ee.L&&(ye=!0);break;default:ye=!0;break}}if(!(!ye&&!we)){var We=new Date(1987,1,19),st=0,$e=Object.create?Object.create(null):{},qe=[];for(ke=0;ke<he.FullPaths.length;++ke)$e[he.FullPaths[ke]]=!0,he.FileIndex[ke].type!==0&&qe.push([he.FullPaths[ke],he.FileIndex[ke]]);for(ke=0;ke<qe.length;++ke){var Ke=s(qe[ke][0]);be=$e[Ke],be||(qe.push([Ke,{name:a(Ke).replace("/",""),type:1,clsid:Q,ct:We,mt:We,content:null}]),$e[Ke]=!0)}for(qe.sort(function(kt,xt){return r(kt[0],xt[0])}),he.FullPaths=[],he.FileIndex=[],ke=0;ke<qe.length;++ke)he.FullPaths[ke]=qe[ke][0],he.FileIndex[ke]=qe[ke][1];for(ke=0;ke<qe.length;++ke){var ft=he.FileIndex[ke],vt=he.FullPaths[ke];if(ft.name=a(vt).replace("/",""),ft.L=ft.R=ft.C=-(ft.color=1),ft.size=ft.content?ft.content.length:0,ft.start=0,ft.clsid=ft.clsid||Q,ke===0)ft.C=qe.length>1?1:-1,ft.size=0,ft.type=5;else if(vt.slice(-1)=="/"){for(st=ke+1;st<qe.length&&s(he.FullPaths[st])!=vt;++st);for(ft.C=st>=qe.length?-1:st,st=ke+1;st<qe.length&&s(he.FullPaths[st])!=s(vt);++st);ft.R=st>=qe.length?-1:st,ft.type=1}else s(he.FullPaths[ke+1]||"")==s(vt)&&(ft.R=ke+1),ft.type=2}}}function q(he,we){var ye=we||{};if(ye.fileType=="mad")return yr(he,ye);if(F(he),ye.fileType==="zip")return je(he,ye);var be=(function(kt){for(var xt=0,me=0,Ie=0;Ie<kt.FileIndex.length;++Ie){var bt=kt.FileIndex[Ie];if(bt.content){var yt=bt.content.length;yt>0&&(yt<4096?xt+=yt+63>>6:me+=yt+511>>9)}}for(var Ut=kt.FullPaths.length+3>>2,Br=xt+7>>3,us=xt+127>>7,ds=Br+me+Ut+us,Wa=ds+127>>7,No=Wa<=109?0:Math.ceil((Wa-109)/127);ds+Wa+No+127>>7>Wa;)No=++Wa<=109?0:Math.ceil((Wa-109)/127);var Js=[1,No,Wa,us,Ut,me,xt,0];return kt.FileIndex[0].size=xt<<6,Js[7]=(kt.FileIndex[0].start=Js[0]+Js[1]+Js[2]+Js[3]+Js[4]+Js[5])+(Js[6]+7>>3),Js})(he),ke=nt(be[7]<<9),Ee=0,We=0;{for(Ee=0;Ee<8;++Ee)ke.write_shift(1,ae[Ee]);for(Ee=0;Ee<8;++Ee)ke.write_shift(2,0);for(ke.write_shift(2,62),ke.write_shift(2,3),ke.write_shift(2,65534),ke.write_shift(2,9),ke.write_shift(2,6),Ee=0;Ee<3;++Ee)ke.write_shift(2,0);for(ke.write_shift(4,0),ke.write_shift(4,be[2]),ke.write_shift(4,be[0]+be[1]+be[2]+be[3]-1),ke.write_shift(4,0),ke.write_shift(4,4096),ke.write_shift(4,be[3]?be[0]+be[1]+be[2]-1:V),ke.write_shift(4,be[3]),ke.write_shift(-4,be[1]?be[0]-1:V),ke.write_shift(4,be[1]),Ee=0;Ee<109;++Ee)ke.write_shift(-4,Ee<be[2]?be[1]+Ee:-1)}if(be[1])for(We=0;We<be[1];++We){for(;Ee<236+We*127;++Ee)ke.write_shift(-4,Ee<be[2]?be[1]+Ee:-1);ke.write_shift(-4,We===be[1]-1?V:We+1)}var st=function(kt){for(We+=kt;Ee<We-1;++Ee)ke.write_shift(-4,Ee+1);kt&&(++Ee,ke.write_shift(-4,V))};for(We=Ee=0,We+=be[1];Ee<We;++Ee)ke.write_shift(-4,te.DIFSECT);for(We+=be[2];Ee<We;++Ee)ke.write_shift(-4,te.FATSECT);st(be[3]),st(be[4]);for(var $e=0,qe=0,Ke=he.FileIndex[0];$e<he.FileIndex.length;++$e)Ke=he.FileIndex[$e],Ke.content&&(qe=Ke.content.length,!(qe<4096)&&(Ke.start=We,st(qe+511>>9)));for(st(be[6]+7>>3);ke.l&511;)ke.write_shift(-4,te.ENDOFCHAIN);for(We=Ee=0,$e=0;$e<he.FileIndex.length;++$e)Ke=he.FileIndex[$e],Ke.content&&(qe=Ke.content.length,!(!qe||qe>=4096)&&(Ke.start=We,st(qe+63>>6)));for(;ke.l&511;)ke.write_shift(-4,te.ENDOFCHAIN);for(Ee=0;Ee<be[4]<<2;++Ee){var ft=he.FullPaths[Ee];if(!ft||ft.length===0){for($e=0;$e<17;++$e)ke.write_shift(4,0);for($e=0;$e<3;++$e)ke.write_shift(4,-1);for($e=0;$e<12;++$e)ke.write_shift(4,0);continue}Ke=he.FileIndex[Ee],Ee===0&&(Ke.start=Ke.size?Ke.start-1:V);var vt=Ee===0&&ye.root||Ke.name;if(qe=2*(vt.length+1),ke.write_shift(64,vt,"utf16le"),ke.write_shift(2,qe),ke.write_shift(1,Ke.type),ke.write_shift(1,Ke.color),ke.write_shift(-4,Ke.L),ke.write_shift(-4,Ke.R),ke.write_shift(-4,Ke.C),Ke.clsid)ke.write_shift(16,Ke.clsid,"hex");else for($e=0;$e<4;++$e)ke.write_shift(4,0);ke.write_shift(4,Ke.state||0),ke.write_shift(4,0),ke.write_shift(4,0),ke.write_shift(4,0),ke.write_shift(4,0),ke.write_shift(4,Ke.start),ke.write_shift(4,Ke.size),ke.write_shift(4,0)}for(Ee=1;Ee<he.FileIndex.length;++Ee)if(Ke=he.FileIndex[Ee],Ke.size>=4096)if(ke.l=Ke.start+1<<9,ar&&Buffer.isBuffer(Ke.content))Ke.content.copy(ke,ke.l,0,Ke.size),ke.l+=Ke.size+511&-512;else{for($e=0;$e<Ke.size;++$e)ke.write_shift(1,Ke.content[$e]);for(;$e&511;++$e)ke.write_shift(1,0)}for(Ee=1;Ee<he.FileIndex.length;++Ee)if(Ke=he.FileIndex[Ee],Ke.size>0&&Ke.size<4096)if(ar&&Buffer.isBuffer(Ke.content))Ke.content.copy(ke,ke.l,0,Ke.size),ke.l+=Ke.size+63&-64;else{for($e=0;$e<Ke.size;++$e)ke.write_shift(1,Ke.content[$e]);for(;$e&63;++$e)ke.write_shift(1,0)}if(ar)ke.l=ke.length;else for(;ke.l<ke.length;)ke.write_shift(1,0);return ke}function fe(he,we){var ye=he.FullPaths.map(function($e){return $e.toUpperCase()}),be=ye.map(function($e){var qe=$e.split("/");return qe[qe.length-($e.slice(-1)=="/"?2:1)]}),ke=!1;we.charCodeAt(0)===47?(ke=!0,we=ye[0].slice(0,-1)+we):ke=we.indexOf("/")!==-1;var Ee=we.toUpperCase(),We=ke===!0?ye.indexOf(Ee):be.indexOf(Ee);if(We!==-1)return he.FileIndex[We];var st=!Ee.match(dd);for(Ee=Ee.replace(ma,""),st&&(Ee=Ee.replace(dd,"!")),We=0;We<ye.length;++We)if((st?ye[We].replace(dd,"!"):ye[We]).replace(ma,"")==Ee||(st?be[We].replace(dd,"!"):be[We]).replace(ma,"")==Ee)return he.FileIndex[We];return null}var D=64,V=-2,I="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:I,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ve(he,we,ye){h();var be=q(he,ye);d.writeFileSync(we,be)}function ee(he){for(var we=new Array(he.length),ye=0;ye<he.length;++ye)we[ye]=String.fromCharCode(he[ye]);return we.join("")}function Se(he,we){var ye=q(he,we);switch(we&&we.type||"buffer"){case"file":return h(),d.writeFileSync(we.filename,ye),ye;case"binary":return typeof ye=="string"?ye:ee(ye);case"base64":return Pd(typeof ye=="string"?ye:ee(ye));case"buffer":if(ar)return Buffer.isBuffer(ye)?ye:Ri(ye);case"array":return typeof ye=="string"?Ua(ye):ye}return ye}var J;function M(he){try{var we=he.InflateRaw,ye=new we;if(ye._processChunk(new Uint8Array([3,0]),ye._finishFlushFlag),ye.bytesRead)J=he;else throw new Error("zlib does not expose bytesRead")}catch(be){console.error("cannot use native zlib: "+(be.message||be))}}function Y(he,we){if(!J)return ct(he,we);var ye=J.InflateRaw,be=new ye,ke=be._processChunk(he.slice(he.l),be._finishFlushFlag);return he.l+=be.bytesRead,ke}function G(he){return J?J.deflateRawSync(he):De(he)}var re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],P=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function U(he){var we=(he<<1|he<<11)&139536|(he<<5|he<<15)&558144;return(we>>16|we>>8|we)&255}for(var le=typeof Uint8Array<"u",ne=le?new Uint8Array(256):[],ie=0;ie<256;++ie)ne[ie]=U(ie);function H(he,we){var ye=ne[he&255];return we<=8?ye>>>8-we:(ye=ye<<8|ne[he>>8&255],we<=16?ye>>>16-we:(ye=ye<<8|ne[he>>16&255],ye>>>24-we))}function K(he,we){var ye=we&7,be=we>>>3;return(he[be]|(ye<=6?0:he[be+1]<<8))>>>ye&3}function S(he,we){var ye=we&7,be=we>>>3;return(he[be]|(ye<=5?0:he[be+1]<<8))>>>ye&7}function ue(he,we){var ye=we&7,be=we>>>3;return(he[be]|(ye<=4?0:he[be+1]<<8))>>>ye&15}function z(he,we){var ye=we&7,be=we>>>3;return(he[be]|(ye<=3?0:he[be+1]<<8))>>>ye&31}function T(he,we){var ye=we&7,be=we>>>3;return(he[be]|(ye<=1?0:he[be+1]<<8))>>>ye&127}function A(he,we,ye){var be=we&7,ke=we>>>3,Ee=(1<<ye)-1,We=he[ke]>>>be;return ye<8-be||(We|=he[ke+1]<<8-be,ye<16-be)||(We|=he[ke+2]<<16-be,ye<24-be)||(We|=he[ke+3]<<24-be),We&Ee}function W(he,we,ye){var be=we&7,ke=we>>>3;return be<=5?he[ke]|=(ye&7)<<be:(he[ke]|=ye<<be&255,he[ke+1]=(ye&7)>>8-be),we+3}function pe(he,we,ye){var be=we&7,ke=we>>>3;return ye=(ye&1)<<be,he[ke]|=ye,we+1}function _e(he,we,ye){var be=we&7,ke=we>>>3;return ye<<=be,he[ke]|=ye&255,ye>>>=8,he[ke+1]=ye,we+8}function oe(he,we,ye){var be=we&7,ke=we>>>3;return ye<<=be,he[ke]|=ye&255,ye>>>=8,he[ke+1]=ye&255,he[ke+2]=ye>>>8,we+16}function Te(he,we){var ye=he.length,be=2*ye>we?2*ye:we+5,ke=0;if(ye>=we)return he;if(ar){var Ee=Ck(be);if(he.copy)he.copy(Ee);else for(;ke<he.length;++ke)Ee[ke]=he[ke];return Ee}else if(le){var We=new Uint8Array(be);if(We.set)We.set(he);else for(;ke<ye;++ke)We[ke]=he[ke];return We}return he.length=be,he}function Me(he){for(var we=new Array(he),ye=0;ye<he;++ye)we[ye]=0;return we}function Ae(he,we,ye){var be=1,ke=0,Ee=0,We=0,st=0,$e=he.length,qe=le?new Uint16Array(32):Me(32);for(Ee=0;Ee<32;++Ee)qe[Ee]=0;for(Ee=$e;Ee<ye;++Ee)he[Ee]=0;$e=he.length;var Ke=le?new Uint16Array($e):Me($e);for(Ee=0;Ee<$e;++Ee)qe[ke=he[Ee]]++,be<ke&&(be=ke),Ke[Ee]=0;for(qe[0]=0,Ee=1;Ee<=be;++Ee)qe[Ee+16]=st=st+qe[Ee-1]<<1;for(Ee=0;Ee<$e;++Ee)st=he[Ee],st!=0&&(Ke[Ee]=qe[st+16]++);var ft=0;for(Ee=0;Ee<$e;++Ee)if(ft=he[Ee],ft!=0)for(st=H(Ke[Ee],be)>>be-ft,We=(1<<be+4-ft)-1;We>=0;--We)we[st|We<<ft]=ft&15|Ee<<4;return be}var Re=le?new Uint16Array(512):Me(512),et=le?new Uint16Array(32):Me(32);if(!le){for(var He=0;He<512;++He)Re[He]=0;for(He=0;He<32;++He)et[He]=0}(function(){for(var he=[],we=0;we<32;we++)he.push(5);Ae(he,et,32);var ye=[];for(we=0;we<=143;we++)ye.push(8);for(;we<=255;we++)ye.push(9);for(;we<=279;we++)ye.push(7);for(;we<=287;we++)ye.push(8);Ae(ye,Re,288)})();var at=(function(){for(var we=le?new Uint8Array(32768):[],ye=0,be=0;ye<P.length-1;++ye)for(;be<P[ye+1];++be)we[be]=ye;for(;be<32768;++be)we[be]=29;var ke=le?new Uint8Array(259):[];for(ye=0,be=0;ye<ce.length-1;++ye)for(;be<ce[ye+1];++be)ke[be]=ye;function Ee(st,$e){for(var qe=0;qe<st.length;){var Ke=Math.min(65535,st.length-qe),ft=qe+Ke==st.length;for($e.write_shift(1,+ft),$e.write_shift(2,Ke),$e.write_shift(2,~Ke&65535);Ke-- >0;)$e[$e.l++]=st[qe++]}return $e.l}function We(st,$e){for(var qe=0,Ke=0,ft=le?new Uint16Array(32768):[];Ke<st.length;){var vt=Math.min(65535,st.length-Ke);if(vt<10){for(qe=W($e,qe,+(Ke+vt==st.length)),qe&7&&(qe+=8-(qe&7)),$e.l=qe/8|0,$e.write_shift(2,vt),$e.write_shift(2,~vt&65535);vt-- >0;)$e[$e.l++]=st[Ke++];qe=$e.l*8;continue}qe=W($e,qe,+(Ke+vt==st.length)+2);for(var kt=0;vt-- >0;){var xt=st[Ke];kt=(kt<<5^xt)&32767;var me=-1,Ie=0;if((me=ft[kt])&&(me|=Ke&-32768,me>Ke&&(me-=32768),me<Ke))for(;st[me+Ie]==st[Ke+Ie]&&Ie<250;)++Ie;if(Ie>2){xt=ke[Ie],xt<=22?qe=_e($e,qe,ne[xt+1]>>1)-1:(_e($e,qe,3),qe+=5,_e($e,qe,ne[xt-23]>>5),qe+=3);var bt=xt<8?0:xt-4>>2;bt>0&&(oe($e,qe,Ie-ce[xt]),qe+=bt),xt=we[Ke-me],qe=_e($e,qe,ne[xt]>>3),qe-=3;var yt=xt<4?0:xt-2>>1;yt>0&&(oe($e,qe,Ke-me-P[xt]),qe+=yt);for(var Ut=0;Ut<Ie;++Ut)ft[kt]=Ke&32767,kt=(kt<<5^st[Ke])&32767,++Ke;vt-=Ie-1}else xt<=143?xt=xt+48:qe=pe($e,qe,1),qe=_e($e,qe,ne[xt]),ft[kt]=Ke&32767,++Ke}qe=_e($e,qe,0)-1}return $e.l=(qe+7)/8|0,$e.l}return function($e,qe){return $e.length<8?Ee($e,qe):We($e,qe)}})();function De(he){var we=nt(50+Math.floor(he.length*1.1)),ye=at(he,we);return we.slice(0,ye)}var mt=le?new Uint16Array(32768):Me(32768),At=le?new Uint16Array(32768):Me(32768),wt=le?new Uint16Array(128):Me(128),Ct=1,It=1;function Le(he,we){var ye=z(he,we)+257;we+=5;var be=z(he,we)+1;we+=5;var ke=ue(he,we)+4;we+=4;for(var Ee=0,We=le?new Uint8Array(19):Me(19),st=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$e=1,qe=le?new Uint8Array(8):Me(8),Ke=le?new Uint8Array(8):Me(8),ft=We.length,vt=0;vt<ke;++vt)We[re[vt]]=Ee=S(he,we),$e<Ee&&($e=Ee),qe[Ee]++,we+=3;var kt=0;for(qe[0]=0,vt=1;vt<=$e;++vt)Ke[vt]=kt=kt+qe[vt-1]<<1;for(vt=0;vt<ft;++vt)(kt=We[vt])!=0&&(st[vt]=Ke[kt]++);var xt=0;for(vt=0;vt<ft;++vt)if(xt=We[vt],xt!=0){kt=ne[st[vt]]>>8-xt;for(var me=(1<<7-xt)-1;me>=0;--me)wt[kt|me<<xt]=xt&7|vt<<3}var Ie=[];for($e=1;Ie.length<ye+be;)switch(kt=wt[T(he,we)],we+=kt&7,kt>>>=3){case 16:for(Ee=3+K(he,we),we+=2,kt=Ie[Ie.length-1];Ee-- >0;)Ie.push(kt);break;case 17:for(Ee=3+S(he,we),we+=3;Ee-- >0;)Ie.push(0);break;case 18:for(Ee=11+T(he,we),we+=7;Ee-- >0;)Ie.push(0);break;default:Ie.push(kt),$e<kt&&($e=kt);break}var bt=Ie.slice(0,ye),yt=Ie.slice(ye);for(vt=ye;vt<286;++vt)bt[vt]=0;for(vt=be;vt<30;++vt)yt[vt]=0;return Ct=Ae(bt,mt,286),It=Ae(yt,At,30),we}function tt(he,we){if(he[0]==3&&!(he[1]&3))return[mo(we),2];for(var ye=0,be=0,ke=Ck(we||1<<18),Ee=0,We=ke.length>>>0,st=0,$e=0;(be&1)==0;){if(be=S(he,ye),ye+=3,be>>>1)be>>1==1?(st=9,$e=5):(ye=Le(he,ye),st=Ct,$e=It);else{ye&7&&(ye+=8-(ye&7));var qe=he[ye>>>3]|he[(ye>>>3)+1]<<8;if(ye+=32,qe>0)for(!we&&We<Ee+qe&&(ke=Te(ke,Ee+qe),We=ke.length);qe-- >0;)ke[Ee++]=he[ye>>>3],ye+=8;continue}for(;;){!we&&We<Ee+32767&&(ke=Te(ke,Ee+32767),We=ke.length);var Ke=A(he,ye,st),ft=be>>>1==1?Re[Ke]:mt[Ke];if(ye+=ft&15,ft>>>=4,(ft>>>8&255)===0)ke[Ee++]=ft;else{if(ft==256)break;ft-=257;var vt=ft<8?0:ft-4>>2;vt>5&&(vt=0);var kt=Ee+ce[ft];vt>0&&(kt+=A(he,ye,vt),ye+=vt),Ke=A(he,ye,$e),ft=be>>>1==1?et[Ke]:At[Ke],ye+=ft&15,ft>>>=4;var xt=ft<4?0:ft-2>>1,me=P[ft];for(xt>0&&(me+=A(he,ye,xt),ye+=xt),!we&&We<kt&&(ke=Te(ke,kt+100),We=ke.length);Ee<kt;)ke[Ee]=ke[Ee-me],++Ee}}}return we?[ke,ye+7>>>3]:[ke.slice(0,Ee),ye+7>>>3]}function ct(he,we){var ye=he.slice(he.l||0),be=tt(ye,we);return he.l+=be[1],be[0]}function se(he,we){if(he)typeof console<"u"&&console.error(we);else throw new Error(we)}function Ne(he,we){var ye=he;Ks(ye,0);var be=[],ke=[],Ee={FileIndex:be,FullPaths:ke};O(Ee,{root:we.root});for(var We=ye.length-4;(ye[We]!=80||ye[We+1]!=75||ye[We+2]!=5||ye[We+3]!=6)&&We>=0;)--We;ye.l=We+4,ye.l+=4;var st=ye.read_shift(2);ye.l+=6;var $e=ye.read_shift(4);for(ye.l=$e,We=0;We<st;++We){ye.l+=20;var qe=ye.read_shift(4),Ke=ye.read_shift(4),ft=ye.read_shift(2),vt=ye.read_shift(2),kt=ye.read_shift(2);ye.l+=8;var xt=ye.read_shift(4),me=u(ye.slice(ye.l+ft,ye.l+ft+vt));ye.l+=ft+vt+kt;var Ie=ye.l;ye.l=xt+4,xe(ye,qe,Ke,Ee,me),ye.l=Ie}return Ee}function xe(he,we,ye,be,ke){he.l+=2;var Ee=he.read_shift(2),We=he.read_shift(2),st=l(he);if(Ee&8257)throw new Error("Unsupported ZIP encryption");for(var $e=he.read_shift(4),qe=he.read_shift(4),Ke=he.read_shift(4),ft=he.read_shift(2),vt=he.read_shift(2),kt="",xt=0;xt<ft;++xt)kt+=String.fromCharCode(he[he.l++]);if(vt){var me=u(he.slice(he.l,he.l+vt));(me[21589]||{}).mt&&(st=me[21589].mt),((ke||{})[21589]||{}).mt&&(st=ke[21589].mt)}he.l+=vt;var Ie=he.slice(he.l,he.l+qe);switch(We){case 8:Ie=Y(he,Ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+We)}var bt=!1;Ee&8&&($e=he.read_shift(4),$e==134695760&&($e=he.read_shift(4),bt=!0),qe=he.read_shift(4),Ke=he.read_shift(4)),qe!=we&&se(bt,"Bad compressed size: "+we+" != "+qe),Ke!=ye&&se(bt,"Bad uncompressed size: "+ye+" != "+Ke),zt(be,kt,Ie,{unsafe:!0,mt:st})}function je(he,we){var ye=we||{},be=[],ke=[],Ee=nt(1),We=ye.compression?8:0,st=0,$e=0,qe=0,Ke=0,ft=0,vt=he.FullPaths[0],kt=vt,xt=he.FileIndex[0],me=[],Ie=0;for($e=1;$e<he.FullPaths.length;++$e)if(kt=he.FullPaths[$e].slice(vt.length),xt=he.FileIndex[$e],!(!xt.size||!xt.content||kt=="Sh33tJ5")){var bt=Ke,yt=nt(kt.length);for(qe=0;qe<kt.length;++qe)yt.write_shift(1,kt.charCodeAt(qe)&127);yt=yt.slice(0,yt.l),me[ft]=_z.buf(xt.content,0);var Ut=xt.content;We==8&&(Ut=G(Ut)),Ee=nt(30),Ee.write_shift(4,67324752),Ee.write_shift(2,20),Ee.write_shift(2,st),Ee.write_shift(2,We),xt.mt?o(Ee,xt.mt):Ee.write_shift(4,0),Ee.write_shift(-4,me[ft]),Ee.write_shift(4,Ut.length),Ee.write_shift(4,xt.content.length),Ee.write_shift(2,yt.length),Ee.write_shift(2,0),Ke+=Ee.length,be.push(Ee),Ke+=yt.length,be.push(yt),Ke+=Ut.length,be.push(Ut),Ee=nt(46),Ee.write_shift(4,33639248),Ee.write_shift(2,0),Ee.write_shift(2,20),Ee.write_shift(2,st),Ee.write_shift(2,We),Ee.write_shift(4,0),Ee.write_shift(-4,me[ft]),Ee.write_shift(4,Ut.length),Ee.write_shift(4,xt.content.length),Ee.write_shift(2,yt.length),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(4,0),Ee.write_shift(4,bt),Ie+=Ee.l,ke.push(Ee),Ie+=yt.length,ke.push(yt),++ft}return Ee=nt(22),Ee.write_shift(4,101010256),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,ft),Ee.write_shift(2,ft),Ee.write_shift(4,Ie),Ee.write_shift(4,Ke),Ee.write_shift(2,0),Is([Is(be),Is(ke),Ee])}var de={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Oe(he,we){if(he.ctype)return he.ctype;var ye=he.name||"",be=ye.match(/\.([^\.]+)$/);return be&&de[be[1]]||we&&(be=(ye=we).match(/[\.\\]([^\.\\])+$/),be&&de[be[1]])?de[be[1]]:"application/octet-stream"}function Ue(he){for(var we=Pd(he),ye=[],be=0;be<we.length;be+=76)ye.push(we.slice(be,be+76));return ye.join(`\r
`)+`\r
`}function rt(he){var we=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(qe){var Ke=qe.charCodeAt(0).toString(16).toUpperCase();return"="+(Ke.length==1?"0"+Ke:Ke)});we=we.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),we.charAt(0)==`
`&&(we="=0D"+we.slice(1)),we=we.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ye=[],be=we.split(`\r
`),ke=0;ke<be.length;++ke){var Ee=be[ke];if(Ee.length==0){ye.push("");continue}for(var We=0;We<Ee.length;){var st=76,$e=Ee.slice(We,We+st);$e.charAt(st-1)=="="?st--:$e.charAt(st-2)=="="?st-=2:$e.charAt(st-3)=="="&&(st-=3),$e=Ee.slice(We,We+st),We+=st,We<Ee.length&&($e+="="),ye.push($e)}}return ye.join(`\r
`)}function pt(he){for(var we=[],ye=0;ye<he.length;++ye){for(var be=he[ye];ye<=he.length&&be.charAt(be.length-1)=="=";)be=be.slice(0,be.length-1)+he[++ye];we.push(be)}for(var ke=0;ke<we.length;++ke)we[ke]=we[ke].replace(/[=][0-9A-Fa-f]{2}/g,function(Ee){return String.fromCharCode(parseInt(Ee.slice(1),16))});return Ua(we.join(`\r
`))}function _t(he,we,ye){for(var be="",ke="",Ee="",We,st=0;st<10;++st){var $e=we[st];if(!$e||$e.match(/^\s*$/))break;var qe=$e.match(/^(.*?):\s*([^\s].*)$/);if(qe)switch(qe[1].toLowerCase()){case"content-location":be=qe[2].trim();break;case"content-type":Ee=qe[2].trim();break;case"content-transfer-encoding":ke=qe[2].trim();break}}switch(++st,ke.toLowerCase()){case"base64":We=Ua(qa(we.slice(st).join("")));break;case"quoted-printable":We=pt(we.slice(st));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ke)}var Ke=zt(he,be.slice(ye.length),We,{unsafe:!0});Ee&&(Ke.ctype=Ee)}function Vt(he,we){if(ee(he.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ye=we&&we.root||"",be=(ar&&Buffer.isBuffer(he)?he.toString("binary"):ee(he)).split(`\r
`),ke=0,Ee="";for(ke=0;ke<be.length;++ke)if(Ee=be[ke],!!/^Content-Location:/i.test(Ee)&&(Ee=Ee.slice(Ee.indexOf("file")),ye||(ye=Ee.slice(0,Ee.lastIndexOf("/")+1)),Ee.slice(0,ye.length)!=ye))for(;ye.length>0&&(ye=ye.slice(0,ye.length-1),ye=ye.slice(0,ye.lastIndexOf("/")+1),Ee.slice(0,ye.length)!=ye););var We=(be[1]||"").match(/boundary="(.*?)"/);if(!We)throw new Error("MAD cannot find boundary");var st="--"+(We[1]||""),$e=[],qe=[],Ke={FileIndex:$e,FullPaths:qe};O(Ke);var ft,vt=0;for(ke=0;ke<be.length;++ke){var kt=be[ke];kt!==st&&kt!==st+"--"||(vt++&&_t(Ke,be.slice(ft,ke),ye),ft=ke)}return Ke}function yr(he,we){var ye=we||{},be=ye.boundary||"SheetJS";be="------="+be;for(var ke=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+be.slice(2)+'"',"","",""],Ee=he.FullPaths[0],We=Ee,st=he.FileIndex[0],$e=1;$e<he.FullPaths.length;++$e)if(We=he.FullPaths[$e].slice(Ee.length),st=he.FileIndex[$e],!(!st.size||!st.content||We=="Sh33tJ5")){We=We.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var qe=st.content,Ke=ar&&Buffer.isBuffer(qe)?qe.toString("binary"):ee(qe),ft=0,vt=Math.min(1024,Ke.length),kt=0,xt=0;xt<=vt;++xt)(kt=Ke.charCodeAt(xt))>=32&&kt<128&&++ft;var me=ft>=vt*4/5;ke.push(be),ke.push("Content-Location: "+(ye.root||"file:///C:/SheetJS/")+We),ke.push("Content-Transfer-Encoding: "+(me?"quoted-printable":"base64")),ke.push("Content-Type: "+Oe(st,We)),ke.push(""),ke.push(me?rt(Ke):Ue(Ke))}return ke.push(be+`--\r
`),ke.join(`\r
`)}function _r(he){var we={};return O(we,he),we}function zt(he,we,ye,be){var ke=be&&be.unsafe;ke||O(he);var Ee=!ke&&Pt.find(he,we);if(!Ee){var We=he.FullPaths[0];we.slice(0,We.length)==We?We=we:(We.slice(-1)!="/"&&(We+="/"),We=(We+we).replace("//","/")),Ee={name:a(we),type:2},he.FileIndex.push(Ee),he.FullPaths.push(We),ke||Pt.utils.cfb_gc(he)}return Ee.content=ye,Ee.size=ye?ye.length:0,be&&(be.CLSID&&(Ee.clsid=be.CLSID),be.mt&&(Ee.mt=be.mt),be.ct&&(Ee.ct=be.ct)),Ee}function fr(he,we){O(he);var ye=Pt.find(he,we);if(ye){for(var be=0;be<he.FileIndex.length;++be)if(he.FileIndex[be]==ye)return he.FileIndex.splice(be,1),he.FullPaths.splice(be,1),!0}return!1}function kr(he,we,ye){O(he);var be=Pt.find(he,we);if(be){for(var ke=0;ke<he.FileIndex.length;++ke)if(he.FileIndex[ke]==be)return he.FileIndex[ke].name=a(ye),he.FullPaths[ke]=ye,!0}return!1}function Jr(he){F(he,!0)}return t.find=fe,t.read=L,t.parse=m,t.write=Se,t.writeFile=ve,t.utils={cfb_new:_r,cfb_add:zt,cfb_del:fr,cfb_mov:kr,cfb_gc:Jr,ReadShift:gd,CheckField:k5,prep_blob:Ks,bconcat:Is,use_zlib:M,_deflateRaw:De,_inflateRaw:ct,consts:te},t})();function Nz(e){return typeof e=="string"?pm(e):Array.isArray(e)?XU(e):e}function uf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=pm(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?zn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var a=new Blob([Nz(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=bo(t)),u.write(t),u.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function Sz(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function ls(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function Bk(e,t){for(var r=[],s=ls(e),a=0;a!==s.length;++a)r[e[s[a]][t]]==null&&(r[e[s[a]][t]]=s[a]);return r}function gm(e){for(var t=[],r=ls(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function ym(e){for(var t=[],r=ls(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function kz(e){for(var t=[],r=ls(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var U0=new Date(1899,11,30,0,0,0);function Rs(e,t){var r=e.getTime(),s=U0.getTime()+(e.getTimezoneOffset()-U0.getTimezoneOffset())*6e4;return(r-s)/(1440*60*1e3)}var a5=new Date,Ez=U0.getTime()+(a5.getTimezoneOffset()-U0.getTimezoneOffset())*6e4,Pk=a5.getTimezoneOffset();function vm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Ez),t.getTimezoneOffset()!==Pk&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Pk)*6e4),t}function jz(e){var t=0,r=0,s=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(r=1,o>3&&(s=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[o],10)}return t}var Uk=new Date("2017-02-19T19:06:09.000Z"),n5=isNaN(Uk.getFullYear())?new Date("2/19/17"):Uk,Tz=n5.getFullYear()==2017;function Gr(e,t){var r=new Date(e);if(Tz)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(n5.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function fl(e,t){if(ar&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return zn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return zn(Gj(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return zn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return zn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var s=[],a=0;a!=e.length;++a)s.push(String.fromCharCode(e[a]));return s.join("")}function Vr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Vr(e[r]));return t}function is(e,t){for(var r="";r.length<t;)r+=e;return r}function jn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(a,o){return r=-r,o}),!isNaN(t=Number(s)))?t/r:t}var Az=["january","february","march","april","may","june","july","august","september","october","november","december"];function Xc(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),a=t.getMonth(),o=t.getDate();if(isNaN(o))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&Az.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return s<0||s>8099?r:(a>0||o>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Cz=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,a){if(e||typeof s=="string")return r.split(s);for(var o=r.split(s),l=[o[0]],u=1;u<o.length;++u)l.push(a),l.push(o[u]);return l}})();function i5(e){return e?e.content&&e.type?fl(e.content,!0):e.data?ud(e.data):e.asNodeBuffer&&ar?ud(e.asNodeBuffer().toString("binary")):e.asBinary?ud(e.asBinary()):e._data&&e._data.getContent?ud(fl(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function o5(e){if(!e)return null;if(e.data)return Tk(e.data);if(e.asNodeBuffer&&ar)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Tk(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Rz(e){return e&&e.name.slice(-4)===".bin"?o5(e):i5(e)}function cn(e,t){for(var r=e.FullPaths||ls(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),a=s.replace(/\\/g,"/"),o=0;o<r.length;++o){var l=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==l||a==l)return e.files?e.files[r[o]]:e.FileIndex[o]}return null}function Iv(e,t){var r=cn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ss(e,t,r){if(!r)return Rz(Iv(e,t));if(!t)return null;try{return Ss(e,t)}catch{return null}}function za(e,t,r){if(!r)return i5(Iv(e,t));if(!t)return null;try{return za(e,t)}catch{return null}}function Dz(e,t,r){return o5(Iv(e,t))}function zk(e){for(var t=e.FullPaths||ls(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function er(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return ar?s=Ri(r):s=YU(r),Pt.utils.cfb_add(e,t,s)}Pt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Mv(){return Pt.utils.cfb_new()}function l5(e,t){switch(t.type){case"base64":return Pt.read(e,{type:"base64"});case"binary":return Pt.read(e,{type:"binary"});case"buffer":case"array":return Pt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function fd(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var a=s.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var ys=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Oz=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,$k=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Fz=/<[^>]*>/g,ca=ys.match($k)?$k:Fz,Lz=/<\w*:/,Iz=/<(\/?)\w+:/;function Kt(e,t,r){for(var s={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(t||(s[0]=e.slice(0,a)),a===e.length)return s;var l=e.match(Oz),u=0,d="",h=0,m="",x="",y=1;if(l)for(h=0;h!=l.length;++h){for(x=l[h],o=0;o!=x.length&&x.charCodeAt(o)!==61;++o);for(m=x.slice(0,o).trim();x.charCodeAt(o+1)==32;)++o;for(y=(a=x.charCodeAt(o+1))==34||a==39?1:0,d=x.slice(o+1+y,x.length-y),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),s[m]=d,s[m.toLowerCase()]=d;else{var v=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(s[v]&&m.slice(u-3,u)=="ext")continue;s[v]=d,s[v.toLowerCase()]=d}}return s}function Hn(e){return e.replace(Iz,"<$1")}var c5={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Bv=gm(c5),xr=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var a=s+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(u,d){return c5[u]||String.fromCharCode(parseInt(d,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,d){return String.fromCharCode(parseInt(d,16))});var l=a.indexOf("]]>");return r(a.slice(0,o))+a.slice(o+9,l)+r(a.slice(l+3))}})(),Pv=/[&<>'"]/g,Mz=/[\u0000-\u0008\u000b-\u001f]/g;function Cr(e){var t=e+"";return t.replace(Pv,function(r){return Bv[r]}).replace(Mz,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function qk(e){return Cr(e).replace(/ /g,"_x0020_")}var u5=/[\u0000-\u001f]/g;function Uv(e){var t=e+"";return t.replace(Pv,function(r){return Bv[r]}).replace(/\n/g,"<br/>").replace(u5,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Bz(e){var t=e+"";return t.replace(Pv,function(r){return Bv[r]}).replace(u5,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Hk=(function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}})();function Pz(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Hr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function J1(e){for(var t="",r=0,s=0,a=0,o=0,l=0,u=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(a=e.charCodeAt(r++),s>191&&s<224){l=(s&31)<<6,l|=a&63,t+=String.fromCharCode(l);continue}if(o=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(a&63)<<6|o&63);continue}l=e.charCodeAt(r++),u=((s&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function Wk(e){var t=mo(2*e.length),r,s,a=1,o=0,l=0,u;for(s=0;s<e.length;s+=a)a=1,(u=e.charCodeAt(s))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(s+1)&63),a=2):u<240?(r=(u&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),a=3):(a=4,r=(u&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[o++]=l&255,t[o++]=l>>>8,l=0),t[o++]=r%256,t[o++]=r>>>8;return t.slice(0,o).toString("ucs2")}function Gk(e){return Ri(e,"binary").toString("utf8")}var Jh="foo bar baz",Mr=ar&&(Gk(Jh)==J1(Jh)&&Gk||Wk(Jh)==J1(Jh)&&Wk)||J1,zn=ar?function(e){return Ri(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,a=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,a=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},zd=(function(){var e={};return function(r,s){var a=r+"|"+(s||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}})(),d5=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)s=s.replace(e[a][0],e[a][1]);return s}})(),Uz=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),zz=/<\/?(?:vt:)?variant>/g,$z=/<(?:vt:)([^>]*)>([\s\S]*)</;function Vk(e,t){var r=Kt(e),s=e.match(Uz(r.baseType))||[],a=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return a}return s.forEach(function(o){var l=o.replace(zz,"").match($z);l&&a.push({v:Mr(l[2]),t:l[1]})}),a}var f5=/(^\s|\s$|\n)/;function Ys(e,t){return"<"+e+(t.match(f5)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function $d(e){return ls(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Nt(e,t,r){return"<"+e+(r!=null?$d(r):"")+(t!=null?(t.match(f5)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Py(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function qz(e,t){switch(typeof e){case"string":var r=Nt("vt:lpwstr",Cr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Nt((e|0)==e?"vt:i4":"vt:r8",Cr(String(e)));case"boolean":return Nt("vt:bool",e?"true":"false")}if(e instanceof Date)return Nt("vt:filetime",Py(e));throw new Error("Unable to serialize "+e)}function zv(e){if(ar&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Mr(bo(Ov(e)));throw new Error("Bad input format: expected Buffer or string")}var qd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Cs={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Nl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ia={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Hz(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,o=5;o>=0;--o)a=a*256+e[t+o];return s==2047?a==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,a+=Math.pow(2,52)),r*Math.pow(2,s-52)*a)}function Wz(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,a=0,o=0,l=s?-t:t;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(t)?26985:0);for(var u=0;u<=5;++u,o/=256)e[r+u]=o&255;e[r+6]=(a&15)<<4|o&15,e[r+7]=a>>4|s}var Kk=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var a=0,o=e[0][s].length;a<o;a+=r)t.push.apply(t,e[0][s].slice(a,a+r));return t},Xk=ar?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ri(t)})):Kk(e)}:Kk,Yk=function(e,t,r){for(var s=[],a=t;a<r;a+=2)s.push(String.fromCharCode(xi(e,a)));return s.join("").replace(ma,"")},$v=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ma,""):Yk(e,t,r)}:Yk,Jk=function(e,t,r){for(var s=[],a=t;a<t+r;++a)s.push(("0"+e[a].toString(16)).slice(-2));return s.join("")},h5=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Jk(e,t,r)}:Jk,Zk=function(e,t,r){for(var s=[],a=t;a<r;a++)s.push(String.fromCharCode(Ec(e,a)));return s.join("")},df=ar?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):Zk(t,r,s)}:Zk,m5=function(e,t){var r=Ma(e,t);return r>0?df(e,t+4,t+4+r-1):""},p5=m5,x5=function(e,t){var r=Ma(e,t);return r>0?df(e,t+4,t+4+r-1):""},g5=x5,y5=function(e,t){var r=2*Ma(e,t);return r>0?df(e,t+4,t+4+r-1):""},v5=y5,b5=function(t,r){var s=Ma(t,r);return s>0?$v(t,r+4,r+4+s):""},w5=b5,_5=function(e,t){var r=Ma(e,t);return r>0?df(e,t+4,t+4+r):""},N5=_5,S5=function(e,t){return Hz(e,t)},z0=S5,qv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ar&&(p5=function(t,r){if(!Buffer.isBuffer(t))return m5(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},g5=function(t,r){if(!Buffer.isBuffer(t))return x5(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},v5=function(t,r){if(!Buffer.isBuffer(t))return y5(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},w5=function(t,r){if(!Buffer.isBuffer(t))return b5(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},N5=function(t,r){if(!Buffer.isBuffer(t))return _5(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},z0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):S5(t,r)},qv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ec=function(e,t){return e[t]},xi=function(e,t){return e[t+1]*256+e[t]},Gz=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ma=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Jo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Vz=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function gd(e,t){var r="",s,a,o=[],l,u,d,h;switch(t){case"dbcs":if(h=this.l,ar&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(xi(this,h)),h+=2;e*=2;break;case"utf8":r=df(this,this.l,this.l+e);break;case"utf16le":e*=2,r=$v(this,this.l,this.l+e);break;case"wstr":return gd.call(this,e,"dbcs");case"lpstr-ansi":r=p5(this,this.l),e=4+Ma(this,this.l);break;case"lpstr-cp":r=g5(this,this.l),e=4+Ma(this,this.l);break;case"lpwstr":r=v5(this,this.l),e=4+2*Ma(this,this.l);break;case"lpp4":e=4+Ma(this,this.l),r=w5(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ma(this,this.l),r=N5(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Ec(this,this.l+e++))!==0;)o.push(Yh(l));r=o.join("");break;case"_wstr":for(e=0,r="";(l=xi(this,this.l+e))!==0;)o.push(Yh(l)),e+=2;e+=2,r=o.join("");break;case"dbcs-cont":for(r="",h=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Ec(this,h),this.l=h+1,u=gd.call(this,e-d,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Yh(xi(this,h))),h+=2}r=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Ec(this,h),this.l=h+1,u=gd.call(this,e-d,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Yh(Ec(this,h))),h+=1}r=o.join("");break;default:switch(e){case 1:return s=Ec(this,this.l),this.l++,s;case 2:return s=(t==="i"?Gz:xi)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(s=(e>0?Jo:Vz)(this,this.l),this.l+=4,s):(a=Ma(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=z0(this,this.l):a=z0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=h5(this,this.l,e);break}}return this.l+=e,r}var Kz=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Xz=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Yz=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Jz(e,t,r){var s=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)Yz(this,t.charCodeAt(a),this.l+2*a);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;s=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var l=t.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,Kz(this,t,this.l);break;case 8:if(s=8,r==="f"){Wz(this,t,this.l);break}case 16:break;case-4:s=4,Xz(this,t,this.l);break}return this.l+=s,this}function k5(e,t){var r=h5(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ks(e,t){e.l=t,e.read_shift=gd,e.chk=k5,e.write_shift=Jz}function la(e,t){e.l+=t}function nt(e){var t=mo(e);return Ks(t,0),t}function Di(e,t,r){if(e){var s,a,o;Ks(e,e.l||0);for(var l=e.length,u=0,d=0;e.l<l;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var h=Xd[u]||Xd[65535];for(s=e.read_shift(1),o=s&127,a=1;a<4&&s&128;++a)o+=((s=e.read_shift(1))&127)<<7*a;d=e.l+o;var m=h.f&&h.f(e,o,r);if(e.l=d,t(m,h,u))return}}}function Ea(){var e=[],t=ar?256:2048,r=function(h){var m=nt(h);return Ks(m,0),m},s=r(t),a=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},o=function(h){return s&&h<s.length-s.l?s:(a(),s=r(Math.max(h+1,t)))},l=function(){return a(),Is(e)},u=function(h){a(),s=h,s.l==null&&(s.l=s.length),o(t)};return{next:o,push:u,end:l,_bufs:e}}function dt(e,t,r,s){var a=+t,o;if(!isNaN(a)){s||(s=Xd[a].p||(r||[]).length||0),o=1+(a>=128?1:0)+1,s>=128&&++o,s>=16384&&++o,s>=2097152&&++o;var l=e.next(o);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(s>=128)l.write_shift(1,(s&127)+128),s>>=7;else{l.write_shift(1,s);break}s>0&&qv(r)&&e.push(r)}}function yd(e,t,r){var s=Vr(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Qk(e,t,r){var s=Vr(e);return s.s=yd(s.s,t.s,r),s.e=yd(s.e,t.s,r),s}function vd(e,t){if(e.cRel&&e.c<0)for(e=Vr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Vr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Gt(e);return!e.cRel&&e.cRel!=null&&(r=e$(r)),!e.rRel&&e.rRel!=null&&(r=Zz(r)),r}function Z1(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Qr(e.s.c)+":"+(e.e.cRel?"":"$")+Qr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+xs(e.s.r)+":"+(e.e.rRel?"":"$")+xs(e.e.r):vd(e.s,t.biff)+":"+vd(e.e,t.biff)}function Hv(e){return parseInt(Qz(e),10)-1}function xs(e){return""+(e+1)}function Zz(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Qz(e){return e.replace(/\$(\d+)$/,"$1")}function Wv(e){for(var t=t$(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function Qr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function e$(e){return e.replace(/^([A-Z])/,"$$$1")}function t$(e){return e.replace(/^\$([A-Z])/,"$1")}function r$(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function es(e){for(var t=0,r=0,s=0;s<e.length;++s){var a=e.charCodeAt(s);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Gt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ja(e){var t=e.indexOf(":");return t==-1?{s:es(e),e:es(e)}:{s:es(e.slice(0,t)),e:es(e.slice(t+1))}}function Zt(e,t){return typeof t>"u"||typeof t=="number"?Zt(e.s,e.e):(typeof e!="string"&&(e=Gt(e)),typeof t!="string"&&(t=Gt(t)),e==t?e:e+":"+t)}function gr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,a=0,o=e.length;for(r=0;s<o&&!((a=e.charCodeAt(s)-64)<1||a>26);++s)r=26*r+a;for(t.s.c=--r,r=0;s<o&&!((a=e.charCodeAt(s)-48)<0||a>9);++s)r=10*r+a;if(t.s.r=--r,s===o||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=o&&!((a=e.charCodeAt(s)-64)<1||a>26);++s)r=26*r+a;for(t.e.c=--r,r=0;s!=o&&!((a=e.charCodeAt(s)-48)<0||a>9);++s)r=10*r+a;return t.e.r=--r,t}function eE(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=hn(e.z,r?Rs(t):t)}catch{}try{return e.w=hn((e.XF||{}).numFmtId||(r?14:0),r?Rs(t):t)}catch{return""+t}}function Si(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Oi[e.v]||e.v:t==null?eE(e,e.v):eE(e,t))}function wo(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function E5(e,t,r){var s=r||{},a=e?Array.isArray(e):s.dense,o=e||(a?[]:{}),l=0,u=0;if(o&&s.origin!=null){if(typeof s.origin=="number")l=s.origin;else{var d=typeof s.origin=="string"?es(s.origin):s.origin;l=d.r,u=d.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var m=gr(o["!ref"]);h.s.c=m.s.c,h.s.r=m.s.r,h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),l==-1&&(h.e.r=l=m.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=t[x].length;++y)if(!(typeof t[x][y]>"u")){var v={v:t[x][y]},b=l+x,g=u+y;if(h.s.r>b&&(h.s.r=b),h.s.c>g&&(h.s.c=g),h.e.r<b&&(h.e.r=b),h.e.c<g&&(h.e.c=g),t[x][y]&&typeof t[x][y]=="object"&&!Array.isArray(t[x][y])&&!(t[x][y]instanceof Date))v=t[x][y];else if(Array.isArray(v.v)&&(v.f=t[x][y][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(s.nullError)v.t="e",v.v=0;else if(s.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=s.dateNF||Wt[14],s.cellDates?(v.t="d",v.w=hn(v.z,Rs(v.v))):(v.t="n",v.v=Rs(v.v),v.w=hn(v.z,v.v))):v.t="s";if(a)o[b]||(o[b]=[]),o[b][g]&&o[b][g].z&&(v.z=o[b][g].z),o[b][g]=v;else{var _=Gt({c:g,r:b});o[_]&&o[_].z&&(v.z=o[_].z),o[_]=v}}}return h.s.c<1e7&&(o["!ref"]=Zt(h)),o}function iu(e,t){return E5(null,e,t)}function s$(e){return e.read_shift(4,"i")}function Tn(e,t){return t||(t=nt(4)),t.write_shift(4,e),t}function ia(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ms(e,t){var r=!1;return t==null&&(r=!0,t=nt(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function a$(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function n$(e,t){return t||(t=nt(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Gv(e,t){var r=e.l,s=e.read_shift(1),a=ia(e),o=[],l={t:a,h:a};if((s&1)!==0){for(var u=e.read_shift(4),d=0;d!=u;++d)o.push(a$(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function i$(e,t){var r=!1;return t==null&&(r=!0,t=nt(15+4*e.t.length)),t.write_shift(1,0),Ms(e.t,t),r?t.slice(0,t.l):t}var o$=Gv;function l$(e,t){var r=!1;return t==null&&(r=!0,t=nt(23+4*e.t.length)),t.write_shift(1,1),Ms(e.t,t),t.write_shift(4,1),n$({},t),r?t.slice(0,t.l):t}function pn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Sl(e,t){return t==null&&(t=nt(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function kl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function El(e,t){return t==null&&(t=nt(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var c$=ia,j5=Ms;function Vv(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function $0(e,t){var r=!1;return t==null&&(r=!0,t=nt(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var u$=ia,Uy=Vv,Kv=$0;function Xv(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var a=s===0?z0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Jo(t,0)>>2;return r?a/100:a}function T5(e,t){t==null&&(t=nt(4));var r=0,s=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function A5(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function d$(e,t){return t||(t=nt(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var jl=A5,ou=d$;function aa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function hl(e,t){return(t||nt(8)).write_shift(8,e,"f")}function f$(e){var t={},r=e.read_shift(1),s=r>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),u=e.read_shift(1),d=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=a;var h=sl[a];h&&(t.rgb=Wd(h));break;case 2:t.rgb=Wd([l,u,d]);break;case 3:t.theme=a;break}return o!=0&&(t.tint=o>0?o/32767:o/32768),t}function q0(e,t){if(t||(t=nt(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function h$(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function m$(e,t){t||(t=nt(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function C5(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function p$(e){return C5(e,1)}function x$(e){return C5(e,2)}var Yv=2,Na=3,Zh=11,tE=12,H0=19,Qh=64,g$=65,y$=71,v$=4108,b$=4126,Ls=80,R5=81,w$=[Ls,R5],zy={1:{n:"CodePage",t:Yv},2:{n:"Category",t:Ls},3:{n:"PresentationFormat",t:Ls},4:{n:"ByteCount",t:Na},5:{n:"LineCount",t:Na},6:{n:"ParagraphCount",t:Na},7:{n:"SlideCount",t:Na},8:{n:"NoteCount",t:Na},9:{n:"HiddenCount",t:Na},10:{n:"MultimediaClipCount",t:Na},11:{n:"ScaleCrop",t:Zh},12:{n:"HeadingPairs",t:v$},13:{n:"TitlesOfParts",t:b$},14:{n:"Manager",t:Ls},15:{n:"Company",t:Ls},16:{n:"LinksUpToDate",t:Zh},17:{n:"CharacterCount",t:Na},19:{n:"SharedDoc",t:Zh},22:{n:"HyperlinksChanged",t:Zh},23:{n:"AppVersion",t:Na,p:"version"},24:{n:"DigSig",t:g$},26:{n:"ContentType",t:Ls},27:{n:"ContentStatus",t:Ls},28:{n:"Language",t:Ls},29:{n:"Version",t:Ls},255:{},2147483648:{n:"Locale",t:H0},2147483651:{n:"Behavior",t:H0},1919054434:{}},$y={1:{n:"CodePage",t:Yv},2:{n:"Title",t:Ls},3:{n:"Subject",t:Ls},4:{n:"Author",t:Ls},5:{n:"Keywords",t:Ls},6:{n:"Comments",t:Ls},7:{n:"Template",t:Ls},8:{n:"LastAuthor",t:Ls},9:{n:"RevNumber",t:Ls},10:{n:"EditTime",t:Qh},11:{n:"LastPrinted",t:Qh},12:{n:"CreatedDate",t:Qh},13:{n:"ModifiedDate",t:Qh},14:{n:"PageCount",t:Na},15:{n:"WordCount",t:Na},16:{n:"CharCount",t:Na},17:{n:"Thumbnail",t:y$},18:{n:"Application",t:Ls},19:{n:"DocSecurity",t:Na},255:{},2147483648:{n:"Locale",t:H0},2147483651:{n:"Behavior",t:H0},1919054434:{}},rE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_$=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function N$(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var S$=N$([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),sl=Vr(S$),Oi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},D5={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},qy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},e0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Jv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function k$(e){var t=Jv();if(!e||!e.match)return t;var r={};if((e.match(ca)||[]).forEach(function(s){var a=Kt(s);switch(a[0].replace(Lz,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[qy[a.ContentType]]!==void 0&&t[qy[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Cs.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function O5(e,t){var r=kz(qy),s=[],a;s[s.length]=ys,s[s.length]=Nt("Types",null,{xmlns:Cs.CT,"xmlns:xsd":Cs.xsd,"xmlns:xsi":Cs.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Nt("Default",null,{Extension:d[0],ContentType:d[1]})}));var o=function(d){e[d]&&e[d].length>0&&(a=e[d][0],s[s.length]=Nt("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:e0[d][t.bookType]||e0[d].xlsx}))},l=function(d){(e[d]||[]).forEach(function(h){s[s.length]=Nt("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:e0[d][t.bookType]||e0[d].xlsx})})},u=function(d){(e[d]||[]).forEach(function(h){s[s.length]=Nt("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[d][0]})})};return o("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var ir={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Hd(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function bd(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(ca)||[]).forEach(function(a){var o=Kt(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:fd(o.Target,t);r[u]=l,s[o.Id]=l}}),r["!id"]=s,r}function Bc(e){var t=[ys,Nt("Relationships",null,{xmlns:Cs.RELS})];return ls(e["!id"]).forEach(function(r){t[t.length]=Nt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ar(e,t,r,s,a,o){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=s,a.Target=r,[ir.HLINK,ir.XPATH,ir.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var E$="application/vnd.oasis.opendocument.spreadsheet";function j$(e,t){for(var r=zv(e),s,a;s=qd.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(a=Kt(s[0],!1),a.path=="/"&&a.type!==E$)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}function T$(e){var t=[ys];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function sE(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function A$(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function C$(e){var t=[ys];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(sE(e[r][0],e[r][1])),t.push(A$("",e[r][0]));return t.push(sE("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function F5(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+I0.version+"</meta:generator></office:meta></office:document-meta>"}var dn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],R$=(function(){for(var e=new Array(dn.length),t=0;t<dn.length;++t){var r=dn[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e})();function L5(e){var t={};e=Mr(e);for(var r=0;r<dn.length;++r){var s=dn[r],a=e.match(R$[r]);a!=null&&a.length>0&&(t[s[1]]=xr(a[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=Gr(t[s[1]]))}return t}function Q1(e,t,r,s,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Cr(t),s[s.length]=r?Nt(e,t,r):Ys(e,t))}function I5(e,t){var r=t||{},s=[ys,Nt("cp:coreProperties",null,{"xmlns:cp":Cs.CORE_PROPS,"xmlns:dc":Cs.dc,"xmlns:dcterms":Cs.dcterms,"xmlns:dcmitype":Cs.dcmitype,"xmlns:xsi":Cs.xsi})],a={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&Q1("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Py(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,a),e.ModifiedDate!=null&&Q1("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Py(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,a));for(var o=0;o!=dn.length;++o){var l=dn[o],u=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Q1(l[0],u,null,s,a)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var al=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],M5=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function B5(e,t,r,s){var a=[];if(typeof e=="string")a=Vk(e,s);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(m){return{v:m}}));var l=typeof t=="string"?Vk(t,s).map(function(m){return m.v}):t,u=0,d=0;if(l.length>0)for(var h=0;h!==a.length;h+=2){switch(d=+a[h+1].v,a[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=d,r.SheetNames=l.slice(u,u+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=d,r.DefinedNames=l.slice(u,u+d);break;case"Charts":case"Diagramme":r.Chartsheets=d,r.ChartNames=l.slice(u,u+d);break}u+=d}}function D$(e,t,r){var s={};return t||(t={}),e=Mr(e),al.forEach(function(a){var o=(e.match(zd(a[0]))||[])[1];switch(a[2]){case"string":o&&(t[a[1]]=xr(o));break;case"bool":t[a[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(s[a[1]]=l[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&B5(s.HeadingPairs,s.TitlesOfParts,t,r),t}function P5(e){var t=[],r=Nt;return e||(e={}),e.Application="SheetJS",t[t.length]=ys,t[t.length]=Nt("Properties",null,{xmlns:Cs.EXT_PROPS,"xmlns:vt":Cs.vt}),al.forEach(function(s){if(e[s[1]]!==void 0){var a;switch(s[2]){case"string":a=Cr(String(e[s[1]]));break;case"bool":a=e[s[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(s[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+Cr(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var O$=/<[^>]+>[^<]*/g;function F$(e,t){var r={},s="",a=e.match(O$);if(a)for(var o=0;o!=a.length;++o){var l=a[o],u=Kt(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":s=xr(u.name);break;case"</property>":s=null;break;default:if(l.indexOf("<vt:")===0){var d=l.split(">"),h=d[0].slice(4),m=d[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[s]=xr(m);break;case"bool":r[s]=Hr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(m);break;case"filetime":case"date":r[s]=Gr(m);break;case"cy":case"error":r[s]=xr(m);break;default:if(h.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,h,d)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function U5(e){var t=[ys,Nt("Properties",null,{xmlns:Cs.CUST_PROPS,"xmlns:vt":Cs.vt})];if(!e)return t.join("");var r=1;return ls(e).forEach(function(a){++r,t[t.length]=Nt("property",qz(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Cr(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Hy={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ey;function L$(e,t,r){ey||(ey=gm(Hy)),t=ey[t]||t,e[t]=r}function I$(e,t){var r=[];return ls(Hy).map(function(s){for(var a=0;a<dn.length;++a)if(dn[a][1]==s)return dn[a];for(a=0;a<al.length;++a)if(al[a][1]==s)return al[a];throw s}).forEach(function(s){if(e[s[1]]!=null){var a=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];s[2]==="date"&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Ys(Hy[s[1]]||s[1],a))}}),Nt("DocumentProperties",r.join(""),{xmlns:Ia.o})}function M$(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",a=[];return e&&ls(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var l=0;l<dn.length;++l)if(o==dn[l][1])return;for(l=0;l<al.length;++l)if(o==al[l][1])return;for(l=0;l<r.length;++l)if(o==r[l])return;var u=e[o],d="string";typeof u=="number"?(d="float",u=String(u)):u===!0||u===!1?(d="boolean",u=u?"1":"0"):u=String(u),a.push(Nt(qk(o),u,{"dt:dt":d}))}}),t&&ls(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var l=t[o],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Nt(qk(o),l,{"dt:dt":u}))}}),"<"+s+' xmlns="'+Ia.o+'">'+a.join("")+"</"+s+">"}function Zv(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function B$(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),a=(r-s)/Math.pow(2,32);s*=1e7,a*=1e7;var o=s/Math.pow(2,32)|0;o>0&&(s=s%Math.pow(2,32),a+=o);var l=nt(8);return l.write_shift(4,s),l.write_shift(4,a),l}function z5(e,t,r){var s=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return a}function $5(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function q5(e,t,r){return t===31?$5(e):z5(e,t,r)}function Wy(e,t,r){return q5(e,t,r===!1?0:4)}function P$(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return q5(e,t,0)}function U$(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var a=e.l;r[s]=e.read_shift(0,"lpwstr").replace(ma,""),e.l-a&2&&(e.l+=2)}return r}function z$(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(ma,"");return r}function $$(e){var t=e.l,r=W0(e,R5);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=W0(e,Na);return[r,s]}function q$(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push($$(e));return r}function aE(e,t){for(var r=e.read_shift(4),s={},a=0;a!=r;++a){var o=e.read_shift(4),l=e.read_shift(4);s[o]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(ma,"").replace(dd,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function H5(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function H$(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function W0(e,t,r){var s=e.read_shift(2),a,o=r||{};if(e.l+=2,t!==tE&&s!==t&&w$.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===tE?s:t){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return z5(e,s,4).replace(ma,"");case 31:return $5(e);case 64:return Zv(e);case 65:return H5(e);case 71:return H$(e);case 80:return Wy(e,s,!o.raw).replace(ma,"");case 81:return P$(e,s).replace(ma,"");case 4108:return q$(e);case 4126:case 4127:return s==4127?U$(e):z$(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function nE(e,t){var r=nt(4),s=nt(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=nt(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=B$(t);break;case 31:case 80:for(s=nt(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Is([r,s])}function iE(e,t){var r=e.l,s=e.read_shift(4),a=e.read_shift(4),o=[],l=0,u=0,d=-1,h={};for(l=0;l!=a;++l){var m=e.read_shift(4),x=e.read_shift(4);o[l]=[m,x+r]}o.sort(function(k,N){return k[1]-N[1]});var y={};for(l=0;l!=a;++l){if(e.l!==o[l][1]){var v=!0;if(l>0&&t)switch(t[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,v=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],v=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],v=!1);break}if((!t||l==0)&&e.l<=o[l][1]&&(v=!1,e.l=o[l][1]),v)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(t){var b=t[o[l][0]];if(y[b.n]=W0(e,b.t,{raw:!0}),b.p==="version"&&(y[b.n]=String(y[b.n]>>16)+"."+("0000"+String(y[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(y[b.n]){case 0:y[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:kn(u=y[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[b.n])}}else if(o[l][0]===1){if(u=y.CodePage=W0(e,Yv),kn(u),d!==-1){var g=e.l;e.l=o[d][1],h=aE(e,u),e.l=g}}else if(o[l][0]===0){if(u===0){d=l,e.l=o[l+1][1];continue}h=aE(e,u)}else{var _=h[o[l][0]],w;switch(e[e.l]){case 65:e.l+=4,w=H5(e);break;case 30:e.l+=4,w=Wy(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=Wy(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=ms(e,4);break;case 64:e.l+=4,w=Gr(Zv(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[_]=w}}return e.l=r+s,y}var W5=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function W$(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function oE(e,t,r){var s=nt(8),a=[],o=[],l=8,u=0,d=nt(8),h=nt(8);if(d.write_shift(4,2),d.write_shift(4,1200),h.write_shift(4,1),o.push(d),a.push(h),l+=8+d.length,!t){h=nt(8),h.write_shift(4,0),a.unshift(h);var m=[nt(4)];for(m[0].write_shift(4,e.length),u=0;u<e.length;++u){var x=e[u][0];for(d=nt(8+2*(x.length+1)+(x.length%2?0:2)),d.write_shift(4,u+2),d.write_shift(4,x.length+1),d.write_shift(0,x,"dbcs");d.l!=d.length;)d.write_shift(1,0);m.push(d)}d=Is(m),o.unshift(d),l+=8+d.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(W5.indexOf(e[u][0])>-1||M5.indexOf(e[u][0])>-1)&&e[u][1]!=null){var y=e[u][1],v=0;if(t){v=+t[e[u][0]];var b=r[v];if(b.p=="version"&&typeof y=="string"){var g=y.split(".");y=(+g[0]<<16)+(+g[1]||0)}d=nE(b.t,y)}else{var _=W$(y);_==-1&&(_=31,y=String(y)),d=nE(_,y)}o.push(d),h=nt(8),h.write_shift(4,t?v:2+u),a.push(h),l+=8+d.length}var w=8*(o.length+1);for(u=0;u<o.length;++u)a[u].write_shift(4,w),w+=o[u].length;return s.write_shift(4,l),s.write_shift(4,o.length),Is([s].concat(a).concat(o))}function lE(e,t,r){var s=e.content;if(!s)return{};Ks(s,0);var a,o,l,u,d=0;s.chk("feff","Byte Order: "),s.read_shift(2);var h=s.read_shift(4),m=s.read_shift(16);if(m!==Pt.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(a=s.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=s.read_shift(16),u=s.read_shift(4),a===1&&u!==s.l)throw new Error("Length mismatch: "+u+" !== "+s.l);a===2&&(l=s.read_shift(16),d=s.read_shift(4));var x=iE(s,t),y={SystemIdentifier:h};for(var v in x)y[v]=x[v];if(y.FMTID=o,a===1)return y;if(d-s.l==2&&(s.l+=2),s.l!==d)throw new Error("Length mismatch 2: "+s.l+" !== "+d);var b;try{b=iE(s,null)}catch{}for(v in b)y[v]=b[v];return y.FMTID=[o,l],y}function cE(e,t,r,s,a,o){var l=nt(a?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Pt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,a?68:48);var d=oE(e,r,s);if(u.push(d),a){var h=oE(a,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+d.length),u.push(h)}return Is(u)}function no(e,t){return e.read_shift(t),null}function G$(e,t){t||(t=nt(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function V$(e,t,r){for(var s=[],a=e.l+t;e.l<a;)s.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return s}function ms(e,t){return e.read_shift(t)===1}function fa(e,t){return t||(t=nt(2)),t.write_shift(2,+!!e),t}function ks(e){return e.read_shift(2,"u")}function un(e,t){return t||(t=nt(2)),t.write_shift(2,e),t}function G5(e,t){return V$(e,t,ks)}function K$(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function V5(e,t,r){return r||(r=nt(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function ff(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=s?e.read_shift(s,a):"";return l}function X$(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,a=r&8,o=1+(r&1),l=0,u,d={};a&&(l=e.read_shift(2)),s&&(u=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",m=t===0?"":e.read_shift(t,h);return a&&(e.l+=4*l),s&&(e.l+=u),d.t=m,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function Y$(e){var t=e.t||"",r=nt(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=nt(2*t.length);s.write_shift(2*t.length,t,"utf16le");var a=[r,s];return Is(a)}function ml(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function hf(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):ml(e,s,r)}function Tl(e,t,r){if(r.biff>5)return hf(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function K5(e,t,r){return r||(r=nt(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function J$(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Z$(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var a=e.read_shift((s?t-24:t)>>1,"utf16le").replace(ma,"");return s&&(e.l+=24),a}function Q$(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+s.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(ma,"");return r+l}function eq(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Z$(e);case"0303000000000000c000000000000046":return Q$(e);default:throw new Error("Unsupported Moniker "+r)}}function t0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ma,""):"";return r}function uE(e,t){t||(t=nt(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function tq(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var a=e.read_shift(2);e.l+=2;var o,l,u,d,h="",m,x;a&16&&(o=t0(e,r-e.l)),a&128&&(l=t0(e,r-e.l)),(a&257)===257&&(u=t0(e,r-e.l)),(a&257)===1&&(d=eq(e,r-e.l)),a&8&&(h=t0(e,r-e.l)),a&32&&(m=e.read_shift(16)),a&64&&(x=Zv(e)),e.l=r;var y=l||u||d||"";y&&h&&(y+="#"+h),y||(y="#"+h),a&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var v={Target:y};return m&&(v.guid=m),x&&(v.time=x),o&&(v.Tooltip=o),v}function rq(e){var t=nt(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var a=s.indexOf("#"),o=a>-1?31:23;switch(s.charAt(0)){case"#":o=28;break;case".":o&=-3;break}t.write_shift(4,2),t.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(o==28)s=s.slice(1),uE(s,t);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var u=a>-1?s.slice(0,a):s;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),o&8&&uE(a>-1?s.slice(a+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var d=0;s.slice(d*3,d*3+3)=="../"||s.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,s.length-3*d+1),r=0;r<s.length-3*d;++r)t.write_shift(1,s.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function X5(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),a=e.read_shift(1);return[t,r,s,a]}function Y5(e,t){var r=X5(e);return r[3]=0,r}function Wn(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function pl(e,t,r,s){return s||(s=nt(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function sq(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function aq(e,t,r){return t===0?"":Tl(e,t,r)}function nq(e,t,r){var s=r.biff>8?4:2,a=e.read_shift(s),o=e.read_shift(s,"i"),l=e.read_shift(s,"i");return[a,o,l]}function J5(e){var t=e.read_shift(2),r=Xv(e);return[t,r]}function iq(e,t,r){e.l+=4,t-=4;var s=e.l+t,a=ff(e,t,r),o=e.read_shift(2);if(s-=e.l,o!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+o);return e.l+=o,a}function bm(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);return{s:{c:s,r:t},e:{c:a,r}}}function Z5(e,t){return t||(t=nt(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Q5(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),a=e.read_shift(1);return{s:{c:s,r:t},e:{c:a,r}}}var oq=Q5;function eT(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function lq(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function cq(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Qs(e){e.l+=2,e.l+=e.read_shift(2)}var uq={0:Qs,4:Qs,5:Qs,6:Qs,7:cq,8:Qs,9:Qs,10:Qs,11:Qs,12:Qs,13:lq,14:Qs,15:Qs,16:Qs,17:Qs,18:Qs,19:Qs,20:Qs,21:eT};function dq(e,t){for(var r=e.l+t,s=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{s.push(uq[a](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function r0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Qv(e,t,r){var s=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,a=8;break;case"biff4":s=4,a=6;break;case"biff3":s=3,a=6;break;case"biff2":s=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=nt(a);return o.write_shift(2,s),o.write_shift(2,t),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function fq(e,t){return t===0||e.read_shift(2),1200}function hq(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,a=Tl(e,0,r);return e.read_shift(t+s-e.l),a}function mq(e,t){var r=!t||t.biff==8,s=nt(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function pq(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function xq(e,t,r){var s=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=ff(e,0,r);return l.length===0&&(l="Sheet1"),{pos:s,hs:a,dt:o,name:l}}function gq(e,t){var r=!t||t.biff>=8?2:1,s=nt(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=s.slice(0,s.l);return a.l=s.l,a}function yq(e,t){for(var r=e.l+t,s=e.read_shift(4),a=e.read_shift(4),o=[],l=0;l!=a&&e.l<r;++l)o.push(X$(e));return o.Count=s,o.Unique=a,o}function vq(e,t){var r=nt(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],a=0;a<e.length;++a)s[a]=Y$(e[a]);var o=Is([r].concat(s));return o.parts=[r.length].concat(s.map(function(l){return l.length})),o}function bq(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function wq(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function _q(e){var t=sq(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Nq(e){return e.read_shift(2),e.read_shift(4)}function dE(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(s=1-(a>>15),a&=32767);var o={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[o,a]}function Sq(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),h=e.read_shift(2);return{Pos:[t,r],Dim:[s,a],Flags:o,CurTab:l,FirstTab:u,Selected:d,TabRatio:h}}function kq(){var e=nt(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Eq(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function jq(e){var t=nt(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Tq(){}function Aq(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=ff(e,0,r),s}function Cq(e,t){var r=e.name||"Arial",s=t&&t.biff==5,a=s?15+r.length:16+2*r.length,o=nt(a);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,r.length),s||o.write_shift(1,1),o.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),o}function Rq(e){var t=Wn(e);return t.isst=e.read_shift(4),t}function Dq(e,t,r,s){var a=nt(10);return pl(e,t,s,a),a.write_shift(4,r),a}function Oq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,a=Wn(e);r.biff==2&&e.l++;var o=hf(e,s-e.l,r);return a.val=o,a}function Fq(e,t,r,s,a){var o=!a||a.biff==8,l=nt(8+ +o+(1+o)*r.length);return pl(e,t,s,l),l.write_shift(2,r.length),o&&l.write_shift(1,1),l.write_shift((1+o)*r.length,r,o?"utf16le":"sbcs"),l}function Lq(e,t,r){var s=e.read_shift(2),a=Tl(e,0,r);return[s,a]}function Iq(e,t,r,s){var a=r&&r.biff==5;s||(s=nt(a?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(a?1:2,t.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var o=s.length>s.l?s.slice(0,s.l):s;return o.l==null&&(o.l=o.length),o}var Mq=Tl;function fE(e,t,r){var s=e.l+t,a=r.biff==8||!r.biff?4:2,o=e.read_shift(a),l=e.read_shift(a),u=e.read_shift(2),d=e.read_shift(2);return e.l=s,{s:{r:o,c:u},e:{r:l,c:d}}}function Bq(e,t){var r=t.biff==8||!t.biff?4:2,s=nt(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function Pq(e){var t=e.read_shift(2),r=e.read_shift(2),s=J5(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function Uq(e,t){for(var r=e.l+t-2,s=e.read_shift(2),a=e.read_shift(2),o=[];e.l<r;)o.push(J5(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:s,c:a,C:l,rkrec:o}}function zq(e,t){for(var r=e.l+t-2,s=e.read_shift(2),a=e.read_shift(2),o=[];e.l<r;)o.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:s,c:a,C:l,ixfe:o}}function $q(e,t,r,s){var a={},o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2);return a.patternType=_$[u>>26],s.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=d&127,a.icvBack=d>>7&127,a.fsxButton=d>>14&1),a}function qq(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=$q(e,t,s.fStyle,r),s}function hE(e,t,r,s){var a=r&&r.biff==5;s||(s=nt(a?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var o=0;return e.numFmtId>0&&a&&(o|=1024),s.write_shift(4,o),s.write_shift(4,0),a||s.write_shift(4,0),s.write_shift(2,0),s}function Hq(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Wq(e){var t=nt(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function mE(e,t,r){var s=Wn(e);(r.biff==2||t==9)&&++e.l;var a=K$(e);return s.val=a,s.t=a===!0||a===!1?"b":"e",s}function Gq(e,t,r,s,a,o){var l=nt(8);return pl(e,t,s,l),V5(r,o,l),l}function Vq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=Wn(e),a=aa(e);return s.val=a,s}function Kq(e,t,r,s){var a=nt(14);return pl(e,t,s,a),hl(r,a),a}var pE=aq;function Xq(e,t,r){var s=e.l+t,a=e.read_shift(2),o=e.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=ml(e,o),u=[];s>e.l;)u.push(hf(e));return[o,a,l,u]}function xE(e,t,r){var s=e.read_shift(2),a,o={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(a=iq(e,t-2,r)),o.body=a||e.read_shift(t-2),typeof a=="string"&&(o.Name=a),o}var Yq=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function gE(e,t,r){var s=e.l+t,a=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),d=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),d=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var h=ml(e,l,r);a&32&&(h=Yq[h.charCodeAt(0)]);var m=s-e.l;r&&r.biff==2&&--m;var x=s==e.l||u===0||!(m>0)?[]:dK(e,m,r,u);return{chKey:o,Name:h,itab:d,rgce:x}}function tT(e,t,r){if(r.biff<8)return Jq(e,t,r);for(var s=[],a=e.l+t,o=e.read_shift(r.biff>8?4:2);o--!==0;)s.push(nq(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return s}function Jq(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=ff(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function Zq(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),a=e.read_shift(2),o=ml(e,s,r),l=ml(e,a,r);return[o,l]}function Qq(e,t,r){var s=Q5(e);e.l++;var a=e.read_shift(1);return t-=8,[fK(e,t,r),a,s]}function yE(e,t,r){var s=oq(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,cK(e,t,r)]}function eH(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function tH(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=Tl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:a},u,l,o]}}function rH(e,t,r){return tH(e,t,r)}function sH(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(bm(e));return r}function aH(e){var t=nt(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Z5(e[r],t);return t}function nH(e,t,r){if(r&&r.biff<8)return oH(e,t,r);var s=eT(e),a=dq(e,t-22,s[1]);return{cmo:s,ft:a}}var iH={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:s}}};function oH(e,t,r){e.l+=4;var s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((iH[s]||la)(e,t,r)),{cmo:[a,s,o],ft:l}}function lH(e,t,r){var s=e.l,a="";try{e.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=J$(e,6,r);var u=e.read_shift(2);e.read_shift(2),ks(e,2);var d=e.read_shift(2);e.l+=d;for(var h=1;h<e.lens.length-1;++h){if(e.l-s!=e.lens[h])throw new Error("TxO: bad continue record");var m=e[e.l],x=ml(e,e.lens[h+1]-e.lens[h]-1);if(a+=x,a.length>=(m?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return e.l=s+t,{t:a}}catch{return e.l=s+t,{t:a}}}function cH(e,t){var r=bm(e);e.l+=16;var s=tq(e,t-24);return[r,s]}function uH(e){var t=nt(24),r=es(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(s[a],16));return Is([t,rq(e[1])])}function dH(e,t){e.read_shift(2);var r=bm(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(ma,""),[r,s]}function fH(e){var t=e[1].Tooltip,r=nt(10+2*(t.length+1));r.write_shift(2,2048);var s=es(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function hH(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=rE[r]||r,r=e.read_shift(2),t[1]=rE[r]||r,t}function mH(e){return e||(e=nt(4)),e.write_shift(2,1),e.write_shift(2,1),e}function pH(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Y5(e));return r}function xH(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Y5(e));return r}function gH(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function rT(e,t,r){if(!r.cellStyles)return la(e,t);var s=r&&r.biff>=12?4:2,a=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(s),u=e.read_shift(s),d=e.read_shift(2);s==2&&(e.l+=2);var h={s:a,e:o,w:l,ixfe:u,flags:d};return(r.biff>=5||!r.biff)&&(h.level=d>>8&7),h}function yH(e,t){var r=nt(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function vH(e,t){var r={};return t<32||(e.l+=16,r.header=aa(e),r.footer=aa(e),e.l+=2),r}function bH(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var a=e.read_shift(1);return e.l+=3,a&16&&(s.area=!0),s}function wH(e){for(var t=nt(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var _H=Wn,NH=G5,SH=hf;function kH(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),a={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,a}function EH(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=Wn(e);++e.l;var a=Tl(e,t-7,r);return s.t="str",s.val=a,s}function jH(e){var t=Wn(e);++e.l;var r=aa(e);return t.t="n",t.val=r,t}function TH(e,t,r){var s=nt(15);return gf(s,e,t),s.write_shift(8,r,"f"),s}function AH(e){var t=Wn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function CH(e,t,r){var s=nt(9);return gf(s,e,t),s.write_shift(2,r),s}function RH(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function DH(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function OH(e,t,r){var s=e.l+t,a=Wn(e),o=e.read_shift(2),l=ml(e,o,r);return e.l=s,a.t="str",a.val=l,a}var FH=[2,3,48,49,131,139,140,245],Gy=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=gm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,d){var h=[],m=mo(1);switch(d.type){case"base64":m=Ua(qa(u));break;case"binary":m=Ua(u);break;case"buffer":case"array":m=u;break}Ks(m,0);var x=m.read_shift(1),y=!!(x&136),v=!1,b=!1;switch(x){case 2:break;case 3:break;case 48:v=!0,y=!0;break;case 49:v=!0,y=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var g=0,_=521;x==2&&(g=m.read_shift(2)),m.l+=3,x!=2&&(g=m.read_shift(4)),g>1048576&&(g=1e6),x!=2&&(_=m.read_shift(2));var w=m.read_shift(2),k=d.codepage||1252;x!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(k=e[m[m.l]]),m.l+=1,m.l+=2),b&&(m.l+=36);for(var N=[],E={},C=Math.min(m.length,x==2?521:_-10-(v?264:0)),L=b?32:11;m.l<C&&m[m.l]!=13;)switch(E={},E.name=Bd.utils.decode(k,m.slice(m.l,m.l+L)).replace(/[\u0000\r\n].*$/g,""),m.l+=L,E.type=String.fromCharCode(m.read_shift(1)),x!=2&&!b&&(E.offset=m.read_shift(4)),E.len=m.read_shift(1),x==2&&(E.offset=m.read_shift(2)),E.dec=m.read_shift(1),E.name.length&&N.push(E),x!=2&&(m.l+=b?13:14),E.type){case"B":(!v||E.len!=8)&&d.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(m[m.l]!==13&&(m.l=_-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=_;var O=0,B=0;for(h[0]=[],B=0;B!=N.length;++B)h[0][B]=N[B].name;for(;g-- >0;){if(m[m.l]===42){m.l+=w;continue}for(++m.l,h[++O]=[],B=0,B=0;B!=N.length;++B){var F=m.slice(m.l,m.l+N[B].len);m.l+=N[B].len,Ks(F,0);var q=Bd.utils.decode(k,F);switch(N[B].type){case"C":q.trim().length&&(h[O][B]=q.replace(/\s+$/,""));break;case"D":q.length===8?h[O][B]=new Date(+q.slice(0,4),+q.slice(4,6)-1,+q.slice(6,8)):h[O][B]=q;break;case"F":h[O][B]=parseFloat(q.trim());break;case"+":case"I":h[O][B]=b?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(q.trim().toUpperCase()){case"Y":case"T":h[O][B]=!0;break;case"N":case"F":h[O][B]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+q+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));h[O][B]="##MEMO##"+(b?parseInt(q.trim(),10):F.read_shift(4));break;case"N":q=q.replace(/\u0000/g,"").trim(),q&&q!="."&&(h[O][B]=+q||0);break;case"@":h[O][B]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":h[O][B]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":h[O][B]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[O][B]=-F.read_shift(-8,"f");break;case"B":if(v&&N[B].len==8){h[O][B]=F.read_shift(8,"f");break}case"G":case"P":F.l+=N[B].len;break;case"0":if(N[B].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[B].type)}}}if(x!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return d&&d.sheetRows&&(h=h.slice(0,d.sheetRows)),d.DBF=N,h}function s(u,d){var h=d||{};h.dateNF||(h.dateNF="yyyymmdd");var m=iu(r(u,h),h);return m["!cols"]=h.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete h.DBF,m}function a(u,d){try{return wo(s(u,d),d)}catch(h){if(d&&d.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,d){var h=d||{};if(+h.codepage>=0&&kn(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var m=Ea(),x=K0(u,{header:1,raw:!0,cellDates:!0}),y=x[0],v=x.slice(1),b=u["!cols"]||[],g=0,_=0,w=0,k=1;for(g=0;g<y.length;++g){if(((b[g]||{}).DBF||{}).name){y[g]=b[g].DBF.name,++w;continue}if(y[g]!=null){if(++w,typeof y[g]=="number"&&(y[g]=y[g].toString(10)),typeof y[g]!="string")throw new Error("DBF Invalid column name "+y[g]+" |"+typeof y[g]+"|");if(y.indexOf(y[g])!==g){for(_=0;_<1024;++_)if(y.indexOf(y[g]+"_"+_)==-1){y[g]+="_"+_;break}}}}var N=gr(u["!ref"]),E=[],C=[],L=[];for(g=0;g<=N.e.c-N.s.c;++g){var O="",B="",F=0,q=[];for(_=0;_<v.length;++_)v[_][g]!=null&&q.push(v[_][g]);if(q.length==0||y[g]==null){E[g]="?";continue}for(_=0;_<q.length;++_){switch(typeof q[_]){case"number":B="B";break;case"string":B="C";break;case"boolean":B="L";break;case"object":B=q[_]instanceof Date?"D":"C";break;default:B="C"}F=Math.max(F,String(q[_]).length),O=O&&O!=B?"C":B}F>250&&(F=250),B=((b[g]||{}).DBF||{}).type,B=="C"&&b[g].DBF.len>F&&(F=b[g].DBF.len),O=="B"&&B=="N"&&(O="N",L[g]=b[g].DBF.dec,F=b[g].DBF.len),C[g]=O=="C"||B=="N"?F:o[O]||0,k+=C[g],E[g]=O}var fe=m.next(32);for(fe.write_shift(4,318902576),fe.write_shift(4,v.length),fe.write_shift(2,296+32*w),fe.write_shift(2,k),g=0;g<4;++g)fe.write_shift(4,0);for(fe.write_shift(4,0|(+t[Wj]||3)<<8),g=0,_=0;g<y.length;++g)if(y[g]!=null){var D=m.next(32),V=(y[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,V,"sbcs"),D.write_shift(1,E[g]=="?"?"C":E[g],"sbcs"),D.write_shift(4,_),D.write_shift(1,C[g]||o[E[g]]||0),D.write_shift(1,L[g]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),_+=C[g]||o[E[g]]||0}var I=m.next(264);for(I.write_shift(4,13),g=0;g<65;++g)I.write_shift(4,0);for(g=0;g<v.length;++g){var ae=m.next(k);for(ae.write_shift(1,0),_=0;_<y.length;++_)if(y[_]!=null)switch(E[_]){case"L":ae.write_shift(1,v[g][_]==null?63:v[g][_]?84:70);break;case"B":ae.write_shift(8,v[g][_]||0,"f");break;case"N":var Q="0";for(typeof v[g][_]=="number"&&(Q=v[g][_].toFixed(L[_]||0)),w=0;w<C[_]-Q.length;++w)ae.write_shift(1,32);ae.write_shift(1,Q,"sbcs");break;case"D":v[g][_]?(ae.write_shift(4,("0000"+v[g][_].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(v[g][_].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+v[g][_].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var te=String(v[g][_]!=null?v[g][_]:"").slice(0,C[_]);for(ae.write_shift(1,te,"sbcs"),w=0;w<C[_]-te.length;++w)ae.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:a,to_sheet:s,from_sheet:l}})(),sT=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ls(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,v){var b=e[v];return typeof b=="number"?Ak(b):b},s=function(y,v,b){var g=v.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return g==59?y:Ak(g)};e["|"]=254;function a(y,v){switch(v.type){case"base64":return o(qa(y),v);case"binary":return o(y,v);case"buffer":return o(ar&&Buffer.isBuffer(y)?y.toString("binary"):bo(y),v);case"array":return o(fl(y),v)}throw new Error("Unrecognized type "+v.type)}function o(y,v){var b=y.split(/[\n\r]+/),g=-1,_=-1,w=0,k=0,N=[],E=[],C=null,L={},O=[],B=[],F=[],q=0,fe;for(+v.codepage>=0&&kn(+v.codepage);w!==b.length;++w){q=0;var D=b[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),V=D.replace(/;;/g,"\0").split(";").map(function(re){return re.replace(/\u0000/g,";")}),I=V[0],ae;if(D.length>0)switch(I){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&E.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,te=!1,ve=!1,ee=!1,Se=-1,J=-1;for(k=1;k<V.length;++k)switch(V[k].charAt(0)){case"A":break;case"X":_=parseInt(V[k].slice(1))-1,te=!0;break;case"Y":for(g=parseInt(V[k].slice(1))-1,te||(_=0),fe=N.length;fe<=g;++fe)N[fe]=[];break;case"K":ae=V[k].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(jn(ae))?isNaN(Xc(ae).getDate())||(ae=Gr(ae)):(ae=jn(ae),C!==null&&au(C)&&(ae=vm(ae))),Q=!0;break;case"E":ee=!0;var M=Pc(V[k].slice(1),{r:g,c:_});N[g][_]=[N[g][_],M];break;case"S":ve=!0,N[g][_]=[N[g][_],"S5S"];break;case"G":break;case"R":Se=parseInt(V[k].slice(1))-1;break;case"C":J=parseInt(V[k].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+D)}if(Q&&(N[g][_]&&N[g][_].length==2?N[g][_][0]=ae:N[g][_]=ae,C=null),ve){if(ee)throw new Error("SYLK shared formula cannot have own formula");var Y=Se>-1&&N[Se][J];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");N[g][_][1]=wT(Y[1],{r:g-Se,c:_-J})}break;case"F":var G=0;for(k=1;k<V.length;++k)switch(V[k].charAt(0)){case"X":_=parseInt(V[k].slice(1))-1,++G;break;case"Y":for(g=parseInt(V[k].slice(1))-1,fe=N.length;fe<=g;++fe)N[fe]=[];break;case"M":q=parseInt(V[k].slice(1))/20;break;case"F":break;case"G":break;case"P":C=E[parseInt(V[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=V[k].slice(1).split(" "),fe=parseInt(F[0],10);fe<=parseInt(F[1],10);++fe)q=parseInt(F[2],10),B[fe-1]=q===0?{hidden:!0}:{wch:q},po(B[fe-1]);break;case"C":_=parseInt(V[k].slice(1))-1,B[_]||(B[_]={});break;case"R":g=parseInt(V[k].slice(1))-1,O[g]||(O[g]={}),q>0?(O[g].hpt=q,O[g].hpx=Jc(q)):q===0&&(O[g].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+D)}G<1&&(C=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+D)}}return O.length>0&&(L["!rows"]=O),B.length>0&&(L["!cols"]=B),v&&v.sheetRows&&(N=N.slice(0,v.sheetRows)),[N,L]}function l(y,v){var b=a(y,v),g=b[0],_=b[1],w=iu(g,v);return ls(_).forEach(function(k){w[k]=_[k]}),w}function u(y,v){return wo(l(y,v),v)}function d(y,v,b,g){var _="C;Y"+(b+1)+";X"+(g+1)+";K";switch(y.t){case"n":_+=y.v||0,y.f&&!y.F&&(_+=";E"+nb(y.f,{r:b,c:g}));break;case"b":_+=y.v?"TRUE":"FALSE";break;case"e":_+=y.w||y.v;break;case"d":_+='"'+(y.w||y.v)+'"';break;case"s":_+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function h(y,v){v.forEach(function(b,g){var _="F;W"+(g+1)+" "+(g+1)+" ";b.hidden?_+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=Gd(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=Vd(b.wpx)),typeof b.wch=="number"&&(_+=Math.round(b.wch))),_.charAt(_.length-1)!=" "&&y.push(_)})}function m(y,v){v.forEach(function(b,g){var _="F;";b.hidden?_+="M0;":b.hpt?_+="M"+20*b.hpt+";":b.hpx&&(_+="M"+20*Kd(b.hpx)+";"),_.length>2&&y.push(_+"R"+(g+1))})}function x(y,v){var b=["ID;PWXL;N;E"],g=[],_=gr(y["!ref"]),w,k=Array.isArray(y),N=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),y["!cols"]&&h(b,y["!cols"]),y["!rows"]&&m(b,y["!rows"]),b.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var E=_.s.r;E<=_.e.r;++E)for(var C=_.s.c;C<=_.e.c;++C){var L=Gt({r:E,c:C});w=k?(y[E]||[])[C]:y[L],!(!w||w.v==null&&(!w.f||w.F))&&g.push(d(w,y,E,C))}return b.join(N)+N+g.join(N)+N+"E"+N}return{to_workbook:u,to_sheet:l,from_sheet:x}})(),aT=(function(){function e(o,l){switch(l.type){case"base64":return t(qa(o),l);case"binary":return t(o,l);case"buffer":return t(ar&&Buffer.isBuffer(o)?o.toString("binary"):bo(o),l);case"array":return t(fl(o),l)}throw new Error("Unrecognized type "+l.type)}function t(o,l){for(var u=o.split(`
`),d=-1,h=-1,m=0,x=[];m!==u.length;++m){if(u[m].trim()==="BOT"){x[++d]=[],h=0;continue}if(!(d<0)){var y=u[m].trim().split(","),v=y[0],b=y[1];++m;for(var g=u[m]||"";(g.match(/["]/g)||[]).length&1&&m<u.length-1;)g+=`
`+u[++m];switch(g=g.trim(),+v){case-1:if(g==="BOT"){x[++d]=[],h=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?x[d][h]=!0:g==="FALSE"?x[d][h]=!1:isNaN(jn(b))?isNaN(Xc(b).getDate())?x[d][h]=b:x[d][h]=Gr(b):x[d][h]=jn(b),++h;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),x[d][h++]=g!==""?g:null;break}if(g==="EOD")break}}return l&&l.sheetRows&&(x=x.slice(0,l.sheetRows)),x}function r(o,l){return iu(e(o,l),l)}function s(o,l){return wo(r(o,l),l)}var a=(function(){var o=function(d,h,m,x,y){d.push(h),d.push(m+","+x),d.push('"'+y.replace(/"/g,'""')+'"')},l=function(d,h,m,x){d.push(h+","+m),d.push(h==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(d){var h=[],m=gr(d["!ref"]),x,y=Array.isArray(d);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,m.e.r-m.s.r+1,""),o(h,"TUPLES",0,m.e.c-m.s.c+1,""),o(h,"DATA",0,0,"");for(var v=m.s.r;v<=m.e.r;++v){l(h,-1,0,"BOT");for(var b=m.s.c;b<=m.e.c;++b){var g=Gt({r:v,c:b});if(x=y?(d[v]||[])[b]:d[g],!x){l(h,1,0,"");continue}switch(x.t){case"n":var _=x.w;!_&&x.v!=null&&(_=x.v),_==null?x.f&&!x.F?l(h,1,0,"="+x.f):l(h,1,0,""):l(h,0,_,"V");break;case"b":l(h,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":l(h,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=hn(x.z||Wt[14],Rs(Gr(x.v)))),l(h,0,x.w,"V");break;default:l(h,1,0,"")}}}l(h,-1,0,"EOD");var w=`\r
`,k=h.join(w);return k}})();return{to_workbook:s,to_sheet:r,from_sheet:a}})(),nT=(function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,y){for(var v=x.split(`
`),b=-1,g=-1,_=0,w=[];_!==v.length;++_){var k=v[_].trim().split(":");if(k[0]==="cell"){var N=es(k[1]);if(w.length<=N.r)for(b=w.length;b<=N.r;++b)w[b]||(w[b]=[]);switch(b=N.r,g=N.c,k[2]){case"t":w[b][g]=e(k[3]);break;case"v":w[b][g]=+k[3];break;case"vtf":var E=k[k.length-1];case"vtc":k[3]==="nl"?w[b][g]=!!+k[4]:w[b][g]=+k[4],k[2]=="vtf"&&(w[b][g]=[w[b][g],E])}}}return y&&y.sheetRows&&(w=w.slice(0,y.sheetRows)),w}function s(x,y){return iu(r(x,y),y)}function a(x,y){return wo(s(x,y),y)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function h(x){if(!x||!x["!ref"])return"";for(var y=[],v=[],b,g="",_=ja(x["!ref"]),w=Array.isArray(x),k=_.s.r;k<=_.e.r;++k)for(var N=_.s.c;N<=_.e.c;++N)if(g=Gt({r:k,c:N}),b=w?(x[k]||[])[N]:x[g],!(!b||b.v==null||b.t==="z")){switch(v=["cell",g,"t"],b.t){case"s":case"str":v.push(t(b.v));break;case"n":b.f?(v[2]="vtf",v[3]="n",v[4]=b.v,v[5]=t(b.f)):(v[2]="v",v[3]=b.v);break;case"b":v[2]="vt"+(b.f?"f":"c"),v[3]="nl",v[4]=b.v?"1":"0",v[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var E=Rs(Gr(b.v));v[2]="vtc",v[3]="nd",v[4]=""+E,v[5]=b.w||hn(b.z||Wt[14],E);break;case"e":continue}y.push(v.join(":"))}return y.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function m(x){return[o,l,u,l,h(x),d].join(`
`)}return{to_workbook:a,to_sheet:s,from_sheet:m}})(),Yc=(function(){function e(m,x,y,v,b){b.raw?x[y][v]=m:m===""||(m==="TRUE"?x[y][v]=!0:m==="FALSE"?x[y][v]=!1:isNaN(jn(m))?isNaN(Xc(m).getDate())?x[y][v]=m:x[y][v]=Gr(m):x[y][v]=jn(m))}function t(m,x){var y=x||{},v=[];if(!m||m.length===0)return v;for(var b=m.split(/[\r\n]/),g=b.length-1;g>=0&&b[g].length===0;)--g;for(var _=10,w=0,k=0;k<=g;++k)w=b[k].indexOf(" "),w==-1?w=b[k].length:w++,_=Math.max(_,w);for(k=0;k<=g;++k){v[k]=[];var N=0;for(e(b[k].slice(0,_).trim(),v,k,N,y),N=1;N<=(b[k].length-_)/10+1;++N)e(b[k].slice(_+(N-1)*10,_+N*10).trim(),v,k,N,y)}return y.sheetRows&&(v=v.slice(0,y.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function a(m){for(var x={},y=!1,v=0,b=0;v<m.length;++v)(b=m.charCodeAt(v))==34?y=!y:!y&&b in r&&(x[b]=(x[b]||0)+1);b=[];for(v in x)Object.prototype.hasOwnProperty.call(x,v)&&b.push([x[v],v]);if(!b.length){x=s;for(v in x)Object.prototype.hasOwnProperty.call(x,v)&&b.push([x[v],v])}return b.sort(function(g,_){return g[0]-_[0]||s[g[1]]-s[_[1]]}),r[b.pop()[1]]||44}function o(m,x){var y=x||{},v="",b=y.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(v=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(v=m.charAt(4),m=m.slice(6)):v=a(m.slice(0,1024)):y&&y.FS?v=y.FS:v=a(m.slice(0,1024));var _=0,w=0,k=0,N=0,E=0,C=v.charCodeAt(0),L=!1,O=0,B=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var F=y.dateNF!=null?bz(y.dateNF):null;function q(){var fe=m.slice(N,E),D={};if(fe.charAt(0)=='"'&&fe.charAt(fe.length-1)=='"'&&(fe=fe.slice(1,-1).replace(/""/g,'"')),fe.length===0)D.t="z";else if(y.raw)D.t="s",D.v=fe;else if(fe.trim().length===0)D.t="s",D.v=fe;else if(fe.charCodeAt(0)==61)fe.charCodeAt(1)==34&&fe.charCodeAt(fe.length-1)==34?(D.t="s",D.v=fe.slice(2,-1).replace(/""/g,'"')):XG(fe)?(D.t="n",D.f=fe.slice(1)):(D.t="s",D.v=fe);else if(fe=="TRUE")D.t="b",D.v=!0;else if(fe=="FALSE")D.t="b",D.v=!1;else if(!isNaN(k=jn(fe)))D.t="n",y.cellText!==!1&&(D.w=fe),D.v=k;else if(!isNaN(Xc(fe).getDate())||F&&fe.match(F)){D.z=y.dateNF||Wt[14];var V=0;F&&fe.match(F)&&(fe=wz(fe,y.dateNF,fe.match(F)||[]),V=1),y.cellDates?(D.t="d",D.v=Gr(fe,V)):(D.t="n",D.v=Rs(Gr(fe,V))),y.cellText!==!1&&(D.w=hn(D.z,D.v instanceof Date?Rs(D.v):D.v)),y.cellNF||delete D.z}else D.t="s",D.v=fe;if(D.t=="z"||(y.dense?(b[_]||(b[_]=[]),b[_][w]=D):b[Gt({c:w,r:_})]=D),N=E+1,B=m.charCodeAt(N),g.e.c<w&&(g.e.c=w),g.e.r<_&&(g.e.r=_),O==C)++w;else if(w=0,++_,y.sheetRows&&y.sheetRows<=_)return!0}e:for(;E<m.length;++E)switch(O=m.charCodeAt(E)){case 34:B===34&&(L=!L);break;case C:case 10:case 13:if(!L&&q())break e;break}return E-N>0&&q(),b["!ref"]=Zt(g),b}function l(m,x){return!(x&&x.PRN)||x.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?o(m,x):iu(t(m,x),x)}function u(m,x){var y="",v=x.type=="string"?[0,0,0,0]:hb(m,x);switch(x.type){case"base64":y=qa(m);break;case"binary":y=m;break;case"buffer":x.codepage==65001?y=m.toString("utf8"):x.codepage&&typeof Bd<"u"||(y=ar&&Buffer.isBuffer(m)?m.toString("binary"):bo(m));break;case"array":y=fl(m);break;case"string":y=m;break;default:throw new Error("Unrecognized type "+x.type)}return v[0]==239&&v[1]==187&&v[2]==191?y=Mr(y.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?y=Mr(y):x.type=="binary"&&typeof Bd<"u",y.slice(0,19)=="socialcalc:version:"?nT.to_sheet(x.type=="string"?y:Mr(y),x):l(y,x)}function d(m,x){return wo(u(m,x),x)}function h(m){for(var x=[],y=gr(m["!ref"]),v,b=Array.isArray(m),g=y.s.r;g<=y.e.r;++g){for(var _=[],w=y.s.c;w<=y.e.c;++w){var k=Gt({r:g,c:w});if(v=b?(m[g]||[])[w]:m[k],!v||v.v==null){_.push("          ");continue}for(var N=(v.w||(Si(v),v.w)||"").slice(0,10);N.length<10;)N+=" ";_.push(N+(w===0?" ":""))}x.push(_.join(""))}return x.join(`
`)}return{to_workbook:d,to_sheet:u,from_sheet:h}})();function LH(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var a=sT.to_workbook(e,r);return r.WTF=s,a}catch(o){if(r.WTF=s,!o.message.match(/SYLK bad record ID/)&&s)throw o;return Yc.to_workbook(e,t)}}var nl=(function(){function e(M,Y,G){if(M){Ks(M,M.l||0);for(var re=G.Enum||Se;M.l<M.length;){var ce=M.read_shift(2),P=re[ce]||re[65535],U=M.read_shift(2),le=M.l+U,ne=P.f&&P.f(M,U,G);if(M.l=le,Y(ne,P,ce))return}}}function t(M,Y){switch(Y.type){case"base64":return r(Ua(qa(M)),Y);case"binary":return r(Ua(M),Y);case"buffer":case"array":return r(M,Y)}throw"Unsupported type "+Y.type}function r(M,Y){if(!M)return M;var G=Y||{},re=G.dense?[]:{},ce="Sheet1",P="",U=0,le={},ne=[],ie=[],H={s:{r:0,c:0},e:{r:0,c:0}},K=G.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)G.Enum=Se,e(M,function(T,A,W){switch(W){case 0:G.vers=T,T>=4096&&(G.qpro=!0);break;case 6:H=T;break;case 204:T&&(P=T);break;case 222:P=T;break;case 15:case 51:G.qpro||(T[1].v=T[1].v.slice(1));case 13:case 14:case 16:W==14&&(T[2]&112)==112&&(T[2]&15)>1&&(T[2]&15)<15&&(T[1].z=G.dateNF||Wt[14],G.cellDates&&(T[1].t="d",T[1].v=vm(T[1].v))),G.qpro&&T[3]>U&&(re["!ref"]=Zt(H),le[ce]=re,ne.push(ce),re=G.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},U=T[3],ce=P||"Sheet"+(U+1),P="");var pe=G.dense?(re[T[0].r]||[])[T[0].c]:re[Gt(T[0])];if(pe){pe.t=T[1].t,pe.v=T[1].v,T[1].z!=null&&(pe.z=T[1].z),T[1].f!=null&&(pe.f=T[1].f);break}G.dense?(re[T[0].r]||(re[T[0].r]=[]),re[T[0].r][T[0].c]=T[1]):re[Gt(T[0])]=T[1];break}},G);else if(M[2]==26||M[2]==14)G.Enum=J,M[2]==14&&(G.qpro=!0,M.l=0),e(M,function(T,A,W){switch(W){case 204:ce=T;break;case 22:T[1].v=T[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(T[3]>U&&(re["!ref"]=Zt(H),le[ce]=re,ne.push(ce),re=G.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},U=T[3],ce="Sheet"+(U+1)),K>0&&T[0].r>=K)break;G.dense?(re[T[0].r]||(re[T[0].r]=[]),re[T[0].r][T[0].c]=T[1]):re[Gt(T[0])]=T[1],H.e.c<T[0].c&&(H.e.c=T[0].c),H.e.r<T[0].r&&(H.e.r=T[0].r);break;case 27:T[14e3]&&(ie[T[14e3][0]]=T[14e3][1]);break;case 1537:ie[T[0]]=T[1],T[0]==U&&(ce=T[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(re["!ref"]=Zt(H),le[P||ce]=re,ne.push(P||ce),!ie.length)return{SheetNames:ne,Sheets:le};for(var S={},ue=[],z=0;z<ie.length;++z)le[ne[z]]?(ue.push(ie[z]||ne[z]),S[ie[z]]=le[ie[z]]||le[ne[z]]):(ue.push(ie[z]),S[ie[z]]={"!ref":"A1"});return{SheetNames:ue,Sheets:S}}function s(M,Y){var G=Y||{};if(+G.codepage>=0&&kn(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var re=Ea(),ce=gr(M["!ref"]),P=Array.isArray(M),U=[];St(re,0,o(1030)),St(re,6,d(ce));for(var le=Math.min(ce.e.r,8191),ne=ce.s.r;ne<=le;++ne)for(var ie=xs(ne),H=ce.s.c;H<=ce.e.c;++H){ne===ce.s.r&&(U[H]=Qr(H));var K=U[H]+ie,S=P?(M[ne]||[])[H]:M[K];if(!(!S||S.t=="z"))if(S.t=="n")(S.v|0)==S.v&&S.v>=-32768&&S.v<=32767?St(re,13,v(ne,H,S.v)):St(re,14,g(ne,H,S.v));else{var ue=Si(S);St(re,15,x(ne,H,ue.slice(0,239)))}}return St(re,1),re.end()}function a(M,Y){var G=Y||{};if(+G.codepage>=0&&kn(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var re=Ea();St(re,0,l(M));for(var ce=0,P=0;ce<M.SheetNames.length;++ce)(M.Sheets[M.SheetNames[ce]]||{})["!ref"]&&St(re,27,ee(M.SheetNames[ce],P++));var U=0;for(ce=0;ce<M.SheetNames.length;++ce){var le=M.Sheets[M.SheetNames[ce]];if(!(!le||!le["!ref"])){for(var ne=gr(le["!ref"]),ie=Array.isArray(le),H=[],K=Math.min(ne.e.r,8191),S=ne.s.r;S<=K;++S)for(var ue=xs(S),z=ne.s.c;z<=ne.e.c;++z){S===ne.s.r&&(H[z]=Qr(z));var T=H[z]+ue,A=ie?(le[S]||[])[z]:le[T];if(!(!A||A.t=="z"))if(A.t=="n")St(re,23,q(S,z,U,A.v));else{var W=Si(A);St(re,22,O(S,z,U,W.slice(0,239)))}}++U}}return St(re,1),re.end()}function o(M){var Y=nt(2);return Y.write_shift(2,M),Y}function l(M){var Y=nt(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var G=0,re=0,ce=0,P=0;P<M.SheetNames.length;++P){var U=M.SheetNames[P],le=M.Sheets[U];if(!(!le||!le["!ref"])){++ce;var ne=ja(le["!ref"]);G<ne.e.r&&(G=ne.e.r),re<ne.e.c&&(re=ne.e.c)}}return G>8191&&(G=8191),Y.write_shift(2,G),Y.write_shift(1,ce),Y.write_shift(1,re),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function u(M,Y,G){var re={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&G.qpro?(re.s.c=M.read_shift(1),M.l++,re.s.r=M.read_shift(2),re.e.c=M.read_shift(1),M.l++,re.e.r=M.read_shift(2),re):(re.s.c=M.read_shift(2),re.s.r=M.read_shift(2),Y==12&&G.qpro&&(M.l+=2),re.e.c=M.read_shift(2),re.e.r=M.read_shift(2),Y==12&&G.qpro&&(M.l+=2),re.s.c==65535&&(re.s.c=re.e.c=re.s.r=re.e.r=0),re)}function d(M){var Y=nt(8);return Y.write_shift(2,M.s.c),Y.write_shift(2,M.s.r),Y.write_shift(2,M.e.c),Y.write_shift(2,M.e.r),Y}function h(M,Y,G){var re=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(re[0].c=M.read_shift(1),re[3]=M.read_shift(1),re[0].r=M.read_shift(2),M.l+=2):(re[2]=M.read_shift(1),re[0].c=M.read_shift(2),re[0].r=M.read_shift(2)),re}function m(M,Y,G){var re=M.l+Y,ce=h(M,Y,G);if(ce[1].t="s",G.vers==20768){M.l++;var P=M.read_shift(1);return ce[1].v=M.read_shift(P,"utf8"),ce}return G.qpro&&M.l++,ce[1].v=M.read_shift(re-M.l,"cstr"),ce}function x(M,Y,G){var re=nt(7+G.length);re.write_shift(1,255),re.write_shift(2,Y),re.write_shift(2,M),re.write_shift(1,39);for(var ce=0;ce<re.length;++ce){var P=G.charCodeAt(ce);re.write_shift(1,P>=128?95:P)}return re.write_shift(1,0),re}function y(M,Y,G){var re=h(M,Y,G);return re[1].v=M.read_shift(2,"i"),re}function v(M,Y,G){var re=nt(7);return re.write_shift(1,255),re.write_shift(2,Y),re.write_shift(2,M),re.write_shift(2,G,"i"),re}function b(M,Y,G){var re=h(M,Y,G);return re[1].v=M.read_shift(8,"f"),re}function g(M,Y,G){var re=nt(13);return re.write_shift(1,255),re.write_shift(2,Y),re.write_shift(2,M),re.write_shift(8,G,"f"),re}function _(M,Y,G){var re=M.l+Y,ce=h(M,Y,G);if(ce[1].v=M.read_shift(8,"f"),G.qpro)M.l=re;else{var P=M.read_shift(2);E(M.slice(M.l,M.l+P),ce),M.l+=P}return ce}function w(M,Y,G){var re=Y&32768;return Y&=-32769,Y=(re?M:0)+(Y>=8192?Y-16384:Y),(re?"":"$")+(G?Qr(Y):xs(Y))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(M,Y){Ks(M,0);for(var G=[],re=0,ce="",P="",U="",le="";M.l<M.length;){var ne=M[M.l++];switch(ne){case 0:G.push(M.read_shift(8,"f"));break;case 1:P=w(Y[0].c,M.read_shift(2),!0),ce=w(Y[0].r,M.read_shift(2),!1),G.push(P+ce);break;case 2:{var ie=w(Y[0].c,M.read_shift(2),!0),H=w(Y[0].r,M.read_shift(2),!1);P=w(Y[0].c,M.read_shift(2),!0),ce=w(Y[0].r,M.read_shift(2),!1),G.push(ie+H+":"+P+ce)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(M.read_shift(2));break;case 6:{for(var K="";ne=M[M.l++];)K+=String.fromCharCode(ne);G.push('"'+K.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:le=G.pop(),U=G.pop(),G.push(["AND","OR"][ne-20]+"("+U+","+le+")");break;default:if(ne<32&&N[ne])le=G.pop(),U=G.pop(),G.push(U+N[ne]+le);else if(k[ne]){if(re=k[ne][1],re==69&&(re=M[M.l++]),re>G.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+G.join("|")+"|");return}var S=G.slice(-re);G.length-=re,G.push(k[ne][0]+"("+S.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}G.length==1?Y[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function C(M){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=M.read_shift(2),Y[3]=M[M.l++],Y[0].c=M[M.l++],Y}function L(M,Y){var G=C(M);return G[1].t="s",G[1].v=M.read_shift(Y-4,"cstr"),G}function O(M,Y,G,re){var ce=nt(6+re.length);ce.write_shift(2,M),ce.write_shift(1,G),ce.write_shift(1,Y),ce.write_shift(1,39);for(var P=0;P<re.length;++P){var U=re.charCodeAt(P);ce.write_shift(1,U>=128?95:U)}return ce.write_shift(1,0),ce}function B(M,Y){var G=C(M);G[1].v=M.read_shift(2);var re=G[1].v>>1;if(G[1].v&1)switch(re&7){case 0:re=(re>>3)*5e3;break;case 1:re=(re>>3)*500;break;case 2:re=(re>>3)/20;break;case 3:re=(re>>3)/200;break;case 4:re=(re>>3)/2e3;break;case 5:re=(re>>3)/2e4;break;case 6:re=(re>>3)/16;break;case 7:re=(re>>3)/64;break}return G[1].v=re,G}function F(M,Y){var G=C(M),re=M.read_shift(4),ce=M.read_shift(4),P=M.read_shift(2);if(P==65535)return re===0&&ce===3221225472?(G[1].t="e",G[1].v=15):re===0&&ce===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var U=P&32768;return P=(P&32767)-16446,G[1].v=(1-U*2)*(ce*Math.pow(2,P+32)+re*Math.pow(2,P)),G}function q(M,Y,G,re){var ce=nt(14);if(ce.write_shift(2,M),ce.write_shift(1,G),ce.write_shift(1,Y),re==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var P=0,U=0,le=0,ne=0;return re<0&&(P=1,re=-re),U=Math.log2(re)|0,re/=Math.pow(2,U-31),ne=re>>>0,(ne&2147483648)==0&&(re/=2,++U,ne=re>>>0),re-=ne,ne|=2147483648,ne>>>=0,re*=Math.pow(2,32),le=re>>>0,ce.write_shift(4,le),ce.write_shift(4,ne),U+=16383+(P?32768:0),ce.write_shift(2,U),ce}function fe(M,Y){var G=F(M);return M.l+=Y-14,G}function D(M,Y){var G=C(M),re=M.read_shift(4);return G[1].v=re>>6,G}function V(M,Y){var G=C(M),re=M.read_shift(8,"f");return G[1].v=re,G}function I(M,Y){var G=V(M);return M.l+=Y-10,G}function ae(M,Y){return M[M.l+Y-1]==0?M.read_shift(Y,"cstr"):""}function Q(M,Y){var G=M[M.l++];G>Y-1&&(G=Y-1);for(var re="";re.length<G;)re+=String.fromCharCode(M[M.l++]);return re}function te(M,Y,G){if(!(!G.qpro||Y<21)){var re=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var ce=M.read_shift(Y-21,"cstr");return[re,ce]}}function ve(M,Y){for(var G={},re=M.l+Y;M.l<re;){var ce=M.read_shift(2);if(ce==14e3){for(G[ce]=[0,""],G[ce][0]=M.read_shift(2);M[M.l];)G[ce][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return G}function ee(M,Y){var G=nt(5+M.length);G.write_shift(2,14e3),G.write_shift(2,Y);for(var re=0;re<M.length;++re){var ce=M.charCodeAt(re);G[G.l++]=ce>127?95:ce}return G[G.l++]=0,G}var Se={0:{n:"BOF",f:ks},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},J={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:fe},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ve},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:I},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:a,to_workbook:t}})();function IH(e){var t={},r=e.match(ca),s=0,a=!1;if(r)for(;s!=r.length;++s){var o=Kt(r[s]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;t.cp=Cv[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return t}var MH=(function(){var e=zd("t"),t=zd("rPr");function r(o){var l=o.match(e);if(!l)return{t:"s",v:""};var u={t:"s",v:xr(l[1])},d=o.match(t);return d&&(u.s=IH(d[1])),u}var s=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(s,"").split(a).map(r).filter(function(u){return u.v})}})(),BH=(function(){var t=/(\r\n|\n)/g;function r(a,o,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var d=a.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(o.push("<"+d+">"),l.push("</"+d+">")),l.push("</span>"),a}function s(a){var o=[[],a.v,[]];return a.v?(a.s&&r(a.s,o[0],o[2]),o[0].join("")+o[1].replace(t,"<br/>")+o[2].join("")):""}return function(o){return o.map(s).join("")}})(),PH=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,UH=/<(?:\w+:)?r>/,zH=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function eb(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=xr(Mr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=Mr(e),r&&(s.h=Uv(s.t))):e.match(UH)&&(s.r=Mr(e),s.t=xr(Mr((e.replace(zH,"").match(PH)||[]).join("").replace(ca,""))),r&&(s.h=BH(MH(s.r)))),s):{t:""}}var $H=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,qH=/<(?:\w+:)?(?:si|sstItem)>/g,HH=/<\/(?:\w+:)?(?:si|sstItem)>/;function WH(e,t){var r=[],s="";if(!e)return r;var a=e.match($H);if(a){s=a[2].replace(qH,"").split(HH);for(var o=0;o!=s.length;++o){var l=eb(s[o].trim(),t);l!=null&&(r[r.length]=l)}a=Kt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var GH=/^\s|\s$|[\t\n\r]/;function iT(e,t){if(!t.bookSST)return"";var r=[ys];r[r.length]=Nt("sst",null,{xmlns:Nl[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var a=e[s],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(GH)&&(o+=' xml:space="preserve"'),o+=">"+Cr(a.t)+"</t>"),o+="</si>",r[r.length]=o}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function VH(e){return[e.read_shift(4),e.read_shift(4)]}function KH(e,t){var r=[],s=!1;return Di(e,function(o,l,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(l.T,!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function XH(e,t){return t||(t=nt(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var YH=i$;function JH(e){var t=Ea();dt(t,159,XH(e));for(var r=0;r<e.length;++r)dt(t,19,YH(e[r]));return dt(t,160),t.end()}function oT(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function bi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function ZH(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=bi(e,4),t.U=bi(e,4),t.W=bi(e,4),t}function QH(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=o,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function eW(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(QH(e));return t}function tW(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function rW(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=bi(e,4),t.U=bi(e,4),t.W=bi(e,4),t}function sW(e){var t=rW(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function lT(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var a=!1;switch(s.AlgID){case 26126:case 26127:case 26128:a=s.Flags==36;break;case 26625:a=s.Flags==4;break;case 0:a=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function cT(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function aW(e){var t=bi(e);switch(t.Minor){case 2:return[t.Minor,nW(e)];case 3:return[t.Minor,iW()];case 4:return[t.Minor,oW(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function nW(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=lT(e,r),a=cT(e,e.length-e.l);return{t:"Std",h:s,v:a}}function iW(){throw new Error("File is password-protected: ECMA-376 Extensible")}function oW(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(ca,function(o){var l=Kt(o);switch(Hn(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){s[u]=l[u]});break;case"<dataIntegrity":s.encryptedHmacKey=l.encryptedHmacKey,s.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(l);break;default:throw l[0]}}),s}function lW(e,t){var r={},s=r.EncryptionVersionInfo=bi(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=lT(e,a),t-=a,r.EncryptionVerifier=cT(e,t),r}function cW(e){var t={},r=t.EncryptionVersionInfo=bi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function tb(e){var t=0,r,s=oT(e),a=s.length+1,o,l,u,d,h;for(r=mo(a),r[0]=s.length,o=1;o!=a;++o)r[o]=s[o-1];for(o=a-1;o>=0;--o)l=r[o],u=(t&16384)===0?0:1,d=t<<1&32767,h=u|d,t=h^l;return t^52811}var uT=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(l){return(l/2|l*128)&255},a=function(l,u){return s(l^u)},o=function(l){for(var u=t[l.length-1],d=104,h=l.length-1;h>=0;--h)for(var m=l[h],x=0;x!=7;++x)m&64&&(u^=r[d]),m*=2,--d;return u};return function(l){for(var u=oT(l),d=o(u),h=u.length,m=mo(16),x=0;x!=16;++x)m[x]=0;var y,v,b;for((h&1)===1&&(y=d>>8,m[h]=a(e[0],y),--h,y=d&255,v=u[u.length-1],m[h]=a(v,y));h>0;)--h,y=d>>8,m[h]=a(u[h],y),--h,y=d&255,m[h]=a(u[h],y);for(h=15,b=15-u.length;b>0;)y=d>>8,m[h]=a(e[b],y),--h,--b,y=d&255,m[h]=a(u[h],y),--h,--b;return m}})(),uW=function(e,t,r,s,a){a||(a=t),s||(s=uT(e));var o,l;for(o=0;o!=t.length;++o)l=t[o],l^=s[r],l=(l>>5|l<<3)&255,a[o]=l,++r;return[a,r,s]},dW=function(e){var t=0,r=uT(e);return function(s){var a=uW("",s,t,r);return t=a[1],a[0]}};function fW(e,t,r,s){var a={key:ks(e),verificationBytes:ks(e)};return r.password&&(a.verifier=tb(r.password)),s.valid=a.verificationBytes===a.verifier,s.valid&&(s.insitu=dW(r.password)),a}function hW(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=cW(e):s.Data=lW(e,t),s}function mW(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?hW(e,t-2,s):fW(e,r.biff>=8?t:t-2,r,s),s}var dT=(function(){function e(a,o){switch(o.type){case"base64":return t(qa(a),o);case"binary":return t(a,o);case"buffer":return t(ar&&Buffer.isBuffer(a)?a.toString("binary"):bo(a),o);case"array":return t(fl(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){var l=o||{},u=l.dense?[]:{},d=a.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(m,x){Array.isArray(u)&&(u[x]=[]);for(var y=/\\\w+\b/g,v=0,b,g=-1;b=y.exec(m);){switch(b[0]){case"\\cell":var _=m.slice(v,y.lastIndex-b[0].length);if(_[0]==" "&&(_=_.slice(1)),++g,_.length){var w={v:_,t:"s"};Array.isArray(u)?u[x][g]=w:u[Gt({r:x,c:g})]=w}break}v=y.lastIndex}g>h.e.c&&(h.e.c=g)}),u["!ref"]=Zt(h),u}function r(a,o){return wo(e(a,o),o)}function s(a){for(var o=["{\\rtf1\\ansi"],l=gr(a["!ref"]),u,d=Array.isArray(a),h=l.s.r;h<=l.e.r;++h){o.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)o.push("\\cellx"+(m+1));for(o.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var x=Gt({r:h,c:m});u=d?(a[h]||[])[m]:a[x],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(Si(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}})();function pW(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Wd(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function xW(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,a=Math.max(t,r,s),o=Math.min(t,r,s),l=a-o;if(l===0)return[0,0,t];var u=0,d=0,h=a+o;switch(d=l/(h>1?2-h:h),a){case t:u=((r-s)/l+6)%6;break;case r:u=(s-t)/l+2;break;case s:u=(t-r)/l+4;break}return[u/6,d,h/2]}function gW(e){var t=e[0],r=e[1],s=e[2],a=r*2*(s<.5?s:1-s),o=s-a/2,l=[o,o,o],u=6*t,d;if(r!==0)switch(u|0){case 0:case 6:d=a*u,l[0]+=a,l[1]+=d;break;case 1:d=a*(2-u),l[0]+=d,l[1]+=a;break;case 2:d=a*(u-2),l[1]+=a,l[2]+=d;break;case 3:d=a*(4-u),l[1]+=d,l[2]+=a;break;case 4:d=a*(u-4),l[2]+=a,l[0]+=d;break;case 5:d=a*(6-u),l[2]+=d,l[0]+=a;break}for(var h=0;h!=3;++h)l[h]=Math.round(l[h]*255);return l}function G0(e,t){if(t===0)return e;var r=xW(pW(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Wd(gW(r))}var fT=6,yW=15,vW=1,sa=fT;function Gd(e){return Math.floor((e+Math.round(128/sa)/256)*sa)}function Vd(e){return Math.floor((e-5)/sa*100+.5)/100}function V0(e){return Math.round((e*sa+5)/sa*256)/256}function ty(e){return V0(Vd(Gd(e)))}function rb(e){var t=Math.abs(e-ty(e)),r=sa;if(t>.005)for(sa=vW;sa<yW;++sa)Math.abs(e-ty(e))<=t&&(t=Math.abs(e-ty(e)),r=sa);sa=r}function po(e){e.width?(e.wpx=Gd(e.width),e.wch=Vd(e.wpx),e.MDW=sa):e.wpx?(e.wch=Vd(e.wpx),e.width=V0(e.wch),e.MDW=sa):typeof e.wch=="number"&&(e.width=V0(e.wch),e.wpx=Gd(e.width),e.MDW=sa),e.customWidth&&delete e.customWidth}var bW=96,hT=bW;function Kd(e){return e*96/hT}function Jc(e){return e*hT/96}var wW={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _W(e,t,r,s){t.Borders=[];var a={},o=!1;(e[0].match(ca)||[]).forEach(function(l){var u=Kt(l);switch(Hn(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=Hr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=Hr(u.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function NW(e,t,r,s){t.Fills=[];var a={},o=!1;(e[0].match(ca)||[]).forEach(function(l){var u=Kt(l);switch(Hn(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function SW(e,t,r,s){t.Fonts=[];var a={},o=!1;(e[0].match(ca)||[]).forEach(function(l){var u=Kt(l);switch(Hn(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=Mr(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?Hr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?Hr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?Hr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?Hr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?Hr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?Hr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?Hr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Cv[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=Hr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var d=sl[a.color.index];a.color.index==81&&(d=sl[1]),d||(d=sl[1]),a.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=G0(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function kW(e,t,r){t.NumberFmt=[];for(var s=ls(Wt),a=0;a<s.length;++a)t.NumberFmt[s[a]]=Wt[s[a]];var o=e[0].match(ca);if(o)for(a=0;a<o.length;++a){var l=Kt(o[a]);switch(Hn(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=xr(Mr(l.formatCode)),d=parseInt(l.numFmtId,10);if(t.NumberFmt[d]=u,d>0){if(d>392){for(d=392;d>60&&t.NumberFmt[d]!=null;--d);t.NumberFmt[d]=u}vi(u,d)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function EW(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=Nt("numFmt",null,{numFmtId:s,formatCode:Cr(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Nt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var s0=["numFmtId","fillId","fontId","borderId","xfId"],a0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function jW(e,t,r){t.CellXf=[];var s,a=!1;(e[0].match(ca)||[]).forEach(function(o){var l=Kt(o),u=0;switch(Hn(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=l,delete s[0],u=0;u<s0.length;++u)s[s0[u]]&&(s[s0[u]]=parseInt(s[s0[u]],10));for(u=0;u<a0.length;++u)s[a0[u]]&&(s[a0[u]]=Hr(s[a0[u]]));if(t.NumberFmt&&s.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[u]){s.numFmtId=u;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};l.vertical&&(d.vertical=l.vertical),l.horizontal&&(d.horizontal=l.horizontal),l.textRotation!=null&&(d.textRotation=l.textRotation),l.indent&&(d.indent=l.indent),l.wrapText&&(d.wrapText=Hr(l.wrapText)),s.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function TW(e){var t=[];return t[t.length]=Nt("cellXfs",null),e.forEach(function(r){t[t.length]=Nt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Nt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var AW=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,d,h){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(t))&&kW(x,m,h),(x=u.match(a))&&SW(x,m,d,h),(x=u.match(s))&&NW(x,m,d,h),(x=u.match(o))&&_W(x,m,d,h),(x=u.match(r))&&jW(x,m,h),m}})();function mT(e,t){var r=[ys,Nt("styleSheet",null,{xmlns:Nl[0],"xmlns:vt":Cs.vt})],s;return e.SSF&&(s=EW(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=TW(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function CW(e,t){var r=e.read_shift(2),s=ia(e);return[r,s]}function RW(e,t,r){r||(r=nt(6+4*t.length)),r.write_shift(2,e),Ms(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function DW(e,t,r){var s={};s.sz=e.read_shift(2)/20;var a=h$(e);a.fItalic&&(s.italic=1),a.fCondense&&(s.condense=1),a.fExtend&&(s.extend=1),a.fShadow&&(s.shadow=1),a.fOutline&&(s.outline=1),a.fStrikeout&&(s.strike=1);var o=e.read_shift(2);switch(o===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(s.underline=l);var u=e.read_shift(1);u>0&&(s.family=u);var d=e.read_shift(1);switch(d>0&&(s.charset=d),e.l++,s.color=f$(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=ia(e),s}function OW(e,t){t||(t=nt(153)),t.write_shift(2,e.sz*20),m$(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),q0(e.color,t);var s=0;return s=2,t.write_shift(1,s),Ms(e.name,t),t.length>t.l?t.slice(0,t.l):t}var FW=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ry,LW=la;function vE(e,t){t||(t=nt(84)),ry||(ry=gm(FW));var r=ry[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(q0({auto:1},t),q0({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function IW(e,t){var r=e.l+t,s=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:a}}function pT(e,t,r){r||(r=nt(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function sd(e,t){return t||(t=nt(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var MW=la;function BW(e,t){return t||(t=nt(51)),t.write_shift(1,0),sd(null,t),sd(null,t),sd(null,t),sd(null,t),sd(null,t),t.length>t.l?t.slice(0,t.l):t}function PW(e,t){return t||(t=nt(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),$0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function UW(e,t,r){var s=nt(2052);return s.write_shift(4,e),$0(t,s),$0(r,s),s.length>s.l?s.slice(0,s.l):s}function zW(e,t,r){var s={};s.NumberFmt=[];for(var a in Wt)s.NumberFmt[a]=Wt[a];s.CellXf=[],s.Fonts=[];var o=[],l=!1;return Di(e,function(d,h,m){switch(m){case 44:s.NumberFmt[d[0]]=d[1],vi(d[1],d[0]);break;case 43:s.Fonts.push(d),d.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(d.color.rgb=G0(t.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&s.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(m),l=!0;break;case 38:o.pop(),l=!1;break;default:if(h.T>0)o.push(m);else if(h.T<0)o.pop();else if(!l||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),s}function $W(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)t[a]!=null&&++r}),r!=0&&(dt(e,615,Tn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)t[a]!=null&&dt(e,44,RW(a,t[a]))}),dt(e,616))}}function qW(e){var t=1;dt(e,611,Tn(t)),dt(e,43,OW({sz:12,color:{theme:1},name:"Calibri",family:2})),dt(e,612)}function HW(e){var t=2;dt(e,603,Tn(t)),dt(e,45,vE({patternType:"none"})),dt(e,45,vE({patternType:"gray125"})),dt(e,604)}function WW(e){var t=1;dt(e,613,Tn(t)),dt(e,46,BW()),dt(e,614)}function GW(e){var t=1;dt(e,626,Tn(t)),dt(e,47,pT({numFmtId:0},65535)),dt(e,627)}function VW(e,t){dt(e,617,Tn(t.length)),t.forEach(function(r){dt(e,47,pT(r,0))}),dt(e,618)}function KW(e){var t=1;dt(e,619,Tn(t)),dt(e,48,PW({xfId:0,name:"Normal"})),dt(e,620)}function XW(e){var t=0;dt(e,505,Tn(t)),dt(e,506)}function YW(e){var t=0;dt(e,508,UW(t,"TableStyleMedium9","PivotStyleMedium4")),dt(e,509)}function JW(e,t){var r=Ea();return dt(r,278),$W(r,e.SSF),qW(r),HW(r),WW(r),GW(r),VW(r,t.cellXfs),KW(r),XW(r),YW(r),dt(r,279),r.end()}var ZW=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function QW(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(ca)||[]).forEach(function(a){var o=Kt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=o.val;break;case"<a:sysClr":s.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(t.themeElements.clrScheme[ZW.indexOf(o[0])]=s,s={}):s.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function eG(){}function tG(){}var rG=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,sG=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,aG=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function nG(e,t,r){t.themeElements={};var s;[["clrScheme",rG,QW],["fontScheme",sG,eG],["fmtScheme",aG,tG]].forEach(function(a){if(!(s=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](s,t,r)})}var iG=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function xT(e,t){(!e||e.length===0)&&(e=sb());var r,s={};if(!(r=e.match(iG)))throw new Error("themeElements not found in theme");return nG(r[0],s,t),s.raw=e,s}function sb(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ys];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function oG(e,t,r){var s=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=s;return}var o=e.slice(e.l);e.l=s;var l;try{l=l5(o,{type:"array"})}catch{return}var u=za(l,"theme/theme/theme1.xml",!0);if(u)return xT(u,r)}}function lG(e){return e.read_shift(4)}function cG(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=uG(e,4);break;case 2:t.xclrValue=X5(e);break;case 3:t.xclrValue=lG(e);break;case 4:e.l+=4;break}return e.l+=8,t}function uG(e,t){return la(e,t)}function dG(e,t){return la(e,t)}function fG(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=cG(e);break;case 6:s[1]=dG(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function hG(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(fG(e,r-e.l));return{ixfe:s,ext:o}}function mG(e,t){t.forEach(function(r){r[0]})}function pG(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ia(e)}}function xG(e){var t=nt(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ms(e.name,t),t.slice(0,t.l)}function gG(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function yG(e){var t=nt(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function vG(e,t){var r=nt(8+2*t.length);return r.write_shift(4,e),Ms(t,r),r.slice(0,r.l)}function bG(e){return e.l+=4,e.read_shift(4)!=0}function wG(e,t){var r=nt(8);return r.write_shift(4,e),r.write_shift(4,1),r}function _G(e,t,r){var s={Types:[],Cell:[],Value:[]},a=r||{},o=[],l=!1,u=2;return Di(e,function(d,h,m){switch(m){case 335:s.Types.push({name:d.name});break;case 51:d.forEach(function(x){u==1?s.Cell.push({type:s.Types[x[0]-1].name,index:x[1]}):u==0&&s.Value.push({type:s.Types[x[0]-1].name,index:x[1]})});break;case 337:u=d?1:0;break;case 338:u=2;break;case 35:o.push(m),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!h.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),s}function NG(){var e=Ea();return dt(e,332),dt(e,334,Tn(1)),dt(e,335,xG({name:"XLDAPR",version:12e4,flags:3496657072})),dt(e,336),dt(e,339,vG(1,"XLDAPR")),dt(e,52),dt(e,35,Tn(514)),dt(e,4096,Tn(0)),dt(e,4097,un(1)),dt(e,36),dt(e,53),dt(e,340),dt(e,337,wG(1)),dt(e,51,yG([[1,0]])),dt(e,338),dt(e,333),e.end()}function SG(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var a=!1,o=2,l;return e.replace(ca,function(u){var d=Kt(u);switch(Hn(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<s.Types.length;++h)s.Types[h].name==d.name&&(l=s.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?s.Cell.push({type:s.Types[d.t-1].name,index:+d.v}):o==0&&s.Value.push({type:s.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+d.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return u}),s}function gT(){var e=[ys];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function kG(e){var t=[];if(!e)return t;var r=1;return(e.match(ca)||[]).forEach(function(s){var a=Kt(s);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function EG(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Gt(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function jG(e,t,r){var s=[];return Di(e,function(o,l,u){switch(u){case 63:s.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),s}function TG(e,t,r,s){if(!e)return e;var a=s||{},o=!1;Di(e,function(u,d,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!d.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},a)}function AG(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Ac=1024;function yT(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Nt("xml",null,{"xmlns:v":Ia.v,"xmlns:o":Ia.o,"xmlns:x":Ia.x,"xmlns:mv":Ia.mv}).replace(/\/>/,">"),Nt("o:shapelayout",Nt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Nt("v:shapetype",[Nt("v:stroke",null,{joinstyle:"miter"}),Nt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];Ac<e*1e3;)Ac+=1e3;return t.forEach(function(o){var l=es(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var d=u.type=="gradient"?Nt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Nt("v:fill",d,u),m={on:"t",obscured:"t"};++Ac,a=a.concat(["<v:shape"+$d({id:"_x0000_s"+Ac,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Nt("v:shadow",null,m),Nt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ys("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Ys("x:AutoFill","False"),Ys("x:Row",String(l.r)),Ys("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function bE(e,t,r,s){var a=Array.isArray(e),o;t.forEach(function(l){var u=es(l.ref);if(a?(e[u.r]||(e[u.r]=[]),o=e[u.r][u.c]):o=e[l.ref],!o){o={t:"z"},a?e[u.r][u.c]=o:e[l.ref]=o;var d=gr(e["!ref"]||"BDWGO1000001:A1");d.s.r>u.r&&(d.s.r=u.r),d.e.r<u.r&&(d.e.r=u.r),d.s.c>u.c&&(d.s.c=u.c),d.e.c<u.c&&(d.e.c=u.c);var h=Zt(d);h!==e["!ref"]&&(e["!ref"]=h)}o.c||(o.c=[]);var m={a:l.author,t:l.t,r:l.r,T:r};l.h&&(m.h=l.h);for(var x=o.c.length-1;x>=0;--x){if(!r&&o.c[x].T)return;r&&!o.c[x].T&&o.c.splice(x,1)}if(r&&s){for(x=0;x<s.length;++x)if(m.a==s[x].id){m.a=s[x].name||m.a;break}}o.c.push(m)})}function CG(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var d=Kt(u[0]),h={author:d.authorId&&r[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},m=es(d.ref);if(!(t.sheetRows&&t.sheetRows<=m.r)){var x=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!x&&!!x[1]&&eb(x[1])||{r:"",t:"",h:""};h.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),h.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(h.h=y.h),s.push(h)}}}}),s}function vT(e){var t=[ys,Nt("comments",null,{xmlns:Nl[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(a){var o=Cr(a.a);r.indexOf(o)==-1&&(r.push(o),t.push("<author>"+o+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var a=0,o=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?a=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(d){d.a&&(a=r.indexOf(Cr(d.a))),o.push(d.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+a+'"><text>'),o.length<=1)t.push(Ys("t",Cr(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)l+=`Reply:
    `+o[u]+`
`;t.push(Ys("t",Cr(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function RG(e,t){var r=[],s=!1,a={},o=0;return e.replace(ca,function(u,d){var h=Kt(u);switch(Hn(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":o=d+u.length;break;case"</text>":a.t=e.slice(o,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return u}),r}function DG(e,t,r){var s=[ys,Nt("ThreadedComments",null,{xmlns:Cs.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var o="";(a[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var d={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?o=d.id:d.parentId=o,l.ID=d.id,l.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),s.push(Nt("threadedComment",Ys("text",l.t||""),d))})}),s.push("</ThreadedComments>"),s.join("")}function OG(e,t){var r=[],s=!1;return e.replace(ca,function(o){var l=Kt(o);switch(Hn(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function FG(e){var t=[ys,Nt("personList",null,{xmlns:Cs.TCMNT,"xmlns:x":Nl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(Nt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function LG(e){var t={};t.iauthor=e.read_shift(4);var r=jl(e);return t.rfx=r.s,t.ref=Gt(r.s),e.l+=16,t}function IG(e,t){return t==null&&(t=nt(36)),t.write_shift(4,e[1].iauthor),ou(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var MG=ia;function BG(e){return Ms(e.slice(0,54))}function PG(e,t){var r=[],s=[],a={},o=!1;return Di(e,function(u,d,h){switch(h){case 632:s.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=s[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function UG(e){var t=Ea(),r=[];return dt(t,628),dt(t,630),e.forEach(function(s){s[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),dt(t,632,BG(a.a)))})}),dt(t,631),dt(t,633),e.forEach(function(s){s[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var o={s:es(s[0]),e:es(s[0])};dt(t,635,IG([o,a])),a.t&&a.t.length>0&&dt(t,637,l$(a)),dt(t,636),delete a.iauthor})}),dt(t,634),dt(t,629),t.end()}var zG="application/vnd.ms-office.vbaProject";function $G(e){var t=Pt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Pt.utils.cfb_add(t,a,e.FileIndex[s].content)}}),Pt.write(t)}function qG(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Pt.utils.cfb_add(e,a,t.FileIndex[s].content)}})}var bT=["xlsb","xlsm","xlam","biff8","xla"];function HG(){return{"!type":"dialog"}}function WG(){return{"!type":"dialog"}}function GG(){return{"!type":"macro"}}function VG(){return{"!type":"macro"}}var Pc=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,a,o,l){var u=!1,d=!1;o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return u?m+=t.c:--m,d?h+=t.r:--h,a+(u?"":"$")+Qr(m)+(d?"":"$")+xs(h)}return function(a,o){return t=o,a.replace(e,r)}})(),ab=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,nb=(function(){return function(t,r){return t.replace(ab,function(s,a,o,l,u,d){var h=Wv(l)-(o?0:r.c),m=Hv(d)-(u?0:r.r),x=m==0?"":u?m+1:"["+m+"]",y=h==0?"":o?h+1:"["+h+"]";return a+"R"+x+"C"+y})}})();function wT(e,t){return e.replace(ab,function(r,s,a,o,l,u){return s+(a=="$"?a+o:Qr(Wv(o)+t.c))+(l=="$"?l+u:xs(Hv(u)+t.r))})}function KG(e,t,r){var s=ja(t),a=s.s,o=es(r),l={r:o.r-a.r,c:o.c-a.c};return wT(e,l)}function XG(e){return e.length!=1}function wE(e){return e.replace(/_xlfn\./g,"")}function Ns(e){e.l+=1}function xo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function _T(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return NT(e);r.biff==12&&(s=4)}var a=e.read_shift(s),o=e.read_shift(s),l=xo(e),u=xo(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function NT(e){var t=xo(e),r=xo(e),s=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function YG(e,t,r){if(r.biff<8)return NT(e);var s=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),o=xo(e),l=xo(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function ST(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return JG(e);var s=e.read_shift(r&&r.biff==12?4:2),a=xo(e);return{r:s,c:a[0],cRel:a[1],rRel:a[2]}}function JG(e){var t=xo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function ZG(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function QG(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return eV(e);var a=e.read_shift(s>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:u}}function eV(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:s}}function tV(e,t,r){var s=(e[e.l++]&96)>>5,a=_T(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,a]}function rV(e,t,r){var s=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=_T(e,o,r);return[s,a,l]}function sV(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function aV(e,t,r){var s=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[s,a]}function nV(e,t,r){var s=(e[e.l++]&96)>>5,a=YG(e,t-1,r);return[s,a]}function iV(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function _E(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function oV(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),a=[],o=0;o<=s;++o)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function lV(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function cV(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function uV(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function dV(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function kT(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function fV(e){return e.read_shift(2),kT(e)}function hV(e){return e.read_shift(2),kT(e)}function mV(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var a=ST(e,0,r);return[s,a]}function pV(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var a=QG(e,0,r);return[s,a]}function xV(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var o=ST(e,0,r);return[s,a,o]}function gV(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[bK[a],TT[a],s]}function yV(e,t,r){var s=e[e.l++],a=e.read_shift(1),o=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:vV(e);return[a,(o[0]===0?TT:vK)[o[1]]]}function vV(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function bV(e,t,r){e.l+=r&&r.biff==2?3:4}function wV(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[s,a]}function _V(e){return e.l++,Oi[e.read_shift(1)]}function NV(e){return e.l++,e.read_shift(2)}function SV(e){return e.l++,e.read_shift(1)!==0}function kV(e){return e.l++,aa(e)}function EV(e,t,r){return e.l++,ff(e,t-1,r)}function jV(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=ms(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Oi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=aa(e);break;case 2:r[1]=Tl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function TV(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),a=[],o=0;o!=s;++o)a.push((r.biff==12?jl:bm)(e));return a}function AV(e,t,r){var s=0,a=0;r.biff==12?(s=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--a==0&&(a=256));for(var o=0,l=[];o!=s&&(l[o]=[]);++o)for(var u=0;u!=a;++u)l[o][u]=jV(e,r.biff);return l}function CV(e,t,r){var s=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,o=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,o]}function RV(e,t,r){if(r.biff==5)return DV(e);var s=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[s,a,o]}function DV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function OV(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[s,a]}function FV(e,t,r){var s=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[s,a]}function LV(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function IV(e,t,r){var s=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[s,a]}var MV=la,BV=la,PV=la;function mf(e,t,r){return e.l+=2,[ZG(e)]}function ib(e){return e.l+=6,[]}var UV=mf,zV=ib,$V=ib,qV=mf;function ET(e){return e.l+=2,[ks(e),e.read_shift(2)&1]}var HV=mf,WV=ET,GV=ib,VV=mf,KV=mf,XV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function YV(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),l=XV[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:s,c:a,C:o}}function JV(e){return e.l+=2,[e.read_shift(4)]}function ZV(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function QV(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function eK(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function tK(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function rK(e){return e.l+=4,[0,0]}var NE={1:{n:"PtgExp",f:wV},2:{n:"PtgTbl",f:PV},3:{n:"PtgAdd",f:Ns},4:{n:"PtgSub",f:Ns},5:{n:"PtgMul",f:Ns},6:{n:"PtgDiv",f:Ns},7:{n:"PtgPower",f:Ns},8:{n:"PtgConcat",f:Ns},9:{n:"PtgLt",f:Ns},10:{n:"PtgLe",f:Ns},11:{n:"PtgEq",f:Ns},12:{n:"PtgGe",f:Ns},13:{n:"PtgGt",f:Ns},14:{n:"PtgNe",f:Ns},15:{n:"PtgIsect",f:Ns},16:{n:"PtgUnion",f:Ns},17:{n:"PtgRange",f:Ns},18:{n:"PtgUplus",f:Ns},19:{n:"PtgUminus",f:Ns},20:{n:"PtgPercent",f:Ns},21:{n:"PtgParen",f:Ns},22:{n:"PtgMissArg",f:Ns},23:{n:"PtgStr",f:EV},26:{n:"PtgSheet",f:ZV},27:{n:"PtgEndSheet",f:QV},28:{n:"PtgErr",f:_V},29:{n:"PtgBool",f:SV},30:{n:"PtgInt",f:NV},31:{n:"PtgNum",f:kV},32:{n:"PtgArray",f:iV},33:{n:"PtgFunc",f:gV},34:{n:"PtgFuncVar",f:yV},35:{n:"PtgName",f:CV},36:{n:"PtgRef",f:mV},37:{n:"PtgArea",f:tV},38:{n:"PtgMemArea",f:OV},39:{n:"PtgMemErr",f:MV},40:{n:"PtgMemNoMem",f:BV},41:{n:"PtgMemFunc",f:FV},42:{n:"PtgRefErr",f:LV},43:{n:"PtgAreaErr",f:sV},44:{n:"PtgRefN",f:pV},45:{n:"PtgAreaN",f:nV},46:{n:"PtgMemAreaN",f:eK},47:{n:"PtgMemNoMemN",f:tK},57:{n:"PtgNameX",f:RV},58:{n:"PtgRef3d",f:xV},59:{n:"PtgArea3d",f:rV},60:{n:"PtgRefErr3d",f:IV},61:{n:"PtgAreaErr3d",f:aV},255:{}},sK={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},aK={1:{n:"PtgElfLel",f:ET},2:{n:"PtgElfRw",f:VV},3:{n:"PtgElfCol",f:UV},6:{n:"PtgElfRwV",f:KV},7:{n:"PtgElfColV",f:qV},10:{n:"PtgElfRadical",f:HV},11:{n:"PtgElfRadicalS",f:GV},13:{n:"PtgElfColS",f:zV},15:{n:"PtgElfColSV",f:$V},16:{n:"PtgElfRadicalLel",f:WV},25:{n:"PtgList",f:YV},29:{n:"PtgSxName",f:JV},255:{}},nK={0:{n:"PtgAttrNoop",f:rK},1:{n:"PtgAttrSemi",f:dV},2:{n:"PtgAttrIf",f:cV},4:{n:"PtgAttrChoose",f:oV},8:{n:"PtgAttrGoto",f:lV},16:{n:"PtgAttrSum",f:bV},32:{n:"PtgAttrBaxcel",f:_E},33:{n:"PtgAttrBaxcel",f:_E},64:{n:"PtgAttrSpace",f:fV},65:{n:"PtgAttrSpaceSemi",f:hV},128:{n:"PtgAttrIfError",f:uV},255:{}};function pf(e,t,r,s){if(s.biff<8)return la(e,t);for(var a=e.l+t,o=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=AV(e,0,s),o.push(r[l][1]);break;case"PtgMemArea":r[l][2]=TV(e,r[l][1],s),o.push(r[l][2]);break;case"PtgExp":s&&s.biff==12&&(r[l][1][1]=e.read_shift(4),o.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=a-e.l,t!==0&&o.push(la(e,t)),o}function xf(e,t,r){for(var s=e.l+t,a,o,l=[];s!=e.l;)t=s-e.l,o=e[e.l],a=NE[o]||NE[sK[o]],(o===24||o===25)&&(a=(o===24?aK:nK)[e[e.l+1]]),!a||!a.f?la(e,t):l.push([a.n,a.f(e,t,r)]);return l}function iK(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],a=[],o=0;o<s.length;++o){var l=s[o];l?l[0]===2?a.push('"'+l[1].replace(/"/g,'""')+'"'):a.push(l[1]):a.push("")}t.push(a.join(","))}return t.join(";")}var oK={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function lK(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function jT(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[s[0]][0]){case 357:return a=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?a:a+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return a=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?a:a+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[s[0]][0][3]?(a=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?a:a+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function SE(e,t,r){var s=jT(e,t,r);return s=="#REF"?s:lK(s,r)}function ra(e,t,r,s,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},u=[],d,h,m,x=0,y=0,v,b="";if(!e[0]||!e[0][0])return"";for(var g=-1,_="",w=0,k=e[0].length;w<k;++w){var N=e[0][w];switch(N[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=u.pop(),h=u.pop(),g>=0){switch(e[0][g][1][0]){case 0:_=is(" ",e[0][g][1][1]);break;case 1:_=is("\r",e[0][g][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}h=h+_,g=-1}u.push(h+oK[N[0]]+d);break;case"PtgIsect":d=u.pop(),h=u.pop(),u.push(h+" "+d);break;case"PtgUnion":d=u.pop(),h=u.pop(),u.push(h+","+d);break;case"PtgRange":d=u.pop(),h=u.pop(),u.push(h+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=yd(N[1][1],l,a),u.push(vd(m,o));break;case"PtgRefN":m=r?yd(N[1][1],r,a):N[1][1],u.push(vd(m,o));break;case"PtgRef3d":x=N[1][1],m=yd(N[1][2],l,a),b=SE(s,x,a),u.push(b+"!"+vd(m,o));break;case"PtgFunc":case"PtgFuncVar":var E=N[1][0],C=N[1][1];E||(E=0),E&=127;var L=E==0?[]:u.slice(-E);u.length-=E,C==="User"&&(C=L.shift()),u.push(C+"("+L.join(",")+")");break;case"PtgBool":u.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(N[1]);break;case"PtgNum":u.push(String(N[1]));break;case"PtgStr":u.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(N[1]);break;case"PtgAreaN":v=Qk(N[1][1],r?{s:r}:l,a),u.push(Z1(v,a));break;case"PtgArea":v=Qk(N[1][1],l,a),u.push(Z1(v,a));break;case"PtgArea3d":x=N[1][1],v=N[1][2],b=SE(s,x,a),u.push(b+"!"+Z1(v,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=N[1][2];var O=(s.names||[])[y-1]||(s[0]||[])[y],B=O?O.Name:"SH33TJSNAME"+String(y);B&&B.slice(0,6)=="_xlfn."&&!a.xlfn&&(B=B.slice(6)),u.push(B);break;case"PtgNameX":var F=N[1][1];y=N[1][2];var q;if(a.biff<=5)F<0&&(F=-F),s[F]&&(q=s[F][y]);else{var fe="";if(((s[F]||[])[0]||[])[0]==14849||(((s[F]||[])[0]||[])[0]==1025?s[F][y]&&s[F][y].itab>0&&(fe=s.SheetNames[s[F][y].itab-1]+"!"):fe=s.SheetNames[y-1]+"!"),s[F]&&s[F][y])fe+=s[F][y].Name;else if(s[0]&&s[0][y])fe+=s[0][y].Name;else{var D=(jT(s,F,a)||"").split(";;");D[y-1]?fe=D[y-1]:fe+="SH33TJSERRX"}u.push(fe);break}q||(q={Name:"SH33TJSERRY"}),u.push(q.Name);break;case"PtgParen":var V="(",I=")";if(g>=0){switch(_="",e[0][g][1][0]){case 2:V=is(" ",e[0][g][1][1])+V;break;case 3:V=is("\r",e[0][g][1][1])+V;break;case 4:I=is(" ",e[0][g][1][1])+I;break;case 5:I=is("\r",e[0][g][1][1])+I;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}u.push(V+u.pop()+I);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:N[1][1],r:N[1][0]};var ae={c:r.c,r:r.r};if(s.sharedf[Gt(m)]){var Q=s.sharedf[Gt(m)];u.push(ra(Q,l,ae,s,a))}else{var te=!1;for(d=0;d!=s.arrayf.length;++d)if(h=s.arrayf[d],!(m.c<h[0].s.c||m.c>h[0].e.c)&&!(m.r<h[0].s.r||m.r>h[0].e.r)){u.push(ra(h[1],l,ae,s,a)),te=!0;break}te||u.push(N[1])}break;case"PtgArray":u.push("{"+iK(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var ve=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&ve.indexOf(e[0][w][0])==-1){N=e[0][g];var ee=!0;switch(N[1][0]){case 4:ee=!1;case 0:_=is(" ",N[1][1]);break;case 5:ee=!1;case 1:_=is("\r",N[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}u.push((ee?_:"")+u.pop()+(ee?"":_)),g=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function cK(e,t,r){var s=e.l+t,a=r.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],la(e,t-2)];var u=xf(e,l,r);return t!==l+a&&(o=pf(e,t-l-a,u,r)),e.l=s,[u,o]}function uK(e,t,r){var s=e.l+t,a=r.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],la(e,t-2)];var u=xf(e,l,r);return t!==l+a&&(o=pf(e,t-l-a,u,r)),e.l=s,[u,o]}function dK(e,t,r,s){var a=e.l+t,o=xf(e,s,r),l;return a!==e.l&&(l=pf(e,a-e.l,o,r)),[o,l]}function fK(e,t,r){var s=e.l+t,a,o=e.read_shift(2),l=xf(e,o,r);return o==65535?[[],la(e,t-2)]:(t!==o+2&&(a=pf(e,s-o-2,l,r)),[l,a])}function hK(e){var t;if(xi(e,e.l+6)!==65535)return[aa(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function mK(e){if(e==null){var t=nt(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return hl(e);return hl(0)}function sy(e,t,r){var s=e.l+t,a=Wn(e);r.biff==2&&++e.l;var o=hK(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=uK(e,s-e.l,r);return{cell:a,val:o[0],formula:u,shared:l>>3&1,tt:o[1]}}function pK(e,t,r,s,a){var o=pl(t,r,a),l=mK(e.v),u=nt(6),d=33;u.write_shift(2,d),u.write_shift(4,0);for(var h=nt(e.bf.length),m=0;m<e.bf.length;++m)h[m]=e.bf[m];var x=Is([o,l,u,h]);return x}function wm(e,t,r){var s=e.read_shift(4),a=xf(e,s,r),o=e.read_shift(4),l=o>0?pf(e,o,a,r):null;return[a,l]}var xK=wm,_m=wm,gK=wm,yK=wm,vK={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},TT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},bK={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function kE(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function wK(e){var t="of:="+e.replace(ab,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function ay(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function _K(e){return e.replace(/\./,"!")}var wd={},Uc={},_d=typeof Map<"u";function ob(e,t,r){var s=0,a=e.length;if(r){if(_d?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var o=_d?r.get(t):r[t];s<o.length;++s)if(e[o[s]].t===t)return e.Count++,o[s]}}else for(;s<a;++s)if(e[s].t===t)return e.Count++,s;return e[a]={t},e.Count++,e.Unique++,r&&(_d?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Nm(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(sa=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=Vd(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=V0(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function il(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function _o(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],a=60,o=e.length;if(s==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){vi(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=s=a;break}}for(a=0;a!=o;++a)if(e[a].numFmtId===s)return a;return e[o]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function AT(e,t,r,s,a,o){try{s.cellNF&&(e.z=Wt[t])}catch(u){if(s.WTF)throw u}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Gr(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(Wt[t]==null&&vi(vz[t]||"General",t),e.t==="e")e.w=e.w||Oi[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ud(e.v);else if(e.t==="d"){var l=Rs(e.v);(l|0)===l?e.w=l.toString(10):e.w=Ud(l)}else{if(e.v===void 0)return"";e.w=dl(e.v,Uc)}else e.t==="d"?e.w=hn(t,Rs(e.v),Uc):e.w=hn(t,e.v,Uc)}catch(u){if(s.WTF)throw u}if(s.cellStyles&&r!=null)try{e.s=o.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=G0(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=G0(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(s.WTF&&o.Fills)throw u}}}function NK(e,t,r){if(e&&e["!ref"]){var s=gr(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function SK(e,t){var r=gr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Zt(r))}var kK=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,EK=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,jK=/<(?:\w:)?hyperlink [^>]*>/mg,TK=/"(\w*:\w*)"/,AK=/<(?:\w:)?col\b[^>]*[\/]?>/g,CK=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,RK=/<(?:\w:)?pageMargins[^>]*\/>/g,CT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,DK=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,OK=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function FK(e,t,r,s,a,o,l){if(!e)return e;s||(s={"!id":{}});var u=t.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",m="",x=e.match(EK);x?(h=e.slice(0,x.index),m=e.slice(x.index+x[0].length)):h=m=e;var y=h.match(CT);y?lb(y[0],u,a,r):(y=h.match(DK))&&IK(y[0],y[1]||"",u,a,r);var v=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var b=h.slice(v,v+50).match(TK);b&&SK(u,b[1])}var g=h.match(OK);g&&g[1]&&XK(g[1],a);var _=[];if(t.cellStyles){var w=h.match(AK);w&&HK(_,w)}x&&ZK(x[1],u,t,d,o,l);var k=m.match(CK);k&&(u["!autofilter"]=GK(k[0]));var N=[],E=m.match(kK);if(E)for(v=0;v!=E.length;++v)N[v]=gr(E[v].slice(E[v].indexOf('"')+1));var C=m.match(jK);C&&zK(u,C,s);var L=m.match(RK);if(L&&(u["!margins"]=$K(Kt(L[0]))),!u["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(u["!ref"]=Zt(d)),t.sheetRows>0&&u["!ref"]){var O=gr(u["!ref"]);t.sheetRows<=+O.e.r&&(O.e.r=t.sheetRows-1,O.e.r>d.e.r&&(O.e.r=d.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>d.e.c&&(O.e.c=d.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Zt(O))}return _.length>0&&(u["!cols"]=_),N.length>0&&(u["!merges"]=N),u}function LK(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Zt(e[r])+'"/>';return t+"</mergeCells>"}function lb(e,t,r,s){var a=Kt(e);r.Sheets[s]||(r.Sheets[s]={}),a.codeName&&(r.Sheets[s].CodeName=xr(Mr(a.codeName)))}function IK(e,t,r,s,a){lb(e.slice(0,e.indexOf(">")),r,s,a)}function MK(e,t,r,s,a){var o=!1,l={},u=null;if(s.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}o=!0,l.codeName=zn(Cr(d))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),u=(u||"")+Nt("outlinePr",null,h)}!o&&!u||(a[a.length]=Nt("sheetPr",u,l))}var BK=["objects","scenarios","selectLockedCells","selectUnlockedCells"],PK=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function UK(e){var t={sheet:1};return BK.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),PK.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=tb(e.password).toString(16).toUpperCase()),Nt("sheetProtection",null,t)}function zK(e,t,r){for(var s=Array.isArray(e),a=0;a!=t.length;++a){var o=Kt(Mr(t[a]),!0);if(!o.ref)return;var l=((r||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+xr(o.location))):(o.Target="#"+xr(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=gr(o.ref),d=u.s.r;d<=u.e.r;++d)for(var h=u.s.c;h<=u.e.c;++h){var m=Gt({c:h,r:d});s?(e[d]||(e[d]=[]),e[d][h]||(e[d][h]={t:"z",v:void 0}),e[d][h].l=o):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=o)}}}function $K(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function qK(e){return il(e),Nt("pageMargins",null,e)}function HK(e,t){for(var r=!1,s=0;s!=t.length;++s){var a=Kt(t[s],!0);a.hidden&&(a.hidden=Hr(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,rb(a.width)),po(a);o<=l;)e[o++]=Vr(a)}}function WK(e,t){for(var r=["<cols>"],s,a=0;a!=t.length;++a)(s=t[a])&&(r[r.length]=Nt("col",null,Nm(a,s)));return r[r.length]="</cols>",r.join("")}function GK(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function VK(e,t,r,s){var a=typeof e.ref=="string"?e.ref:Zt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=ja(a);l.s.r==l.e.r&&(l.e.r=ja(t["!ref"]).e.r,a=Zt(l));for(var u=0;u<o.length;++u){var d=o[u];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+r.SheetNames[s]+"'!"+a;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+a}),Nt("autoFilter",null,{ref:a})}var KK=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function XK(e,t){t.Views||(t.Views=[{}]),(e.match(KK)||[]).forEach(function(r,s){var a=Kt(r);t.Views[s]||(t.Views[s]={}),+a.zoomScale&&(t.Views[s].zoom=+a.zoomScale),Hr(a.rightToLeft)&&(t.Views[s].RTL=!0)})}function YK(e,t,r,s){var a={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Nt("sheetViews",Nt("sheetView",null,a),{})}function JK(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",o=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Oi[e.v];break;case"d":s&&s.cellDates?a=Gr(e.v,-1).toISOString():(e=Vr(e),e.t="n",a=""+(e.v=Rs(Gr(e.v)))),typeof e.z>"u"&&(e.z=Wt[14]);break;default:a=e.v;break}var u=Ys("v",Cr(a)),d={r:t},h=_o(s.cellXfs,e,s);switch(h!==0&&(d.s=h),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){u=Ys("v",""+ob(s.Strings,e.v,s.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=o&&(e.t=o,e.v=l),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Nt("f",Cr(e.f),m)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),Nt("c",u,d)}var ZK=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=zd("v"),l=zd("f");return function(d,h,m,x,y,v){for(var b=0,g="",_=[],w=[],k=0,N=0,E=0,C="",L,O,B=0,F=0,q,fe,D=0,V=0,I=Array.isArray(v.CellXf),ae,Q=[],te=[],ve=Array.isArray(h),ee=[],Se={},J=!1,M=!!m.sheetStubs,Y=d.split(t),G=0,re=Y.length;G!=re;++G){g=Y[G].trim();var ce=g.length;if(ce!==0){var P=0;e:for(b=0;b<ce;++b)switch(g[b]){case">":if(g[b-1]!="/"){++b;break e}if(m&&m.cellStyles){if(O=Kt(g.slice(P,b),!0),B=O.r!=null?parseInt(O.r,10):B+1,F=-1,m.sheetRows&&m.sheetRows<B)continue;Se={},J=!1,O.ht&&(J=!0,Se.hpt=parseFloat(O.ht),Se.hpx=Jc(Se.hpt)),O.hidden=="1"&&(J=!0,Se.hidden=!0),O.outlineLevel!=null&&(J=!0,Se.level=+O.outlineLevel),J&&(ee[B-1]=Se)}break;case"<":P=b;break}if(P>=b)break;if(O=Kt(g.slice(P,b),!0),B=O.r!=null?parseInt(O.r,10):B+1,F=-1,!(m.sheetRows&&m.sheetRows<B)){x.s.r>B-1&&(x.s.r=B-1),x.e.r<B-1&&(x.e.r=B-1),m&&m.cellStyles&&(Se={},J=!1,O.ht&&(J=!0,Se.hpt=parseFloat(O.ht),Se.hpx=Jc(Se.hpt)),O.hidden=="1"&&(J=!0,Se.hidden=!0),O.outlineLevel!=null&&(J=!0,Se.level=+O.outlineLevel),J&&(ee[B-1]=Se)),_=g.slice(b).split(e);for(var U=0;U!=_.length&&_[U].trim().charAt(0)=="<";++U);for(_=_.slice(U),b=0;b!=_.length;++b)if(g=_[b].trim(),g.length!==0){if(w=g.match(r),k=b,N=0,E=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,w!=null&&w.length===2){for(k=0,C=w[1],N=0;N!=C.length&&!((E=C.charCodeAt(N)-64)<1||E>26);++N)k=26*k+E;--k,F=k}else++F;for(N=0;N!=g.length&&g.charCodeAt(N)!==62;++N);if(++N,O=Kt(g.slice(0,N),!0),O.r||(O.r=Gt({r:B-1,c:F})),C=g.slice(N),L={t:""},(w=C.match(o))!=null&&w[1]!==""&&(L.v=xr(w[1])),m.cellFormula){if((w=C.match(l))!=null&&w[1]!==""){if(L.f=xr(Mr(w[1])).replace(/\r\n/g,`
`),m.xlfn||(L.f=wE(L.f)),w[0].indexOf('t="array"')>-1)L.F=(C.match(a)||[])[1],L.F.indexOf(":")>-1&&Q.push([gr(L.F),L.F]);else if(w[0].indexOf('t="shared"')>-1){fe=Kt(w[0]);var le=xr(Mr(w[1]));m.xlfn||(le=wE(le)),te[parseInt(fe.si,10)]=[fe,le,O.r]}}else(w=C.match(/<f[^>]*\/>/))&&(fe=Kt(w[0]),te[fe.si]&&(L.f=KG(te[fe.si][1],te[fe.si][2],O.r)));var ne=es(O.r);for(N=0;N<Q.length;++N)ne.r>=Q[N][0].s.r&&ne.r<=Q[N][0].e.r&&ne.c>=Q[N][0].s.c&&ne.c<=Q[N][0].e.c&&(L.F=Q[N][1])}if(O.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(M)L.t="z";else continue;else L.t=O.t||"n";switch(x.s.c>F&&(x.s.c=F),x.e.c<F&&(x.e.c=F),L.t){case"n":if(L.v==""||L.v==null){if(!M)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!M)continue;L.t="z"}else q=wd[parseInt(L.v,10)],L.v=q.t,L.r=q.r,m.cellHTML&&(L.h=q.h);break;case"str":L.t="s",L.v=L.v!=null?Mr(L.v):"",m.cellHTML&&(L.h=Uv(L.v));break;case"inlineStr":w=C.match(s),L.t="s",w!=null&&(q=eb(w[1]))?(L.v=q.t,m.cellHTML&&(L.h=q.h)):L.v="";break;case"b":L.v=Hr(L.v);break;case"d":m.cellDates?L.v=Gr(L.v,1):(L.v=Rs(Gr(L.v,1)),L.t="n");break;case"e":(!m||m.cellText!==!1)&&(L.w=L.v),L.v=D5[L.v];break}if(D=V=0,ae=null,I&&O.s!==void 0&&(ae=v.CellXf[O.s],ae!=null&&(ae.numFmtId!=null&&(D=ae.numFmtId),m.cellStyles&&ae.fillId!=null&&(V=ae.fillId))),AT(L,D,V,m,y,v),m.cellDates&&I&&L.t=="n"&&au(Wt[D])&&(L.t="d",L.v=vm(L.v)),O.cm&&m.xlmeta){var ie=(m.xlmeta.Cell||[])[+O.cm-1];ie&&ie.type=="XLDAPR"&&(L.D=!0)}if(ve){var H=es(O.r);h[H.r]||(h[H.r]=[]),h[H.r][H.c]=L}else h[O.r]=L}}}}ee.length>0&&(h["!rows"]=ee)}})();function QK(e,t,r,s){var a=[],o=[],l=gr(e["!ref"]),u="",d,h="",m=[],x=0,y=0,v=e["!rows"],b=Array.isArray(e),g={r:h},_,w=-1;for(y=l.s.c;y<=l.e.c;++y)m[y]=Qr(y);for(x=l.s.r;x<=l.e.r;++x){for(o=[],h=xs(x),y=l.s.c;y<=l.e.c;++y){d=m[y]+h;var k=b?(e[x]||[])[y]:e[d];k!==void 0&&(u=JK(k,d,e,t))!=null&&o.push(u)}(o.length>0||v&&v[x])&&(g={r:h},v&&v[x]&&(_=v[x],_.hidden&&(g.hidden=1),w=-1,_.hpx?w=Kd(_.hpx):_.hpt&&(w=_.hpt),w>-1&&(g.ht=w,g.customHeight=1),_.level&&(g.outlineLevel=_.level)),a[a.length]=Nt("row",o.join(""),g))}if(v)for(;x<v.length;++x)v&&v[x]&&(g={r:x+1},_=v[x],_.hidden&&(g.hidden=1),w=-1,_.hpx?w=Kd(_.hpx):_.hpt&&(w=_.hpt),w>-1&&(g.ht=w,g.customHeight=1),_.level&&(g.outlineLevel=_.level),a[a.length]=Nt("row","",g));return a.join("")}function RT(e,t,r,s){var a=[ys,Nt("worksheet",null,{xmlns:Nl[0],"xmlns:r":Cs.r})],o=r.SheetNames[e],l=0,u="",d=r.Sheets[o];d==null&&(d={});var h=d["!ref"]||"A1",m=gr(h);if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),h=Zt(m)}s||(s={}),d["!comments"]=[];var x=[];MK(d,r,e,t,a),a[a.length]=Nt("dimension",null,{ref:h}),a[a.length]=YK(d,t,e,r),t.sheetFormat&&(a[a.length]=Nt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(a[a.length]=WK(d,d["!cols"])),a[l=a.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(u=QK(d,t),u.length>0&&(a[a.length]=u)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),d["!protect"]&&(a[a.length]=UK(d["!protect"])),d["!autofilter"]!=null&&(a[a.length]=VK(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(a[a.length]=LK(d["!merges"]));var y=-1,v,b=-1;return d["!links"].length>0&&(a[a.length]="<hyperlinks>",d["!links"].forEach(function(g){g[1].Target&&(v={ref:g[0]},g[1].Target.charAt(0)!="#"&&(b=Ar(s,-1,Cr(g[1].Target).replace(/#.*$/,""),ir.HLINK),v["r:id"]="rId"+b),(y=g[1].Target.indexOf("#"))>-1&&(v.location=Cr(g[1].Target.slice(y+1))),g[1].Tooltip&&(v.tooltip=Cr(g[1].Tooltip)),a[a.length]=Nt("hyperlink",null,v))}),a[a.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(a[a.length]=qK(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Ys("ignoredErrors",Nt("ignoredError",null,{numberStoredAsText:1,sqref:h}))),x.length>0&&(b=Ar(s,-1,"../drawings/drawing"+(e+1)+".xml",ir.DRAW),a[a.length]=Nt("drawing",null,{"r:id":"rId"+b}),d["!drawing"]=x),d["!comments"].length>0&&(b=Ar(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ir.VML),a[a.length]=Nt("legacyDrawing",null,{"r:id":"rId"+b}),d["!legacy"]=b),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function eX(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=s,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=a/20),r}function tX(e,t,r){var s=nt(145),a=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var o=320;a.hpx?o=Kd(a.hpx)*20:a.hpt&&(o=a.hpt*20),s.write_shift(2,o),s.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),s.write_shift(1,l),s.write_shift(1,0);var u=0,d=s.l;s.l+=4;for(var h={r:e,c:0},m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var x=-1,y=-1,v=m<<10;v<m+1<<10;++v){h.c=v;var b=Array.isArray(r)?(r[h.r]||[])[h.c]:r[Gt(h)];b&&(x<0&&(x=v),y=v)}x<0||(++u,s.write_shift(4,x),s.write_shift(4,y))}var g=s.l;return s.l=d,s.write_shift(4,u),s.l=g,s.length>s.l?s.slice(0,s.l):s}function rX(e,t,r,s){var a=tX(s,r,t);(a.length>17||(t["!rows"]||[])[s])&&dt(e,0,a)}var sX=jl,aX=ou;function nX(){}function iX(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=c$(e),r}function oX(e,t,r){r==null&&(r=nt(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var a=1;a<3;++a)r.write_shift(1,0);return q0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),j5(e,r),r.slice(0,r.l)}function lX(e){var t=pn(e);return[t]}function cX(e,t,r){return r==null&&(r=nt(8)),Sl(t,r)}function uX(e){var t=kl(e);return[t]}function dX(e,t,r){return r==null&&(r=nt(4)),El(t,r)}function fX(e){var t=pn(e),r=e.read_shift(1);return[t,r,"b"]}function hX(e,t,r){return r==null&&(r=nt(9)),Sl(t,r),r.write_shift(1,e.v?1:0),r}function mX(e){var t=kl(e),r=e.read_shift(1);return[t,r,"b"]}function pX(e,t,r){return r==null&&(r=nt(5)),El(t,r),r.write_shift(1,e.v?1:0),r}function xX(e){var t=pn(e),r=e.read_shift(1);return[t,r,"e"]}function gX(e,t,r){return r==null&&(r=nt(9)),Sl(t,r),r.write_shift(1,e.v),r}function yX(e){var t=kl(e),r=e.read_shift(1);return[t,r,"e"]}function vX(e,t,r){return r==null&&(r=nt(8)),El(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function bX(e){var t=pn(e),r=e.read_shift(4);return[t,r,"s"]}function wX(e,t,r){return r==null&&(r=nt(12)),Sl(t,r),r.write_shift(4,t.v),r}function _X(e){var t=kl(e),r=e.read_shift(4);return[t,r,"s"]}function NX(e,t,r){return r==null&&(r=nt(8)),El(t,r),r.write_shift(4,t.v),r}function SX(e){var t=pn(e),r=aa(e);return[t,r,"n"]}function kX(e,t,r){return r==null&&(r=nt(16)),Sl(t,r),hl(e.v,r),r}function DT(e){var t=kl(e),r=aa(e);return[t,r,"n"]}function EX(e,t,r){return r==null&&(r=nt(12)),El(t,r),hl(e.v,r),r}function jX(e){var t=pn(e),r=Xv(e);return[t,r,"n"]}function TX(e,t,r){return r==null&&(r=nt(12)),Sl(t,r),T5(e.v,r),r}function AX(e){var t=kl(e),r=Xv(e);return[t,r,"n"]}function CX(e,t,r){return r==null&&(r=nt(8)),El(t,r),T5(e.v,r),r}function RX(e){var t=pn(e),r=Gv(e);return[t,r,"is"]}function DX(e){var t=pn(e),r=ia(e);return[t,r,"str"]}function OX(e,t,r){return r==null&&(r=nt(12+4*e.v.length)),Sl(t,r),Ms(e.v,r),r.length>r.l?r.slice(0,r.l):r}function FX(e){var t=kl(e),r=ia(e);return[t,r,"str"]}function LX(e,t,r){return r==null&&(r=nt(8+4*e.v.length)),El(t,r),Ms(e.v,r),r.length>r.l?r.slice(0,r.l):r}function IX(e,t,r){var s=e.l+t,a=pn(e);a.r=r["!row"];var o=e.read_shift(1),l=[a,o,"b"];if(r.cellFormula){e.l+=2;var u=_m(e,s-e.l,r);l[3]=ra(u,null,a,r.supbooks,r)}else e.l=s;return l}function MX(e,t,r){var s=e.l+t,a=pn(e);a.r=r["!row"];var o=e.read_shift(1),l=[a,o,"e"];if(r.cellFormula){e.l+=2;var u=_m(e,s-e.l,r);l[3]=ra(u,null,a,r.supbooks,r)}else e.l=s;return l}function BX(e,t,r){var s=e.l+t,a=pn(e);a.r=r["!row"];var o=aa(e),l=[a,o,"n"];if(r.cellFormula){e.l+=2;var u=_m(e,s-e.l,r);l[3]=ra(u,null,a,r.supbooks,r)}else e.l=s;return l}function PX(e,t,r){var s=e.l+t,a=pn(e);a.r=r["!row"];var o=ia(e),l=[a,o,"str"];if(r.cellFormula){e.l+=2;var u=_m(e,s-e.l,r);l[3]=ra(u,null,a,r.supbooks,r)}else e.l=s;return l}var UX=jl,zX=ou;function $X(e,t){return t==null&&(t=nt(4)),t.write_shift(4,e),t}function qX(e,t){var r=e.l+t,s=jl(e),a=Vv(e),o=ia(e),l=ia(e),u=ia(e);e.l=r;var d={rfx:s,relId:a,loc:o,display:u};return l&&(d.Tooltip=l),d}function HX(e,t){var r=nt(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ou({s:es(e[0]),e:es(e[0])},r),Kv("rId"+t,r);var s=e[1].Target.indexOf("#"),a=s==-1?"":e[1].Target.slice(s+1);return Ms(a||"",r),Ms(e[1].Tooltip||"",r),Ms("",r),r.slice(0,r.l)}function WX(){}function GX(e,t,r){var s=e.l+t,a=A5(e),o=e.read_shift(1),l=[a];if(l[2]=o,r.cellFormula){var u=xK(e,s-e.l,r);l[1]=u}else e.l=s;return l}function VX(e,t,r){var s=e.l+t,a=jl(e),o=[a];if(r.cellFormula){var l=yK(e,s-e.l,r);o[1]=l,e.l=s}else e.l=s;return o}function KX(e,t,r){r==null&&(r=nt(18));var s=Nm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof s.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var OT=["left","right","top","bottom","header","footer"];function XX(e){var t={};return OT.forEach(function(r){t[r]=aa(e)}),t}function YX(e,t){return t==null&&(t=nt(48)),il(e),OT.forEach(function(r){hl(e[r],t)}),t}function JX(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function ZX(e,t,r){r==null&&(r=nt(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function QX(e){var t=nt(24);return t.write_shift(4,4),t.write_shift(4,1),ou(e,t),t}function eY(e,t){return t==null&&(t=nt(66)),t.write_shift(2,e.password?tb(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function tY(){}function rY(){}function sY(e,t,r,s,a,o,l){if(!e)return e;var u=t||{};s||(s={"!id":{}});var d=u.dense?[]:{},h,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,y=!1,v,b,g,_,w,k,N,E,C,L=[];u.biff=12,u["!row"]=0;var O=0,B=!1,F=[],q={},fe=u.supbooks||a.supbooks||[[]];if(fe.sharedf=q,fe.arrayf=F,fe.SheetNames=a.SheetNames||a.Sheets.map(function(ve){return ve.name}),!u.supbooks&&(u.supbooks=fe,a.Names))for(var D=0;D<a.Names.length;++D)fe[0][D+1]=a.Names[D];var V=[],I=[],ae=!1;Xd[16]={n:"BrtShortReal",f:DT};var Q;if(Di(e,function(ee,Se,J){if(!y)switch(J){case 148:h=ee;break;case 0:v=ee,u.sheetRows&&u.sheetRows<=v.r&&(y=!0),E=xs(_=v.r),u["!row"]=v.r,(ee.hidden||ee.hpt||ee.level!=null)&&(ee.hpt&&(ee.hpx=Jc(ee.hpt)),I[ee.r]=ee);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:ee[2]},ee[2]){case"n":b.v=ee[1];break;case"s":N=wd[ee[1]],b.v=N.t,b.r=N.r;break;case"b":b.v=!!ee[1];break;case"e":b.v=ee[1],u.cellText!==!1&&(b.w=Oi[b.v]);break;case"str":b.t="s",b.v=ee[1];break;case"is":b.t="s",b.v=ee[1].t;break}if((g=l.CellXf[ee[0].iStyleRef])&&AT(b,g.numFmtId,null,u,o,l),w=ee[0].c==-1?w+1:ee[0].c,u.dense?(d[_]||(d[_]=[]),d[_][w]=b):d[Qr(w)+E]=b,u.cellFormula){for(B=!1,O=0;O<F.length;++O){var M=F[O];v.r>=M[0].s.r&&v.r<=M[0].e.r&&w>=M[0].s.c&&w<=M[0].e.c&&(b.F=Zt(M[0]),B=!0)}!B&&ee.length>3&&(b.f=ee[3])}if(m.s.r>v.r&&(m.s.r=v.r),m.s.c>w&&(m.s.c=w),m.e.r<v.r&&(m.e.r=v.r),m.e.c<w&&(m.e.c=w),u.cellDates&&g&&b.t=="n"&&au(Wt[g.numFmtId])){var Y=tl(b.v);Y&&(b.t="d",b.v=new Date(Y.y,Y.m-1,Y.d,Y.H,Y.M,Y.S,Y.u))}Q&&(Q.type=="XLDAPR"&&(b.D=!0),Q=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;b={t:"z",v:void 0},w=ee[0].c==-1?w+1:ee[0].c,u.dense?(d[_]||(d[_]=[]),d[_][w]=b):d[Qr(w)+E]=b,m.s.r>v.r&&(m.s.r=v.r),m.s.c>w&&(m.s.c=w),m.e.r<v.r&&(m.e.r=v.r),m.e.c<w&&(m.e.c=w),Q&&(Q.type=="XLDAPR"&&(b.D=!0),Q=void 0);break;case 176:L.push(ee);break;case 49:Q=((u.xlmeta||{}).Cell||[])[ee-1];break;case 494:var G=s["!id"][ee.relId];for(G?(ee.Target=G.Target,ee.loc&&(ee.Target+="#"+ee.loc),ee.Rel=G):ee.relId==""&&(ee.Target="#"+ee.loc),_=ee.rfx.s.r;_<=ee.rfx.e.r;++_)for(w=ee.rfx.s.c;w<=ee.rfx.e.c;++w)u.dense?(d[_]||(d[_]=[]),d[_][w]||(d[_][w]={t:"z",v:void 0}),d[_][w].l=ee):(k=Gt({c:w,r:_}),d[k]||(d[k]={t:"z",v:void 0}),d[k].l=ee);break;case 426:if(!u.cellFormula)break;F.push(ee),C=u.dense?d[_][w]:d[Qr(w)+E],C.f=ra(ee[1],m,{r:v.r,c:w},fe,u),C.F=Zt(ee[0]);break;case 427:if(!u.cellFormula)break;q[Gt(ee[0].s)]=ee[1],C=u.dense?d[_][w]:d[Qr(w)+E],C.f=ra(ee[1],m,{r:v.r,c:w},fe,u);break;case 60:if(!u.cellStyles)break;for(;ee.e>=ee.s;)V[ee.e--]={width:ee.w/256,hidden:!!(ee.flags&1),level:ee.level},ae||(ae=!0,rb(ee.w/256)),po(V[ee.e+1]);break;case 161:d["!autofilter"]={ref:Zt(ee)};break;case 476:d["!margins"]=ee;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ee.name&&(a.Sheets[r].CodeName=ee.name),(ee.above||ee.left)&&(d["!outline"]={above:ee.above,left:ee.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ee.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!Se.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+J.toString(16))}}},u),delete u.supbooks,delete u["!row"],!d["!ref"]&&(m.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(d["!ref"]=Zt(h||m)),u.sheetRows&&d["!ref"]){var te=gr(d["!ref"]);u.sheetRows<=+te.e.r&&(te.e.r=u.sheetRows-1,te.e.r>m.e.r&&(te.e.r=m.e.r),te.e.r<te.s.r&&(te.s.r=te.e.r),te.e.c>m.e.c&&(te.e.c=m.e.c),te.e.c<te.s.c&&(te.s.c=te.e.c),d["!fullref"]=d["!ref"],d["!ref"]=Zt(te))}return L.length>0&&(d["!merges"]=L),V.length>0&&(d["!cols"]=V),I.length>0&&(d["!rows"]=I),d}function aY(e,t,r,s,a,o,l){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Vr(t),t.z=t.z||Wt[14],t.v=Rs(Gr(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var d={r,c:s};switch(d.s=_o(a.cellXfs,t,a),t.l&&o["!links"].push([Gt(d),t.l]),t.c&&o["!comments"].push([Gt(d),t.c]),t.t){case"s":case"str":return a.bookSST?(u=ob(a.Strings,t.v,a.revStrings),d.t="s",d.v=u,l?dt(e,18,NX(t,d)):dt(e,7,wX(t,d))):(d.t="str",l?dt(e,17,LX(t,d)):dt(e,6,OX(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?dt(e,13,CX(t,d)):dt(e,2,TX(t,d)):l?dt(e,16,EX(t,d)):dt(e,5,kX(t,d)),!0;case"b":return d.t="b",l?dt(e,15,pX(t,d)):dt(e,4,hX(t,d)),!0;case"e":return d.t="e",l?dt(e,14,vX(t,d)):dt(e,3,gX(t,d)),!0}return l?dt(e,12,dX(t,d)):dt(e,1,cX(t,d)),!0}function nY(e,t,r,s){var a=gr(t["!ref"]||"A1"),o,l="",u=[];dt(e,145);var d=Array.isArray(t),h=a.e.r;t["!rows"]&&(h=Math.max(a.e.r,t["!rows"].length-1));for(var m=a.s.r;m<=h;++m){l=xs(m),rX(e,t,a,m);var x=!1;if(m<=a.e.r)for(var y=a.s.c;y<=a.e.c;++y){m===a.s.r&&(u[y]=Qr(y)),o=u[y]+l;var v=d?(t[m]||[])[y]:t[o];if(!v){x=!1;continue}x=aY(e,v,m,y,s,t,x)}}dt(e,146)}function iY(e,t){!t||!t["!merges"]||(dt(e,177,$X(t["!merges"].length)),t["!merges"].forEach(function(r){dt(e,176,zX(r))}),dt(e,178))}function oY(e,t){!t||!t["!cols"]||(dt(e,390),t["!cols"].forEach(function(r,s){r&&dt(e,60,KX(s,r))}),dt(e,391))}function lY(e,t){!t||!t["!ref"]||(dt(e,648),dt(e,649,QX(gr(t["!ref"]))),dt(e,650))}function cY(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var a=Ar(r,-1,s[1].Target.replace(/#.*$/,""),ir.HLINK);dt(e,494,HX(s,a))}}),delete t["!links"]}function uY(e,t,r,s){if(t["!comments"].length>0){var a=Ar(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ir.VML);dt(e,551,Kv("rId"+a)),t["!legacy"]=a}}function dY(e,t,r,s){if(t["!autofilter"]){var a=t["!autofilter"],o=typeof a.ref=="string"?a.ref:Zt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,u=ja(o);u.s.r==u.e.r&&(u.e.r=ja(t["!ref"]).e.r,o=Zt(u));for(var d=0;d<l.length;++d){var h=l[d];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==s){h.Ref="'"+r.SheetNames[s]+"'!"+o;break}}d==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+o}),dt(e,161,ou(gr(o))),dt(e,162)}}function fY(e,t,r){dt(e,133),dt(e,137,ZX(t,r)),dt(e,138),dt(e,134)}function hY(e,t){t["!protect"]&&dt(e,535,eY(t["!protect"]))}function mY(e,t,r,s){var a=Ea(),o=r.SheetNames[e],l=r.Sheets[o]||{},u=o;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var d=gr(l["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],dt(a,129),(r.vbaraw||l["!outline"])&&dt(a,147,oX(u,l["!outline"])),dt(a,148,aX(d)),fY(a,l,r.Workbook),oY(a,l),nY(a,l,e,t),hY(a,l),dY(a,l,r,e),iY(a,l),cY(a,l,s),l["!margins"]&&dt(a,476,YX(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&lY(a,l),uY(a,l,e,s),dt(a,130),a.end()}function pY(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var a=xr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){s=o.replace(/<.*?>/g,"")}),[t,a,s]}function xY(e,t,r,s,a,o){var l=o||{"!type":"chart"};if(!e)return o;var u=0,d=0,h="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var y=pY(x);m.s.r=m.s.c=0,m.e.c=u,h=Qr(u),y[0].forEach(function(v,b){l[h+xs(b)]={t:"n",v,z:y[1]},d=b}),m.e.r<d&&(m.e.r=d),++u}),u>0&&(l["!ref"]=Zt(m)),l}function gY(e,t,r,s,a){if(!e)return e;s||(s={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,u=e.match(CT);return u&&lb(u[0],o,a,r),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),s["!id"][o["!rel"]]&&(o["!drawel"]=s["!id"][o["!rel"]]),o}function yY(e,t){e.l+=10;var r=ia(e);return{name:r}}function vY(e,t,r,s,a){if(!e)return e;s||(s={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Di(e,function(d,h,m){switch(m){case 550:o["!rel"]=d;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),d.name&&(a.Sheets[r].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},t),s["!id"][o["!rel"]]&&(o["!drawel"]=s["!id"][o["!rel"]]),o}var cb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],bY=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],wY=[],_Y=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function EE(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],a=0;a!=t.length;++a){var o=t[a];if(s[o[0]]==null)s[o[0]]=o[1];else switch(o[2]){case"bool":typeof s[o[0]]=="string"&&(s[o[0]]=Hr(s[o[0]]));break;case"int":typeof s[o[0]]=="string"&&(s[o[0]]=parseInt(s[o[0]],10));break}}}function jE(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=Hr(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function FT(e){jE(e.WBProps,cb),jE(e.CalcPr,_Y),EE(e.WBView,bY),EE(e.Sheets,wY),Uc.date1904=Hr(e.WBProps.date1904)}function NY(e){return!e.Workbook||!e.Workbook.WBProps?"false":Hr(e.Workbook.WBProps.date1904)?"true":"false"}var SY="][*?/\\".split("");function LT(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return SY.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function kY(e,t,r){e.forEach(function(s,a){LT(s);for(var o=0;o<a;++o)if(s==e[o])throw new Error("Duplicate Sheet Name: "+s);if(r){var l=t&&t[a]&&t[a].CodeName||s;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function EY(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];kY(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)NK(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var jY=/<\w+:workbook/;function TY(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,a="xmlns",o={},l=0;if(e.replace(ca,function(d,h){var m=Kt(d);switch(Hn(m[0])){case"<?xml":break;case"<workbook":d.match(jY)&&(a="xmlns"+d.match(/<(\w+):/)[1]),r.xmlns=m[a];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":cb.forEach(function(x){if(m[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=Hr(m[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(m[x[0]],10);break;default:r.WBProps[x[0]]=m[x[0]]}}),m.codeName&&(r.WBProps.CodeName=Mr(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=xr(Mr(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":o={},o.Name=Mr(m.name),m.comment&&(o.Comment=m.comment),m.localSheetId&&(o.Sheet=+m.localSheetId),Hr(m.hidden||"0")&&(o.Hidden=!0),l=h+d.length;break;case"</definedName>":o.Ref=xr(Mr(e.slice(l,h))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return d}),Nl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return FT(r),r}function IT(e){var t=[ys];t[t.length]=Nt("workbook",null,{xmlns:Nl[0],"xmlns:r":Cs.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(cb.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(s[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=Nt("workbookPr",null,s);var a=e.Workbook&&e.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var l={name:Cr(e.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Nt("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var d={name:u.Name};u.Comment&&(d.comment=u.Comment),u.Sheet!=null&&(d.localSheetId=""+u.Sheet),u.Hidden&&(d.hidden="1"),u.Ref&&(t[t.length]=Nt("definedName",Cr(u.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function AY(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Uy(e),r.name=ia(e),r}function CY(e,t){return t||(t=nt(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Kv(e.strRelID,t),Ms(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function RY(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?ia(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function DY(e,t){t||(t=nt(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),j5(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function OY(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function FY(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),o=u$(e),l=gK(e,0,r),u=Vv(e);e.l=s;var d={Name:o,Ptg:l};return a<268435455&&(d.Sheet=a),u&&(d.Comment=u),d}function LY(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],a=!1;t||(t={}),t.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Xd[16]={n:"BrtFRTArchID$",f:OY},Di(e,function(d,h,m){switch(m){case 156:l.SheetNames.push(d.name),r.Sheets.push(d);break;case 153:r.WBProps=d;break;case 39:d.Sheet!=null&&(t.SID=d.Sheet),d.Ref=ra(d.Ptg,null,null,l,t),delete t.SID,delete d.Ptg,o.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,d]):l[0]=[m,d],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(d),l.XTI=l.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(m),a=!0;break;case 36:s.pop(),a=!1;break;case 37:s.push(m),a=!0;break;case 38:s.pop(),a=!1;break;case 16:break;default:if(!h.T){if(!a||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},t),FT(r),r.Names=o,r.supbooks=l,r}function IY(e,t){dt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};dt(e,156,CY(a))}dt(e,144)}function MY(e,t){t||(t=nt(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ms("SheetJS",t),Ms(I0.version,t),Ms(I0.version,t),Ms("7262",t),t.length>t.l?t.slice(0,t.l):t}function BY(e,t){t||(t=nt(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function PY(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,a=-1,o=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&a==-1?a=s:r[s].Hidden==1&&o==-1&&(o=s);o>a||(dt(e,135),dt(e,158,BY(a)),dt(e,136))}}function UY(e,t){var r=Ea();return dt(r,131),dt(r,128,MY()),dt(r,153,DY(e.Workbook&&e.Workbook.WBProps||null)),PY(r,e),IY(r,e),dt(r,132),r.end()}function zY(e,t,r){return t.slice(-4)===".bin"?LY(e,r):TY(e,r)}function $Y(e,t,r,s,a,o,l,u){return t.slice(-4)===".bin"?sY(e,s,r,a,o,l,u):FK(e,s,r,a,o,l,u)}function qY(e,t,r,s,a,o,l,u){return t.slice(-4)===".bin"?vY(e,s,r,a,o):gY(e,s,r,a,o)}function HY(e,t,r,s,a,o,l,u){return t.slice(-4)===".bin"?GG():VG()}function WY(e,t,r,s,a,o,l,u){return t.slice(-4)===".bin"?HG():WG()}function GY(e,t,r,s){return t.slice(-4)===".bin"?zW(e,r,s):AW(e,r,s)}function VY(e,t,r){return xT(e,r)}function KY(e,t,r){return t.slice(-4)===".bin"?KH(e,r):WH(e,r)}function XY(e,t,r){return t.slice(-4)===".bin"?PG(e,r):CG(e,r)}function YY(e,t,r){return t.slice(-4)===".bin"?jG(e):kG(e)}function JY(e,t,r,s){return r.slice(-4)===".bin"?TG(e,t,r,s):void 0}function ZY(e,t,r){return t.slice(-4)===".bin"?_G(e,t,r):SG(e,t,r)}function QY(e,t,r){return(t.slice(-4)===".bin"?UY:IT)(e)}function eJ(e,t,r,s,a){return(t.slice(-4)===".bin"?mY:RT)(e,r,s,a)}function tJ(e,t,r){return(t.slice(-4)===".bin"?JW:mT)(e,r)}function rJ(e,t,r){return(t.slice(-4)===".bin"?JH:iT)(e,r)}function sJ(e,t,r){return(t.slice(-4)===".bin"?UG:vT)(e)}function aJ(e){return(e.slice(-4)===".bin"?NG:gT)()}var MT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,BT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function vn(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var a=e.match(MT),o,l,u,d;if(a)for(d=0;d!=a.length;++d)o=a[d].match(BT),(l=o[1].indexOf(":"))===-1?s[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(l+1),s[u]=o[2].slice(1,o[2].length-1));return s}function nJ(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(MT),a,o,l,u;if(s)for(u=0;u!=s.length;++u)a=s[u].match(BT),(o=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),r[l]=a[2].slice(1,a[2].length-1));return r}var Nd;function iJ(e,t){var r=Nd[e]||xr(e);return r==="General"?dl(t):hn(r,t)}function oJ(e,t,r,s){var a=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Hr(s);break;case"i2":case"int":a=parseInt(s,10);break;case"r4":case"float":a=parseFloat(s);break;case"date":case"dateTime.tz":a=Gr(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[xr(t)]=a}function lJ(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Oi[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ud(e.v):e.w=dl(e.v):e.w=iJ(t||"General",e.v)}catch(o){if(r.WTF)throw o}try{var s=Nd[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&au(s)){var a=tl(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(r.WTF)throw o}}}function cJ(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=wW[s.Pattern]||s.Pattern)}e[t.ID]=t}function uJ(e,t,r,s,a,o,l,u,d,h){var m="General",x=s.StyleID,y={};h=h||{};var v=[],b=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&l&&(x=l.StyleID);o[x]!==void 0&&(o[x].nf&&(m=o[x].nf),o[x].Interior&&v.push(o[x].Interior),!!o[x].Parent);)x=o[x].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=Hr(e);break;case"String":s.t="s",s.r=Hk(xr(e)),s.v=e.indexOf("<")>-1?xr(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(Gr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),s.v!==s.v?s.v=xr(e):s.v<60&&(s.v=s.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=D5[e],h.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=Hk(t||e));break}if(lJ(s,m,h),h.cellFormula!==!1)if(s.Formula){var g=xr(s.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),s.f=Pc(g,a),delete s.Formula,s.ArrayRange=="RC"?s.F=Pc("RC:RC",a):s.ArrayRange&&(s.F=Pc(s.ArrayRange,a),d.push([gr(s.F),s.F]))}else for(b=0;b<d.length;++b)a.r>=d[b][0].s.r&&a.r<=d[b][0].e.r&&a.c>=d[b][0].s.c&&a.c<=d[b][0].e.c&&(s.F=d[b][1]);h.cellStyles&&(v.forEach(function(_){!y.patternType&&_.patternType&&(y.patternType=_.patternType)}),s.s=y),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function dJ(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ny(e,t){var r=t||{};nu();var s=ud(zv(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=Mr(s));var a=s.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Vr(r);return l.type="string",Yc.to_workbook(s,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(A){a.indexOf("<"+A)>=0&&(o=!0)}),o)return YJ(s,r);Nd={"General Number":"General","General Date":Wt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Wt[15],"Short Date":Wt[14],"Long Time":Wt[19],"Medium Time":Wt[18],"Short Time":Wt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Wt[2],Standard:Wt[4],Percent:Wt[10],Scientific:Wt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,d=[],h,m={},x=[],y=r.dense?[]:{},v="",b={},g={},_=vn('<Data ss:Type="String">'),w=0,k=0,N=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},L={},O="",B=0,F=[],q={},fe={},D=0,V=[],I=[],ae={},Q=[],te,ve=!1,ee=[],Se=[],J={},M=0,Y=0,G={Sheets:[],WBProps:{date1904:!1}},re={};qd.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";u=qd.exec(s);)switch(u[3]=(ce=u[3]).toLowerCase()){case"data":if(ce=="data"){if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break}if(d[d.length-1][1])break;u[1]==="/"?uJ(s.slice(w,u.index),O,_,d[d.length-1][0]=="comment"?ae:b,{c:k,r:N},C,Q[k],g,ee,r):(O="",_=vn(u[0]),w=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(I.length>0&&(b.c=I),(!r.sheetRows||r.sheetRows>N)&&b.v!==void 0&&(r.dense?(y[N]||(y[N]=[]),y[N][k]=b):y[Qr(k)+xs(N)]=b),b.HRef&&(b.l={Target:xr(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(M=k+(parseInt(b.MergeAcross,10)|0),Y=N+(parseInt(b.MergeDown,10)|0),F.push({s:{c:k,r:N},e:{c:M,r:Y}})),!r.sheetStubs)b.MergeAcross?k=M+1:++k;else if(b.MergeAcross||b.MergeDown){for(var P=k;P<=M;++P)for(var U=N;U<=Y;++U)(P>k||U>N)&&(r.dense?(y[U]||(y[U]=[]),y[U][P]={t:"z"}):y[Qr(P)+xs(U)]={t:"z"});k=M+1}else++k;else b=nJ(u[0]),b.Index&&(k=+b.Index-1),k<E.s.c&&(E.s.c=k),k>E.e.c&&(E.e.c=k),u[0].slice(-2)==="/>"&&++k,I=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(N<E.s.r&&(E.s.r=N),N>E.e.r&&(E.e.r=N),u[0].slice(-2)==="/>"&&(g=vn(u[0]),g.Index&&(N=+g.Index-1)),k=0,++N):(g=vn(u[0]),g.Index&&(N=+g.Index-1),J={},(g.AutoFitHeight=="0"||g.Height)&&(J.hpx=parseInt(g.Height,10),J.hpt=Kd(J.hpx),Se[N]=J),g.Hidden=="1"&&(J.hidden=!0,Se[N]=J));break;case"worksheet":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));x.push(v),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(y["!ref"]=Zt(E),r.sheetRows&&r.sheetRows<=E.e.r&&(y["!fullref"]=y["!ref"],E.e.r=r.sheetRows-1,y["!ref"]=Zt(E))),F.length&&(y["!merges"]=F),Q.length>0&&(y["!cols"]=Q),Se.length>0&&(y["!rows"]=Se),m[v]=y}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=k=0,d.push([u[3],!1]),h=vn(u[0]),v=xr(h.Name),y=r.dense?[]:{},F=[],ee=[],Se=[],re={name:v,Hidden:0},G.Sheets.push(re);break;case"table":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else{if(u[0].slice(-2)=="/>")break;d.push([u[3],!1]),Q=[],ve=!1}break;case"style":u[1]==="/"?cJ(C,L,r):L=vn(u[0]);break;case"numberformat":L.nf=xr(vn(u[0]).Format||"General"),Nd[L.nf]&&(L.nf=Nd[L.nf]);for(var le=0;le!=392&&Wt[le]!=L.nf;++le);if(le==392){for(le=57;le!=392;++le)if(Wt[le]==null){vi(L.nf,le);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(te=vn(u[0]),te.Hidden&&(te.hidden=!0,delete te.Hidden),te.Width&&(te.wpx=parseInt(te.Width,10)),!ve&&te.wpx>10){ve=!0,sa=fT;for(var ne=0;ne<Q.length;++ne)Q[ne]&&po(Q[ne])}ve&&po(te),Q[te.Index-1||Q.length]=te;for(var ie=0;ie<+te.Span;++ie)Q[Q.length]=Vr(te);break;case"namedrange":if(u[1]==="/")break;G.Names||(G.Names=[]);var H=Kt(u[0]),K={Name:H.Name,Ref:Pc(H.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(K.Sheet=G.Sheets.length-1),G.Names.push(K);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?O+=s.slice(B,u.index):B=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;L.Interior=vn(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?L$(q,ce,s.slice(D,u.index)):D=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else d.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));dJ(ae),I.push(ae)}else d.push([u[3],!1]),h=vn(u[0]),ae={a:h.Author};break;case"autofilter":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var S=vn(u[0]);y["!autofilter"]={ref:Pc(S.Range).replace(/\$/g,"")},d.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"null":break;default:if(d.length==0&&u[3]=="document"||d.length==0&&u[3]=="uof")return DE(s,r);var ue=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ue=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ue=!1}break;case"excelworkbook":switch(u[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ue=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:ue=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(s.slice(D,u.index)){case"SheetHidden":re.Hidden=1;break;case"SheetVeryHidden":re.Hidden=2;break}else D=u.index+u[0].length;break;case"header":y["!margins"]||il(y["!margins"]={},"xlml"),isNaN(+Kt(u[0]).Margin)||(y["!margins"].header=+Kt(u[0]).Margin);break;case"footer":y["!margins"]||il(y["!margins"]={},"xlml"),isNaN(+Kt(u[0]).Margin)||(y["!margins"].footer=+Kt(u[0]).Margin);break;case"pagemargins":var z=Kt(u[0]);y["!margins"]||il(y["!margins"]={},"xlml"),isNaN(+z.Top)||(y["!margins"].top=+z.Top),isNaN(+z.Left)||(y["!margins"].left=+z.Left),isNaN(+z.Right)||(y["!margins"].right=+z.Right),isNaN(+z.Bottom)||(y["!margins"].bottom=+z.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ue=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ue=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ue=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ue=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ue=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ue=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ue=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ue=!1}break;case"smarttags":break;default:ue=!1;break}if(ue||u[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?oJ(fe,ce,V,s.slice(D,u.index)):(V=u,D=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+d.join("|")}var T={};return!r.bookSheets&&!r.bookProps&&(T.Sheets=m),T.SheetNames=x,T.Workbook=G,T.SSF=Vr(Wt),T.Props=q,T.Custprops=fe,T}function Vy(e,t){switch(db(t=t||{}),t.type||"base64"){case"base64":return ny(qa(e),t);case"binary":case"buffer":case"file":return ny(e,t);case"array":return ny(bo(e),t)}}function fJ(e,t){var r=[];return e.Props&&r.push(I$(e.Props,t)),e.Custprops&&r.push(M$(e.Props,e.Custprops)),r.join("")}function hJ(){return""}function mJ(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,a){var o=[];o.push(Nt("NumberFormat",null,{"ss:Format":Cr(Wt[s.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(Nt("Style",o.join(""),l))}),Nt("Styles",r.join(""))}function PT(e){return Nt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+nb(e.Ref,{r:0,c:0})})}function pJ(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var a=t[s];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(PT(a)))}return Nt("Names",r.join(""))}function xJ(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var a=s.Workbook.Names,o=[],l=0;l<a.length;++l){var u=a[l];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||o.push(PT(u)))}return o.join("")}function gJ(e,t,r,s){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Nt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Nt("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Nt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)a.push(Nt("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<r&&!(s.Workbook.Sheets[o]&&!s.Workbook.Sheets[o].Hidden);++o);o==r&&a.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Ys("ProtectContents","True")),e["!protect"].objects&&a.push(Ys("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Ys("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Ys("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Ys("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Nt("WorksheetOptions",a.join(""),{xmlns:Ia.x})}function yJ(e){return e.map(function(t){var r=Pz(t.t||""),s=Nt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Nt("Comment",s,{"ss:Author":t.a})}).join("")}function vJ(e,t,r,s,a,o,l){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+Cr(nb(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var d=es(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(d.r==l.r?"":"["+(d.r-l.r)+"]")+"C"+(d.c==l.c?"":"["+(d.c-l.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=Cr(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=Cr(e.l.Tooltip))),r["!merges"])for(var h=r["!merges"],m=0;m!=h.length;++m)h[m].s.c!=l.c||h[m].s.r!=l.r||(h[m].e.c>h[m].s.c&&(u["ss:MergeAcross"]=h[m].e.c-h[m].s.c),h[m].e.r>h[m].s.r&&(u["ss:MergeDown"]=h[m].e.r-h[m].s.r));var x="",y="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":x="Number",y=String(e.v);break;case"b":x="Boolean",y=e.v?"1":"0";break;case"e":x="Error",y=Oi[e.v];break;case"d":x="DateTime",y=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Wt[14]);break;case"s":x="String",y=Bz(e.v||"");break}var v=_o(s.cellXfs,e,s);u["ss:StyleID"]="s"+(21+v),u["ss:Index"]=l.c+1;var b=e.v!=null?y:"",g=e.t=="z"?"":'<Data ss:Type="'+x+'">'+b+"</Data>";return(e.c||[]).length>0&&(g+=yJ(e.c)),Nt("Cell",g,u)}function bJ(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Jc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function wJ(e,t,r,s){if(!e["!ref"])return"";var a=gr(e["!ref"]),o=e["!merges"]||[],l=0,u=[];e["!cols"]&&e["!cols"].forEach(function(_,w){po(_);var k=!!_.width,N=Nm(w,_),E={"ss:Index":w+1};k&&(E["ss:Width"]=Gd(N.width)),_.hidden&&(E["ss:Hidden"]="1"),u.push(Nt("Column",null,E))});for(var d=Array.isArray(e),h=a.s.r;h<=a.e.r;++h){for(var m=[bJ(h,(e["!rows"]||[])[h])],x=a.s.c;x<=a.e.c;++x){var y=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>x)&&!(o[l].s.r>h)&&!(o[l].e.c<x)&&!(o[l].e.r<h)){(o[l].s.c!=x||o[l].s.r!=h)&&(y=!0);break}if(!y){var v={r:h,c:x},b=Gt(v),g=d?(e[h]||[])[x]:e[b];m.push(vJ(g,b,e,t,r,s,v))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function _J(e,t,r){var s=[],a=r.SheetNames[e],o=r.Sheets[a],l=o?xJ(o,t,e,r):"";return l.length>0&&s.push("<Names>"+l+"</Names>"),l=o?wJ(o,t,e,r):"",l.length>0&&s.push("<Table>"+l+"</Table>"),s.push(gJ(o,t,e,r)),s.join("")}function NJ(e,t){t||(t={}),e.SSF||(e.SSF=Vr(Wt)),e.SSF&&(nu(),xm(e.SSF),t.revssf=ym(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],_o(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(fJ(e,t)),r.push(hJ()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(Nt("Worksheet",_J(s,t,e),{"ss:Name":Cr(e.SheetNames[s])}));return r[2]=mJ(e,t),r[3]=pJ(e),ys+Nt("Workbook",r.join(""),{xmlns:Ia.ss,"xmlns:o":Ia.o,"xmlns:x":Ia.x,"xmlns:ss":Ia.ss,"xmlns:dt":Ia.dt,"xmlns:html":Ia.html})}function SJ(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=p$(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=x$(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var kJ=[60,1084,2066,2165,2175];function EJ(e,t,r,s,a){var o=s,l=[],u=r.slice(r.l,r.l+o);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),r.l+=o;for(var d=xi(r,r.l),h=Ky[d],m=0;h!=null&&kJ.indexOf(d)>-1;)o=xi(r,r.l+2),m=r.l+4,d==2066?m+=4:(d==2165||d==2175)&&(m+=12),u=r.slice(m,r.l+4+o),l.push(u),r.l+=4+o,h=Ky[d=xi(r,r.l)];var x=Is(l);Ks(x,0);var y=0;x.lens=[];for(var v=0;v<l.length;++v)x.lens.push(y),y+=l[v].length;if(x.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+s;return t.f(x,x.length,a)}function Fn(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Wt[s])}catch(o){if(t.WTF)throw o}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Oi[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ud(e.v):e.w=dl(e.v):e.w=hn(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(o){if(t.WTF)throw o}if(t.cellDates&&s&&e.t=="n"&&au(Wt[s]||String(s))){var a=tl(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function n0(e,t,r){return{v:e,ixfe:t,t:r}}function jJ(e,t){var r={opts:{}},s={},a=t.dense?[]:{},o={},l={},u=null,d=[],h="",m={},x,y="",v,b,g,_,w={},k=[],N,E,C=[],L=[],O={Sheets:[],WBProps:{date1904:!1},Views:[{}]},B={},F=function(De){return De<8?sl[De]:De<64&&L[De-8]||sl[De]},q=function(De,mt,At){var wt=mt.XF.data;if(!(!wt||!wt.patternType||!At||!At.cellStyles)){mt.s={},mt.s.patternType=wt.patternType;var Ct;(Ct=Wd(F(wt.icvFore)))&&(mt.s.fgColor={rgb:Ct}),(Ct=Wd(F(wt.icvBack)))&&(mt.s.bgColor={rgb:Ct})}},fe=function(De,mt,At){if(!(J>1)&&!(At.sheetRows&&De.r>=At.sheetRows)){if(At.cellStyles&&mt.XF&&mt.XF.data&&q(De,mt,At),delete mt.ixfe,delete mt.XF,x=De,y=Gt(De),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),De.r<l.s.r&&(l.s.r=De.r),De.c<l.s.c&&(l.s.c=De.c),De.r+1>l.e.r&&(l.e.r=De.r+1),De.c+1>l.e.c&&(l.e.c=De.c+1),At.cellFormula&&mt.f){for(var wt=0;wt<k.length;++wt)if(!(k[wt][0].s.c>De.c||k[wt][0].s.r>De.r)&&!(k[wt][0].e.c<De.c||k[wt][0].e.r<De.r)){mt.F=Zt(k[wt][0]),(k[wt][0].s.c!=De.c||k[wt][0].s.r!=De.r)&&delete mt.f,mt.f&&(mt.f=""+ra(k[wt][1],l,De,ee,D));break}}At.dense?(a[De.r]||(a[De.r]=[]),a[De.r][De.c]=mt):a[y]=mt}},D={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var V,I=[],ae=[],Q=[],te=[],ve=!1,ee=[];ee.SheetNames=D.snames,ee.sharedf=D.sharedf,ee.arrayf=D.arrayf,ee.names=[],ee.XTI=[];var Se=0,J=0,M=0,Y=[],G=[],re;D.codepage=1200,kn(1200);for(var ce=!1;e.l<e.length-1;){var P=e.l,U=e.read_shift(2);if(U===0&&Se===10)break;var le=e.l===e.length?0:e.read_shift(2),ne=Ky[U];if(ne&&ne.f){if(t.bookSheets&&Se===133&&U!==133)break;if(Se=U,ne.r===2||ne.r==12){var ie=e.read_shift(2);if(le-=2,!D.enc&&ie!==U&&((ie&255)<<8|ie>>8)!==U)throw new Error("rt mismatch: "+ie+"!="+U);ne.r==12&&(e.l+=10,le-=10)}var H={};if(U===10?H=ne.f(e,le,D):H=EJ(U,ne,e,le,D),J==0&&[9,521,1033,2057].indexOf(Se)===-1)continue;switch(U){case 34:r.opts.Date1904=O.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=H,!t.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=H;break;case 66:var K=Number(H);switch(K){case 21010:K=1200;break;case 32768:K=1e4;break;case 32769:K=1252;break}kn(D.codepage=K),ce=!0;break;case 317:D.rrtabid=H;break;case 25:D.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:D.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(a["!type"]="dialog"),H.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),H.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:C.push(H);break;case 430:ee.push([H]),ee[ee.length-1].XTI=[];break;case 35:case 547:ee[ee.length-1].push(H);break;case 24:case 536:re={Name:H.Name,Ref:ra(H.rgce,l,null,ee,D)},H.itab>0&&(re.Sheet=H.itab-1),ee.names.push(re),ee[0]||(ee[0]=[],ee[0].XTI=[]),ee[ee.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(G[H.itab-1]={ref:Zt(H.rgce[0][0][1][2])});break;case 22:D.ExternCount=H;break;case 23:ee.length==0&&(ee[0]=[],ee[0].XTI=[]),ee[ee.length-1].XTI=ee[ee.length-1].XTI.concat(H),ee.XTI=ee.XTI.concat(H);break;case 2196:if(D.biff<8)break;re!=null&&(re.Comment=H[1]);break;case 18:a["!protect"]=H;break;case 19:H!==0&&D.WTF&&console.error("Password verifier: "+H);break;case 133:o[H.pos]=H,D.snames.push(H.name);break;case 10:{if(--J)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=Zt(l),t.sheetRows&&t.sheetRows<=l.e.r){var S=l.e.r;l.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Zt(l),l.e.r=S}l.e.r++,l.e.c++}I.length>0&&(a["!merges"]=I),ae.length>0&&(a["!objects"]=ae),Q.length>0&&(a["!cols"]=Q),te.length>0&&(a["!rows"]=te),O.Sheets.push(B)}h===""?m=a:s[h]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[U]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),D.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(D.biff=5,ce=!0,kn(D.codepage=28591)),D.biff==8&&H.BIFFVer==0&&H.dt==16&&(D.biff=2),J++)break;if(a=t.dense?[]:{},D.biff<8&&!ce&&(ce=!0,kn(D.codepage=t.codepage||1252)),D.biff<5||H.BIFFVer==0&&H.dt==4096){h===""&&(h="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var ue={pos:e.l-le,name:h};o[ue.pos]=ue,D.snames.push(h)}else h=(o[P]||{name:""}).name;H.dt==32&&(a["!type"]="chart"),H.dt==64&&(a["!type"]="macro"),I=[],ae=[],D.arrayf=k=[],Q=[],te=[],ve=!1,B={Hidden:(o[P]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[H.r]||[])[H.c]:a[Gt({c:H.c,r:H.r})])&&++H.c,N={ixfe:H.ixfe,XF:C[H.ixfe]||{},v:H.val,t:"n"},M>0&&(N.z=Y[N.ixfe>>8&63]),Fn(N,t,r.opts.Date1904),fe({c:H.c,r:H.r},N,t);break;case 5:case 517:N={ixfe:H.ixfe,XF:C[H.ixfe],v:H.val,t:H.t},M>0&&(N.z=Y[N.ixfe>>8&63]),Fn(N,t,r.opts.Date1904),fe({c:H.c,r:H.r},N,t);break;case 638:N={ixfe:H.ixfe,XF:C[H.ixfe],v:H.rknum,t:"n"},M>0&&(N.z=Y[N.ixfe>>8&63]),Fn(N,t,r.opts.Date1904),fe({c:H.c,r:H.r},N,t);break;case 189:for(var z=H.c;z<=H.C;++z){var T=H.rkrec[z-H.c][0];N={ixfe:T,XF:C[T],v:H.rkrec[z-H.c][1],t:"n"},M>0&&(N.z=Y[N.ixfe>>8&63]),Fn(N,t,r.opts.Date1904),fe({c:z,r:H.r},N,t)}break;case 6:case 518:case 1030:{if(H.val=="String"){u=H;break}if(N=n0(H.val,H.cell.ixfe,H.tt),N.XF=C[N.ixfe],t.cellFormula){var A=H.formula;if(A&&A[0]&&A[0][0]&&A[0][0][0]=="PtgExp"){var W=A[0][0][1][0],pe=A[0][0][1][1],_e=Gt({r:W,c:pe});w[_e]?N.f=""+ra(H.formula,l,H.cell,ee,D):N.F=((t.dense?(a[W]||[])[pe]:a[_e])||{}).F}else N.f=""+ra(H.formula,l,H.cell,ee,D)}M>0&&(N.z=Y[N.ixfe>>8&63]),Fn(N,t,r.opts.Date1904),fe(H.cell,N,t),u=H}break;case 7:case 519:if(u)u.val=H,N=n0(H,u.cell.ixfe,"s"),N.XF=C[N.ixfe],t.cellFormula&&(N.f=""+ra(u.formula,l,u.cell,ee,D)),M>0&&(N.z=Y[N.ixfe>>8&63]),Fn(N,t,r.opts.Date1904),fe(u.cell,N,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(H);var oe=Gt(H[0].s);if(v=t.dense?(a[H[0].s.r]||[])[H[0].s.c]:a[oe],t.cellFormula&&v){if(!u||!oe||!v)break;v.f=""+ra(H[1],l,H[0],ee,D),v.F=Zt(H[0])}}break;case 1212:{if(!t.cellFormula)break;if(y){if(!u)break;w[Gt(u.cell)]=H[0],v=t.dense?(a[u.cell.r]||[])[u.cell.c]:a[Gt(u.cell)],(v||{}).f=""+ra(H[0],l,x,ee,D)}}break;case 253:N=n0(d[H.isst].t,H.ixfe,"s"),d[H.isst].h&&(N.h=d[H.isst].h),N.XF=C[N.ixfe],M>0&&(N.z=Y[N.ixfe>>8&63]),Fn(N,t,r.opts.Date1904),fe({c:H.c,r:H.r},N,t);break;case 513:t.sheetStubs&&(N={ixfe:H.ixfe,XF:C[H.ixfe],t:"z"},M>0&&(N.z=Y[N.ixfe>>8&63]),Fn(N,t,r.opts.Date1904),fe({c:H.c,r:H.r},N,t));break;case 190:if(t.sheetStubs)for(var Te=H.c;Te<=H.C;++Te){var Me=H.ixfe[Te-H.c];N={ixfe:Me,XF:C[Me],t:"z"},M>0&&(N.z=Y[N.ixfe>>8&63]),Fn(N,t,r.opts.Date1904),fe({c:Te,r:H.r},N,t)}break;case 214:case 516:case 4:N=n0(H.val,H.ixfe,"s"),N.XF=C[N.ixfe],M>0&&(N.z=Y[N.ixfe>>8&63]),Fn(N,t,r.opts.Date1904),fe({c:H.c,r:H.r},N,t);break;case 0:case 512:J===1&&(l=H);break;case 252:d=H;break;case 1054:if(D.biff==4){Y[M++]=H[1];for(var Ae=0;Ae<M+163&&Wt[Ae]!=H[1];++Ae);Ae>=163&&vi(H[1],M+163)}else vi(H[1],H[0]);break;case 30:{Y[M++]=H;for(var Re=0;Re<M+163&&Wt[Re]!=H;++Re);Re>=163&&vi(H,M+163)}break;case 229:I=I.concat(H);break;case 93:ae[H.cmo[0]]=D.lastobj=H;break;case 438:D.lastobj.TxO=H;break;case 127:D.lastobj.ImData=H;break;case 440:for(_=H[0].s.r;_<=H[0].e.r;++_)for(g=H[0].s.c;g<=H[0].e.c;++g)v=t.dense?(a[_]||[])[g]:a[Gt({c:g,r:_})],v&&(v.l=H[1]);break;case 2048:for(_=H[0].s.r;_<=H[0].e.r;++_)for(g=H[0].s.c;g<=H[0].e.c;++g)v=t.dense?(a[_]||[])[g]:a[Gt({c:g,r:_})],v&&v.l&&(v.l.Tooltip=H[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;v=t.dense?(a[H[0].r]||[])[H[0].c]:a[Gt(H[0])];var et=ae[H[2]];v||(t.dense?(a[H[0].r]||(a[H[0].r]=[]),v=a[H[0].r][H[0].c]={t:"z"}):v=a[Gt(H[0])]={t:"z"},l.e.r=Math.max(l.e.r,H[0].r),l.s.r=Math.min(l.s.r,H[0].r),l.e.c=Math.max(l.e.c,H[0].c),l.s.c=Math.min(l.s.c,H[0].c)),v.c||(v.c=[]),b={a:H[1],t:et.TxO.t},v.c.push(b)}break;case 2173:mG(C[H.ixfe],H.ext);break;case 125:{if(!D.cellStyles)break;for(;H.e>=H.s;)Q[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},ve||(ve=!0,rb(H.w/256)),po(Q[H.e+1])}break;case 520:{var He={};H.level!=null&&(te[H.r]=He,He.level=H.level),H.hidden&&(te[H.r]=He,He.hidden=!0),H.hpt&&(te[H.r]=He,He.hpt=H.hpt,He.hpx=Jc(H.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||il(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[U]]=H;break;case 161:a["!margins"]||il(a["!margins"]={}),a["!margins"].header=H.header,a["!margins"].footer=H.footer;break;case 574:H.RTL&&(O.Views[0].RTL=!0);break;case 146:L=H;break;case 2198:V=H;break;case 140:E=H;break;case 442:h?B.CodeName=H||B.name:O.WBProps.CodeName=H||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+U.toString(16)),e.l+=le}return r.SheetNames=ls(o).sort(function(at,De){return Number(at)-Number(De)}).map(function(at){return o[at].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&G.forEach(function(at,De){r.Sheets[r.SheetNames[De]]["!autofilter"]=at}),r.Strings=d,r.SSF=Vr(Wt),D.enc&&(r.Encryption=D.enc),V&&(r.Themes=V),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),ee.names.length>0&&(O.Names=ee.names),r.Workbook=O,r}var Sd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function TJ(e,t,r){var s=Pt.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var a=lE(s,zy,Sd.DSI);for(var o in a)t[o]=a[o]}catch(h){if(r.WTF)throw h}var l=Pt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var u=lE(l,$y,Sd.SI);for(var d in u)t[d]==null&&(t[d]=u[d])}catch(h){if(r.WTF)throw h}t.HeadingPairs&&t.TitlesOfParts&&(B5(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function AJ(e,t){var r=[],s=[],a=[],o=0,l,u=Bk(zy,"n"),d=Bk($y,"n");if(e.Props)for(l=ls(e.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(d,l[o])?s:a).push([l[o],e.Props[l[o]]]);if(e.Custprops)for(l=ls(e.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(d,l[o])?s:a).push([l[o],e.Custprops[l[o]]]);var h=[];for(o=0;o<a.length;++o)W5.indexOf(a[o][0])>-1||M5.indexOf(a[o][0])>-1||a[o][1]!=null&&h.push(a[o]);s.length&&Pt.utils.cfb_add(t,"/SummaryInformation",cE(s,Sd.SI,d,$y)),(r.length||h.length)&&Pt.utils.cfb_add(t,"/DocumentSummaryInformation",cE(r,Sd.DSI,u,zy,h.length?h:null,Sd.UDI))}function UT(e,t){t||(t={}),db(t),Dv(),t.codepage&&Rv(t.codepage);var r,s;if(e.FullPaths){if(Pt.find(e,"/encryption"))throw new Error("File is password-protected");r=Pt.find(e,"!CompObj"),s=Pt.find(e,"/Workbook")||Pt.find(e,"/Book")}else{switch(t.type){case"base64":e=Ua(qa(e));break;case"binary":e=Ua(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ks(e,0),s={content:e}}var a,o;if(r&&SJ(r),t.bookProps&&!t.bookSheets)a={};else{var l=ar?"buffer":"array";if(s&&s.content)a=jJ(s.content,t);else if((o=Pt.find(e,"PerfectOffice_MAIN"))&&o.content)a=nl.to_workbook(o.content,(t.type=l,t));else if((o=Pt.find(e,"NativeContent_MAIN"))&&o.content)a=nl.to_workbook(o.content,(t.type=l,t));else throw(o=Pt.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Pt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=$G(e))}var u={};return e.FullPaths&&TJ(e,u,t),a.Props=a.Custprops=u,t.bookFiles&&(a.cfb=e),a}function CJ(e,t){var r=t||{},s=Pt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Pt.utils.cfb_add(s,a,zT(e,r)),r.biff==8&&(e.Props||e.Custprops)&&AJ(e,s),r.biff==8&&e.vbaraw&&qG(s,Pt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var Xd={0:{f:eX},1:{f:lX},2:{f:jX},3:{f:xX},4:{f:fX},5:{f:SX},6:{f:DX},7:{f:bX},8:{f:PX},9:{f:BX},10:{f:IX},11:{f:MX},12:{f:uX},13:{f:AX},14:{f:yX},15:{f:mX},16:{f:DT},17:{f:FX},18:{f:_X},19:{f:Gv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:FY},40:{},42:{},43:{f:DW},44:{f:CW},45:{f:LW},46:{f:MW},47:{f:IW},48:{},49:{f:s$},50:{},51:{f:gG},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rT},62:{f:RX},63:{f:EG},64:{f:tY},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:la,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:JX},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:iX},148:{f:sX,p:16},151:{f:WX},152:{},153:{f:RY},154:{},155:{},156:{f:AY},157:{},158:{},159:{T:1,f:VH},160:{T:-1},161:{T:1,f:jl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:UX},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:pG},336:{T:-1},337:{f:bG,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Uy},357:{},358:{},359:{},360:{T:1},361:{},362:{f:tT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:GX},427:{f:VX},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:XX},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:nX},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:qX},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Uy},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:MG},633:{T:1},634:{T:-1},635:{T:1,f:LG},636:{T:-1},637:{f:o$},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:yY},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rY},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ky={6:{f:sy},10:{f:no},12:{f:ks},13:{f:ks},14:{f:ms},15:{f:ms},16:{f:aa},17:{f:ms},18:{f:ms},19:{f:ks},20:{f:pE},21:{f:pE},23:{f:tT},24:{f:gE},25:{f:ms},26:{},27:{},28:{f:rH},29:{},34:{f:ms},35:{f:xE},38:{f:aa},39:{f:aa},40:{f:aa},41:{f:aa},42:{f:ms},43:{f:ms},47:{f:mW},49:{f:Aq},51:{f:ks},60:{},61:{f:Sq},64:{f:ms},65:{f:Tq},66:{f:ks},77:{},80:{},81:{},82:{},85:{f:ks},89:{},90:{},91:{},92:{f:hq},93:{f:nH},94:{},95:{f:ms},96:{},97:{},99:{f:ms},125:{f:rT},128:{f:Hq},129:{f:pq},130:{f:ks},131:{f:ms},132:{f:ms},133:{f:xq},134:{},140:{f:hH},141:{f:ks},144:{},146:{f:xH},151:{},152:{},153:{},154:{},155:{},156:{f:ks},157:{},158:{},160:{f:NH},161:{f:vH},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Uq},190:{f:zq},193:{f:no},197:{},198:{},199:{},200:{},201:{},202:{f:ms},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ks},220:{},221:{f:ms},222:{},224:{f:qq},225:{f:fq},226:{f:no},227:{},229:{f:sH},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:yq},253:{f:Rq},255:{f:bq},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:G5},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ms},353:{f:no},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Xq},431:{f:ms},432:{},433:{},434:{},437:{},438:{f:lH},439:{f:ms},440:{f:cH},441:{},442:{f:hf},443:{},444:{f:ks},445:{},446:{},448:{f:no},449:{f:Nq,r:2},450:{f:no},512:{f:fE},513:{f:_H},515:{f:Vq},516:{f:Oq},517:{f:mE},519:{f:SH},520:{f:wq},523:{},545:{f:yE},549:{f:dE},566:{},574:{f:Eq},638:{f:Pq},659:{},1048:{},1054:{f:Lq},1084:{},1212:{f:Qq},2048:{f:dH},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:r0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:no},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:gH,r:12},2173:{f:hG,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ms,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Zq,r:12},2197:{},2198:{f:oG,r:12},2199:{},2200:{},2201:{},2202:{f:eH,r:12},2203:{f:no},2204:{},2205:{},2206:{},2207:{},2211:{f:_q},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ks},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:bH},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:pH},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:fE},1:{},2:{f:AH},3:{f:jH},4:{f:EH},5:{f:mE},7:{f:RH},8:{},9:{f:r0},11:{},22:{f:ks},30:{f:Mq},31:{},32:{},33:{f:yE},36:{},37:{f:dE},50:{f:DH},62:{},52:{},67:{},68:{f:ks},69:{},86:{},126:{},127:{f:kH},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:OH},223:{},234:{},354:{},421:{},518:{f:sy},521:{f:r0},536:{f:gE},547:{f:xE},561:{},579:{},1030:{f:sy},1033:{f:r0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function St(e,t,r,s){var a=t;if(!isNaN(a)){var o=s||(r||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&qv(r)&&e.push(r)}}function RJ(e,t,r,s){var a=(r||[]).length||0;if(a<=8224)return St(e,t,r,a);var o=t;if(!isNaN(o)){for(var l=r.parts||[],u=0,d=0,h=0;h+(l[u]||8224)<=8224;)h+=l[u]||8224,u++;var m=e.next(4);for(m.write_shift(2,o),m.write_shift(2,h),e.push(r.slice(d,d+h)),d+=h;d<a;){for(m=e.next(4),m.write_shift(2,60),h=0;h+(l[u]||8224)<=8224;)h+=l[u]||8224,u++;m.write_shift(2,h),e.push(r.slice(d,d+h)),d+=h}}}function gf(e,t,r){return e||(e=nt(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function DJ(e,t,r,s){var a=nt(9);return gf(a,e,t),V5(r,s||"b",a),a}function OJ(e,t,r){var s=nt(8+2*r.length);return gf(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function FJ(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Rs(Gr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?St(e,2,CH(r,s,a)):St(e,3,TH(r,s,a));return;case"b":case"e":St(e,5,DJ(r,s,t.v,t.t));return;case"s":case"str":St(e,4,OJ(r,s,(t.v||"").slice(0,255)));return}St(e,1,gf(null,r,s))}function LJ(e,t,r,s){var a=Array.isArray(t),o=gr(t["!ref"]||"A1"),l,u="",d=[];if(o.e.c>255||o.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=Zt(o)}for(var h=o.s.r;h<=o.e.r;++h){u=xs(h);for(var m=o.s.c;m<=o.e.c;++m){h===o.s.r&&(d[m]=Qr(m)),l=d[m]+u;var x=a?(t[h]||[])[m]:t[l];x&&FJ(e,x,h,m)}}}function IJ(e,t){for(var r=t||{},s=Ea(),a=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==r.sheet&&(a=o);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return St(s,r.biff==4?1033:r.biff==3?521:9,Qv(e,16,r)),LJ(s,e.Sheets[e.SheetNames[a]],a,r),St(s,10),s.end()}function MJ(e,t,r){St(e,49,Cq({sz:12,name:"Arial"},r))}function BJ(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)t[a]!=null&&St(e,1054,Iq(a,t[a],r))})}function PJ(e,t){var r=nt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),St(e,2151,r),r=nt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Z5(gr(t["!ref"]||"A1"),r),r.write_shift(4,4),St(e,2152,r)}function UJ(e,t){for(var r=0;r<16;++r)St(e,224,hE({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){St(e,224,hE(s,0,t))})}function zJ(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];St(e,440,uH(s)),s[1].Tooltip&&St(e,2048,fH(s))}delete t["!links"]}function $J(e,t){if(t){var r=0;t.forEach(function(s,a){++r<=256&&s&&St(e,125,yH(Nm(a,s),a))})}}function qJ(e,t,r,s,a){var o=16+_o(a.cellXfs,t,a);if(t.v==null&&!t.bf){St(e,513,pl(r,s,o));return}if(t.bf)St(e,6,pK(t,r,s,a,o));else switch(t.t){case"d":case"n":var l=t.t=="d"?Rs(Gr(t.v)):t.v;St(e,515,Kq(r,s,l,o));break;case"b":case"e":St(e,517,Gq(r,s,t.v,o,a,t.t));break;case"s":case"str":if(a.bookSST){var u=ob(a.Strings,t.v,a.revStrings);St(e,253,Dq(r,s,u,o))}else St(e,516,Fq(r,s,(t.v||"").slice(0,255),o,a));break;default:St(e,513,pl(r,s,o))}}function HJ(e,t,r){var s=Ea(),a=r.SheetNames[e],o=r.Sheets[a]||{},l=(r||{}).Workbook||{},u=(l.Sheets||[])[e]||{},d=Array.isArray(o),h=t.biff==8,m,x="",y=[],v=gr(o["!ref"]||"A1"),b=h?65536:16384;if(v.e.c>255||v.e.r>=b){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,b-1)}St(s,2057,Qv(r,16,t)),St(s,13,un(1)),St(s,12,un(100)),St(s,15,fa(!0)),St(s,17,fa(!1)),St(s,16,hl(.001)),St(s,95,fa(!0)),St(s,42,fa(!1)),St(s,43,fa(!1)),St(s,130,un(1)),St(s,128,Wq()),St(s,131,fa(!1)),St(s,132,fa(!1)),h&&$J(s,o["!cols"]),St(s,512,Bq(v,t)),h&&(o["!links"]=[]);for(var g=v.s.r;g<=v.e.r;++g){x=xs(g);for(var _=v.s.c;_<=v.e.c;++_){g===v.s.r&&(y[_]=Qr(_)),m=y[_]+x;var w=d?(o[g]||[])[_]:o[m];w&&(qJ(s,w,g,_,t),h&&w.l&&o["!links"].push([m,w.l]))}}var k=u.CodeName||u.name||a;return h&&St(s,574,jq((l.Views||[])[0])),h&&(o["!merges"]||[]).length&&St(s,229,aH(o["!merges"])),h&&zJ(s,o),St(s,442,K5(k)),h&&PJ(s,o),St(s,10),s.end()}function WJ(e,t,r){var s=Ea(),a=(e||{}).Workbook||{},o=a.Sheets||[],l=a.WBProps||{},u=r.biff==8,d=r.biff==5;if(St(s,2057,Qv(e,5,r)),r.bookType=="xla"&&St(s,135),St(s,225,u?un(1200):null),St(s,193,G$(2)),d&&St(s,191),d&&St(s,192),St(s,226),St(s,92,mq("SheetJS",r)),St(s,66,un(u?1200:1252)),u&&St(s,353,un(0)),u&&St(s,448),St(s,317,wH(e.SheetNames.length)),u&&e.vbaraw&&St(s,211),u&&e.vbaraw){var h=l.CodeName||"ThisWorkbook";St(s,442,K5(h))}St(s,156,un(17)),St(s,25,fa(!1)),St(s,18,fa(!1)),St(s,19,un(0)),u&&St(s,431,fa(!1)),u&&St(s,444,un(0)),St(s,61,kq()),St(s,64,fa(!1)),St(s,141,un(0)),St(s,34,fa(NY(e)=="true")),St(s,14,fa(!0)),u&&St(s,439,fa(!1)),St(s,218,un(0)),MJ(s,e,r),BJ(s,e.SSF,r),UJ(s,r),u&&St(s,352,fa(!1));var m=s.end(),x=Ea();u&&St(x,140,mH()),u&&r.Strings&&RJ(x,252,vq(r.Strings)),St(x,10);var y=x.end(),v=Ea(),b=0,g=0;for(g=0;g<e.SheetNames.length;++g)b+=(u?12:11)+(u?2:1)*e.SheetNames[g].length;var _=m.length+b+y.length;for(g=0;g<e.SheetNames.length;++g){var w=o[g]||{};St(v,133,gq({pos:_,hs:w.Hidden||0,dt:0,name:e.SheetNames[g]},r)),_+=t[g].length}var k=v.end();if(b!=k.length)throw new Error("BS8 "+b+" != "+k.length);var N=[];return m.length&&N.push(m),k.length&&N.push(k),y.length&&N.push(y),Is(N)}function GJ(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=Vr(Wt)),e&&e.SSF&&(nu(),xm(e.SSF),r.revssf=ym(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fb(r),r.cellXfs=[],_o(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)s[s.length]=HJ(a,r,e);return s.unshift(WJ(e,s,r)),Is(s)}function zT(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var a=ja(s["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var o=t||{};switch(o.biff||2){case 8:case 5:return GJ(e,t);case 4:case 3:case 2:return IJ(e,t)}throw new Error("invalid type "+o.bookType+" for BIFF")}function TE(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=a.index,u=o&&o.index||e.length,d=Cz(e.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,m=0,x=0,y=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(l=0;l<d.length;++l){var g=d[l].trim(),_=g.slice(0,3).toLowerCase();if(_=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}m=0;continue}if(!(_!="<td"&&_!="<th")){var w=g.split(/<\/t[dh]>/i);for(u=0;u<w.length;++u){var k=w[u].trim();if(k.match(/<t[dh]/i)){for(var N=k,E=0;N.charAt(0)=="<"&&(E=N.indexOf(">"))>-1;)N=N.slice(E+1);for(var C=0;C<b.length;++C){var L=b[C];L.s.c==m&&L.s.r<h&&h<=L.e.r&&(m=L.e.c+1,C=-1)}var O=Kt(k.slice(0,k.indexOf(">")));y=O.colspan?+O.colspan:1,((x=+O.rowspan)>1||y>1)&&b.push({s:{r:h,c:m},e:{r:h+(x||1)-1,c:m+y-1}});var B=O.t||O["data-t"]||"";if(!N.length){m+=y;continue}if(N=d5(N),v.s.r>h&&(v.s.r=h),v.e.r<h&&(v.e.r=h),v.s.c>m&&(v.s.c=m),v.e.c<m&&(v.e.c=m),!N.length){m+=y;continue}var F={t:"s",v:N};r.raw||!N.trim().length||B=="s"||(N==="TRUE"?F={t:"b",v:!0}:N==="FALSE"?F={t:"b",v:!1}:isNaN(jn(N))?isNaN(Xc(N).getDate())||(F={t:"d",v:Gr(N)},r.cellDates||(F={t:"n",v:Rs(F.v)}),F.z=r.dateNF||Wt[14]):F={t:"n",v:jn(N)}),r.dense?(s[h]||(s[h]=[]),s[h][m]=F):s[Gt({r:h,c:m})]=F,m+=y}}}}return s["!ref"]=Zt(v),b.length&&(s["!merges"]=b),s}function VJ(e,t,r,s){for(var a=e["!merges"]||[],o=[],l=t.s.c;l<=t.e.c;++l){for(var u=0,d=0,h=0;h<a.length;++h)if(!(a[h].s.r>r||a[h].s.c>l)&&!(a[h].e.r<r||a[h].e.c<l)){if(a[h].s.r<r||a[h].s.c<l){u=-1;break}u=a[h].e.r-a[h].s.r+1,d=a[h].e.c-a[h].s.c+1;break}if(!(u<0)){var m=Gt({r,c:l}),x=s.dense?(e[r]||[])[l]:e[m],y=x&&x.v!=null&&(x.h||Uv(x.w||(Si(x),x.w)||""))||"",v={};u>1&&(v.rowspan=u),d>1&&(v.colspan=d),s.editable?y='<span contenteditable="true">'+y+"</span>":x&&(v["data-t"]=x&&x.t||"z",x.v!=null&&(v["data-v"]=x.v),x.z!=null&&(v["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+x.l.Target+'">'+y+"</a>")),v.id=(s.id||"sjs")+"-"+m,o.push(Nt("td",y,v))}}var b="<tr>";return b+o.join("")+"</tr>"}var KJ='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',XJ="</body></html>";function YJ(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return wo(TE(r[0],t),t);var s=pb();return r.forEach(function(a,o){xb(s,TE(a,t),"Sheet"+(o+1))}),s}function JJ(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function $T(e,t){var r=t||{},s=r.header!=null?r.header:KJ,a=r.footer!=null?r.footer:XJ,o=[s],l=ja(e["!ref"]);r.dense=Array.isArray(e),o.push(JJ(e,l,r));for(var u=l.s.r;u<=l.e.r;++u)o.push(VJ(e,l,u,r));return o.push("</table>"+a),o.join("")}function qT(e,t,r){var s=r||{},a=0,o=0;if(s.origin!=null)if(typeof s.origin=="number")a=s.origin;else{var l=typeof s.origin=="string"?es(s.origin):s.origin;a=l.r,o=l.c}var u=t.getElementsByTagName("tr"),d=Math.min(s.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var m=ja(e["!ref"]);h.s.r=Math.min(h.s.r,m.s.r),h.s.c=Math.min(h.s.c,m.s.c),h.e.r=Math.max(h.e.r,m.e.r),h.e.c=Math.max(h.e.c,m.e.c),a==-1&&(h.e.r=a=m.e.r+1)}var x=[],y=0,v=e["!rows"]||(e["!rows"]=[]),b=0,g=0,_=0,w=0,k=0,N=0;for(e["!cols"]||(e["!cols"]=[]);b<u.length&&g<d;++b){var E=u[b];if(AE(E)){if(s.display)continue;v[g]={hidden:!0}}var C=E.children;for(_=w=0;_<C.length;++_){var L=C[_];if(!(s.display&&AE(L))){var O=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):d5(L.innerHTML),B=L.getAttribute("data-z")||L.getAttribute("z");for(y=0;y<x.length;++y){var F=x[y];F.s.c==w+o&&F.s.r<g+a&&g+a<=F.e.r&&(w=F.e.c+1-o,y=-1)}N=+L.getAttribute("colspan")||1,((k=+L.getAttribute("rowspan")||1)>1||N>1)&&x.push({s:{r:g+a,c:w+o},e:{r:g+a+(k||1)-1,c:w+o+(N||1)-1}});var q={t:"s",v:O},fe=L.getAttribute("data-t")||L.getAttribute("t")||"";O!=null&&(O.length==0?q.t=fe||"z":s.raw||O.trim().length==0||fe=="s"||(O==="TRUE"?q={t:"b",v:!0}:O==="FALSE"?q={t:"b",v:!1}:isNaN(jn(O))?isNaN(Xc(O).getDate())||(q={t:"d",v:Gr(O)},s.cellDates||(q={t:"n",v:Rs(q.v)}),q.z=s.dateNF||Wt[14]):q={t:"n",v:jn(O)})),q.z===void 0&&B!=null&&(q.z=B);var D="",V=L.getElementsByTagName("A");if(V&&V.length)for(var I=0;I<V.length&&!(V[I].hasAttribute("href")&&(D=V[I].getAttribute("href"),D.charAt(0)!="#"));++I);D&&D.charAt(0)!="#"&&(q.l={Target:D}),s.dense?(e[g+a]||(e[g+a]=[]),e[g+a][w+o]=q):e[Gt({c:w+o,r:g+a})]=q,h.e.c<w+o&&(h.e.c=w+o),w+=N}}++g}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),h.e.r=Math.max(h.e.r,g-1+a),e["!ref"]=Zt(h),g>=d&&(e["!fullref"]=Zt((h.e.r=u.length-b+g-1+a,h))),e}function HT(e,t){var r=t||{},s=r.dense?[]:{};return qT(s,e,t)}function ZJ(e,t){return wo(HT(e,t),t)}function AE(e){var t="",r=QJ(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function QJ(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function eZ(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=xr(t.replace(/<[^>]*>/g,""));return[r]}var CE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function WT(e,t){var r=t||{},s=zv(e),a=[],o,l,u={name:""},d="",h=0,m,x,y={},v=[],b=r.dense?[]:{},g,_,w={value:""},k="",N=0,E=[],C=-1,L=-1,O={s:{r:1e6,c:1e7},e:{r:0,c:0}},B=0,F={},q=[],fe={},D=0,V=0,I=[],ae=1,Q=1,te=[],ve={Names:[]},ee={},Se=["",""],J=[],M={},Y="",G=0,re=!1,ce=!1,P=0;for(qd.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=qd.exec(s);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(O.e.c>=O.s.c&&O.e.r>=O.s.r?b["!ref"]=Zt(O):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=O.e.r&&(b["!fullref"]=b["!ref"],O.e.r=r.sheetRows-1,b["!ref"]=Zt(O)),q.length&&(b["!merges"]=q),I.length&&(b["!rows"]=I),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),v.push(m.name),y[m.name]=b,ce=!1):g[0].charAt(g[0].length-2)!=="/"&&(m=Kt(g[0],!1),C=L=-1,O.s.r=O.s.c=1e7,O.e.r=O.e.c=0,b=r.dense?[]:{},q=[],I=[],ce=!0);break;case"table-row-group":g[1]==="/"?--B:++B;break;case"table-row":case"":if(g[1]==="/"){C+=ae,ae=1;break}if(x=Kt(g[0],!1),x.?C=x.-1:C==-1&&(C=0),ae=+x["number-rows-repeated"]||1,ae<10)for(P=0;P<ae;++P)B>0&&(I[C+P]={level:B});L=-1;break;case"covered-table-cell":g[1]!=="/"&&++L,r.sheetStubs&&(r.dense?(b[C]||(b[C]=[]),b[C][L]={t:"z"}):b[Gt({r:C,c:L})]={t:"z"}),k="",E=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++L,w=Kt(g[0],!1),Q=parseInt(w["number-columns-repeated"]||"1",10),_={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(_.f=kE(xr(w.formula))),(w.||w["value-type"])=="string"&&(_.t="s",_.v=xr(w["string-value"]||""),r.dense?(b[C]||(b[C]=[]),b[C][L]=_):b[Gt({r:C,c:L})]=_),L+=Q-1;else if(g[1]!=="/"){++L,k="",N=0,E=[],Q=1;var U=ae?C+ae-1:C;if(L>O.e.c&&(O.e.c=L),L<O.s.c&&(O.s.c=L),C<O.s.r&&(O.s.r=C),U>O.e.r&&(O.e.r=U),w=Kt(g[0],!1),J=[],M={},_={t:w.||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=xr(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(D=parseInt(w["number-matrix-rows-spanned"],10)||0,V=parseInt(w["number-matrix-columns-spanned"],10)||0,fe={s:{r:C,c:L},e:{r:C+D-1,c:L+V-1}},_.F=Zt(fe),te.push([fe,_.F])),w.formula)_.f=kE(w.formula);else for(P=0;P<te.length;++P)C>=te[P][0].s.r&&C<=te[P][0].e.r&&L>=te[P][0].s.c&&L<=te[P][0].e.c&&(_.F=te[P][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(D=parseInt(w["number-rows-spanned"],10)||0,V=parseInt(w["number-columns-spanned"],10)||0,fe={s:{r:C,c:L},e:{r:C+D-1,c:L+V-1}},q.push(fe)),w["number-columns-repeated"]&&(Q=parseInt(w["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Hr(w["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(w.value);break;case"percentage":_.t="n",_.v=parseFloat(w.value);break;case"currency":_.t="n",_.v=parseFloat(w.value);break;case"date":_.t="d",_.v=Gr(w["date-value"]),r.cellDates||(_.t="n",_.v=Rs(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=jz(w["time-value"])/86400,r.cellDates&&(_.t="d",_.v=vm(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(w.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",w["string-value"]!=null&&(k=xr(w["string-value"]),E=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(re=!1,_.t==="s"&&(_.v=k||"",E.length&&(_.R=E),re=N==0),ee.Target&&(_.l=ee),J.length>0&&(_.c=J,J=[]),k&&r.cellText!==!1&&(_.w=k),re&&(_.t="z",delete _.v),(!re||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=C))for(var le=0;le<ae;++le){if(Q=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(b[C+le]||(b[C+le]=[]),b[C+le][L]=le==0?_:Vr(_);--Q>0;)b[C+le][L+Q]=Vr(_);else for(b[Gt({r:C+le,c:L})]=_;--Q>0;)b[Gt({r:C+le,c:L+Q})]=Vr(_);O.e.c<=L&&(O.e.c=L)}Q=parseInt(w["number-columns-repeated"]||"1",10),L+=Q-1,Q=0,_={},k="",E=[]}ee={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((o=a.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((o=a.pop())[0]!==g[3])throw"Bad state: "+o;M.t=k,E.length&&(M.R=E),M.a=Y,J.push(M)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);Y="",G=0,k="",N=0,E=[];break;case"creator":g[1]==="/"?Y=s.slice(G,g.index):G=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((o=a.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);k="",N=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(F[u.name]=d,(o=a.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&(d="",u=Kt(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Kt(g[0],!1),d+=CE[g[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Kt(g[0],!1),d+=CE[g[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":d+=s.slice(h,g.index);break}else h=g.index+g[0].length;break;case"named-range":l=Kt(g[0],!1),Se=ay(l["cell-range-address"]);var ne={Name:l.name,Ref:Se[0]+"!"+Se[1]};ce&&(ne.Sheet=v.length),ve.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!w||!w["string-value"])){var ie=eZ(s.slice(N,g.index));k=(k.length>0?k+`
`:"")+ie[0]}else Kt(g[0],!1),N=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{Se=ay(Kt(g[0])["target-range-address"]),y[Se[0]]["!autofilter"]={ref:Se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(ee=Kt(g[0],!1),!ee.href)break;ee.Target=xr(ee.href),delete ee.href,ee.Target.charAt(0)=="#"&&ee.Target.indexOf(".")>-1?(Se=ay(ee.Target.slice(1)),ee.Target="#"+Se[0]+"!"+Se[1]):ee.Target.match(/^\.\.[\\\/]/)&&(ee.Target=ee.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var H={Sheets:y,SheetNames:v,Workbook:ve};return r.bookSheets&&delete H.Sheets,H}function RE(e,t){t=t||{},cn(e,"META-INF/manifest.xml")&&j$(Ss(e,"META-INF/manifest.xml"),t);var r=za(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=WT(Mr(r),t);return cn(e,"meta.xml")&&(s.Props=L5(Ss(e,"meta.xml"))),s}function DE(e,t){return WT(e,t)}var tZ=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+$d({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ys+t}})(),OE=(function(){var e=function(o){return Cr(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(o,l,u){var d=[];d.push('      <table:table table:name="'+Cr(l.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,m=0,x=ja(o["!ref"]||"A1"),y=o["!merges"]||[],v=0,b=Array.isArray(o);if(o["!cols"])for(m=0;m<=x.e.c;++m)d.push("        <table:table-column"+(o["!cols"][m]?' table:style-name="co'+o["!cols"][m].ods+'"':"")+`></table:table-column>
`);var g="",_=o["!rows"]||[];for(h=0;h<x.s.r;++h)g=_[h]?' table:style-name="ro'+_[h].ods+'"':"",d.push("        <table:table-row"+g+`></table:table-row>
`);for(;h<=x.e.r;++h){for(g=_[h]?' table:style-name="ro'+_[h].ods+'"':"",d.push("        <table:table-row"+g+`>
`),m=0;m<x.s.c;++m)d.push(t);for(;m<=x.e.c;++m){var w=!1,k={},N="";for(v=0;v!=y.length;++v)if(!(y[v].s.c>m)&&!(y[v].s.r>h)&&!(y[v].e.c<m)&&!(y[v].e.r<h)){(y[v].s.c!=m||y[v].s.r!=h)&&(w=!0),k["table:number-columns-spanned"]=y[v].e.c-y[v].s.c+1,k["table:number-rows-spanned"]=y[v].e.r-y[v].s.r+1;break}if(w){d.push(r);continue}var E=Gt({r:h,c:m}),C=b?(o[h]||[])[m]:o[E];if(C&&C.f&&(k["table:formula"]=Cr(wK(C.f)),C.F&&C.F.slice(0,E.length)==E)){var L=ja(C.F);k["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,k["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!C){d.push(t);continue}switch(C.t){case"b":N=C.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=C.v?"true":"false";break;case"n":N=C.w||String(C.v||0),k["office:value-type"]="float",k["office:value"]=C.v||0;break;case"s":case"str":N=C.v==null?"":C.v,k["office:value-type"]="string";break;case"d":N=C.w||Gr(C.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Gr(C.v).toISOString(),k["table:style-name"]="ce1";break;default:d.push(t);continue}var O=e(N);if(C.l&&C.l.Target){var B=C.l.Target;B=B.charAt(0)=="#"?"#"+_K(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),O=Nt("text:a",O,{"xlink:href":B.replace(/&/g,"&amp;")})}d.push("          "+Nt("table:table-cell",Nt("text:p",O,{}),k)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},a=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(h){return l.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var m=0;m<h["!cols"].length;++m)if(h["!cols"][m]){var x=h["!cols"][m];if(x.width==null&&x.wpx==null&&x.wch==null)continue;po(x),x.ods=u;var y=h["!cols"][m].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),o.push(`  </style:style>
`),++u}}});var d=0;l.SheetNames.map(function(h){return l.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var m=0;m<h["!rows"].length;++m)if(h["!rows"][m]){h["!rows"][m].ods=d;var x=h["!rows"][m].hpx+"px";o.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),o.push(`  </style:style>
`),++d}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,u){var d=[ys],h=$d({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=$d({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(d.push("<office:document"+h+m+`>
`),d.push(F5().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+h+`>
`),a(d,l),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var x=0;x!=l.SheetNames.length;++x)d.push(s(l.Sheets[l.SheetNames[x]],l,x));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),u.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function GT(e,t){if(t.bookType=="fods")return OE(e,t);var r=Mv(),s="",a=[],o=[];return s="mimetype",er(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",er(r,s,OE(e,t)),a.push([s,"text/xml"]),o.push([s,"ContentFile"]),s="styles.xml",er(r,s,tZ(e,t)),a.push([s,"text/xml"]),o.push([s,"StylesFile"]),s="meta.xml",er(r,s,ys+F5()),a.push([s,"text/xml"]),o.push([s,"MetadataFile"]),s="manifest.rdf",er(r,s,C$(o)),a.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",er(r,s,T$(a)),r}function xl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Xy(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Mr(bo(e))}function rZ(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ua(zn(e))}function sZ(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function go(e){var t=e.reduce(function(a,o){return a+o.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(a){r.set(a,s),s+=a.length}),r}function FE(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function aZ(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,a=t+13;a>=t;--a)s=s*256+e[a];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function nZ(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var o=0;a>=1;++o,a/=256)e[t+o]=a&255;e[t+15]|=r>=0?0:128}function Yd(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function Tr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function os(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function wr(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],a=Yd(e,r),o=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(o){case 0:{for(var d=r[0];e[r[0]++]>=128;);u=e.slice(d,r[0])}break;case 5:l=4,u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Yd(e,r),u=e.slice(r[0],r[0]+l),r[0]+=l;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(s))}var h={data:u,type:o};t[a]==null?t[a]=[h]:t[a].push(h)}return t}function Hs(e){var t=[];return e.forEach(function(r,s){r.forEach(function(a){a.data&&(t.push(Tr(s*8+a.type)),a.type==2&&t.push(Tr(a.data.length)),t.push(a.data))})}),go(t)}function ub(e,t){return e?.map(function(r){return t(r.data)})||[]}function on(e){for(var t,r=[],s=[0];s[0]<e.length;){var a=Yd(e,s),o=wr(e.slice(s[0],s[0]+a));s[0]+=a;var l={id:os(o[1][0].data),messages:[]};o[2].forEach(function(u){var d=wr(u.data),h=os(d[3][0].data);l.messages.push({meta:d,data:e.slice(s[0],s[0]+h)}),s[0]+=h}),(t=o[3])!=null&&t[0]&&(l.merge=os(o[3][0].data)>>>0>0),r.push(l)}return r}function yc(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:Tr(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:Tr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Tr(l.data.length)}],s[2].push({data:Hs(l.meta),type:2})});var o=Hs(s);t.push(Tr(o.length)),t.push(o),a.forEach(function(l){return t.push(l)})}),go(t)}function iZ(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=Yd(t,r),a=[];r[0]<t.length;){var o=t[r[0]]&3;if(o==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=t[r[0]],u>1&&(l|=t[r[0]+1]<<8),u>2&&(l|=t[r[0]+2]<<16),u>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}a.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var d=0,h=0;if(o==1?(h=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(h=(t[r[0]++]>>2)+1,o==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[go(a)],d==0)throw new Error("Invalid offset 0");if(d>a[0].length)throw new Error("Invalid offset beyond length");if(h>=d)for(a.push(a[0].slice(-d)),h-=d;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-d,-d+h))}}var m=go(a);if(m.length!=s)throw new Error("Unexpected length: ".concat(m.length," != ").concat(s));return m}function ln(e){for(var t=[],r=0;r<e.length;){var s=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(iZ(s,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return go(t)}function vc(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var o=Tr(s),l=o.length;t.push(o),s<=60?(l++,t.push(new Uint8Array([s-1<<2]))):s<=256?(l+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(l+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(l+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(l+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),l+=s,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=s}return go(t)}function oZ(e,t,r,s){var a=xl(e),o=a.getUint32(4,!0),l=(s>1?12:8)+FE(o&(s>1?3470:398))*4,u=-1,d=-1,h=NaN,m=new Date(2001,0,1);o&512&&(u=a.getUint32(l,!0),l+=4),l+=FE(o&(s>1?12288:4096))*4,o&16&&(d=a.getUint32(l,!0),l+=4),o&32&&(h=a.getFloat64(l,!0),l+=8),o&64&&(m.setTime(m.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:t[d]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(d>-1)x={t:"s",v:t[d]};else if(!isNaN(h))x={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function lZ(e,t,r){var s=xl(e),a=s.getUint32(8,!0),o=12,l=-1,u=-1,d=NaN,h=NaN,m=new Date(2001,0,1);a&1&&(d=aZ(e,o),o+=16),a&2&&(h=s.getFloat64(o,!0),o+=8),a&4&&(m.setTime(m.getTime()+s.getFloat64(o,!0)*1e3),o+=8),a&8&&(u=s.getUint32(o,!0),o+=4),a&16&&(l=s.getUint32(o,!0),o+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:t[u]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(l>-1)x={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return x}function iy(e,t){var r=new Uint8Array(32),s=xl(r),a=12,o=0;switch(r[0]=5,e.t){case"n":r[1]=2,nZ(r,a,e.v),o|=1,a+=16;break;case"b":r[1]=6,s.setFloat64(a,e.v?1:0,!0),o|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(a,t.indexOf(e.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,o,!0),r.slice(0,a)}function oy(e,t){var r=new Uint8Array(32),s=xl(r),a=12,o=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(a,e.v,!0),o|=32,a+=8;break;case"b":r[2]=6,s.setFloat64(a,e.v?1:0,!0),o|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(a,t.indexOf(e.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,o,!0),r.slice(0,a)}function cZ(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return oZ(e,t,r,e[0]);case 5:return lZ(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ea(e){var t=wr(e);return Yd(t[1][0].data)}function LE(e,t){var r=wr(t.data),s=os(r[1][0].data),a=r[3],o=[];return(a||[]).forEach(function(l){var u=wr(l.data),d=os(u[1][0].data)>>>0;switch(s){case 1:o[d]=Xy(u[3][0].data);break;case 8:{var h=e[ea(u[9][0].data)][0],m=wr(h.data),x=e[ea(m[1][0].data)][0],y=os(x.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var v=wr(x.data);o[d]=v[3].map(function(b){return Xy(b.data)}).join("")}break}}),o}function uZ(e,t){var r,s,a,o,l,u,d,h,m,x,y,v,b,g,_=wr(e),w=os(_[1][0].data)>>>0,k=os(_[2][0].data)>>>0,N=((s=(r=_[8])==null?void 0:r[0])==null?void 0:s.data)&&os(_[8][0].data)>0||!1,E,C;if((o=(a=_[7])==null?void 0:a[0])!=null&&o.data&&t!=0)E=(u=(l=_[7])==null?void 0:l[0])==null?void 0:u.data,C=(h=(d=_[6])==null?void 0:d[0])==null?void 0:h.data;else if((x=(m=_[4])==null?void 0:m[0])!=null&&x.data&&t!=1)E=(v=(y=_[4])==null?void 0:y[0])==null?void 0:v.data,C=(g=(b=_[3])==null?void 0:b[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var L=N?4:1,O=xl(E),B=[],F=0;F<E.length/2;++F){var q=O.getUint16(F*2,!0);q<65535&&B.push([F,q])}if(B.length!=k)throw"Expected ".concat(k," cells, found ").concat(B.length);var fe=[];for(F=0;F<B.length-1;++F)fe[B[F][0]]=C.subarray(B[F][1]*L,B[F+1][1]*L);return B.length>=1&&(fe[B[B.length-1][0]]=C.subarray(B[B.length-1][1]*L)),{R:w,cells:fe}}function dZ(e,t){var r,s=wr(t.data),a=(r=s?.[7])!=null&&r[0]?os(s[7][0].data)>>>0>0?1:0:-1,o=ub(s[5],function(l){return uZ(l,a)});return{nrows:os(s[4][0].data)>>>0,data:o.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(d,h){if(l[u.R][h])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(h));l[u.R][h]=d}),l},[])}}function fZ(e,t,r){var s,a=wr(t.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(os(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(os(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Zt(o);var l=wr(a[4][0].data),u=LE(e,e[ea(l[4][0].data)][0]),d=(s=l[17])!=null&&s[0]?LE(e,e[ea(l[17][0].data)][0]):[],h=wr(l[3][0].data),m=0;h[1].forEach(function(x){var y=wr(x.data),v=e[ea(y[2][0].data)][0],b=os(v.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var g=dZ(e,v);g.data.forEach(function(_,w){_.forEach(function(k,N){var E=Gt({r:m+w,c:N}),C=cZ(k,u,d);C&&(r[E]=C)})}),m+=g.nrows})}function hZ(e,t){var r=wr(t.data),s={"!ref":"A1"},a=e[ea(r[2][0].data)],o=os(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return fZ(e,a[0],s),s}function mZ(e,t){var r,s=wr(t.data),a={name:(r=s[1])!=null&&r[0]?Xy(s[1][0].data):"",sheets:[]},o=ub(s[2],ea);return o.forEach(function(l){e[l].forEach(function(u){var d=os(u.meta[1][0].data);d==6e3&&a.sheets.push(hZ(e,u))})}),a}function pZ(e,t){var r=pb(),s=wr(t.data),a=ub(s[1],ea);if(a.forEach(function(o){e[o].forEach(function(l){var u=os(l.meta[1][0].data);if(u==2){var d=mZ(e,l);d.sheets.forEach(function(h,m){xb(r,h,m==0?d.name:d.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ly(e){var t,r,s,a,o={},l=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var h;try{h=ln(d.content)}catch(x){return console.log("?? "+d.content.length+" "+(x.message||x))}var m;try{m=on(h)}catch(x){return console.log("## "+(x.message||x))}m.forEach(function(x){o[x.id]=x.messages,l.push(x.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(s=(r=(t=o?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:a[0].data)&&os(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||l.forEach(function(d){o[d].forEach(function(h){var m=os(h.meta[1][0].data)>>>0;if(m==1)if(!u)u=h;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return pZ(o,u)}function xZ(e,t,r){var s,a,o,l;if(!((s=e[6])!=null&&s[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(o=e[8])==null?void 0:o[0])==null?void 0:l.data)&&os(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var d=0,h=xl(e[7][0].data),m=0,x=[],y=xl(e[4][0].data),v=0,b=[],g=0;g<t.length;++g){if(t[g]==null){h.setUint16(g*2,65535,!0),y.setUint16(g*2,65535);continue}h.setUint16(g*2,m,!0),y.setUint16(g*2,v,!0);var _,w;switch(typeof t[g]){case"string":_=iy({t:"s",v:t[g]},r),w=oy({t:"s",v:t[g]},r);break;case"number":_=iy({t:"n",v:t[g]},r),w=oy({t:"n",v:t[g]},r);break;case"boolean":_=iy({t:"b",v:t[g]},r),w=oy({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}x.push(_),m+=_.length,b.push(w),v+=w.length,++d}for(e[2][0].data=Tr(d);g<e[7][0].data.length/2;++g)h.setUint16(g*2,65535,!0),y.setUint16(g*2,65535,!0);return e[6][0].data=go(x),e[3][0].data=go(b),d}function gZ(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=ja(r["!ref"]);s.s.r=s.s.c=0;var a=!1;s.e.c>9&&(a=!0,s.e.c=9),s.e.r>49&&(a=!0,s.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Zt(s)));var o=K0(r,{range:s,header:1}),l=["~Sh33tJ5~"];o.forEach(function(Y){return Y.forEach(function(G){typeof G=="string"&&l.push(G)})});var u={},d=[],h=Pt.read(t.numbers,{type:"base64"});h.FileIndex.map(function(Y,G){return[Y,h.FullPaths[G]]}).forEach(function(Y){var G=Y[0],re=Y[1];if(G.type==2&&G.name.match(/\.iwa/)){var ce=G.content,P=ln(ce),U=on(P);U.forEach(function(le){d.push(le.id),u[le.id]={deps:[],location:re,type:os(le.messages[0].meta[1][0].data)}})}}),d.sort(function(Y,G){return Y-G});var m=d.filter(function(Y){return Y>1}).map(function(Y){return[Y,Tr(Y)]});h.FileIndex.map(function(Y,G){return[Y,h.FullPaths[G]]}).forEach(function(Y){var G=Y[0];if(Y[1],!!G.name.match(/\.iwa/)){var re=on(ln(G.content));re.forEach(function(ce){ce.messages.forEach(function(P){m.forEach(function(U){ce.messages.some(function(le){return os(le.meta[1][0].data)!=11006&&sZ(le.data,U[1])})&&u[U[0]].deps.push(ce.id)})})})}});for(var x=Pt.find(h,u[1].location),y=on(ln(x.content)),v,b=0;b<y.length;++b){var g=y[b];g.id==1&&(v=g)}var _=ea(wr(v.messages[0].data)[1][0].data);for(x=Pt.find(h,u[_].location),y=on(ln(x.content)),b=0;b<y.length;++b)g=y[b],g.id==_&&(v=g);for(_=ea(wr(v.messages[0].data)[2][0].data),x=Pt.find(h,u[_].location),y=on(ln(x.content)),b=0;b<y.length;++b)g=y[b],g.id==_&&(v=g);for(_=ea(wr(v.messages[0].data)[2][0].data),x=Pt.find(h,u[_].location),y=on(ln(x.content)),b=0;b<y.length;++b)g=y[b],g.id==_&&(v=g);var w=wr(v.messages[0].data);{w[6][0].data=Tr(s.e.r+1),w[7][0].data=Tr(s.e.c+1);var k=ea(w[46][0].data),N=Pt.find(h,u[k].location),E=on(ln(N.content));{for(var C=0;C<E.length&&E[C].id!=k;++C);if(E[C].id!=k)throw"Bad ColumnRowUIDMapArchive";var L=wr(E[C].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var O=0;O<=s.e.c;++O){var B=[];B[1]=B[2]=[{type:0,data:Tr(O+420690)}],L[1].push({type:2,data:Hs(B)}),L[2].push({type:0,data:Tr(O)}),L[3].push({type:0,data:Tr(O)})}L[4]=[],L[5]=[],L[6]=[];for(var F=0;F<=s.e.r;++F)B=[],B[1]=B[2]=[{type:0,data:Tr(F+726270)}],L[4].push({type:2,data:Hs(B)}),L[5].push({type:0,data:Tr(F)}),L[6].push({type:0,data:Tr(F)});E[C].messages[0].data=Hs(L)}N.content=vc(yc(E)),N.size=N.content.length,delete w[46];var q=wr(w[4][0].data);{q[7][0].data=Tr(s.e.r+1);var fe=wr(q[1][0].data),D=ea(fe[2][0].data);N=Pt.find(h,u[D].location),E=on(ln(N.content));{if(E[0].id!=D)throw"Bad HeaderStorageBucket";var V=wr(E[0].messages[0].data);for(F=0;F<o.length;++F){var I=wr(V[2][0].data);I[1][0].data=Tr(F),I[4][0].data=Tr(o[F].length),V[2][F]={type:V[2][0].type,data:Hs(I)}}E[0].messages[0].data=Hs(V)}N.content=vc(yc(E)),N.size=N.content.length;var ae=ea(q[2][0].data);N=Pt.find(h,u[ae].location),E=on(ln(N.content));{if(E[0].id!=ae)throw"Bad HeaderStorageBucket";for(V=wr(E[0].messages[0].data),O=0;O<=s.e.c;++O)I=wr(V[2][0].data),I[1][0].data=Tr(O),I[4][0].data=Tr(s.e.r+1),V[2][O]={type:V[2][0].type,data:Hs(I)};E[0].messages[0].data=Hs(V)}N.content=vc(yc(E)),N.size=N.content.length;var Q=ea(q[4][0].data);(function(){for(var Y=Pt.find(h,u[Q].location),G=on(ln(Y.content)),re,ce=0;ce<G.length;++ce){var P=G[ce];P.id==Q&&(re=P)}var U=wr(re.messages[0].data);{U[3]=[];var le=[];l.forEach(function(H,K){le[1]=[{type:0,data:Tr(K)}],le[2]=[{type:0,data:Tr(1)}],le[3]=[{type:2,data:rZ(H)}],U[3].push({type:2,data:Hs(le)})})}re.messages[0].data=Hs(U);var ne=yc(G),ie=vc(ne);Y.content=ie,Y.size=Y.content.length})();var te=wr(q[3][0].data);{var ve=te[1][0];delete te[2];var ee=wr(ve.data);{var Se=ea(ee[2][0].data);(function(){for(var Y=Pt.find(h,u[Se].location),G=on(ln(Y.content)),re,ce=0;ce<G.length;++ce){var P=G[ce];P.id==Se&&(re=P)}var U=wr(re.messages[0].data);{delete U[6],delete te[7];var le=new Uint8Array(U[5][0].data);U[5]=[];for(var ne=0,ie=0;ie<=s.e.r;++ie){var H=wr(le);ne+=xZ(H,o[ie],l),H[1][0].data=Tr(ie),U[5].push({data:Hs(H),type:2})}U[1]=[{type:0,data:Tr(s.e.c+1)}],U[2]=[{type:0,data:Tr(s.e.r+1)}],U[3]=[{type:0,data:Tr(ne)}],U[4]=[{type:0,data:Tr(s.e.r+1)}]}re.messages[0].data=Hs(U);var K=yc(G),S=vc(K);Y.content=S,Y.size=Y.content.length})()}ve.data=Hs(ee)}q[3][0].data=Hs(te)}w[4][0].data=Hs(q)}v.messages[0].data=Hs(w);var J=yc(y),M=vc(J);return x.content=M,x.size=x.content.length,h}function VT(e){return function(r){for(var s=0;s!=e.length;++s){var a=e[s];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function db(e){VT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function fb(e){VT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function yZ(e){return ir.WS.indexOf(e)>-1?"sheet":e==ir.CS?"chart":e==ir.DS?"dialog":e==ir.MS?"macro":e&&e.length?e:"sheet"}function vZ(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,yZ(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function bZ(e,t,r,s,a,o,l,u,d,h,m,x){try{o[s]=bd(za(e,r,!0),t);var y=Ss(e,t),v;switch(u){case"sheet":v=$Y(y,t,a,d,o[s],h,m,x);break;case"chart":if(v=qY(y,t,a,d,o[s],h,m,x),!v||!v["!drawel"])break;var b=fd(v["!drawel"].Target,t),g=Hd(b),_=AG(za(e,b,!0),bd(za(e,g,!0),b)),w=fd(_,b),k=Hd(w);v=xY(za(e,w,!0),w,d,bd(za(e,k,!0),w),h,v);break;case"macro":v=HY(y,t,a,d,o[s],h,m,x);break;case"dialog":v=WY(y,t,a,d,o[s],h,m,x);break;default:throw new Error("Unrecognized sheet type "+u)}l[s]=v;var N=[];o&&o[s]&&ls(o[s]).forEach(function(E){var C="";if(o[s][E].Type==ir.CMNT){C=fd(o[s][E].Target,t);var L=XY(Ss(e,C,!0),C,d);if(!L||!L.length)return;bE(v,L,!1)}o[s][E].Type==ir.TCMNT&&(C=fd(o[s][E].Target,t),N=N.concat(RG(Ss(e,C,!0),d)))}),N&&N.length&&bE(v,N,!0,d.people||[])}catch(E){if(d.WTF)throw E}}function an(e){return e.charAt(0)=="/"?e.slice(1):e}function wZ(e,t){if(nu(),t=t||{},db(t),cn(e,"META-INF/manifest.xml")||cn(e,"objectdata.xml"))return RE(e,t);if(cn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ly<"u"){if(e.FileIndex)return ly(e);var r=Pt.utils.cfb_new();return zk(e).forEach(function(I){er(r,I,Dz(e,I))}),ly(r)}throw new Error("Unsupported NUMBERS file")}if(!cn(e,"[Content_Types].xml"))throw cn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):cn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=zk(e),a=k$(za(e,"[Content_Types].xml")),o=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",Ss(e,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!Ss(e,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var d={},h={};if(!t.bookSheets&&!t.bookProps){if(wd=[],a.sst)try{wd=KY(Ss(e,an(a.sst)),a.sst,t)}catch(I){if(t.WTF)throw I}t.cellStyles&&a.themes.length&&(d=VY(za(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(h=GY(Ss(e,an(a.style)),a.style,d,t))}a.links.map(function(I){try{var ae=bd(za(e,Hd(an(I))),I);return JY(Ss(e,an(I)),ae,I,t)}catch{}});var m=zY(Ss(e,an(a.workbooks[0])),a.workbooks[0],t),x={},y="";a.coreprops.length&&(y=Ss(e,an(a.coreprops[0]),!0),y&&(x=L5(y)),a.extprops.length!==0&&(y=Ss(e,an(a.extprops[0]),!0),y&&D$(y,x,t)));var v={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(y=za(e,an(a.custprops[0]),!0),y&&(v=F$(y,t)));var b={};if((t.bookSheets||t.bookProps)&&(m.Sheets?l=m.Sheets.map(function(ae){return ae.name}):x.Worksheets&&x.SheetNames.length>0&&(l=x.SheetNames),t.bookProps&&(b.Props=x,b.Custprops=v),t.bookSheets&&typeof l<"u"&&(b.SheetNames=l),t.bookSheets?b.SheetNames:t.bookProps))return b;l={};var g={};t.bookDeps&&a.calcchain&&(g=YY(Ss(e,an(a.calcchain)),a.calcchain));var _=0,w={},k,N;{var E=m.Sheets;x.Worksheets=E.length,x.SheetNames=[];for(var C=0;C!=E.length;++C)x.SheetNames[C]=E[C].name}var L=o?"bin":"xml",O=a.workbooks[0].lastIndexOf("/"),B=(a.workbooks[0].slice(0,O+1)+"_rels/"+a.workbooks[0].slice(O+1)+".rels").replace(/^\//,"");cn(e,B)||(B="xl/_rels/workbook."+L+".rels");var F=bd(za(e,B,!0),B.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=ZY(Ss(e,an(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=OG(Ss(e,an(a.people[0])),t)),F&&(F=vZ(F,m.Sheets));var q=Ss(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=x.Worksheets;++_){var fe="sheet";if(F&&F[_]?(k="xl/"+F[_][1].replace(/[\/]?xl\//,""),cn(e,k)||(k=F[_][1]),cn(e,k)||(k=B.replace(/_rels\/.*$/,"")+F[_][1]),fe=F[_][2]):(k="xl/worksheets/sheet"+(_+1-q)+"."+L,k=k.replace(/sheet0\./,"sheet.")),N=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(x.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,V=0;V!=t.sheets.length;++V)typeof t.sheets[V]=="number"&&t.sheets[V]==_&&(D=1),typeof t.sheets[V]=="string"&&t.sheets[V].toLowerCase()==x.SheetNames[_].toLowerCase()&&(D=1);if(!D)continue e}}bZ(e,k,N,x.SheetNames[_],_,w,l,fe,t,m,d,h)}return b={Directory:a,Workbook:m,Props:x,Custprops:v,Deps:g,Sheets:l,SheetNames:x.SheetNames,Strings:wd,Styles:h,Themes:d,SSF:Vr(Wt)},t&&t.bookFiles&&(e.files?(b.keys=s,b.files=e.files):(b.keys=[],b.files={},e.FullPaths.forEach(function(I,ae){I=I.replace(/^Root Entry[\/]/,""),b.keys.push(I),b.files[I]=e.FileIndex[ae]}))),t&&t.bookVBA&&(a.vba.length>0?b.vbaraw=Ss(e,an(a.vba[0]),!0):a.defaults&&a.defaults.bin===zG&&(b.vbaraw=Ss(e,"xl/vbaProject.bin",!0))),b}function _Z(e,t){var r=t||{},s="Workbook",a=Pt.find(e,s);try{if(s="/!DataSpaces/Version",a=Pt.find(e,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(ZH(a.content),s="/!DataSpaces/DataSpaceMap",a=Pt.find(e,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=eW(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Pt.find(e,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=tW(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Pt.find(e,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);sW(a.content)}catch{}if(s="/EncryptionInfo",a=Pt.find(e,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);var u=aW(a.content);if(s="/EncryptedPackage",a=Pt.find(e,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function NZ(e,t){return t.bookType=="ods"?GT(e,t):t.bookType=="numbers"?gZ(e,t):t.bookType=="xlsb"?SZ(e,t):kZ(e,t)}function SZ(e,t){Ac=1024,e&&!e.SSF&&(e.SSF=Vr(Wt)),e&&e.SSF&&(nu(),xm(e.SSF),t.revssf=ym(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,_d?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=bT.indexOf(t.bookType)>-1,a=Jv();fb(t=t||{});var o=Mv(),l="",u=0;if(t.cellXfs=[],_o(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",er(o,l,I5(e.Props,t)),a.coreprops.push(l),Ar(t.rels,2,l,ir.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,er(o,l,P5(e.Props)),a.extprops.push(l),Ar(t.rels,3,l,ir.EXT_PROPS),e.Custprops!==e.Props&&ls(e.Custprops||{}).length>0&&(l="docProps/custom.xml",er(o,l,U5(e.Custprops)),a.custprops.push(l),Ar(t.rels,4,l,ir.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var m={"!id":{}},x=e.Sheets[e.SheetNames[u-1]],y=(x||{})["!type"]||"sheet";if(l="xl/worksheets/sheet"+u+"."+r,er(o,l,eJ(u-1,l,t,e,m)),a.sheets.push(l),Ar(t.wbrels,-1,"worksheets/sheet"+u+"."+r,ir.WS[0]),x){var v=x["!comments"],b=!1,g="";v&&v.length>0&&(g="xl/comments"+u+"."+r,er(o,g,sJ(v,g)),a.comments.push(g),Ar(m,-1,"../comments"+u+"."+r,ir.CMNT),b=!0),x["!legacy"]&&b&&er(o,"xl/drawings/vmlDrawing"+u+".vml",yT(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&er(o,Hd(l),Bc(m))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,er(o,l,rJ(t.Strings,l,t)),a.strs.push(l),Ar(t.wbrels,-1,"sharedStrings."+r,ir.SST)),l="xl/workbook."+r,er(o,l,QY(e,l)),a.workbooks.push(l),Ar(t.rels,1,l,ir.WB),l="xl/theme/theme1.xml",er(o,l,sb(e.Themes,t)),a.themes.push(l),Ar(t.wbrels,-1,"theme/theme1.xml",ir.THEME),l="xl/styles."+r,er(o,l,tJ(e,l,t)),a.styles.push(l),Ar(t.wbrels,-1,"styles."+r,ir.STY),e.vbaraw&&s&&(l="xl/vbaProject.bin",er(o,l,e.vbaraw),a.vba.push(l),Ar(t.wbrels,-1,"vbaProject.bin",ir.VBA)),l="xl/metadata."+r,er(o,l,aJ(l)),a.metadata.push(l),Ar(t.wbrels,-1,"metadata."+r,ir.XLMETA),er(o,"[Content_Types].xml",O5(a,t)),er(o,"_rels/.rels",Bc(t.rels)),er(o,"xl/_rels/workbook."+r+".rels",Bc(t.wbrels)),delete t.revssf,delete t.ssf,o}function kZ(e,t){Ac=1024,e&&!e.SSF&&(e.SSF=Vr(Wt)),e&&e.SSF&&(nu(),xm(e.SSF),t.revssf=ym(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,_d?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=bT.indexOf(t.bookType)>-1,a=Jv();fb(t=t||{});var o=Mv(),l="",u=0;if(t.cellXfs=[],_o(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",er(o,l,I5(e.Props,t)),a.coreprops.push(l),Ar(t.rels,2,l,ir.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,er(o,l,P5(e.Props)),a.extprops.push(l),Ar(t.rels,3,l,ir.EXT_PROPS),e.Custprops!==e.Props&&ls(e.Custprops||{}).length>0&&(l="docProps/custom.xml",er(o,l,U5(e.Custprops)),a.custprops.push(l),Ar(t.rels,4,l,ir.CUST_PROPS));var m=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var x={"!id":{}},y=e.Sheets[e.SheetNames[u-1]],v=(y||{})["!type"]||"sheet";if(l="xl/worksheets/sheet"+u+"."+r,er(o,l,RT(u-1,t,e,x)),a.sheets.push(l),Ar(t.wbrels,-1,"worksheets/sheet"+u+"."+r,ir.WS[0]),y){var b=y["!comments"],g=!1,_="";if(b&&b.length>0){var w=!1;b.forEach(function(k){k[1].forEach(function(N){N.T==!0&&(w=!0)})}),w&&(_="xl/threadedComments/threadedComment"+u+"."+r,er(o,_,DG(b,m,t)),a.threadedcomments.push(_),Ar(x,-1,"../threadedComments/threadedComment"+u+"."+r,ir.TCMNT)),_="xl/comments"+u+"."+r,er(o,_,vT(b)),a.comments.push(_),Ar(x,-1,"../comments"+u+"."+r,ir.CMNT),g=!0}y["!legacy"]&&g&&er(o,"xl/drawings/vmlDrawing"+u+".vml",yT(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}x["!id"].rId1&&er(o,Hd(l),Bc(x))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,er(o,l,iT(t.Strings,t)),a.strs.push(l),Ar(t.wbrels,-1,"sharedStrings."+r,ir.SST)),l="xl/workbook."+r,er(o,l,IT(e)),a.workbooks.push(l),Ar(t.rels,1,l,ir.WB),l="xl/theme/theme1.xml",er(o,l,sb(e.Themes,t)),a.themes.push(l),Ar(t.wbrels,-1,"theme/theme1.xml",ir.THEME),l="xl/styles."+r,er(o,l,mT(e,t)),a.styles.push(l),Ar(t.wbrels,-1,"styles."+r,ir.STY),e.vbaraw&&s&&(l="xl/vbaProject.bin",er(o,l,e.vbaraw),a.vba.push(l),Ar(t.wbrels,-1,"vbaProject.bin",ir.VBA)),l="xl/metadata."+r,er(o,l,gT()),a.metadata.push(l),Ar(t.wbrels,-1,"metadata."+r,ir.XLMETA),m.length>1&&(l="xl/persons/person.xml",er(o,l,FG(m)),a.people.push(l),Ar(t.wbrels,-1,"persons/person.xml",ir.PEOPLE)),er(o,"[Content_Types].xml",O5(a,t)),er(o,"_rels/.rels",Bc(t.rels)),er(o,"xl/_rels/workbook."+r+".rels",Bc(t.wbrels)),delete t.revssf,delete t.ssf,o}function hb(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=qa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function EZ(e,t){return Pt.find(e,"EncryptedPackage")?_Z(e,t):UT(e,t)}function jZ(e,t){var r,s=e,a=t||{};return a.type||(a.type=ar&&Buffer.isBuffer(e)?"buffer":"base64"),r=l5(s,a),wZ(r,a)}function KT(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Vy(e.slice(r),t);default:break e}return Yc.to_workbook(e,t)}function TZ(e,t){var r="",s=hb(e,t);switch(t.type){case"base64":r=qa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=fl(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=Mr(r)),t.type="binary",KT(r,t)}function AZ(e,t){var r=e;return t.type=="base64"&&(r=qa(r)),r=Bd.utils.decode(1200,r.slice(2),"str"),t.type="binary",KT(r,t)}function CZ(e){return e.match(/[^\x00-\x7F]/)?zn(e):e}function cy(e,t,r,s){return s?(r.type="string",Yc.to_workbook(e,r)):Yc.to_workbook(t,r)}function Zc(e,t){Dv();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Zc(new Uint8Array(e),(r=Vr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,a=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Uc={},r.dateNF&&(Uc.dateNF=r.dateNF),r.type||(r.type=ar&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ar?"buffer":"binary",s=Sz(e),typeof Uint8Array<"u"&&!ar&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,s=CZ(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=Vr(r),r.type="array",Zc(Ov(s),r)}switch((a=hb(s,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return EZ(Pt.read(s,r),r);break;case 9:if(a[1]<=8)return UT(s,r);break;case 60:return Vy(s,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return LH(s,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return aT.to_workbook(s,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?jZ(s,r):cy(e,s,r,o);case 239:return a[3]===60?Vy(s,r):cy(e,s,r,o);case 255:if(a[1]===254)return AZ(s,r);if(a[1]===0&&a[2]===2&&a[3]===0)return nl.to_workbook(s,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return nl.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return Gy.to_workbook(s,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return dT.to_workbook(s,r);break;case 10:case 13:case 32:return TZ(s,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return FH.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Gy.to_workbook(s,r):cy(e,s,r,o)}function XT(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return uf(t.file,Pt.write(e,{type:ar?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Pt.write(e,t)}function RZ(e,t){var r=Vr(t||{}),s=NZ(e,r);return DZ(s,r)}function DZ(e,t){var r={},s=ar?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Pt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(pm(a))}return t.password&&typeof encrypt_agile<"u"?XT(encrypt_agile(a,t.password),t):t.type==="file"?uf(t.file,a):t.type=="string"?Mr(a):a}function OZ(e,t){var r=t||{},s=CJ(e,r);return XT(s,r)}function In(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return Pd(zn(s));case"binary":return zn(s);case"string":return e;case"file":return uf(t.file,s,"utf8");case"buffer":return ar?Ri(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):In(s,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function FZ(e,t){switch(t.type){case"base64":return Pd(e);case"binary":return e;case"string":return e;case"file":return uf(t.file,e,"binary");case"buffer":return ar?Ri(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function i0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?Pd(r):t.type=="string"?Mr(r):r;case"file":return uf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function YT(e,t){Dv(),EY(e);var r=Vr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=YT(e,r);return r.type="array",pm(s)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return In(NJ(e,r),r);case"slk":case"sylk":return In(sT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return In($T(e.Sheets[e.SheetNames[a]],r),r);case"txt":return FZ(JT(e.Sheets[e.SheetNames[a]],r),r);case"csv":return In(mb(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return In(aT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return i0(Gy.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return In(Yc.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return In(dT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return In(nT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return In(GT(e,r),r);case"wk1":return i0(nl.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return i0(nl.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),i0(zT(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),OZ(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return RZ(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function LZ(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function gl(e,t,r){var s=r||{};return s.type="file",s.file=t,LZ(s),YT(e,s)}function IZ(e,t,r,s,a,o,l,u){var d=xs(r),h=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,y=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!l||e[r])for(var v=t.s.c;v<=t.e.c;++v){var b=l?e[r][v]:e[s[v]+d];if(b===void 0||b.t===void 0){if(h===void 0)continue;o[v]!=null&&(y[o[v]]=h);continue}var g=b.v;switch(b.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(o[v]!=null){if(g==null)if(b.t=="e"&&g===null)y[o[v]]=null;else if(h!==void 0)y[o[v]]=h;else if(m&&g===null)y[o[v]]=null;else continue;else y[o[v]]=m&&(b.t!=="n"||b.t==="n"&&u.rawNumbers!==!1)?g:Si(b,g,u);g!=null&&(x=!1)}}return{row:y,isempty:x}}function K0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,a=1,o=[],l=0,u="",d={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},m=h.range!=null?h.range:e["!ref"];switch(h.header===1?s=1:h.header==="A"?s=2:Array.isArray(h.header)?s=3:h.header==null&&(s=0),typeof m){case"string":d=gr(m);break;case"number":d=gr(e["!ref"]),d.s.r=m;break;default:d=m}s>0&&(a=0);var x=xs(d.s.r),y=[],v=[],b=0,g=0,_=Array.isArray(e),w=d.s.r,k=0,N={};_&&!e[w]&&(e[w]=[]);var E=h.skipHidden&&e["!cols"]||[],C=h.skipHidden&&e["!rows"]||[];for(k=d.s.c;k<=d.e.c;++k)if(!(E[k]||{}).hidden)switch(y[k]=Qr(k),r=_?e[w][k]:e[y[k]+x],s){case 1:o[k]=k-d.s.c;break;case 2:o[k]=y[k];break;case 3:o[k]=h.header[k-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=Si(r,null,h),g=N[l]||0,!g)N[l]=1;else{do u=l+"_"+g++;while(N[u]);N[l]=g,N[u]=1}o[k]=u}for(w=d.s.r+a;w<=d.e.r;++w)if(!(C[w]||{}).hidden){var L=IZ(e,d,w,y,s,o,_,h);(L.isempty===!1||(s===1?h.blankrows!==!1:h.blankrows))&&(v[b++]=L.row)}return v.length=b,v}var IE=/"/g;function MZ(e,t,r,s,a,o,l,u){for(var d=!0,h=[],m="",x=xs(r),y=t.s.c;y<=t.e.c;++y)if(s[y]){var v=u.dense?(e[r]||[])[y]:e[s[y]+x];if(v==null)m="";else if(v.v!=null){d=!1,m=""+(u.rawNumbers&&v.t=="n"?v.v:Si(v,null,u));for(var b=0,g=0;b!==m.length;++b)if((g=m.charCodeAt(b))===a||g===o||g===34||u.forceQuotes){m='"'+m.replace(IE,'""')+'"';break}m=="ID"&&(m='"ID"')}else v.f!=null&&!v.F?(d=!1,m="="+v.f,m.indexOf(",")>=0&&(m='"'+m.replace(IE,'""')+'"')):m="";h.push(m)}return u.blankrows===!1&&d?null:h.join(l)}function mb(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var a=gr(e["!ref"]),o=s.FS!==void 0?s.FS:",",l=o.charCodeAt(0),u=s.RS!==void 0?s.RS:`
`,d=u.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),m="",x=[];s.dense=Array.isArray(e);for(var y=s.skipHidden&&e["!cols"]||[],v=s.skipHidden&&e["!rows"]||[],b=a.s.c;b<=a.e.c;++b)(y[b]||{}).hidden||(x[b]=Qr(b));for(var g=0,_=a.s.r;_<=a.e.r;++_)(v[_]||{}).hidden||(m=MZ(e,a,_,x,l,d,o,s),m!=null&&(s.strip&&(m=m.replace(h,"")),(m||s.blankrows!==!1)&&r.push((g++?u:"")+m)));return delete s.dense,r.join("")}function JT(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=mb(e,t);return r}function BZ(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var a=gr(e["!ref"]),o="",l=[],u,d=[],h=Array.isArray(e);for(u=a.s.c;u<=a.e.c;++u)l[u]=Qr(u);for(var m=a.s.r;m<=a.e.r;++m)for(o=xs(m),u=a.s.c;u<=a.e.c;++u)if(t=l[u]+o,r=h?(e[m]||[])[u]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}d[d.length]=t+"="+s}return d}function ZT(e,t,r){var s=r||{},a=+!s.skipHeader,o=e||{},l=0,u=0;if(o&&s.origin!=null)if(typeof s.origin=="number")l=s.origin;else{var d=typeof s.origin=="string"?es(s.origin):s.origin;l=d.r,u=d.c}var h,m={s:{c:0,r:0},e:{c:u,r:l+t.length-1+a}};if(o["!ref"]){var x=gr(o["!ref"]);m.e.c=Math.max(m.e.c,x.e.c),m.e.r=Math.max(m.e.r,x.e.r),l==-1&&(l=x.e.r+1,m.e.r=l+t.length-1+a)}else l==-1&&(l=0,m.e.r=t.length-1+a);var y=s.header||[],v=0;t.forEach(function(g,_){ls(g).forEach(function(w){(v=y.indexOf(w))==-1&&(y[v=y.length]=w);var k=g[w],N="z",E="",C=Gt({c:u+v,r:l+_+a});h=Jd(o,C),k&&typeof k=="object"&&!(k instanceof Date)?o[C]=k:(typeof k=="number"?N="n":typeof k=="boolean"?N="b":typeof k=="string"?N="s":k instanceof Date?(N="d",s.cellDates||(N="n",k=Rs(k)),E=s.dateNF||Wt[14]):k===null&&s.nullError&&(N="e",k=0),h?(h.t=N,h.v=k,delete h.w,delete h.R,E&&(h.z=E)):o[C]=h={t:N,v:k},E&&(h.z=E))})}),m.e.c=Math.max(m.e.c,u+y.length-1);var b=xs(l);if(a)for(v=0;v<y.length;++v)o[Qr(v+u)+b]={t:"s",v:y[v]};return o["!ref"]=Zt(m),o}function PZ(e,t){return ZT(null,e,t)}function Jd(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=es(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Jd(e,Gt(t)):Jd(e,Gt({r:t,c:r||0}))}function UZ(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function pb(){return{SheetNames:[],Sheets:{}}}function xb(e,t,r,s){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=l+a)!=-1;++a);}if(LT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function zZ(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=UZ(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function $Z(e,t){return e.z=t,e}function QT(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function qZ(e,t,r){return QT(e,"#"+t,r)}function HZ(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function WZ(e,t,r,s){for(var a=typeof t!="string"?t:gr(t),o=typeof t=="string"?t:Zt(t),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var d=Jd(e,l,u);d.t="n",d.F=o,delete d.v,l==a.s.r&&u==a.s.c&&(d.f=r,s&&(d.D=!0))}return e}var Wr={encode_col:Qr,encode_row:xs,encode_cell:Gt,encode_range:Zt,decode_col:Wv,decode_row:Hv,split_cell:r$,decode_cell:es,decode_range:ja,format_cell:Si,sheet_add_aoa:E5,sheet_add_json:ZT,sheet_add_dom:qT,aoa_to_sheet:iu,json_to_sheet:PZ,table_to_sheet:HT,table_to_book:ZJ,sheet_to_csv:mb,sheet_to_txt:JT,sheet_to_json:K0,sheet_to_html:$T,sheet_to_formulae:BZ,sheet_to_row_object_array:K0,sheet_get_cell:Jd,book_new:pb,book_append_sheet:xb,book_set_sheet_visibility:zZ,cell_set_number_format:$Z,cell_set_hyperlink:QT,cell_set_internal_link:qZ,cell_add_comment:HZ,sheet_set_array_formula:WZ,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const GZ=()=>{const{isAdmin:e,isSubAdmin:t,profile:r}=Kr(),{labels:s,ledgerData:a,selectedLabel:o,loading:l,setSelectedLabel:u,addLabel:d,updateLabel:h,deleteLabel:m,addLedgerItem:x,updateLedgerItem:y,deleteLedgerItem:v,getNextRowNumber:b}=WU(),g=e||t||s.length===1||o?.name===r?.team,[_,w]=X.useState(!1),[k,N]=X.useState(!1),[E,C]=X.useState(!1),[L,O]=X.useState(null),[B,F]=X.useState(null),[q,fe]=X.useState("list"),[D,V]=X.useState(null),[I,ae]=X.useState(""),[Q,te]=X.useState(null),[ve,ee]=X.useState(""),Se=X.useRef(null),J=X.useRef(null),[M,Y]=X.useState(!1),[G,re]=X.useState(null),[ce,P]=X.useState(!1),[U,le]=X.useState(!1),[ne,ie]=X.useState({row_number:1,doc_number:"",content:"",receiver_org:"",receiver_date:"",sender_org:"",sender_date:"",note:""}),H=(De,mt)=>{g&&(te({id:De.id,field:mt}),ee(De[mt]||""))},K=async()=>{if(!Q)return;const{id:De,field:mt}=Q,At=a.find(wt=>wt.id===De);At&&At[mt]!==ve&&await y(De,{[mt]:ve}),te(null),ee("")},S=()=>{te(null),ee("")},ue=De=>{De.key==="Enter"?K():De.key==="Escape"&&S()},z=async(De=!1)=>{if(!o)return;if(!ne.content.trim()&&!ne.doc_number.trim()){De||le(!1);return}const mt={...ne,row_number:b(),label_id:o.id,created_by:r?.id};(await x(mt)).success&&(ie({row_number:b()+1,doc_number:"",content:"",receiver_org:"",receiver_date:"",sender_org:"",sender_date:"",note:""}),De||le(!1))},T=(De,mt)=>{ie(At=>({...At,[De]:mt}))},A=(De,mt)=>{De.key==="Enter"?(De.preventDefault(),z(!0)):De.key==="Escape"&&(ne.content.trim()||ne.doc_number.trim()?z(!1):(le(!1),ie({row_number:1,doc_number:"",content:"",receiver_org:"",receiver_date:"",sender_org:"",sender_date:"",note:""})))},W=De=>{O(De),N(!0)},pe=async()=>{L&&(await v(L.id),N(!1),O(null))},_e=async()=>{if(!I.trim()){alert("  .");return}(await d(I.trim())).success&&(ae(""),fe("list"))},oe=async()=>{if(!I.trim()||!D)return;(await h(D.id,I.trim())).success&&(ae(""),V(null),fe("list"))},Te=De=>{F(De),C(!0)},Me=async()=>{B&&(await m(B.id),C(!1),F(null))},Ae=async De=>{const mt=De.target.files?.[0];if(mt)try{Y(!0);const At=await mt.arrayBuffer(),wt=Zc(At),Ct=wt.SheetNames[0],It=wt.Sheets[Ct],Le=Wr.sheet_to_json(It,{header:1});let tt=-1;for(let se=0;se<Math.min(10,Le.length);se++){const Ne=Le[se];if(Ne&&Ne.some(xe=>xe&&String(xe).includes(""))){tt=se;break}}if(tt===-1){alert("   . , ,    .");return}const ct=[];for(let se=tt+2;se<Le.length;se++){const Ne=Le[se];if(!Ne||Ne.length===0)continue;const xe=Ne[0];if(!xe||isNaN(Number(xe)))continue;const je=Ne[2];!je||String(je).trim()===""||ct.push({row_number:Number(xe),doc_number:Ne[1]?String(Ne[1]).trim():"",content:Ne[2]?String(Ne[2]).trim():"",receiver_org:Ne[3]?String(Ne[3]).trim():"",receiver_date:Ne[4]?String(Ne[4]).trim():"",sender_org:Ne[5]?String(Ne[5]).trim():"",sender_date:Ne[6]?String(Ne[6]).trim():"",note:Ne[7]?String(Ne[7]).trim():""})}if(ct.length===0){alert("  .");return}re(ct),P(!0)}catch(At){console.error("  :",At),alert("     .")}finally{Y(!1),J.current&&(J.current.value="")}},Re=async()=>{if(!(!G||!o)){Y(!0);try{for(const De of G)await x({...De,label_id:o.id,created_by:r?.id});P(!1),re(null),alert(`${G.length}  .`)}catch(De){console.error("  :",De),alert("    .")}finally{Y(!1)}}},et=()=>{if(!o)return;const De=Wr.book_new(),mt=[...a].sort((It,Le)=>It.row_number-Le.row_number),At=[[`${He}  , `,null,null,null,null,null,null,null],[o.name,null,null,null,null,null,null,null],["","",""," ",null," ",null,""],[null,null,null,"","","","",null]];if(mt.length>0)mt.forEach(It=>{At.push([String(It.row_number),It.doc_number||"",It.content||"",It.receiver_org||"",It.receiver_date||"",It.sender_org||"",It.sender_date||"",It.note||""])});else for(let It=1;It<=23;It++)At.push([String(It),"","","","","","",""]);const wt=Wr.aoa_to_sheet(At);wt["!merges"]=[{s:{r:0,c:0},e:{r:0,c:7}},{s:{r:1,c:0},e:{r:1,c:7}},{s:{r:2,c:0},e:{r:3,c:0}},{s:{r:2,c:1},e:{r:3,c:1}},{s:{r:2,c:2},e:{r:3,c:2}},{s:{r:2,c:3},e:{r:2,c:4}},{s:{r:2,c:5},e:{r:2,c:6}},{s:{r:2,c:7},e:{r:3,c:7}}];const Ct=At.length;wt["!rows"]=[],wt["!rows"][0]={hpt:42,hpx:42},wt["!rows"][1]={hpt:42,hpx:42};for(let It=2;It<Ct;It++)wt["!rows"][It]={hpt:25.5,hpx:25.5};wt["!cols"]=[{wch:6},{wch:12},{wch:40},{wch:15},{wch:10},{wch:15},{wch:10},{wch:25}],Wr.book_append_sheet(De,wt,`${He}`),gl(De,`${He}__${o.name}.xls`,{bookType:"xls"})};X.useEffect(()=>{Q&&Se.current&&(Se.current.focus(),Se.current.select())},[Q]);const He=new Date().getFullYear(),at=({item:De,field:mt,className:At="",align:wt="left"})=>Q?.id===De.id&&Q?.field===mt?n.jsx("input",{ref:Se,type:"text",value:ve,onChange:It=>ee(It.target.value),onBlur:K,onKeyDown:ue,className:`w-full px-2 py-1 bg-toss-blue/5 border border-toss-blue rounded text-sm focus:outline-none focus:ring-1 focus:ring-toss-blue ${wt==="center"?"text-center":""}`}):n.jsx("div",{onClick:()=>g&&H(De,mt),className:`px-2 py-1 min-h-[28px] ${g?"cursor-text hover:bg-toss-gray-50 rounded":""} ${At} ${wt==="center"?"text-center":""}`,children:De[mt]||n.jsx("span",{className:"text-toss-gray-300",children:"-"})});return n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(L3,{size:24})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-xl font-bold mb-1",children:"  "}),n.jsxs("p",{className:"text-white/90",children:[He,""]})]})]}),n.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap",children:[g&&o&&n.jsxs(n.Fragment,{children:[n.jsx("input",{ref:J,type:"file",accept:".xlsx,.xls",onChange:Ae,className:"hidden"}),n.jsxs(Ye,{onClick:()=>J.current?.click(),disabled:M,className:"flex-1 sm:flex-none text-sm bg-white/20 hover:bg-white/30 text-white border-0",children:[n.jsx(ji,{size:16}),n.jsx("span",{className:"hidden sm:inline",children:""})]}),n.jsxs(Ye,{onClick:et,className:"flex-1 sm:flex-none text-sm bg-white/20 hover:bg-white/30 text-white border-0",children:[n.jsx(ts,{size:16}),n.jsx("span",{className:"hidden sm:inline",children:""})]})]}),(e||t)&&n.jsxs(Ye,{onClick:()=>{fe("list"),ae(""),V(null),w(!0)},className:"flex-1 sm:flex-none text-sm bg-white/20 hover:bg-white/30 text-white border-0",children:[n.jsx(Fd,{size:16}),n.jsx("span",{className:"hidden sm:inline",children:" "})]})]})]})}),n.jsxs("div",{className:"flex items-center gap-2 border-b border-toss-gray-200",children:[s.map(De=>n.jsxs("button",{onClick:()=>u(De),className:`px-4 py-3 font-medium text-sm transition-colors relative ${o?.id===De.id?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[De.name,o?.id===De.id&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]},De.id)),s.length===0&&n.jsx("div",{className:"px-4 py-3 text-sm text-toss-gray-400",children:" "})]}),n.jsxs(Et,{padding:"p-0",className:"hidden lg:block",children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full min-w-[900px]",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-200 bg-toss-gray-50",children:[n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-14",children:""}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-24",children:""}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-left min-w-[200px]",children:""}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-28 bg-blue-50/50",children:" "}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-20 bg-blue-50/50",children:""}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-28 bg-green-50/50",children:" "}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-20 bg-green-50/50",children:""}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-left min-w-[120px]",children:""}),g&&n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-12"})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-100",children:l?n.jsx("tr",{children:n.jsx("td",{colSpan:g?9:8,className:"px-4 py-12 text-center text-toss-gray-500",children:" ..."})}):n.jsxs(n.Fragment,{children:[U&&g&&n.jsxs("tr",{className:"bg-toss-blue/5",children:[n.jsx("td",{className:"px-3 py-2 text-sm text-center text-toss-gray-400",children:b()}),n.jsx("td",{className:"px-1 py-1",children:n.jsx("input",{type:"text",value:ne.doc_number,onChange:De=>T("doc_number",De.target.value),onKeyDown:De=>A(De),placeholder:"",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),n.jsx("td",{className:"px-1 py-1",children:n.jsx("input",{type:"text",value:ne.content,onChange:De=>T("content",De.target.value),onKeyDown:De=>A(De),placeholder:"",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue",autoFocus:!0})}),n.jsx("td",{className:"px-1 py-1 bg-blue-50/30",children:n.jsx("input",{type:"text",value:ne.receiver_org,onChange:De=>T("receiver_org",De.target.value),onKeyDown:De=>A(De),placeholder:" ",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),n.jsx("td",{className:"px-1 py-1 bg-blue-50/30",children:n.jsx("input",{type:"text",value:ne.receiver_date,onChange:De=>T("receiver_date",De.target.value),onKeyDown:De=>A(De),placeholder:"0122",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),n.jsx("td",{className:"px-1 py-1 bg-green-50/30",children:n.jsx("input",{type:"text",value:ne.sender_org,onChange:De=>T("sender_org",De.target.value),onKeyDown:De=>A(De),placeholder:" ",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),n.jsx("td",{className:"px-1 py-1 bg-green-50/30",children:n.jsx("input",{type:"text",value:ne.sender_date,onChange:De=>T("sender_date",De.target.value),onKeyDown:De=>A(De),placeholder:"0105",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),n.jsx("td",{className:"px-1 py-1",children:n.jsx("input",{type:"text",value:ne.note,onChange:De=>T("note",De.target.value),onKeyDown:De=>A(De),placeholder:"",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),n.jsx("td",{className:"px-2 py-1",children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>z(!0),className:"p-1 text-green-600 hover:bg-green-50 rounded-full transition-colors",title:"   (Enter)",children:n.jsx(A0,{size:14})}),n.jsx("button",{onClick:()=>{ne.content.trim()||ne.doc_number.trim()?z(!1):le(!1)},className:"p-1 text-toss-gray-400 hover:bg-toss-gray-100 rounded-full transition-colors",title:" (Esc)",children:n.jsx(mr,{size:14})})]})})]}),[...a].sort((De,mt)=>mt.row_number-De.row_number).map(De=>n.jsxs("tr",{className:"hover:bg-toss-gray-50/50 transition-colors",children:[n.jsx("td",{className:"px-3 py-2 text-sm text-center text-toss-gray-500 font-medium",children:De.row_number}),n.jsx("td",{className:"px-1 py-1 text-sm",children:n.jsx(at,{item:De,field:"doc_number",align:"center"})}),n.jsx("td",{className:"px-1 py-1 text-sm",children:n.jsx(at,{item:De,field:"content"})}),n.jsx("td",{className:"px-1 py-1 text-sm bg-blue-50/30",children:n.jsx(at,{item:De,field:"receiver_org",align:"center"})}),n.jsx("td",{className:"px-1 py-1 text-sm bg-blue-50/30",children:n.jsx(at,{item:De,field:"receiver_date",align:"center"})}),n.jsx("td",{className:"px-1 py-1 text-sm bg-green-50/30",children:n.jsx(at,{item:De,field:"sender_org",align:"center"})}),n.jsx("td",{className:"px-1 py-1 text-sm bg-green-50/30",children:n.jsx(at,{item:De,field:"sender_date",align:"center"})}),n.jsx("td",{className:"px-1 py-1 text-sm",children:n.jsx(at,{item:De,field:"note"})}),g&&n.jsx("td",{className:"px-2 py-1 text-center",children:n.jsx("button",{onClick:()=>W(De),className:"p-1.5 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors",children:n.jsx(Jt,{size:14})})})]},De.id)),a.length===0&&!U&&n.jsx("tr",{children:n.jsx("td",{colSpan:g?9:8,className:"px-4 py-12 text-center text-toss-gray-400",children:o?"  ":" "})})]})})]})}),o&&g&&!U&&n.jsx("div",{className:"border-t border-toss-gray-100",children:n.jsxs("button",{onClick:()=>le(!0),className:"w-full px-4 py-3 text-sm text-toss-gray-500 hover:text-toss-blue hover:bg-toss-gray-50 transition-colors flex items-center justify-center gap-2",children:[n.jsx(ps,{size:16}),"  "]})})]}),n.jsx("div",{className:"lg:hidden space-y-3",children:l?n.jsx(Et,{children:n.jsx("div",{className:"py-8 text-center text-toss-gray-500",children:" ..."})}):n.jsxs(n.Fragment,{children:[o&&g&&!U&&n.jsxs("button",{onClick:()=>le(!0),className:"w-full p-4 bg-toss-gray-50 border-2 border-dashed border-toss-gray-200 rounded-xl text-toss-gray-500 hover:border-toss-blue hover:text-toss-blue transition-colors flex items-center justify-center gap-2",children:[n.jsx(ps,{size:18}),"  "]}),U&&g&&n.jsx(Et,{children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm font-medium text-toss-gray-500",children:["#",b()]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>z(!0),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",children:n.jsx(A0,{size:18})}),n.jsx("button",{onClick:()=>{ne.content.trim()||ne.doc_number.trim()?z(!1):le(!1)},className:"p-2 text-toss-gray-400 hover:bg-toss-gray-100 rounded-lg transition-colors",children:n.jsx(mr,{size:18})})]})]}),n.jsx("input",{type:"text",value:ne.content,onChange:De=>T("content",De.target.value),placeholder:"",className:"w-full px-3 py-2 text-sm bg-toss-gray-50 border-0 rounded-lg focus:ring-2 focus:ring-toss-blue",autoFocus:!0}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsx("input",{type:"text",value:ne.doc_number,onChange:De=>T("doc_number",De.target.value),placeholder:"",className:"px-3 py-2 text-sm bg-toss-gray-50 border-0 rounded-lg focus:ring-2 focus:ring-toss-blue"}),n.jsx("input",{type:"text",value:ne.note,onChange:De=>T("note",De.target.value),placeholder:"",className:"px-3 py-2 text-sm bg-toss-gray-50 border-0 rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-xs text-blue-600 font-medium",children:""}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("input",{type:"text",value:ne.receiver_org,onChange:De=>T("receiver_org",De.target.value),placeholder:"",className:"flex-1 px-2 py-1.5 text-sm bg-blue-50 border-0 rounded-lg focus:ring-2 focus:ring-blue-400"}),n.jsx("input",{type:"text",value:ne.receiver_date,onChange:De=>T("receiver_date",De.target.value),placeholder:"",className:"w-16 px-2 py-1.5 text-sm bg-blue-50 border-0 rounded-lg focus:ring-2 focus:ring-blue-400 text-center"})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-xs text-green-600 font-medium",children:""}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("input",{type:"text",value:ne.sender_org,onChange:De=>T("sender_org",De.target.value),placeholder:"",className:"flex-1 px-2 py-1.5 text-sm bg-green-50 border-0 rounded-lg focus:ring-2 focus:ring-green-400"}),n.jsx("input",{type:"text",value:ne.sender_date,onChange:De=>T("sender_date",De.target.value),placeholder:"",className:"w-16 px-2 py-1.5 text-sm bg-green-50 border-0 rounded-lg focus:ring-2 focus:ring-green-400 text-center"})]})]})]})]})}),[...a].sort((De,mt)=>mt.row_number-De.row_number).map(De=>n.jsx(Et,{className:"relative",children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs font-medium text-toss-gray-400",children:["#",De.row_number]}),De.doc_number&&n.jsx("span",{className:"text-xs px-2 py-0.5 bg-toss-gray-100 text-toss-gray-600 rounded-full",children:De.doc_number})]}),g&&n.jsx("button",{onClick:()=>W(De),className:"p-1.5 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:n.jsx(Jt,{size:16})})]}),n.jsx("p",{className:"text-sm font-medium text-toss-gray-900",children:De.content||n.jsx("span",{className:"text-toss-gray-300",children:" "})}),n.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[(De.receiver_org||De.receiver_date)&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 rounded-lg",children:[n.jsx("span",{className:"font-medium",children:""}),De.receiver_org,De.receiver_date&&n.jsxs("span",{className:"text-blue-500",children:["(",De.receiver_date,")"]})]}),(De.sender_org||De.sender_date)&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-50 text-green-700 rounded-lg",children:[n.jsx("span",{className:"font-medium",children:""}),De.sender_org,De.sender_date&&n.jsxs("span",{className:"text-green-500",children:["(",De.sender_date,")"]})]})]}),De.note&&n.jsx("p",{className:"text-xs text-toss-gray-500 pt-1 border-t border-toss-gray-100",children:De.note})]})},De.id)),a.length===0&&!U&&n.jsx(Et,{children:n.jsx("div",{className:"py-8 text-center text-toss-gray-400",children:o?"  ":" "})})]})}),g&&n.jsx("p",{className:"text-xs text-toss-gray-400 text-center",children:"        Enter    , Esc "}),n.jsx(dr,{isOpen:_,onClose:()=>w(!1),title:" ",children:n.jsxs("div",{className:"space-y-4",children:[q==="list"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"space-y-2",children:s.length>0?s.map(De=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-toss",children:[n.jsx("span",{className:"font-medium text-toss-gray-900",children:De.name}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>{V(De),ae(De.name),fe("edit")},className:"p-1 text-toss-gray-500 hover:bg-toss-gray-200 rounded",children:n.jsx(z3,{size:16})}),n.jsx("button",{onClick:()=>Te(De),className:"p-1 text-red-500 hover:bg-red-50 rounded",children:n.jsx(Jt,{size:16})})]})]},De.id)):n.jsx("div",{className:"p-4 text-center text-toss-gray-500",children:"  "})}),n.jsxs(Ye,{onClick:()=>{ae(""),fe("add")},className:"w-full",children:[n.jsx(ps,{size:18}),"  "]})]}),q==="add"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"text",value:I,onChange:De=>ae(De.target.value),onKeyDown:De=>De.key==="Enter"&&_e(),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue",placeholder:"  ",autoFocus:!0})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>fe("list"),className:"flex-1",children:""}),n.jsx(Ye,{onClick:_e,className:"flex-1",children:""})]})]}),q==="edit"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"text",value:I,onChange:De=>ae(De.target.value),onKeyDown:De=>De.key==="Enter"&&oe(),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue",placeholder:"  ",autoFocus:!0})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{V(null),fe("list")},className:"flex-1",children:""}),n.jsx(Ye,{onClick:oe,className:"flex-1",children:""})]})]})]})}),n.jsx(dr,{isOpen:k,onClose:()=>{N(!1),O(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-toss-gray-700",children:"  ?"}),L&&n.jsxs("div",{className:"p-3 bg-toss-gray-50 rounded-toss text-sm",children:[n.jsx("p",{className:"font-medium text-toss-gray-900",children:L.content||"( )"}),L.doc_number&&n.jsxs("p",{className:"text-toss-gray-500 mt-1",children:[": ",L.doc_number]})]}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{N(!1),O(null)},className:"flex-1",children:""}),n.jsx(Ye,{variant:"danger",onClick:pe,className:"flex-1",children:""})]})]})}),n.jsx(dr,{isOpen:E,onClose:()=>{C(!1),F(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("p",{className:"text-toss-gray-700",children:[n.jsxs("span",{className:"font-medium text-toss-gray-900",children:['"',B?.name,'"']}),"  ?"]}),n.jsx("p",{className:"text-sm text-red-500",children:"      ."}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{C(!1),F(null)},className:"flex-1",children:""}),n.jsx(Ye,{variant:"danger",onClick:Me,className:"flex-1",children:""})]})]})}),n.jsx(dr,{isOpen:ce,onClose:()=>{P(!1),re(null)},title:"  ",size:"xl",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("p",{className:"text-toss-gray-700",children:[n.jsxs("span",{className:"font-bold text-toss-blue",children:[G?.length||0,""]}),"  ."]}),n.jsx("div",{className:"max-h-[400px] overflow-auto border border-toss-gray-200 rounded-toss",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-toss-gray-50 sticky top-0",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-100",children:G?.map((De,mt)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-2 py-2 text-toss-gray-500",children:De.row_number}),n.jsx("td",{className:"px-2 py-2",children:De.doc_number||"-"}),n.jsx("td",{className:"px-2 py-2 max-w-[200px] truncate",children:De.content}),n.jsx("td",{className:"px-2 py-2 text-toss-gray-500",children:De.receiver_org&&`${De.receiver_org} (${De.receiver_date||"-"})`}),n.jsx("td",{className:"px-2 py-2 text-toss-gray-500",children:De.sender_org&&`${De.sender_org} (${De.sender_date||"-"})`})]},mt))})]})}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{P(!1),re(null)},className:"flex-1",disabled:M,children:""}),n.jsx(Ye,{onClick:Re,className:"flex-1",disabled:M,children:M?" ...":""})]})]})})]})};function VZ(){const{user:e,profile:t,isAdmin:r,isSubAdmin:s}=Kr(),a=e?.user_id||t?.id,[o,l]=X.useState(null),[u,d]=X.useState(null),[h,m]=X.useState([]),[x,y]=X.useState([]),[v,b]=X.useState([]),[g,_]=X.useState([]),[w,k]=X.useState([]),[N,E]=X.useState([]),[C,L]=X.useState([]),[O,B]=X.useState(!1),[F,q]=X.useState(null),fe=new Date().getFullYear(),D=r||s,V=X.useCallback(async()=>{if(a)try{let{data:K,error:S}=await Pe.from("annual_leaves").select("*").eq("user_id",a).eq("year",fe).single();if(S&&S.code==="PGRST116"){const{data:pe,error:_e}=await Pe.from("annual_leaves").insert({user_id:a,year:fe,total_days:_0,used_days:0}).select().single();if(_e)throw _e;K=pe}else if(S)throw S;const ue=`${fe}-01-01`,z=`${fe}-12-31`,{data:T}=await Pe.from("leave_requests").select("days").eq("user_id",a).eq("status","approved").gte("start_date",ue).lte("start_date",z).neq("leave_type","comp");let A=(T||[]).reduce((pe,_e)=>pe+(_e.days||0),0);const{data:W}=await Pe.from("document_labels").select("id").eq("code",xd).single();if(W){const{data:pe}=await Pe.from("documents").select("leave_days").eq("drafter_id",a).eq("label_id",W.id).eq("attendance_type","leave").eq("status","approved").gte("leave_start_date",ue).lte("leave_start_date",z).not("leave_type","is",null).neq("leave_type","comp");A+=(pe||[]).reduce((_e,oe)=>_e+(oe.leave_days||0),0)}l({...K,used_days:A})}catch(K){console.error("   :",K),q(K.message)}},[a,fe]),I=X.useCallback(async()=>{if(a)try{const{data:K,error:S}=await Pe.from("comp_leaves").select("*").eq("user_id",a).eq("year",fe).single();if(S&&S.code!=="PGRST116")throw S;d(K||null)}catch(K){console.error("   :",K)}},[a,fe]),ae=X.useCallback(async()=>{if(a)try{const{data:K,error:S}=await Pe.from("leave_requests").select("*").eq("user_id",a).order("created_at",{ascending:!1});if(S)throw S;m(K||[])}catch(K){console.error("    :",K),q(K.message)}},[a]),Q=X.useCallback(async()=>{if(a)try{const{data:K,error:S}=await Pe.from("overtime_requests").select("*").eq("user_id",a).order("created_at",{ascending:!1});if(S)throw S;y(K||[])}catch(K){console.error("    :",K),q(K.message)}},[a]),te=X.useCallback(async(K=null)=>{if(D)try{let S=Pe.from("leave_requests").select("*").order("created_at",{ascending:!1});K&&(S=S.eq("status",K));const{data:ue,error:z}=await S;if(z)throw z;b(ue||[])}catch(S){console.error("    :",S),q(S.message)}},[D]),ve=X.useCallback(async(K=null)=>{if(D)try{let S=Pe.from("overtime_requests").select("*").order("created_at",{ascending:!1});K&&(S=S.eq("status",K));const{data:ue,error:z}=await S;if(z)throw z;_(ue||[])}catch(S){console.error("    :",S),q(S.message)}},[D]),ee=X.useCallback(async()=>{if(D)try{const{data:K,error:S}=await Pe.from("users").select("id, name, team").order("name");if(S)throw S;E(K||[]);const{data:ue,error:z}=await Pe.from("annual_leaves").select("*").eq("year",fe);if(z)throw z;const T=`${fe}-01-01`,A=`${fe}-12-31`,{data:W,error:pe}=await Pe.from("leave_requests").select("user_id, days, leave_type").eq("status","approved").gte("start_date",T).lte("start_date",A).neq("leave_type","comp");if(pe)throw pe;const{data:_e}=await Pe.from("document_labels").select("id").eq("code",xd).single();let oe=[];if(_e){const{data:Re}=await Pe.from("documents").select("drafter_id, leave_days, leave_type").eq("label_id",_e.id).eq("attendance_type","leave").eq("status","approved").gte("leave_start_date",T).lte("leave_start_date",A).not("leave_type","is",null).neq("leave_type","comp");oe=Re||[]}const Te={};(W||[]).forEach(Re=>{Te[Re.user_id]=(Te[Re.user_id]||0)+(Re.days||0)}),oe.forEach(Re=>{Te[Re.drafter_id]=(Te[Re.drafter_id]||0)+(Re.leave_days||0)});const Me=(ue||[]).map(Re=>({...Re,used_days:Te[Re.user_id]||Re.used_days||0})),Ae=new Set((ue||[]).map(Re=>Re.user_id));(K||[]).forEach(Re=>{!Ae.has(Re.id)&&Te[Re.id]&&Me.push({user_id:Re.id,year:fe,total_days:_0,used_days:Te[Re.id]})}),k(Me)}catch(K){console.error("    :",K,K?.message,K?.code),q(K.message)}},[D,fe]),Se=async K=>{if(!a)return{success:!1,error:" ."};try{B(!0);let S=0;const ue=K.leave_type;if(ue==="full"||ue==="comp"){const A=new Date(K.start_date),W=new Date(K.end_date);S=Math.ceil((W-A)/(1e3*60*60*24))+1}else S=By[ue]||.5;if(ue!=="comp"&&o){const A=o.total_days-o.used_days;if(S>A)return{success:!1,error:`  . (: ${A})`}}const{data:z,error:T}=await Pe.from("leave_requests").insert({user_id:a,leave_type:ue,start_date:K.start_date,end_date:K.end_date||K.start_date,days:S,reason:K.reason,status:"pending"}).select().single();if(T)throw T;return await ae(),{success:!0,data:z}}catch(S){return console.error("  :",S),{success:!1,error:S.message}}finally{B(!1)}},J=async K=>{try{B(!0);const{error:S}=await Pe.from("leave_requests").delete().eq("id",K).eq("user_id",a).eq("status","pending");if(S)throw S;return await ae(),{success:!0}}catch(S){return console.error("  :",S),{success:!1,error:S.message}}finally{B(!1)}},M=async K=>{if(!a)return{success:!1,error:" ."};try{B(!0);const{data:S,error:ue}=await Pe.from("overtime_requests").insert({user_id:a,start_datetime:K.start_datetime,end_datetime:K.end_datetime,reason:K.reason,status:"pending"}).select().single();if(ue)throw ue;return await Q(),{success:!0,data:S}}catch(S){return console.error("  :",S),{success:!1,error:S.message}}finally{B(!1)}},Y=async K=>{try{B(!0);const{error:S}=await Pe.from("overtime_requests").delete().eq("id",K).eq("user_id",a).eq("status","pending");if(S)throw S;return await Q(),{success:!0}}catch(S){return console.error("  :",S),{success:!1,error:S.message}}finally{B(!1)}},G=async K=>{if(!D)return{success:!1,error:" ."};try{B(!0);const{data:S,error:ue}=await Pe.from("leave_requests").select("*").eq("id",K).single();if(ue)throw ue;const{error:z}=await Pe.from("leave_requests").update({status:"approved",approved_by:a,updated_at:new Date().toISOString()}).eq("id",K);if(z)throw z;if(S.leave_type==="comp"){const T=S.days*8,{data:A}=await Pe.from("comp_leaves").select("*").eq("user_id",S.user_id).eq("year",fe).single();A&&await Pe.from("comp_leaves").update({used_hours:A.used_hours+T,updated_at:new Date().toISOString()}).eq("id",A.id)}else{const{data:T}=await Pe.from("annual_leaves").select("*").eq("user_id",S.user_id).eq("year",fe).single();T?await Pe.from("annual_leaves").update({used_days:T.used_days+S.days,updated_at:new Date().toISOString()}).eq("id",T.id):await Pe.from("annual_leaves").insert({user_id:S.user_id,year:fe,total_days:_0,used_days:S.days})}return await te(),await ee(),{success:!0}}catch(S){return console.error("  :",S),{success:!1,error:S.message}}finally{B(!1)}},re=async(K,S)=>{if(!D)return{success:!1,error:" ."};try{B(!0);const{error:ue}=await Pe.from("leave_requests").update({status:"rejected",rejected_reason:S,approved_by:a,updated_at:new Date().toISOString()}).eq("id",K);if(ue)throw ue;return await te(),{success:!0}}catch(ue){return console.error("  :",ue),{success:!1,error:ue.message}}finally{B(!1)}},ce=async K=>{if(!D)return{success:!1,error:" ."};try{B(!0);const{error:S}=await Pe.from("overtime_requests").update({status:"approved",approved_by:a,approved_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",K);if(S)throw S;return await ve(),{success:!0}}catch(S){return console.error("  :",S),{success:!1,error:S.message}}finally{B(!1)}},P=async(K,S)=>{if(!D)return{success:!1,error:" ."};try{B(!0);const{error:ue}=await Pe.from("overtime_requests").update({status:"rejected",rejected_reason:S,approved_by:a,updated_at:new Date().toISOString()}).eq("id",K);if(ue)throw ue;return await ve(),{success:!0}}catch(ue){return console.error("  :",ue),{success:!1,error:ue.message}}finally{B(!1)}},U=async(K,S)=>{if(!D)return{success:!1,error:" ."};try{B(!0);const{data:ue,error:z}=await Pe.from("annual_leaves").upsert({user_id:K,year:fe,total_days:S,updated_at:new Date().toISOString()},{onConflict:"user_id,year"}).select().single();if(z)throw z;return await ee(),{success:!0,data:ue}}catch(ue){return console.error("  :",ue),{success:!1,error:ue.message}}finally{B(!1)}},le=X.useCallback(async(K,S)=>{try{const ue=new Date(K,S,1).toISOString().split("T")[0],z=new Date(K,S+1,0).toISOString().split("T")[0],{data:T,error:A}=await Pe.from("leave_requests").select("*").eq("status","approved").or(`start_date.lte.${z},end_date.gte.${ue}`);if(A)throw A;const W=[...new Set((T||[]).map(Te=>Te.user_id))],{data:pe}=await Pe.from("users").select("id, name, team").in("id",W),_e={};return(pe||[]).forEach(Te=>{_e[Te.id]=Te}),(T||[]).map(Te=>({...Te,user:_e[Te.user_id]}))}catch(ue){return console.error("   :",ue),[]}},[]),ne=X.useCallback(async(K=null)=>{if(D)try{const{data:S}=await Pe.from("document_labels").select("id").eq("code",xd).single();if(!S)return;let ue=Pe.from("documents").select("*, drafter:drafter_id(name, team, position)").eq("label_id",S.id).eq("attendance_type","leave").not("leave_type","is",null).order("created_at",{ascending:!1});K==="pending"?ue=ue.eq("status","pending"):K==="approved"?ue=ue.eq("status","approved"):K==="rejected"&&(ue=ue.eq("status","rejected"));const{data:z,error:T}=await ue;if(T)throw T;L(z||[])}catch(S){console.error("   :",S),q(S.message)}},[D]),ie=async K=>{if(!D)return{success:!1,error:" ."};try{B(!0);const{error:S}=await Pe.from("documents").update({status:"approved",approved_by:a,approved_at:new Date().toISOString()}).eq("id",K);if(S)throw S;return await ne(),{success:!0}}catch(S){return console.error("   :",S),{success:!1,error:S.message}}finally{B(!1)}},H=async(K,S)=>{if(!D)return{success:!1,error:" ."};try{B(!0);const{error:ue}=await Pe.from("documents").update({status:"rejected",approved_by:a,approved_at:new Date().toISOString(),rejected_reason:S}).eq("id",K);if(ue)throw ue;return await ne(),{success:!0}}catch(ue){return console.error("   :",ue),{success:!1,error:ue.message}}finally{B(!1)}};return X.useEffect(()=>{a&&(V(),I(),ae(),Q(),D&&(te(),ve(),ee(),ne()))},[a,D,V,I,ae,Q,te,ve,ee,ne]),{annualLeave:o,compLeave:u,myRequests:h,myOvertimeRequests:x,allRequests:v,allOvertimeRequests:g,allAnnualLeaves:w,allUsers:N,documentLeaves:C,loading:O,error:F,canManage:D,currentYear:fe,fetchAnnualLeave:V,fetchMyRequests:ae,createRequest:Se,cancelRequest:J,fetchMyOvertimeRequests:Q,createOvertimeRequest:M,cancelOvertimeRequest:Y,fetchAllRequests:te,fetchAllOvertimeRequests:ve,fetchAllAnnualLeaves:ee,approveRequest:G,rejectRequest:re,approveOvertimeRequest:ce,rejectOvertimeRequest:P,updateUserLeave:U,fetchDocumentLeaves:ne,approveDocumentLeave:ie,rejectDocumentLeave:H,fetchApprovedLeaves:le}}const o0={full:{label:"",days:1},half_am:{label:" ",days:.5},half_pm:{label:" ",days:.5},out_1h:{label:"/ 1",days:.125},out_2h:{label:"/ 2",days:.25},out_3h:{label:"/ 3",days:.375},comp:{label:"",days:1}},KZ=()=>{const{annualLeave:e,compLeave:t,myRequests:r,myOvertimeRequests:s,allRequests:a,allOvertimeRequests:o,allAnnualLeaves:l,allUsers:u,documentLeaves:d,loading:h,canManage:m,currentYear:x,createRequest:y,cancelRequest:v,createOvertimeRequest:b,cancelOvertimeRequest:g,approveRequest:_,rejectRequest:w,approveOvertimeRequest:k,rejectOvertimeRequest:N,updateUserLeave:E,fetchApprovedLeaves:C,fetchAllRequests:L,fetchAllOvertimeRequests:O,fetchAllAnnualLeaves:B,fetchDocumentLeaves:F,approveDocumentLeave:q,rejectDocumentLeave:fe}=VZ(),[D,V]=X.useState("my"),[I,ae]=X.useState(!1),[Q,te]=X.useState("leave"),[ve,ee]=X.useState({leave_type:"full",start_date:"",end_date:"",reason:""}),[Se,J]=X.useState({start_date:"",start_time:"",end_date:"",end_time:"",reason:""}),[M,Y]=X.useState(!1),[G,re]=X.useState(null),[ce,P]=X.useState(""),[U,le]=X.useState(!1),[ne,ie]=X.useState(null),[H,K]=X.useState(15),[S,ue]=X.useState(new Date),[z,T]=X.useState([]),[A,W]=X.useState("pending"),[pe,_e]=X.useState(""),oe=(e?.total_days||15)-(e?.used_days||0),Te=t?Math.floor((t.total_hours-t.used_hours)/8):0,Me=X.useMemo(()=>{const se={};return u.forEach(Ne=>{se[Ne.id]=Ne}),se},[u]),Ae=(se,Ne,xe)=>{if(!Ne)return 0;if(o0[se]&&se!=="full"&&se!=="comp")return o0[se].days;if(!xe)return 1;const je=new Date(Ne),de=new Date(xe),Oe=Math.abs(de-je);return Math.ceil(Oe/(1e3*60*60*24))+1},Re=async()=>{if(!ve.start_date){alert(" .");return}const se=Ae(ve.leave_type,ve.start_date,["full","comp"].includes(ve.leave_type)?ve.end_date:ve.start_date);if(ve.leave_type!=="comp"&&se>oe){alert(`  . (: ${oe})`);return}const Ne=await y({...ve,end_date:["full","comp"].includes(ve.leave_type)&&ve.end_date||ve.start_date,days:se});Ne.success?(ae(!1),ee({leave_type:"full",start_date:"",end_date:"",reason:""}),te("leave"),alert(" .")):alert(" : "+Ne.error)},et=async()=>{if(!Se.start_date||!Se.start_time){alert("   .");return}if(!Se.end_date||!Se.end_time){alert("   .");return}if(!Se.reason.trim()){alert(" .");return}const se=`${Se.start_date}T${Se.start_time}:00`,Ne=`${Se.end_date}T${Se.end_time}:00`;if(new Date(Ne)<=new Date(se)){alert("     .");return}const xe=await b({start_datetime:se,end_datetime:Ne,reason:Se.reason});xe.success?(ae(!1),J({start_date:"",start_time:"",end_date:"",end_time:"",reason:""}),te("leave"),alert("  .")):alert(" : "+xe.error)},He=async se=>{if(!confirm(" ?"))return;const Ne=await g(se);Ne.success||alert(" : "+Ne.error)},at=async se=>{const Ne=await k(se);Ne.success||alert(" : "+Ne.error)},De=async se=>{if(!confirm(" ?"))return;const Ne=await v(se);Ne.success||alert(" : "+Ne.error)},mt=async se=>{const Ne=await _(se);Ne.success||alert(" : "+Ne.error)},At=async()=>{if(!G)return;let se;G.isDocument?se=await fe(G.id,ce):G.isOvertime?se=await N(G.id,ce):se=await w(G.id,ce),se.success?(Y(!1),re(null),P("")):alert(" : "+se.error)},wt=async se=>{const Ne=await q(se);Ne.success||alert(" : "+Ne.error)},Ct=async()=>{if(!ne)return;const se=await E(ne.id,parseFloat(H));se.success?ie(null):alert(" : "+se.error)};X.useEffect(()=>{(async()=>{const Ne=await C(S.getFullYear(),S.getMonth());T(Ne)})()},[S,C]),X.useEffect(()=>{m&&D==="manage"&&(L(A==="all"?null:A),O(A==="all"?null:A),F(A==="all"?null:A))},[A,D,m,L,O,F]),X.useEffect(()=>{m&&D==="settings"&&B()},[D,m,B]);const It=se=>{switch(se){case"pending":return{text:"",color:"bg-yellow-100 text-yellow-700"};case"approved":return{text:"",color:"bg-green-100 text-green-700"};case"rejected":return{text:"",color:"bg-red-100 text-red-700"};default:return{text:se,color:"bg-gray-100 text-gray-700"}}},Le=se=>o0[se]?.label||se,tt=()=>{const se=S.getFullYear(),Ne=S.getMonth(),xe=new Date(se,Ne,1).getDay(),je=new Date(se,Ne+1,0).getDate(),de=[],Oe=[];for(let rt=0;rt<xe;rt++)de.push(null);for(let rt=1;rt<=je;rt++)de.push(rt);for(let rt=0;rt<de.length;rt+=7)Oe.push(de.slice(rt,rt+7));const Ue=rt=>{if(!rt)return[];const pt=`${se}-${String(Ne+1).padStart(2,"0")}-${String(rt).padStart(2,"0")}`;return z.filter(_t=>pt>=_t.start_date&&pt<=_t.end_date)};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("button",{onClick:()=>ue(new Date(se,Ne-1,1)),className:"p-2 hover:bg-toss-gray-100 rounded-full",children:n.jsx($a,{size:20})}),n.jsxs("h3",{className:"text-lg font-bold text-toss-gray-900",children:[se," ",Ne+1,""]}),n.jsx("button",{onClick:()=>ue(new Date(se,Ne+1,1)),className:"p-2 hover:bg-toss-gray-100 rounded-full",children:n.jsx(pa,{size:20})})]}),n.jsxs("div",{className:"border border-toss-gray-200 rounded-toss overflow-hidden",children:[n.jsx("div",{className:"grid grid-cols-7 bg-toss-gray-50",children:["","","","","","",""].map((rt,pt)=>n.jsx("div",{className:`p-2 text-center text-sm font-medium ${pt===0?"text-red-500":pt===6?"text-blue-500":"text-toss-gray-600"}`,children:rt},rt))}),n.jsx("div",{className:"divide-y divide-toss-gray-100",children:Oe.map((rt,pt)=>n.jsx("div",{className:"grid grid-cols-7 divide-x divide-toss-gray-100",children:rt.map((_t,Vt)=>{const yr=Ue(_t),_r=_t&&new Date().toDateString()===new Date(se,Ne,_t).toDateString();return n.jsx("div",{className:`min-h-[80px] p-1 ${_t?"":"bg-toss-gray-50"}`,children:_t&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:`text-sm font-medium mb-1 ${Vt===0?"text-red-500":Vt===6?"text-blue-500":"text-toss-gray-700"} ${_r?"bg-toss-blue text-white w-6 h-6 rounded-full flex items-center justify-center":""}`,children:_t}),n.jsxs("div",{className:"space-y-0.5",children:[yr.slice(0,3).map((zt,fr)=>n.jsx("div",{className:`text-xs px-1 py-0.5 rounded truncate ${zt.leave_type==="full"?"bg-toss-blue/10 text-toss-blue":zt.leave_type==="half_am"||zt.leave_type==="am"?"bg-orange-100 text-orange-700":"bg-purple-100 text-purple-700"}`,title:`${zt.user?.name} ${Le(zt.leave_type)}`,children:zt.user?.name},fr)),yr.length>3&&n.jsxs("div",{className:"text-xs text-toss-gray-400",children:["+",yr.length-3,""]})]})]})},Vt)})},pt))})]})]})},ct=()=>{const se=a.map(je=>{const de=Me[je.user_id];return{...je,_source:"leave_requests",_type:"leave",_sortDate:new Date(je.created_at),_name:de?.name||"  ",_team:de?.team,_position:de?.position}}),Ne=o.map(je=>{const de=Me[je.user_id],Oe=new Date(je.start_datetime),Ue=new Date(je.end_datetime),rt=(Ue-Oe)/(1e3*60*60),pt=Math.floor(rt),_t=Math.round((rt-pt)*60);return{...je,_source:"overtime_requests",_type:"overtime",_sortDate:new Date(je.created_at),_name:de?.name||"  ",_team:de?.team,_position:de?.position,_overtimeHours:_t>0?`${pt} ${_t}`:`${pt}`,_startDt:Oe,_endDt:Ue}}),xe=d.map(je=>({...je,_source:"document",_type:"leave",_sortDate:new Date(je.created_at),_name:je.drafter?.name,_team:je.drafter?.team,_position:je.drafter?.position,leave_type:je.leave_type,days:je.leave_days,start_date:je.leave_start_date,end_date:je.leave_end_date,reason:je.content||je.title}));return[...se,...Ne,...xe].sort((je,de)=>de._sortDate-je._sortDate)};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),n.jsxs("p",{className:"text-toss-gray-500 mt-1",children:[x,""]})]}),D==="my"&&n.jsxs(Ye,{onClick:()=>ae(!0),children:[n.jsx(ps,{size:18}),""]})]}),D==="my"&&e&&n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs(Et,{className:"text-center",children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[e.total_days,""]})]}),n.jsxs(Et,{className:"text-center",children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold text-toss-blue",children:[e.used_days,""]})]}),n.jsxs(Et,{className:"text-center",children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[e.total_days-e.used_days,""]})]})]}),n.jsxs("div",{className:"flex items-center gap-2 border-b border-toss-gray-200",children:[n.jsxs("button",{onClick:()=>V("my"),className:`px-4 py-3 font-medium text-sm transition-colors relative ${D==="my"?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[n.jsx(ta,{size:16,className:"inline mr-1"})," ",D==="my"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]}),n.jsxs("button",{onClick:()=>V("calendar"),className:`px-4 py-3 font-medium text-sm transition-colors relative ${D==="calendar"?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[n.jsx(ha,{size:16,className:"inline mr-1"}),"",D==="calendar"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]}),m&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>V("manage"),className:`px-4 py-3 font-medium text-sm transition-colors relative ${D==="manage"?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[n.jsx(Ld,{size:16,className:"inline mr-1"})," ",D==="manage"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]}),n.jsxs("button",{onClick:()=>V("settings"),className:`px-4 py-3 font-medium text-sm transition-colors relative ${D==="settings"?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[n.jsx(yl,{size:16,className:"inline mr-1"})," ",D==="settings"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]})]})]}),D==="my"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs(Et,{padding:"p-0",children:[n.jsx("div",{className:"p-4 border-b border-toss-gray-100",children:n.jsx("h3",{className:"font-medium text-toss-gray-900",children:"  "})}),r.length>0?n.jsx("div",{className:"divide-y divide-toss-gray-100",children:r.map(se=>{const Ne=It(se.status);return n.jsx("div",{className:"p-4",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Ne.color}`,children:Ne.text}),n.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:Le(se.leave_type)}),n.jsxs("span",{className:"text-sm text-toss-gray-500",children:[se.days,""]})]}),n.jsx("p",{className:"text-sm text-toss-gray-700",children:se.start_date===se.end_date?se.start_date:`${se.start_date} ~ ${se.end_date}`}),se.reason&&n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:se.reason}),se.status==="rejected"&&se.rejected_reason&&n.jsxs("p",{className:"text-sm text-red-500 mt-1",children:[" : ",se.rejected_reason]})]}),se.status==="pending"&&n.jsx("button",{onClick:()=>De(se.id),className:"text-sm text-red-500 hover:underline",children:""})]})},se.id)})}):n.jsx("div",{className:"p-8 text-center text-toss-gray-400",children:"   "})]}),n.jsxs(Et,{padding:"p-0",children:[n.jsx("div",{className:"p-4 border-b border-toss-gray-100",children:n.jsx("h3",{className:"font-medium text-toss-gray-900",children:"  "})}),s.length>0?n.jsx("div",{className:"divide-y divide-toss-gray-100",children:s.map(se=>{const Ne=It(se.status),xe=new Date(se.start_datetime),je=new Date(se.end_datetime),de=(je-xe)/(1e3*60*60),Oe=Math.floor(de),Ue=Math.round((de-Oe)*60);return n.jsx("div",{className:"p-4",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Ne.color}`,children:Ne.text}),n.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:""}),n.jsx("span",{className:"text-sm text-toss-gray-500",children:Ue>0?`${Oe} ${Ue}`:`${Oe}`})]}),n.jsxs("p",{className:"text-sm text-toss-gray-700",children:[xe.toLocaleDateString("ko-KR")," ",xe.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})," ~"," ",je.toLocaleDateString("ko-KR")," ",je.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})]}),se.reason&&n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:se.reason}),se.status==="rejected"&&se.rejected_reason&&n.jsxs("p",{className:"text-sm text-red-500 mt-1",children:[" : ",se.rejected_reason]})]}),se.status==="pending"&&n.jsx("button",{onClick:()=>He(se.id),className:"text-sm text-red-500 hover:underline",children:""})]})},se.id)})}):n.jsx("div",{className:"p-8 text-center text-toss-gray-400",children:"   "})]})]}),D==="calendar"&&n.jsx(Et,{children:tt()}),D==="manage"&&m&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"flex gap-2",children:["pending","approved","rejected","all"].map(se=>n.jsx("button",{onClick:()=>W(se),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${A===se?"bg-toss-blue text-white":"bg-toss-gray-100 text-toss-gray-600 hover:bg-toss-gray-200"}`,children:se==="pending"?"":se==="approved"?"":se==="rejected"?"":""},se))}),n.jsx(Et,{padding:"p-0",children:ct().length>0?n.jsx("div",{className:"divide-y divide-toss-gray-100",children:ct().map(se=>{const Ne=It(se.status),xe=se._source==="document",je=se._source==="overtime_requests";return n.jsx("div",{className:"p-4",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"font-medium text-toss-gray-900",children:se._name}),n.jsxs("span",{className:"text-sm text-toss-gray-500",children:[se._team," ",se._position]}),n.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Ne.color}`,children:Ne.text}),xe&&n.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700",children:""}),je&&n.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-700",children:""})]}),je?n.jsx(n.Fragment,{children:n.jsxs("p",{className:"text-sm text-toss-gray-700",children:[" ",se._overtimeHours," "," ",se._startDt.toLocaleDateString("ko-KR")," ",se._startDt.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})," ~"," ",se._endDt.toLocaleDateString("ko-KR")," ",se._endDt.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})]})}):n.jsxs("p",{className:"text-sm text-toss-gray-700",children:[Le(se.leave_type)," ",se.days," "," ",se.start_date===se.end_date?se.start_date:`${se.start_date} ~ ${se.end_date}`]}),se.reason&&n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:se.reason}),se.status==="rejected"&&se.rejected_reason&&n.jsxs("p",{className:"text-sm text-red-500 mt-1",children:[" : ",se.rejected_reason]})]}),se.status==="pending"?n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>{xe?wt(se.id):je?at(se.id):mt(se.id)},className:"p-2 text-green-600 hover:bg-green-50 rounded-full",children:n.jsx(A0,{size:18})}),n.jsx("button",{onClick:()=>{re({...se,isDocument:xe,isOvertime:je}),Y(!0)},className:"p-2 text-red-500 hover:bg-red-50 rounded-full",children:n.jsx(mr,{size:18})})]}):n.jsxs("span",{className:"text-xs text-toss-gray-400",children:[se.approved_at&&new Date(se.approved_at).toLocaleDateString("ko-KR"),se.updated_at&&!se.approved_at&&new Date(se.updated_at).toLocaleDateString("ko-KR")]})]})},`${se._source}-${se.id}`)})}):n.jsx("div",{className:"p-8 text-center text-toss-gray-400",children:"  "})})]}),D==="settings"&&m&&n.jsxs(Et,{padding:"p-0",children:[n.jsxs("div",{className:"p-4 border-b border-toss-gray-100 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ld,{size:18,className:"text-toss-gray-500"}),n.jsx("h3",{className:"font-medium text-toss-gray-900",children:"  "})]}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",placeholder:"   ",value:pe,onChange:se=>_e(se.target.value),className:"pl-9 pr-4 py-2 bg-toss-gray-100 border-0 rounded-toss text-sm focus:ring-2 focus:ring-toss-blue w-56"}),n.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-toss-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-100",children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:""}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:""}),n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:" "}),n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:""}),n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-100",children:u.filter(se=>{if(!pe)return!0;const Ne=pe.toLowerCase();return se.name?.toLowerCase().includes(Ne)||se.team?.toLowerCase().includes(Ne)}).map(se=>{const Ne=l.find(Ue=>Ue.user_id===se.id),xe=Ne?.total_days??15,je=Ne?.used_days??0,de=xe-je,Oe=ne?.id===se.id;return n.jsxs("tr",{className:"hover:bg-toss-gray-50",children:[n.jsx("td",{className:"px-6 py-4",children:n.jsx("p",{className:"font-medium text-toss-gray-900",children:se.name})}),n.jsx("td",{className:"px-6 py-3 text-sm text-toss-gray-700",children:se.team||"-"}),n.jsx("td",{className:"px-6 py-3 text-center",children:Oe?n.jsx("input",{type:"number",value:H,onChange:Ue=>K(Ue.target.value),onBlur:async()=>{await Ct()},onKeyDown:async Ue=>{Ue.key==="Enter"?await Ct():Ue.key==="Escape"&&ie(null)},min:0,step:.5,className:"w-16 px-2 py-1 text-center bg-white border border-toss-blue rounded text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue",autoFocus:!0}):n.jsxs("span",{onClick:()=>{ie(se),K(xe)},className:"cursor-pointer hover:text-toss-blue font-medium",children:[xe,""]})}),n.jsxs("td",{className:"px-6 py-3 text-center text-sm text-toss-blue font-medium",children:[je,""]}),n.jsxs("td",{className:"px-6 py-3 text-center text-sm text-green-600 font-bold",children:[de,""]})]},se.id)})})]})})]}),n.jsx(dr,{isOpen:I,onClose:()=>{ae(!1),te("leave"),ee({leave_type:"full",start_date:"",end_date:"",reason:""})},title:" ",size:"lg",children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("button",{onClick:()=>te("overtime"),className:`p-4 rounded-toss border-2 text-left transition-all ${Q==="overtime"?"border-toss-blue bg-toss-blue/5":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(ta,{size:20,className:Q==="overtime"?"text-toss-blue":"text-toss-gray-400"}),n.jsx("span",{className:`font-medium ${Q==="overtime"?"text-toss-blue":"text-toss-gray-700"}`,children:" "})]}),n.jsx("p",{className:"text-xs text-toss-gray-500",children:",  "})]}),n.jsxs("button",{onClick:()=>te("leave"),className:`p-4 rounded-toss border-2 text-left transition-all ${Q==="leave"?"border-toss-blue bg-toss-blue/5":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(ha,{size:20,className:Q==="leave"?"text-toss-blue":"text-toss-gray-400"}),n.jsx("span",{className:`font-medium ${Q==="leave"?"text-toss-blue":"text-toss-gray-700"}`,children:" "})]}),n.jsx("p",{className:"text-xs text-toss-gray-500",children:", , "})]})]})]}),Q==="leave"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex gap-4 p-3 bg-toss-gray-50 rounded-toss",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-toss-gray-500",children:" : "}),n.jsxs("span",{className:"font-bold text-toss-blue",children:[oe,""]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-toss-gray-500",children:" : "}),n.jsxs("span",{className:"font-bold text-toss-gray-700",children:[Te,""]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.entries(o0).map(([se,Ne])=>{const xe=se==="comp"&&Te===0;return n.jsxs("button",{onClick:()=>!xe&&ee({...ve,leave_type:se}),disabled:xe,className:`p-3 rounded-toss border text-left transition-all ${ve.leave_type===se?"border-toss-blue bg-toss-blue/5":xe?"border-toss-gray-100 bg-toss-gray-50 cursor-not-allowed":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[n.jsx("p",{className:`font-medium text-sm ${ve.leave_type===se?"text-toss-blue":xe?"text-toss-gray-400":"text-toss-gray-700"}`,children:Ne.label}),n.jsx("p",{className:`text-xs mt-0.5 ${xe?"text-toss-gray-300":"text-toss-gray-500"}`,children:se==="comp"&&xe?" ":`${Ne.days} `})]},se)})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:[["full","comp"].includes(ve.leave_type)?"":""," ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:ve.start_date,onChange:se=>ee({...ve,start_date:se.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]}),["full","comp"].includes(ve.leave_type)&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"date",value:ve.end_date,onChange:se=>ee({...ve,end_date:se.target.value}),min:ve.start_date,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" ()"}),n.jsx("textarea",{value:ve.reason,onChange:se=>ee({...ve,reason:se.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:" "})]}),ve.start_date&&n.jsx("div",{className:"p-3 bg-toss-blue/5 rounded-toss border border-toss-blue/20",children:n.jsxs("p",{className:"text-sm text-toss-gray-700",children:[" :"," ",n.jsxs("span",{className:"font-bold text-toss-blue",children:[Ae(ve.leave_type,ve.start_date,["full","comp"].includes(ve.leave_type)?ve.end_date:ve.start_date),""]})]})})]}),Q==="overtime"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx("input",{type:"date",value:Se.start_date,onChange:se=>J({...Se,start_date:se.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"}),n.jsx("input",{type:"time",value:Se.start_time,onChange:se=>J({...Se,start_time:se.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx("input",{type:"date",value:Se.end_date,onChange:se=>J({...Se,end_date:se.target.value}),min:Se.start_date,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"}),n.jsx("input",{type:"time",value:Se.end_time,onChange:se=>J({...Se,end_time:se.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:Se.reason,onChange:se=>J({...Se,reason:se.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:"  "})]}),Se.start_date&&Se.start_time&&Se.end_date&&Se.end_time&&n.jsx("div",{className:"p-3 bg-toss-blue/5 rounded-toss border border-toss-blue/20",children:n.jsxs("p",{className:"text-sm text-toss-gray-700",children:[" :"," ",n.jsx("span",{className:"font-bold text-toss-blue",children:(()=>{const se=new Date(`${Se.start_date}T${Se.start_time}`),xe=(new Date(`${Se.end_date}T${Se.end_time}`)-se)/(1e3*60*60);if(xe>0){const je=Math.floor(xe),de=Math.round((xe-je)*60);return de>0?`${je} ${de}`:`${je}`}return"0"})()})]})})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{ae(!1),te("leave"),ee({leave_type:"full",start_date:"",end_date:"",reason:""}),J({start_date:"",start_time:"",end_date:"",end_time:"",reason:""})},className:"flex-1",children:""}),n.jsx(Ye,{onClick:Q==="overtime"?et:Re,className:"flex-1",disabled:h,children:""})]})]})}),n.jsx(dr,{isOpen:M,onClose:()=>{Y(!1),re(null),P("")},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("p",{className:"text-toss-gray-700",children:[n.jsx("span",{className:"font-medium",children:G?.isDocument?G?.drafter?.name:G?._name}),"  ."]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:ce,onChange:se=>P(se.target.value),rows:3,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:"  "})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{Y(!1),re(null),P("")},className:"flex-1",children:""}),n.jsx(Ye,{variant:"danger",onClick:At,className:"flex-1",disabled:h,children:""})]})]})}),n.jsx(dr,{isOpen:U,onClose:()=>{le(!1),ie(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("p",{className:"text-toss-gray-700",children:[n.jsx("span",{className:"font-medium",children:ne?.name})," ",x," "]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  "}),n.jsx("input",{type:"number",value:H,onChange:se=>K(se.target.value),min:0,step:.5,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(Ye,{variant:"secondary",onClick:()=>{le(!1),ie(null)},className:"flex-1",children:""}),n.jsx(Ye,{onClick:Ct,className:"flex-1",disabled:h,children:""})]})]})})]})},XZ=e=>{if(!e)return"";const t=new Date(e);return t.setMonth(t.getMonth()+4),t.toISOString().split("T")[0]},ME=e=>e?e.replace(/-/g,"."):"-",YZ=e=>{if(!e)return!1;const t=new Date(e),r=new Date,s=new Date(r.getFullYear(),r.getMonth()+1,r.getDate());return t<=s&&t>=r},l0=16;function gb({isOpen:e,onClose:t,records:r,stats:s}){const a=X.useRef(null),o=X.useRef(null),[l,u]=X.useState(!1),[d,h]=X.useState(!0),[m,x]=X.useState(null),[y,v]=X.useState(0),[b,g]=X.useState(1);X.useEffect(()=>{const C=()=>{u(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",C),()=>document.removeEventListener("fullscreenchange",C)},[]),X.useEffect(()=>{const C=L=>{L.key==="Escape"&&!l&&t(),L.key==="ArrowLeft"&&y>0&&v(O=>O-1),L.key==="ArrowRight"&&y<b-1&&v(O=>O+1)};return e&&document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[e,l,t,y,b]);const _=X.useCallback(async C=>{const L=a.current;if(!L)return;h(!0);const O=2,B=1920,F=1080;L.width=B*O,L.height=F*O;const q=L.getContext("2d");if(!q)return;q.imageSmoothingEnabled=!0,q.imageSmoothingQuality="high",q.scale(O,O);const fe="/company-intranet/",D=new Image;D.crossOrigin="anonymous",D.src=`${fe}back_2.jpg`,await new Promise(H=>{D.onload=()=>H(),D.onerror=()=>H()}),q.drawImage(D,0,0,B,F);const V=155,I=Math.max(1,Math.ceil(r.length/l0));g(I);const ae=C===0,Q=r.slice(C*l0,(C+1)*l0),te="#3b6cb5",ve="#ffffff",ee="rgba(255, 255, 255, 0.95)",Se="rgba(245, 247, 250, 0.95)",J="#1a2332",M="#2d3748",Y="#718096";let G=V;if(ae){const z=(B-804)/2;[{label:" ",value:s.total},{label:"  ",value:s.active},{label:" ",value:s.discharged}].forEach((A,W)=>{const pe=z+W*272;q.fillStyle=te,q.fillRect(pe,V,260,36),q.fillStyle=ve,q.font="bold 17px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.textBaseline="middle",q.fillText(A.label,pe+260/2,V+18),q.fillStyle=ee,q.fillRect(pe,V+36,260,54),q.fillStyle=J,q.font="bold 38px Pretendard, -apple-system, sans-serif";const _e=`${A.value}`,oe=q.measureText(_e).width;q.fillText(_e,pe+260/2-10,V+36+54/2),q.fillStyle=Y,q.font="20px Pretendard, -apple-system, sans-serif",q.fillText("",pe+260/2-10+oe/2+8,V+36+54/2+2)}),G=V+90+20}const re=60,ce=B-120,P=46,U=48,le=[{label:"No",width:55},{label:"",width:160},{label:"",width:190},{label:"",width:190},{label:"()",width:280},{label:"",width:160},{label:"",width:0}],ne=le.reduce((H,K)=>H+K.width,0);le[le.length-1].width=ce-ne,q.fillStyle=te,q.fillRect(re,G,ce,U),q.fillStyle=ve,q.font="bold 18px Pretendard, -apple-system, sans-serif",q.textBaseline="middle";let ie=re;if(le.forEach(H=>{q.textAlign="center",q.fillText(H.label,ie+H.width/2,G+U/2),ie+=H.width}),Q.forEach((H,K)=>{const S=C*l0+K,ue=G+U+K*P,z=H.ganghwa?H.discharge_date||XZ(H.admission_date):H.discharge_date||"";q.fillStyle=K%2===0?ee:Se,q.fillRect(re,ue,ce,P),q.textBaseline="middle";const T=ue+P/2;let A=re;q.fillStyle=Y,q.font="16px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText(`${S+1}`,A+le[0].width/2,T),A+=le[0].width,q.fillStyle=J,q.font="600 17px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText(ME(H.admission_date),A+le[1].width/2,T),A+=le[1].width,q.fillStyle=M,q.font="bold 17px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText(H.bupyeong||"-",A+le[2].width/2,T),A+=le[2].width,q.fillText(H.ganghwa||"-",A+le[3].width/2,T),A+=le[3].width;const W=H.location&&H.room?`${H.location}(${H.room})`:H.location||H.room||"-";q.fillText(W,A+le[4].width/2,T),A+=le[4].width,!H.ganghwa&&H.bupyeong&&!z?(q.fillStyle="#2563eb",q.font="600 17px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText("",A+le[5].width/2,T)):z?(q.fillStyle=YZ(z)?"#ef4444":"#2563eb",q.font="600 17px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText(ME(z),A+le[5].width/2,T)):(q.fillStyle=Y,q.font="17px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText("-",A+le[5].width/2,T)),A+=le[5].width,q.fillStyle=M,q.font="16px Pretendard, -apple-system, sans-serif",q.textAlign="left";const _e=le[6].width-20;let oe=H.notes||"-";for(;q.measureText(oe).width>_e&&oe.length>1;)oe=oe.slice(0,-1);oe!==(H.notes||"-")&&oe.length>0&&(oe+="..."),q.fillText(oe,A+10,T)}),I>1){const H=U+Q.length*P,K=G+H+25;q.fillStyle=Y,q.font="600 16px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText(`${C+1} / ${I} `,B/2,K)}x(L.toDataURL("image/png")),h(!1)},[r,s]);X.useEffect(()=>{if(e){v(0);const C=setTimeout(()=>{_(0)},100);return()=>clearTimeout(C)}},[e,_]),X.useEffect(()=>{e&&_(y)},[y,e,_]);const w=X.useCallback(()=>{document.fullscreenElement?document.exitFullscreen():o.current?.requestFullscreen()},[]),k=X.useCallback(()=>{const C=a.current;C&&C.toBlob(L=>{if(L){const O=URL.createObjectURL(L),B=document.createElement("a"),F=b>1?`_${y+1}`:"";B.download=`${F}_${new Date().toISOString().split("T")[0]}.png`,B.href=O,B.click(),URL.revokeObjectURL(O)}},"image/png")},[y,b]),N=()=>{y>0&&v(C=>C-1)},E=()=>{y<b-1&&v(C=>C+1)};return e?n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90",children:[n.jsx("canvas",{ref:a,width:1920,height:1080,style:{display:"none"}}),!l&&n.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-[60] p-3 bg-white rounded-full shadow-lg hover:bg-gray-100 transition-colors",title:" (ESC)",children:n.jsx(mr,{size:28})}),n.jsx("div",{ref:o,className:"relative flex items-center justify-center w-full h-full",children:d?n.jsx("div",{className:"text-white text-xl",children:" ..."}):m?n.jsxs(n.Fragment,{children:[n.jsx("img",{src:m,alt:"",className:`max-w-full max-h-full object-contain ${l?"w-full h-full":""}`,style:{maxWidth:l?"100%":"90vw",maxHeight:l?"100%":"90vh"}}),!l&&n.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-3 z-50",children:[b>1&&n.jsxs("div",{className:"flex items-center gap-1 bg-white/90 rounded-lg shadow-lg px-2",children:[n.jsx("button",{onClick:N,disabled:y===0,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-30 disabled:cursor-not-allowed",title:" ",children:n.jsx($a,{size:20})}),n.jsxs("span",{className:"text-sm font-medium text-gray-700 px-2",children:[y+1," / ",b]}),n.jsx("button",{onClick:E,disabled:y===b-1,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-30 disabled:cursor-not-allowed",title:" ",children:n.jsx(pa,{size:20})})]}),n.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-4 py-2 bg-white/90 hover:bg-white rounded-lg shadow-lg transition-all text-gray-800",title:" ",children:[n.jsx(ts,{size:20}),n.jsx("span",{className:"font-medium",children:""})]}),n.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-white/90 hover:bg-white rounded-lg shadow-lg transition-all text-gray-800",title:"",children:[n.jsx(U3,{size:20}),n.jsx("span",{className:"font-medium",children:""})]})]})]}):n.jsx("div",{className:"text-white text-xl",children:"   ."})})]}):null}const io=e=>{if(!e)return"";const t=new Date(e);return t.setMonth(t.getMonth()+4),t.toISOString().split("T")[0]},_a=e=>e?e.replace(/-/g,"."):"-",BE=e=>{if(!e)return!1;const t=new Date(e),r=new Date,s=new Date(r.getFullYear(),r.getMonth()+1,r.getDate());return t<=s&&t>=r},ad={admission_date:"",bupyeong:"",ganghwa:"",room:"",discharge_date:"",location:"",notes:""};function JZ(){const{profile:e,isAdmin:t}=Kr(),[r,s]=X.useState([]),[a,o]=X.useState(!0),[l,u]=X.useState(!1),[d,h]=X.useState(!1),[m,x]=X.useState(!1),[y,v]=X.useState(null),[b,g]=X.useState(null),[_,w]=X.useState(null),[k,N]=X.useState(ad),[E,C]=X.useState(!1),[L,O]=X.useState(!1),[B,F]=X.useState(!0),[q,fe]=X.useState(!0),[D,V]=X.useState(!1),I=X.useRef(null),ae=X.useCallback(async()=>{try{o(!0);const{data:K,error:S}=await Pe.from("admission_records").select("*").order("admission_date",{ascending:!1});if(S)throw S;s(K||[])}catch(K){console.error("  :",K)}finally{o(!1)}},[]);X.useEffect(()=>{ae()},[ae]);const Q=r.filter(K=>!K.is_discharged),te=r.filter(K=>K.is_discharged),ve=()=>{v(null),N(ad),u(!0)},ee=K=>{v(K),N({admission_date:K.admission_date||"",bupyeong:K.bupyeong||"",ganghwa:K.ganghwa||"",room:K.room||"",discharge_date:K.discharge_date||(K.bupyeong&&!K.ganghwa?"":""),location:K.location||"",notes:K.notes||""}),u(!0)},Se=K=>{g(K),h(!0)},J=async()=>{if(b)try{const{error:K}=await Pe.from("admission_records").delete().eq("id",b);if(K)throw K;await ae()}catch(K){console.error(" :",K),alert("   .")}finally{h(!1),g(null)}},M=K=>{w(K),x(!0)},Y=async()=>{if(_)try{const K=new Date().toISOString().split("T")[0],{error:S}=await Pe.from("admission_records").update({is_discharged:!0,discharge_date:K}).eq("id",_);if(S)throw S;await ae()}catch(K){console.error("  :",K),alert(`    .
${K?.message||JSON.stringify(K)}`)}finally{x(!1),w(null)}},G=async()=>{if(!k.admission_date){alert(" .");return}C(!0);try{let K=null;k.ganghwa?K=io(k.admission_date):k.discharge_date&&k.discharge_date!==""&&(K=k.discharge_date);const S={admission_date:k.admission_date,bupyeong:k.bupyeong,ganghwa:k.ganghwa,room:k.room,discharge_date:K,location:k.location,notes:k.notes};if(y){const{error:ue}=await Pe.from("admission_records").update(S).eq("id",y.id);if(ue)throw ue}else{const{error:ue}=await Pe.from("admission_records").insert({...S,is_discharged:!1});if(ue)throw ue}await ae(),u(!1),N(ad),v(null)}catch(K){console.error(" :",K),alert(`   .
${K?.message||JSON.stringify(K)}`)}finally{C(!1)}},re=()=>{if(r.length===0){alert("  .");return}const K=r.map((T,A)=>{const W=T.ganghwa?T.discharge_date||io(T.admission_date):T.discharge_date||"";return{No:A+1,:_a(T.admission_date),:T.bupyeong||"",:T.ganghwa||"",:T.location||"",:T.room||"",:!T.ganghwa&&T.bupyeong&&!W?"":_a(W),:T.notes||"",:T.is_discharged?"":" "}}),S=Wr.json_to_sheet(K),ue=Wr.book_new();Wr.book_append_sheet(ue,S,""),S["!cols"]=[{wch:5},{wch:14},{wch:15},{wch:15},{wch:20},{wch:10},{wch:14},{wch:25},{wch:10}];const z=new Date().toISOString().split("T")[0];gl(ue,`_${z}.xlsx`)},ce=()=>{const K=[["","","","","","",""]],S=Wr.aoa_to_sheet(K),ue=Wr.book_new();Wr.book_append_sheet(ue,S,""),S["!cols"]=[{wch:14},{wch:15},{wch:15},{wch:20},{wch:10},{wch:14},{wch:25}],gl(ue,"_.xlsx")},P=async K=>{const S=K.target.files?.[0];if(S){I.current&&(I.current.value=""),V(!0);try{const ue=await S.arrayBuffer(),z=Zc(ue),T=z.Sheets[z.SheetNames[0]],A=Wr.sheet_to_json(T);if(A.length===0){alert("   .");return}const W=Ae=>{if(!Ae)return"";if(typeof Ae=="number")return new Date((Ae-25569)*86400*1e3).toISOString().split("T")[0];const Re=String(Ae).trim(),et=Re.match(/(\d{4})[.\-/](\d{1,2})[.\-/](\d{1,2})/);return et?`${et[1]}-${et[2].padStart(2,"0")}-${et[3].padStart(2,"0")}`:Re},pe=A.map(Ae=>({admission_date:W(Ae.),bupyeong:String(Ae.||"").trim(),ganghwa:String(Ae.||"").trim(),room:String(Ae.||"").trim(),discharge_date:W(Ae.),location:String(Ae.||Ae.||"").trim(),notes:String(Ae.||"").trim()})).filter(Ae=>Ae.admission_date);if(pe.length===0){alert("  .  .");return}let _e=0,oe=0,Te=0;for(const Ae of pe){const Re=Ae.bupyeong||Ae.ganghwa,et=r.find(He=>(He.bupyeong||He.ganghwa)===Re&&He.admission_date===Ae.admission_date);if(et)if(et.room!==Ae.room||et.location!==Ae.location||et.notes!==Ae.notes||et.bupyeong!==Ae.bupyeong||et.ganghwa!==Ae.ganghwa){const at=Ae.ganghwa?io(Ae.admission_date):Ae.discharge_date||null,{error:De}=await Pe.from("admission_records").update({bupyeong:Ae.bupyeong,ganghwa:Ae.ganghwa,room:Ae.room,location:Ae.location,notes:Ae.notes,discharge_date:at}).eq("id",et.id);if(De)throw De;oe++}else Te++;else{const He=Ae.ganghwa?io(Ae.admission_date):Ae.discharge_date||null,{error:at}=await Pe.from("admission_records").insert({admission_date:Ae.admission_date,bupyeong:Ae.bupyeong,ganghwa:Ae.ganghwa,room:Ae.room,discharge_date:He,location:Ae.location,notes:Ae.notes,is_discharged:!1});if(at)throw at;_e++}}await ae();const Me=[];_e>0&&Me.push(` : ${_e}`),oe>0&&Me.push(`: ${oe}`),Te>0&&Me.push(` : ${Te}`),alert(` !
${Me.join(`
`)}`)}catch(ue){console.error("  :",ue),alert(`   .
${ue?.message||JSON.stringify(ue)}`)}finally{V(!1)}}},U=r.length,le=Q.length,ne=te.length,ie=Q,H=()=>{const S=`
      <div class="stats-grid">
        <div class="stat-box"><div class="label"> </div><div class="value">${U}<span class="unit"> </span></div></div>
        <div class="stat-box highlight"><div class="label">  </div><div class="value">${le}<span class="unit"> </span></div></div>
        <div class="stat-box"><div class="label"> </div><div class="value">${ne}<span class="unit"> </span></div></div>
      </div>
      <div class="section-title">   (${le})</div>
      <table>
        <thead><tr><th>No</th><th></th><th></th><th></th><th>()</th><th></th><th></th></tr></thead>
        <tbody>
          ${Q.map((ue,z)=>{const T=ue.ganghwa?ue.discharge_date||io(ue.admission_date):ue.discharge_date||"",A=ue.location&&ue.room?`${ue.location}(${ue.room})`:ue.location||ue.room||"-",pe=!ue.ganghwa&&ue.bupyeong&&!T?"":T?_a(T):"-";return`<tr>
              <td style="text-align:center">${z+1}</td>
              <td style="text-align:center">${_a(ue.admission_date)}</td>
              <td style="text-align:center">${ue.bupyeong||"-"}</td>
              <td style="text-align:center">${ue.ganghwa||"-"}</td>
              <td style="text-align:center">${A}</td>
              <td style="text-align:center">${pe}</td>
              <td>${ue.notes||"-"}</td>
            </tr>`}).join("")}
        </tbody>
      </table>
    `;ul({title:" ",content:S})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(ol,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:" "}),n.jsx("p",{className:"text-white/90",children:t?"    ":"  "})]})]})}),n.jsxs(Et,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-blue-50 border-b border-blue-100 cursor-pointer",onClick:()=>F(!B),children:[n.jsx("div",{className:"flex items-center gap-3",children:n.jsx("h3",{className:"font-bold text-toss-gray-900",children:"  "})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:K=>{K.stopPropagation(),O(!0)},className:"p-2 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:n.jsx(tm,{size:18})}),n.jsx("button",{onClick:K=>{K.stopPropagation(),H()},className:"p-2 text-toss-gray-600 hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:n.jsx(na,{size:18})}),B?n.jsx(_i,{size:20,className:"text-toss-gray-500"}):n.jsx($n,{size:20,className:"text-toss-gray-500"})]})]}),B&&n.jsx("div",{className:"p-4 sm:p-6",children:n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[U,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-blue-50 border-2 border-blue-300 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"  "}),n.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[le,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[ne,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]})]})})]}),n.jsxs(Et,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-toss-gray-100",children:[n.jsxs("h3",{className:"font-bold text-toss-gray-900",children:["  ",n.jsxs("span",{className:"text-sm font-normal text-blue-600 ml-1",children:["(",le,")"]})]}),n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsxs(Ye,{variant:"secondary",size:"sm",onClick:ce,children:[n.jsx(rm,{size:16,className:"mr-1"}),""]}),n.jsxs(Ye,{variant:"secondary",size:"sm",onClick:()=>I.current?.click(),disabled:D,children:[n.jsx(ji,{size:16,className:"mr-1"}),D?" ...":""]}),n.jsx("input",{ref:I,type:"file",accept:".xlsx,.xls",onChange:P,className:"hidden"}),n.jsxs(Ye,{variant:"secondary",size:"sm",onClick:re,children:[n.jsx(ts,{size:16,className:"mr-1"}),""]}),n.jsxs(Ye,{variant:"primary",size:"sm",onClick:ve,children:[n.jsx(ps,{size:16,className:"mr-1"}),""]})]})]}),a?n.jsx("div",{className:"flex justify-center items-center py-20",children:n.jsx("div",{className:"w-10 h-10 border-4 border-toss-blue border-t-transparent rounded-full animate-spin"})}):Q.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-toss-gray-400",children:[n.jsx(ol,{size:48,className:"mb-4"}),n.jsx("p",{className:"text-lg font-medium",children:"    "}),n.jsx("p",{className:"text-sm mt-1",children:"+     "})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:"No"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:"()"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-4 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""})]})}),n.jsx("tbody",{children:Q.map((K,S)=>{const ue=K.ganghwa?K.discharge_date||io(K.admission_date):K.discharge_date||"",z=!K.ganghwa&&K.bupyeong&&!ue,T=K.location&&K.room?`${K.location}(${K.room})`:K.location||K.room||"-";return n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors bg-blue-50/30",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500",children:S+1}),n.jsx("td",{className:"px-4 py-3 text-sm font-medium text-toss-gray-900",children:_a(K.admission_date)}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-700",children:K.bupyeong||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-700",children:K.ganghwa||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-700",children:T}),n.jsx("td",{className:"px-4 py-3 text-sm",children:z?n.jsx("span",{className:"font-medium text-blue-600",children:""}):ue?n.jsx("span",{className:`font-medium ${BE(ue)?"text-red-500":"text-blue-600"}`,children:_a(ue)}):n.jsx("span",{className:"text-toss-gray-400",children:"-"})}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500 max-w-[200px] truncate",children:K.notes||"-"}),n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:()=>M(K.id),className:"p-1.5 text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",title:"",children:n.jsx(Dc,{size:16})}),n.jsx("button",{onClick:()=>ee(K),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:"",children:n.jsx(js,{size:16})}),n.jsx("button",{onClick:()=>Se(K.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(Jt,{size:16})})]})})]},K.id)})})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:Q.map((K,S)=>{const ue=K.ganghwa?K.discharge_date||io(K.admission_date):K.discharge_date||"",z=!K.ganghwa&&K.bupyeong&&!ue;return n.jsxs("div",{className:"p-4 bg-blue-50/30",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",S+1]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>M(K.id),className:"p-1.5 text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",children:n.jsx(Dc,{size:14})}),n.jsx("button",{onClick:()=>ee(K),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",children:n.jsx(js,{size:14})}),n.jsx("button",{onClick:()=>Se(K.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Jt,{size:14})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:_a(K.admission_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),z?n.jsx("p",{className:"font-medium text-blue-600",children:""}):ue?n.jsx("p",{className:`font-medium ${BE(ue)?"text-red-500":"text-blue-600"}`,children:_a(ue)}):n.jsx("p",{className:"text-toss-gray-400",children:"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-700",children:K.bupyeong||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-700",children:K.ganghwa||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:"()"}),n.jsx("p",{className:"text-toss-gray-700",children:K.location&&K.room?`${K.location}(${K.room})`:K.location||K.room||"-"})]}),K.notes&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:K.notes})]})]})]},K.id)})})]})]}),te.length>0&&n.jsxs(Et,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-gray-50 border-b border-toss-gray-200 cursor-pointer",onClick:()=>fe(!q),children:[n.jsxs("h3",{className:"font-bold text-toss-gray-700",children:["  ",n.jsxs("span",{className:"text-sm font-normal text-toss-gray-500 ml-1",children:["(",ne,")"]})]}),q?n.jsx(_i,{size:20,className:"text-toss-gray-500"}):n.jsx($n,{size:20,className:"text-toss-gray-500"})]}),q&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:"No"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:"()"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-4 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""})]})}),n.jsx("tbody",{children:te.map((K,S)=>n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-400",children:S+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500",children:_a(K.admission_date)}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500",children:K.bupyeong||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500",children:K.ganghwa||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500",children:K.location&&K.room?`${K.location}(${K.room})`:K.location||K.room||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500",children:_a(K.discharge_date)}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-400 max-w-[200px] truncate",children:K.notes||"-"}),n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:()=>ee(K),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:"",children:n.jsx(js,{size:16})}),n.jsx("button",{onClick:()=>Se(K.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(Jt,{size:16})})]})})]},K.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:te.map((K,S)=>n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",S+1]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>ee(K),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",children:n.jsx(js,{size:14})}),n.jsx("button",{onClick:()=>Se(K.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Jt,{size:14})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:_a(K.admission_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:_a(K.discharge_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:K.bupyeong||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:K.ganghwa||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:"()"}),n.jsx("p",{className:"text-toss-gray-500",children:K.location&&K.room?`${K.location}(${K.room})`:K.location||K.room||"-"})]}),K.notes&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-400",children:K.notes})]})]})]},K.id))})]})]}),n.jsx(dr,{isOpen:l,onClose:()=>{u(!1),v(null),N(ad)},title:y?"  ":"  ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:k.admission_date,onChange:K=>N({...k,admission_date:K.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"}),k.admission_date&&k.ganghwa&&n.jsxs("p",{className:"text-xs text-toss-gray-400 mt-1",children:["  : ",_a(io(k.admission_date))," (4   )"]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("input",{type:"text",value:k.bupyeong,onChange:K=>N({...k,bupyeong:K.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("input",{type:"text",value:k.ganghwa,onChange:K=>N({...k,ganghwa:K.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("input",{type:"text",value:k.location,onChange:K=>N({...k,location:K.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("input",{type:"text",value:k.room,onChange:K=>N({...k,room:K.target.value}),placeholder:" ",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]})]}),k.bupyeong&&!k.ganghwa&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("select",{value:k.discharge_date===""?"":k.discharge_date?"date":"",onChange:K=>{if(K.target.value==="")N({...k,discharge_date:""});else{const ue=k.discharge_date!==""?k.discharge_date:"";N({...k,discharge_date:ue})}},className:"px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue bg-white",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"date",children:" "})]}),k.discharge_date!==""&&n.jsx("input",{type:"date",value:k.discharge_date,onChange:K=>N({...k,discharge_date:K.target.value}),className:"flex-1 px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("textarea",{value:k.notes,onChange:K=>N({...k,notes:K.target.value}),placeholder:" ",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue resize-none"})]}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{u(!1),v(null),N(ad)},children:""}),n.jsx(Ye,{variant:"primary",className:"flex-1",onClick:G,disabled:E,children:E?" ...":y?"":""})]})]})}),n.jsx(dr,{isOpen:d,onClose:()=>{h(!1),g(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 rounded-lg",children:[n.jsx(vl,{size:24,className:"text-red-500 flex-shrink-0"}),n.jsx("p",{className:"text-sm text-red-700",children:"   ?     ."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{h(!1),g(null)},children:""}),n.jsx(Ye,{variant:"danger",className:"flex-1",onClick:J,children:""})]})]})}),n.jsx(dr,{isOpen:m,onClose:()=>{x(!1),w(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 bg-orange-50 rounded-lg",children:[n.jsx(Dc,{size:24,className:"text-orange-500 flex-shrink-0"}),n.jsxs("p",{className:"text-sm text-orange-700",children:["   ?  (",_a(new Date().toISOString().split("T")[0]),") ."]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{x(!1),w(null)},children:""}),n.jsx(Ye,{variant:"primary",className:"flex-1 !bg-orange-500 hover:!bg-orange-600",onClick:Y,children:" "})]})]})}),n.jsx(gb,{isOpen:L,onClose:()=>O(!1),records:ie,stats:{total:U,active:le,discharged:ne}})]})}const nd=e=>{if(!e)return"";const t=new Date(e);return t.setMonth(t.getMonth()+4),t.toISOString().split("T")[0]},Os=e=>e?e.replace(/-/g,"."):"-",c0=e=>{if(!e)return!1;const t=new Date(e),r=new Date,s=new Date(r.getFullYear(),r.getMonth()+1,r.getDate());return t<=s&&t>=r},id={admission_date:"",bupyeong:"",ganghwa:"",room:"",discharge_date:"",location:"",admin_status:"",notes:""};function ZZ(){const{profile:e,isAdmin:t}=Kr(),[r,s]=X.useState([]),[a,o]=X.useState(!0),[l,u]=X.useState(!1),[d,h]=X.useState(!1),[m,x]=X.useState(!1),[y,v]=X.useState(null),[b,g]=X.useState(null),[_,w]=X.useState(null),[k,N]=X.useState(id),[E,C]=X.useState(!1),[L,O]=X.useState(!1),[B,F]=X.useState(!0),[q,fe]=X.useState(!0),[D,V]=X.useState(!1),I=X.useRef(null),ae=X.useCallback(async()=>{try{o(!0);const{data:S,error:ue}=await Pe.from("admission_records").select("*").order("admission_date",{ascending:!1});if(ue)throw ue;s(S||[])}catch(S){console.error("  :",S)}finally{o(!1)}},[]);X.useEffect(()=>{ae()},[ae]);const Q=S=>{if(!S)return 1/0;const ue=parseInt(S.replace(/[^0-9]/g,""),10);return isNaN(ue)?1/0:ue},te=r.filter(S=>!S.is_discharged).sort((S,ue)=>{const z=Q(S.room),T=Q(ue.room);return z!==1/0||T!==1/0?z-T:(S.admission_date||"").localeCompare(ue.admission_date||"")}),ve=r.filter(S=>S.is_discharged),ee=()=>{v(null),N(id),u(!0)},Se=S=>{v(S),N({admission_date:S.admission_date||"",bupyeong:S.bupyeong||"",ganghwa:S.ganghwa||"",room:S.room||"",discharge_date:S.discharge_date||"",location:S.location||"",admin_status:S.admin_status||"",notes:S.notes||""}),u(!0)},J=S=>{g(S),h(!0)},M=async()=>{if(b)try{const{error:S}=await Pe.from("admission_records").delete().eq("id",b);if(S)throw S;await ae()}catch(S){console.error(" :",S),alert("   .")}finally{h(!1),g(null)}},Y=S=>{w(S),x(!0)},G=async()=>{if(_)try{const S=new Date().toISOString().split("T")[0],{error:ue}=await Pe.from("admission_records").update({is_discharged:!0,discharge_date:S}).eq("id",_);if(ue)throw ue;await ae()}catch(S){console.error("  :",S),alert(`    .
${S?.message||JSON.stringify(S)}`)}finally{x(!1),w(null)}},re=async()=>{if(!k.admission_date){alert(" .");return}if(!k.ganghwa){alert(" .");return}C(!0);try{const S={admission_date:k.admission_date,bupyeong:k.bupyeong,ganghwa:k.ganghwa,room:k.room,discharge_date:k.discharge_date||null,location:k.location,admin_status:k.admin_status,notes:k.notes};if(y){const{error:ue}=await Pe.from("admission_records").update(S).eq("id",y.id);if(ue)throw ue}else{const{error:ue}=await Pe.from("admission_records").insert({...S,is_discharged:!1});if(ue)throw ue}await ae(),u(!1),N(id),v(null)}catch(S){console.error(" :",S),alert(`   .
${S?.message||JSON.stringify(S)}`)}finally{C(!1)}},ce=()=>{if(r.length===0){alert("  .");return}const S=r.map((A,W)=>{const pe=nd(A.admission_date);return{No:W+1,:A.location||"",:Os(A.admission_date),:A.ganghwa||"",:A.bupyeong||"",:A.room||""," ":Os(pe)," ":Os(A.discharge_date),:A.admin_status||"",:A.notes||"",:A.is_discharged?"":" "}}),ue=Wr.json_to_sheet(S),z=Wr.book_new();Wr.book_append_sheet(z,ue,""),ue["!cols"]=[{wch:5},{wch:12},{wch:14},{wch:12},{wch:8},{wch:8},{wch:14},{wch:14},{wch:15},{wch:25},{wch:10}];const T=new Date().toISOString().split("T")[0];gl(z,`__${T}.xlsx`)},P=()=>{const S=[["","","","",""," ","",""]],ue=Wr.aoa_to_sheet(S),z=Wr.book_new();Wr.book_append_sheet(z,ue,""),ue["!cols"]=[{wch:12},{wch:14},{wch:12},{wch:8},{wch:8},{wch:14},{wch:15},{wch:25}],gl(z,"__.xlsx")},U=async S=>{const ue=S.target.files?.[0];if(ue){I.current&&(I.current.value=""),V(!0);try{const z=await ue.arrayBuffer(),T=Zc(z),A=T.Sheets[T.SheetNames[0]],W=Wr.sheet_to_json(A);if(W.length===0){alert("   .");return}const pe=Re=>{if(!Re)return"";if(typeof Re=="number")return new Date((Re-25569)*86400*1e3).toISOString().split("T")[0];const et=String(Re).trim(),He=et.match(/(\d{4})[.\-/](\d{1,2})[.\-/](\d{1,2})/);if(He)return`${He[1]}-${He[2].padStart(2,"0")}-${He[3].padStart(2,"0")}`;const at=et.match(/(\d{2})[.\-/](\d{1,2})[.\-/](\d{1,2})/);if(at){const De=parseInt(at[1],10);return`${De>=50?1900+De:2e3+De}-${at[2].padStart(2,"0")}-${at[3].padStart(2,"0")}`}return et},_e=W.map(Re=>({admission_date:pe(Re.||Re.),bupyeong:String(Re.||Re.||"").trim(),ganghwa:String(Re.||Re.||"").trim(),room:String(Re.||"").trim(),discharge_date:pe(Re[" "]||Re.||Re.),location:String(Re.||Re.||Re.||"").trim(),admin_status:String(Re.||"").trim(),notes:String(Re.||"").trim()})).filter(Re=>Re.admission_date);if(_e.length===0){alert("  .  .");return}let oe=0,Te=0,Me=0;for(const Re of _e){const et=r.find(He=>He.ganghwa===Re.ganghwa&&He.admission_date===Re.admission_date);if(et)if(et.room!==Re.room||et.location!==Re.location||et.admin_status!==Re.admin_status||et.notes!==Re.notes||et.bupyeong!==Re.bupyeong){const{error:at}=await Pe.from("admission_records").update({bupyeong:Re.bupyeong,ganghwa:Re.ganghwa,room:Re.room,location:Re.location,admin_status:Re.admin_status,notes:Re.notes,discharge_date:Re.discharge_date||null}).eq("id",et.id);if(at)throw at;Te++}else Me++;else{const{error:He}=await Pe.from("admission_records").insert({admission_date:Re.admission_date,bupyeong:Re.bupyeong,ganghwa:Re.ganghwa,room:Re.room,discharge_date:Re.discharge_date||null,location:Re.location,admin_status:Re.admin_status,notes:Re.notes,is_discharged:!1});if(He)throw He;oe++}}await ae();const Ae=[];oe>0&&Ae.push(` : ${oe}`),Te>0&&Ae.push(`: ${Te}`),Me>0&&Ae.push(` : ${Me}`),alert(` !
${Ae.join(`
`)}`)}catch(z){console.error("  :",z),alert(`   .
${z?.message||JSON.stringify(z)}`)}finally{V(!1)}}},le=r.length,ne=te.length,ie=ve.length,H=te,K=()=>{const ue=`
      <div class="stats-grid">
        <div class="stat-box"><div class="label"> </div><div class="value">${le}<span class="unit"> </span></div></div>
        <div class="stat-box highlight"><div class="label">  </div><div class="value">${ne}<span class="unit"> </span></div></div>
        <div class="stat-box"><div class="label"> </div><div class="value">${ie}<span class="unit"> </span></div></div>
      </div>
      <div class="section-title">   (${ne})</div>
      <table>
        <thead><tr>
          <th>No</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th> </th>
          <th> </th>
          <th></th>
          <th></th>
        </tr></thead>
        <tbody>
          ${te.map((z,T)=>{const A=nd(z.admission_date);return`<tr>
              <td style="text-align:center">${T+1}</td>
              <td style="text-align:center">${z.location||"-"}</td>
              <td style="text-align:center">${Os(z.admission_date)}</td>
              <td style="text-align:center">${z.ganghwa||"-"}</td>
              <td style="text-align:center">${z.bupyeong||"-"}</td>
              <td style="text-align:center">${z.room||"-"}</td>
              <td style="text-align:center">${Os(A)}</td>
              <td style="text-align:center">${z.discharge_date?Os(z.discharge_date):"-"}</td>
              <td style="text-align:center;white-space:pre-line">${z.admin_status||"-"}</td>
              <td>${z.notes||"-"}</td>
            </tr>`}).join("")}
        </tbody>
      </table>
    `;ul({title:"   ",content:ue})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(ol,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:"  "}),n.jsx("p",{className:"text-white/90",children:t?"     ":"    "})]})]})}),n.jsxs(Et,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-blue-50 border-b border-blue-100 cursor-pointer",onClick:()=>F(!B),children:[n.jsx("div",{className:"flex items-center gap-3",children:n.jsx("h3",{className:"font-bold text-toss-gray-900",children:"  "})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:S=>{S.stopPropagation(),O(!0)},className:"p-2 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:n.jsx(tm,{size:18})}),n.jsx("button",{onClick:S=>{S.stopPropagation(),K()},className:"p-2 text-toss-gray-600 hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:n.jsx(na,{size:18})}),B?n.jsx(_i,{size:20,className:"text-toss-gray-500"}):n.jsx($n,{size:20,className:"text-toss-gray-500"})]})]}),B&&n.jsx("div",{className:"p-4 sm:p-6",children:n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[le,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-blue-50 border-2 border-blue-300 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"  "}),n.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[ne,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[ie,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]})]})})]}),n.jsxs(Et,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-toss-gray-100",children:[n.jsxs("h3",{className:"font-bold text-toss-gray-900",children:["  ",n.jsxs("span",{className:"text-sm font-normal text-blue-600 ml-1",children:["(",ne,")"]})]}),n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsxs(Ye,{variant:"secondary",size:"sm",onClick:P,children:[n.jsx(rm,{size:16,className:"mr-1"}),""]}),n.jsxs(Ye,{variant:"secondary",size:"sm",onClick:()=>I.current?.click(),disabled:D,children:[n.jsx(ji,{size:16,className:"mr-1"}),D?" ...":""]}),n.jsx("input",{ref:I,type:"file",accept:".xlsx,.xls",onChange:U,className:"hidden"}),n.jsxs(Ye,{variant:"secondary",size:"sm",onClick:ce,children:[n.jsx(ts,{size:16,className:"mr-1"}),""]}),n.jsxs(Ye,{variant:"primary",size:"sm",onClick:ee,children:[n.jsx(ps,{size:16,className:"mr-1"}),""]})]})]}),a?n.jsx("div",{className:"flex justify-center items-center py-20",children:n.jsx("div",{className:"w-10 h-10 border-4 border-toss-blue border-t-transparent rounded-full animate-spin"})}):te.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-toss-gray-400",children:[n.jsx(ol,{size:48,className:"mb-4"}),n.jsx("p",{className:"text-lg font-medium",children:"    "}),n.jsx("p",{className:"text-sm mt-1",children:"+     "})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsxs("thead",{children:[n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-12",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",colSpan:2,children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-36",children:""})]}),n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{colSpan:6}),n.jsx("th",{className:"px-2 py-1 text-center text-[10px] font-medium text-toss-gray-500",children:" "}),n.jsx("th",{className:"px-2 py-1 text-center text-[10px] font-medium text-toss-gray-500",children:" "}),n.jsx("th",{colSpan:3})]})]}),n.jsx("tbody",{children:te.map((S,ue)=>{const z=nd(S.admission_date),T=S.discharge_date;return n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors bg-blue-50/30",children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:ue+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:S.location||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm font-medium text-toss-gray-900 text-center",children:Os(S.admission_date)}),n.jsx("td",{className:"px-3 py-3 text-sm font-medium text-toss-gray-900 text-center",children:S.ganghwa||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:S.bupyeong||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:S.room||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-center",children:n.jsx("span",{className:`font-medium ${c0(z)?"text-red-500":"text-blue-600"}`,children:Os(z)})}),n.jsx("td",{className:"px-3 py-3 text-sm text-center",children:T&&T!==z?n.jsx("span",{className:`font-medium ${c0(T)?"text-red-500":"text-orange-600"}`,children:Os(T)}):n.jsx("span",{className:"text-toss-gray-400",children:"-"})}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center whitespace-pre-line",children:S.admin_status||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 max-w-[150px] truncate",children:S.notes||"-"}),n.jsx("td",{className:"px-2 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-1 whitespace-nowrap",children:[n.jsx("button",{onClick:()=>Y(S.id),className:"px-2 py-1 text-xs font-medium text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",title:"",children:""}),n.jsx("button",{onClick:()=>Se(S),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:"",children:n.jsx(js,{size:16})}),n.jsx("button",{onClick:()=>J(S.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(Jt,{size:16})})]})})]},S.id)})})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:te.map((S,ue)=>{const z=nd(S.admission_date),T=S.discharge_date;return n.jsxs("div",{className:"px-3 py-2 bg-blue-50/30",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",ue+1]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>Y(S.id),className:"px-2 py-0.5 text-xs font-medium text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:()=>Se(S),className:"p-1 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",children:n.jsx(js,{size:14})}),n.jsx("button",{onClick:()=>J(S.id),className:"p-1 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Jt,{size:14})})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-x-2 gap-y-1 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:S.ganghwa||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-700",children:S.location||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-700",children:S.bupyeong||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:Os(S.admission_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:" "}),n.jsx("p",{className:`font-medium ${c0(z)?"text-red-500":"text-blue-600"}`,children:Os(z)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-700",children:S.room||"-"})]}),T&&T!==z&&n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:" "}),n.jsx("p",{className:`font-medium ${c0(T)?"text-red-500":"text-orange-600"}`,children:Os(T)})]}),S.admin_status&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-500 whitespace-pre-line",children:S.admin_status})]}),S.notes&&n.jsxs("div",{className:"col-span-3",children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:S.notes})]})]})]},S.id)})})]})]}),ve.length>0&&n.jsxs(Et,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-gray-50 border-b border-toss-gray-200 cursor-pointer",onClick:()=>fe(!q),children:[n.jsxs("h3",{className:"font-bold text-toss-gray-700",children:["  ",n.jsxs("span",{className:"text-sm font-normal text-toss-gray-500 ml-1",children:["(",ie,")"]})]}),q?n.jsx(_i,{size:20,className:"text-toss-gray-500"}):n.jsx($n,{size:20,className:"text-toss-gray-500"})]}),q&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-12",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-20",children:""})]})}),n.jsx("tbody",{children:ve.map((S,ue)=>n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors",children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 text-center",children:ue+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:S.location||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:Os(S.admission_date)}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:S.ganghwa||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:S.bupyeong||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:S.room||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:Os(S.discharge_date)}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 text-center whitespace-pre-line",children:S.admin_status||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 max-w-[150px] truncate",children:S.notes||"-"}),n.jsx("td",{className:"px-3 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:()=>Se(S),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:"",children:n.jsx(js,{size:16})}),n.jsx("button",{onClick:()=>J(S.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(Jt,{size:16})})]})})]},S.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:ve.map((S,ue)=>n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",ue+1]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>Se(S),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",children:n.jsx(js,{size:14})}),n.jsx("button",{onClick:()=>J(S.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Jt,{size:14})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:S.ganghwa||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:S.location||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:Os(S.admission_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:Os(S.discharge_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:S.bupyeong||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:S.room||"-"})]}),S.admin_status&&n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-400 whitespace-pre-line",children:S.admin_status})]}),S.notes&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-400",children:S.notes})]})]})]},S.id))})]})]}),n.jsx(dr,{isOpen:l,onClose:()=>{u(!1),v(null),N(id)},title:y?"  ":"  ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:k.ganghwa,onChange:S=>N({...k,ganghwa:S.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("input",{type:"text",value:k.location,onChange:S=>N({...k,location:S.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsxs("select",{value:k.bupyeong,onChange:S=>N({...k,bupyeong:S.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue bg-white",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("input",{type:"text",value:k.room,onChange:S=>N({...k,room:S.target.value}),placeholder:" ",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:k.admission_date,onChange:S=>N({...k,admission_date:S.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"}),k.admission_date&&n.jsxs("p",{className:"text-xs text-toss-gray-400 mt-1",children:[" : ",Os(nd(k.admission_date))," ( )"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:" "}),n.jsx("input",{type:"date",value:k.discharge_date,onChange:S=>N({...k,discharge_date:S.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"}),n.jsx("p",{className:"text-xs text-toss-gray-400 mt-1",children:"  ,    "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("textarea",{value:k.admin_status,onChange:S=>N({...k,admin_status:S.target.value}),placeholder:"  (  )",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue resize-none"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("textarea",{value:k.notes,onChange:S=>N({...k,notes:S.target.value}),placeholder:" ",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue resize-none"})]}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{u(!1),v(null),N(id)},children:""}),n.jsx(Ye,{variant:"primary",className:"flex-1",onClick:re,disabled:E,children:E?" ...":y?"":""})]})]})}),n.jsx(dr,{isOpen:d,onClose:()=>{h(!1),g(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 rounded-lg",children:[n.jsx(vl,{size:24,className:"text-red-500 flex-shrink-0"}),n.jsx("p",{className:"text-sm text-red-700",children:"   ?     ."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{h(!1),g(null)},children:""}),n.jsx(Ye,{variant:"danger",className:"flex-1",onClick:M,children:""})]})]})}),n.jsx(dr,{isOpen:m,onClose:()=>{x(!1),w(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 bg-orange-50 rounded-lg",children:[n.jsx(Dc,{size:24,className:"text-orange-500 flex-shrink-0"}),n.jsxs("p",{className:"text-sm text-orange-700",children:["   ?  (",Os(new Date().toISOString().split("T")[0]),") ."]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{x(!1),w(null)},children:""}),n.jsx(Ye,{variant:"primary",className:"flex-1 !bg-orange-500 hover:!bg-orange-600",onClick:G,children:" "})]})]})}),n.jsx(gb,{isOpen:L,onClose:()=>O(!1),records:H,stats:{total:le,active:ne,discharged:ie},backgroundImage:"back_gw.jpg"})]})}const od=e=>{if(!e)return"";const t=new Date(e);return t.setMonth(t.getMonth()+4),t.toISOString().split("T")[0]},Fs=e=>e?e.replace(/-/g,"."):"-",u0=e=>{if(!e)return!1;const t=new Date(e),r=new Date,s=new Date(r.getFullYear(),r.getMonth()+1,r.getDate());return t<=s&&t>=r},bc=e=>{if(!e)return!0;const t=e.trim();return/^\d+?$/.test(t)},Vo="bupyeong_admission_records",ld={admission_date:"",name:"",gender:"",room:"",discharge_date:"",nationality:"",admin_status:"",notes:""};function QZ(){const{profile:e,isAdmin:t}=Kr(),[r,s]=X.useState([]),[a,o]=X.useState(!0),[l,u]=X.useState(!1),[d,h]=X.useState(!1),[m,x]=X.useState(!1),[y,v]=X.useState(null),[b,g]=X.useState(null),[_,w]=X.useState(null),[k,N]=X.useState(ld),[E,C]=X.useState(!1),[L,O]=X.useState(!1),[B,F]=X.useState(!0),[q,fe]=X.useState(!0),[D,V]=X.useState(!1),I=X.useRef(null),ae=X.useCallback(async()=>{try{o(!0);const{data:S,error:ue}=await Pe.from(Vo).select("*").order("admission_date",{ascending:!1});if(ue)throw ue;s(S||[])}catch(S){console.error("   :",S)}finally{o(!1)}},[]);X.useEffect(()=>{ae()},[ae]);const Q=S=>{if(!S)return 1/0;const ue=parseInt(S.replace(/[^0-9]/g,""),10);return isNaN(ue)?1/0:ue},te=r.filter(S=>!S.is_discharged).sort((S,ue)=>Q(S.room)-Q(ue.room)),ve=r.filter(S=>S.is_discharged),ee=()=>{v(null),N(ld),u(!0)},Se=S=>{v(S),N({admission_date:S.admission_date||"",name:S.name||"",gender:S.gender||"",room:S.room||"",discharge_date:S.discharge_date||"",nationality:S.nationality||"",admin_status:S.admin_status||"",notes:S.notes||""}),u(!0)},J=S=>{g(S),h(!0)},M=async()=>{if(b)try{const{error:S}=await Pe.from(Vo).delete().eq("id",b);if(S)throw S;await ae()}catch(S){console.error(" :",S),alert("   .")}finally{h(!1),g(null)}},Y=S=>{w(S),x(!0)},G=async()=>{if(_)try{const S=new Date().toISOString().split("T")[0],{error:ue}=await Pe.from(Vo).update({is_discharged:!0,discharge_date:S}).eq("id",_);if(ue)throw ue;await ae()}catch(S){console.error("  :",S),alert(`    .
${S?.message||JSON.stringify(S)}`)}finally{x(!1),w(null)}},re=async()=>{if(!k.admission_date){alert(" .");return}if(!k.name){alert(" .");return}C(!0);try{const S={admission_date:k.admission_date,name:k.name,gender:k.gender,room:k.room,discharge_date:k.discharge_date||null,nationality:k.nationality,admin_status:k.admin_status,notes:k.notes};if(y){const{error:ue}=await Pe.from(Vo).update(S).eq("id",y.id);if(ue)throw ue}else{const{error:ue}=await Pe.from(Vo).insert({...S,is_discharged:!1});if(ue)throw ue}await ae(),u(!1),N(ld),v(null)}catch(S){console.error(" :",S),alert(`   .
${S?.message||JSON.stringify(S)}`)}finally{C(!1)}},ce=()=>{if(r.length===0){alert("  .");return}const S=r.map((A,W)=>{const pe=bc(A.room)?od(A.admission_date):"";return{No:W+1,:A.nationality||"",:Fs(A.admission_date),:A.name||"",:A.gender||"","  ()":A.room||""," ":pe?Fs(pe):""," ":Fs(A.discharge_date),:A.admin_status||"",:A.notes||"",:A.is_discharged?"":" "}}),ue=Wr.json_to_sheet(S),z=Wr.book_new();Wr.book_append_sheet(z,ue,""),ue["!cols"]=[{wch:5},{wch:12},{wch:14},{wch:12},{wch:8},{wch:15},{wch:14},{wch:14},{wch:15},{wch:25},{wch:10}];const T=new Date().toISOString().split("T")[0];gl(z,`__${T}.xlsx`)},P=()=>{const S=[["","","","","  ()"," ","",""]],ue=Wr.aoa_to_sheet(S),z=Wr.book_new();Wr.book_append_sheet(z,ue,""),ue["!cols"]=[{wch:12},{wch:14},{wch:12},{wch:8},{wch:15},{wch:14},{wch:15},{wch:25}],gl(z,"__.xlsx")},U=async S=>{const ue=S.target.files?.[0];if(ue){I.current&&(I.current.value=""),V(!0);try{const z=await ue.arrayBuffer(),T=Zc(z),A=T.Sheets[T.SheetNames[0]],W=Wr.sheet_to_json(A);if(W.length===0){alert("   .");return}const pe=Re=>{if(!Re)return"";if(typeof Re=="number")return new Date((Re-25569)*86400*1e3).toISOString().split("T")[0];const et=String(Re).trim(),He=et.match(/(\d{4})[.\-/](\d{1,2})[.\-/](\d{1,2})/);if(He)return`${He[1]}-${He[2].padStart(2,"0")}-${He[3].padStart(2,"0")}`;const at=et.match(/(\d{2})[.\-/](\d{1,2})[.\-/](\d{1,2})/);if(at){const De=parseInt(at[1],10);return`${De>=50?1900+De:2e3+De}-${at[2].padStart(2,"0")}-${at[3].padStart(2,"0")}`}return et},_e=W.map(Re=>({admission_date:pe(Re.||Re.),name:String(Re.||"").trim(),gender:String(Re.||"").trim(),room:String(Re["  ()"]||Re.||"").trim(),discharge_date:pe(Re[" "]||Re.||Re.),nationality:String(Re.||Re.||"").trim(),admin_status:String(Re.||"").trim(),notes:String(Re.||"").trim()})).filter(Re=>Re.admission_date);if(_e.length===0){alert("  .  .");return}let oe=0,Te=0,Me=0;for(const Re of _e){const et=r.find(He=>He.name===Re.name&&He.admission_date===Re.admission_date);if(et)if(et.room!==Re.room||et.nationality!==Re.nationality||et.admin_status!==Re.admin_status||et.notes!==Re.notes||et.gender!==Re.gender){const{error:at}=await Pe.from(Vo).update({name:Re.name,gender:Re.gender,room:Re.room,nationality:Re.nationality,admin_status:Re.admin_status,notes:Re.notes,discharge_date:Re.discharge_date||null}).eq("id",et.id);if(at)throw at;Te++}else Me++;else{const{error:He}=await Pe.from(Vo).insert({admission_date:Re.admission_date,name:Re.name,gender:Re.gender,room:Re.room,discharge_date:Re.discharge_date||null,nationality:Re.nationality,admin_status:Re.admin_status,notes:Re.notes,is_discharged:!1});if(He)throw He;oe++}}await ae();const Ae=[];oe>0&&Ae.push(` : ${oe}`),Te>0&&Ae.push(`: ${Te}`),Me>0&&Ae.push(` : ${Me}`),alert(` !
${Ae.join(`
`)}`)}catch(z){console.error("  :",z),alert(`   .
${z?.message||JSON.stringify(z)}`)}finally{V(!1)}}},le=r.length,ne=te.length,ie=ve.length,H=te.map(S=>({id:S.id,admission_date:S.admission_date,bupyeong:S.gender,ganghwa:S.name,room:S.room,discharge_date:S.discharge_date,location:S.nationality,admin_status:S.admin_status,notes:S.notes})),K=()=>{const ue=`
      <div class="stats-grid">
        <div class="stat-box"><div class="label"> </div><div class="value">${le}<span class="unit"> </span></div></div>
        <div class="stat-box highlight"><div class="label">  </div><div class="value">${ne}<span class="unit"> </span></div></div>
        <div class="stat-box"><div class="label"> </div><div class="value">${ie}<span class="unit"> </span></div></div>
      </div>
      <div class="section-title">   (${ne})</div>
      <table>
        <thead><tr>
          <th>No</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th>  ()</th>
          <th> </th>
          <th> </th>
          <th></th>
          <th></th>
        </tr></thead>
        <tbody>
          ${te.map((z,T)=>{const A=bc(z.room)?od(z.admission_date):"";return`<tr>
              <td style="text-align:center">${T+1}</td>
              <td style="text-align:center">${z.nationality||"-"}</td>
              <td style="text-align:center">${Fs(z.admission_date)}</td>
              <td style="text-align:center">${z.name||"-"}</td>
              <td style="text-align:center">${z.gender||"-"}</td>
              <td style="text-align:center">${z.room||"-"}</td>
              <td style="text-align:center">${A?Fs(A):"-"}</td>
              <td style="text-align:center">${z.discharge_date?Fs(z.discharge_date):"-"}</td>
              <td style="text-align:center;white-space:pre-line">${z.admin_status||"-"}</td>
              <td>${z.notes||"-"}</td>
            </tr>`}).join("")}
        </tbody>
      </table>
    `;ul({title:"   ",content:ue})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{className:"bg-gradient-to-r from-emerald-500 to-teal-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(ol,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:"  "}),n.jsx("p",{className:"text-white/90",children:t?"     ":"    "})]})]})}),n.jsxs(Et,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-emerald-50 border-b border-emerald-100 cursor-pointer",onClick:()=>F(!B),children:[n.jsx("div",{className:"flex items-center gap-3",children:n.jsx("h3",{className:"font-bold text-toss-gray-900",children:"  "})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:S=>{S.stopPropagation(),O(!0)},className:"p-2 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",title:" ",children:n.jsx(tm,{size:18})}),n.jsx("button",{onClick:S=>{S.stopPropagation(),K()},className:"p-2 text-toss-gray-600 hover:bg-emerald-100 rounded-lg transition-colors",title:" ",children:n.jsx(na,{size:18})}),B?n.jsx(_i,{size:20,className:"text-toss-gray-500"}):n.jsx($n,{size:20,className:"text-toss-gray-500"})]})]}),B&&n.jsx("div",{className:"p-4 sm:p-6",children:n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[le,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-emerald-50 border-2 border-emerald-300 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-emerald-600 mb-1",children:"  "}),n.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:[ne,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[ie,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]})]})})]}),n.jsxs(Et,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-toss-gray-100",children:[n.jsxs("h3",{className:"font-bold text-toss-gray-900",children:["  ",n.jsxs("span",{className:"text-sm font-normal text-emerald-600 ml-1",children:["(",ne,")"]})]}),n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsxs(Ye,{variant:"secondary",size:"sm",onClick:P,children:[n.jsx(rm,{size:16,className:"mr-1"}),""]}),n.jsxs(Ye,{variant:"secondary",size:"sm",onClick:()=>I.current?.click(),disabled:D,children:[n.jsx(ji,{size:16,className:"mr-1"}),D?" ...":""]}),n.jsx("input",{ref:I,type:"file",accept:".xlsx,.xls",onChange:U,className:"hidden"}),n.jsxs(Ye,{variant:"secondary",size:"sm",onClick:ce,children:[n.jsx(ts,{size:16,className:"mr-1"}),""]}),n.jsxs(Ye,{variant:"primary",size:"sm",onClick:ee,children:[n.jsx(ps,{size:16,className:"mr-1"}),""]})]})]}),a?n.jsx("div",{className:"flex justify-center items-center py-20",children:n.jsx("div",{className:"w-10 h-10 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin"})}):te.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-toss-gray-400",children:[n.jsx(ol,{size:48,className:"mb-4"}),n.jsx("p",{className:"text-lg font-medium",children:"    "}),n.jsx("p",{className:"text-sm mt-1",children:"+     "})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsxs("thead",{children:[n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-12",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:"  ()"}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",colSpan:2,children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-24",children:""})]}),n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{colSpan:6}),n.jsx("th",{className:"px-2 py-1 text-center text-[10px] font-medium text-toss-gray-500",children:" "}),n.jsx("th",{className:"px-2 py-1 text-center text-[10px] font-medium text-toss-gray-500",children:" "}),n.jsx("th",{colSpan:3})]})]}),n.jsx("tbody",{children:te.map((S,ue)=>{const T=bc(S.room)?od(S.admission_date):"",A=S.discharge_date;return n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors bg-emerald-50/30",children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:ue+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:S.nationality||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm font-medium text-toss-gray-900 text-center",children:Fs(S.admission_date)}),n.jsx("td",{className:"px-3 py-3 text-sm font-medium text-toss-gray-900 text-center",children:S.name||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:S.gender||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:S.room||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-center",children:T?n.jsx("span",{className:`font-medium ${u0(T)?"text-red-500":"text-emerald-600"}`,children:Fs(T)}):n.jsx("span",{className:"text-toss-gray-400",children:"-"})}),n.jsx("td",{className:"px-3 py-3 text-sm text-center",children:A&&A!==T?n.jsx("span",{className:`font-medium ${u0(A)?"text-red-500":"text-orange-600"}`,children:Fs(A)}):n.jsx("span",{className:"text-toss-gray-400",children:"-"})}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center whitespace-pre-line",children:S.admin_status||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 max-w-[150px] truncate",children:S.notes||"-"}),n.jsx("td",{className:"px-2 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-1 whitespace-nowrap",children:[n.jsx("button",{onClick:()=>Y(S.id),className:"px-2 py-1 text-xs font-medium text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",title:"",children:""}),n.jsx("button",{onClick:()=>Se(S),className:"p-1.5 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",title:"",children:n.jsx(js,{size:16})}),n.jsx("button",{onClick:()=>J(S.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(Jt,{size:16})})]})})]},S.id)})})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:te.map((S,ue)=>{const T=bc(S.room)?od(S.admission_date):"",A=S.discharge_date;return n.jsxs("div",{className:"px-3 py-2 bg-emerald-50/30",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",ue+1]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>Y(S.id),className:"px-2 py-0.5 text-xs font-medium text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:()=>Se(S),className:"p-1 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",children:n.jsx(js,{size:14})}),n.jsx("button",{onClick:()=>J(S.id),className:"p-1 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Jt,{size:14})})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-x-2 gap-y-1 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:S.name||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-700",children:S.nationality||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-700",children:S.gender||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:Fs(S.admission_date)})]}),T&&n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:" "}),n.jsx("p",{className:`font-medium ${u0(T)?"text-red-500":"text-emerald-600"}`,children:Fs(T)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:"/"}),n.jsx("p",{className:"text-toss-gray-700",children:S.room||"-"})]}),A&&A!==T&&n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:" "}),n.jsx("p",{className:`font-medium ${u0(A)?"text-red-500":"text-orange-600"}`,children:Fs(A)})]}),S.admin_status&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-500 whitespace-pre-line",children:S.admin_status})]}),S.notes&&n.jsxs("div",{className:"col-span-3",children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:S.notes})]})]})]},S.id)})})]})]}),ve.length>0&&n.jsxs(Et,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-gray-50 border-b border-toss-gray-200 cursor-pointer",onClick:()=>fe(!q),children:[n.jsxs("h3",{className:"font-bold text-toss-gray-700",children:["  ",n.jsxs("span",{className:"text-sm font-normal text-toss-gray-500 ml-1",children:["(",ie,")"]})]}),q?n.jsx(_i,{size:20,className:"text-toss-gray-500"}):n.jsx($n,{size:20,className:"text-toss-gray-500"})]}),q&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-12",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:"  ()"}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-20",children:""})]})}),n.jsx("tbody",{children:ve.map((S,ue)=>n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors",children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 text-center",children:ue+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:S.nationality||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:Fs(S.admission_date)}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:S.name||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:S.gender||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:S.room||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:Fs(S.discharge_date)}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 text-center whitespace-pre-line",children:S.admin_status||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 max-w-[150px] truncate",children:S.notes||"-"}),n.jsx("td",{className:"px-3 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:()=>Se(S),className:"p-1.5 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",title:"",children:n.jsx(js,{size:16})}),n.jsx("button",{onClick:()=>J(S.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(Jt,{size:16})})]})})]},S.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:ve.map((S,ue)=>n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",ue+1]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>Se(S),className:"p-1.5 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",children:n.jsx(js,{size:14})}),n.jsx("button",{onClick:()=>J(S.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Jt,{size:14})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:S.name||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:S.nationality||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:Fs(S.admission_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:Fs(S.discharge_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:S.gender||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:"  ()"}),n.jsx("p",{className:"text-toss-gray-500",children:S.room||"-"})]}),S.admin_status&&n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-400 whitespace-pre-line",children:S.admin_status})]}),S.notes&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-400",children:S.notes})]})]})]},S.id))})]})]}),n.jsx(dr,{isOpen:l,onClose:()=>{u(!1),v(null),N(ld)},title:y?"  ":"  ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:k.name,onChange:S=>N({...k,name:S.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("input",{type:"text",value:k.nationality,onChange:S=>N({...k,nationality:S.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsxs("select",{value:k.gender,onChange:S=>N({...k,gender:S.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 bg-white",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:"  ()"}),n.jsx("input",{type:"text",value:k.room,onChange:S=>N({...k,room:S.target.value}),placeholder:": 301  OO(301)",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:k.admission_date,onChange:S=>N({...k,admission_date:S.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"}),k.admission_date&&bc(k.room)&&n.jsxs("p",{className:"text-xs text-toss-gray-400 mt-1",children:[" : ",Fs(od(k.admission_date))," ( )"]}),k.admission_date&&!bc(k.room)&&n.jsx("p",{className:"text-xs text-orange-400 mt-1",children:"      "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:" "}),n.jsx("input",{type:"date",value:k.discharge_date,onChange:S=>N({...k,discharge_date:S.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"}),n.jsx("p",{className:"text-xs text-toss-gray-400 mt-1",children:"  ,    "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("textarea",{value:k.admin_status,onChange:S=>N({...k,admin_status:S.target.value}),placeholder:"  (  )",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 resize-none"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("textarea",{value:k.notes,onChange:S=>N({...k,notes:S.target.value}),placeholder:" ",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 resize-none"})]}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{u(!1),v(null),N(ld)},children:""}),n.jsx(Ye,{variant:"primary",className:"flex-1",onClick:re,disabled:E,children:E?" ...":y?"":""})]})]})}),n.jsx(dr,{isOpen:d,onClose:()=>{h(!1),g(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 rounded-lg",children:[n.jsx(vl,{size:24,className:"text-red-500 flex-shrink-0"}),n.jsx("p",{className:"text-sm text-red-700",children:"   ?     ."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{h(!1),g(null)},children:""}),n.jsx(Ye,{variant:"danger",className:"flex-1",onClick:M,children:""})]})]})}),n.jsx(dr,{isOpen:m,onClose:()=>{x(!1),w(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 bg-orange-50 rounded-lg",children:[n.jsx(Dc,{size:24,className:"text-orange-500 flex-shrink-0"}),n.jsxs("p",{className:"text-sm text-orange-700",children:["   ?  (",Fs(new Date().toISOString().split("T")[0]),") ."]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{x(!1),w(null)},children:""}),n.jsx(Ye,{variant:"primary",className:"flex-1 !bg-orange-500 hover:!bg-orange-600",onClick:G,children:" "})]})]})}),n.jsx(gb,{isOpen:L,onClose:()=>O(!1),records:H,stats:{total:le,active:ne,discharged:ie},backgroundImage:"back_bp.jpg"})]})}const PE=e=>e?e.length===3?e[0]+"O"+e[2]:e.length===2?e[0]+"O":e.length>=4?e[0]+"O".repeat(e.length-2)+e[e.length-1]:e:"",UE=e=>{if(!e)return"";const t=new Date(e);return t.getFullYear()+"."+String(t.getMonth()+1).padStart(2,"0")+"."+String(t.getDate()).padStart(2,"0")};function eQ(){const[e,t]=X.useState([{id:1,roomNum:"",persons:[{date:"",gender:"",name:""},{date:"",gender:"",name:""}]}]),[r,s]=X.useState(2),[a,o]=X.useState(!1),[l,u]=X.useState({col1:16.5,col2:53.6,col3:63.6,row1:23.4,row2:55.5}),[d,h]=X.useState({data:23,name:31,room:22}),m=()=>{t(B=>[...B,{id:r,roomNum:"",persons:[{date:"",gender:"",name:""},{date:"",gender:"",name:""}]}]),s(B=>B+1)},x=B=>{t(F=>F.filter(q=>q.id!==B))},y=(B,F,q,fe)=>{t(D=>D.map(V=>{if(V.id!==B)return V;if(fe!==void 0){const I=[...V.persons];return I[fe]={...I[fe],[F]:q},{...V,persons:I}}return{...V,[F]:q}}))},v=()=>{t([{id:1,roomNum:"",persons:[{date:"",gender:"",name:""},{date:"",gender:"",name:""}]}]),s(2)},b=(B,F)=>u(q=>({...q,[B]:parseFloat(F)})),g=(B,F)=>h(q=>({...q,[B]:parseInt(F)})),_=()=>{const B=`col1:${l.col1} col2:${l.col2} col3:${l.col3} row1:${l.row1} row2:${l.row2} data:${d.data}px name:${d.name}px room:${d.room}px`;navigator.clipboard.writeText(B).then(()=>alert(": "+B))},w=l.col2-l.col1,k=l.col3-l.col2,N=100-l.col3,E=l.row2-l.row1,C=96-l.row2,L={roomNum:{left:0,top:"23.4%",width:`${l.col1}%`,height:"72.6%",fontSize:`${d.room}px`,fontWeight:900,color:"#000"},r1Date:{left:`${l.col1}%`,top:`${l.row1}%`,width:`${w}%`,height:`${E}%`,fontSize:`${d.data}px`,fontWeight:500},r1Gender:{left:`${l.col2}%`,top:`${l.row1}%`,width:`${k}%`,height:`${E}%`,fontSize:`${d.data}px`,fontWeight:500},r1Name:{left:`${l.col3}%`,top:`${l.row1}%`,width:`${N}%`,height:`${E}%`,fontSize:`${d.name}px`,fontWeight:800},r2Date:{left:`${l.col1}%`,top:`${l.row2}%`,width:`${w}%`,height:`${C}%`,fontSize:`${d.data}px`,fontWeight:500},r2Gender:{left:`${l.col2}%`,top:`${l.row2}%`,width:`${k}%`,height:`${C}%`,fontSize:`${d.data}px`,fontWeight:500},r2Name:{left:`${l.col3}%`,top:`${l.row2}%`,width:`${N}%`,height:`${C}%`,fontSize:`${d.name}px`,fontWeight:800}},O={position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"'Noto Sans KR', sans-serif",color:"#1d1d1f"};return n.jsxs(n.Fragment,{children:[n.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;900&display=swap');
        @media print {
          * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
          body { background: #fff !important; margin: 0 !important; padding: 0 !important; }
          .print-hide { display: none !important; }
          .nametag-print-area {
            display: flex !important; flex-wrap: wrap !important; flex-direction: row !important;
            gap: 4mm !important; justify-content: center !important; align-items: flex-start !important;
            padding: 5mm !important;
          }
          .nametag-tag-wrap {
            background: transparent !important; padding: 0 !important; margin: 0 !important;
            box-shadow: none !important; border: none !important;
            page-break-inside: avoid; break-inside: avoid;
            display: inline-block; width: auto; height: auto;
          }
          .nametag-box, .nametag-box * {
            box-shadow: none !important; outline: none !important;
            text-shadow: none !important; filter: none !important;
          }
          aside, header, nav, [class*="shadow-toss"] { display: none !important; }
          main, [class*="flex-1"], [class*="ml-64"] {
            margin: 0 !important; padding: 0 !important; width: 100% !important;
          }
          @page { margin: 5mm; size: auto; }
        }
      `}),n.jsxs("div",{className:"space-y-6",children:[n.jsx(Et,{padding:"p-0",className:"print-hide overflow-hidden",children:n.jsx("div",{className:"bg-gradient-to-r from-toss-blue to-blue-600 p-6 md:p-8",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-toss flex items-center justify-center",children:n.jsx(Fd,{size:24,className:"text-white"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-xl md:text-2xl font-bold text-white",children:" "}),n.jsx("p",{className:"text-blue-100 text-sm mt-1",children:"    "})]})]})})}),n.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[n.jsxs("div",{className:"w-full lg:w-[400px] lg:min-w-[400px] space-y-4 print-hide",children:[n.jsxs(Et,{children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsxs("div",{children:[n.jsx("span",{className:"text-xs font-semibold text-toss-gray-500 uppercase tracking-wider",children:""}),n.jsxs("p",{className:"text-sm font-medium text-toss-gray-900 mt-1",children:[": ",n.jsx("strong",{children:"130 x 45 mm"})]})]})}),n.jsxs("div",{className:"flex gap-2 flex-wrap",children:[n.jsxs(Ye,{size:"sm",variant:"primary",onClick:m,children:[n.jsx(ps,{size:16})," "]}),n.jsxs(Ye,{size:"sm",variant:"secondary",onClick:v,children:[n.jsx(x7,{size:16})," "]}),n.jsxs(Ye,{size:"sm",variant:"primary",onClick:()=>window.print(),className:"ml-auto",children:[n.jsx(na,{size:16})," "]})]})]}),n.jsxs(Et,{padding:"p-0",children:[n.jsxs("button",{onClick:()=>o(!a),className:"w-full flex items-center justify-between p-4 text-sm font-semibold text-toss-gray-700 hover:bg-toss-gray-50 transition-all rounded-toss-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(yl,{size:16,className:"text-toss-gray-500"}),"  ()"]}),a?n.jsx(_i,{size:16}):n.jsx($n,{size:16})]}),a&&n.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[n.jsx("div",{className:"text-[11px] font-semibold text-toss-gray-500 uppercase tracking-wider",children:" "}),[{label:"|",key:"col1",min:5,max:25},{label:"|",key:"col2",min:30,max:65},{label:"|",key:"col3",min:40,max:75}].map(B=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs text-toss-gray-500 min-w-[80px]",children:B.label}),n.jsx("input",{type:"range",min:B.min,max:B.max,step:"0.1",value:l[B.key],onChange:F=>b(B.key,F.target.value),className:"flex-1 h-1 accent-toss-blue"}),n.jsxs("span",{className:"text-xs text-toss-gray-400 min-w-[40px] text-right tabular-nums",children:[l[B.key],"%"]})]},B.key)),n.jsx("div",{className:"text-[11px] font-semibold text-toss-gray-500 uppercase tracking-wider pt-2",children:" "}),[{label:"|1",key:"row1",min:15,max:35},{label:"1|2",key:"row2",min:45,max:70}].map(B=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs text-toss-gray-500 min-w-[80px]",children:B.label}),n.jsx("input",{type:"range",min:B.min,max:B.max,step:"0.1",value:l[B.key],onChange:F=>b(B.key,F.target.value),className:"flex-1 h-1 accent-toss-blue"}),n.jsxs("span",{className:"text-xs text-toss-gray-400 min-w-[40px] text-right tabular-nums",children:[l[B.key],"%"]})]},B.key)),n.jsx("div",{className:"text-[11px] font-semibold text-toss-gray-500 uppercase tracking-wider pt-2",children:" "}),[{label:"/",key:"data",min:10,max:30},{label:"",key:"name",min:16,max:40},{label:"",key:"room",min:14,max:36}].map(B=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs text-toss-gray-500 min-w-[80px]",children:B.label}),n.jsx("input",{type:"range",min:B.min,max:B.max,step:"1",value:d[B.key],onChange:F=>g(B.key,F.target.value),className:"flex-1 h-1 accent-toss-blue"}),n.jsxs("span",{className:"text-xs text-toss-gray-400 min-w-[40px] text-right tabular-nums",children:[d[B.key],"px"]})]},B.key)),n.jsxs("button",{onClick:_,className:"mt-2 flex items-center gap-1 text-xs text-toss-gray-600 hover:text-toss-blue transition-colors",children:[n.jsx(em,{size:12})," CSS  "]})]})]}),n.jsxs(Et,{children:[n.jsxs("div",{className:"text-xs font-semibold text-toss-gray-500 uppercase tracking-wider mb-3",children:["  (",e.length,")"]}),n.jsx("div",{className:"space-y-3",children:e.map((B,F)=>n.jsxs("div",{className:"bg-toss-gray-50 rounded-toss p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-sm font-bold text-toss-gray-900",children:[" ",F+1]}),B.roomNum&&n.jsxs("span",{className:"text-[11px] font-semibold text-toss-blue bg-toss-blue/10 px-2 py-0.5 rounded-full",children:[B.roomNum,""]})]}),n.jsx("button",{onClick:()=>x(B.id),className:"text-toss-gray-400 hover:text-red-500 transition-colors",children:n.jsx(Jt,{size:16})})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"text-xs font-medium text-toss-gray-500 min-w-[56px]",children:""}),n.jsx("input",{type:"text",placeholder:"102",value:B.roomNum,onChange:q=>y(B.id,"roomNum",q.target.value),className:"w-20 px-3 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"})]}),n.jsx("div",{className:"h-px bg-toss-gray-200 my-3"}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"text-xs font-medium text-toss-gray-500 min-w-[56px]",children:"1"}),n.jsxs("div",{className:"flex gap-1.5 flex-1 flex-wrap",children:[n.jsx("input",{type:"date",value:B.persons[0].date,onChange:q=>y(B.id,"date",q.target.value,0),className:"px-2.5 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"}),n.jsxs("select",{value:B.persons[0].gender,onChange:q=>y(B.id,"gender",q.target.value,0),className:"min-w-[60px] px-2 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]}),n.jsx("input",{type:"text",placeholder:"",value:B.persons[0].name,onChange:q=>y(B.id,"name",q.target.value,0),className:"flex-1 min-w-[70px] px-3 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs font-medium text-toss-gray-500 min-w-[56px]",children:"2"}),n.jsxs("div",{className:"flex gap-1.5 flex-1 flex-wrap",children:[n.jsx("input",{type:"date",value:B.persons[1].date,onChange:q=>y(B.id,"date",q.target.value,1),className:"px-2.5 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"}),n.jsxs("select",{value:B.persons[1].gender,onChange:q=>y(B.id,"gender",q.target.value,1),className:"min-w-[60px] px-2 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]}),n.jsx("input",{type:"text",placeholder:"",value:B.persons[1].name,onChange:q=>y(B.id,"name",q.target.value,1),className:"flex-1 min-w-[70px] px-3 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"})]})]})]},B.id))})]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx(Et,{className:"print-hide mb-4",children:n.jsx("span",{className:"text-xs font-semibold text-toss-gray-500 uppercase tracking-wider",children:""})}),n.jsx("div",{className:"nametag-print-area flex flex-col gap-6 items-center",children:e.length===0?n.jsx(Et,{className:"w-full text-center py-16",children:n.jsx("p",{className:"text-toss-gray-400 text-sm",children:" "})}):e.map(B=>n.jsx("div",{className:"nametag-tag-wrap",children:n.jsxs("div",{className:"nametag-box",style:{width:"130mm",height:"45mm",position:"relative",backgroundImage:"url('/company-intranet/name.jpg')",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",overflow:"hidden"},children:[n.jsx("div",{style:{...O,...L.roomNum},children:B.roomNum?B.roomNum+"":""}),n.jsx("div",{style:{...O,...L.r1Date},children:UE(B.persons[0].date)}),n.jsx("div",{style:{...O,...L.r1Gender},children:B.persons[0].gender}),n.jsx("div",{style:{...O,...L.r1Name},children:PE(B.persons[0].name)}),n.jsx("div",{style:{...O,...L.r2Date},children:UE(B.persons[1].date)}),n.jsx("div",{style:{...O,...L.r2Gender},children:B.persons[1].gender}),n.jsx("div",{style:{...O,...L.r2Name},children:PE(B.persons[1].name)})]})},B.id))})]})]})]})]})}const tQ=({children:e})=>{const{user:t,loading:r}=Kr();return r?n.jsx("div",{className:"min-h-screen bg-toss-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-toss-blue border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-toss-gray-500",children:" ..."})]})}):t?e:n.jsx(Cc,{to:"/login",replace:!0})},zE=({children:e})=>{const{user:t,loading:r}=Kr();return r?n.jsx("div",{className:"min-h-screen bg-toss-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"w-12 h-12 border-4 border-toss-blue border-t-transparent rounded-full animate-spin"})}):t?n.jsx(Cc,{to:"/",replace:!0}):e};function rQ(){return n.jsxs(A8,{children:[n.jsx(Ur,{path:"/login",element:n.jsx(zE,{children:n.jsx(I7,{})})}),n.jsx(Ur,{path:"/register",element:n.jsx(zE,{children:n.jsx(M7,{})})}),n.jsxs(Ur,{element:n.jsx(tQ,{children:n.jsx(L7,{})}),children:[n.jsx(Ur,{path:"/",element:n.jsx(B7,{})}),n.jsx(Ur,{path:"/notices",element:n.jsx(rS,{})}),n.jsx(Ur,{path:"/notices/:id",element:n.jsx(rS,{})}),n.jsx(Ur,{path:"/events",element:n.jsx(FU,{})}),n.jsx(Ur,{path:"/worklogs",element:n.jsx(Cc,{to:"/worklogs/daily",replace:!0})}),n.jsx(Ur,{path:"/worklogs/daily",element:n.jsx(_U,{})}),n.jsx(Ur,{path:"/worklogs/weekly",element:n.jsx(kU,{})}),n.jsx(Ur,{path:"/worklogs/monthly",element:n.jsx(TU,{})}),n.jsx(Ur,{path:"/rescue",element:n.jsx(CU,{})}),n.jsx(Ur,{path:"/meetings",element:n.jsx(DU,{})}),n.jsx(Ur,{path:"/document",element:n.jsx(UU,{})}),n.jsx(Ur,{path:"/archive",element:n.jsx(Cc,{to:"/archive/forms",replace:!0})}),n.jsx(Ur,{path:"/archive/:type",element:n.jsx(HU,{})}),n.jsx(Ur,{path:"/document-ledger",element:n.jsx(GZ,{})}),n.jsx(Ur,{path:"/leave",element:n.jsx(KZ,{})}),n.jsx(Ur,{path:"/admission",element:n.jsx(JZ,{})}),n.jsx(Ur,{path:"/admission/ganghwa",element:n.jsx(ZZ,{})}),n.jsx(Ur,{path:"/admission/bupyeong",element:n.jsx(QZ,{})}),n.jsx(Ur,{path:"/admission/nametag",element:n.jsx(eQ,{})}),n.jsx(Ur,{path:"/admin",element:n.jsx($U,{})}),n.jsx(Ur,{path:"/mypage",element:n.jsx(LU,{})})]}),n.jsx(Ur,{path:"*",element:n.jsx(Cc,{to:"/",replace:!0})})]})}function sQ(){return n.jsx(D7,{children:n.jsx(Q8,{basename:"/company-intranet/",children:n.jsx(rF,{children:n.jsx(rQ,{})})})})}const $E=!1,aQ=async()=>{if(N0.isNativePlatform())try{const{LiveUpdate:e}=await cC(async()=>{const{LiveUpdate:r}=await import("./index-B0qgw-gR.js");return{LiveUpdate:r}},[]);(await e.sync()).nextBundleId}catch{}};aQ();vC.createRoot(document.getElementById("root")).render(n.jsx(X.StrictMode,{children:n.jsx(sQ,{})}));export{Zy as W,cC as _,Jy as r};
