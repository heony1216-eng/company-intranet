(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();const gC="modulepreload",yC=function(e){return"/company-intranet/"+e},uN={},vC=function(t,r,s){let n=Promise.resolve();if(r&&r.length>0){let d=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");n=d(r.map(h=>{if(h=yC(h),h in uN)return;uN[h]=!0;const m=h.endsWith(".css"),x=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${x}`))return;const y=document.createElement("link");if(y.rel=m?"stylesheet":gC,m||(y.as="script"),y.crossOrigin="",y.href=h,u&&y.setAttribute("nonce",u),document.head.appendChild(y),m)return new Promise((b,v)=>{y.addEventListener("load",b),y.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${h}`)))})}))}function o(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return n.then(l=>{for(const u of l||[])u.status==="rejected"&&o(u.reason);return t().catch(o)})};var Ch=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Lx={exports:{}},Ju={};var dN;function bC(){if(dN)return Ju;dN=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(s,n,o){var l=null;if(o!==void 0&&(l=""+o),n.key!==void 0&&(l=""+n.key),"key"in n){o={};for(var u in n)u!=="key"&&(o[u]=n[u])}else o=n;return n=o.ref,{$$typeof:e,type:s,key:l,ref:n!==void 0?n:null,props:o}}return Ju.Fragment=t,Ju.jsx=r,Ju.jsxs=r,Ju}var fN;function wC(){return fN||(fN=1,Lx.exports=bC()),Lx.exports}var a=wC(),Ix={exports:{}},Yt={};var hN;function _C(){if(hN)return Yt;hN=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),y=Symbol.iterator;function b(Z){return Z===null||typeof Z!="object"?null:(Z=y&&Z[y]||Z["@@iterator"],typeof Z=="function"?Z:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,_={};function w(Z,M,J){this.props=Z,this.context=M,this.refs=_,this.updater=J||v}w.prototype.isReactComponent={},w.prototype.setState=function(Z,M){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,M,"setState")},w.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function S(){}S.prototype=w.prototype;function N(Z,M,J){this.props=Z,this.context=M,this.refs=_,this.updater=J||v}var E=N.prototype=new S;E.constructor=N,g(E,w.prototype),E.isPureReactComponent=!0;var C=Array.isArray;function F(){}var O={H:null,A:null,T:null,S:null},B=Object.prototype.hasOwnProperty;function L(Z,M,J){var V=J.ref;return{$$typeof:e,type:Z,key:M,ref:V!==void 0?V:null,props:J}}function H(Z,M){return L(Z.type,M,Z.props)}function ue(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===e}function A(Z){var M={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(J){return M[J]})}var Y=/\/+/g;function I(Z,M){return typeof Z=="object"&&Z!==null&&Z.key!=null?A(""+Z.key):M.toString(36)}function ae(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then(F,F):(Z.status="pending",Z.then(function(M){Z.status==="pending"&&(Z.status="fulfilled",Z.value=M)},function(M){Z.status==="pending"&&(Z.status="rejected",Z.reason=M)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function Q(Z,M,J,V,X){var se=typeof Z;(se==="undefined"||se==="boolean")&&(Z=null);var P=!1;if(Z===null)P=!0;else switch(se){case"bigint":case"string":case"number":P=!0;break;case"object":switch(Z.$$typeof){case e:case t:P=!0;break;case m:return P=Z._init,Q(P(Z._payload),M,J,V,X)}}if(P)return X=X(Z),P=V===""?"."+I(Z,0):V,C(X)?(J="",P!=null&&(J=P.replace(Y,"$&/")+"/"),Q(X,M,J,"",function(ne){return ne})):X!=null&&(ue(X)&&(X=H(X,J+(X.key==null||Z&&Z.key===X.key?"":(""+X.key).replace(Y,"$&/")+"/")+P)),M.push(X)),1;P=0;var U=V===""?".":V+":";if(C(Z))for(var ce=0;ce<Z.length;ce++)V=Z[ce],se=U+I(V,ce),P+=Q(V,M,J,se,X);else if(ce=b(Z),typeof ce=="function")for(Z=ce.call(Z),ce=0;!(V=Z.next()).done;)V=V.value,se=U+I(V,ce++),P+=Q(V,M,J,se,X);else if(se==="object"){if(typeof Z.then=="function")return Q(ae(Z),M,J,V,X);throw M=String(Z),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.")}return P}function re(Z,M,J){if(Z==null)return Z;var V=[],X=0;return Q(Z,V,"","",function(se){return M.call(J,se,X++)}),V}function ve(Z){if(Z._status===-1){var M=Z._result;M=M(),M.then(function(J){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=J)},function(J){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=J)}),Z._status===-1&&(Z._status=0,Z._result=M)}if(Z._status===1)return Z._result.default;throw Z._result}var te=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var M=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(M))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Z);return}console.error(Z)},ke={map:re,forEach:function(Z,M,J){re(Z,function(){M.apply(this,arguments)},J)},count:function(Z){var M=0;return re(Z,function(){M++}),M},toArray:function(Z){return re(Z,function(M){return M})||[]},only:function(Z){if(!ue(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}};return Yt.Activity=x,Yt.Children=ke,Yt.Component=w,Yt.Fragment=r,Yt.Profiler=n,Yt.PureComponent=N,Yt.StrictMode=s,Yt.Suspense=d,Yt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Yt.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return O.H.useMemoCache(Z)}},Yt.cache=function(Z){return function(){return Z.apply(null,arguments)}},Yt.cacheSignal=function(){return null},Yt.cloneElement=function(Z,M,J){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var V=g({},Z.props),X=Z.key;if(M!=null)for(se in M.key!==void 0&&(X=""+M.key),M)!B.call(M,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&M.ref===void 0||(V[se]=M[se]);var se=arguments.length-2;if(se===1)V.children=J;else if(1<se){for(var P=Array(se),U=0;U<se;U++)P[U]=arguments[U+2];V.children=P}return L(Z.type,X,V)},Yt.createContext=function(Z){return Z={$$typeof:l,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:o,_context:Z},Z},Yt.createElement=function(Z,M,J){var V,X={},se=null;if(M!=null)for(V in M.key!==void 0&&(se=""+M.key),M)B.call(M,V)&&V!=="key"&&V!=="__self"&&V!=="__source"&&(X[V]=M[V]);var P=arguments.length-2;if(P===1)X.children=J;else if(1<P){for(var U=Array(P),ce=0;ce<P;ce++)U[ce]=arguments[ce+2];X.children=U}if(Z&&Z.defaultProps)for(V in P=Z.defaultProps,P)X[V]===void 0&&(X[V]=P[V]);return L(Z,se,X)},Yt.createRef=function(){return{current:null}},Yt.forwardRef=function(Z){return{$$typeof:u,render:Z}},Yt.isValidElement=ue,Yt.lazy=function(Z){return{$$typeof:m,_payload:{_status:-1,_result:Z},_init:ve}},Yt.memo=function(Z,M){return{$$typeof:h,type:Z,compare:M===void 0?null:M}},Yt.startTransition=function(Z){var M=O.T,J={};O.T=J;try{var V=Z(),X=O.S;X!==null&&X(J,V),typeof V=="object"&&V!==null&&typeof V.then=="function"&&V.then(F,te)}catch(se){te(se)}finally{M!==null&&J.types!==null&&(M.types=J.types),O.T=M}},Yt.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Yt.use=function(Z){return O.H.use(Z)},Yt.useActionState=function(Z,M,J){return O.H.useActionState(Z,M,J)},Yt.useCallback=function(Z,M){return O.H.useCallback(Z,M)},Yt.useContext=function(Z){return O.H.useContext(Z)},Yt.useDebugValue=function(){},Yt.useDeferredValue=function(Z,M){return O.H.useDeferredValue(Z,M)},Yt.useEffect=function(Z,M){return O.H.useEffect(Z,M)},Yt.useEffectEvent=function(Z){return O.H.useEffectEvent(Z)},Yt.useId=function(){return O.H.useId()},Yt.useImperativeHandle=function(Z,M,J){return O.H.useImperativeHandle(Z,M,J)},Yt.useInsertionEffect=function(Z,M){return O.H.useInsertionEffect(Z,M)},Yt.useLayoutEffect=function(Z,M){return O.H.useLayoutEffect(Z,M)},Yt.useMemo=function(Z,M){return O.H.useMemo(Z,M)},Yt.useOptimistic=function(Z,M){return O.H.useOptimistic(Z,M)},Yt.useReducer=function(Z,M,J){return O.H.useReducer(Z,M,J)},Yt.useRef=function(Z){return O.H.useRef(Z)},Yt.useState=function(Z){return O.H.useState(Z)},Yt.useSyncExternalStore=function(Z,M,J){return O.H.useSyncExternalStore(Z,M,J)},Yt.useTransition=function(){return O.H.useTransition()},Yt.version="19.2.3",Yt}var mN;function sv(){return mN||(mN=1,Ix.exports=_C()),Ix.exports}var K=sv(),Mx={exports:{}},Zu={},Bx={exports:{}},Px={};var pN;function NC(){return pN||(pN=1,(function(e){function t(Q,re){var ve=Q.length;Q.push(re);e:for(;0<ve;){var te=ve-1>>>1,ke=Q[te];if(0<n(ke,re))Q[te]=re,Q[ve]=ke,ve=te;else break e}}function r(Q){return Q.length===0?null:Q[0]}function s(Q){if(Q.length===0)return null;var re=Q[0],ve=Q.pop();if(ve!==re){Q[0]=ve;e:for(var te=0,ke=Q.length,Z=ke>>>1;te<Z;){var M=2*(te+1)-1,J=Q[M],V=M+1,X=Q[V];if(0>n(J,ve))V<ke&&0>n(X,J)?(Q[te]=X,Q[V]=ve,te=V):(Q[te]=J,Q[M]=ve,te=M);else if(V<ke&&0>n(X,ve))Q[te]=X,Q[V]=ve,te=V;else break e}}return re}function n(Q,re){var ve=Q.sortIndex-re.sortIndex;return ve!==0?ve:Q.id-re.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var d=[],h=[],m=1,x=null,y=3,b=!1,v=!1,g=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function E(Q){for(var re=r(h);re!==null;){if(re.callback===null)s(h);else if(re.startTime<=Q)s(h),re.sortIndex=re.expirationTime,t(d,re);else break;re=r(h)}}function C(Q){if(g=!1,E(Q),!v)if(r(d)!==null)v=!0,F||(F=!0,A());else{var re=r(h);re!==null&&ae(C,re.startTime-Q)}}var F=!1,O=-1,B=5,L=-1;function H(){return _?!0:!(e.unstable_now()-L<B)}function ue(){if(_=!1,F){var Q=e.unstable_now();L=Q;var re=!0;try{e:{v=!1,g&&(g=!1,S(O),O=-1),b=!0;var ve=y;try{t:{for(E(Q),x=r(d);x!==null&&!(x.expirationTime>Q&&H());){var te=x.callback;if(typeof te=="function"){x.callback=null,y=x.priorityLevel;var ke=te(x.expirationTime<=Q);if(Q=e.unstable_now(),typeof ke=="function"){x.callback=ke,E(Q),re=!0;break t}x===r(d)&&s(d),E(Q)}else s(d);x=r(d)}if(x!==null)re=!0;else{var Z=r(h);Z!==null&&ae(C,Z.startTime-Q),re=!1}}break e}finally{x=null,y=ve,b=!1}re=void 0}}finally{re?A():F=!1}}}var A;if(typeof N=="function")A=function(){N(ue)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,I=Y.port2;Y.port1.onmessage=ue,A=function(){I.postMessage(null)}}else A=function(){w(ue,0)};function ae(Q,re){O=w(function(){Q(e.unstable_now())},re)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Q){Q.callback=null},e.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<Q?Math.floor(1e3/Q):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(Q){switch(y){case 1:case 2:case 3:var re=3;break;default:re=y}var ve=y;y=re;try{return Q()}finally{y=ve}},e.unstable_requestPaint=function(){_=!0},e.unstable_runWithPriority=function(Q,re){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var ve=y;y=Q;try{return re()}finally{y=ve}},e.unstable_scheduleCallback=function(Q,re,ve){var te=e.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?te+ve:te):ve=te,Q){case 1:var ke=-1;break;case 2:ke=250;break;case 5:ke=1073741823;break;case 4:ke=1e4;break;default:ke=5e3}return ke=ve+ke,Q={id:m++,callback:re,priorityLevel:Q,startTime:ve,expirationTime:ke,sortIndex:-1},ve>te?(Q.sortIndex=ve,t(h,Q),r(d)===null&&Q===r(h)&&(g?(S(O),O=-1):g=!0,ae(C,ve-te))):(Q.sortIndex=ke,t(d,Q),v||b||(v=!0,F||(F=!0,A()))),Q},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(Q){var re=y;return function(){var ve=y;y=re;try{return Q.apply(this,arguments)}finally{y=ve}}}})(Px)),Px}var xN;function kC(){return xN||(xN=1,Bx.exports=NC()),Bx.exports}var Ux={exports:{}},Qs={};var gN;function SC(){if(gN)return Qs;gN=1;var e=sv();function t(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var s={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function o(d,h,m){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:x==null?null:""+x,children:d,containerInfo:h,implementation:m}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Qs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Qs.createPortal=function(d,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return o(d,h,null,m)},Qs.flushSync=function(d){var h=l.T,m=s.p;try{if(l.T=null,s.p=2,d)return d()}finally{l.T=h,s.p=m,s.d.f()}},Qs.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,s.d.C(d,h))},Qs.prefetchDNS=function(d){typeof d=="string"&&s.d.D(d)},Qs.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var m=h.as,x=u(m,h.crossOrigin),y=typeof h.integrity=="string"?h.integrity:void 0,b=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?s.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:b}):m==="script"&&s.d.X(d,{crossOrigin:x,integrity:y,fetchPriority:b,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Qs.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=u(h.as,h.crossOrigin);s.d.M(d,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&s.d.M(d)},Qs.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,x=u(m,h.crossOrigin);s.d.L(d,m,{crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Qs.preloadModule=function(d,h){if(typeof d=="string")if(h){var m=u(h.as,h.crossOrigin);s.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else s.d.m(d)},Qs.requestFormReset=function(d){s.d.r(d)},Qs.unstable_batchedUpdates=function(d,h){return d(h)},Qs.useFormState=function(d,h,m){return l.H.useFormState(d,h,m)},Qs.useFormStatus=function(){return l.H.useHostTransitionStatus()},Qs.version="19.2.3",Qs}var yN;function EC(){if(yN)return Ux.exports;yN=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Ux.exports=SC(),Ux.exports}var vN;function jC(){if(vN)return Zu;vN=1;var e=kC(),t=sv(),r=EC();function s(i){var c="https://react.dev/errors/"+i;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var c=i,f=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(f=c.return),i=c.return;while(i)}return c.tag===3?f:null}function l(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function u(i){if(i.tag===31){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function d(i){if(o(i)!==i)throw Error(s(188))}function h(i){var c=i.alternate;if(!c){if(c=o(i),c===null)throw Error(s(188));return c!==i?null:i}for(var f=i,p=c;;){var j=f.return;if(j===null)break;var D=j.alternate;if(D===null){if(p=j.return,p!==null){f=p;continue}break}if(j.child===D.child){for(D=j.child;D;){if(D===f)return d(j),i;if(D===p)return d(j),c;D=D.sibling}throw Error(s(188))}if(f.return!==p.return)f=j,p=D;else{for(var ee=!1,ge=j.child;ge;){if(ge===f){ee=!0,f=j,p=D;break}if(ge===p){ee=!0,p=j,f=D;break}ge=ge.sibling}if(!ee){for(ge=D.child;ge;){if(ge===f){ee=!0,f=D,p=j;break}if(ge===p){ee=!0,p=D,f=j;break}ge=ge.sibling}if(!ee)throw Error(s(189))}}if(f.alternate!==p)throw Error(s(190))}if(f.tag!==3)throw Error(s(188));return f.stateNode.current===f?i:c}function m(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i;for(i=i.child;i!==null;){if(c=m(i),c!==null)return c;i=i.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),S=Symbol.for("react.consumer"),N=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),ue=Symbol.iterator;function A(i){return i===null||typeof i!="object"?null:(i=ue&&i[ue]||i["@@iterator"],typeof i=="function"?i:null)}var Y=Symbol.for("react.client.reference");function I(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Y?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case g:return"Fragment";case w:return"Profiler";case _:return"StrictMode";case C:return"Suspense";case F:return"SuspenseList";case L:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case v:return"Portal";case N:return i.displayName||"Context";case S:return(i._context.displayName||"Context")+".Consumer";case E:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case O:return c=i.displayName||null,c!==null?c:I(i.type)||"Memo";case B:c=i._payload,i=i._init;try{return I(i(c))}catch{}}return null}var ae=Array.isArray,Q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve={pending:!1,data:null,method:null,action:null},te=[],ke=-1;function Z(i){return{current:i}}function M(i){0>ke||(i.current=te[ke],te[ke]=null,ke--)}function J(i,c){ke++,te[ke]=i.current,i.current=c}var V=Z(null),X=Z(null),se=Z(null),P=Z(null);function U(i,c){switch(J(se,c),J(X,i),J(V,null),c.nodeType){case 9:case 11:i=(i=c.documentElement)&&(i=i.namespaceURI)?O2(i):0;break;default:if(i=c.tagName,c=c.namespaceURI)c=O2(c),i=F2(c,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}M(V),J(V,i)}function ce(){M(V),M(X),M(se)}function ne(i){i.memoizedState!==null&&J(P,i);var c=V.current,f=F2(c,i.type);c!==f&&(J(X,i),J(V,f))}function ie(i){X.current===i&&(M(V),M(X)),P.current===i&&(M(P),Vu._currentValue=ve)}var W,G;function k(i){if(W===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);W=c&&c[1]||"",G=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+W+i+G}var de=!1;function z(i,c){if(!i||de)return"";de=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(c){var ut=function(){throw Error()};if(Object.defineProperty(ut.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ut,[])}catch(Qe){var Xe=Qe}Reflect.construct(i,[],ut)}else{try{ut.call()}catch(Qe){Xe=Qe}i.call(ut.prototype)}}else{try{throw Error()}catch(Qe){Xe=Qe}(ut=i())&&typeof ut.catch=="function"&&ut.catch(function(){})}}catch(Qe){if(Qe&&Xe&&typeof Qe.stack=="string")return[Qe.stack,Xe.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var j=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");j&&j.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=p.DetermineComponentFrameRoot(),ee=D[0],ge=D[1];if(ee&&ge){var Fe=ee.split(`
`),Ve=ge.split(`
`);for(j=p=0;p<Fe.length&&!Fe[p].includes("DetermineComponentFrameRoot");)p++;for(;j<Ve.length&&!Ve[j].includes("DetermineComponentFrameRoot");)j++;if(p===Fe.length||j===Ve.length)for(p=Fe.length-1,j=Ve.length-1;1<=p&&0<=j&&Fe[p]!==Ve[j];)j--;for(;1<=p&&0<=j;p--,j--)if(Fe[p]!==Ve[j]){if(p!==1||j!==1)do if(p--,j--,0>j||Fe[p]!==Ve[j]){var it=`
`+Fe[p].replace(" at new "," at ");return i.displayName&&it.includes("<anonymous>")&&(it=it.replace("<anonymous>",i.displayName)),it}while(1<=p&&0<=j);break}}}finally{de=!1,Error.prepareStackTrace=f}return(f=i?i.displayName||i.name:"")?k(f):""}function T(i,c){switch(i.tag){case 26:case 27:case 5:return k(i.type);case 16:return k("Lazy");case 13:return i.child!==c&&c!==null?k("Suspense Fallback"):k("Suspense");case 19:return k("SuspenseList");case 0:case 15:return z(i.type,!1);case 11:return z(i.type.render,!1);case 1:return z(i.type,!0);case 31:return k("Activity");default:return""}}function R(i){try{var c="",f=null;do c+=T(i,f),f=i,i=i.return;while(i);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var q=Object.prototype.hasOwnProperty,me=e.unstable_scheduleCallback,_e=e.unstable_cancelCallback,le=e.unstable_shouldYield,Ae=e.unstable_requestPaint,Me=e.unstable_now,Ee=e.unstable_getCurrentPriorityLevel,Ce=e.unstable_ImmediatePriority,Je=e.unstable_UserBlockingPriority,$e=e.unstable_NormalPriority,tt=e.unstable_LowPriority,De=e.unstable_IdlePriority,ft=e.log,jt=e.unstable_setDisableYieldValue,vt=null,At=null;function Rt(i){if(typeof ft=="function"&&jt(i),At&&typeof At.setStrictMode=="function")try{At.setStrictMode(vt,i)}catch{}}var Le=Math.clz32?Math.clz32:oe,rt=Math.log,ct=Math.LN2;function oe(i){return i>>>=0,i===0?32:31-(rt(i)/ct|0)|0}var Ne=256,xe=262144,je=4194304;function fe(i){var c=i&42;if(c!==0)return c;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Oe(i,c,f){var p=i.pendingLanes;if(p===0)return 0;var j=0,D=i.suspendedLanes,ee=i.pingedLanes;i=i.warmLanes;var ge=p&134217727;return ge!==0?(p=ge&~D,p!==0?j=fe(p):(ee&=ge,ee!==0?j=fe(ee):f||(f=ge&~i,f!==0&&(j=fe(f))))):(ge=p&~D,ge!==0?j=fe(ge):ee!==0?j=fe(ee):f||(f=p&~i,f!==0&&(j=fe(f)))),j===0?0:c!==0&&c!==j&&(c&D)===0&&(D=j&-j,f=c&-c,D>=f||D===32&&(f&4194048)!==0)?c:j}function Ue(i,c){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&c)===0}function st(i,c){switch(i){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pt(){var i=je;return je<<=1,(je&62914560)===0&&(je=4194304),i}function Nt(i){for(var c=[],f=0;31>f;f++)c.push(i);return c}function Vt(i,c){i.pendingLanes|=c,c!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function yr(i,c,f,p,j,D){var ee=i.pendingLanes;i.pendingLanes=f,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=f,i.entangledLanes&=f,i.errorRecoveryDisabledLanes&=f,i.shellSuspendCounter=0;var ge=i.entanglements,Fe=i.expirationTimes,Ve=i.hiddenUpdates;for(f=ee&~f;0<f;){var it=31-Le(f),ut=1<<it;ge[it]=0,Fe[it]=-1;var Xe=Ve[it];if(Xe!==null)for(Ve[it]=null,it=0;it<Xe.length;it++){var Qe=Xe[it];Qe!==null&&(Qe.lane&=-536870913)}f&=~ut}p!==0&&_r(i,p,0),D!==0&&j===0&&i.tag!==0&&(i.suspendedLanes|=D&~(ee&~c))}function _r(i,c,f){i.pendingLanes|=c,i.suspendedLanes&=~c;var p=31-Le(c);i.entangledLanes|=c,i.entanglements[p]=i.entanglements[p]|1073741824|f&261930}function zt(i,c){var f=i.entangledLanes|=c;for(i=i.entanglements;f;){var p=31-Le(f),j=1<<p;j&c|i[p]&c&&(i[p]|=c),f&=~j}}function fr(i,c){var f=c&-c;return f=(f&42)!==0?1:Sr(f),(f&(i.suspendedLanes|c))!==0?0:f}function Sr(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Zr(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function he(){var i=re.p;return i!==0?i:(i=window.event,i===void 0?32:sN(i.type))}function we(i,c){var f=re.p;try{return re.p=i,c()}finally{re.p=f}}var ye=Math.random().toString(36).slice(2),be="__reactFiber$"+ye,Se="__reactProps$"+ye,Te="__reactContainer$"+ye,We="__reactEvents$"+ye,at="__reactListeners$"+ye,qe="__reactHandles$"+ye,He="__reactResources$"+ye,Ke="__reactMarker$"+ye;function ht(i){delete i[be],delete i[Se],delete i[We],delete i[at],delete i[qe]}function bt(i){var c=i[be];if(c)return c;for(var f=i.parentNode;f;){if(c=f[Te]||f[be]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(i=z2(i);i!==null;){if(f=i[be])return f;i=z2(i)}return c}i=f,f=i.parentNode}return null}function Et(i){if(i=i[be]||i[Te]){var c=i.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return i}return null}function xt(i){var c=i.tag;if(c===5||c===26||c===27||c===6)return i.stateNode;throw Error(s(33))}function pe(i){var c=i[He];return c||(c=i[He]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Ie(i){i[Ke]=!0}var wt=new Set,yt={};function Ut(i,c){Ur(i,c),Ur(i+"Capture",c)}function Ur(i,c){for(yt[i]=c,i=0;i<c.length;i++)wt.add(c[i])}var ds=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),fs={},Ga={};function So(i){return q.call(Ga,i)?!0:q.call(fs,i)?!1:ds.test(i)?Ga[i]=!0:(fs[i]=!0,!1)}function Zs(i,c,f){if(So(c))if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":i.removeAttribute(c);return;case"boolean":var p=c.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(c);return}}i.setAttribute(c,""+f)}}function Va(i,c,f){if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttribute(c,""+f)}}function Yn(i,c,f,p){if(p===null)i.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(f);return}i.setAttributeNS(c,f,""+p)}}function Ka(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Sb(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function u6(i,c,f){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,c);if(!i.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var j=p.get,D=p.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return j.call(this)},set:function(ee){f=""+ee,D.call(this,ee)}}),Object.defineProperty(i,c,{enumerable:p.enumerable}),{getValue:function(){return f},setValue:function(ee){f=""+ee},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function Tm(i){if(!i._valueTracker){var c=Sb(i)?"checked":"value";i._valueTracker=u6(i,c,""+i[c])}}function Eb(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var f=c.getValue(),p="";return i&&(p=Sb(i)?i.checked?"true":"false":i.value),i=p,i!==f?(c.setValue(i),!0):!1}function bf(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var d6=/[\n"\\]/g;function Xa(i){return i.replace(d6,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Am(i,c,f,p,j,D,ee,ge){i.name="",ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"?i.type=ee:i.removeAttribute("type"),c!=null?ee==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+Ka(c)):i.value!==""+Ka(c)&&(i.value=""+Ka(c)):ee!=="submit"&&ee!=="reset"||i.removeAttribute("value"),c!=null?Cm(i,ee,Ka(c)):f!=null?Cm(i,ee,Ka(f)):p!=null&&i.removeAttribute("value"),j==null&&D!=null&&(i.defaultChecked=!!D),j!=null&&(i.checked=j&&typeof j!="function"&&typeof j!="symbol"),ge!=null&&typeof ge!="function"&&typeof ge!="symbol"&&typeof ge!="boolean"?i.name=""+Ka(ge):i.removeAttribute("name")}function jb(i,c,f,p,j,D,ee,ge){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(i.type=D),c!=null||f!=null){if(!(D!=="submit"&&D!=="reset"||c!=null)){Tm(i);return}f=f!=null?""+Ka(f):"",c=c!=null?""+Ka(c):f,ge||c===i.value||(i.value=c),i.defaultValue=c}p=p??j,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=ge?i.checked:!!p,i.defaultChecked=!!p,ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"&&(i.name=ee),Tm(i)}function Cm(i,c,f){c==="number"&&bf(i.ownerDocument)===i||i.defaultValue===""+f||(i.defaultValue=""+f)}function Ol(i,c,f,p){if(i=i.options,c){c={};for(var j=0;j<f.length;j++)c["$"+f[j]]=!0;for(f=0;f<i.length;f++)j=c.hasOwnProperty("$"+i[f].value),i[f].selected!==j&&(i[f].selected=j),j&&p&&(i[f].defaultSelected=!0)}else{for(f=""+Ka(f),c=null,j=0;j<i.length;j++){if(i[j].value===f){i[j].selected=!0,p&&(i[j].defaultSelected=!0);return}c!==null||i[j].disabled||(c=i[j])}c!==null&&(c.selected=!0)}}function Tb(i,c,f){if(c!=null&&(c=""+Ka(c),c!==i.value&&(i.value=c),f==null)){i.defaultValue!==c&&(i.defaultValue=c);return}i.defaultValue=f!=null?""+Ka(f):""}function Ab(i,c,f,p){if(c==null){if(p!=null){if(f!=null)throw Error(s(92));if(ae(p)){if(1<p.length)throw Error(s(93));p=p[0]}f=p}f==null&&(f=""),c=f}f=Ka(c),i.defaultValue=f,p=i.textContent,p===f&&p!==""&&p!==null&&(i.value=p),Tm(i)}function Fl(i,c){if(c){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=c;return}}i.textContent=c}var f6=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Cb(i,c,f){var p=c.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?p?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="":p?i.setProperty(c,f):typeof f!="number"||f===0||f6.has(c)?c==="float"?i.cssFloat=f:i[c]=(""+f).trim():i[c]=f+"px"}function Rb(i,c,f){if(c!=null&&typeof c!="object")throw Error(s(62));if(i=i.style,f!=null){for(var p in f)!f.hasOwnProperty(p)||c!=null&&c.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var j in c)p=c[j],c.hasOwnProperty(j)&&f[j]!==p&&Cb(i,j,p)}else for(var D in c)c.hasOwnProperty(D)&&Cb(i,D,c[D])}function Rm(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var h6=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),m6=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wf(i){return m6.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Jn(){}var Dm=null;function Om(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ll=null,Il=null;function Db(i){var c=Et(i);if(c&&(i=c.stateNode)){var f=i[Se]||null;e:switch(i=c.stateNode,c.type){case"input":if(Am(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),c=f.name,f.type==="radio"&&c!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Xa(""+c)+'"][type="radio"]'),c=0;c<f.length;c++){var p=f[c];if(p!==i&&p.form===i.form){var j=p[Se]||null;if(!j)throw Error(s(90));Am(p,j.value,j.defaultValue,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name)}}for(c=0;c<f.length;c++)p=f[c],p.form===i.form&&Eb(p)}break e;case"textarea":Tb(i,f.value,f.defaultValue);break e;case"select":c=f.value,c!=null&&Ol(i,!!f.multiple,c,!1)}}}var Fm=!1;function Ob(i,c,f){if(Fm)return i(c,f);Fm=!0;try{var p=i(c);return p}finally{if(Fm=!1,(Ll!==null||Il!==null)&&(lh(),Ll&&(c=Ll,i=Il,Il=Ll=null,Db(c),i)))for(c=0;c<i.length;c++)Db(i[c])}}function uu(i,c){var f=i.stateNode;if(f===null)return null;var p=f[Se]||null;if(p===null)return null;f=p[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(s(231,c,typeof f));return f}var Zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lm=!1;if(Zn)try{var du={};Object.defineProperty(du,"passive",{get:function(){Lm=!0}}),window.addEventListener("test",du,du),window.removeEventListener("test",du,du)}catch{Lm=!1}var Ii=null,Im=null,_f=null;function Fb(){if(_f)return _f;var i,c=Im,f=c.length,p,j="value"in Ii?Ii.value:Ii.textContent,D=j.length;for(i=0;i<f&&c[i]===j[i];i++);var ee=f-i;for(p=1;p<=ee&&c[f-p]===j[D-p];p++);return _f=j.slice(i,1<p?1-p:void 0)}function Nf(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function kf(){return!0}function Lb(){return!1}function ga(i){function c(f,p,j,D,ee){this._reactName=f,this._targetInst=j,this.type=p,this.nativeEvent=D,this.target=ee,this.currentTarget=null;for(var ge in i)i.hasOwnProperty(ge)&&(f=i[ge],this[ge]=f?f(D):D[ge]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?kf:Lb,this.isPropagationStopped=Lb,this}return x(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=kf)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=kf)},persist:function(){},isPersistent:kf}),c}var Eo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sf=ga(Eo),fu=x({},Eo,{view:0,detail:0}),p6=ga(fu),Mm,Bm,hu,Ef=x({},fu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Um,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==hu&&(hu&&i.type==="mousemove"?(Mm=i.screenX-hu.screenX,Bm=i.screenY-hu.screenY):Bm=Mm=0,hu=i),Mm)},movementY:function(i){return"movementY"in i?i.movementY:Bm}}),Ib=ga(Ef),x6=x({},Ef,{dataTransfer:0}),g6=ga(x6),y6=x({},fu,{relatedTarget:0}),Pm=ga(y6),v6=x({},Eo,{animationName:0,elapsedTime:0,pseudoElement:0}),b6=ga(v6),w6=x({},Eo,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),_6=ga(w6),N6=x({},Eo,{data:0}),Mb=ga(N6),k6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},S6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},E6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function j6(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=E6[i])?!!c[i]:!1}function Um(){return j6}var T6=x({},fu,{key:function(i){if(i.key){var c=k6[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=Nf(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?S6[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Um,charCode:function(i){return i.type==="keypress"?Nf(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Nf(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),A6=ga(T6),C6=x({},Ef,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bb=ga(C6),R6=x({},fu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Um}),D6=ga(R6),O6=x({},Eo,{propertyName:0,elapsedTime:0,pseudoElement:0}),F6=ga(O6),L6=x({},Ef,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),I6=ga(L6),M6=x({},Eo,{newState:0,oldState:0}),B6=ga(M6),P6=[9,13,27,32],zm=Zn&&"CompositionEvent"in window,mu=null;Zn&&"documentMode"in document&&(mu=document.documentMode);var U6=Zn&&"TextEvent"in window&&!mu,Pb=Zn&&(!zm||mu&&8<mu&&11>=mu),Ub=" ",zb=!1;function $b(i,c){switch(i){case"keyup":return P6.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qb(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ml=!1;function z6(i,c){switch(i){case"compositionend":return qb(c);case"keypress":return c.which!==32?null:(zb=!0,Ub);case"textInput":return i=c.data,i===Ub&&zb?null:i;default:return null}}function $6(i,c){if(Ml)return i==="compositionend"||!zm&&$b(i,c)?(i=Fb(),_f=Im=Ii=null,Ml=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Pb&&c.locale!=="ko"?null:c.data;default:return null}}var q6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hb(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!q6[i.type]:c==="textarea"}function Wb(i,c,f,p){Ll?Il?Il.push(p):Il=[p]:Ll=p,c=ph(c,"onChange"),0<c.length&&(f=new Sf("onChange","change",null,f,p),i.push({event:f,listeners:c}))}var pu=null,xu=null;function H6(i){j2(i,0)}function jf(i){var c=xt(i);if(Eb(c))return i}function Gb(i,c){if(i==="change")return c}var Vb=!1;if(Zn){var $m;if(Zn){var qm="oninput"in document;if(!qm){var Kb=document.createElement("div");Kb.setAttribute("oninput","return;"),qm=typeof Kb.oninput=="function"}$m=qm}else $m=!1;Vb=$m&&(!document.documentMode||9<document.documentMode)}function Xb(){pu&&(pu.detachEvent("onpropertychange",Yb),xu=pu=null)}function Yb(i){if(i.propertyName==="value"&&jf(xu)){var c=[];Wb(c,xu,i,Om(i)),Ob(H6,c)}}function W6(i,c,f){i==="focusin"?(Xb(),pu=c,xu=f,pu.attachEvent("onpropertychange",Yb)):i==="focusout"&&Xb()}function G6(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return jf(xu)}function V6(i,c){if(i==="click")return jf(c)}function K6(i,c){if(i==="input"||i==="change")return jf(c)}function X6(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var Aa=typeof Object.is=="function"?Object.is:X6;function gu(i,c){if(Aa(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var f=Object.keys(i),p=Object.keys(c);if(f.length!==p.length)return!1;for(p=0;p<f.length;p++){var j=f[p];if(!q.call(c,j)||!Aa(i[j],c[j]))return!1}return!0}function Jb(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Zb(i,c){var f=Jb(i);i=0;for(var p;f;){if(f.nodeType===3){if(p=i+f.textContent.length,i<=c&&p>=c)return{node:f,offset:c-i};i=p}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=Jb(f)}}function Qb(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?Qb(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function ew(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var c=bf(i.document);c instanceof i.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)i=c.contentWindow;else break;c=bf(i.document)}return c}function Hm(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}var Y6=Zn&&"documentMode"in document&&11>=document.documentMode,Bl=null,Wm=null,yu=null,Gm=!1;function tw(i,c,f){var p=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Gm||Bl==null||Bl!==bf(p)||(p=Bl,"selectionStart"in p&&Hm(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),yu&&gu(yu,p)||(yu=p,p=ph(Wm,"onSelect"),0<p.length&&(c=new Sf("onSelect","select",null,c,f),i.push({event:c,listeners:p}),c.target=Bl)))}function jo(i,c){var f={};return f[i.toLowerCase()]=c.toLowerCase(),f["Webkit"+i]="webkit"+c,f["Moz"+i]="moz"+c,f}var Pl={animationend:jo("Animation","AnimationEnd"),animationiteration:jo("Animation","AnimationIteration"),animationstart:jo("Animation","AnimationStart"),transitionrun:jo("Transition","TransitionRun"),transitionstart:jo("Transition","TransitionStart"),transitioncancel:jo("Transition","TransitionCancel"),transitionend:jo("Transition","TransitionEnd")},Vm={},rw={};Zn&&(rw=document.createElement("div").style,"AnimationEvent"in window||(delete Pl.animationend.animation,delete Pl.animationiteration.animation,delete Pl.animationstart.animation),"TransitionEvent"in window||delete Pl.transitionend.transition);function To(i){if(Vm[i])return Vm[i];if(!Pl[i])return i;var c=Pl[i],f;for(f in c)if(c.hasOwnProperty(f)&&f in rw)return Vm[i]=c[f];return i}var sw=To("animationend"),aw=To("animationiteration"),nw=To("animationstart"),J6=To("transitionrun"),Z6=To("transitionstart"),Q6=To("transitioncancel"),iw=To("transitionend"),ow=new Map,Km="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Km.push("scrollEnd");function gn(i,c){ow.set(i,c),Ut(c,[i])}var Tf=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ya=[],Ul=0,Xm=0;function Af(){for(var i=Ul,c=Xm=Ul=0;c<i;){var f=Ya[c];Ya[c++]=null;var p=Ya[c];Ya[c++]=null;var j=Ya[c];Ya[c++]=null;var D=Ya[c];if(Ya[c++]=null,p!==null&&j!==null){var ee=p.pending;ee===null?j.next=j:(j.next=ee.next,ee.next=j),p.pending=j}D!==0&&lw(f,j,D)}}function Cf(i,c,f,p){Ya[Ul++]=i,Ya[Ul++]=c,Ya[Ul++]=f,Ya[Ul++]=p,Xm|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function Ym(i,c,f,p){return Cf(i,c,f,p),Rf(i)}function Ao(i,c){return Cf(i,null,null,c),Rf(i)}function lw(i,c,f){i.lanes|=f;var p=i.alternate;p!==null&&(p.lanes|=f);for(var j=!1,D=i.return;D!==null;)D.childLanes|=f,p=D.alternate,p!==null&&(p.childLanes|=f),D.tag===22&&(i=D.stateNode,i===null||i._visibility&1||(j=!0)),i=D,D=D.return;return i.tag===3?(D=i.stateNode,j&&c!==null&&(j=31-Le(f),i=D.hiddenUpdates,p=i[j],p===null?i[j]=[c]:p.push(c),c.lane=f|536870912),D):null}function Rf(i){if(50<Uu)throw Uu=0,nx=null,Error(s(185));for(var c=i.return;c!==null;)i=c,c=i.return;return i.tag===3?i.stateNode:null}var zl={};function eA(i,c,f,p){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ca(i,c,f,p){return new eA(i,c,f,p)}function Jm(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Qn(i,c){var f=i.alternate;return f===null?(f=Ca(i.tag,c,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=c,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&65011712,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,c=i.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f.refCleanup=i.refCleanup,f}function cw(i,c){i.flags&=65011714;var f=i.alternate;return f===null?(i.childLanes=0,i.lanes=c,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=f.childLanes,i.lanes=f.lanes,i.child=f.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=f.memoizedProps,i.memoizedState=f.memoizedState,i.updateQueue=f.updateQueue,i.type=f.type,c=f.dependencies,i.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),i}function Df(i,c,f,p,j,D){var ee=0;if(p=i,typeof i=="function")Jm(i)&&(ee=1);else if(typeof i=="string")ee=nC(i,f,V.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case L:return i=Ca(31,f,c,j),i.elementType=L,i.lanes=D,i;case g:return Co(f.children,j,D,c);case _:ee=8,j|=24;break;case w:return i=Ca(12,f,c,j|2),i.elementType=w,i.lanes=D,i;case C:return i=Ca(13,f,c,j),i.elementType=C,i.lanes=D,i;case F:return i=Ca(19,f,c,j),i.elementType=F,i.lanes=D,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case N:ee=10;break e;case S:ee=9;break e;case E:ee=11;break e;case O:ee=14;break e;case B:ee=16,p=null;break e}ee=29,f=Error(s(130,i===null?"null":typeof i,"")),p=null}return c=Ca(ee,f,c,j),c.elementType=i,c.type=p,c.lanes=D,c}function Co(i,c,f,p){return i=Ca(7,i,p,c),i.lanes=f,i}function Zm(i,c,f){return i=Ca(6,i,null,c),i.lanes=f,i}function uw(i){var c=Ca(18,null,null,0);return c.stateNode=i,c}function Qm(i,c,f){return c=Ca(4,i.children!==null?i.children:[],i.key,c),c.lanes=f,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}var dw=new WeakMap;function Ja(i,c){if(typeof i=="object"&&i!==null){var f=dw.get(i);return f!==void 0?f:(c={value:i,source:c,stack:R(c)},dw.set(i,c),c)}return{value:i,source:c,stack:R(c)}}var $l=[],ql=0,Of=null,vu=0,Za=[],Qa=0,Mi=null,Rn=1,Dn="";function ei(i,c){$l[ql++]=vu,$l[ql++]=Of,Of=i,vu=c}function fw(i,c,f){Za[Qa++]=Rn,Za[Qa++]=Dn,Za[Qa++]=Mi,Mi=i;var p=Rn;i=Dn;var j=32-Le(p)-1;p&=~(1<<j),f+=1;var D=32-Le(c)+j;if(30<D){var ee=j-j%5;D=(p&(1<<ee)-1).toString(32),p>>=ee,j-=ee,Rn=1<<32-Le(c)+j|f<<j|p,Dn=D+i}else Rn=1<<D|f<<j|p,Dn=i}function ep(i){i.return!==null&&(ei(i,1),fw(i,1,0))}function tp(i){for(;i===Of;)Of=$l[--ql],$l[ql]=null,vu=$l[--ql],$l[ql]=null;for(;i===Mi;)Mi=Za[--Qa],Za[Qa]=null,Dn=Za[--Qa],Za[Qa]=null,Rn=Za[--Qa],Za[Qa]=null}function hw(i,c){Za[Qa++]=Rn,Za[Qa++]=Dn,Za[Qa++]=Mi,Rn=c.id,Dn=c.overflow,Mi=i}var Bs=null,Hr=null,hr=!1,Bi=null,en=!1,rp=Error(s(519));function Pi(i){var c=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw bu(Ja(c,i)),rp}function mw(i){var c=i.stateNode,f=i.type,p=i.memoizedProps;switch(c[be]=i,c[Se]=p,f){case"dialog":lr("cancel",c),lr("close",c);break;case"iframe":case"object":case"embed":lr("load",c);break;case"video":case"audio":for(f=0;f<$u.length;f++)lr($u[f],c);break;case"source":lr("error",c);break;case"img":case"image":case"link":lr("error",c),lr("load",c);break;case"details":lr("toggle",c);break;case"input":lr("invalid",c),jb(c,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":lr("invalid",c);break;case"textarea":lr("invalid",c),Ab(c,p.value,p.defaultValue,p.children)}f=p.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||c.textContent===""+f||p.suppressHydrationWarning===!0||R2(c.textContent,f)?(p.popover!=null&&(lr("beforetoggle",c),lr("toggle",c)),p.onScroll!=null&&lr("scroll",c),p.onScrollEnd!=null&&lr("scrollend",c),p.onClick!=null&&(c.onclick=Jn),c=!0):c=!1,c||Pi(i,!0)}function pw(i){for(Bs=i.return;Bs;)switch(Bs.tag){case 5:case 31:case 13:en=!1;return;case 27:case 3:en=!0;return;default:Bs=Bs.return}}function Hl(i){if(i!==Bs)return!1;if(!hr)return pw(i),hr=!0,!1;var c=i.tag,f;if((f=c!==3&&c!==27)&&((f=c===5)&&(f=i.type,f=!(f!=="form"&&f!=="button")||bx(i.type,i.memoizedProps)),f=!f),f&&Hr&&Pi(i),pw(i),c===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));Hr=U2(i)}else if(c===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));Hr=U2(i)}else c===27?(c=Hr,Qi(i.type)?(i=Sx,Sx=null,Hr=i):Hr=c):Hr=Bs?rn(i.stateNode.nextSibling):null;return!0}function Ro(){Hr=Bs=null,hr=!1}function sp(){var i=Bi;return i!==null&&(wa===null?wa=i:wa.push.apply(wa,i),Bi=null),i}function bu(i){Bi===null?Bi=[i]:Bi.push(i)}var ap=Z(null),Do=null,ti=null;function Ui(i,c,f){J(ap,c._currentValue),c._currentValue=f}function ri(i){i._currentValue=ap.current,M(ap)}function np(i,c,f){for(;i!==null;){var p=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,p!==null&&(p.childLanes|=c)):p!==null&&(p.childLanes&c)!==c&&(p.childLanes|=c),i===f)break;i=i.return}}function ip(i,c,f,p){var j=i.child;for(j!==null&&(j.return=i);j!==null;){var D=j.dependencies;if(D!==null){var ee=j.child;D=D.firstContext;e:for(;D!==null;){var ge=D;D=j;for(var Fe=0;Fe<c.length;Fe++)if(ge.context===c[Fe]){D.lanes|=f,ge=D.alternate,ge!==null&&(ge.lanes|=f),np(D.return,f,i),p||(ee=null);break e}D=ge.next}}else if(j.tag===18){if(ee=j.return,ee===null)throw Error(s(341));ee.lanes|=f,D=ee.alternate,D!==null&&(D.lanes|=f),np(ee,f,i),ee=null}else ee=j.child;if(ee!==null)ee.return=j;else for(ee=j;ee!==null;){if(ee===i){ee=null;break}if(j=ee.sibling,j!==null){j.return=ee.return,ee=j;break}ee=ee.return}j=ee}}function Wl(i,c,f,p){i=null;for(var j=c,D=!1;j!==null;){if(!D){if((j.flags&524288)!==0)D=!0;else if((j.flags&262144)!==0)break}if(j.tag===10){var ee=j.alternate;if(ee===null)throw Error(s(387));if(ee=ee.memoizedProps,ee!==null){var ge=j.type;Aa(j.pendingProps.value,ee.value)||(i!==null?i.push(ge):i=[ge])}}else if(j===P.current){if(ee=j.alternate,ee===null)throw Error(s(387));ee.memoizedState.memoizedState!==j.memoizedState.memoizedState&&(i!==null?i.push(Vu):i=[Vu])}j=j.return}i!==null&&ip(c,i,f,p),c.flags|=262144}function Ff(i){for(i=i.firstContext;i!==null;){if(!Aa(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Oo(i){Do=i,ti=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Ps(i){return xw(Do,i)}function Lf(i,c){return Do===null&&Oo(i),xw(i,c)}function xw(i,c){var f=c._currentValue;if(c={context:c,memoizedValue:f,next:null},ti===null){if(i===null)throw Error(s(308));ti=c,i.dependencies={lanes:0,firstContext:c},i.flags|=524288}else ti=ti.next=c;return f}var tA=typeof AbortController<"u"?AbortController:function(){var i=[],c=this.signal={aborted:!1,addEventListener:function(f,p){i.push(p)}};this.abort=function(){c.aborted=!0,i.forEach(function(f){return f()})}},rA=e.unstable_scheduleCallback,sA=e.unstable_NormalPriority,vs={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function op(){return{controller:new tA,data:new Map,refCount:0}}function wu(i){i.refCount--,i.refCount===0&&rA(sA,function(){i.controller.abort()})}var _u=null,lp=0,Gl=0,Vl=null;function aA(i,c){if(_u===null){var f=_u=[];lp=0,Gl=dx(),Vl={status:"pending",value:void 0,then:function(p){f.push(p)}}}return lp++,c.then(gw,gw),c}function gw(){if(--lp===0&&_u!==null){Vl!==null&&(Vl.status="fulfilled");var i=_u;_u=null,Gl=0,Vl=null;for(var c=0;c<i.length;c++)(0,i[c])()}}function nA(i,c){var f=[],p={status:"pending",value:null,reason:null,then:function(j){f.push(j)}};return i.then(function(){p.status="fulfilled",p.value=c;for(var j=0;j<f.length;j++)(0,f[j])(c)},function(j){for(p.status="rejected",p.reason=j,j=0;j<f.length;j++)(0,f[j])(void 0)}),p}var yw=Q.S;Q.S=function(i,c){t2=Me(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&aA(i,c),yw!==null&&yw(i,c)};var Fo=Z(null);function cp(){var i=Fo.current;return i!==null?i:zr.pooledCache}function If(i,c){c===null?J(Fo,Fo.current):J(Fo,c.pool)}function vw(){var i=cp();return i===null?null:{parent:vs._currentValue,pool:i}}var Kl=Error(s(460)),up=Error(s(474)),Mf=Error(s(542)),Bf={then:function(){}};function bw(i){return i=i.status,i==="fulfilled"||i==="rejected"}function ww(i,c,f){switch(f=i[f],f===void 0?i.push(c):f!==c&&(c.then(Jn,Jn),c=f),c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,Nw(i),i;default:if(typeof c.status=="string")c.then(Jn,Jn);else{if(i=zr,i!==null&&100<i.shellSuspendCounter)throw Error(s(482));i=c,i.status="pending",i.then(function(p){if(c.status==="pending"){var j=c;j.status="fulfilled",j.value=p}},function(p){if(c.status==="pending"){var j=c;j.status="rejected",j.reason=p}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw i=c.reason,Nw(i),i}throw Io=c,Kl}}function Lo(i){try{var c=i._init;return c(i._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(Io=f,Kl):f}}var Io=null;function _w(){if(Io===null)throw Error(s(459));var i=Io;return Io=null,i}function Nw(i){if(i===Kl||i===Mf)throw Error(s(483))}var Xl=null,Nu=0;function Pf(i){var c=Nu;return Nu+=1,Xl===null&&(Xl=[]),ww(Xl,i,c)}function ku(i,c){c=c.props.ref,i.ref=c!==void 0?c:null}function Uf(i,c){throw c.$$typeof===y?Error(s(525)):(i=Object.prototype.toString.call(c),Error(s(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i)))}function kw(i){function c(ze,Be){if(i){var Ge=ze.deletions;Ge===null?(ze.deletions=[Be],ze.flags|=16):Ge.push(Be)}}function f(ze,Be){if(!i)return null;for(;Be!==null;)c(ze,Be),Be=Be.sibling;return null}function p(ze){for(var Be=new Map;ze!==null;)ze.key!==null?Be.set(ze.key,ze):Be.set(ze.index,ze),ze=ze.sibling;return Be}function j(ze,Be){return ze=Qn(ze,Be),ze.index=0,ze.sibling=null,ze}function D(ze,Be,Ge){return ze.index=Ge,i?(Ge=ze.alternate,Ge!==null?(Ge=Ge.index,Ge<Be?(ze.flags|=67108866,Be):Ge):(ze.flags|=67108866,Be)):(ze.flags|=1048576,Be)}function ee(ze){return i&&ze.alternate===null&&(ze.flags|=67108866),ze}function ge(ze,Be,Ge,lt){return Be===null||Be.tag!==6?(Be=Zm(Ge,ze.mode,lt),Be.return=ze,Be):(Be=j(Be,Ge),Be.return=ze,Be)}function Fe(ze,Be,Ge,lt){var Mt=Ge.type;return Mt===g?it(ze,Be,Ge.props.children,lt,Ge.key):Be!==null&&(Be.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===B&&Lo(Mt)===Be.type)?(Be=j(Be,Ge.props),ku(Be,Ge),Be.return=ze,Be):(Be=Df(Ge.type,Ge.key,Ge.props,null,ze.mode,lt),ku(Be,Ge),Be.return=ze,Be)}function Ve(ze,Be,Ge,lt){return Be===null||Be.tag!==4||Be.stateNode.containerInfo!==Ge.containerInfo||Be.stateNode.implementation!==Ge.implementation?(Be=Qm(Ge,ze.mode,lt),Be.return=ze,Be):(Be=j(Be,Ge.children||[]),Be.return=ze,Be)}function it(ze,Be,Ge,lt,Mt){return Be===null||Be.tag!==7?(Be=Co(Ge,ze.mode,lt,Mt),Be.return=ze,Be):(Be=j(Be,Ge),Be.return=ze,Be)}function ut(ze,Be,Ge){if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return Be=Zm(""+Be,ze.mode,Ge),Be.return=ze,Be;if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case b:return Ge=Df(Be.type,Be.key,Be.props,null,ze.mode,Ge),ku(Ge,Be),Ge.return=ze,Ge;case v:return Be=Qm(Be,ze.mode,Ge),Be.return=ze,Be;case B:return Be=Lo(Be),ut(ze,Be,Ge)}if(ae(Be)||A(Be))return Be=Co(Be,ze.mode,Ge,null),Be.return=ze,Be;if(typeof Be.then=="function")return ut(ze,Pf(Be),Ge);if(Be.$$typeof===N)return ut(ze,Lf(ze,Be),Ge);Uf(ze,Be)}return null}function Xe(ze,Be,Ge,lt){var Mt=Be!==null?Be.key:null;if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint")return Mt!==null?null:ge(ze,Be,""+Ge,lt);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case b:return Ge.key===Mt?Fe(ze,Be,Ge,lt):null;case v:return Ge.key===Mt?Ve(ze,Be,Ge,lt):null;case B:return Ge=Lo(Ge),Xe(ze,Be,Ge,lt)}if(ae(Ge)||A(Ge))return Mt!==null?null:it(ze,Be,Ge,lt,null);if(typeof Ge.then=="function")return Xe(ze,Be,Pf(Ge),lt);if(Ge.$$typeof===N)return Xe(ze,Be,Lf(ze,Ge),lt);Uf(ze,Ge)}return null}function Qe(ze,Be,Ge,lt,Mt){if(typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint")return ze=ze.get(Ge)||null,ge(Be,ze,""+lt,Mt);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case b:return ze=ze.get(lt.key===null?Ge:lt.key)||null,Fe(Be,ze,lt,Mt);case v:return ze=ze.get(lt.key===null?Ge:lt.key)||null,Ve(Be,ze,lt,Mt);case B:return lt=Lo(lt),Qe(ze,Be,Ge,lt,Mt)}if(ae(lt)||A(lt))return ze=ze.get(Ge)||null,it(Be,ze,lt,Mt,null);if(typeof lt.then=="function")return Qe(ze,Be,Ge,Pf(lt),Mt);if(lt.$$typeof===N)return Qe(ze,Be,Ge,Lf(Be,lt),Mt);Uf(Be,lt)}return null}function Ot(ze,Be,Ge,lt){for(var Mt=null,vr=null,Lt=Be,Qt=Be=0,dr=null;Lt!==null&&Qt<Ge.length;Qt++){Lt.index>Qt?(dr=Lt,Lt=null):dr=Lt.sibling;var br=Xe(ze,Lt,Ge[Qt],lt);if(br===null){Lt===null&&(Lt=dr);break}i&&Lt&&br.alternate===null&&c(ze,Lt),Be=D(br,Be,Qt),vr===null?Mt=br:vr.sibling=br,vr=br,Lt=dr}if(Qt===Ge.length)return f(ze,Lt),hr&&ei(ze,Qt),Mt;if(Lt===null){for(;Qt<Ge.length;Qt++)Lt=ut(ze,Ge[Qt],lt),Lt!==null&&(Be=D(Lt,Be,Qt),vr===null?Mt=Lt:vr.sibling=Lt,vr=Lt);return hr&&ei(ze,Qt),Mt}for(Lt=p(Lt);Qt<Ge.length;Qt++)dr=Qe(Lt,ze,Qt,Ge[Qt],lt),dr!==null&&(i&&dr.alternate!==null&&Lt.delete(dr.key===null?Qt:dr.key),Be=D(dr,Be,Qt),vr===null?Mt=dr:vr.sibling=dr,vr=dr);return i&&Lt.forEach(function(ao){return c(ze,ao)}),hr&&ei(ze,Qt),Mt}function $t(ze,Be,Ge,lt){if(Ge==null)throw Error(s(151));for(var Mt=null,vr=null,Lt=Be,Qt=Be=0,dr=null,br=Ge.next();Lt!==null&&!br.done;Qt++,br=Ge.next()){Lt.index>Qt?(dr=Lt,Lt=null):dr=Lt.sibling;var ao=Xe(ze,Lt,br.value,lt);if(ao===null){Lt===null&&(Lt=dr);break}i&&Lt&&ao.alternate===null&&c(ze,Lt),Be=D(ao,Be,Qt),vr===null?Mt=ao:vr.sibling=ao,vr=ao,Lt=dr}if(br.done)return f(ze,Lt),hr&&ei(ze,Qt),Mt;if(Lt===null){for(;!br.done;Qt++,br=Ge.next())br=ut(ze,br.value,lt),br!==null&&(Be=D(br,Be,Qt),vr===null?Mt=br:vr.sibling=br,vr=br);return hr&&ei(ze,Qt),Mt}for(Lt=p(Lt);!br.done;Qt++,br=Ge.next())br=Qe(Lt,ze,Qt,br.value,lt),br!==null&&(i&&br.alternate!==null&&Lt.delete(br.key===null?Qt:br.key),Be=D(br,Be,Qt),vr===null?Mt=br:vr.sibling=br,vr=br);return i&&Lt.forEach(function(xC){return c(ze,xC)}),hr&&ei(ze,Qt),Mt}function Ir(ze,Be,Ge,lt){if(typeof Ge=="object"&&Ge!==null&&Ge.type===g&&Ge.key===null&&(Ge=Ge.props.children),typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case b:e:{for(var Mt=Ge.key;Be!==null;){if(Be.key===Mt){if(Mt=Ge.type,Mt===g){if(Be.tag===7){f(ze,Be.sibling),lt=j(Be,Ge.props.children),lt.return=ze,ze=lt;break e}}else if(Be.elementType===Mt||typeof Mt=="object"&&Mt!==null&&Mt.$$typeof===B&&Lo(Mt)===Be.type){f(ze,Be.sibling),lt=j(Be,Ge.props),ku(lt,Ge),lt.return=ze,ze=lt;break e}f(ze,Be);break}else c(ze,Be);Be=Be.sibling}Ge.type===g?(lt=Co(Ge.props.children,ze.mode,lt,Ge.key),lt.return=ze,ze=lt):(lt=Df(Ge.type,Ge.key,Ge.props,null,ze.mode,lt),ku(lt,Ge),lt.return=ze,ze=lt)}return ee(ze);case v:e:{for(Mt=Ge.key;Be!==null;){if(Be.key===Mt)if(Be.tag===4&&Be.stateNode.containerInfo===Ge.containerInfo&&Be.stateNode.implementation===Ge.implementation){f(ze,Be.sibling),lt=j(Be,Ge.children||[]),lt.return=ze,ze=lt;break e}else{f(ze,Be);break}else c(ze,Be);Be=Be.sibling}lt=Qm(Ge,ze.mode,lt),lt.return=ze,ze=lt}return ee(ze);case B:return Ge=Lo(Ge),Ir(ze,Be,Ge,lt)}if(ae(Ge))return Ot(ze,Be,Ge,lt);if(A(Ge)){if(Mt=A(Ge),typeof Mt!="function")throw Error(s(150));return Ge=Mt.call(Ge),$t(ze,Be,Ge,lt)}if(typeof Ge.then=="function")return Ir(ze,Be,Pf(Ge),lt);if(Ge.$$typeof===N)return Ir(ze,Be,Lf(ze,Ge),lt);Uf(ze,Ge)}return typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint"?(Ge=""+Ge,Be!==null&&Be.tag===6?(f(ze,Be.sibling),lt=j(Be,Ge),lt.return=ze,ze=lt):(f(ze,Be),lt=Zm(Ge,ze.mode,lt),lt.return=ze,ze=lt),ee(ze)):f(ze,Be)}return function(ze,Be,Ge,lt){try{Nu=0;var Mt=Ir(ze,Be,Ge,lt);return Xl=null,Mt}catch(Lt){if(Lt===Kl||Lt===Mf)throw Lt;var vr=Ca(29,Lt,null,ze.mode);return vr.lanes=lt,vr.return=ze,vr}}}var Mo=kw(!0),Sw=kw(!1),zi=!1;function dp(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function fp(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function $i(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function qi(i,c,f){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Nr&2)!==0){var j=p.pending;return j===null?c.next=c:(c.next=j.next,j.next=c),p.pending=c,c=Rf(i),lw(i,null,f),c}return Cf(i,p,c,f),Rf(i)}function Su(i,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194048)!==0)){var p=c.lanes;p&=i.pendingLanes,f|=p,c.lanes=f,zt(i,f)}}function hp(i,c){var f=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,f===p)){var j=null,D=null;if(f=f.firstBaseUpdate,f!==null){do{var ee={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};D===null?j=D=ee:D=D.next=ee,f=f.next}while(f!==null);D===null?j=D=c:D=D.next=c}else j=D=c;f={baseState:p.baseState,firstBaseUpdate:j,lastBaseUpdate:D,shared:p.shared,callbacks:p.callbacks},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=c:i.next=c,f.lastBaseUpdate=c}var mp=!1;function Eu(){if(mp){var i=Vl;if(i!==null)throw i}}function ju(i,c,f,p){mp=!1;var j=i.updateQueue;zi=!1;var D=j.firstBaseUpdate,ee=j.lastBaseUpdate,ge=j.shared.pending;if(ge!==null){j.shared.pending=null;var Fe=ge,Ve=Fe.next;Fe.next=null,ee===null?D=Ve:ee.next=Ve,ee=Fe;var it=i.alternate;it!==null&&(it=it.updateQueue,ge=it.lastBaseUpdate,ge!==ee&&(ge===null?it.firstBaseUpdate=Ve:ge.next=Ve,it.lastBaseUpdate=Fe))}if(D!==null){var ut=j.baseState;ee=0,it=Ve=Fe=null,ge=D;do{var Xe=ge.lane&-536870913,Qe=Xe!==ge.lane;if(Qe?(ur&Xe)===Xe:(p&Xe)===Xe){Xe!==0&&Xe===Gl&&(mp=!0),it!==null&&(it=it.next={lane:0,tag:ge.tag,payload:ge.payload,callback:null,next:null});e:{var Ot=i,$t=ge;Xe=c;var Ir=f;switch($t.tag){case 1:if(Ot=$t.payload,typeof Ot=="function"){ut=Ot.call(Ir,ut,Xe);break e}ut=Ot;break e;case 3:Ot.flags=Ot.flags&-65537|128;case 0:if(Ot=$t.payload,Xe=typeof Ot=="function"?Ot.call(Ir,ut,Xe):Ot,Xe==null)break e;ut=x({},ut,Xe);break e;case 2:zi=!0}}Xe=ge.callback,Xe!==null&&(i.flags|=64,Qe&&(i.flags|=8192),Qe=j.callbacks,Qe===null?j.callbacks=[Xe]:Qe.push(Xe))}else Qe={lane:Xe,tag:ge.tag,payload:ge.payload,callback:ge.callback,next:null},it===null?(Ve=it=Qe,Fe=ut):it=it.next=Qe,ee|=Xe;if(ge=ge.next,ge===null){if(ge=j.shared.pending,ge===null)break;Qe=ge,ge=Qe.next,Qe.next=null,j.lastBaseUpdate=Qe,j.shared.pending=null}}while(!0);it===null&&(Fe=ut),j.baseState=Fe,j.firstBaseUpdate=Ve,j.lastBaseUpdate=it,D===null&&(j.shared.lanes=0),Ki|=ee,i.lanes=ee,i.memoizedState=ut}}function Ew(i,c){if(typeof i!="function")throw Error(s(191,i));i.call(c)}function jw(i,c){var f=i.callbacks;if(f!==null)for(i.callbacks=null,i=0;i<f.length;i++)Ew(f[i],c)}var Yl=Z(null),zf=Z(0);function Tw(i,c){i=di,J(zf,i),J(Yl,c),di=i|c.baseLanes}function pp(){J(zf,di),J(Yl,Yl.current)}function xp(){di=zf.current,M(Yl),M(zf)}var Ra=Z(null),tn=null;function Hi(i){var c=i.alternate;J(hs,hs.current&1),J(Ra,i),tn===null&&(c===null||Yl.current!==null||c.memoizedState!==null)&&(tn=i)}function gp(i){J(hs,hs.current),J(Ra,i),tn===null&&(tn=i)}function Aw(i){i.tag===22?(J(hs,hs.current),J(Ra,i),tn===null&&(tn=i)):Wi()}function Wi(){J(hs,hs.current),J(Ra,Ra.current)}function Da(i){M(Ra),tn===i&&(tn=null),M(hs)}var hs=Z(0);function $f(i){for(var c=i;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Nx(f)||kx(f)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var si=0,Jt=null,Fr=null,bs=null,qf=!1,Jl=!1,Bo=!1,Hf=0,Tu=0,Zl=null,iA=0;function rs(){throw Error(s(321))}function yp(i,c){if(c===null)return!1;for(var f=0;f<c.length&&f<i.length;f++)if(!Aa(i[f],c[f]))return!1;return!0}function vp(i,c,f,p,j,D){return si=D,Jt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Q.H=i===null||i.memoizedState===null?f_:Fp,Bo=!1,D=f(p,j),Bo=!1,Jl&&(D=Rw(c,f,p,j)),Cw(i),D}function Cw(i){Q.H=Ru;var c=Fr!==null&&Fr.next!==null;if(si=0,bs=Fr=Jt=null,qf=!1,Tu=0,Zl=null,c)throw Error(s(300));i===null||ws||(i=i.dependencies,i!==null&&Ff(i)&&(ws=!0))}function Rw(i,c,f,p){Jt=i;var j=0;do{if(Jl&&(Zl=null),Tu=0,Jl=!1,25<=j)throw Error(s(301));if(j+=1,bs=Fr=null,i.updateQueue!=null){var D=i.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}Q.H=h_,D=c(f,p)}while(Jl);return D}function oA(){var i=Q.H,c=i.useState()[0];return c=typeof c.then=="function"?Au(c):c,i=i.useState()[0],(Fr!==null?Fr.memoizedState:null)!==i&&(Jt.flags|=1024),c}function bp(){var i=Hf!==0;return Hf=0,i}function wp(i,c,f){c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~f}function _p(i){if(qf){for(i=i.memoizedState;i!==null;){var c=i.queue;c!==null&&(c.pending=null),i=i.next}qf=!1}si=0,bs=Fr=Jt=null,Jl=!1,Tu=Hf=0,Zl=null}function da(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bs===null?Jt.memoizedState=bs=i:bs=bs.next=i,bs}function ms(){if(Fr===null){var i=Jt.alternate;i=i!==null?i.memoizedState:null}else i=Fr.next;var c=bs===null?Jt.memoizedState:bs.next;if(c!==null)bs=c,Fr=i;else{if(i===null)throw Jt.alternate===null?Error(s(467)):Error(s(310));Fr=i,i={memoizedState:Fr.memoizedState,baseState:Fr.baseState,baseQueue:Fr.baseQueue,queue:Fr.queue,next:null},bs===null?Jt.memoizedState=bs=i:bs=bs.next=i}return bs}function Wf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Au(i){var c=Tu;return Tu+=1,Zl===null&&(Zl=[]),i=ww(Zl,i,c),c=Jt,(bs===null?c.memoizedState:bs.next)===null&&(c=c.alternate,Q.H=c===null||c.memoizedState===null?f_:Fp),i}function Gf(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Au(i);if(i.$$typeof===N)return Ps(i)}throw Error(s(438,String(i)))}function Np(i){var c=null,f=Jt.updateQueue;if(f!==null&&(c=f.memoCache),c==null){var p=Jt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(c={data:p.data.map(function(j){return j.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),f===null&&(f=Wf(),Jt.updateQueue=f),f.memoCache=c,f=c.data[c.index],f===void 0)for(f=c.data[c.index]=Array(i),p=0;p<i;p++)f[p]=H;return c.index++,f}function ai(i,c){return typeof c=="function"?c(i):c}function Vf(i){var c=ms();return kp(c,Fr,i)}function kp(i,c,f){var p=i.queue;if(p===null)throw Error(s(311));p.lastRenderedReducer=f;var j=i.baseQueue,D=p.pending;if(D!==null){if(j!==null){var ee=j.next;j.next=D.next,D.next=ee}c.baseQueue=j=D,p.pending=null}if(D=i.baseState,j===null)i.memoizedState=D;else{c=j.next;var ge=ee=null,Fe=null,Ve=c,it=!1;do{var ut=Ve.lane&-536870913;if(ut!==Ve.lane?(ur&ut)===ut:(si&ut)===ut){var Xe=Ve.revertLane;if(Xe===0)Fe!==null&&(Fe=Fe.next={lane:0,revertLane:0,gesture:null,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null}),ut===Gl&&(it=!0);else if((si&Xe)===Xe){Ve=Ve.next,Xe===Gl&&(it=!0);continue}else ut={lane:0,revertLane:Ve.revertLane,gesture:null,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null},Fe===null?(ge=Fe=ut,ee=D):Fe=Fe.next=ut,Jt.lanes|=Xe,Ki|=Xe;ut=Ve.action,Bo&&f(D,ut),D=Ve.hasEagerState?Ve.eagerState:f(D,ut)}else Xe={lane:ut,revertLane:Ve.revertLane,gesture:Ve.gesture,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null},Fe===null?(ge=Fe=Xe,ee=D):Fe=Fe.next=Xe,Jt.lanes|=ut,Ki|=ut;Ve=Ve.next}while(Ve!==null&&Ve!==c);if(Fe===null?ee=D:Fe.next=ge,!Aa(D,i.memoizedState)&&(ws=!0,it&&(f=Vl,f!==null)))throw f;i.memoizedState=D,i.baseState=ee,i.baseQueue=Fe,p.lastRenderedState=D}return j===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function Sp(i){var c=ms(),f=c.queue;if(f===null)throw Error(s(311));f.lastRenderedReducer=i;var p=f.dispatch,j=f.pending,D=c.memoizedState;if(j!==null){f.pending=null;var ee=j=j.next;do D=i(D,ee.action),ee=ee.next;while(ee!==j);Aa(D,c.memoizedState)||(ws=!0),c.memoizedState=D,c.baseQueue===null&&(c.baseState=D),f.lastRenderedState=D}return[D,p]}function Dw(i,c,f){var p=Jt,j=ms(),D=hr;if(D){if(f===void 0)throw Error(s(407));f=f()}else f=c();var ee=!Aa((Fr||j).memoizedState,f);if(ee&&(j.memoizedState=f,ws=!0),j=j.queue,Tp(Lw.bind(null,p,j,i),[i]),j.getSnapshot!==c||ee||bs!==null&&bs.memoizedState.tag&1){if(p.flags|=2048,Ql(9,{destroy:void 0},Fw.bind(null,p,j,f,c),null),zr===null)throw Error(s(349));D||(si&127)!==0||Ow(p,c,f)}return f}function Ow(i,c,f){i.flags|=16384,i={getSnapshot:c,value:f},c=Jt.updateQueue,c===null?(c=Wf(),Jt.updateQueue=c,c.stores=[i]):(f=c.stores,f===null?c.stores=[i]:f.push(i))}function Fw(i,c,f,p){c.value=f,c.getSnapshot=p,Iw(c)&&Mw(i)}function Lw(i,c,f){return f(function(){Iw(c)&&Mw(i)})}function Iw(i){var c=i.getSnapshot;i=i.value;try{var f=c();return!Aa(i,f)}catch{return!0}}function Mw(i){var c=Ao(i,2);c!==null&&_a(c,i,2)}function Ep(i){var c=da();if(typeof i=="function"){var f=i;if(i=f(),Bo){Rt(!0);try{f()}finally{Rt(!1)}}}return c.memoizedState=c.baseState=i,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:i},c}function Bw(i,c,f,p){return i.baseState=f,kp(i,Fr,typeof p=="function"?p:ai)}function lA(i,c,f,p,j){if(Yf(i))throw Error(s(485));if(i=c.action,i!==null){var D={payload:j,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ee){D.listeners.push(ee)}};Q.T!==null?f(!0):D.isTransition=!1,p(D),f=c.pending,f===null?(D.next=c.pending=D,Pw(c,D)):(D.next=f.next,c.pending=f.next=D)}}function Pw(i,c){var f=c.action,p=c.payload,j=i.state;if(c.isTransition){var D=Q.T,ee={};Q.T=ee;try{var ge=f(j,p),Fe=Q.S;Fe!==null&&Fe(ee,ge),Uw(i,c,ge)}catch(Ve){jp(i,c,Ve)}finally{D!==null&&ee.types!==null&&(D.types=ee.types),Q.T=D}}else try{D=f(j,p),Uw(i,c,D)}catch(Ve){jp(i,c,Ve)}}function Uw(i,c,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(p){zw(i,c,p)},function(p){return jp(i,c,p)}):zw(i,c,f)}function zw(i,c,f){c.status="fulfilled",c.value=f,$w(c),i.state=f,c=i.pending,c!==null&&(f=c.next,f===c?i.pending=null:(f=f.next,c.next=f,Pw(i,f)))}function jp(i,c,f){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do c.status="rejected",c.reason=f,$w(c),c=c.next;while(c!==p)}i.action=null}function $w(i){i=i.listeners;for(var c=0;c<i.length;c++)(0,i[c])()}function qw(i,c){return c}function Hw(i,c){if(hr){var f=zr.formState;if(f!==null){e:{var p=Jt;if(hr){if(Hr){t:{for(var j=Hr,D=en;j.nodeType!==8;){if(!D){j=null;break t}if(j=rn(j.nextSibling),j===null){j=null;break t}}D=j.data,j=D==="F!"||D==="F"?j:null}if(j){Hr=rn(j.nextSibling),p=j.data==="F!";break e}}Pi(p)}p=!1}p&&(c=f[0])}}return f=da(),f.memoizedState=f.baseState=c,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qw,lastRenderedState:c},f.queue=p,f=c_.bind(null,Jt,p),p.dispatch=f,p=Ep(!1),D=Op.bind(null,Jt,!1,p.queue),p=da(),j={state:c,dispatch:null,action:i,pending:null},p.queue=j,f=lA.bind(null,Jt,j,D,f),j.dispatch=f,p.memoizedState=i,[c,f,!1]}function Ww(i){var c=ms();return Gw(c,Fr,i)}function Gw(i,c,f){if(c=kp(i,c,qw)[0],i=Vf(ai)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var p=Au(c)}catch(ee){throw ee===Kl?Mf:ee}else p=c;c=ms();var j=c.queue,D=j.dispatch;return f!==c.memoizedState&&(Jt.flags|=2048,Ql(9,{destroy:void 0},cA.bind(null,j,f),null)),[p,D,i]}function cA(i,c){i.action=c}function Vw(i){var c=ms(),f=Fr;if(f!==null)return Gw(c,f,i);ms(),c=c.memoizedState,f=ms();var p=f.queue.dispatch;return f.memoizedState=i,[c,p,!1]}function Ql(i,c,f,p){return i={tag:i,create:f,deps:p,inst:c,next:null},c=Jt.updateQueue,c===null&&(c=Wf(),Jt.updateQueue=c),f=c.lastEffect,f===null?c.lastEffect=i.next=i:(p=f.next,f.next=i,i.next=p,c.lastEffect=i),i}function Kw(){return ms().memoizedState}function Kf(i,c,f,p){var j=da();Jt.flags|=i,j.memoizedState=Ql(1|c,{destroy:void 0},f,p===void 0?null:p)}function Xf(i,c,f,p){var j=ms();p=p===void 0?null:p;var D=j.memoizedState.inst;Fr!==null&&p!==null&&yp(p,Fr.memoizedState.deps)?j.memoizedState=Ql(c,D,f,p):(Jt.flags|=i,j.memoizedState=Ql(1|c,D,f,p))}function Xw(i,c){Kf(8390656,8,i,c)}function Tp(i,c){Xf(2048,8,i,c)}function uA(i){Jt.flags|=4;var c=Jt.updateQueue;if(c===null)c=Wf(),Jt.updateQueue=c,c.events=[i];else{var f=c.events;f===null?c.events=[i]:f.push(i)}}function Yw(i){var c=ms().memoizedState;return uA({ref:c,nextImpl:i}),function(){if((Nr&2)!==0)throw Error(s(440));return c.impl.apply(void 0,arguments)}}function Jw(i,c){return Xf(4,2,i,c)}function Zw(i,c){return Xf(4,4,i,c)}function Qw(i,c){if(typeof c=="function"){i=i();var f=c(i);return function(){typeof f=="function"?f():c(null)}}if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function e_(i,c,f){f=f!=null?f.concat([i]):null,Xf(4,4,Qw.bind(null,c,i),f)}function Ap(){}function t_(i,c){var f=ms();c=c===void 0?null:c;var p=f.memoizedState;return c!==null&&yp(c,p[1])?p[0]:(f.memoizedState=[i,c],i)}function r_(i,c){var f=ms();c=c===void 0?null:c;var p=f.memoizedState;if(c!==null&&yp(c,p[1]))return p[0];if(p=i(),Bo){Rt(!0);try{i()}finally{Rt(!1)}}return f.memoizedState=[p,c],p}function Cp(i,c,f){return f===void 0||(si&1073741824)!==0&&(ur&261930)===0?i.memoizedState=c:(i.memoizedState=f,i=s2(),Jt.lanes|=i,Ki|=i,f)}function s_(i,c,f,p){return Aa(f,c)?f:Yl.current!==null?(i=Cp(i,f,p),Aa(i,c)||(ws=!0),i):(si&42)===0||(si&1073741824)!==0&&(ur&261930)===0?(ws=!0,i.memoizedState=f):(i=s2(),Jt.lanes|=i,Ki|=i,c)}function a_(i,c,f,p,j){var D=re.p;re.p=D!==0&&8>D?D:8;var ee=Q.T,ge={};Q.T=ge,Op(i,!1,c,f);try{var Fe=j(),Ve=Q.S;if(Ve!==null&&Ve(ge,Fe),Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"){var it=nA(Fe,p);Cu(i,c,it,La(i))}else Cu(i,c,p,La(i))}catch(ut){Cu(i,c,{then:function(){},status:"rejected",reason:ut},La())}finally{re.p=D,ee!==null&&ge.types!==null&&(ee.types=ge.types),Q.T=ee}}function dA(){}function Rp(i,c,f,p){if(i.tag!==5)throw Error(s(476));var j=n_(i).queue;a_(i,j,c,ve,f===null?dA:function(){return i_(i),f(p)})}function n_(i){var c=i.memoizedState;if(c!==null)return c;c={memoizedState:ve,baseState:ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:ve},next:null};var f={};return c.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:f},next:null},i.memoizedState=c,i=i.alternate,i!==null&&(i.memoizedState=c),c}function i_(i){var c=n_(i);c.next===null&&(c=i.alternate.memoizedState),Cu(i,c.next.queue,{},La())}function Dp(){return Ps(Vu)}function o_(){return ms().memoizedState}function l_(){return ms().memoizedState}function fA(i){for(var c=i.return;c!==null;){switch(c.tag){case 24:case 3:var f=La();i=$i(f);var p=qi(c,i,f);p!==null&&(_a(p,c,f),Su(p,c,f)),c={cache:op()},i.payload=c;return}c=c.return}}function hA(i,c,f){var p=La();f={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Yf(i)?u_(c,f):(f=Ym(i,c,f,p),f!==null&&(_a(f,i,p),d_(f,c,p)))}function c_(i,c,f){var p=La();Cu(i,c,f,p)}function Cu(i,c,f,p){var j={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Yf(i))u_(c,j);else{var D=i.alternate;if(i.lanes===0&&(D===null||D.lanes===0)&&(D=c.lastRenderedReducer,D!==null))try{var ee=c.lastRenderedState,ge=D(ee,f);if(j.hasEagerState=!0,j.eagerState=ge,Aa(ge,ee))return Cf(i,c,j,0),zr===null&&Af(),!1}catch{}if(f=Ym(i,c,j,p),f!==null)return _a(f,i,p),d_(f,c,p),!0}return!1}function Op(i,c,f,p){if(p={lane:2,revertLane:dx(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Yf(i)){if(c)throw Error(s(479))}else c=Ym(i,f,p,2),c!==null&&_a(c,i,2)}function Yf(i){var c=i.alternate;return i===Jt||c!==null&&c===Jt}function u_(i,c){Jl=qf=!0;var f=i.pending;f===null?c.next=c:(c.next=f.next,f.next=c),i.pending=c}function d_(i,c,f){if((f&4194048)!==0){var p=c.lanes;p&=i.pendingLanes,f|=p,c.lanes=f,zt(i,f)}}var Ru={readContext:Ps,use:Gf,useCallback:rs,useContext:rs,useEffect:rs,useImperativeHandle:rs,useLayoutEffect:rs,useInsertionEffect:rs,useMemo:rs,useReducer:rs,useRef:rs,useState:rs,useDebugValue:rs,useDeferredValue:rs,useTransition:rs,useSyncExternalStore:rs,useId:rs,useHostTransitionStatus:rs,useFormState:rs,useActionState:rs,useOptimistic:rs,useMemoCache:rs,useCacheRefresh:rs};Ru.useEffectEvent=rs;var f_={readContext:Ps,use:Gf,useCallback:function(i,c){return da().memoizedState=[i,c===void 0?null:c],i},useContext:Ps,useEffect:Xw,useImperativeHandle:function(i,c,f){f=f!=null?f.concat([i]):null,Kf(4194308,4,Qw.bind(null,c,i),f)},useLayoutEffect:function(i,c){return Kf(4194308,4,i,c)},useInsertionEffect:function(i,c){Kf(4,2,i,c)},useMemo:function(i,c){var f=da();c=c===void 0?null:c;var p=i();if(Bo){Rt(!0);try{i()}finally{Rt(!1)}}return f.memoizedState=[p,c],p},useReducer:function(i,c,f){var p=da();if(f!==void 0){var j=f(c);if(Bo){Rt(!0);try{f(c)}finally{Rt(!1)}}}else j=c;return p.memoizedState=p.baseState=j,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:j},p.queue=i,i=i.dispatch=hA.bind(null,Jt,i),[p.memoizedState,i]},useRef:function(i){var c=da();return i={current:i},c.memoizedState=i},useState:function(i){i=Ep(i);var c=i.queue,f=c_.bind(null,Jt,c);return c.dispatch=f,[i.memoizedState,f]},useDebugValue:Ap,useDeferredValue:function(i,c){var f=da();return Cp(f,i,c)},useTransition:function(){var i=Ep(!1);return i=a_.bind(null,Jt,i.queue,!0,!1),da().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,c,f){var p=Jt,j=da();if(hr){if(f===void 0)throw Error(s(407));f=f()}else{if(f=c(),zr===null)throw Error(s(349));(ur&127)!==0||Ow(p,c,f)}j.memoizedState=f;var D={value:f,getSnapshot:c};return j.queue=D,Xw(Lw.bind(null,p,D,i),[i]),p.flags|=2048,Ql(9,{destroy:void 0},Fw.bind(null,p,D,f,c),null),f},useId:function(){var i=da(),c=zr.identifierPrefix;if(hr){var f=Dn,p=Rn;f=(p&~(1<<32-Le(p)-1)).toString(32)+f,c="_"+c+"R_"+f,f=Hf++,0<f&&(c+="H"+f.toString(32)),c+="_"}else f=iA++,c="_"+c+"r_"+f.toString(32)+"_";return i.memoizedState=c},useHostTransitionStatus:Dp,useFormState:Hw,useActionState:Hw,useOptimistic:function(i){var c=da();c.memoizedState=c.baseState=i;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=f,c=Op.bind(null,Jt,!0,f),f.dispatch=c,[i,c]},useMemoCache:Np,useCacheRefresh:function(){return da().memoizedState=fA.bind(null,Jt)},useEffectEvent:function(i){var c=da(),f={impl:i};return c.memoizedState=f,function(){if((Nr&2)!==0)throw Error(s(440));return f.impl.apply(void 0,arguments)}}},Fp={readContext:Ps,use:Gf,useCallback:t_,useContext:Ps,useEffect:Tp,useImperativeHandle:e_,useInsertionEffect:Jw,useLayoutEffect:Zw,useMemo:r_,useReducer:Vf,useRef:Kw,useState:function(){return Vf(ai)},useDebugValue:Ap,useDeferredValue:function(i,c){var f=ms();return s_(f,Fr.memoizedState,i,c)},useTransition:function(){var i=Vf(ai)[0],c=ms().memoizedState;return[typeof i=="boolean"?i:Au(i),c]},useSyncExternalStore:Dw,useId:o_,useHostTransitionStatus:Dp,useFormState:Ww,useActionState:Ww,useOptimistic:function(i,c){var f=ms();return Bw(f,Fr,i,c)},useMemoCache:Np,useCacheRefresh:l_};Fp.useEffectEvent=Yw;var h_={readContext:Ps,use:Gf,useCallback:t_,useContext:Ps,useEffect:Tp,useImperativeHandle:e_,useInsertionEffect:Jw,useLayoutEffect:Zw,useMemo:r_,useReducer:Sp,useRef:Kw,useState:function(){return Sp(ai)},useDebugValue:Ap,useDeferredValue:function(i,c){var f=ms();return Fr===null?Cp(f,i,c):s_(f,Fr.memoizedState,i,c)},useTransition:function(){var i=Sp(ai)[0],c=ms().memoizedState;return[typeof i=="boolean"?i:Au(i),c]},useSyncExternalStore:Dw,useId:o_,useHostTransitionStatus:Dp,useFormState:Vw,useActionState:Vw,useOptimistic:function(i,c){var f=ms();return Fr!==null?Bw(f,Fr,i,c):(f.baseState=i,[i,f.queue.dispatch])},useMemoCache:Np,useCacheRefresh:l_};h_.useEffectEvent=Yw;function Lp(i,c,f,p){c=i.memoizedState,f=f(p,c),f=f==null?c:x({},c,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var Ip={enqueueSetState:function(i,c,f){i=i._reactInternals;var p=La(),j=$i(p);j.payload=c,f!=null&&(j.callback=f),c=qi(i,j,p),c!==null&&(_a(c,i,p),Su(c,i,p))},enqueueReplaceState:function(i,c,f){i=i._reactInternals;var p=La(),j=$i(p);j.tag=1,j.payload=c,f!=null&&(j.callback=f),c=qi(i,j,p),c!==null&&(_a(c,i,p),Su(c,i,p))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var f=La(),p=$i(f);p.tag=2,c!=null&&(p.callback=c),c=qi(i,p,f),c!==null&&(_a(c,i,f),Su(c,i,f))}};function m_(i,c,f,p,j,D,ee){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,D,ee):c.prototype&&c.prototype.isPureReactComponent?!gu(f,p)||!gu(j,D):!0}function p_(i,c,f,p){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,p),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,p),c.state!==i&&Ip.enqueueReplaceState(c,c.state,null)}function Po(i,c){var f=c;if("ref"in c){f={};for(var p in c)p!=="ref"&&(f[p]=c[p])}if(i=i.defaultProps){f===c&&(f=x({},f));for(var j in i)f[j]===void 0&&(f[j]=i[j])}return f}function x_(i){Tf(i)}function g_(i){console.error(i)}function y_(i){Tf(i)}function Jf(i,c){try{var f=i.onUncaughtError;f(c.value,{componentStack:c.stack})}catch(p){setTimeout(function(){throw p})}}function v_(i,c,f){try{var p=i.onCaughtError;p(f.value,{componentStack:f.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(j){setTimeout(function(){throw j})}}function Mp(i,c,f){return f=$i(f),f.tag=3,f.payload={element:null},f.callback=function(){Jf(i,c)},f}function b_(i){return i=$i(i),i.tag=3,i}function w_(i,c,f,p){var j=f.type.getDerivedStateFromError;if(typeof j=="function"){var D=p.value;i.payload=function(){return j(D)},i.callback=function(){v_(c,f,p)}}var ee=f.stateNode;ee!==null&&typeof ee.componentDidCatch=="function"&&(i.callback=function(){v_(c,f,p),typeof j!="function"&&(Xi===null?Xi=new Set([this]):Xi.add(this));var ge=p.stack;this.componentDidCatch(p.value,{componentStack:ge!==null?ge:""})})}function mA(i,c,f,p,j){if(f.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(c=f.alternate,c!==null&&Wl(c,f,j,!0),f=Ra.current,f!==null){switch(f.tag){case 31:case 13:return tn===null?ch():f.alternate===null&&ss===0&&(ss=3),f.flags&=-257,f.flags|=65536,f.lanes=j,p===Bf?f.flags|=16384:(c=f.updateQueue,c===null?f.updateQueue=new Set([p]):c.add(p),lx(i,p,j)),!1;case 22:return f.flags|=65536,p===Bf?f.flags|=16384:(c=f.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([p])},f.updateQueue=c):(f=c.retryQueue,f===null?c.retryQueue=new Set([p]):f.add(p)),lx(i,p,j)),!1}throw Error(s(435,f.tag))}return lx(i,p,j),ch(),!1}if(hr)return c=Ra.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=j,p!==rp&&(i=Error(s(422),{cause:p}),bu(Ja(i,f)))):(p!==rp&&(c=Error(s(423),{cause:p}),bu(Ja(c,f))),i=i.current.alternate,i.flags|=65536,j&=-j,i.lanes|=j,p=Ja(p,f),j=Mp(i.stateNode,p,j),hp(i,j),ss!==4&&(ss=2)),!1;var D=Error(s(520),{cause:p});if(D=Ja(D,f),Pu===null?Pu=[D]:Pu.push(D),ss!==4&&(ss=2),c===null)return!0;p=Ja(p,f),f=c;do{switch(f.tag){case 3:return f.flags|=65536,i=j&-j,f.lanes|=i,i=Mp(f.stateNode,p,i),hp(f,i),!1;case 1:if(c=f.type,D=f.stateNode,(f.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(Xi===null||!Xi.has(D))))return f.flags|=65536,j&=-j,f.lanes|=j,j=b_(j),w_(j,i,f,p),hp(f,j),!1}f=f.return}while(f!==null);return!1}var Bp=Error(s(461)),ws=!1;function Us(i,c,f,p){c.child=i===null?Sw(c,null,f,p):Mo(c,i.child,f,p)}function __(i,c,f,p,j){f=f.render;var D=c.ref;if("ref"in p){var ee={};for(var ge in p)ge!=="ref"&&(ee[ge]=p[ge])}else ee=p;return Oo(c),p=vp(i,c,f,ee,D,j),ge=bp(),i!==null&&!ws?(wp(i,c,j),ni(i,c,j)):(hr&&ge&&ep(c),c.flags|=1,Us(i,c,p,j),c.child)}function N_(i,c,f,p,j){if(i===null){var D=f.type;return typeof D=="function"&&!Jm(D)&&D.defaultProps===void 0&&f.compare===null?(c.tag=15,c.type=D,k_(i,c,D,p,j)):(i=Df(f.type,null,p,c,c.mode,j),i.ref=c.ref,i.return=c,c.child=i)}if(D=i.child,!Gp(i,j)){var ee=D.memoizedProps;if(f=f.compare,f=f!==null?f:gu,f(ee,p)&&i.ref===c.ref)return ni(i,c,j)}return c.flags|=1,i=Qn(D,p),i.ref=c.ref,i.return=c,c.child=i}function k_(i,c,f,p,j){if(i!==null){var D=i.memoizedProps;if(gu(D,p)&&i.ref===c.ref)if(ws=!1,c.pendingProps=p=D,Gp(i,j))(i.flags&131072)!==0&&(ws=!0);else return c.lanes=i.lanes,ni(i,c,j)}return Pp(i,c,f,p,j)}function S_(i,c,f,p){var j=p.children,D=i!==null?i.memoizedState:null;if(i===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((c.flags&128)!==0){if(D=D!==null?D.baseLanes|f:f,i!==null){for(p=c.child=i.child,j=0;p!==null;)j=j|p.lanes|p.childLanes,p=p.sibling;p=j&~D}else p=0,c.child=null;return E_(i,c,D,f,p)}if((f&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},i!==null&&If(c,D!==null?D.cachePool:null),D!==null?Tw(c,D):pp(),Aw(c);else return p=c.lanes=536870912,E_(i,c,D!==null?D.baseLanes|f:f,f,p)}else D!==null?(If(c,D.cachePool),Tw(c,D),Wi(),c.memoizedState=null):(i!==null&&If(c,null),pp(),Wi());return Us(i,c,j,f),c.child}function Du(i,c){return i!==null&&i.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function E_(i,c,f,p,j){var D=cp();return D=D===null?null:{parent:vs._currentValue,pool:D},c.memoizedState={baseLanes:f,cachePool:D},i!==null&&If(c,null),pp(),Aw(c),i!==null&&Wl(i,c,p,!0),c.childLanes=j,null}function Zf(i,c){return c=eh({mode:c.mode,children:c.children},i.mode),c.ref=i.ref,i.child=c,c.return=i,c}function j_(i,c,f){return Mo(c,i.child,null,f),i=Zf(c,c.pendingProps),i.flags|=2,Da(c),c.memoizedState=null,i}function pA(i,c,f){var p=c.pendingProps,j=(c.flags&128)!==0;if(c.flags&=-129,i===null){if(hr){if(p.mode==="hidden")return i=Zf(c,p),c.lanes=536870912,Du(null,i);if(gp(c),(i=Hr)?(i=P2(i,en),i=i!==null&&i.data==="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:Mi!==null?{id:Rn,overflow:Dn}:null,retryLane:536870912,hydrationErrors:null},f=uw(i),f.return=c,c.child=f,Bs=c,Hr=null)):i=null,i===null)throw Pi(c);return c.lanes=536870912,null}return Zf(c,p)}var D=i.memoizedState;if(D!==null){var ee=D.dehydrated;if(gp(c),j)if(c.flags&256)c.flags&=-257,c=j_(i,c,f);else if(c.memoizedState!==null)c.child=i.child,c.flags|=128,c=null;else throw Error(s(558));else if(ws||Wl(i,c,f,!1),j=(f&i.childLanes)!==0,ws||j){if(p=zr,p!==null&&(ee=fr(p,f),ee!==0&&ee!==D.retryLane))throw D.retryLane=ee,Ao(i,ee),_a(p,i,ee),Bp;ch(),c=j_(i,c,f)}else i=D.treeContext,Hr=rn(ee.nextSibling),Bs=c,hr=!0,Bi=null,en=!1,i!==null&&hw(c,i),c=Zf(c,p),c.flags|=4096;return c}return i=Qn(i.child,{mode:p.mode,children:p.children}),i.ref=c.ref,c.child=i,i.return=c,i}function Qf(i,c){var f=c.ref;if(f===null)i!==null&&i.ref!==null&&(c.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(s(284));(i===null||i.ref!==f)&&(c.flags|=4194816)}}function Pp(i,c,f,p,j){return Oo(c),f=vp(i,c,f,p,void 0,j),p=bp(),i!==null&&!ws?(wp(i,c,j),ni(i,c,j)):(hr&&p&&ep(c),c.flags|=1,Us(i,c,f,j),c.child)}function T_(i,c,f,p,j,D){return Oo(c),c.updateQueue=null,f=Rw(c,p,f,j),Cw(i),p=bp(),i!==null&&!ws?(wp(i,c,D),ni(i,c,D)):(hr&&p&&ep(c),c.flags|=1,Us(i,c,f,D),c.child)}function A_(i,c,f,p,j){if(Oo(c),c.stateNode===null){var D=zl,ee=f.contextType;typeof ee=="object"&&ee!==null&&(D=Ps(ee)),D=new f(p,D),c.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=Ip,c.stateNode=D,D._reactInternals=c,D=c.stateNode,D.props=p,D.state=c.memoizedState,D.refs={},dp(c),ee=f.contextType,D.context=typeof ee=="object"&&ee!==null?Ps(ee):zl,D.state=c.memoizedState,ee=f.getDerivedStateFromProps,typeof ee=="function"&&(Lp(c,f,ee,p),D.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(ee=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),ee!==D.state&&Ip.enqueueReplaceState(D,D.state,null),ju(c,p,D,j),Eu(),D.state=c.memoizedState),typeof D.componentDidMount=="function"&&(c.flags|=4194308),p=!0}else if(i===null){D=c.stateNode;var ge=c.memoizedProps,Fe=Po(f,ge);D.props=Fe;var Ve=D.context,it=f.contextType;ee=zl,typeof it=="object"&&it!==null&&(ee=Ps(it));var ut=f.getDerivedStateFromProps;it=typeof ut=="function"||typeof D.getSnapshotBeforeUpdate=="function",ge=c.pendingProps!==ge,it||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(ge||Ve!==ee)&&p_(c,D,p,ee),zi=!1;var Xe=c.memoizedState;D.state=Xe,ju(c,p,D,j),Eu(),Ve=c.memoizedState,ge||Xe!==Ve||zi?(typeof ut=="function"&&(Lp(c,f,ut,p),Ve=c.memoizedState),(Fe=zi||m_(c,f,Fe,p,Xe,Ve,ee))?(it||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(c.flags|=4194308)):(typeof D.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=p,c.memoizedState=Ve),D.props=p,D.state=Ve,D.context=ee,p=Fe):(typeof D.componentDidMount=="function"&&(c.flags|=4194308),p=!1)}else{D=c.stateNode,fp(i,c),ee=c.memoizedProps,it=Po(f,ee),D.props=it,ut=c.pendingProps,Xe=D.context,Ve=f.contextType,Fe=zl,typeof Ve=="object"&&Ve!==null&&(Fe=Ps(Ve)),ge=f.getDerivedStateFromProps,(Ve=typeof ge=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(ee!==ut||Xe!==Fe)&&p_(c,D,p,Fe),zi=!1,Xe=c.memoizedState,D.state=Xe,ju(c,p,D,j),Eu();var Qe=c.memoizedState;ee!==ut||Xe!==Qe||zi||i!==null&&i.dependencies!==null&&Ff(i.dependencies)?(typeof ge=="function"&&(Lp(c,f,ge,p),Qe=c.memoizedState),(it=zi||m_(c,f,it,p,Xe,Qe,Fe)||i!==null&&i.dependencies!==null&&Ff(i.dependencies))?(Ve||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(p,Qe,Fe),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(p,Qe,Fe)),typeof D.componentDidUpdate=="function"&&(c.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof D.componentDidUpdate!="function"||ee===i.memoizedProps&&Xe===i.memoizedState||(c.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||ee===i.memoizedProps&&Xe===i.memoizedState||(c.flags|=1024),c.memoizedProps=p,c.memoizedState=Qe),D.props=p,D.state=Qe,D.context=Fe,p=it):(typeof D.componentDidUpdate!="function"||ee===i.memoizedProps&&Xe===i.memoizedState||(c.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||ee===i.memoizedProps&&Xe===i.memoizedState||(c.flags|=1024),p=!1)}return D=p,Qf(i,c),p=(c.flags&128)!==0,D||p?(D=c.stateNode,f=p&&typeof f.getDerivedStateFromError!="function"?null:D.render(),c.flags|=1,i!==null&&p?(c.child=Mo(c,i.child,null,j),c.child=Mo(c,null,f,j)):Us(i,c,f,j),c.memoizedState=D.state,i=c.child):i=ni(i,c,j),i}function C_(i,c,f,p){return Ro(),c.flags|=256,Us(i,c,f,p),c.child}var Up={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function zp(i){return{baseLanes:i,cachePool:vw()}}function $p(i,c,f){return i=i!==null?i.childLanes&~f:0,c&&(i|=Fa),i}function R_(i,c,f){var p=c.pendingProps,j=!1,D=(c.flags&128)!==0,ee;if((ee=D)||(ee=i!==null&&i.memoizedState===null?!1:(hs.current&2)!==0),ee&&(j=!0,c.flags&=-129),ee=(c.flags&32)!==0,c.flags&=-33,i===null){if(hr){if(j?Hi(c):Wi(),(i=Hr)?(i=P2(i,en),i=i!==null&&i.data!=="&"?i:null,i!==null&&(c.memoizedState={dehydrated:i,treeContext:Mi!==null?{id:Rn,overflow:Dn}:null,retryLane:536870912,hydrationErrors:null},f=uw(i),f.return=c,c.child=f,Bs=c,Hr=null)):i=null,i===null)throw Pi(c);return kx(i)?c.lanes=32:c.lanes=536870912,null}var ge=p.children;return p=p.fallback,j?(Wi(),j=c.mode,ge=eh({mode:"hidden",children:ge},j),p=Co(p,j,f,null),ge.return=c,p.return=c,ge.sibling=p,c.child=ge,p=c.child,p.memoizedState=zp(f),p.childLanes=$p(i,ee,f),c.memoizedState=Up,Du(null,p)):(Hi(c),qp(c,ge))}var Fe=i.memoizedState;if(Fe!==null&&(ge=Fe.dehydrated,ge!==null)){if(D)c.flags&256?(Hi(c),c.flags&=-257,c=Hp(i,c,f)):c.memoizedState!==null?(Wi(),c.child=i.child,c.flags|=128,c=null):(Wi(),ge=p.fallback,j=c.mode,p=eh({mode:"visible",children:p.children},j),ge=Co(ge,j,f,null),ge.flags|=2,p.return=c,ge.return=c,p.sibling=ge,c.child=p,Mo(c,i.child,null,f),p=c.child,p.memoizedState=zp(f),p.childLanes=$p(i,ee,f),c.memoizedState=Up,c=Du(null,p));else if(Hi(c),kx(ge)){if(ee=ge.nextSibling&&ge.nextSibling.dataset,ee)var Ve=ee.dgst;ee=Ve,p=Error(s(419)),p.stack="",p.digest=ee,bu({value:p,source:null,stack:null}),c=Hp(i,c,f)}else if(ws||Wl(i,c,f,!1),ee=(f&i.childLanes)!==0,ws||ee){if(ee=zr,ee!==null&&(p=fr(ee,f),p!==0&&p!==Fe.retryLane))throw Fe.retryLane=p,Ao(i,p),_a(ee,i,p),Bp;Nx(ge)||ch(),c=Hp(i,c,f)}else Nx(ge)?(c.flags|=192,c.child=i.child,c=null):(i=Fe.treeContext,Hr=rn(ge.nextSibling),Bs=c,hr=!0,Bi=null,en=!1,i!==null&&hw(c,i),c=qp(c,p.children),c.flags|=4096);return c}return j?(Wi(),ge=p.fallback,j=c.mode,Fe=i.child,Ve=Fe.sibling,p=Qn(Fe,{mode:"hidden",children:p.children}),p.subtreeFlags=Fe.subtreeFlags&65011712,Ve!==null?ge=Qn(Ve,ge):(ge=Co(ge,j,f,null),ge.flags|=2),ge.return=c,p.return=c,p.sibling=ge,c.child=p,Du(null,p),p=c.child,ge=i.child.memoizedState,ge===null?ge=zp(f):(j=ge.cachePool,j!==null?(Fe=vs._currentValue,j=j.parent!==Fe?{parent:Fe,pool:Fe}:j):j=vw(),ge={baseLanes:ge.baseLanes|f,cachePool:j}),p.memoizedState=ge,p.childLanes=$p(i,ee,f),c.memoizedState=Up,Du(i.child,p)):(Hi(c),f=i.child,i=f.sibling,f=Qn(f,{mode:"visible",children:p.children}),f.return=c,f.sibling=null,i!==null&&(ee=c.deletions,ee===null?(c.deletions=[i],c.flags|=16):ee.push(i)),c.child=f,c.memoizedState=null,f)}function qp(i,c){return c=eh({mode:"visible",children:c},i.mode),c.return=i,i.child=c}function eh(i,c){return i=Ca(22,i,null,c),i.lanes=0,i}function Hp(i,c,f){return Mo(c,i.child,null,f),i=qp(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function D_(i,c,f){i.lanes|=c;var p=i.alternate;p!==null&&(p.lanes|=c),np(i.return,c,f)}function Wp(i,c,f,p,j,D){var ee=i.memoizedState;ee===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:p,tail:f,tailMode:j,treeForkCount:D}:(ee.isBackwards=c,ee.rendering=null,ee.renderingStartTime=0,ee.last=p,ee.tail=f,ee.tailMode=j,ee.treeForkCount=D)}function O_(i,c,f){var p=c.pendingProps,j=p.revealOrder,D=p.tail;p=p.children;var ee=hs.current,ge=(ee&2)!==0;if(ge?(ee=ee&1|2,c.flags|=128):ee&=1,J(hs,ee),Us(i,c,p,f),p=hr?vu:0,!ge&&i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&D_(i,f,c);else if(i.tag===19)D_(i,f,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(j){case"forwards":for(f=c.child,j=null;f!==null;)i=f.alternate,i!==null&&$f(i)===null&&(j=f),f=f.sibling;f=j,f===null?(j=c.child,c.child=null):(j=f.sibling,f.sibling=null),Wp(c,!1,j,f,D,p);break;case"backwards":case"unstable_legacy-backwards":for(f=null,j=c.child,c.child=null;j!==null;){if(i=j.alternate,i!==null&&$f(i)===null){c.child=j;break}i=j.sibling,j.sibling=f,f=j,j=i}Wp(c,!0,f,null,D,p);break;case"together":Wp(c,!1,null,null,void 0,p);break;default:c.memoizedState=null}return c.child}function ni(i,c,f){if(i!==null&&(c.dependencies=i.dependencies),Ki|=c.lanes,(f&c.childLanes)===0)if(i!==null){if(Wl(i,c,f,!1),(f&c.childLanes)===0)return null}else return null;if(i!==null&&c.child!==i.child)throw Error(s(153));if(c.child!==null){for(i=c.child,f=Qn(i,i.pendingProps),c.child=f,f.return=c;i.sibling!==null;)i=i.sibling,f=f.sibling=Qn(i,i.pendingProps),f.return=c;f.sibling=null}return c.child}function Gp(i,c){return(i.lanes&c)!==0?!0:(i=i.dependencies,!!(i!==null&&Ff(i)))}function xA(i,c,f){switch(c.tag){case 3:U(c,c.stateNode.containerInfo),Ui(c,vs,i.memoizedState.cache),Ro();break;case 27:case 5:ne(c);break;case 4:U(c,c.stateNode.containerInfo);break;case 10:Ui(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,gp(c),null;break;case 13:var p=c.memoizedState;if(p!==null)return p.dehydrated!==null?(Hi(c),c.flags|=128,null):(f&c.child.childLanes)!==0?R_(i,c,f):(Hi(c),i=ni(i,c,f),i!==null?i.sibling:null);Hi(c);break;case 19:var j=(i.flags&128)!==0;if(p=(f&c.childLanes)!==0,p||(Wl(i,c,f,!1),p=(f&c.childLanes)!==0),j){if(p)return O_(i,c,f);c.flags|=128}if(j=c.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),J(hs,hs.current),p)break;return null;case 22:return c.lanes=0,S_(i,c,f,c.pendingProps);case 24:Ui(c,vs,i.memoizedState.cache)}return ni(i,c,f)}function F_(i,c,f){if(i!==null)if(i.memoizedProps!==c.pendingProps)ws=!0;else{if(!Gp(i,f)&&(c.flags&128)===0)return ws=!1,xA(i,c,f);ws=(i.flags&131072)!==0}else ws=!1,hr&&(c.flags&1048576)!==0&&fw(c,vu,c.index);switch(c.lanes=0,c.tag){case 16:e:{var p=c.pendingProps;if(i=Lo(c.elementType),c.type=i,typeof i=="function")Jm(i)?(p=Po(i,p),c.tag=1,c=A_(null,c,i,p,f)):(c.tag=0,c=Pp(null,c,i,p,f));else{if(i!=null){var j=i.$$typeof;if(j===E){c.tag=11,c=__(null,c,i,p,f);break e}else if(j===O){c.tag=14,c=N_(null,c,i,p,f);break e}}throw c=I(i)||i,Error(s(306,c,""))}}return c;case 0:return Pp(i,c,c.type,c.pendingProps,f);case 1:return p=c.type,j=Po(p,c.pendingProps),A_(i,c,p,j,f);case 3:e:{if(U(c,c.stateNode.containerInfo),i===null)throw Error(s(387));p=c.pendingProps;var D=c.memoizedState;j=D.element,fp(i,c),ju(c,p,null,f);var ee=c.memoizedState;if(p=ee.cache,Ui(c,vs,p),p!==D.cache&&ip(c,[vs],f,!0),Eu(),p=ee.element,D.isDehydrated)if(D={element:p,isDehydrated:!1,cache:ee.cache},c.updateQueue.baseState=D,c.memoizedState=D,c.flags&256){c=C_(i,c,p,f);break e}else if(p!==j){j=Ja(Error(s(424)),c),bu(j),c=C_(i,c,p,f);break e}else for(i=c.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,Hr=rn(i.firstChild),Bs=c,hr=!0,Bi=null,en=!0,f=Sw(c,null,p,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Ro(),p===j){c=ni(i,c,f);break e}Us(i,c,p,f)}c=c.child}return c;case 26:return Qf(i,c),i===null?(f=W2(c.type,null,c.pendingProps,null))?c.memoizedState=f:hr||(f=c.type,i=c.pendingProps,p=xh(se.current).createElement(f),p[be]=c,p[Se]=i,zs(p,f,i),Ie(p),c.stateNode=p):c.memoizedState=W2(c.type,i.memoizedProps,c.pendingProps,i.memoizedState),null;case 27:return ne(c),i===null&&hr&&(p=c.stateNode=$2(c.type,c.pendingProps,se.current),Bs=c,en=!0,j=Hr,Qi(c.type)?(Sx=j,Hr=rn(p.firstChild)):Hr=j),Us(i,c,c.pendingProps.children,f),Qf(i,c),i===null&&(c.flags|=4194304),c.child;case 5:return i===null&&hr&&((j=p=Hr)&&(p=GA(p,c.type,c.pendingProps,en),p!==null?(c.stateNode=p,Bs=c,Hr=rn(p.firstChild),en=!1,j=!0):j=!1),j||Pi(c)),ne(c),j=c.type,D=c.pendingProps,ee=i!==null?i.memoizedProps:null,p=D.children,bx(j,D)?p=null:ee!==null&&bx(j,ee)&&(c.flags|=32),c.memoizedState!==null&&(j=vp(i,c,oA,null,null,f),Vu._currentValue=j),Qf(i,c),Us(i,c,p,f),c.child;case 6:return i===null&&hr&&((i=f=Hr)&&(f=VA(f,c.pendingProps,en),f!==null?(c.stateNode=f,Bs=c,Hr=null,i=!0):i=!1),i||Pi(c)),null;case 13:return R_(i,c,f);case 4:return U(c,c.stateNode.containerInfo),p=c.pendingProps,i===null?c.child=Mo(c,null,p,f):Us(i,c,p,f),c.child;case 11:return __(i,c,c.type,c.pendingProps,f);case 7:return Us(i,c,c.pendingProps,f),c.child;case 8:return Us(i,c,c.pendingProps.children,f),c.child;case 12:return Us(i,c,c.pendingProps.children,f),c.child;case 10:return p=c.pendingProps,Ui(c,c.type,p.value),Us(i,c,p.children,f),c.child;case 9:return j=c.type._context,p=c.pendingProps.children,Oo(c),j=Ps(j),p=p(j),c.flags|=1,Us(i,c,p,f),c.child;case 14:return N_(i,c,c.type,c.pendingProps,f);case 15:return k_(i,c,c.type,c.pendingProps,f);case 19:return O_(i,c,f);case 31:return pA(i,c,f);case 22:return S_(i,c,f,c.pendingProps);case 24:return Oo(c),p=Ps(vs),i===null?(j=cp(),j===null&&(j=zr,D=op(),j.pooledCache=D,D.refCount++,D!==null&&(j.pooledCacheLanes|=f),j=D),c.memoizedState={parent:p,cache:j},dp(c),Ui(c,vs,j)):((i.lanes&f)!==0&&(fp(i,c),ju(c,null,null,f),Eu()),j=i.memoizedState,D=c.memoizedState,j.parent!==p?(j={parent:p,cache:p},c.memoizedState=j,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=j),Ui(c,vs,p)):(p=D.cache,Ui(c,vs,p),p!==j.cache&&ip(c,[vs],f,!0))),Us(i,c,c.pendingProps.children,f),c.child;case 29:throw c.pendingProps}throw Error(s(156,c.tag))}function ii(i){i.flags|=4}function Vp(i,c,f,p,j){if((c=(i.mode&32)!==0)&&(c=!1),c){if(i.flags|=16777216,(j&335544128)===j)if(i.stateNode.complete)i.flags|=8192;else if(o2())i.flags|=8192;else throw Io=Bf,up}else i.flags&=-16777217}function L_(i,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Y2(c))if(o2())i.flags|=8192;else throw Io=Bf,up}function th(i,c){c!==null&&(i.flags|=4),i.flags&16384&&(c=i.tag!==22?pt():536870912,i.lanes|=c,sc|=c)}function Ou(i,c){if(!hr)switch(i.tailMode){case"hidden":c=i.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Wr(i){var c=i.alternate!==null&&i.alternate.child===i.child,f=0,p=0;if(c)for(var j=i.child;j!==null;)f|=j.lanes|j.childLanes,p|=j.subtreeFlags&65011712,p|=j.flags&65011712,j.return=i,j=j.sibling;else for(j=i.child;j!==null;)f|=j.lanes|j.childLanes,p|=j.subtreeFlags,p|=j.flags,j.return=i,j=j.sibling;return i.subtreeFlags|=p,i.childLanes=f,c}function gA(i,c,f){var p=c.pendingProps;switch(tp(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wr(c),null;case 1:return Wr(c),null;case 3:return f=c.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),ri(vs),ce(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(Hl(c)?ii(c):i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,sp())),Wr(c),null;case 26:var j=c.type,D=c.memoizedState;return i===null?(ii(c),D!==null?(Wr(c),L_(c,D)):(Wr(c),Vp(c,j,null,p,f))):D?D!==i.memoizedState?(ii(c),Wr(c),L_(c,D)):(Wr(c),c.flags&=-16777217):(i=i.memoizedProps,i!==p&&ii(c),Wr(c),Vp(c,j,i,p,f)),null;case 27:if(ie(c),f=se.current,j=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==p&&ii(c);else{if(!p){if(c.stateNode===null)throw Error(s(166));return Wr(c),null}i=V.current,Hl(c)?mw(c):(i=$2(j,p,f),c.stateNode=i,ii(c))}return Wr(c),null;case 5:if(ie(c),j=c.type,i!==null&&c.stateNode!=null)i.memoizedProps!==p&&ii(c);else{if(!p){if(c.stateNode===null)throw Error(s(166));return Wr(c),null}if(D=V.current,Hl(c))mw(c);else{var ee=xh(se.current);switch(D){case 1:D=ee.createElementNS("http://www.w3.org/2000/svg",j);break;case 2:D=ee.createElementNS("http://www.w3.org/1998/Math/MathML",j);break;default:switch(j){case"svg":D=ee.createElementNS("http://www.w3.org/2000/svg",j);break;case"math":D=ee.createElementNS("http://www.w3.org/1998/Math/MathML",j);break;case"script":D=ee.createElement("div"),D.innerHTML="<script><\/script>",D=D.removeChild(D.firstChild);break;case"select":D=typeof p.is=="string"?ee.createElement("select",{is:p.is}):ee.createElement("select"),p.multiple?D.multiple=!0:p.size&&(D.size=p.size);break;default:D=typeof p.is=="string"?ee.createElement(j,{is:p.is}):ee.createElement(j)}}D[be]=c,D[Se]=p;e:for(ee=c.child;ee!==null;){if(ee.tag===5||ee.tag===6)D.appendChild(ee.stateNode);else if(ee.tag!==4&&ee.tag!==27&&ee.child!==null){ee.child.return=ee,ee=ee.child;continue}if(ee===c)break e;for(;ee.sibling===null;){if(ee.return===null||ee.return===c)break e;ee=ee.return}ee.sibling.return=ee.return,ee=ee.sibling}c.stateNode=D;e:switch(zs(D,j,p),j){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&ii(c)}}return Wr(c),Vp(c,c.type,i===null?null:i.memoizedProps,c.pendingProps,f),null;case 6:if(i&&c.stateNode!=null)i.memoizedProps!==p&&ii(c);else{if(typeof p!="string"&&c.stateNode===null)throw Error(s(166));if(i=se.current,Hl(c)){if(i=c.stateNode,f=c.memoizedProps,p=null,j=Bs,j!==null)switch(j.tag){case 27:case 5:p=j.memoizedProps}i[be]=c,i=!!(i.nodeValue===f||p!==null&&p.suppressHydrationWarning===!0||R2(i.nodeValue,f)),i||Pi(c,!0)}else i=xh(i).createTextNode(p),i[be]=c,c.stateNode=i}return Wr(c),null;case 31:if(f=c.memoizedState,i===null||i.memoizedState!==null){if(p=Hl(c),f!==null){if(i===null){if(!p)throw Error(s(318));if(i=c.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(557));i[be]=c}else Ro(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Wr(c),i=!1}else f=sp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=f),i=!0;if(!i)return c.flags&256?(Da(c),c):(Da(c),null);if((c.flags&128)!==0)throw Error(s(558))}return Wr(c),null;case 13:if(p=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(j=Hl(c),p!==null&&p.dehydrated!==null){if(i===null){if(!j)throw Error(s(318));if(j=c.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(s(317));j[be]=c}else Ro(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Wr(c),j=!1}else j=sp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=j),j=!0;if(!j)return c.flags&256?(Da(c),c):(Da(c),null)}return Da(c),(c.flags&128)!==0?(c.lanes=f,c):(f=p!==null,i=i!==null&&i.memoizedState!==null,f&&(p=c.child,j=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(j=p.alternate.memoizedState.cachePool.pool),D=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(D=p.memoizedState.cachePool.pool),D!==j&&(p.flags|=2048)),f!==i&&f&&(c.child.flags|=8192),th(c,c.updateQueue),Wr(c),null);case 4:return ce(),i===null&&px(c.stateNode.containerInfo),Wr(c),null;case 10:return ri(c.type),Wr(c),null;case 19:if(M(hs),p=c.memoizedState,p===null)return Wr(c),null;if(j=(c.flags&128)!==0,D=p.rendering,D===null)if(j)Ou(p,!1);else{if(ss!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(D=$f(i),D!==null){for(c.flags|=128,Ou(p,!1),i=D.updateQueue,c.updateQueue=i,th(c,i),c.subtreeFlags=0,i=f,f=c.child;f!==null;)cw(f,i),f=f.sibling;return J(hs,hs.current&1|2),hr&&ei(c,p.treeForkCount),c.child}i=i.sibling}p.tail!==null&&Me()>ih&&(c.flags|=128,j=!0,Ou(p,!1),c.lanes=4194304)}else{if(!j)if(i=$f(D),i!==null){if(c.flags|=128,j=!0,i=i.updateQueue,c.updateQueue=i,th(c,i),Ou(p,!0),p.tail===null&&p.tailMode==="hidden"&&!D.alternate&&!hr)return Wr(c),null}else 2*Me()-p.renderingStartTime>ih&&f!==536870912&&(c.flags|=128,j=!0,Ou(p,!1),c.lanes=4194304);p.isBackwards?(D.sibling=c.child,c.child=D):(i=p.last,i!==null?i.sibling=D:c.child=D,p.last=D)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=Me(),i.sibling=null,f=hs.current,J(hs,j?f&1|2:f&1),hr&&ei(c,p.treeForkCount),i):(Wr(c),null);case 22:case 23:return Da(c),xp(),p=c.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(c.flags|=8192):p&&(c.flags|=8192),p?(f&536870912)!==0&&(c.flags&128)===0&&(Wr(c),c.subtreeFlags&6&&(c.flags|=8192)):Wr(c),f=c.updateQueue,f!==null&&th(c,f.retryQueue),f=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==f&&(c.flags|=2048),i!==null&&M(Fo),null;case 24:return f=null,i!==null&&(f=i.memoizedState.cache),c.memoizedState.cache!==f&&(c.flags|=2048),ri(vs),Wr(c),null;case 25:return null;case 30:return null}throw Error(s(156,c.tag))}function yA(i,c){switch(tp(c),c.tag){case 1:return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return ri(vs),ce(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 26:case 27:case 5:return ie(c),null;case 31:if(c.memoizedState!==null){if(Da(c),c.alternate===null)throw Error(s(340));Ro()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 13:if(Da(c),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(s(340));Ro()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return M(hs),null;case 4:return ce(),null;case 10:return ri(c.type),null;case 22:case 23:return Da(c),xp(),i!==null&&M(Fo),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 24:return ri(vs),null;case 25:return null;default:return null}}function I_(i,c){switch(tp(c),c.tag){case 3:ri(vs),ce();break;case 26:case 27:case 5:ie(c);break;case 4:ce();break;case 31:c.memoizedState!==null&&Da(c);break;case 13:Da(c);break;case 19:M(hs);break;case 10:ri(c.type);break;case 22:case 23:Da(c),xp(),i!==null&&M(Fo);break;case 24:ri(vs)}}function Fu(i,c){try{var f=c.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var j=p.next;f=j;do{if((f.tag&i)===i){p=void 0;var D=f.create,ee=f.inst;p=D(),ee.destroy=p}f=f.next}while(f!==j)}}catch(ge){Tr(c,c.return,ge)}}function Gi(i,c,f){try{var p=c.updateQueue,j=p!==null?p.lastEffect:null;if(j!==null){var D=j.next;p=D;do{if((p.tag&i)===i){var ee=p.inst,ge=ee.destroy;if(ge!==void 0){ee.destroy=void 0,j=c;var Fe=f,Ve=ge;try{Ve()}catch(it){Tr(j,Fe,it)}}}p=p.next}while(p!==D)}}catch(it){Tr(c,c.return,it)}}function M_(i){var c=i.updateQueue;if(c!==null){var f=i.stateNode;try{jw(c,f)}catch(p){Tr(i,i.return,p)}}}function B_(i,c,f){f.props=Po(i.type,i.memoizedProps),f.state=i.memoizedState;try{f.componentWillUnmount()}catch(p){Tr(i,c,p)}}function Lu(i,c){try{var f=i.ref;if(f!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof f=="function"?i.refCleanup=f(p):f.current=p}}catch(j){Tr(i,c,j)}}function On(i,c){var f=i.ref,p=i.refCleanup;if(f!==null)if(typeof p=="function")try{p()}catch(j){Tr(i,c,j)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(j){Tr(i,c,j)}else f.current=null}function P_(i){var c=i.type,f=i.memoizedProps,p=i.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":f.autoFocus&&p.focus();break e;case"img":f.src?p.src=f.src:f.srcSet&&(p.srcset=f.srcSet)}}catch(j){Tr(i,i.return,j)}}function Kp(i,c,f){try{var p=i.stateNode;UA(p,i.type,f,c),p[Se]=c}catch(j){Tr(i,i.return,j)}}function U_(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Qi(i.type)||i.tag===4}function Xp(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||U_(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Qi(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Yp(i,c,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,c?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(i,c):(c=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,c.appendChild(i),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=Jn));else if(p!==4&&(p===27&&Qi(i.type)&&(f=i.stateNode,c=null),i=i.child,i!==null))for(Yp(i,c,f),i=i.sibling;i!==null;)Yp(i,c,f),i=i.sibling}function rh(i,c,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,c?f.insertBefore(i,c):f.appendChild(i);else if(p!==4&&(p===27&&Qi(i.type)&&(f=i.stateNode),i=i.child,i!==null))for(rh(i,c,f),i=i.sibling;i!==null;)rh(i,c,f),i=i.sibling}function z_(i){var c=i.stateNode,f=i.memoizedProps;try{for(var p=i.type,j=c.attributes;j.length;)c.removeAttributeNode(j[0]);zs(c,p,f),c[be]=i,c[Se]=f}catch(D){Tr(i,i.return,D)}}var oi=!1,_s=!1,Jp=!1,$_=typeof WeakSet=="function"?WeakSet:Set,Ds=null;function vA(i,c){if(i=i.containerInfo,yx=Nh,i=ew(i),Hm(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else e:{f=(f=i.ownerDocument)&&f.defaultView||window;var p=f.getSelection&&f.getSelection();if(p&&p.rangeCount!==0){f=p.anchorNode;var j=p.anchorOffset,D=p.focusNode;p=p.focusOffset;try{f.nodeType,D.nodeType}catch{f=null;break e}var ee=0,ge=-1,Fe=-1,Ve=0,it=0,ut=i,Xe=null;t:for(;;){for(var Qe;ut!==f||j!==0&&ut.nodeType!==3||(ge=ee+j),ut!==D||p!==0&&ut.nodeType!==3||(Fe=ee+p),ut.nodeType===3&&(ee+=ut.nodeValue.length),(Qe=ut.firstChild)!==null;)Xe=ut,ut=Qe;for(;;){if(ut===i)break t;if(Xe===f&&++Ve===j&&(ge=ee),Xe===D&&++it===p&&(Fe=ee),(Qe=ut.nextSibling)!==null)break;ut=Xe,Xe=ut.parentNode}ut=Qe}f=ge===-1||Fe===-1?null:{start:ge,end:Fe}}else f=null}f=f||{start:0,end:0}}else f=null;for(vx={focusedElem:i,selectionRange:f},Nh=!1,Ds=c;Ds!==null;)if(c=Ds,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,Ds=i;else for(;Ds!==null;){switch(c=Ds,D=c.alternate,i=c.flags,c.tag){case 0:if((i&4)!==0&&(i=c.updateQueue,i=i!==null?i.events:null,i!==null))for(f=0;f<i.length;f++)j=i[f],j.ref.impl=j.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&D!==null){i=void 0,f=c,j=D.memoizedProps,D=D.memoizedState,p=f.stateNode;try{var Ot=Po(f.type,j);i=p.getSnapshotBeforeUpdate(Ot,D),p.__reactInternalSnapshotBeforeUpdate=i}catch($t){Tr(f,f.return,$t)}}break;case 3:if((i&1024)!==0){if(i=c.stateNode.containerInfo,f=i.nodeType,f===9)_x(i);else if(f===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":_x(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(s(163))}if(i=c.sibling,i!==null){i.return=c.return,Ds=i;break}Ds=c.return}}function q_(i,c,f){var p=f.flags;switch(f.tag){case 0:case 11:case 15:ci(i,f),p&4&&Fu(5,f);break;case 1:if(ci(i,f),p&4)if(i=f.stateNode,c===null)try{i.componentDidMount()}catch(ee){Tr(f,f.return,ee)}else{var j=Po(f.type,c.memoizedProps);c=c.memoizedState;try{i.componentDidUpdate(j,c,i.__reactInternalSnapshotBeforeUpdate)}catch(ee){Tr(f,f.return,ee)}}p&64&&M_(f),p&512&&Lu(f,f.return);break;case 3:if(ci(i,f),p&64&&(i=f.updateQueue,i!==null)){if(c=null,f.child!==null)switch(f.child.tag){case 27:case 5:c=f.child.stateNode;break;case 1:c=f.child.stateNode}try{jw(i,c)}catch(ee){Tr(f,f.return,ee)}}break;case 27:c===null&&p&4&&z_(f);case 26:case 5:ci(i,f),c===null&&p&4&&P_(f),p&512&&Lu(f,f.return);break;case 12:ci(i,f);break;case 31:ci(i,f),p&4&&G_(i,f);break;case 13:ci(i,f),p&4&&V_(i,f),p&64&&(i=f.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(f=TA.bind(null,f),KA(i,f))));break;case 22:if(p=f.memoizedState!==null||oi,!p){c=c!==null&&c.memoizedState!==null||_s,j=oi;var D=_s;oi=p,(_s=c)&&!D?ui(i,f,(f.subtreeFlags&8772)!==0):ci(i,f),oi=j,_s=D}break;case 30:break;default:ci(i,f)}}function H_(i){var c=i.alternate;c!==null&&(i.alternate=null,H_(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&ht(c)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Xr=null,ya=!1;function li(i,c,f){for(f=f.child;f!==null;)W_(i,c,f),f=f.sibling}function W_(i,c,f){if(At&&typeof At.onCommitFiberUnmount=="function")try{At.onCommitFiberUnmount(vt,f)}catch{}switch(f.tag){case 26:_s||On(f,c),li(i,c,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:_s||On(f,c);var p=Xr,j=ya;Qi(f.type)&&(Xr=f.stateNode,ya=!1),li(i,c,f),Hu(f.stateNode),Xr=p,ya=j;break;case 5:_s||On(f,c);case 6:if(p=Xr,j=ya,Xr=null,li(i,c,f),Xr=p,ya=j,Xr!==null)if(ya)try{(Xr.nodeType===9?Xr.body:Xr.nodeName==="HTML"?Xr.ownerDocument.body:Xr).removeChild(f.stateNode)}catch(D){Tr(f,c,D)}else try{Xr.removeChild(f.stateNode)}catch(D){Tr(f,c,D)}break;case 18:Xr!==null&&(ya?(i=Xr,M2(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,f.stateNode),dc(i)):M2(Xr,f.stateNode));break;case 4:p=Xr,j=ya,Xr=f.stateNode.containerInfo,ya=!0,li(i,c,f),Xr=p,ya=j;break;case 0:case 11:case 14:case 15:Gi(2,f,c),_s||Gi(4,f,c),li(i,c,f);break;case 1:_s||(On(f,c),p=f.stateNode,typeof p.componentWillUnmount=="function"&&B_(f,c,p)),li(i,c,f);break;case 21:li(i,c,f);break;case 22:_s=(p=_s)||f.memoizedState!==null,li(i,c,f),_s=p;break;default:li(i,c,f)}}function G_(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{dc(i)}catch(f){Tr(c,c.return,f)}}}function V_(i,c){if(c.memoizedState===null&&(i=c.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{dc(i)}catch(f){Tr(c,c.return,f)}}function bA(i){switch(i.tag){case 31:case 13:case 19:var c=i.stateNode;return c===null&&(c=i.stateNode=new $_),c;case 22:return i=i.stateNode,c=i._retryCache,c===null&&(c=i._retryCache=new $_),c;default:throw Error(s(435,i.tag))}}function sh(i,c){var f=bA(i);c.forEach(function(p){if(!f.has(p)){f.add(p);var j=AA.bind(null,i,p);p.then(j,j)}})}function va(i,c){var f=c.deletions;if(f!==null)for(var p=0;p<f.length;p++){var j=f[p],D=i,ee=c,ge=ee;e:for(;ge!==null;){switch(ge.tag){case 27:if(Qi(ge.type)){Xr=ge.stateNode,ya=!1;break e}break;case 5:Xr=ge.stateNode,ya=!1;break e;case 3:case 4:Xr=ge.stateNode.containerInfo,ya=!0;break e}ge=ge.return}if(Xr===null)throw Error(s(160));W_(D,ee,j),Xr=null,ya=!1,D=j.alternate,D!==null&&(D.return=null),j.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)K_(c,i),c=c.sibling}var yn=null;function K_(i,c){var f=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:va(c,i),ba(i),p&4&&(Gi(3,i,i.return),Fu(3,i),Gi(5,i,i.return));break;case 1:va(c,i),ba(i),p&512&&(_s||f===null||On(f,f.return)),p&64&&oi&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(f=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=f===null?p:f.concat(p))));break;case 26:var j=yn;if(va(c,i),ba(i),p&512&&(_s||f===null||On(f,f.return)),p&4){var D=f!==null?f.memoizedState:null;if(p=i.memoizedState,f===null)if(p===null)if(i.stateNode===null){e:{p=i.type,f=i.memoizedProps,j=j.ownerDocument||j;t:switch(p){case"title":D=j.getElementsByTagName("title")[0],(!D||D[Ke]||D[be]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=j.createElement(p),j.head.insertBefore(D,j.querySelector("head > title"))),zs(D,p,f),D[be]=i,Ie(D),p=D;break e;case"link":var ee=K2("link","href",j).get(p+(f.href||""));if(ee){for(var ge=0;ge<ee.length;ge++)if(D=ee[ge],D.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&D.getAttribute("rel")===(f.rel==null?null:f.rel)&&D.getAttribute("title")===(f.title==null?null:f.title)&&D.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){ee.splice(ge,1);break t}}D=j.createElement(p),zs(D,p,f),j.head.appendChild(D);break;case"meta":if(ee=K2("meta","content",j).get(p+(f.content||""))){for(ge=0;ge<ee.length;ge++)if(D=ee[ge],D.getAttribute("content")===(f.content==null?null:""+f.content)&&D.getAttribute("name")===(f.name==null?null:f.name)&&D.getAttribute("property")===(f.property==null?null:f.property)&&D.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&D.getAttribute("charset")===(f.charSet==null?null:f.charSet)){ee.splice(ge,1);break t}}D=j.createElement(p),zs(D,p,f),j.head.appendChild(D);break;default:throw Error(s(468,p))}D[be]=i,Ie(D),p=D}i.stateNode=p}else X2(j,i.type,i.stateNode);else i.stateNode=V2(j,p,i.memoizedProps);else D!==p?(D===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):D.count--,p===null?X2(j,i.type,i.stateNode):V2(j,p,i.memoizedProps)):p===null&&i.stateNode!==null&&Kp(i,i.memoizedProps,f.memoizedProps)}break;case 27:va(c,i),ba(i),p&512&&(_s||f===null||On(f,f.return)),f!==null&&p&4&&Kp(i,i.memoizedProps,f.memoizedProps);break;case 5:if(va(c,i),ba(i),p&512&&(_s||f===null||On(f,f.return)),i.flags&32){j=i.stateNode;try{Fl(j,"")}catch(Ot){Tr(i,i.return,Ot)}}p&4&&i.stateNode!=null&&(j=i.memoizedProps,Kp(i,j,f!==null?f.memoizedProps:j)),p&1024&&(Jp=!0);break;case 6:if(va(c,i),ba(i),p&4){if(i.stateNode===null)throw Error(s(162));p=i.memoizedProps,f=i.stateNode;try{f.nodeValue=p}catch(Ot){Tr(i,i.return,Ot)}}break;case 3:if(vh=null,j=yn,yn=gh(c.containerInfo),va(c,i),yn=j,ba(i),p&4&&f!==null&&f.memoizedState.isDehydrated)try{dc(c.containerInfo)}catch(Ot){Tr(i,i.return,Ot)}Jp&&(Jp=!1,X_(i));break;case 4:p=yn,yn=gh(i.stateNode.containerInfo),va(c,i),ba(i),yn=p;break;case 12:va(c,i),ba(i);break;case 31:va(c,i),ba(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,sh(i,p)));break;case 13:va(c,i),ba(i),i.child.flags&8192&&i.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(nh=Me()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,sh(i,p)));break;case 22:j=i.memoizedState!==null;var Fe=f!==null&&f.memoizedState!==null,Ve=oi,it=_s;if(oi=Ve||j,_s=it||Fe,va(c,i),_s=it,oi=Ve,ba(i),p&8192)e:for(c=i.stateNode,c._visibility=j?c._visibility&-2:c._visibility|1,j&&(f===null||Fe||oi||_s||Uo(i)),f=null,c=i;;){if(c.tag===5||c.tag===26){if(f===null){Fe=f=c;try{if(D=Fe.stateNode,j)ee=D.style,typeof ee.setProperty=="function"?ee.setProperty("display","none","important"):ee.display="none";else{ge=Fe.stateNode;var ut=Fe.memoizedProps.style,Xe=ut!=null&&ut.hasOwnProperty("display")?ut.display:null;ge.style.display=Xe==null||typeof Xe=="boolean"?"":(""+Xe).trim()}}catch(Ot){Tr(Fe,Fe.return,Ot)}}}else if(c.tag===6){if(f===null){Fe=c;try{Fe.stateNode.nodeValue=j?"":Fe.memoizedProps}catch(Ot){Tr(Fe,Fe.return,Ot)}}}else if(c.tag===18){if(f===null){Fe=c;try{var Qe=Fe.stateNode;j?B2(Qe,!0):B2(Fe.stateNode,!1)}catch(Ot){Tr(Fe,Fe.return,Ot)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===i)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break e;for(;c.sibling===null;){if(c.return===null||c.return===i)break e;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}p&4&&(p=i.updateQueue,p!==null&&(f=p.retryQueue,f!==null&&(p.retryQueue=null,sh(i,f))));break;case 19:va(c,i),ba(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,sh(i,p)));break;case 30:break;case 21:break;default:va(c,i),ba(i)}}function ba(i){var c=i.flags;if(c&2){try{for(var f,p=i.return;p!==null;){if(U_(p)){f=p;break}p=p.return}if(f==null)throw Error(s(160));switch(f.tag){case 27:var j=f.stateNode,D=Xp(i);rh(i,D,j);break;case 5:var ee=f.stateNode;f.flags&32&&(Fl(ee,""),f.flags&=-33);var ge=Xp(i);rh(i,ge,ee);break;case 3:case 4:var Fe=f.stateNode.containerInfo,Ve=Xp(i);Yp(i,Ve,Fe);break;default:throw Error(s(161))}}catch(it){Tr(i,i.return,it)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function X_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var c=i;X_(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),i=i.sibling}}function ci(i,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)q_(i,c.alternate,c),c=c.sibling}function Uo(i){for(i=i.child;i!==null;){var c=i;switch(c.tag){case 0:case 11:case 14:case 15:Gi(4,c,c.return),Uo(c);break;case 1:On(c,c.return);var f=c.stateNode;typeof f.componentWillUnmount=="function"&&B_(c,c.return,f),Uo(c);break;case 27:Hu(c.stateNode);case 26:case 5:On(c,c.return),Uo(c);break;case 22:c.memoizedState===null&&Uo(c);break;case 30:Uo(c);break;default:Uo(c)}i=i.sibling}}function ui(i,c,f){for(f=f&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var p=c.alternate,j=i,D=c,ee=D.flags;switch(D.tag){case 0:case 11:case 15:ui(j,D,f),Fu(4,D);break;case 1:if(ui(j,D,f),p=D,j=p.stateNode,typeof j.componentDidMount=="function")try{j.componentDidMount()}catch(Ve){Tr(p,p.return,Ve)}if(p=D,j=p.updateQueue,j!==null){var ge=p.stateNode;try{var Fe=j.shared.hiddenCallbacks;if(Fe!==null)for(j.shared.hiddenCallbacks=null,j=0;j<Fe.length;j++)Ew(Fe[j],ge)}catch(Ve){Tr(p,p.return,Ve)}}f&&ee&64&&M_(D),Lu(D,D.return);break;case 27:z_(D);case 26:case 5:ui(j,D,f),f&&p===null&&ee&4&&P_(D),Lu(D,D.return);break;case 12:ui(j,D,f);break;case 31:ui(j,D,f),f&&ee&4&&G_(j,D);break;case 13:ui(j,D,f),f&&ee&4&&V_(j,D);break;case 22:D.memoizedState===null&&ui(j,D,f),Lu(D,D.return);break;case 30:break;default:ui(j,D,f)}c=c.sibling}}function Zp(i,c){var f=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),i=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(i=c.memoizedState.cachePool.pool),i!==f&&(i!=null&&i.refCount++,f!=null&&wu(f))}function Qp(i,c){i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&wu(i))}function vn(i,c,f,p){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)Y_(i,c,f,p),c=c.sibling}function Y_(i,c,f,p){var j=c.flags;switch(c.tag){case 0:case 11:case 15:vn(i,c,f,p),j&2048&&Fu(9,c);break;case 1:vn(i,c,f,p);break;case 3:vn(i,c,f,p),j&2048&&(i=null,c.alternate!==null&&(i=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==i&&(c.refCount++,i!=null&&wu(i)));break;case 12:if(j&2048){vn(i,c,f,p),i=c.stateNode;try{var D=c.memoizedProps,ee=D.id,ge=D.onPostCommit;typeof ge=="function"&&ge(ee,c.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Fe){Tr(c,c.return,Fe)}}else vn(i,c,f,p);break;case 31:vn(i,c,f,p);break;case 13:vn(i,c,f,p);break;case 23:break;case 22:D=c.stateNode,ee=c.alternate,c.memoizedState!==null?D._visibility&2?vn(i,c,f,p):Iu(i,c):D._visibility&2?vn(i,c,f,p):(D._visibility|=2,ec(i,c,f,p,(c.subtreeFlags&10256)!==0||!1)),j&2048&&Zp(ee,c);break;case 24:vn(i,c,f,p),j&2048&&Qp(c.alternate,c);break;default:vn(i,c,f,p)}}function ec(i,c,f,p,j){for(j=j&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var D=i,ee=c,ge=f,Fe=p,Ve=ee.flags;switch(ee.tag){case 0:case 11:case 15:ec(D,ee,ge,Fe,j),Fu(8,ee);break;case 23:break;case 22:var it=ee.stateNode;ee.memoizedState!==null?it._visibility&2?ec(D,ee,ge,Fe,j):Iu(D,ee):(it._visibility|=2,ec(D,ee,ge,Fe,j)),j&&Ve&2048&&Zp(ee.alternate,ee);break;case 24:ec(D,ee,ge,Fe,j),j&&Ve&2048&&Qp(ee.alternate,ee);break;default:ec(D,ee,ge,Fe,j)}c=c.sibling}}function Iu(i,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var f=i,p=c,j=p.flags;switch(p.tag){case 22:Iu(f,p),j&2048&&Zp(p.alternate,p);break;case 24:Iu(f,p),j&2048&&Qp(p.alternate,p);break;default:Iu(f,p)}c=c.sibling}}var Mu=8192;function tc(i,c,f){if(i.subtreeFlags&Mu)for(i=i.child;i!==null;)J_(i,c,f),i=i.sibling}function J_(i,c,f){switch(i.tag){case 26:tc(i,c,f),i.flags&Mu&&i.memoizedState!==null&&iC(f,yn,i.memoizedState,i.memoizedProps);break;case 5:tc(i,c,f);break;case 3:case 4:var p=yn;yn=gh(i.stateNode.containerInfo),tc(i,c,f),yn=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=Mu,Mu=16777216,tc(i,c,f),Mu=p):tc(i,c,f));break;default:tc(i,c,f)}}function Z_(i){var c=i.alternate;if(c!==null&&(i=c.child,i!==null)){c.child=null;do c=i.sibling,i.sibling=null,i=c;while(i!==null)}}function Bu(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];Ds=p,e2(p,i)}Z_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Q_(i),i=i.sibling}function Q_(i){switch(i.tag){case 0:case 11:case 15:Bu(i),i.flags&2048&&Gi(9,i,i.return);break;case 3:Bu(i);break;case 12:Bu(i);break;case 22:var c=i.stateNode;i.memoizedState!==null&&c._visibility&2&&(i.return===null||i.return.tag!==13)?(c._visibility&=-3,ah(i)):Bu(i);break;default:Bu(i)}}function ah(i){var c=i.deletions;if((i.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];Ds=p,e2(p,i)}Z_(i)}for(i=i.child;i!==null;){switch(c=i,c.tag){case 0:case 11:case 15:Gi(8,c,c.return),ah(c);break;case 22:f=c.stateNode,f._visibility&2&&(f._visibility&=-3,ah(c));break;default:ah(c)}i=i.sibling}}function e2(i,c){for(;Ds!==null;){var f=Ds;switch(f.tag){case 0:case 11:case 15:Gi(8,f,c);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var p=f.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:wu(f.memoizedState.cache)}if(p=f.child,p!==null)p.return=f,Ds=p;else e:for(f=i;Ds!==null;){p=Ds;var j=p.sibling,D=p.return;if(H_(p),p===f){Ds=null;break e}if(j!==null){j.return=D,Ds=j;break e}Ds=D}}}var wA={getCacheForType:function(i){var c=Ps(vs),f=c.data.get(i);return f===void 0&&(f=i(),c.data.set(i,f)),f},cacheSignal:function(){return Ps(vs).controller.signal}},_A=typeof WeakMap=="function"?WeakMap:Map,Nr=0,zr=null,or=null,ur=0,jr=0,Oa=null,Vi=!1,rc=!1,ex=!1,di=0,ss=0,Ki=0,zo=0,tx=0,Fa=0,sc=0,Pu=null,wa=null,rx=!1,nh=0,t2=0,ih=1/0,oh=null,Xi=null,Ts=0,Yi=null,ac=null,fi=0,sx=0,ax=null,r2=null,Uu=0,nx=null;function La(){return(Nr&2)!==0&&ur!==0?ur&-ur:Q.T!==null?dx():he()}function s2(){if(Fa===0)if((ur&536870912)===0||hr){var i=xe;xe<<=1,(xe&3932160)===0&&(xe=262144),Fa=i}else Fa=536870912;return i=Ra.current,i!==null&&(i.flags|=32),Fa}function _a(i,c,f){(i===zr&&(jr===2||jr===9)||i.cancelPendingCommit!==null)&&(nc(i,0),Ji(i,ur,Fa,!1)),Vt(i,f),((Nr&2)===0||i!==zr)&&(i===zr&&((Nr&2)===0&&(zo|=f),ss===4&&Ji(i,ur,Fa,!1)),Fn(i))}function a2(i,c,f){if((Nr&6)!==0)throw Error(s(327));var p=!f&&(c&127)===0&&(c&i.expiredLanes)===0||Ue(i,c),j=p?SA(i,c):ox(i,c,!0),D=p;do{if(j===0){rc&&!p&&Ji(i,c,0,!1);break}else{if(f=i.current.alternate,D&&!NA(f)){j=ox(i,c,!1),D=!1;continue}if(j===2){if(D=c,i.errorRecoveryDisabledLanes&D)var ee=0;else ee=i.pendingLanes&-536870913,ee=ee!==0?ee:ee&536870912?536870912:0;if(ee!==0){c=ee;e:{var ge=i;j=Pu;var Fe=ge.current.memoizedState.isDehydrated;if(Fe&&(nc(ge,ee).flags|=256),ee=ox(ge,ee,!1),ee!==2){if(ex&&!Fe){ge.errorRecoveryDisabledLanes|=D,zo|=D,j=4;break e}D=wa,wa=j,D!==null&&(wa===null?wa=D:wa.push.apply(wa,D))}j=ee}if(D=!1,j!==2)continue}}if(j===1){nc(i,0),Ji(i,c,0,!0);break}e:{switch(p=i,D=j,D){case 0:case 1:throw Error(s(345));case 4:if((c&4194048)!==c)break;case 6:Ji(p,c,Fa,!Vi);break e;case 2:wa=null;break;case 3:case 5:break;default:throw Error(s(329))}if((c&62914560)===c&&(j=nh+300-Me(),10<j)){if(Ji(p,c,Fa,!Vi),Oe(p,0,!0)!==0)break e;fi=c,p.timeoutHandle=L2(n2.bind(null,p,f,wa,oh,rx,c,Fa,zo,sc,Vi,D,"Throttled",-0,0),j);break e}n2(p,f,wa,oh,rx,c,Fa,zo,sc,Vi,D,null,-0,0)}}break}while(!0);Fn(i)}function n2(i,c,f,p,j,D,ee,ge,Fe,Ve,it,ut,Xe,Qe){if(i.timeoutHandle=-1,ut=c.subtreeFlags,ut&8192||(ut&16785408)===16785408){ut={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Jn},J_(c,D,ut);var Ot=(D&62914560)===D?nh-Me():(D&4194048)===D?t2-Me():0;if(Ot=oC(ut,Ot),Ot!==null){fi=D,i.cancelPendingCommit=Ot(h2.bind(null,i,c,D,f,p,j,ee,ge,Fe,it,ut,null,Xe,Qe)),Ji(i,D,ee,!Ve);return}}h2(i,c,D,f,p,j,ee,ge,Fe)}function NA(i){for(var c=i;;){var f=c.tag;if((f===0||f===11||f===15)&&c.flags&16384&&(f=c.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var p=0;p<f.length;p++){var j=f[p],D=j.getSnapshot;j=j.value;try{if(!Aa(D(),j))return!1}catch{return!1}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ji(i,c,f,p){c&=~tx,c&=~zo,i.suspendedLanes|=c,i.pingedLanes&=~c,p&&(i.warmLanes|=c),p=i.expirationTimes;for(var j=c;0<j;){var D=31-Le(j),ee=1<<D;p[D]=-1,j&=~ee}f!==0&&_r(i,f,c)}function lh(){return(Nr&6)===0?(zu(0),!1):!0}function ix(){if(or!==null){if(jr===0)var i=or.return;else i=or,ti=Do=null,_p(i),Xl=null,Nu=0,i=or;for(;i!==null;)I_(i.alternate,i),i=i.return;or=null}}function nc(i,c){var f=i.timeoutHandle;f!==-1&&(i.timeoutHandle=-1,qA(f)),f=i.cancelPendingCommit,f!==null&&(i.cancelPendingCommit=null,f()),fi=0,ix(),zr=i,or=f=Qn(i.current,null),ur=c,jr=0,Oa=null,Vi=!1,rc=Ue(i,c),ex=!1,sc=Fa=tx=zo=Ki=ss=0,wa=Pu=null,rx=!1,(c&8)!==0&&(c|=c&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=c;0<p;){var j=31-Le(p),D=1<<j;c|=i[j],p&=~D}return di=c,Af(),f}function i2(i,c){Jt=null,Q.H=Ru,c===Kl||c===Mf?(c=_w(),jr=3):c===up?(c=_w(),jr=4):jr=c===Bp?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Oa=c,or===null&&(ss=1,Jf(i,Ja(c,i.current)))}function o2(){var i=Ra.current;return i===null?!0:(ur&4194048)===ur?tn===null:(ur&62914560)===ur||(ur&536870912)!==0?i===tn:!1}function l2(){var i=Q.H;return Q.H=Ru,i===null?Ru:i}function c2(){var i=Q.A;return Q.A=wA,i}function ch(){ss=4,Vi||(ur&4194048)!==ur&&Ra.current!==null||(rc=!0),(Ki&134217727)===0&&(zo&134217727)===0||zr===null||Ji(zr,ur,Fa,!1)}function ox(i,c,f){var p=Nr;Nr|=2;var j=l2(),D=c2();(zr!==i||ur!==c)&&(oh=null,nc(i,c)),c=!1;var ee=ss;e:do try{if(jr!==0&&or!==null){var ge=or,Fe=Oa;switch(jr){case 8:ix(),ee=6;break e;case 3:case 2:case 9:case 6:Ra.current===null&&(c=!0);var Ve=jr;if(jr=0,Oa=null,ic(i,ge,Fe,Ve),f&&rc){ee=0;break e}break;default:Ve=jr,jr=0,Oa=null,ic(i,ge,Fe,Ve)}}kA(),ee=ss;break}catch(it){i2(i,it)}while(!0);return c&&i.shellSuspendCounter++,ti=Do=null,Nr=p,Q.H=j,Q.A=D,or===null&&(zr=null,ur=0,Af()),ee}function kA(){for(;or!==null;)u2(or)}function SA(i,c){var f=Nr;Nr|=2;var p=l2(),j=c2();zr!==i||ur!==c?(oh=null,ih=Me()+500,nc(i,c)):rc=Ue(i,c);e:do try{if(jr!==0&&or!==null){c=or;var D=Oa;t:switch(jr){case 1:jr=0,Oa=null,ic(i,c,D,1);break;case 2:case 9:if(bw(D)){jr=0,Oa=null,d2(c);break}c=function(){jr!==2&&jr!==9||zr!==i||(jr=7),Fn(i)},D.then(c,c);break e;case 3:jr=7;break e;case 4:jr=5;break e;case 7:bw(D)?(jr=0,Oa=null,d2(c)):(jr=0,Oa=null,ic(i,c,D,7));break;case 5:var ee=null;switch(or.tag){case 26:ee=or.memoizedState;case 5:case 27:var ge=or;if(ee?Y2(ee):ge.stateNode.complete){jr=0,Oa=null;var Fe=ge.sibling;if(Fe!==null)or=Fe;else{var Ve=ge.return;Ve!==null?(or=Ve,uh(Ve)):or=null}break t}}jr=0,Oa=null,ic(i,c,D,5);break;case 6:jr=0,Oa=null,ic(i,c,D,6);break;case 8:ix(),ss=6;break e;default:throw Error(s(462))}}EA();break}catch(it){i2(i,it)}while(!0);return ti=Do=null,Q.H=p,Q.A=j,Nr=f,or!==null?0:(zr=null,ur=0,Af(),ss)}function EA(){for(;or!==null&&!le();)u2(or)}function u2(i){var c=F_(i.alternate,i,di);i.memoizedProps=i.pendingProps,c===null?uh(i):or=c}function d2(i){var c=i,f=c.alternate;switch(c.tag){case 15:case 0:c=T_(f,c,c.pendingProps,c.type,void 0,ur);break;case 11:c=T_(f,c,c.pendingProps,c.type.render,c.ref,ur);break;case 5:_p(c);default:I_(f,c),c=or=cw(c,di),c=F_(f,c,di)}i.memoizedProps=i.pendingProps,c===null?uh(i):or=c}function ic(i,c,f,p){ti=Do=null,_p(c),Xl=null,Nu=0;var j=c.return;try{if(mA(i,j,c,f,ur)){ss=1,Jf(i,Ja(f,i.current)),or=null;return}}catch(D){if(j!==null)throw or=j,D;ss=1,Jf(i,Ja(f,i.current)),or=null;return}c.flags&32768?(hr||p===1?i=!0:rc||(ur&536870912)!==0?i=!1:(Vi=i=!0,(p===2||p===9||p===3||p===6)&&(p=Ra.current,p!==null&&p.tag===13&&(p.flags|=16384))),f2(c,i)):uh(c)}function uh(i){var c=i;do{if((c.flags&32768)!==0){f2(c,Vi);return}i=c.return;var f=gA(c.alternate,c,di);if(f!==null){or=f;return}if(c=c.sibling,c!==null){or=c;return}or=c=i}while(c!==null);ss===0&&(ss=5)}function f2(i,c){do{var f=yA(i.alternate,i);if(f!==null){f.flags&=32767,or=f;return}if(f=i.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!c&&(i=i.sibling,i!==null)){or=i;return}or=i=f}while(i!==null);ss=6,or=null}function h2(i,c,f,p,j,D,ee,ge,Fe){i.cancelPendingCommit=null;do dh();while(Ts!==0);if((Nr&6)!==0)throw Error(s(327));if(c!==null){if(c===i.current)throw Error(s(177));if(D=c.lanes|c.childLanes,D|=Xm,yr(i,f,D,ee,ge,Fe),i===zr&&(or=zr=null,ur=0),ac=c,Yi=i,fi=f,sx=D,ax=j,r2=p,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,CA($e,function(){return y2(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||p){p=Q.T,Q.T=null,j=re.p,re.p=2,ee=Nr,Nr|=4;try{vA(i,c,f)}finally{Nr=ee,re.p=j,Q.T=p}}Ts=1,m2(),p2(),x2()}}function m2(){if(Ts===1){Ts=0;var i=Yi,c=ac,f=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||f){f=Q.T,Q.T=null;var p=re.p;re.p=2;var j=Nr;Nr|=4;try{K_(c,i);var D=vx,ee=ew(i.containerInfo),ge=D.focusedElem,Fe=D.selectionRange;if(ee!==ge&&ge&&ge.ownerDocument&&Qb(ge.ownerDocument.documentElement,ge)){if(Fe!==null&&Hm(ge)){var Ve=Fe.start,it=Fe.end;if(it===void 0&&(it=Ve),"selectionStart"in ge)ge.selectionStart=Ve,ge.selectionEnd=Math.min(it,ge.value.length);else{var ut=ge.ownerDocument||document,Xe=ut&&ut.defaultView||window;if(Xe.getSelection){var Qe=Xe.getSelection(),Ot=ge.textContent.length,$t=Math.min(Fe.start,Ot),Ir=Fe.end===void 0?$t:Math.min(Fe.end,Ot);!Qe.extend&&$t>Ir&&(ee=Ir,Ir=$t,$t=ee);var ze=Zb(ge,$t),Be=Zb(ge,Ir);if(ze&&Be&&(Qe.rangeCount!==1||Qe.anchorNode!==ze.node||Qe.anchorOffset!==ze.offset||Qe.focusNode!==Be.node||Qe.focusOffset!==Be.offset)){var Ge=ut.createRange();Ge.setStart(ze.node,ze.offset),Qe.removeAllRanges(),$t>Ir?(Qe.addRange(Ge),Qe.extend(Be.node,Be.offset)):(Ge.setEnd(Be.node,Be.offset),Qe.addRange(Ge))}}}}for(ut=[],Qe=ge;Qe=Qe.parentNode;)Qe.nodeType===1&&ut.push({element:Qe,left:Qe.scrollLeft,top:Qe.scrollTop});for(typeof ge.focus=="function"&&ge.focus(),ge=0;ge<ut.length;ge++){var lt=ut[ge];lt.element.scrollLeft=lt.left,lt.element.scrollTop=lt.top}}Nh=!!yx,vx=yx=null}finally{Nr=j,re.p=p,Q.T=f}}i.current=c,Ts=2}}function p2(){if(Ts===2){Ts=0;var i=Yi,c=ac,f=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||f){f=Q.T,Q.T=null;var p=re.p;re.p=2;var j=Nr;Nr|=4;try{q_(i,c.alternate,c)}finally{Nr=j,re.p=p,Q.T=f}}Ts=3}}function x2(){if(Ts===4||Ts===3){Ts=0,Ae();var i=Yi,c=ac,f=fi,p=r2;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Ts=5:(Ts=0,ac=Yi=null,g2(i,i.pendingLanes));var j=i.pendingLanes;if(j===0&&(Xi=null),Zr(f),c=c.stateNode,At&&typeof At.onCommitFiberRoot=="function")try{At.onCommitFiberRoot(vt,c,void 0,(c.current.flags&128)===128)}catch{}if(p!==null){c=Q.T,j=re.p,re.p=2,Q.T=null;try{for(var D=i.onRecoverableError,ee=0;ee<p.length;ee++){var ge=p[ee];D(ge.value,{componentStack:ge.stack})}}finally{Q.T=c,re.p=j}}(fi&3)!==0&&dh(),Fn(i),j=i.pendingLanes,(f&261930)!==0&&(j&42)!==0?i===nx?Uu++:(Uu=0,nx=i):Uu=0,zu(0)}}function g2(i,c){(i.pooledCacheLanes&=c)===0&&(c=i.pooledCache,c!=null&&(i.pooledCache=null,wu(c)))}function dh(){return m2(),p2(),x2(),y2()}function y2(){if(Ts!==5)return!1;var i=Yi,c=sx;sx=0;var f=Zr(fi),p=Q.T,j=re.p;try{re.p=32>f?32:f,Q.T=null,f=ax,ax=null;var D=Yi,ee=fi;if(Ts=0,ac=Yi=null,fi=0,(Nr&6)!==0)throw Error(s(331));var ge=Nr;if(Nr|=4,Q_(D.current),Y_(D,D.current,ee,f),Nr=ge,zu(0,!1),At&&typeof At.onPostCommitFiberRoot=="function")try{At.onPostCommitFiberRoot(vt,D)}catch{}return!0}finally{re.p=j,Q.T=p,g2(i,c)}}function v2(i,c,f){c=Ja(f,c),c=Mp(i.stateNode,c,2),i=qi(i,c,2),i!==null&&(Vt(i,2),Fn(i))}function Tr(i,c,f){if(i.tag===3)v2(i,i,f);else for(;c!==null;){if(c.tag===3){v2(c,i,f);break}else if(c.tag===1){var p=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Xi===null||!Xi.has(p))){i=Ja(f,i),f=b_(2),p=qi(c,f,2),p!==null&&(w_(f,p,c,i),Vt(p,2),Fn(p));break}}c=c.return}}function lx(i,c,f){var p=i.pingCache;if(p===null){p=i.pingCache=new _A;var j=new Set;p.set(c,j)}else j=p.get(c),j===void 0&&(j=new Set,p.set(c,j));j.has(f)||(ex=!0,j.add(f),i=jA.bind(null,i,c,f),c.then(i,i))}function jA(i,c,f){var p=i.pingCache;p!==null&&p.delete(c),i.pingedLanes|=i.suspendedLanes&f,i.warmLanes&=~f,zr===i&&(ur&f)===f&&(ss===4||ss===3&&(ur&62914560)===ur&&300>Me()-nh?(Nr&2)===0&&nc(i,0):tx|=f,sc===ur&&(sc=0)),Fn(i)}function b2(i,c){c===0&&(c=pt()),i=Ao(i,c),i!==null&&(Vt(i,c),Fn(i))}function TA(i){var c=i.memoizedState,f=0;c!==null&&(f=c.retryLane),b2(i,f)}function AA(i,c){var f=0;switch(i.tag){case 31:case 13:var p=i.stateNode,j=i.memoizedState;j!==null&&(f=j.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(s(314))}p!==null&&p.delete(c),b2(i,f)}function CA(i,c){return me(i,c)}var fh=null,oc=null,cx=!1,hh=!1,ux=!1,Zi=0;function Fn(i){i!==oc&&i.next===null&&(oc===null?fh=oc=i:oc=oc.next=i),hh=!0,cx||(cx=!0,DA())}function zu(i,c){if(!ux&&hh){ux=!0;do for(var f=!1,p=fh;p!==null;){if(i!==0){var j=p.pendingLanes;if(j===0)var D=0;else{var ee=p.suspendedLanes,ge=p.pingedLanes;D=(1<<31-Le(42|i)+1)-1,D&=j&~(ee&~ge),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(f=!0,k2(p,D))}else D=ur,D=Oe(p,p===zr?D:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(D&3)===0||Ue(p,D)||(f=!0,k2(p,D));p=p.next}while(f);ux=!1}}function RA(){w2()}function w2(){hh=cx=!1;var i=0;Zi!==0&&$A()&&(i=Zi);for(var c=Me(),f=null,p=fh;p!==null;){var j=p.next,D=_2(p,c);D===0?(p.next=null,f===null?fh=j:f.next=j,j===null&&(oc=f)):(f=p,(i!==0||(D&3)!==0)&&(hh=!0)),p=j}Ts!==0&&Ts!==5||zu(i),Zi!==0&&(Zi=0)}function _2(i,c){for(var f=i.suspendedLanes,p=i.pingedLanes,j=i.expirationTimes,D=i.pendingLanes&-62914561;0<D;){var ee=31-Le(D),ge=1<<ee,Fe=j[ee];Fe===-1?((ge&f)===0||(ge&p)!==0)&&(j[ee]=st(ge,c)):Fe<=c&&(i.expiredLanes|=ge),D&=~ge}if(c=zr,f=ur,f=Oe(i,i===c?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,f===0||i===c&&(jr===2||jr===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&_e(p),i.callbackNode=null,i.callbackPriority=0;if((f&3)===0||Ue(i,f)){if(c=f&-f,c===i.callbackPriority)return c;switch(p!==null&&_e(p),Zr(f)){case 2:case 8:f=Je;break;case 32:f=$e;break;case 268435456:f=De;break;default:f=$e}return p=N2.bind(null,i),f=me(f,p),i.callbackPriority=c,i.callbackNode=f,c}return p!==null&&p!==null&&_e(p),i.callbackPriority=2,i.callbackNode=null,2}function N2(i,c){if(Ts!==0&&Ts!==5)return i.callbackNode=null,i.callbackPriority=0,null;var f=i.callbackNode;if(dh()&&i.callbackNode!==f)return null;var p=ur;return p=Oe(i,i===zr?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(a2(i,p,c),_2(i,Me()),i.callbackNode!=null&&i.callbackNode===f?N2.bind(null,i):null)}function k2(i,c){if(dh())return null;a2(i,c,!0)}function DA(){HA(function(){(Nr&6)!==0?me(Ce,RA):w2()})}function dx(){if(Zi===0){var i=Gl;i===0&&(i=Ne,Ne<<=1,(Ne&261888)===0&&(Ne=256)),Zi=i}return Zi}function S2(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:wf(""+i)}function E2(i,c){var f=c.ownerDocument.createElement("input");return f.name=c.name,f.value=c.value,i.id&&f.setAttribute("form",i.id),c.parentNode.insertBefore(f,c),i=new FormData(i),f.parentNode.removeChild(f),i}function OA(i,c,f,p,j){if(c==="submit"&&f&&f.stateNode===j){var D=S2((j[Se]||null).action),ee=p.submitter;ee&&(c=(c=ee[Se]||null)?S2(c.formAction):ee.getAttribute("formAction"),c!==null&&(D=c,ee=null));var ge=new Sf("action","action",null,p,j);i.push({event:ge,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Zi!==0){var Fe=ee?E2(j,ee):new FormData(j);Rp(f,{pending:!0,data:Fe,method:j.method,action:D},null,Fe)}}else typeof D=="function"&&(ge.preventDefault(),Fe=ee?E2(j,ee):new FormData(j),Rp(f,{pending:!0,data:Fe,method:j.method,action:D},D,Fe))},currentTarget:j}]})}}for(var fx=0;fx<Km.length;fx++){var hx=Km[fx],FA=hx.toLowerCase(),LA=hx[0].toUpperCase()+hx.slice(1);gn(FA,"on"+LA)}gn(sw,"onAnimationEnd"),gn(aw,"onAnimationIteration"),gn(nw,"onAnimationStart"),gn("dblclick","onDoubleClick"),gn("focusin","onFocus"),gn("focusout","onBlur"),gn(J6,"onTransitionRun"),gn(Z6,"onTransitionStart"),gn(Q6,"onTransitionCancel"),gn(iw,"onTransitionEnd"),Ur("onMouseEnter",["mouseout","mouseover"]),Ur("onMouseLeave",["mouseout","mouseover"]),Ur("onPointerEnter",["pointerout","pointerover"]),Ur("onPointerLeave",["pointerout","pointerover"]),Ut("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ut("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ut("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ut("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ut("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ut("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),IA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($u));function j2(i,c){c=(c&4)!==0;for(var f=0;f<i.length;f++){var p=i[f],j=p.event;p=p.listeners;e:{var D=void 0;if(c)for(var ee=p.length-1;0<=ee;ee--){var ge=p[ee],Fe=ge.instance,Ve=ge.currentTarget;if(ge=ge.listener,Fe!==D&&j.isPropagationStopped())break e;D=ge,j.currentTarget=Ve;try{D(j)}catch(it){Tf(it)}j.currentTarget=null,D=Fe}else for(ee=0;ee<p.length;ee++){if(ge=p[ee],Fe=ge.instance,Ve=ge.currentTarget,ge=ge.listener,Fe!==D&&j.isPropagationStopped())break e;D=ge,j.currentTarget=Ve;try{D(j)}catch(it){Tf(it)}j.currentTarget=null,D=Fe}}}}function lr(i,c){var f=c[We];f===void 0&&(f=c[We]=new Set);var p=i+"__bubble";f.has(p)||(T2(c,i,2,!1),f.add(p))}function mx(i,c,f){var p=0;c&&(p|=4),T2(f,i,p,c)}var mh="_reactListening"+Math.random().toString(36).slice(2);function px(i){if(!i[mh]){i[mh]=!0,wt.forEach(function(f){f!=="selectionchange"&&(IA.has(f)||mx(f,!1,i),mx(f,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[mh]||(c[mh]=!0,mx("selectionchange",!1,c))}}function T2(i,c,f,p){switch(sN(c)){case 2:var j=uC;break;case 8:j=dC;break;default:j=Cx}f=j.bind(null,c,f,i),j=void 0,!Lm||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(j=!0),p?j!==void 0?i.addEventListener(c,f,{capture:!0,passive:j}):i.addEventListener(c,f,!0):j!==void 0?i.addEventListener(c,f,{passive:j}):i.addEventListener(c,f,!1)}function xx(i,c,f,p,j){var D=p;if((c&1)===0&&(c&2)===0&&p!==null)e:for(;;){if(p===null)return;var ee=p.tag;if(ee===3||ee===4){var ge=p.stateNode.containerInfo;if(ge===j)break;if(ee===4)for(ee=p.return;ee!==null;){var Fe=ee.tag;if((Fe===3||Fe===4)&&ee.stateNode.containerInfo===j)return;ee=ee.return}for(;ge!==null;){if(ee=bt(ge),ee===null)return;if(Fe=ee.tag,Fe===5||Fe===6||Fe===26||Fe===27){p=D=ee;continue e}ge=ge.parentNode}}p=p.return}Ob(function(){var Ve=D,it=Om(f),ut=[];e:{var Xe=ow.get(i);if(Xe!==void 0){var Qe=Sf,Ot=i;switch(i){case"keypress":if(Nf(f)===0)break e;case"keydown":case"keyup":Qe=A6;break;case"focusin":Ot="focus",Qe=Pm;break;case"focusout":Ot="blur",Qe=Pm;break;case"beforeblur":case"afterblur":Qe=Pm;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qe=Ib;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qe=g6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qe=D6;break;case sw:case aw:case nw:Qe=b6;break;case iw:Qe=F6;break;case"scroll":case"scrollend":Qe=p6;break;case"wheel":Qe=I6;break;case"copy":case"cut":case"paste":Qe=_6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qe=Bb;break;case"toggle":case"beforetoggle":Qe=B6}var $t=(c&4)!==0,Ir=!$t&&(i==="scroll"||i==="scrollend"),ze=$t?Xe!==null?Xe+"Capture":null:Xe;$t=[];for(var Be=Ve,Ge;Be!==null;){var lt=Be;if(Ge=lt.stateNode,lt=lt.tag,lt!==5&&lt!==26&&lt!==27||Ge===null||ze===null||(lt=uu(Be,ze),lt!=null&&$t.push(qu(Be,lt,Ge))),Ir)break;Be=Be.return}0<$t.length&&(Xe=new Qe(Xe,Ot,null,f,it),ut.push({event:Xe,listeners:$t}))}}if((c&7)===0){e:{if(Xe=i==="mouseover"||i==="pointerover",Qe=i==="mouseout"||i==="pointerout",Xe&&f!==Dm&&(Ot=f.relatedTarget||f.fromElement)&&(bt(Ot)||Ot[Te]))break e;if((Qe||Xe)&&(Xe=it.window===it?it:(Xe=it.ownerDocument)?Xe.defaultView||Xe.parentWindow:window,Qe?(Ot=f.relatedTarget||f.toElement,Qe=Ve,Ot=Ot?bt(Ot):null,Ot!==null&&(Ir=o(Ot),$t=Ot.tag,Ot!==Ir||$t!==5&&$t!==27&&$t!==6)&&(Ot=null)):(Qe=null,Ot=Ve),Qe!==Ot)){if($t=Ib,lt="onMouseLeave",ze="onMouseEnter",Be="mouse",(i==="pointerout"||i==="pointerover")&&($t=Bb,lt="onPointerLeave",ze="onPointerEnter",Be="pointer"),Ir=Qe==null?Xe:xt(Qe),Ge=Ot==null?Xe:xt(Ot),Xe=new $t(lt,Be+"leave",Qe,f,it),Xe.target=Ir,Xe.relatedTarget=Ge,lt=null,bt(it)===Ve&&($t=new $t(ze,Be+"enter",Ot,f,it),$t.target=Ge,$t.relatedTarget=Ir,lt=$t),Ir=lt,Qe&&Ot)t:{for($t=MA,ze=Qe,Be=Ot,Ge=0,lt=ze;lt;lt=$t(lt))Ge++;lt=0;for(var Mt=Be;Mt;Mt=$t(Mt))lt++;for(;0<Ge-lt;)ze=$t(ze),Ge--;for(;0<lt-Ge;)Be=$t(Be),lt--;for(;Ge--;){if(ze===Be||Be!==null&&ze===Be.alternate){$t=ze;break t}ze=$t(ze),Be=$t(Be)}$t=null}else $t=null;Qe!==null&&A2(ut,Xe,Qe,$t,!1),Ot!==null&&Ir!==null&&A2(ut,Ir,Ot,$t,!0)}}e:{if(Xe=Ve?xt(Ve):window,Qe=Xe.nodeName&&Xe.nodeName.toLowerCase(),Qe==="select"||Qe==="input"&&Xe.type==="file")var vr=Gb;else if(Hb(Xe))if(Vb)vr=K6;else{vr=G6;var Lt=W6}else Qe=Xe.nodeName,!Qe||Qe.toLowerCase()!=="input"||Xe.type!=="checkbox"&&Xe.type!=="radio"?Ve&&Rm(Ve.elementType)&&(vr=Gb):vr=V6;if(vr&&(vr=vr(i,Ve))){Wb(ut,vr,f,it);break e}Lt&&Lt(i,Xe,Ve),i==="focusout"&&Ve&&Xe.type==="number"&&Ve.memoizedProps.value!=null&&Cm(Xe,"number",Xe.value)}switch(Lt=Ve?xt(Ve):window,i){case"focusin":(Hb(Lt)||Lt.contentEditable==="true")&&(Bl=Lt,Wm=Ve,yu=null);break;case"focusout":yu=Wm=Bl=null;break;case"mousedown":Gm=!0;break;case"contextmenu":case"mouseup":case"dragend":Gm=!1,tw(ut,f,it);break;case"selectionchange":if(Y6)break;case"keydown":case"keyup":tw(ut,f,it)}var Qt;if(zm)e:{switch(i){case"compositionstart":var dr="onCompositionStart";break e;case"compositionend":dr="onCompositionEnd";break e;case"compositionupdate":dr="onCompositionUpdate";break e}dr=void 0}else Ml?$b(i,f)&&(dr="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(dr="onCompositionStart");dr&&(Pb&&f.locale!=="ko"&&(Ml||dr!=="onCompositionStart"?dr==="onCompositionEnd"&&Ml&&(Qt=Fb()):(Ii=it,Im="value"in Ii?Ii.value:Ii.textContent,Ml=!0)),Lt=ph(Ve,dr),0<Lt.length&&(dr=new Mb(dr,i,null,f,it),ut.push({event:dr,listeners:Lt}),Qt?dr.data=Qt:(Qt=qb(f),Qt!==null&&(dr.data=Qt)))),(Qt=U6?z6(i,f):$6(i,f))&&(dr=ph(Ve,"onBeforeInput"),0<dr.length&&(Lt=new Mb("onBeforeInput","beforeinput",null,f,it),ut.push({event:Lt,listeners:dr}),Lt.data=Qt)),OA(ut,i,Ve,f,it)}j2(ut,c)})}function qu(i,c,f){return{instance:i,listener:c,currentTarget:f}}function ph(i,c){for(var f=c+"Capture",p=[];i!==null;){var j=i,D=j.stateNode;if(j=j.tag,j!==5&&j!==26&&j!==27||D===null||(j=uu(i,f),j!=null&&p.unshift(qu(i,j,D)),j=uu(i,c),j!=null&&p.push(qu(i,j,D))),i.tag===3)return p;i=i.return}return[]}function MA(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function A2(i,c,f,p,j){for(var D=c._reactName,ee=[];f!==null&&f!==p;){var ge=f,Fe=ge.alternate,Ve=ge.stateNode;if(ge=ge.tag,Fe!==null&&Fe===p)break;ge!==5&&ge!==26&&ge!==27||Ve===null||(Fe=Ve,j?(Ve=uu(f,D),Ve!=null&&ee.unshift(qu(f,Ve,Fe))):j||(Ve=uu(f,D),Ve!=null&&ee.push(qu(f,Ve,Fe)))),f=f.return}ee.length!==0&&i.push({event:c,listeners:ee})}var BA=/\r\n?/g,PA=/\u0000|\uFFFD/g;function C2(i){return(typeof i=="string"?i:""+i).replace(BA,`
`).replace(PA,"")}function R2(i,c){return c=C2(c),C2(i)===c}function Lr(i,c,f,p,j,D){switch(f){case"children":typeof p=="string"?c==="body"||c==="textarea"&&p===""||Fl(i,p):(typeof p=="number"||typeof p=="bigint")&&c!=="body"&&Fl(i,""+p);break;case"className":Va(i,"class",p);break;case"tabIndex":Va(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Va(i,f,p);break;case"style":Rb(i,p,D);break;case"data":if(c!=="object"){Va(i,"data",p);break}case"src":case"href":if(p===""&&(c!=="a"||f!=="href")){i.removeAttribute(f);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=wf(""+p),i.setAttribute(f,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(f==="formAction"?(c!=="input"&&Lr(i,c,"name",j.name,j,null),Lr(i,c,"formEncType",j.formEncType,j,null),Lr(i,c,"formMethod",j.formMethod,j,null),Lr(i,c,"formTarget",j.formTarget,j,null)):(Lr(i,c,"encType",j.encType,j,null),Lr(i,c,"method",j.method,j,null),Lr(i,c,"target",j.target,j,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=wf(""+p),i.setAttribute(f,p);break;case"onClick":p!=null&&(i.onclick=Jn);break;case"onScroll":p!=null&&lr("scroll",i);break;case"onScrollEnd":p!=null&&lr("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(s(61));if(f=p.__html,f!=null){if(j.children!=null)throw Error(s(60));i.innerHTML=f}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}f=wf(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""+p):i.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""):i.removeAttribute(f);break;case"capture":case"download":p===!0?i.setAttribute(f,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,p):i.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(f,p):i.removeAttribute(f);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(f):i.setAttribute(f,p);break;case"popover":lr("beforetoggle",i),lr("toggle",i),Zs(i,"popover",p);break;case"xlinkActuate":Yn(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Yn(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Yn(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Yn(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Yn(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Yn(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Yn(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Yn(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Yn(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Zs(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=h6.get(f)||f,Zs(i,f,p))}}function gx(i,c,f,p,j,D){switch(f){case"style":Rb(i,p,D);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(s(61));if(f=p.__html,f!=null){if(j.children!=null)throw Error(s(60));i.innerHTML=f}}break;case"children":typeof p=="string"?Fl(i,p):(typeof p=="number"||typeof p=="bigint")&&Fl(i,""+p);break;case"onScroll":p!=null&&lr("scroll",i);break;case"onScrollEnd":p!=null&&lr("scrollend",i);break;case"onClick":p!=null&&(i.onclick=Jn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!yt.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(j=f.endsWith("Capture"),c=f.slice(2,j?f.length-7:void 0),D=i[Se]||null,D=D!=null?D[f]:null,typeof D=="function"&&i.removeEventListener(c,D,j),typeof p=="function")){typeof D!="function"&&D!==null&&(f in i?i[f]=null:i.hasAttribute(f)&&i.removeAttribute(f)),i.addEventListener(c,p,j);break e}f in i?i[f]=p:p===!0?i.setAttribute(f,""):Zs(i,f,p)}}}function zs(i,c,f){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":lr("error",i),lr("load",i);var p=!1,j=!1,D;for(D in f)if(f.hasOwnProperty(D)){var ee=f[D];if(ee!=null)switch(D){case"src":p=!0;break;case"srcSet":j=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,c));default:Lr(i,c,D,ee,f,null)}}j&&Lr(i,c,"srcSet",f.srcSet,f,null),p&&Lr(i,c,"src",f.src,f,null);return;case"input":lr("invalid",i);var ge=D=ee=j=null,Fe=null,Ve=null;for(p in f)if(f.hasOwnProperty(p)){var it=f[p];if(it!=null)switch(p){case"name":j=it;break;case"type":ee=it;break;case"checked":Fe=it;break;case"defaultChecked":Ve=it;break;case"value":D=it;break;case"defaultValue":ge=it;break;case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(s(137,c));break;default:Lr(i,c,p,it,f,null)}}jb(i,D,ge,Fe,Ve,ee,j,!1);return;case"select":lr("invalid",i),p=ee=D=null;for(j in f)if(f.hasOwnProperty(j)&&(ge=f[j],ge!=null))switch(j){case"value":D=ge;break;case"defaultValue":ee=ge;break;case"multiple":p=ge;default:Lr(i,c,j,ge,f,null)}c=D,f=ee,i.multiple=!!p,c!=null?Ol(i,!!p,c,!1):f!=null&&Ol(i,!!p,f,!0);return;case"textarea":lr("invalid",i),D=j=p=null;for(ee in f)if(f.hasOwnProperty(ee)&&(ge=f[ee],ge!=null))switch(ee){case"value":p=ge;break;case"defaultValue":j=ge;break;case"children":D=ge;break;case"dangerouslySetInnerHTML":if(ge!=null)throw Error(s(91));break;default:Lr(i,c,ee,ge,f,null)}Ab(i,p,j,D);return;case"option":for(Fe in f)f.hasOwnProperty(Fe)&&(p=f[Fe],p!=null)&&(Fe==="selected"?i.selected=p&&typeof p!="function"&&typeof p!="symbol":Lr(i,c,Fe,p,f,null));return;case"dialog":lr("beforetoggle",i),lr("toggle",i),lr("cancel",i),lr("close",i);break;case"iframe":case"object":lr("load",i);break;case"video":case"audio":for(p=0;p<$u.length;p++)lr($u[p],i);break;case"image":lr("error",i),lr("load",i);break;case"details":lr("toggle",i);break;case"embed":case"source":case"link":lr("error",i),lr("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ve in f)if(f.hasOwnProperty(Ve)&&(p=f[Ve],p!=null))switch(Ve){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,c));default:Lr(i,c,Ve,p,f,null)}return;default:if(Rm(c)){for(it in f)f.hasOwnProperty(it)&&(p=f[it],p!==void 0&&gx(i,c,it,p,f,void 0));return}}for(ge in f)f.hasOwnProperty(ge)&&(p=f[ge],p!=null&&Lr(i,c,ge,p,f,null))}function UA(i,c,f,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var j=null,D=null,ee=null,ge=null,Fe=null,Ve=null,it=null;for(Qe in f){var ut=f[Qe];if(f.hasOwnProperty(Qe)&&ut!=null)switch(Qe){case"checked":break;case"value":break;case"defaultValue":Fe=ut;default:p.hasOwnProperty(Qe)||Lr(i,c,Qe,null,p,ut)}}for(var Xe in p){var Qe=p[Xe];if(ut=f[Xe],p.hasOwnProperty(Xe)&&(Qe!=null||ut!=null))switch(Xe){case"type":D=Qe;break;case"name":j=Qe;break;case"checked":Ve=Qe;break;case"defaultChecked":it=Qe;break;case"value":ee=Qe;break;case"defaultValue":ge=Qe;break;case"children":case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(s(137,c));break;default:Qe!==ut&&Lr(i,c,Xe,Qe,p,ut)}}Am(i,ee,ge,Fe,Ve,it,D,j);return;case"select":Qe=ee=ge=Xe=null;for(D in f)if(Fe=f[D],f.hasOwnProperty(D)&&Fe!=null)switch(D){case"value":break;case"multiple":Qe=Fe;default:p.hasOwnProperty(D)||Lr(i,c,D,null,p,Fe)}for(j in p)if(D=p[j],Fe=f[j],p.hasOwnProperty(j)&&(D!=null||Fe!=null))switch(j){case"value":Xe=D;break;case"defaultValue":ge=D;break;case"multiple":ee=D;default:D!==Fe&&Lr(i,c,j,D,p,Fe)}c=ge,f=ee,p=Qe,Xe!=null?Ol(i,!!f,Xe,!1):!!p!=!!f&&(c!=null?Ol(i,!!f,c,!0):Ol(i,!!f,f?[]:"",!1));return;case"textarea":Qe=Xe=null;for(ge in f)if(j=f[ge],f.hasOwnProperty(ge)&&j!=null&&!p.hasOwnProperty(ge))switch(ge){case"value":break;case"children":break;default:Lr(i,c,ge,null,p,j)}for(ee in p)if(j=p[ee],D=f[ee],p.hasOwnProperty(ee)&&(j!=null||D!=null))switch(ee){case"value":Xe=j;break;case"defaultValue":Qe=j;break;case"children":break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(91));break;default:j!==D&&Lr(i,c,ee,j,p,D)}Tb(i,Xe,Qe);return;case"option":for(var Ot in f)Xe=f[Ot],f.hasOwnProperty(Ot)&&Xe!=null&&!p.hasOwnProperty(Ot)&&(Ot==="selected"?i.selected=!1:Lr(i,c,Ot,null,p,Xe));for(Fe in p)Xe=p[Fe],Qe=f[Fe],p.hasOwnProperty(Fe)&&Xe!==Qe&&(Xe!=null||Qe!=null)&&(Fe==="selected"?i.selected=Xe&&typeof Xe!="function"&&typeof Xe!="symbol":Lr(i,c,Fe,Xe,p,Qe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $t in f)Xe=f[$t],f.hasOwnProperty($t)&&Xe!=null&&!p.hasOwnProperty($t)&&Lr(i,c,$t,null,p,Xe);for(Ve in p)if(Xe=p[Ve],Qe=f[Ve],p.hasOwnProperty(Ve)&&Xe!==Qe&&(Xe!=null||Qe!=null))switch(Ve){case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(s(137,c));break;default:Lr(i,c,Ve,Xe,p,Qe)}return;default:if(Rm(c)){for(var Ir in f)Xe=f[Ir],f.hasOwnProperty(Ir)&&Xe!==void 0&&!p.hasOwnProperty(Ir)&&gx(i,c,Ir,void 0,p,Xe);for(it in p)Xe=p[it],Qe=f[it],!p.hasOwnProperty(it)||Xe===Qe||Xe===void 0&&Qe===void 0||gx(i,c,it,Xe,p,Qe);return}}for(var ze in f)Xe=f[ze],f.hasOwnProperty(ze)&&Xe!=null&&!p.hasOwnProperty(ze)&&Lr(i,c,ze,null,p,Xe);for(ut in p)Xe=p[ut],Qe=f[ut],!p.hasOwnProperty(ut)||Xe===Qe||Xe==null&&Qe==null||Lr(i,c,ut,Xe,p,Qe)}function D2(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function zA(){if(typeof performance.getEntriesByType=="function"){for(var i=0,c=0,f=performance.getEntriesByType("resource"),p=0;p<f.length;p++){var j=f[p],D=j.transferSize,ee=j.initiatorType,ge=j.duration;if(D&&ge&&D2(ee)){for(ee=0,ge=j.responseEnd,p+=1;p<f.length;p++){var Fe=f[p],Ve=Fe.startTime;if(Ve>ge)break;var it=Fe.transferSize,ut=Fe.initiatorType;it&&D2(ut)&&(Fe=Fe.responseEnd,ee+=it*(Fe<ge?1:(ge-Ve)/(Fe-Ve)))}if(--p,c+=8*(D+ee)/(j.duration/1e3),i++,10<i)break}}if(0<i)return c/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var yx=null,vx=null;function xh(i){return i.nodeType===9?i:i.ownerDocument}function O2(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function F2(i,c){if(i===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&c==="foreignObject"?0:i}function bx(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var wx=null;function $A(){var i=window.event;return i&&i.type==="popstate"?i===wx?!1:(wx=i,!0):(wx=null,!1)}var L2=typeof setTimeout=="function"?setTimeout:void 0,qA=typeof clearTimeout=="function"?clearTimeout:void 0,I2=typeof Promise=="function"?Promise:void 0,HA=typeof queueMicrotask=="function"?queueMicrotask:typeof I2<"u"?function(i){return I2.resolve(null).then(i).catch(WA)}:L2;function WA(i){setTimeout(function(){throw i})}function Qi(i){return i==="head"}function M2(i,c){var f=c,p=0;do{var j=f.nextSibling;if(i.removeChild(f),j&&j.nodeType===8)if(f=j.data,f==="/$"||f==="/&"){if(p===0){i.removeChild(j),dc(c);return}p--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")p++;else if(f==="html")Hu(i.ownerDocument.documentElement);else if(f==="head"){f=i.ownerDocument.head,Hu(f);for(var D=f.firstChild;D;){var ee=D.nextSibling,ge=D.nodeName;D[Ke]||ge==="SCRIPT"||ge==="STYLE"||ge==="LINK"&&D.rel.toLowerCase()==="stylesheet"||f.removeChild(D),D=ee}}else f==="body"&&Hu(i.ownerDocument.body);f=j}while(f);dc(c)}function B2(i,c){var f=i;i=0;do{var p=f.nextSibling;if(f.nodeType===1?c?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(c?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),p&&p.nodeType===8)if(f=p.data,f==="/$"){if(i===0)break;i--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||i++;f=p}while(f)}function _x(i){var c=i.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var f=c;switch(c=c.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":_x(f),ht(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}i.removeChild(f)}}function GA(i,c,f,p){for(;i.nodeType===1;){var j=f;if(i.nodeName.toLowerCase()!==c.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Ke])switch(c){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(D=i.getAttribute("rel"),D==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(D!==j.rel||i.getAttribute("href")!==(j.href==null||j.href===""?null:j.href)||i.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin)||i.getAttribute("title")!==(j.title==null?null:j.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(D=i.getAttribute("src"),(D!==(j.src==null?null:j.src)||i.getAttribute("type")!==(j.type==null?null:j.type)||i.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin))&&D&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(c==="input"&&i.type==="hidden"){var D=j.name==null?null:""+j.name;if(j.type==="hidden"&&i.getAttribute("name")===D)return i}else return i;if(i=rn(i.nextSibling),i===null)break}return null}function VA(i,c,f){if(c==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!f||(i=rn(i.nextSibling),i===null))return null;return i}function P2(i,c){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=rn(i.nextSibling),i===null))return null;return i}function Nx(i){return i.data==="$?"||i.data==="$~"}function kx(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function KA(i,c){var f=i.ownerDocument;if(i.data==="$~")i._reactRetry=c;else if(i.data!=="$?"||f.readyState!=="loading")c();else{var p=function(){c(),f.removeEventListener("DOMContentLoaded",p)};f.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function rn(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return i}var Sx=null;function U2(i){i=i.nextSibling;for(var c=0;i;){if(i.nodeType===8){var f=i.data;if(f==="/$"||f==="/&"){if(c===0)return rn(i.nextSibling);c--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||c++}i=i.nextSibling}return null}function z2(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(c===0)return i;c--}else f!=="/$"&&f!=="/&"||c++}i=i.previousSibling}return null}function $2(i,c,f){switch(c=xh(f),i){case"html":if(i=c.documentElement,!i)throw Error(s(452));return i;case"head":if(i=c.head,!i)throw Error(s(453));return i;case"body":if(i=c.body,!i)throw Error(s(454));return i;default:throw Error(s(451))}}function Hu(i){for(var c=i.attributes;c.length;)i.removeAttributeNode(c[0]);ht(i)}var sn=new Map,q2=new Set;function gh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var hi=re.d;re.d={f:XA,r:YA,D:JA,C:ZA,L:QA,m:eC,X:rC,S:tC,M:sC};function XA(){var i=hi.f(),c=lh();return i||c}function YA(i){var c=Et(i);c!==null&&c.tag===5&&c.type==="form"?i_(c):hi.r(i)}var lc=typeof document>"u"?null:document;function H2(i,c,f){var p=lc;if(p&&typeof c=="string"&&c){var j=Xa(c);j='link[rel="'+i+'"][href="'+j+'"]',typeof f=="string"&&(j+='[crossorigin="'+f+'"]'),q2.has(j)||(q2.add(j),i={rel:i,crossOrigin:f,href:c},p.querySelector(j)===null&&(c=p.createElement("link"),zs(c,"link",i),Ie(c),p.head.appendChild(c)))}}function JA(i){hi.D(i),H2("dns-prefetch",i,null)}function ZA(i,c){hi.C(i,c),H2("preconnect",i,c)}function QA(i,c,f){hi.L(i,c,f);var p=lc;if(p&&i&&c){var j='link[rel="preload"][as="'+Xa(c)+'"]';c==="image"&&f&&f.imageSrcSet?(j+='[imagesrcset="'+Xa(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(j+='[imagesizes="'+Xa(f.imageSizes)+'"]')):j+='[href="'+Xa(i)+'"]';var D=j;switch(c){case"style":D=cc(i);break;case"script":D=uc(i)}sn.has(D)||(i=x({rel:"preload",href:c==="image"&&f&&f.imageSrcSet?void 0:i,as:c},f),sn.set(D,i),p.querySelector(j)!==null||c==="style"&&p.querySelector(Wu(D))||c==="script"&&p.querySelector(Gu(D))||(c=p.createElement("link"),zs(c,"link",i),Ie(c),p.head.appendChild(c)))}}function eC(i,c){hi.m(i,c);var f=lc;if(f&&i){var p=c&&typeof c.as=="string"?c.as:"script",j='link[rel="modulepreload"][as="'+Xa(p)+'"][href="'+Xa(i)+'"]',D=j;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=uc(i)}if(!sn.has(D)&&(i=x({rel:"modulepreload",href:i},c),sn.set(D,i),f.querySelector(j)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Gu(D)))return}p=f.createElement("link"),zs(p,"link",i),Ie(p),f.head.appendChild(p)}}}function tC(i,c,f){hi.S(i,c,f);var p=lc;if(p&&i){var j=pe(p).hoistableStyles,D=cc(i);c=c||"default";var ee=j.get(D);if(!ee){var ge={loading:0,preload:null};if(ee=p.querySelector(Wu(D)))ge.loading=5;else{i=x({rel:"stylesheet",href:i,"data-precedence":c},f),(f=sn.get(D))&&Ex(i,f);var Fe=ee=p.createElement("link");Ie(Fe),zs(Fe,"link",i),Fe._p=new Promise(function(Ve,it){Fe.onload=Ve,Fe.onerror=it}),Fe.addEventListener("load",function(){ge.loading|=1}),Fe.addEventListener("error",function(){ge.loading|=2}),ge.loading|=4,yh(ee,c,p)}ee={type:"stylesheet",instance:ee,count:1,state:ge},j.set(D,ee)}}}function rC(i,c){hi.X(i,c);var f=lc;if(f&&i){var p=pe(f).hoistableScripts,j=uc(i),D=p.get(j);D||(D=f.querySelector(Gu(j)),D||(i=x({src:i,async:!0},c),(c=sn.get(j))&&jx(i,c),D=f.createElement("script"),Ie(D),zs(D,"link",i),f.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},p.set(j,D))}}function sC(i,c){hi.M(i,c);var f=lc;if(f&&i){var p=pe(f).hoistableScripts,j=uc(i),D=p.get(j);D||(D=f.querySelector(Gu(j)),D||(i=x({src:i,async:!0,type:"module"},c),(c=sn.get(j))&&jx(i,c),D=f.createElement("script"),Ie(D),zs(D,"link",i),f.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},p.set(j,D))}}function W2(i,c,f,p){var j=(j=se.current)?gh(j):null;if(!j)throw Error(s(446));switch(i){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(c=cc(f.href),f=pe(j).hoistableStyles,p=f.get(c),p||(p={type:"style",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){i=cc(f.href);var D=pe(j).hoistableStyles,ee=D.get(i);if(ee||(j=j.ownerDocument||j,ee={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(i,ee),(D=j.querySelector(Wu(i)))&&!D._p&&(ee.instance=D,ee.state.loading=5),sn.has(i)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},sn.set(i,f),D||aC(j,i,f,ee.state))),c&&p===null)throw Error(s(528,""));return ee}if(c&&p!==null)throw Error(s(529,""));return null;case"script":return c=f.async,f=f.src,typeof f=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=uc(f),f=pe(j).hoistableScripts,p=f.get(c),p||(p={type:"script",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,i))}}function cc(i){return'href="'+Xa(i)+'"'}function Wu(i){return'link[rel="stylesheet"]['+i+"]"}function G2(i){return x({},i,{"data-precedence":i.precedence,precedence:null})}function aC(i,c,f,p){i.querySelector('link[rel="preload"][as="style"]['+c+"]")?p.loading=1:(c=i.createElement("link"),p.preload=c,c.addEventListener("load",function(){return p.loading|=1}),c.addEventListener("error",function(){return p.loading|=2}),zs(c,"link",f),Ie(c),i.head.appendChild(c))}function uc(i){return'[src="'+Xa(i)+'"]'}function Gu(i){return"script[async]"+i}function V2(i,c,f){if(c.count++,c.instance===null)switch(c.type){case"style":var p=i.querySelector('style[data-href~="'+Xa(f.href)+'"]');if(p)return c.instance=p,Ie(p),p;var j=x({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Ie(p),zs(p,"style",j),yh(p,f.precedence,i),c.instance=p;case"stylesheet":j=cc(f.href);var D=i.querySelector(Wu(j));if(D)return c.state.loading|=4,c.instance=D,Ie(D),D;p=G2(f),(j=sn.get(j))&&Ex(p,j),D=(i.ownerDocument||i).createElement("link"),Ie(D);var ee=D;return ee._p=new Promise(function(ge,Fe){ee.onload=ge,ee.onerror=Fe}),zs(D,"link",p),c.state.loading|=4,yh(D,f.precedence,i),c.instance=D;case"script":return D=uc(f.src),(j=i.querySelector(Gu(D)))?(c.instance=j,Ie(j),j):(p=f,(j=sn.get(D))&&(p=x({},f),jx(p,j)),i=i.ownerDocument||i,j=i.createElement("script"),Ie(j),zs(j,"link",p),i.head.appendChild(j),c.instance=j);case"void":return null;default:throw Error(s(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(p=c.instance,c.state.loading|=4,yh(p,f.precedence,i));return c.instance}function yh(i,c,f){for(var p=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),j=p.length?p[p.length-1]:null,D=j,ee=0;ee<p.length;ee++){var ge=p[ee];if(ge.dataset.precedence===c)D=ge;else if(D!==j)break}D?D.parentNode.insertBefore(i,D.nextSibling):(c=f.nodeType===9?f.head:f,c.insertBefore(i,c.firstChild))}function Ex(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.title==null&&(i.title=c.title)}function jx(i,c){i.crossOrigin==null&&(i.crossOrigin=c.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=c.referrerPolicy),i.integrity==null&&(i.integrity=c.integrity)}var vh=null;function K2(i,c,f){if(vh===null){var p=new Map,j=vh=new Map;j.set(f,p)}else j=vh,p=j.get(f),p||(p=new Map,j.set(f,p));if(p.has(i))return p;for(p.set(i,null),f=f.getElementsByTagName(i),j=0;j<f.length;j++){var D=f[j];if(!(D[Ke]||D[be]||i==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var ee=D.getAttribute(c)||"";ee=i+ee;var ge=p.get(ee);ge?ge.push(D):p.set(ee,[D])}}return p}function X2(i,c,f){i=i.ownerDocument||i,i.head.insertBefore(f,c==="title"?i.querySelector("head > title"):null)}function nC(i,c,f){if(f===1||c.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;return c.rel==="stylesheet"?(i=c.disabled,typeof c.precedence=="string"&&i==null):!0;case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function Y2(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function iC(i,c,f,p){if(f.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var j=cc(p.href),D=c.querySelector(Wu(j));if(D){c=D._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(i.count++,i=bh.bind(i),c.then(i,i)),f.state.loading|=4,f.instance=D,Ie(D);return}D=c.ownerDocument||c,p=G2(p),(j=sn.get(j))&&Ex(p,j),D=D.createElement("link"),Ie(D);var ee=D;ee._p=new Promise(function(ge,Fe){ee.onload=ge,ee.onerror=Fe}),zs(D,"link",p),f.instance=D}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(f,c),(c=f.state.preload)&&(f.state.loading&3)===0&&(i.count++,f=bh.bind(i),c.addEventListener("load",f),c.addEventListener("error",f))}}var Tx=0;function oC(i,c){return i.stylesheets&&i.count===0&&_h(i,i.stylesheets),0<i.count||0<i.imgCount?function(f){var p=setTimeout(function(){if(i.stylesheets&&_h(i,i.stylesheets),i.unsuspend){var D=i.unsuspend;i.unsuspend=null,D()}},6e4+c);0<i.imgBytes&&Tx===0&&(Tx=62500*zA());var j=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&_h(i,i.stylesheets),i.unsuspend)){var D=i.unsuspend;i.unsuspend=null,D()}},(i.imgBytes>Tx?50:800)+c);return i.unsuspend=f,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(j)}}:null}function bh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)_h(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var wh=null;function _h(i,c){i.stylesheets=null,i.unsuspend!==null&&(i.count++,wh=new Map,c.forEach(lC,i),wh=null,bh.call(i))}function lC(i,c){if(!(c.state.loading&4)){var f=wh.get(i);if(f)var p=f.get(null);else{f=new Map,wh.set(i,f);for(var j=i.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<j.length;D++){var ee=j[D];(ee.nodeName==="LINK"||ee.getAttribute("media")!=="not all")&&(f.set(ee.dataset.precedence,ee),p=ee)}p&&f.set(null,p)}j=c.instance,ee=j.getAttribute("data-precedence"),D=f.get(ee)||p,D===p&&f.set(null,j),f.set(ee,j),this.count++,p=bh.bind(this),j.addEventListener("load",p),j.addEventListener("error",p),D?D.parentNode.insertBefore(j,D.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(j,i.firstChild)),c.state.loading|=4}}var Vu={$$typeof:N,Provider:null,Consumer:null,_currentValue:ve,_currentValue2:ve,_threadCount:0};function cC(i,c,f,p,j,D,ee,ge,Fe){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Nt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nt(0),this.hiddenUpdates=Nt(null),this.identifierPrefix=p,this.onUncaughtError=j,this.onCaughtError=D,this.onRecoverableError=ee,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Fe,this.incompleteTransitions=new Map}function J2(i,c,f,p,j,D,ee,ge,Fe,Ve,it,ut){return i=new cC(i,c,f,ee,Fe,Ve,it,ut,ge),c=1,D===!0&&(c|=24),D=Ca(3,null,null,c),i.current=D,D.stateNode=i,c=op(),c.refCount++,i.pooledCache=c,c.refCount++,D.memoizedState={element:p,isDehydrated:f,cache:c},dp(D),i}function Z2(i){return i?(i=zl,i):zl}function Q2(i,c,f,p,j,D){j=Z2(j),p.context===null?p.context=j:p.pendingContext=j,p=$i(c),p.payload={element:f},D=D===void 0?null:D,D!==null&&(p.callback=D),f=qi(i,p,c),f!==null&&(_a(f,i,c),Su(f,i,c))}function eN(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<c?f:c}}function Ax(i,c){eN(i,c),(i=i.alternate)&&eN(i,c)}function tN(i){if(i.tag===13||i.tag===31){var c=Ao(i,67108864);c!==null&&_a(c,i,67108864),Ax(i,67108864)}}function rN(i){if(i.tag===13||i.tag===31){var c=La();c=Sr(c);var f=Ao(i,c);f!==null&&_a(f,i,c),Ax(i,c)}}var Nh=!0;function uC(i,c,f,p){var j=Q.T;Q.T=null;var D=re.p;try{re.p=2,Cx(i,c,f,p)}finally{re.p=D,Q.T=j}}function dC(i,c,f,p){var j=Q.T;Q.T=null;var D=re.p;try{re.p=8,Cx(i,c,f,p)}finally{re.p=D,Q.T=j}}function Cx(i,c,f,p){if(Nh){var j=Rx(p);if(j===null)xx(i,c,p,kh,f),aN(i,p);else if(hC(j,i,c,f,p))p.stopPropagation();else if(aN(i,p),c&4&&-1<fC.indexOf(i)){for(;j!==null;){var D=Et(j);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var ee=fe(D.pendingLanes);if(ee!==0){var ge=D;for(ge.pendingLanes|=2,ge.entangledLanes|=2;ee;){var Fe=1<<31-Le(ee);ge.entanglements[1]|=Fe,ee&=~Fe}Fn(D),(Nr&6)===0&&(ih=Me()+500,zu(0))}}break;case 31:case 13:ge=Ao(D,2),ge!==null&&_a(ge,D,2),lh(),Ax(D,2)}if(D=Rx(p),D===null&&xx(i,c,p,kh,f),D===j)break;j=D}j!==null&&p.stopPropagation()}else xx(i,c,p,null,f)}}function Rx(i){return i=Om(i),Dx(i)}var kh=null;function Dx(i){if(kh=null,i=bt(i),i!==null){var c=o(i);if(c===null)i=null;else{var f=c.tag;if(f===13){if(i=l(c),i!==null)return i;i=null}else if(f===31){if(i=u(c),i!==null)return i;i=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null)}}return kh=i,null}function sN(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ee()){case Ce:return 2;case Je:return 8;case $e:case tt:return 32;case De:return 268435456;default:return 32}default:return 32}}var Ox=!1,eo=null,to=null,ro=null,Ku=new Map,Xu=new Map,so=[],fC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function aN(i,c){switch(i){case"focusin":case"focusout":eo=null;break;case"dragenter":case"dragleave":to=null;break;case"mouseover":case"mouseout":ro=null;break;case"pointerover":case"pointerout":Ku.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xu.delete(c.pointerId)}}function Yu(i,c,f,p,j,D){return i===null||i.nativeEvent!==D?(i={blockedOn:c,domEventName:f,eventSystemFlags:p,nativeEvent:D,targetContainers:[j]},c!==null&&(c=Et(c),c!==null&&tN(c)),i):(i.eventSystemFlags|=p,c=i.targetContainers,j!==null&&c.indexOf(j)===-1&&c.push(j),i)}function hC(i,c,f,p,j){switch(c){case"focusin":return eo=Yu(eo,i,c,f,p,j),!0;case"dragenter":return to=Yu(to,i,c,f,p,j),!0;case"mouseover":return ro=Yu(ro,i,c,f,p,j),!0;case"pointerover":var D=j.pointerId;return Ku.set(D,Yu(Ku.get(D)||null,i,c,f,p,j)),!0;case"gotpointercapture":return D=j.pointerId,Xu.set(D,Yu(Xu.get(D)||null,i,c,f,p,j)),!0}return!1}function nN(i){var c=bt(i.target);if(c!==null){var f=o(c);if(f!==null){if(c=f.tag,c===13){if(c=l(f),c!==null){i.blockedOn=c,we(i.priority,function(){rN(f)});return}}else if(c===31){if(c=u(f),c!==null){i.blockedOn=c,we(i.priority,function(){rN(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Sh(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var f=Rx(i.nativeEvent);if(f===null){f=i.nativeEvent;var p=new f.constructor(f.type,f);Dm=p,f.target.dispatchEvent(p),Dm=null}else return c=Et(f),c!==null&&tN(c),i.blockedOn=f,!1;c.shift()}return!0}function iN(i,c,f){Sh(i)&&f.delete(c)}function mC(){Ox=!1,eo!==null&&Sh(eo)&&(eo=null),to!==null&&Sh(to)&&(to=null),ro!==null&&Sh(ro)&&(ro=null),Ku.forEach(iN),Xu.forEach(iN)}function Eh(i,c){i.blockedOn===c&&(i.blockedOn=null,Ox||(Ox=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,mC)))}var jh=null;function oN(i){jh!==i&&(jh=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){jh===i&&(jh=null);for(var c=0;c<i.length;c+=3){var f=i[c],p=i[c+1],j=i[c+2];if(typeof p!="function"){if(Dx(p||f)===null)continue;break}var D=Et(f);D!==null&&(i.splice(c,3),c-=3,Rp(D,{pending:!0,data:j,method:f.method,action:p},p,j))}}))}function dc(i){function c(Fe){return Eh(Fe,i)}eo!==null&&Eh(eo,i),to!==null&&Eh(to,i),ro!==null&&Eh(ro,i),Ku.forEach(c),Xu.forEach(c);for(var f=0;f<so.length;f++){var p=so[f];p.blockedOn===i&&(p.blockedOn=null)}for(;0<so.length&&(f=so[0],f.blockedOn===null);)nN(f),f.blockedOn===null&&so.shift();if(f=(i.ownerDocument||i).$$reactFormReplay,f!=null)for(p=0;p<f.length;p+=3){var j=f[p],D=f[p+1],ee=j[Se]||null;if(typeof D=="function")ee||oN(f);else if(ee){var ge=null;if(D&&D.hasAttribute("formAction")){if(j=D,ee=D[Se]||null)ge=ee.formAction;else if(Dx(j)!==null)continue}else ge=ee.action;typeof ge=="function"?f[p+1]=ge:(f.splice(p,3),p-=3),oN(f)}}}function lN(){function i(D){D.canIntercept&&D.info==="react-transition"&&D.intercept({handler:function(){return new Promise(function(ee){return j=ee})},focusReset:"manual",scroll:"manual"})}function c(){j!==null&&(j(),j=null),p||setTimeout(f,20)}function f(){if(!p&&!navigation.transition){var D=navigation.currentEntry;D&&D.url!=null&&navigation.navigate(D.url,{state:D.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,j=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(f,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),j!==null&&(j(),j=null)}}}function Fx(i){this._internalRoot=i}Th.prototype.render=Fx.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(s(409));var f=c.current,p=La();Q2(f,p,i,c,null,null)},Th.prototype.unmount=Fx.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;Q2(i.current,2,null,i,null,null),lh(),c[Te]=null}};function Th(i){this._internalRoot=i}Th.prototype.unstable_scheduleHydration=function(i){if(i){var c=he();i={blockedOn:null,target:i,priority:c};for(var f=0;f<so.length&&c!==0&&c<so[f].priority;f++);so.splice(f,0,i),f===0&&nN(i)}};var cN=t.version;if(cN!=="19.2.3")throw Error(s(527,cN,"19.2.3"));re.findDOMNode=function(i){var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(s(188)):(i=Object.keys(i).join(","),Error(s(268,i)));return i=h(c),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var pC={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ah.isDisabled&&Ah.supportsFiber)try{vt=Ah.inject(pC),At=Ah}catch{}}return Zu.createRoot=function(i,c){if(!n(i))throw Error(s(299));var f=!1,p="",j=x_,D=g_,ee=y_;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(j=c.onUncaughtError),c.onCaughtError!==void 0&&(D=c.onCaughtError),c.onRecoverableError!==void 0&&(ee=c.onRecoverableError)),c=J2(i,1,!1,null,null,f,p,null,j,D,ee,lN),i[Te]=c.current,px(i),new Fx(c)},Zu.hydrateRoot=function(i,c,f){if(!n(i))throw Error(s(299));var p=!1,j="",D=x_,ee=g_,ge=y_,Fe=null;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(j=f.identifierPrefix),f.onUncaughtError!==void 0&&(D=f.onUncaughtError),f.onCaughtError!==void 0&&(ee=f.onCaughtError),f.onRecoverableError!==void 0&&(ge=f.onRecoverableError),f.formState!==void 0&&(Fe=f.formState)),c=J2(i,1,!0,c,f??null,p,j,Fe,D,ee,ge,lN),c.context=Z2(null),f=c.current,p=La(),p=Sr(p),j=$i(p),j.callback=null,qi(f,j,p),f=p,c.current.lanes=f,Vt(c,f),Fn(c),i[Te]=c.current,px(i),new Th(c)},Zu.version="19.2.3",Zu}var bN;function TC(){if(bN)return Mx.exports;bN=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Mx.exports=jC(),Mx.exports}var AC=TC();var qc;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(qc||(qc={}));class zx extends Error{constructor(t,r,s){super(t),this.message=t,this.code=r,this.data=s}}const CC=e=>{var t,r;return e?.androidBridge?"android":!((r=(t=e?.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},RC=e=>{const t=e.CapacitorCustomPlatform||null,r=e.Capacitor||{},s=r.Plugins=r.Plugins||{},n=()=>t!==null?t.name:CC(e),o=()=>n()!=="web",l=x=>{const y=h.get(x);return!!(y?.platforms.has(n())||u(x))},u=x=>{var y;return(y=r.PluginHeaders)===null||y===void 0?void 0:y.find(b=>b.name===x)},d=x=>e.console.error(x),h=new Map,m=(x,y={})=>{const b=h.get(x);if(b)return console.warn(`Capacitor plugin "${x}" already registered. Cannot register plugins twice.`),b.proxy;const v=n(),g=u(x);let _;const w=async()=>(!_&&v in y?_=typeof y[v]=="function"?_=await y[v]():_=y[v]:t!==null&&!_&&"web"in y&&(_=typeof y.web=="function"?_=await y.web():_=y.web),_),S=(B,L)=>{var H,ue;if(g){const A=g?.methods.find(Y=>L===Y.name);if(A)return A.rtype==="promise"?Y=>r.nativePromise(x,L.toString(),Y):(Y,I)=>r.nativeCallback(x,L.toString(),Y,I);if(B)return(H=B[L])===null||H===void 0?void 0:H.bind(B)}else{if(B)return(ue=B[L])===null||ue===void 0?void 0:ue.bind(B);throw new zx(`"${x}" plugin is not implemented on ${v}`,qc.Unimplemented)}},N=B=>{let L;const H=(...ue)=>{const A=w().then(Y=>{const I=S(Y,B);if(I){const ae=I(...ue);return L=ae?.remove,ae}else throw new zx(`"${x}.${B}()" is not implemented on ${v}`,qc.Unimplemented)});return B==="addListener"&&(A.remove=async()=>L()),A};return H.toString=()=>`${B.toString()}() { [capacitor code] }`,Object.defineProperty(H,"name",{value:B,writable:!1,configurable:!1}),H},E=N("addListener"),C=N("removeListener"),F=(B,L)=>{const H=E({eventName:B},L),ue=async()=>{const Y=await H;C({eventName:B,callbackId:Y},L)},A=new Promise(Y=>H.then(()=>Y({remove:ue})));return A.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await ue()},A},O=new Proxy({},{get(B,L){switch(L){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return g?F:E;case"removeListener":return C;default:return N(L)}}});return s[x]=O,h.set(x,{name:x,proxy:O,platforms:new Set([...Object.keys(y),...g?[v]:[]])}),O};return r.convertFileSrc||(r.convertFileSrc=x=>x),r.getPlatform=n,r.handleError=d,r.isNativePlatform=o,r.isPluginAvailable=l,r.registerPlugin=m,r.Exception=zx,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},DC=e=>e.Capacitor=RC(e),S0=DC(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),av=S0.registerPlugin;class nv{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,r){let s=!1;this.listeners[t]||(this.listeners[t]=[],s=!0),this.listeners[t].push(r);const o=this.windowListeners[t];o&&!o.registered&&this.addWindowListener(o),s&&this.sendRetainedArgumentsForEvent(t);const l=async()=>this.removeListener(t,r);return Promise.resolve({remove:l})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,r,s){const n=this.listeners[t];if(!n){if(s){let o=this.retainedEventArguments[t];o||(o=[]),o.push(r),this.retainedEventArguments[t]=o}return}n.forEach(o=>o(r))}hasListeners(t){var r;return!!(!((r=this.listeners[t])===null||r===void 0)&&r.length)}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:s=>{this.notifyListeners(r,s)}}}unimplemented(t="not implemented"){return new S0.Exception(t,qc.Unimplemented)}unavailable(t="not available"){return new S0.Exception(t,qc.Unavailable)}async removeListener(t,r){const s=this.listeners[t];if(!s)return;const n=s.indexOf(r);this.listeners[t].splice(n,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const r=this.retainedEventArguments[t];r&&(delete this.retainedEventArguments[t],r.forEach(s=>{this.notifyListeners(t,s)}))}}const wN=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),_N=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class OC extends nv{async getCookies(){const t=document.cookie,r={};return t.split(";").forEach(s=>{if(s.length<=0)return;let[n,o]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=_N(n).trim(),o=_N(o).trim(),r[n]=o}),r}async setCookie(t){try{const r=wN(t.key),s=wN(t.value),n=`; expires=${(t.expires||"").replace("expires=","")}`,o=(t.path||"/").replace("path=",""),l=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${s||""}${n}; path=${o}; ${l};`}catch(r){return Promise.reject(r)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}av("CapacitorCookies",{web:()=>new OC});const FC=async e=>new Promise((t,r)=>{const s=new FileReader;s.onload=()=>{const n=s.result;t(n.indexOf(",")>=0?n.split(",")[1]:n)},s.onerror=n=>r(n),s.readAsDataURL(e)}),LC=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(n=>n.toLocaleLowerCase()).reduce((n,o,l)=>(n[o]=e[t[l]],n),{})},IC=(e,t=!0)=>e?Object.entries(e).reduce((s,n)=>{const[o,l]=n;let u,d;return Array.isArray(l)?(d="",l.forEach(h=>{u=t?encodeURIComponent(h):h,d+=`${o}=${u}&`}),d.slice(0,-1)):(u=t?encodeURIComponent(l):l,d=`${o}=${u}`),`${s}&${d}`},"").substr(1):null,MC=(e,t={})=>{const r=Object.assign({method:e.method||"GET",headers:e.headers},t),n=LC(e.headers)["content-type"]||"";if(typeof e.data=="string")r.body=e.data;else if(n.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[l,u]of Object.entries(e.data||{}))o.set(l,u);r.body=o.toString()}else if(n.includes("multipart/form-data")||e.data instanceof FormData){const o=new FormData;if(e.data instanceof FormData)e.data.forEach((u,d)=>{o.append(d,u)});else for(const u of Object.keys(e.data))o.append(u,e.data[u]);r.body=o;const l=new Headers(r.headers);l.delete("content-type"),r.headers=l}else(n.includes("application/json")||typeof e.data=="object")&&(r.body=JSON.stringify(e.data));return r};class BC extends nv{async request(t){const r=MC(t,t.webFetchExtra),s=IC(t.params,t.shouldEncodeUrlParams),n=s?`${t.url}?${s}`:t.url,o=await fetch(n,r),l=o.headers.get("content-type")||"";let{responseType:u="text"}=o.ok?t:{};l.includes("application/json")&&(u="json");let d,h;switch(u){case"arraybuffer":case"blob":h=await o.blob(),d=await FC(h);break;case"json":d=await o.json();break;default:d=await o.text()}const m={};return o.headers.forEach((x,y)=>{m[y]=x}),{data:d,headers:m,status:o.status,url:o.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}av("CapacitorHttp",{web:()=>new BC});var NN;(function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"})(NN||(NN={}));var kN;(function(e){e.StatusBar="StatusBar",e.NavigationBar="NavigationBar"})(kN||(kN={}));class PC extends nv{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}av("SystemBars",{web:()=>new PC});var SN="popstate";function UC(e={}){function t(s,n){let{pathname:o,search:l,hash:u}=s.location;return xy("",{pathname:o,search:l,hash:u},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(s,n){return typeof n=="string"?n:jd(n)}return $C(t,r,null,e)}function Yr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function hn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function zC(){return Math.random().toString(36).substring(2,10)}function EN(e,t){return{usr:e.state,key:e.key,idx:t}}function xy(e,t,r=null,s){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?tu(t):t,state:r,key:t&&t.key||s||zC()}}function jd({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function tu(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let s=e.indexOf("?");s>=0&&(t.search=e.substring(s),e=e.substring(0,s)),e&&(t.pathname=e)}return t}function $C(e,t,r,s={}){let{window:n=document.defaultView,v5Compat:o=!1}=s,l=n.history,u="POP",d=null,h=m();h==null&&(h=0,l.replaceState({...l.state,idx:h},""));function m(){return(l.state||{idx:null}).idx}function x(){u="POP";let _=m(),w=_==null?null:_-h;h=_,d&&d({action:u,location:g.location,delta:w})}function y(_,w){u="PUSH";let S=xy(g.location,_,w);h=m()+1;let N=EN(S,h),E=g.createHref(S);try{l.pushState(N,"",E)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;n.location.assign(E)}o&&d&&d({action:u,location:g.location,delta:1})}function b(_,w){u="REPLACE";let S=xy(g.location,_,w);h=m();let N=EN(S,h),E=g.createHref(S);l.replaceState(N,"",E),o&&d&&d({action:u,location:g.location,delta:0})}function v(_){return qC(_)}let g={get action(){return u},get location(){return e(n,l)},listen(_){if(d)throw new Error("A history only accepts one active listener");return n.addEventListener(SN,x),d=_,()=>{n.removeEventListener(SN,x),d=null}},createHref(_){return t(n,_)},createURL:v,encodeLocation(_){let w=v(_);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:y,replace:b,go(_){return l.go(_)}};return g}function qC(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Yr(r,"No window.location.(origin|href) available to create URL");let s=typeof e=="string"?e:jd(e);return s=s.replace(/ $/,"%20"),!t&&s.startsWith("//")&&(s=r+s),new URL(s,r)}function Q3(e,t,r="/"){return HC(e,t,r,!1)}function HC(e,t,r,s){let n=typeof t=="string"?tu(t):t,o=ki(n.pathname||"/",r);if(o==null)return null;let l=eE(e);WC(l);let u=null;for(let d=0;u==null&&d<l.length;++d){let h=r8(o);u=e8(l[d],h,s)}return u}function eE(e,t=[],r=[],s="",n=!1){let o=(l,u,d=n,h)=>{let m={relativePath:h===void 0?l.path||"":h,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(s)&&d)return;Yr(m.relativePath.startsWith(s),`Absolute route path "${m.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(s.length)}let x=bi([s,m.relativePath]),y=r.concat(m);l.children&&l.children.length>0&&(Yr(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),eE(l.children,t,y,x,d)),!(l.path==null&&!l.index)&&t.push({path:x,score:ZC(x,l.index),routesMeta:y})};return e.forEach((l,u)=>{if(l.path===""||!l.path?.includes("?"))o(l,u);else for(let d of tE(l.path))o(l,u,!0,d)}),t}function tE(e){let t=e.split("/");if(t.length===0)return[];let[r,...s]=t,n=r.endsWith("?"),o=r.replace(/\?$/,"");if(s.length===0)return n?[o,""]:[o];let l=tE(s.join("/")),u=[];return u.push(...l.map(d=>d===""?o:[o,d].join("/"))),n&&u.push(...l),u.map(d=>e.startsWith("/")&&d===""?"/":d)}function WC(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:QC(t.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}var GC=/^:[\w-]+$/,VC=3,KC=2,XC=1,YC=10,JC=-2,jN=e=>e==="*";function ZC(e,t){let r=e.split("/"),s=r.length;return r.some(jN)&&(s+=JC),t&&(s+=KC),r.filter(n=>!jN(n)).reduce((n,o)=>n+(GC.test(o)?VC:o===""?XC:YC),s)}function QC(e,t){return e.length===t.length&&e.slice(0,-1).every((s,n)=>s===t[n])?e[e.length-1]-t[t.length-1]:0}function e8(e,t,r=!1){let{routesMeta:s}=e,n={},o="/",l=[];for(let u=0;u<s.length;++u){let d=s[u],h=u===s.length-1,m=o==="/"?t:t.slice(o.length)||"/",x=E0({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},m),y=d.route;if(!x&&h&&r&&!s[s.length-1].route.index&&(x=E0({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!x)return null;Object.assign(n,x.params),l.push({params:n,pathname:bi([o,x.pathname]),pathnameBase:i8(bi([o,x.pathnameBase])),route:y}),x.pathnameBase!=="/"&&(o=bi([o,x.pathnameBase]))}return l}function E0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,s]=t8(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let o=n[0],l=o.replace(/(.)\/+$/,"$1"),u=n.slice(1);return{params:s.reduce((h,{paramName:m,isOptional:x},y)=>{if(m==="*"){let v=u[y]||"";l=o.slice(0,o.length-v.length).replace(/(.)\/+$/,"$1")}const b=u[y];return x&&!b?h[m]=void 0:h[m]=(b||"").replace(/%2F/g,"/"),h},{}),pathname:o,pathnameBase:l,pattern:e}}function t8(e,t=!1,r=!0){hn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let s=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,d)=>(s.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(s.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),s]}function r8(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return hn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function ki(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=e.charAt(r);return s&&s!=="/"?null:e.slice(r)||"/"}var rE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,s8=e=>rE.test(e);function a8(e,t="/"){let{pathname:r,search:s="",hash:n=""}=typeof e=="string"?tu(e):e,o;if(r)if(s8(r))o=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),hn(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${r}`)}r.startsWith("/")?o=TN(r.substring(1),"/"):o=TN(r,t)}else o=t;return{pathname:o,search:o8(s),hash:l8(n)}}function TN(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function $x(e,t,r,s){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function n8(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function iv(e){let t=n8(e);return t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase)}function ov(e,t,r,s=!1){let n;typeof e=="string"?n=tu(e):(n={...e},Yr(!n.pathname||!n.pathname.includes("?"),$x("?","pathname","search",n)),Yr(!n.pathname||!n.pathname.includes("#"),$x("#","pathname","hash",n)),Yr(!n.search||!n.search.includes("#"),$x("#","search","hash",n)));let o=e===""||n.pathname==="",l=o?"/":n.pathname,u;if(l==null)u=r;else{let x=t.length-1;if(!s&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),x-=1;n.pathname=y.join("/")}u=x>=0?t[x]:"/"}let d=a8(n,u),h=l&&l!=="/"&&l.endsWith("/"),m=(o||l===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(h||m)&&(d.pathname+="/"),d}var bi=e=>e.join("/").replace(/\/\/+/g,"/"),i8=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),o8=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,l8=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,c8=class{constructor(e,t,r,s=!1){this.status=e,this.statusText=t||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function u8(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function d8(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var sE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function aE(e,t){let r=e;if(typeof r!="string"||!rE.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let s=r,n=!1;if(sE)try{let o=new URL(window.location.href),l=r.startsWith("//")?new URL(o.protocol+r):new URL(r),u=ki(l.pathname,t);l.origin===o.origin&&u!=null?r=u+l.search+l.hash:n=!0}catch{hn(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:n,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var nE=["POST","PUT","PATCH","DELETE"];new Set(nE);var f8=["GET",...nE];new Set(f8);var ru=K.createContext(null);ru.displayName="DataRouter";var Q0=K.createContext(null);Q0.displayName="DataRouterState";var h8=K.createContext(!1),iE=K.createContext({isTransitioning:!1});iE.displayName="ViewTransition";var m8=K.createContext(new Map);m8.displayName="Fetchers";var p8=K.createContext(null);p8.displayName="Await";var Wa=K.createContext(null);Wa.displayName="Navigation";var ef=K.createContext(null);ef.displayName="Location";var pn=K.createContext({outlet:null,matches:[],isDataRoute:!1});pn.displayName="Route";var lv=K.createContext(null);lv.displayName="RouteError";var oE="REACT_ROUTER_ERROR",x8="REDIRECT",g8="ROUTE_ERROR_RESPONSE";function y8(e){if(e.startsWith(`${oE}:${x8}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function v8(e){if(e.startsWith(`${oE}:${g8}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new c8(t.status,t.statusText,t.data)}catch{}}function b8(e,{relative:t}={}){Yr(su(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:s}=K.useContext(Wa),{hash:n,pathname:o,search:l}=tf(e,{relative:t}),u=o;return r!=="/"&&(u=o==="/"?r:bi([r,o])),s.createHref({pathname:u,search:l,hash:n})}function su(){return K.useContext(ef)!=null}function Ti(){return Yr(su(),"useLocation() may be used only in the context of a <Router> component."),K.useContext(ef).location}var lE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function cE(e){K.useContext(Wa).static||K.useLayoutEffect(e)}function au(){let{isDataRoute:e}=K.useContext(pn);return e?L8():w8()}function w8(){Yr(su(),"useNavigate() may be used only in the context of a <Router> component.");let e=K.useContext(ru),{basename:t,navigator:r}=K.useContext(Wa),{matches:s}=K.useContext(pn),{pathname:n}=Ti(),o=JSON.stringify(iv(s)),l=K.useRef(!1);return cE(()=>{l.current=!0}),K.useCallback((d,h={})=>{if(hn(l.current,lE),!l.current)return;if(typeof d=="number"){r.go(d);return}let m=ov(d,JSON.parse(o),n,h.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:bi([t,m.pathname])),(h.replace?r.replace:r.push)(m,h.state,h)},[t,r,o,n,e])}var _8=K.createContext(null);function N8(e){let t=K.useContext(pn).outlet;return K.useMemo(()=>t&&K.createElement(_8.Provider,{value:e},t),[t,e])}function uE(){let{matches:e}=K.useContext(pn),t=e[e.length-1];return t?t.params:{}}function tf(e,{relative:t}={}){let{matches:r}=K.useContext(pn),{pathname:s}=Ti(),n=JSON.stringify(iv(r));return K.useMemo(()=>ov(e,JSON.parse(n),s,t==="path"),[e,n,s,t])}function k8(e,t){return dE(e,t)}function dE(e,t,r,s,n){Yr(su(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=K.useContext(Wa),{matches:l}=K.useContext(pn),u=l[l.length-1],d=u?u.params:{},h=u?u.pathname:"/",m=u?u.pathnameBase:"/",x=u&&u.route;{let S=x&&x.path||"";hE(h,!x||S.endsWith("*")||S.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${S}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${S}"> to <Route path="${S==="/"?"*":`${S}/*`}">.`)}let y=Ti(),b;if(t){let S=typeof t=="string"?tu(t):t;Yr(m==="/"||S.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${S.pathname}" was given in the \`location\` prop.`),b=S}else b=y;let v=b.pathname||"/",g=v;if(m!=="/"){let S=m.replace(/^\//,"").split("/");g="/"+v.replace(/^\//,"").split("/").slice(S.length).join("/")}let _=Q3(e,{pathname:g});hn(x||_!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),hn(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=A8(_&&_.map(S=>Object.assign({},S,{params:Object.assign({},d,S.params),pathname:bi([m,o.encodeLocation?o.encodeLocation(S.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?m:bi([m,o.encodeLocation?o.encodeLocation(S.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:S.pathnameBase])})),l,r,s,n);return t&&w?K.createElement(ef.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},w):w}function S8(){let e=F8(),t=u8(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:s},o={padding:"2px 4px",backgroundColor:s},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=K.createElement(K.Fragment,null,K.createElement("p",null," Hey developer "),K.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",K.createElement("code",{style:o},"ErrorBoundary")," or"," ",K.createElement("code",{style:o},"errorElement")," prop on your route.")),K.createElement(K.Fragment,null,K.createElement("h2",null,"Unexpected Application Error!"),K.createElement("h3",{style:{fontStyle:"italic"}},t),r?K.createElement("pre",{style:n},r):null,l)}var E8=K.createElement(S8,null),fE=class extends K.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const r=v8(e.digest);r&&(e=r)}let t=e!==void 0?K.createElement(pn.Provider,{value:this.props.routeContext},K.createElement(lv.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?K.createElement(j8,{error:e},t):t}};fE.contextType=h8;var qx=new WeakMap;function j8({children:e,error:t}){let{basename:r}=K.useContext(Wa);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let s=y8(t.digest);if(s){let n=qx.get(t);if(n)throw n;let o=aE(s.location,r);if(sE&&!qx.get(t))if(o.isExternal||s.reloadDocument)window.location.href=o.absoluteURL||o.to;else{const l=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(o.to,{replace:s.replace}));throw qx.set(t,l),l}return K.createElement("meta",{httpEquiv:"refresh",content:`0;url=${o.absoluteURL||o.to}`})}}return e}function T8({routeContext:e,match:t,children:r}){let s=K.useContext(ru);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),K.createElement(pn.Provider,{value:e},r)}function A8(e,t=[],r=null,s=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=r?.errors;if(l!=null){let m=o.findIndex(x=>x.route.id&&l?.[x.route.id]!==void 0);Yr(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,d=-1;if(r)for(let m=0;m<o.length;m++){let x=o[m];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(d=m),x.route.id){let{loaderData:y,errors:b}=r,v=x.route.loader&&!y.hasOwnProperty(x.route.id)&&(!b||b[x.route.id]===void 0);if(x.route.lazy||v){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}let h=r&&s?(m,x)=>{s(m,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:d8(r.matches),errorInfo:x})}:void 0;return o.reduceRight((m,x,y)=>{let b,v=!1,g=null,_=null;r&&(b=l&&x.route.id?l[x.route.id]:void 0,g=x.route.errorElement||E8,u&&(d<0&&y===0?(hE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,_=null):d===y&&(v=!0,_=x.route.hydrateFallbackElement||null)));let w=t.concat(o.slice(0,y+1)),S=()=>{let N;return b?N=g:v?N=_:x.route.Component?N=K.createElement(x.route.Component,null):x.route.element?N=x.route.element:N=m,K.createElement(T8,{match:x,routeContext:{outlet:m,matches:w,isDataRoute:r!=null},children:N})};return r&&(x.route.ErrorBoundary||x.route.errorElement||y===0)?K.createElement(fE,{location:r.location,revalidation:r.revalidation,component:g,error:b,children:S(),routeContext:{outlet:null,matches:w,isDataRoute:!0},onError:h}):S()},null)}function cv(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function C8(e){let t=K.useContext(ru);return Yr(t,cv(e)),t}function R8(e){let t=K.useContext(Q0);return Yr(t,cv(e)),t}function D8(e){let t=K.useContext(pn);return Yr(t,cv(e)),t}function uv(e){let t=D8(e),r=t.matches[t.matches.length-1];return Yr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function O8(){return uv("useRouteId")}function F8(){let e=K.useContext(lv),t=R8("useRouteError"),r=uv("useRouteError");return e!==void 0?e:t.errors?.[r]}function L8(){let{router:e}=C8("useNavigate"),t=uv("useNavigate"),r=K.useRef(!1);return cE(()=>{r.current=!0}),K.useCallback(async(n,o={})=>{hn(r.current,lE),r.current&&(typeof n=="number"?await e.navigate(n):await e.navigate(n,{fromRouteId:t,...o}))},[e,t])}var AN={};function hE(e,t,r){!t&&!AN[e]&&(AN[e]=!0,hn(!1,r))}K.memo(I8);function I8({routes:e,future:t,state:r,onError:s}){return dE(e,void 0,r,s,t)}function el({to:e,replace:t,state:r,relative:s}){Yr(su(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=K.useContext(Wa);hn(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=K.useContext(pn),{pathname:l}=Ti(),u=au(),d=ov(e,iv(o),l,s==="path"),h=JSON.stringify(d);return K.useEffect(()=>{u(JSON.parse(h),{replace:t,state:r,relative:s})},[u,h,s,t,r]),null}function M8(e){return N8(e.context)}function Er(e){Yr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function B8({basename:e="/",children:t=null,location:r,navigationType:s="POP",navigator:n,static:o=!1,unstable_useTransitions:l}){Yr(!su(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=e.replace(/^\/*/,"/"),d=K.useMemo(()=>({basename:u,navigator:n,static:o,unstable_useTransitions:l,future:{}}),[u,n,o,l]);typeof r=="string"&&(r=tu(r));let{pathname:h="/",search:m="",hash:x="",state:y=null,key:b="default"}=r,v=K.useMemo(()=>{let g=ki(h,u);return g==null?null:{location:{pathname:g,search:m,hash:x,state:y,key:b},navigationType:s}},[u,h,m,x,y,b,s]);return hn(v!=null,`<Router basename="${u}"> is not able to match the URL "${h}${m}${x}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:K.createElement(Wa.Provider,{value:d},K.createElement(ef.Provider,{children:t,value:v}))}function P8({children:e,location:t}){return k8(gy(e),t)}function gy(e,t=[]){let r=[];return K.Children.forEach(e,(s,n)=>{if(!K.isValidElement(s))return;let o=[...t,n];if(s.type===K.Fragment){r.push.apply(r,gy(s.props.children,o));return}Yr(s.type===Er,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Yr(!s.props.index||!s.props.children,"An index route cannot have child routes.");let l={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(l.children=gy(s.props.children,o)),r.push(l)}),r}var h0="get",m0="application/x-www-form-urlencoded";function em(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function U8(e){return em(e)&&e.tagName.toLowerCase()==="button"}function z8(e){return em(e)&&e.tagName.toLowerCase()==="form"}function $8(e){return em(e)&&e.tagName.toLowerCase()==="input"}function q8(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function H8(e,t){return e.button===0&&(!t||t==="_self")&&!q8(e)}var Rh=null;function W8(){if(Rh===null)try{new FormData(document.createElement("form"),0),Rh=!1}catch{Rh=!0}return Rh}var G8=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Hx(e){return e!=null&&!G8.has(e)?(hn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${m0}"`),null):e}function V8(e,t){let r,s,n,o,l;if(z8(e)){let u=e.getAttribute("action");s=u?ki(u,t):null,r=e.getAttribute("method")||h0,n=Hx(e.getAttribute("enctype"))||m0,o=new FormData(e)}else if(U8(e)||$8(e)&&(e.type==="submit"||e.type==="image")){let u=e.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||u.getAttribute("action");if(s=d?ki(d,t):null,r=e.getAttribute("formmethod")||u.getAttribute("method")||h0,n=Hx(e.getAttribute("formenctype"))||Hx(u.getAttribute("enctype"))||m0,o=new FormData(u,e),!W8()){let{name:h,type:m,value:x}=e;if(m==="image"){let y=h?`${h}.`:"";o.append(`${y}x`,"0"),o.append(`${y}y`,"0")}else h&&o.append(h,x)}}else{if(em(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=h0,s=null,n=m0,l=e}return o&&n==="text/plain"&&(l=o,o=void 0),{action:s,method:r.toLowerCase(),encType:n,formData:o,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function dv(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function K8(e,t,r,s){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r?n.pathname.endsWith("/")?n.pathname=`${n.pathname}_.${s}`:n.pathname=`${n.pathname}.${s}`:n.pathname==="/"?n.pathname=`_root.${s}`:t&&ki(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${s}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${s}`,n}async function X8(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Y8(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function J8(e,t,r){let s=await Promise.all(e.map(async n=>{let o=t.routes[n.route.id];if(o){let l=await X8(o,r);return l.links?l.links():[]}return[]}));return tR(s.flat(1).filter(Y8).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function CN(e,t,r,s,n,o){let l=(d,h)=>r[h]?d.route.id!==r[h].route.id:!0,u=(d,h)=>r[h].pathname!==d.pathname||r[h].route.path?.endsWith("*")&&r[h].params["*"]!==d.params["*"];return o==="assets"?t.filter((d,h)=>l(d,h)||u(d,h)):o==="data"?t.filter((d,h)=>{let m=s.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(l(d,h)||u(d,h))return!0;if(d.route.shouldRevalidate){let x=d.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function Z8(e,t,{includeHydrateFallback:r}={}){return Q8(e.map(s=>{let n=t.routes[s.route.id];if(!n)return[];let o=[n.module];return n.clientActionModule&&(o=o.concat(n.clientActionModule)),n.clientLoaderModule&&(o=o.concat(n.clientLoaderModule)),r&&n.hydrateFallbackModule&&(o=o.concat(n.hydrateFallbackModule)),n.imports&&(o=o.concat(n.imports)),o}).flat(1))}function Q8(e){return[...new Set(e)]}function eR(e){let t={},r=Object.keys(e).sort();for(let s of r)t[s]=e[s];return t}function tR(e,t){let r=new Set;return new Set(t),e.reduce((s,n)=>{let o=JSON.stringify(eR(n));return r.has(o)||(r.add(o),s.push({key:o,link:n})),s},[])}function mE(){let e=K.useContext(ru);return dv(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function rR(){let e=K.useContext(Q0);return dv(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var fv=K.createContext(void 0);fv.displayName="FrameworkContext";function pE(){let e=K.useContext(fv);return dv(e,"You must render this element inside a <HydratedRouter> element"),e}function sR(e,t){let r=K.useContext(fv),[s,n]=K.useState(!1),[o,l]=K.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:h,onMouseLeave:m,onTouchStart:x}=t,y=K.useRef(null);K.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let g=w=>{w.forEach(S=>{l(S.isIntersecting)})},_=new IntersectionObserver(g,{threshold:.5});return y.current&&_.observe(y.current),()=>{_.disconnect()}}},[e]),K.useEffect(()=>{if(s){let g=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(g)}}},[s]);let b=()=>{n(!0)},v=()=>{n(!1),l(!1)};return r?e!=="intent"?[o,y,{}]:[o,y,{onFocus:Qu(u,b),onBlur:Qu(d,v),onMouseEnter:Qu(h,b),onMouseLeave:Qu(m,v),onTouchStart:Qu(x,b)}]:[!1,y,{}]}function Qu(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function aR({page:e,...t}){let{router:r}=mE(),s=K.useMemo(()=>Q3(r.routes,e,r.basename),[r.routes,e,r.basename]);return s?K.createElement(iR,{page:e,matches:s,...t}):null}function nR(e){let{manifest:t,routeModules:r}=pE(),[s,n]=K.useState([]);return K.useEffect(()=>{let o=!1;return J8(e,t,r).then(l=>{o||n(l)}),()=>{o=!0}},[e,t,r]),s}function iR({page:e,matches:t,...r}){let s=Ti(),{future:n,manifest:o,routeModules:l}=pE(),{basename:u}=mE(),{loaderData:d,matches:h}=rR(),m=K.useMemo(()=>CN(e,t,h,o,s,"data"),[e,t,h,o,s]),x=K.useMemo(()=>CN(e,t,h,o,s,"assets"),[e,t,h,o,s]),y=K.useMemo(()=>{if(e===s.pathname+s.search+s.hash)return[];let g=new Set,_=!1;if(t.forEach(S=>{let N=o.routes[S.route.id];!N||!N.hasLoader||(!m.some(E=>E.route.id===S.route.id)&&S.route.id in d&&l[S.route.id]?.shouldRevalidate||N.hasClientLoader?_=!0:g.add(S.route.id))}),g.size===0)return[];let w=K8(e,u,n.unstable_trailingSlashAwareDataRequests,"data");return _&&g.size>0&&w.searchParams.set("_routes",t.filter(S=>g.has(S.route.id)).map(S=>S.route.id).join(",")),[w.pathname+w.search]},[u,n.unstable_trailingSlashAwareDataRequests,d,s,o,m,t,e,l]),b=K.useMemo(()=>Z8(x,o),[x,o]),v=nR(x);return K.createElement(K.Fragment,null,y.map(g=>K.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...r})),b.map(g=>K.createElement("link",{key:g,rel:"modulepreload",href:g,...r})),v.map(({key:g,link:_})=>K.createElement("link",{key:g,nonce:r.nonce,..._})))}function oR(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var lR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{lR&&(window.__reactRouterVersion="7.12.0")}catch{}function cR({basename:e,children:t,unstable_useTransitions:r,window:s}){let n=K.useRef();n.current==null&&(n.current=UC({window:s,v5Compat:!0}));let o=n.current,[l,u]=K.useState({action:o.action,location:o.location}),d=K.useCallback(h=>{r===!1?u(h):K.startTransition(()=>u(h))},[r]);return K.useLayoutEffect(()=>o.listen(d),[o,d]),K.createElement(B8,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,unstable_useTransitions:r})}var xE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vs=K.forwardRef(function({onClick:t,discover:r="render",prefetch:s="none",relative:n,reloadDocument:o,replace:l,state:u,target:d,to:h,preventScrollReset:m,viewTransition:x,unstable_defaultShouldRevalidate:y,...b},v){let{basename:g,unstable_useTransitions:_}=K.useContext(Wa),w=typeof h=="string"&&xE.test(h),S=aE(h,g);h=S.to;let N=b8(h,{relative:n}),[E,C,F]=sR(s,b),O=fR(h,{replace:l,state:u,target:d,preventScrollReset:m,relative:n,viewTransition:x,unstable_defaultShouldRevalidate:y,unstable_useTransitions:_});function B(H){t&&t(H),H.defaultPrevented||O(H)}let L=K.createElement("a",{...b,...F,href:S.absoluteURL||N,onClick:S.isExternal||o?t:B,ref:oR(v,C),target:d,"data-discover":!w&&r==="render"?"true":void 0});return E&&!w?K.createElement(K.Fragment,null,L,K.createElement(aR,{page:N})):L});Vs.displayName="Link";var yy=K.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:s="",end:n=!1,style:o,to:l,viewTransition:u,children:d,...h},m){let x=tf(l,{relative:h.relative}),y=Ti(),b=K.useContext(Q0),{navigator:v,basename:g}=K.useContext(Wa),_=b!=null&&gR(x)&&u===!0,w=v.encodeLocation?v.encodeLocation(x).pathname:x.pathname,S=y.pathname,N=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;r||(S=S.toLowerCase(),N=N?N.toLowerCase():null,w=w.toLowerCase()),N&&g&&(N=ki(N,g)||N);const E=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let C=S===w||!n&&S.startsWith(w)&&S.charAt(E)==="/",F=N!=null&&(N===w||!n&&N.startsWith(w)&&N.charAt(w.length)==="/"),O={isActive:C,isPending:F,isTransitioning:_},B=C?t:void 0,L;typeof s=="function"?L=s(O):L=[s,C?"active":null,F?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let H=typeof o=="function"?o(O):o;return K.createElement(Vs,{...h,"aria-current":B,className:L,ref:m,style:H,to:l,viewTransition:u},typeof d=="function"?d(O):d)});yy.displayName="NavLink";var uR=K.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:s,replace:n,state:o,method:l=h0,action:u,onSubmit:d,relative:h,preventScrollReset:m,viewTransition:x,unstable_defaultShouldRevalidate:y,...b},v)=>{let{unstable_useTransitions:g}=K.useContext(Wa),_=pR(),w=xR(u,{relative:h}),S=l.toLowerCase()==="get"?"get":"post",N=typeof u=="string"&&xE.test(u),E=C=>{if(d&&d(C),C.defaultPrevented)return;C.preventDefault();let F=C.nativeEvent.submitter,O=F?.getAttribute("formmethod")||l,B=()=>_(F||C.currentTarget,{fetcherKey:t,method:O,navigate:r,replace:n,state:o,relative:h,preventScrollReset:m,viewTransition:x,unstable_defaultShouldRevalidate:y});g&&r!==!1?K.startTransition(()=>B()):B()};return K.createElement("form",{ref:v,method:S,action:w,onSubmit:s?d:E,...b,"data-discover":!N&&e==="render"?"true":void 0})});uR.displayName="Form";function dR(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function gE(e){let t=K.useContext(ru);return Yr(t,dR(e)),t}function fR(e,{target:t,replace:r,state:s,preventScrollReset:n,relative:o,viewTransition:l,unstable_defaultShouldRevalidate:u,unstable_useTransitions:d}={}){let h=au(),m=Ti(),x=tf(e,{relative:o});return K.useCallback(y=>{if(H8(y,t)){y.preventDefault();let b=r!==void 0?r:jd(m)===jd(x),v=()=>h(e,{replace:b,state:s,preventScrollReset:n,relative:o,viewTransition:l,unstable_defaultShouldRevalidate:u});d?K.startTransition(()=>v()):v()}},[m,h,x,r,s,t,e,n,o,l,u,d])}var hR=0,mR=()=>`__${String(++hR)}__`;function pR(){let{router:e}=gE("useSubmit"),{basename:t}=K.useContext(Wa),r=O8(),s=e.fetch,n=e.navigate;return K.useCallback(async(o,l={})=>{let{action:u,method:d,encType:h,formData:m,body:x}=V8(o,t);if(l.navigate===!1){let y=l.fetcherKey||mR();await s(y,r,l.action||u,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:m,body:x,formMethod:l.method||d,formEncType:l.encType||h,flushSync:l.flushSync})}else await n(l.action||u,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:m,body:x,formMethod:l.method||d,formEncType:l.encType||h,replace:l.replace,state:l.state,fromRouteId:r,flushSync:l.flushSync,viewTransition:l.viewTransition})},[s,n,t,r])}function xR(e,{relative:t}={}){let{basename:r}=K.useContext(Wa),s=K.useContext(pn);Yr(s,"useFormAction must be used inside a RouteContext");let[n]=s.matches.slice(-1),o={...tf(e||".",{relative:t})},l=Ti();if(e==null){o.search=l.search;let u=new URLSearchParams(o.search),d=u.getAll("index");if(d.some(m=>m==="")){u.delete("index"),d.filter(x=>x).forEach(x=>u.append("index",x));let m=u.toString();o.search=m?`?${m}`:""}}return(!e||e===".")&&n.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(o.pathname=o.pathname==="/"?r:bi([r,o.pathname])),jd(o)}function gR(e,{relative:t}={}){let r=K.useContext(iE);Yr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=gE("useViewTransitionState"),n=tf(e,{relative:t});if(!r.isTransitioning)return!1;let o=ki(r.currentLocation.pathname,s)||r.currentLocation.pathname,l=ki(r.nextLocation.pathname,s)||r.nextLocation.pathname;return E0(n.pathname,l)!=null||E0(n.pathname,o)!=null}const yR={};var vy=null;function vR(e){try{return crypto.getRandomValues(new Uint8Array(e))}catch{}try{return yR.randomBytes(e)}catch{}if(!vy)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return vy(e)}function bR(e){vy=e}function hv(e,t){if(e=e||mv,typeof e!="number")throw Error("Illegal arguments: "+typeof e+", "+typeof t);e<4?e=4:e>31&&(e=31);var r=[];return r.push("$2b$"),e<10&&r.push("0"),r.push(e.toString()),r.push("$"),r.push(j0(vR(Td),Td)),r.join("")}function yE(e,t,r){if(typeof t=="function"&&(r=t,t=void 0),typeof e=="function"&&(r=e,e=void 0),typeof e>"u")e=mv;else if(typeof e!="number")throw Error("illegal arguments: "+typeof e);function s(n){kn(function(){try{n(null,hv(e))}catch(o){n(o)}})}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);s(r)}else return new Promise(function(n,o){s(function(l,u){if(l){o(l);return}n(u)})})}function vE(e,t){if(typeof t>"u"&&(t=mv),typeof t=="number"&&(t=hv(t)),typeof e!="string"||typeof t!="string")throw Error("Illegal arguments: "+typeof e+", "+typeof t);return by(e,t)}function bE(e,t,r,s){function n(o){typeof e=="string"&&typeof t=="number"?yE(t,function(l,u){by(e,u,o,s)}):typeof e=="string"&&typeof t=="string"?by(e,t,o,s):kn(o.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)))}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);n(r)}else return new Promise(function(o,l){n(function(u,d){if(u){l(u);return}o(d)})})}function wE(e,t){for(var r=e.length^t.length,s=0;s<e.length;++s)r|=e.charCodeAt(s)^t.charCodeAt(s);return r===0}function wR(e,t){if(typeof e!="string"||typeof t!="string")throw Error("Illegal arguments: "+typeof e+", "+typeof t);return t.length!==60?!1:wE(vE(e,t.substring(0,t.length-31)),t)}function _R(e,t,r,s){function n(o){if(typeof e!="string"||typeof t!="string"){kn(o.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)));return}if(t.length!==60){kn(o.bind(this,null,!1));return}bE(e,t.substring(0,29),function(l,u){l?o(l):o(null,wE(u,t))},s)}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);n(r)}else return new Promise(function(o,l){n(function(u,d){if(u){l(u);return}o(d)})})}function NR(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)}function kR(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);if(e.length!==60)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)}function SR(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);return _E(e)>72}var kn=typeof setImmediate=="function"?setImmediate:typeof scheduler=="object"&&typeof scheduler.postTask=="function"?scheduler.postTask.bind(scheduler):setTimeout;function _E(e){for(var t=0,r=0,s=0;s<e.length;++s)r=e.charCodeAt(s),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(s+1)&64512)===56320?(++s,t+=4):t+=3;return t}function ER(e){for(var t=0,r,s,n=new Array(_E(e)),o=0,l=e.length;o<l;++o)r=e.charCodeAt(o),r<128?n[t++]=r:r<2048?(n[t++]=r>>6|192,n[t++]=r&63|128):(r&64512)===55296&&((s=e.charCodeAt(o+1))&64512)===56320?(r=65536+((r&1023)<<10)+(s&1023),++o,n[t++]=r>>18|240,n[t++]=r>>12&63|128,n[t++]=r>>6&63|128,n[t++]=r&63|128):(n[t++]=r>>12|224,n[t++]=r>>6&63|128,n[t++]=r&63|128);return n}var fc="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),no=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function j0(e,t){var r=0,s=[],n,o;if(t<=0||t>e.length)throw Error("Illegal len: "+t);for(;r<t;){if(n=e[r++]&255,s.push(fc[n>>2&63]),n=(n&3)<<4,r>=t){s.push(fc[n&63]);break}if(o=e[r++]&255,n|=o>>4&15,s.push(fc[n&63]),n=(o&15)<<2,r>=t){s.push(fc[n&63]);break}o=e[r++]&255,n|=o>>6&3,s.push(fc[n&63]),s.push(fc[o&63])}return s.join("")}function NE(e,t){var r=0,s=e.length,n=0,o=[],l,u,d,h,m,x;if(t<=0)throw Error("Illegal len: "+t);for(;r<s-1&&n<t&&(x=e.charCodeAt(r++),l=x<no.length?no[x]:-1,x=e.charCodeAt(r++),u=x<no.length?no[x]:-1,!(l==-1||u==-1||(m=l<<2>>>0,m|=(u&48)>>4,o.push(String.fromCharCode(m)),++n>=t||r>=s)||(x=e.charCodeAt(r++),d=x<no.length?no[x]:-1,d==-1)||(m=(u&15)<<4>>>0,m|=(d&60)>>2,o.push(String.fromCharCode(m)),++n>=t||r>=s)));)x=e.charCodeAt(r++),h=x<no.length?no[x]:-1,m=(d&3)<<6>>>0,m|=h,o.push(String.fromCharCode(m)),++n;var y=[];for(r=0;r<n;r++)y.push(o[r].charCodeAt(0));return y}var Td=16,mv=10,jR=16,TR=100,RN=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],DN=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],kE=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function Ad(e,t,r,s){var n,o=e[t],l=e[t+1];return o^=r[0],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],l^=n^r[1],n=s[l>>>24],n+=s[256|l>>16&255],n^=s[512|l>>8&255],n+=s[768|l&255],o^=n^r[2],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],l^=n^r[3],n=s[l>>>24],n+=s[256|l>>16&255],n^=s[512|l>>8&255],n+=s[768|l&255],o^=n^r[4],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],l^=n^r[5],n=s[l>>>24],n+=s[256|l>>16&255],n^=s[512|l>>8&255],n+=s[768|l&255],o^=n^r[6],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],l^=n^r[7],n=s[l>>>24],n+=s[256|l>>16&255],n^=s[512|l>>8&255],n+=s[768|l&255],o^=n^r[8],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],l^=n^r[9],n=s[l>>>24],n+=s[256|l>>16&255],n^=s[512|l>>8&255],n+=s[768|l&255],o^=n^r[10],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],l^=n^r[11],n=s[l>>>24],n+=s[256|l>>16&255],n^=s[512|l>>8&255],n+=s[768|l&255],o^=n^r[12],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],l^=n^r[13],n=s[l>>>24],n+=s[256|l>>16&255],n^=s[512|l>>8&255],n+=s[768|l&255],o^=n^r[14],n=s[o>>>24],n+=s[256|o>>16&255],n^=s[512|o>>8&255],n+=s[768|o&255],l^=n^r[15],n=s[l>>>24],n+=s[256|l>>16&255],n^=s[512|l>>8&255],n+=s[768|l&255],o^=n^r[16],e[t]=l^r[jR+1],e[t+1]=o,e}function Ec(e,t){for(var r=0,s=0;r<4;++r)s=s<<8|e[t]&255,t=(t+1)%e.length;return{key:s,offp:t}}function ON(e,t,r){for(var s=0,n=[0,0],o=t.length,l=r.length,u,d=0;d<o;d++)u=Ec(e,s),s=u.offp,t[d]=t[d]^u.key;for(d=0;d<o;d+=2)n=Ad(n,0,t,r),t[d]=n[0],t[d+1]=n[1];for(d=0;d<l;d+=2)n=Ad(n,0,t,r),r[d]=n[0],r[d+1]=n[1]}function AR(e,t,r,s){for(var n=0,o=[0,0],l=r.length,u=s.length,d,h=0;h<l;h++)d=Ec(t,n),n=d.offp,r[h]=r[h]^d.key;for(n=0,h=0;h<l;h+=2)d=Ec(e,n),n=d.offp,o[0]^=d.key,d=Ec(e,n),n=d.offp,o[1]^=d.key,o=Ad(o,0,r,s),r[h]=o[0],r[h+1]=o[1];for(h=0;h<u;h+=2)d=Ec(e,n),n=d.offp,o[0]^=d.key,d=Ec(e,n),n=d.offp,o[1]^=d.key,o=Ad(o,0,r,s),s[h]=o[0],s[h+1]=o[1]}function FN(e,t,r,s,n){var o=kE.slice(),l=o.length,u;if(r<4||r>31)if(u=Error("Illegal number of rounds (4-31): "+r),s){kn(s.bind(this,u));return}else throw u;if(t.length!==Td)if(u=Error("Illegal salt length: "+t.length+" != "+Td),s){kn(s.bind(this,u));return}else throw u;r=1<<r>>>0;var d,h,m=0,x;typeof Int32Array=="function"?(d=new Int32Array(RN),h=new Int32Array(DN)):(d=RN.slice(),h=DN.slice()),AR(t,e,d,h);function y(){if(n&&n(m/r),m<r)for(var v=Date.now();m<r&&(m=m+1,ON(e,d,h),ON(t,d,h),!(Date.now()-v>TR)););else{for(m=0;m<64;m++)for(x=0;x<l>>1;x++)Ad(o,x<<1,d,h);var g=[];for(m=0;m<l;m++)g.push((o[m]>>24&255)>>>0),g.push((o[m]>>16&255)>>>0),g.push((o[m]>>8&255)>>>0),g.push((o[m]&255)>>>0);if(s){s(null,g);return}else return g}s&&kn(y)}if(typeof s<"u")y();else for(var b;;)if(typeof(b=y())<"u")return b||[]}function by(e,t,r,s){var n;if(typeof e!="string"||typeof t!="string")if(n=Error("Invalid string / salt: Not a string"),r){kn(r.bind(this,n));return}else throw n;var o,l;if(t.charAt(0)!=="$"||t.charAt(1)!=="2")if(n=Error("Invalid salt version: "+t.substring(0,2)),r){kn(r.bind(this,n));return}else throw n;if(t.charAt(2)==="$")o="\0",l=3;else{if(o=t.charAt(2),o!=="a"&&o!=="b"&&o!=="y"||t.charAt(3)!=="$")if(n=Error("Invalid salt revision: "+t.substring(2,4)),r){kn(r.bind(this,n));return}else throw n;l=4}if(t.charAt(l+2)>"$")if(n=Error("Missing salt rounds"),r){kn(r.bind(this,n));return}else throw n;var u=parseInt(t.substring(l,l+1),10)*10,d=parseInt(t.substring(l+1,l+2),10),h=u+d,m=t.substring(l+3,l+25);e+=o>="a"?"\0":"";var x=ER(e),y=NE(m,Td);function b(v){var g=[];return g.push("$2"),o>="a"&&g.push(o),g.push("$"),h<10&&g.push("0"),g.push(h.toString()),g.push("$"),g.push(j0(y,y.length)),g.push(j0(v,kE.length*4-1)),g.join("")}if(typeof r>"u")return b(FN(x,y,h));FN(x,y,h,function(v,g){v?r(v,null):r(null,b(g))},s)}function CR(e,t){return j0(e,t)}function RR(e,t){return NE(e,t)}const Wx={setRandomFallback:bR,genSaltSync:hv,genSalt:yE,hashSync:vE,hash:bE,compareSync:wR,compare:_R,getRounds:NR,getSalt:kR,truncates:SR,encodeBase64:CR,decodeBase64:RR};function tm(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}function DR(e,t,r,s){function n(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function u(m){try{h(s.next(m))}catch(x){l(x)}}function d(m){try{h(s.throw(m))}catch(x){l(x)}}function h(m){m.done?o(m.value):n(m.value).then(u,d)}h((s=s.apply(e,t||[])).next())})}const OR=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class pv extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class FR extends pv{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class LN extends pv{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class IN extends pv{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var wy;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(wy||(wy={}));class LR{constructor(t,{headers:r={},customFetch:s,region:n=wy.Any}={}){this.url=t,this.headers=r,this.region=n,this.fetch=OR(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return DR(this,arguments,void 0,function*(r,s={}){var n;let o,l;try{const{headers:u,method:d,body:h,signal:m,timeout:x}=s;let y={},{region:b}=s;b||(b=this.region);const v=new URL(`${this.url}/${r}`);b&&b!=="any"&&(y["x-region"]=b,v.searchParams.set("forceFunctionRegion",b));let g;h&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",g=h):typeof h=="string"?(y["Content-Type"]="text/plain",g=h):typeof FormData<"u"&&h instanceof FormData?g=h:(y["Content-Type"]="application/json",g=JSON.stringify(h)):h&&typeof h!="string"&&!(typeof Blob<"u"&&h instanceof Blob)&&!(h instanceof ArrayBuffer)&&!(typeof FormData<"u"&&h instanceof FormData)?g=JSON.stringify(h):g=h;let _=m;x&&(l=new AbortController,o=setTimeout(()=>l.abort(),x),m?(_=l.signal,m.addEventListener("abort",()=>l.abort())):_=l.signal);const w=yield this.fetch(v.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),u),body:g,signal:_}).catch(C=>{throw new FR(C)}),S=w.headers.get("x-relay-error");if(S&&S==="true")throw new LN(w);if(!w.ok)throw new IN(w);let N=((n=w.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),E;return N==="application/json"?E=yield w.json():N==="application/octet-stream"||N==="application/pdf"?E=yield w.blob():N==="text/event-stream"?E=w:N==="multipart/form-data"?E=yield w.formData():E=yield w.text(),{data:E,error:null,response:w}}catch(u){return{data:null,error:u,response:u instanceof IN||u instanceof LN?u.context:void 0}}finally{o&&clearTimeout(o)}})}}var IR=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},MR=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{let l=null,u=null,d=null,h=o.status,m=o.statusText;if(o.ok){var x,y;if(r.method!=="HEAD"){var b;const w=await o.text();w===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((b=r.headers.get("Accept"))===null||b===void 0)&&b.includes("application/vnd.pgrst.plan+text"))?u=w:u=JSON.parse(w))}const g=(x=r.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),_=(y=o.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");g&&_&&_.length>1&&(d=parseInt(_[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(u)&&(u.length>1?(l={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,h=406,m="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var v;const g=await o.text();try{l=JSON.parse(g),Array.isArray(l)&&o.status===404&&(u=[],l=null,h=200,m="OK")}catch{o.status===404&&g===""?(h=204,m="No Content"):l={message:g}}if(l&&r.isMaybeSingle&&(!(l==null||(v=l.details)===null||v===void 0)&&v.includes("0 rows"))&&(l=null,h=200,m="OK"),l&&r.shouldThrowOnError)throw new IR(l)}return{error:l,data:u,count:d,status:h,statusText:m}});return this.shouldThrowOnError||(n=n.catch(o=>{var l;let u="";const d=o?.cause;if(d){var h,m,x,y;const v=(h=d?.message)!==null&&h!==void 0?h:"",g=(m=d?.code)!==null&&m!==void 0?m:"";u=`${(x=o?.name)!==null&&x!==void 0?x:"FetchError"}: ${o?.message}`,u+=`

Caused by: ${(y=d?.name)!==null&&y!==void 0?y:"Error"}: ${v}`,g&&(u+=` (${g})`),d?.stack&&(u+=`
${d.stack}`)}else{var b;u=(b=o?.stack)!==null&&b!==void 0?b:""}return{error:{message:`${(l=o?.name)!==null&&l!==void 0?l:"FetchError"}: ${o?.message}`,details:u,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}},BR=class extends MR{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){const o=n?`${n}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const n=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:o="text"}={}){var l;const u=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${u};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const MN=new RegExp("[,()]");var jc=class extends BR{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&MN.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&MN.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let n="";s==="plain"?n="pl":s==="phrase"?n="ph":s==="websearch"&&(n="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},PR=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:s}=t??{},n=r?"HEAD":"GET";let o=!1;const l=(e??"*").split("").map(h=>/\s/.test(h)&&!o?"":(h==='"'&&(o=!o),h)).join(""),{url:u,headers:d}=this.cloneRequestState();return u.searchParams.set("select",l),s&&d.append("Prefer",`count=${s}`),new jc({method:n,url:u,headers:d,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var s;const n="POST",{url:o,headers:l}=this.cloneRequestState();if(t&&l.append("Prefer",`count=${t}`),r||l.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);o.searchParams.set("columns",d.join(","))}}return new jc({method:n,url:o,headers:l,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:n=!0}={}){var o;const l="POST",{url:u,headers:d}=this.cloneRequestState();if(d.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&u.searchParams.set("on_conflict",t),s&&d.append("Prefer",`count=${s}`),n||d.append("Prefer","missing=default"),Array.isArray(e)){const h=e.reduce((m,x)=>m.concat(Object.keys(x)),[]);if(h.length>0){const m=[...new Set(h)].map(x=>`"${x}"`);u.searchParams.set("columns",m.join(","))}}return new jc({method:l,url:u,headers:d,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:t}={}){var r;const s="PATCH",{url:n,headers:o}=this.cloneRequestState();return t&&o.append("Prefer",`count=${t}`),new jc({method:s,url:n,headers:o,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:s,headers:n}=this.cloneRequestState();return e&&n.append("Prefer",`count=${e}`),new jc({method:r,url:s,headers:n,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},UR=class SE{constructor(t,{headers:r={},schema:s,fetch:n}={}){this.url=t,this.headers=new Headers(r),this.schemaName=s,this.fetch=n}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new PR(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new SE(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:s=!1,get:n=!1,count:o}={}){var l;let u;const d=new URL(`${this.url}/rpc/${t}`);let h;const m=b=>b!==null&&typeof b=="object"&&(!Array.isArray(b)||b.some(m)),x=s&&Object.values(r).some(m);x?(u="POST",h=r):s||n?(u=s?"HEAD":"GET",Object.entries(r).filter(([b,v])=>v!==void 0).map(([b,v])=>[b,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([b,v])=>{d.searchParams.append(b,v)})):(u="POST",h=r);const y=new Headers(this.headers);return x?y.set("Prefer",o?`count=${o},return=minimal`:"return=minimal"):o&&y.set("Prefer",`count=${o}`),new jc({method:u,url:d,headers:y,schema:this.schemaName,body:h,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class zR{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const s=r.versions;if(s&&s.node){const n=s.node,o=parseInt(n.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const $R="2.90.1",qR=`realtime-js/${$R}`,EE="1.0.0",HR="2.0.0",BN=EE,_y=1e4,WR=1e3,GR=100;var co;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(co||(co={}));var As;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(As||(As={}));var Nn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Nn||(Nn={}));var Ny;(function(e){e.websocket="websocket"})(Ny||(Ny={}));var Jo;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Jo||(Jo={}));class VR{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,s;const n=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(t){var r,s;const n=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},l=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(t,r,s){var n,o;const l=t.topic,u=(n=t.ref)!==null&&n!==void 0?n:"",d=(o=t.join_ref)!==null&&o!==void 0?o:"",h=t.payload.event,m=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},x=Object.keys(m).length===0?"":JSON.stringify(m);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`userEvent length ${h.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`metadata length ${x.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+u.length+l.length+h.length+x.length,b=new ArrayBuffer(this.HEADER_LENGTH+y);let v=new DataView(b),g=0;v.setUint8(g++,this.KINDS.userBroadcastPush),v.setUint8(g++,d.length),v.setUint8(g++,u.length),v.setUint8(g++,l.length),v.setUint8(g++,h.length),v.setUint8(g++,x.length),v.setUint8(g++,r),Array.from(d,w=>v.setUint8(g++,w.charCodeAt(0))),Array.from(u,w=>v.setUint8(g++,w.charCodeAt(0))),Array.from(l,w=>v.setUint8(g++,w.charCodeAt(0))),Array.from(h,w=>v.setUint8(g++,w.charCodeAt(0))),Array.from(x,w=>v.setUint8(g++,w.charCodeAt(0)));var _=new Uint8Array(b.byteLength+s.byteLength);return _.set(new Uint8Array(b),0),_.set(new Uint8Array(s),b.byteLength),_.buffer}decode(t,r){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return r(s)}if(typeof t=="string"){const s=JSON.parse(t),[n,o,l,u,d]=s;return r({join_ref:n,ref:o,topic:l,event:u,payload:d})}return r({})}_binaryDecode(t){const r=new DataView(t),s=r.getUint8(0),n=new TextDecoder;if(s===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,r,n)}_decodeUserBroadcast(t,r,s){const n=r.getUint8(1),o=r.getUint8(2),l=r.getUint8(3),u=r.getUint8(4);let d=this.HEADER_LENGTH+4;const h=s.decode(t.slice(d,d+n));d=d+n;const m=s.decode(t.slice(d,d+o));d=d+o;const x=s.decode(t.slice(d,d+l));d=d+l;const y=t.slice(d,t.byteLength),b=u===this.JSON_ENCODING?JSON.parse(s.decode(y)):y,v={type:this.BROADCAST_EVENT,event:m,payload:b};return l>0&&(v.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST_EVENT,payload:v}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([s])=>r.includes(s)))}}class jE{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var $r;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})($r||($r={}));const PN=(e,t,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((o,l)=>(o[l]=KR(l,e,t,n),o),{}):{}},KR=(e,t,r,s)=>{const n=t.find(u=>u.name===e),o=n?.type,l=r[e];return o&&!s.includes(o)?TE(o,l):ky(l)},TE=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return ZR(t,r)}switch(e){case $r.bool:return XR(t);case $r.float4:case $r.float8:case $r.int2:case $r.int4:case $r.int8:case $r.numeric:case $r.oid:return YR(t);case $r.json:case $r.jsonb:return JR(t);case $r.timestamp:return QR(t);case $r.abstime:case $r.date:case $r.daterange:case $r.int4range:case $r.int8range:case $r.money:case $r.reltime:case $r.text:case $r.time:case $r.timestamptz:case $r.timetz:case $r.tsrange:case $r.tstzrange:return ky(t);default:return ky(t)}},ky=e=>e,XR=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},YR=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},JR=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},ZR=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,s=e[r];if(e[0]==="{"&&s==="}"){let o;const l=e.slice(1,r);try{o=JSON.parse("["+l+"]")}catch{o=l?l.split(","):[]}return o.map(u=>TE(t,u))}return e},QR=e=>typeof e=="string"?e.replace(" ","T"):e,AE=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Gx{constructor(t,r,s={},n=_y){this.channel=t,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var UN;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(UN||(UN={}));class pd{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:o,onLeave:l,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=pd.syncState(this.state,n,o,l),this.pendingDiffs.forEach(d=>{this.state=pd.syncDiff(this.state,d,o,l)}),this.pendingDiffs=[],u()}),this.channel._on(s.diff,{},n=>{const{onJoin:o,onLeave:l,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=pd.syncDiff(this.state,n,o,l),u())}),this.onJoin((n,o,l)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:o,newPresences:l})}),this.onLeave((n,o,l)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:o,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,n){const o=this.cloneDeep(t),l=this.transformState(r),u={},d={};return this.map(o,(h,m)=>{l[h]||(d[h]=m)}),this.map(l,(h,m)=>{const x=o[h];if(x){const y=m.map(_=>_.presence_ref),b=x.map(_=>_.presence_ref),v=m.filter(_=>b.indexOf(_.presence_ref)<0),g=x.filter(_=>y.indexOf(_.presence_ref)<0);v.length>0&&(u[h]=v),g.length>0&&(d[h]=g)}else u[h]=m}),this.syncDiff(o,{joins:u,leaves:d},s,n)}static syncDiff(t,r,s,n){const{joins:o,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(o,(u,d)=>{var h;const m=(h=t[u])!==null&&h!==void 0?h:[];if(t[u]=this.cloneDeep(d),m.length>0){const x=t[u].map(b=>b.presence_ref),y=m.filter(b=>x.indexOf(b.presence_ref)<0);t[u].unshift(...y)}s(u,m,d)}),this.map(l,(u,d)=>{let h=t[u];if(!h)return;const m=d.map(x=>x.presence_ref);h=h.filter(x=>m.indexOf(x.presence_ref)<0),t[u]=h,n(u,h,d),h.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const n=t[s];return"metas"in n?r[s]=n.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[s]=n,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var zN;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(zN||(zN={}));var xd;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(xd||(xd={}));var xi;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(xi||(xi={}));class Dc{constructor(t,r={config:{}},s){var n,o;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=As.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Gx(this,Nn.join,this.params,this.timeout),this.rejoinTimer=new jE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=As.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=As.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=As.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=As.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=As.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Nn.reply,{},(l,u)=>{this._trigger(this._replyEventName(u),l)}),this.presence=new pd(this),this.broadcastEndpointURL=AE(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,n,o;if(this.socket.isConnected()||this.socket.connect(),this.state==As.closed){const{config:{broadcast:l,presence:u,private:d}}=this.params,h=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(b=>b.filter))!==null&&n!==void 0?n:[],m=!!this.bindings[xd.PRESENCE]&&this.bindings[xd.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,x={},y={broadcast:l,presence:Object.assign(Object.assign({},u),{enabled:m}),postgres_changes:h,private:d};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(b=>t?.(xi.CHANNEL_ERROR,b)),this._onClose(()=>t?.(xi.CLOSED)),this.updateJoinPayload(Object.assign({config:y},x)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:b})=>{var v;if(this.socket._isManualToken()||this.socket.setAuth(),b===void 0){t?.(xi.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,_=(v=g?.length)!==null&&v!==void 0?v:0,w=[];for(let S=0;S<_;S++){const N=g[S],{filter:{event:E,schema:C,table:F,filter:O}}=N,B=b&&b[S];if(B&&B.event===E&&Dc.isFilterValueEqual(B.schema,C)&&Dc.isFilterValueEqual(B.table,F)&&Dc.isFilterValueEqual(B.filter,O))w.push(Object.assign(Object.assign({},N),{id:B.id}));else{this.unsubscribe(),this.state=As.errored,t?.(xi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(xi.SUBSCRIBED);return}}).receive("error",b=>{this.state=As.errored,t?.(xi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{t?.(xi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===As.joined&&t===xd.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,s)}async httpSend(t,r,s={}){var n;if(r==null)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(u.status===202)return{success:!0};let d=u.statusText;try{const h=await u.json();d=h.error||h.message||d}catch{}return Promise.reject(new Error(d))}async send(t,r={}){var s,n;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:l}=t,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:l,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=h.body)===null||n===void 0?void 0:n.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var l,u,d;const h=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(u=(l=this.params)===null||l===void 0?void 0:l.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.ack)&&o("ok"),h.receive("ok",()=>o("ok")),h.receive("error",()=>o("error")),h.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=As.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Nn.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new Gx(this,Nn.leave,{},t),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=As.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const n=new AbortController,o=setTimeout(()=>n.abort(),s),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(o),l}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Gx(this,t,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>GR){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var n,o;const l=t.toLocaleLowerCase(),{close:u,error:d,leave:h,join:m}=Nn;if(s&&[u,d,h,m].indexOf(l)>=0&&s!==this._joinRef())return;let y=this._onMessage(l,r,s);if(r&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(b=>{var v,g,_;return((v=b.filter)===null||v===void 0?void 0:v.event)==="*"||((_=(g=b.filter)===null||g===void 0?void 0:g.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===l}).map(b=>b.callback(y,s)):(o=this.bindings[l])===null||o===void 0||o.filter(b=>{var v,g,_,w,S,N,E,C;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in b){const F=b.id,O=(v=b.filter)===null||v===void 0?void 0:v.event;return F&&((g=r.ids)===null||g===void 0?void 0:g.includes(F))&&(O==="*"||O?.toLocaleLowerCase()===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))&&(!(!((w=b.filter)===null||w===void 0)&&w.table)||b.filter.table===((S=r.data)===null||S===void 0?void 0:S.table))}else{const F=(E=(N=b?.filter)===null||N===void 0?void 0:N.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return F==="*"||F===((C=r?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===l}).map(b=>{if(typeof y=="object"&&"ids"in y){const v=y.data,{schema:g,table:_,commit_timestamp:w,type:S,errors:N}=v;y=Object.assign(Object.assign({},{schema:g,table:_,commit_timestamp:w,eventType:S,new:{},old:{},errors:N}),this._getPayloadRecords(v))}b.callback(y,s)})}_isClosed(){return this.state===As.closed}_isJoined(){return this.state===As.joined}_isJoining(){return this.state===As.joining}_isLeaving(){return this.state===As.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const n=t.toLocaleLowerCase(),o={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(o):this.bindings[n]=[o],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var o;return!(((o=n.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===s&&Dc.isEqual(n.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Nn.close,{},t)}_onError(t){this._on(Nn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=As.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=PN(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=PN(t.columns,t.old_record)),r}}const Vx=()=>{},Dh={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},eD=[1e3,2e3,5e3,1e4],tD=1e4,rD=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class sD{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=_y,this.transport=null,this.heartbeatIntervalMs=Dh.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Vx,this.ref=0,this.reconnectTimer=null,this.vsn=BN,this.logger=Vx,this.conn=null,this.sendBuffer=[],this.serializer=new VR,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=n=>n?(...o)=>n(...o):(...o)=>fetch(...o),!(!((s=r?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Ny.websocket}`,this.httpEndpoint=AE(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=zR.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case co.connecting:return Jo.Connecting;case co.open:return Jo.Open;case co.closing:return Jo.Closing;default:return Jo.Closed}}isConnected(){return this.connectionState()===Jo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,n=this.getChannels().find(o=>o.topic===s);if(n)return n;{const o=new Dc(`realtime:${t}`,r,this);return this.channels.push(o),o}}push(t){const{topic:r,event:s,payload:n,ref:o}=t,l=()=>{this.encode(t,u=>{var d;(d=this.conn)===null||d===void 0||d.send(u)})};this.log("push",`${r} ${s} (${o})`,n),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(WR,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Dh.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const h=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",h)}catch(m){this.log("error","error in heartbeat callback",m)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:n,payload:o,ref:l}=r,u=l?`(${l})`:"",d=o.status||"";this.log("receive",`${d} ${s} ${n} ${u}`.trim(),o),this.channels.filter(h=>h._isMember(s)).forEach(h=>h._trigger(n,o,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===co.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===co.open||this.conn.readyState===co.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Nn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${t}${s}${n}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([rD],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,s=!1;if(t)r=t,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const o={access_token:r,version:qR};r&&n.updateJoinPayload(o),n.joinedOnce&&n._isJoined()&&n._push(Nn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new jE(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Dh.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,n,o,l,u,d,h,m,x,y,b;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t?.timeout)!==null&&s!==void 0?s:_y,this.heartbeatIntervalMs=(n=t?.heartbeatIntervalMs)!==null&&n!==void 0?n:Dh.HEARTBEAT_INTERVAL,this.worker=(o=t?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(l=t?.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:Vx,this.vsn=(d=t?.vsn)!==null&&d!==void 0?d:BN,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=t?.reconnectAfterMs)!==null&&h!==void 0?h:(v=>eD[v-1]||tD),this.vsn){case EE:this.encode=(m=t?.encode)!==null&&m!==void 0?m:((v,g)=>g(JSON.stringify(v))),this.decode=(x=t?.decode)!==null&&x!==void 0?x:((v,g)=>g(JSON.parse(v)));break;case HR:this.encode=(y=t?.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(b=t?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var Cd=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function aD(e,t,r){const s=new URL(t,e);if(r)for(const[n,o]of Object.entries(r))o!==void 0&&s.searchParams.set(n,o);return s.toString()}async function nD(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function iD(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:n,body:o,headers:l}){const u=aD(e.baseUrl,s,n),d=await nD(e.auth),h=await t(u,{method:r,headers:{...o?{"Content-Type":"application/json"}:{},...d,...l},body:o?JSON.stringify(o):void 0}),m=await h.text(),x=(h.headers.get("content-type")||"").includes("application/json"),y=x&&m?JSON.parse(m):m;if(!h.ok){const b=x?y:void 0,v=b?.error;throw new Cd(v?.message??`Request failed with status ${h.status}`,{status:h.status,icebergType:v?.type,icebergCode:v?.code,details:b})}return{status:h.status,headers:h.headers,data:y}}}}function Oh(e){return e.join("")}var oD=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Oh(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Oh(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Oh(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Oh(e.namespace)}`}),!0}catch(t){if(t instanceof Cd&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Cd&&r.status===409)return;throw r}}};function hc(e){return e.join("")}var lD=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${hc(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${hc(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${hc(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${hc(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${hc(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${hc(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Cd&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Cd&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},cD=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=iD({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new oD(this.client,t),this.tableOps=new lD(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},rm=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Qr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var uD=class extends rm{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Sy=class extends rm{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const xv=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),dD=()=>Response,Ey=e=>{if(Array.isArray(e))return e.map(r=>Ey(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[n]=Ey(s)}),t},fD=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},hD=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Rd(e){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(e)}function mD(e,t){if(Rd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(Rd(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pD(e){var t=mD(e,"string");return Rd(t)=="symbol"?t:t+""}function xD(e,t,r){return(t=pD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Ht(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$N(Object(r),!0).forEach(function(s){xD(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$N(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const Kx=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},gD=async(e,t,r)=>{e instanceof await dD()&&!r?.noResolveJson?e.json().then(s=>{const n=e.status||500,o=s?.statusCode||n+"";t(new uD(Kx(s),n,o))}).catch(s=>{t(new Sy(Kx(s),s))}):t(new Sy(Kx(e),e))},yD=(e,t,r,s)=>{const n={method:e,headers:t?.headers||{}};return e==="GET"||!s?n:(fD(s)?(n.headers=Ht({"Content-Type":"application/json"},t?.headers),n.body=JSON.stringify(s)):n.body=s,t?.duplex&&(n.duplex=t.duplex),Ht(Ht({},n),r))};async function rf(e,t,r,s,n,o){return new Promise((l,u)=>{e(r,yD(t,s,n,o)).then(d=>{if(!d.ok)throw d;return s?.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>gD(d,u,s))})}async function Dd(e,t,r,s){return rf(e,"GET",t,r,s)}async function _n(e,t,r,s,n){return rf(e,"POST",t,s,n,r)}async function jy(e,t,r,s,n){return rf(e,"PUT",t,s,n,r)}async function vD(e,t,r,s){return rf(e,"HEAD",t,Ht(Ht({},r),{},{noResolveJson:!0}),s)}async function gv(e,t,r,s,n){return rf(e,"DELETE",t,s,n,r)}var bD=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Qr(t))return{data:null,error:t};throw t}}};let CE;CE=Symbol.toStringTag;var wD=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[CE]="BlobDownloadBuilder",this.promise=null}asStream(){return new bD(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Qr(t))return{data:null,error:t};throw t}}};const _D={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},qN={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var ND=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=xv(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,s){var n=this;try{let o;const l=Ht(Ht({},qN),s);let u=Ht(Ht({},n.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",l.cacheControl),d&&o.append("metadata",n.encodeMetadata(d)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.has("cacheControl")||o.append("cacheControl",l.cacheControl),d&&!o.has("metadata")&&o.append("metadata",n.encodeMetadata(d))):(o=r,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType,d&&(u["x-metadata"]=n.toBase64(n.encodeMetadata(d))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!l.duplex&&(l.duplex="half")),s?.headers&&(u=Ht(Ht({},u),s.headers));const h=n._removeEmptyFolders(t),m=n._getFinalPath(h),x=await(e=="PUT"?jy:_n)(n.fetch,`${n.url}/object/${m}`,o,Ht({headers:u},l?.duplex?{duplex:l.duplex}:{}));return{data:{path:h,id:x.Id,fullPath:x.Key},error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Qr(o))return{data:null,error:o};throw o}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,s){var n=this;const o=n._removeEmptyFolders(e),l=n._getFinalPath(o),u=new URL(n.url+`/object/upload/sign/${l}`);u.searchParams.set("token",t);try{let d;const h=Ht({upsert:qN.upsert},s),m=Ht(Ht({},n.headers),{"x-upsert":String(h.upsert)});return typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",h.cacheControl)):(d=r,m["cache-control"]=`max-age=${h.cacheControl}`,m["content-type"]=h.contentType),{data:{path:o,fullPath:(await jy(n.fetch,u.toString(),d,{headers:m})).Key},error:null}}catch(d){if(n.shouldThrowOnError)throw d;if(Qr(d))return{data:null,error:d};throw d}}async createSignedUploadUrl(e,t){var r=this;try{let s=r._getFinalPath(e);const n=Ht({},r.headers);t?.upsert&&(n["x-upsert"]="true");const o=await _n(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:n}),l=new URL(r.url+o.url),u=l.searchParams.get("token");if(!u)throw new rm("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:u},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Qr(s))return{data:null,error:s};throw s}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var s=this;try{return{data:await _n(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Qr(n))return{data:null,error:n};throw n}}async copy(e,t,r){var s=this;try{return{data:{path:(await _n(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:s.headers})).Key},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Qr(n))return{data:null,error:n};throw n}}async createSignedUrl(e,t,r){var s=this;try{let n=s._getFinalPath(e),o=await _n(s.fetch,`${s.url}/object/sign/${n}`,Ht({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:s.headers});const l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${s.url}${o.signedURL}${l}`)},{data:o,error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Qr(n))return{data:null,error:n};throw n}}async createSignedUrls(e,t,r){var s=this;try{const n=await _n(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:t,paths:e},{headers:s.headers}),o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(l=>Ht(Ht({},l),{},{signedUrl:l.signedURL?encodeURI(`${s.url}${l.signedURL}${o}`):null})),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Qr(n))return{data:null,error:n};throw n}}download(e,t){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(t?.transform||{}),n=s?`?${s}`:"",o=this._getFinalPath(e),l=()=>Dd(this.fetch,`${this.url}/${r}/${o}${n}`,{headers:this.headers,noResolveJson:!0});return new wD(l,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:Ey(await Dd(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Qr(s))return{data:null,error:s};throw s}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await vD(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Qr(s)&&s instanceof Sy){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],n=t?.download?`download=${t.download===!0?"":t.download}`:"";n!==""&&s.push(n);const o=typeof t?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(t?.transform||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${u}`)}}}async remove(e){var t=this;try{return{data:await gv(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async list(e,t,r){var s=this;try{const n=Ht(Ht(Ht({},_D),t),{},{prefix:e||""});return{data:await _n(s.fetch,`${s.url}/object/list/${s.bucketId}`,n,{headers:s.headers},r),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(Qr(n))return{data:null,error:n};throw n}}async listV2(e,t){var r=this;try{const s=Ht({},e);return{data:await _n(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},t),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Qr(s))return{data:null,error:s};throw s}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const RE="2.90.1",DE={"X-Client-Info":`storage-js/${RE}`};var kD=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const n=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=Ht(Ht({},DE),t),this.fetch=xv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await Dd(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Dd(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await _n(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Qr(s))return{data:null,error:s};throw s}}async updateBucket(e,t){var r=this;try{return{data:await jy(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Qr(s))return{data:null,error:s};throw s}}async emptyBucket(e){var t=this;try{return{data:await _n(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await gv(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},SD=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ht(Ht({},DE),t),this.fetch=xv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await _n(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const s=r.toString(),n=s?`${t.url}/bucket?${s}`:`${t.url}/bucket`;return{data:await Dd(t.fetch,n,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await gv(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Qr(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!hD(e))throw new rm("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new cD({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(n,o){const l=n[o];return typeof l!="function"?l:async(...u)=>{try{return{data:await l.apply(n,u),error:null}}catch(d){if(s)throw d;return{data:null,error:d}}}}})}};const yv={"X-Client-Info":`storage-js/${RE}`,"Content-Type":"application/json"};var OE=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Pa(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var Xx=class extends OE{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ED=class extends OE{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const vv=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),jD=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},HN=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),TD=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const s=e.status||500,n=e;if(typeof n.json=="function")n.json().then(o=>{const l=o?.statusCode||o?.code||s+"";t(new Xx(HN(o),s,l))}).catch(()=>{const o=s+"";t(new Xx(n.statusText||`HTTP ${s} error`,s,o))});else{const o=s+"";t(new Xx(n.statusText||`HTTP ${s} error`,s,o))}}else t(new ED(HN(e),e))},AD=(e,t,r,s)=>{const n={method:e,headers:t?.headers||{}};return s?(jD(s)?(n.headers=Ht({"Content-Type":"application/json"},t?.headers),n.body=JSON.stringify(s)):n.body=s,Ht(Ht({},n),r)):n};async function CD(e,t,r,s,n,o){return new Promise((l,u)=>{e(r,AD(t,s,n,o)).then(d=>{if(!d.ok)throw d;if(s?.noResolveJson)return d;const h=d.headers.get("content-type");return!h||!h.includes("application/json")?{}:d.json()}).then(d=>l(d)).catch(d=>TD(d,u,s))})}async function Ua(e,t,r,s,n){return CD(e,"POST",t,s,n,r)}var RD=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ht(Ht({},yv),t),this.fetch=vv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Ua(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Ua(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Pa(s))return{data:null,error:s};throw s}}async listIndexes(e){var t=this;try{return{data:await Ua(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Ua(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Pa(s))return{data:null,error:s};throw s}}},DD=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ht(Ht({},yv),t),this.fetch=vv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Ua(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Ua(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Ua(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Ua(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Ua(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}},OD=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ht(Ht({},yv),t),this.fetch=vv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Ua(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Ua(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Ua(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Ua(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Pa(r))return{data:null,error:r};throw r}}},FD=class extends OD{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new LD(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},LD=class extends RD{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new ID(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},ID=class extends DD{constructor(e,t,r,s,n){super(e,t,n),this.vectorBucketName=r,this.indexName=s}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},MD=class extends kD{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new ND(this.url,this.headers,e,this.fetch)}get vectors(){return new FD(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new SD(this.url+"/iceberg",this.headers,this.fetch)}};const FE="2.90.1",Tc=30*1e3,Ty=3,Yx=Ty*Tc,BD="http://localhost:9999",PD="supabase.auth.token",UD={"X-Client-Info":`gotrue-js/${FE}`},Ay="X-Supabase-Api-Version",LE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},zD=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,$D=600*1e3;class Od extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function It(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class qD extends Od{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function HD(e){return It(e)&&e.name==="AuthApiError"}class Zo extends Od{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ai extends Od{constructor(t,r,s,n){super(t,s,n),this.name=r,this.status=s}}class Ia extends Ai{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function WD(e){return It(e)&&e.name==="AuthSessionMissingError"}class mc extends Ai{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Fh extends Ai{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Lh extends Ai{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function GD(e){return It(e)&&e.name==="AuthImplicitGrantRedirectError"}class WN extends Ai{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class VD extends Ai{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Cy extends Ai{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Jx(e){return It(e)&&e.name==="AuthRetryableFetchError"}class GN extends Ai{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class Ry extends Ai{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const T0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),VN=` 	
\r=`.split(""),KD=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<VN.length;t+=1)e[VN[t].charCodeAt(0)]=-2;for(let t=0;t<T0.length;t+=1)e[T0[t].charCodeAt(0)]=t;return e})();function KN(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(T0[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(T0[s]),t.queuedBits-=6}}function IE(e,t,r){const s=KD[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function XN(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},o=l=>{JD(l,s,r)};for(let l=0;l<e.length;l+=1)IE(e.charCodeAt(l),n,o);return t.join("")}function XD(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function YD(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}XD(s,t)}}function JD(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let s=1;s<6;s+=1)if((e>>7-s&1)===0){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Fc(e){const t=[],r={queue:0,queuedBits:0},s=n=>{t.push(n)};for(let n=0;n<e.length;n+=1)IE(e.charCodeAt(n),r,s);return new Uint8Array(t)}function ZD(e){const t=[];return YD(e,r=>t.push(r)),new Uint8Array(t)}function tl(e){const t=[],r={queue:0,queuedBits:0},s=n=>{t.push(n)};return e.forEach(n=>KN(n,r,s)),KN(null,r,s),t.join("")}function QD(e){return Math.round(Date.now()/1e3)+e}function eO(){return Symbol("auth-callback")}const qs=()=>typeof window<"u"&&typeof document<"u",$o={tested:!1,writable:!1},ME=()=>{if(!qs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if($o.tested)return $o.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),$o.tested=!0,$o.writable=!0}catch{$o.tested=!0,$o.writable=!1}return $o.writable};function tO(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,o)=>{t[o]=n})}catch{}return r.searchParams.forEach((s,n)=>{t[n]=s}),t}const BE=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),rO=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ac=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},qo=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},$s=async(e,t)=>{await e.removeItem(t)};class sm{constructor(){this.promise=new sm.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}sm.promiseConstructor=Promise;function Zx(e){const t=e.split(".");if(t.length!==3)throw new Ry("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!zD.test(t[s]))throw new Ry("JWT not in base64url format");return{header:JSON.parse(XN(t[0])),payload:JSON.parse(XN(t[1])),signature:Fc(t[2]),raw:{header:t[0],payload:t[1]}}}async function sO(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function aO(e,t){return new Promise((s,n)=>{(async()=>{for(let o=0;o<1/0;o++)try{const l=await e(o);if(!t(o,null,l)){s(l);return}}catch(l){if(!t(o,l)){n(l);return}}})()})}function nO(e){return("0"+e.toString(16)).substr(-2)}function iO(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let o=0;o<56;o++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(t),Array.from(t,nO).join("")}async function oO(e){const r=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(o=>String.fromCharCode(o)).join("")}async function lO(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await oO(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function pc(e,t,r=!1){const s=iO();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await Ac(e,`${t}-code-verifier`,n);const o=await lO(s);return[o,s===o?"plain":"s256"]}const cO=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function uO(e){const t=e.headers.get(Ay);if(!t||!t.match(cO))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function dO(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function fO(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const hO=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xc(e){if(!hO.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Qx(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function mO(e,t){return new Proxy(e,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const o=s.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,s,n)}})}function YN(e){return JSON.parse(JSON.stringify(e))}const Yo=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),pO=[502,503,504];async function JN(e){var t;if(!rO(e))throw new Cy(Yo(e),0);if(pO.includes(e.status))throw new Cy(Yo(e),e.status);let r;try{r=await e.json()}catch(o){throw new Zo(Yo(o),o)}let s;const n=uO(e);if(n&&n.getTime()>=LE["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new GN(Yo(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new Ia}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,l)=>o&&typeof l=="string",!0))throw new GN(Yo(r),e.status,r.weak_password.reasons);throw new qD(Yo(r),e.status||500,s)}const xO=(e,t,r,s)=>{const n={method:e,headers:t?.headers||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function qt(e,t,r,s){var n;const o=Object.assign({},s?.headers);o[Ay]||(o[Ay]=LE["2024-01-01"].name),s?.jwt&&(o.Authorization=`Bearer ${s.jwt}`);const l=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(l.redirect_to=s.redirectTo);const u=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await gO(e,t,r+u,{headers:o,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(d):{data:Object.assign({},d),error:null}}async function gO(e,t,r,s,n,o){const l=xO(t,s,n,o);let u;try{u=await e(r,Object.assign({},l))}catch(d){throw console.error(d),new Cy(Yo(d),0)}if(u.ok||await JN(u),s?.noResolveJson)return u;try{return await u.json()}catch(d){await JN(d)}}function wn(e){var t;let r=null;bO(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=QD(e.expires_in)));const s=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:s},error:null}}function ZN(e){const t=wn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=e.weak_password),t}function uo(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function yO(e){return{data:e,error:null}}function vO(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:o}=e,l=tm(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:o},d=Object.assign({},l);return{data:{properties:u,user:d},error:null}}function QN(e){return e}function bO(e){return e.access_token&&e.refresh_token&&e.expires_in}const eg=["global","local","others"];class wO{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=BE(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=eg[0]){if(eg.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${eg.join(", ")}`);try{return await qt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(It(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await qt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:uo})}catch(s){if(It(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=tm(t,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await qt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:vO,redirectTo:r?.redirectTo})}catch(r){if(It(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await qt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:uo})}catch(r){if(It(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,n,o,l,u,d;try{const h={nextPage:null,lastPage:0,total:0},m=await qt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(o=(n=t?.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:QN});if(m.error)throw m.error;const x=await m.json(),y=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,b=(d=(u=m.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return b.length>0&&(b.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(v.split(";")[1].split("=")[1]);h[`${_}Page`]=g}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},x),h),error:null}}catch(h){if(It(h))return{data:{users:[]},error:h};throw h}}async getUserById(t){xc(t);try{return await qt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:uo})}catch(r){if(It(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){xc(t);try{return await qt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:uo})}catch(s){if(It(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){xc(t);try{return await qt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:uo})}catch(s){if(It(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){xc(t.userId);try{const{data:r,error:s}=await qt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(It(r))return{data:null,error:r};throw r}}async _deleteFactor(t){xc(t.userId),xc(t.id);try{return{data:await qt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(It(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,n,o,l,u,d;try{const h={nextPage:null,lastPage:0,total:0},m=await qt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(o=(n=t?.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:QN});if(m.error)throw m.error;const x=await m.json(),y=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,b=(d=(u=m.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return b.length>0&&(b.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(v.split(";")[1].split("=")[1]);h[`${_}Page`]=g}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},x),h),error:null}}catch(h){if(It(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(t){try{return await qt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(It(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await qt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(It(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await qt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(It(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await qt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(It(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await qt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(It(r))return{data:null,error:r};throw r}}}function e4(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const gc={debug:!!(globalThis&&ME()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class PE extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class _O extends PE{}async function NO(e,t,r){gc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),gc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){gc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{gc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(t===0)throw gc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new _O(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(gc.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function kO(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function UE(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function SO(e){return parseInt(e,16)}function EO(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function jO(e){var t;const{chainId:r,domain:s,expirationTime:n,issuedAt:o=new Date,nonce:l,notBefore:u,requestId:d,resources:h,scheme:m,uri:x,version:y}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const b=UE(e.address),v=m?`${m}://${s}`:s,g=e.statement?`${e.statement}
`:"",_=`${v} wants you to sign in with your Ethereum account:
${b}

${g}`;let w=`URI: ${x}
Version: ${y}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${o.toISOString()}`;if(n&&(w+=`
Expiration Time: ${n.toISOString()}`),u&&(w+=`
Not Before: ${u.toISOString()}`),d&&(w+=`
Request ID: ${d}`),h){let S=`
Resources:`;for(const N of h){if(!N||typeof N!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${N}`);S+=`
- ${N}`}w+=S}return`${_}
${w}`}class Es extends Error{constructor({message:t,code:r,cause:s,name:n}){var o;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(o=n??(s instanceof Error?s.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=r}}class A0 extends Es{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function TO({error:e,options:t}){var r,s,n;const{publicKey:o}=t;if(!o)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Es({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Es({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Es({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Es({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Es({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Es({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return o.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new Es({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Es({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(zE(l)){if(o.rp.id!==l)return new Es({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Es({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new Es({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Es({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Es({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function AO({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Es({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Es({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(zE(s)){if(r.rpId!==s)return new Es({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Es({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Es({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Es({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class CO{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const RO=new CO;function DO(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,n=tm(e,["challenge","user","excludeCredentials"]),o=Fc(t).buffer,l=Object.assign(Object.assign({},r),{id:Fc(r.id).buffer}),u=Object.assign(Object.assign({},n),{challenge:o,user:l});if(s&&s.length>0){u.excludeCredentials=new Array(s.length);for(let d=0;d<s.length;d++){const h=s[d];u.excludeCredentials[d]=Object.assign(Object.assign({},h),{id:Fc(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return u}function OO(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=tm(e,["challenge","allowCredentials"]),n=Fc(t).buffer,o=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){o.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const u=r[l];o.allowCredentials[l]=Object.assign(Object.assign({},u),{id:Fc(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function FO(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:tl(new Uint8Array(e.response.attestationObject)),clientDataJSON:tl(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function LO(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,s=e.getClientExtensionResults(),n=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:tl(new Uint8Array(n.authenticatorData)),clientDataJSON:tl(new Uint8Array(n.clientDataJSON)),signature:tl(new Uint8Array(n.signature)),userHandle:n.userHandle?tl(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function zE(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function t4(){var e,t;return!!(qs()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function IO(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new A0("Browser returned unexpected credential type",t)}:{data:null,error:new A0("Empty credential response",t)}}catch(t){return{data:null,error:TO({error:t,options:e})}}}async function MO(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new A0("Browser returned unexpected credential type",t)}:{data:null,error:new A0("Empty credential response",t)}}catch(t){return{data:null,error:AO({error:t,options:e})}}}const BO={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},PO={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function C0(...e){const t=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of e)if(n)for(const o in n){const l=n[o];if(l!==void 0)if(Array.isArray(l))s[o]=l;else if(r(l))s[o]=l;else if(t(l)){const u=s[o];t(u)?s[o]=C0(u,l):s[o]=C0(l)}else s[o]=l}return s}function UO(e,t){return C0(BO,e,t||{})}function zO(e,t){return C0(PO,e,t||{})}class $O{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:n},o){try{const{data:l,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:u};const d=n??RO.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:h}=l.webauthn.credential_options.publicKey;h.name||(h.name=`${h.id}:${s}`),h.displayName||(h.displayName=h.name)}switch(l.webauthn.type){case"create":{const h=UO(l.webauthn.credential_options.publicKey,o?.create),{data:m,error:x}=await IO({publicKey:h,signal:d});return m?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:x}}case"request":{const h=zO(l.webauthn.credential_options.publicKey,o?.request),{data:m,error:x}=await MO(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:h,signal:d}));return m?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:x}}}}catch(l){return It(l)?{data:null,error:l}:{data:null,error:new Zo("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},o){if(!r)return{data:null,error:new Od("rpId is required for WebAuthn authentication")};try{if(!t4())return{data:null,error:new Zo("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:o});if(!l)return{data:null,error:u};const{webauthn:d}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:d.type,rpId:r,rpOrigins:s,credential_response:d.credential_response}})}catch(l){return It(l)?{data:null,error:l}:{data:null,error:new Zo("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},o){if(!r)return{data:null,error:new Od("rpId is required for WebAuthn registration")};try{if(!t4())return{data:null,error:new Zo("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(m=>{var x;return(x=m.data)===null||x===void 0?void 0:x.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===t&&y.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m?.id}):void 0),{data:null,error:u};const{data:d,error:h}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:o});return d?this._verify({factorId:l.id,challengeId:d.challengeId,webauthn:{rpId:r,rpOrigins:s,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:h}}catch(l){return It(l)?{data:null,error:l}:{data:null,error:new Zo("Unexpected error in register",l)}}}}kO();const qO={url:BD,storageKey:PD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:UD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function r4(e,t,r){return await r()}const yc={};class Fd{get jwks(){var t,r;return(r=(t=yc[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){yc[this.storageKey]=Object.assign(Object.assign({},yc[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=yc[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){yc[this.storageKey]=Object.assign(Object.assign({},yc[this.storageKey]),{cachedAt:t})}constructor(t){var r,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},qO),t);if(this.storageKey=o.storageKey,this.instanceID=(r=Fd.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Fd.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&qs()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new wO({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=BE(o.fetch),this.lock=o.lock||r4,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,this.lockAcquireTimeout=o.lockAcquireTimeout,o.lock?this.lock=o.lock:this.persistSession&&qs()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=NO:this.lock=r4,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new $O(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:ME()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=e4(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=e4(this.memoryStorage)),qs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${FE}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},s="none";if(qs()&&(r=tO(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),qs()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:o}=await this._getSessionFromURL(r,s);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),GD(o)){const d=(t=o.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:o}}return{error:o}}const{session:l,redirectType:u}=n;return this._debug("#_initialize()","detected session in URL",l,"redirect type",u),await this._saveSession(l),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return It(r)?this._returnResult({error:r}):this._returnResult({error:new Zo("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,n;try{const o=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=t?.options)===null||n===void 0?void 0:n.captchaToken}},xform:wn}),{data:l,error:u}=o;if(u||!l)return this._returnResult({data:{user:null,session:null},error:u});const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(o){if(It(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(t){var r,s,n;try{let o;if("email"in t){const{email:m,password:x,options:y}=t;let b=null,v=null;this.flowType==="pkce"&&([b,v]=await pc(this.storage,this.storageKey)),o=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:m,password:x,data:(r=y?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:b,code_challenge_method:v},xform:wn})}else if("phone"in t){const{phone:m,password:x,options:y}=t;o=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:x,data:(s=y?.data)!==null&&s!==void 0?s:{},channel:(n=y?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:wn})}else throw new Fh("You must provide either an email or phone number and a password");const{data:l,error:u}=o;if(u||!l)return await $s(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(o){if(await $s(this.storage,`${this.storageKey}-code-verifier`),It(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(t){try{let r;if("email"in t){const{email:o,password:l,options:u}=t;r=await qt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:ZN})}else if("phone"in t){const{phone:o,password:l,options:u}=t;r=await qt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:ZN})}else throw new Fh("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const o=new mc;return this._returnResult({data:{user:null,session:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(It(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,s,n,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,n,o,l,u,d,h,m,x,y;let b,v;if("message"in t)b=t.message,v=t.signature;else{const{chain:g,wallet:_,statement:w,options:S}=t;let N;if(qs())if(typeof _=="object")N=_;else{const L=window;if("ethereum"in L&&typeof L.ethereum=="object"&&"request"in L.ethereum&&typeof L.ethereum.request=="function")N=L.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!S?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=_}const E=new URL((r=S?.url)!==null&&r!==void 0?r:window.location.href),C=await N.request({method:"eth_requestAccounts"}).then(L=>L).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const F=UE(C[0]);let O=(s=S?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!O){const L=await N.request({method:"eth_chainId"});O=SO(L)}const B={domain:E.host,address:F,statement:w,uri:E.href,version:"1",chainId:O,nonce:(n=S?.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(l=(o=S?.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(u=S?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(d=S?.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(h=S?.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(m=S?.signInWithEthereum)===null||m===void 0?void 0:m.resources};b=jO(B),v=await N.request({method:"personal_sign",params:[EO(b),F]})}try{const{data:g,error:_}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:v},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:wn});if(_)throw _;if(!g||!g.session||!g.user){const w=new mc;return this._returnResult({data:{user:null,session:null},error:w})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:_})}catch(g){if(It(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(t){var r,s,n,o,l,u,d,h,m,x,y,b;let v,g;if("message"in t)v=t.message,g=t.signature;else{const{chain:_,wallet:w,statement:S,options:N}=t;let E;if(qs())if(typeof w=="object")E=w;else{const F=window;if("solana"in F&&typeof F.solana=="object"&&("signIn"in F.solana&&typeof F.solana.signIn=="function"||"signMessage"in F.solana&&typeof F.solana.signMessage=="function"))E=F.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!N?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=w}const C=new URL((r=N?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in E&&E.signIn){const F=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N?.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),S?{statement:S}:null));let O;if(Array.isArray(F)&&F[0]&&typeof F[0]=="object")O=F[0];else if(F&&typeof F=="object"&&"signedMessage"in F&&"signature"in F)O=F;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)v=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),g=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${C.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...S?["",S,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(n=(s=N?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((o=N?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((l=N?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((u=N?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((d=N?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((h=N?.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((x=(m=N?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||x===void 0)&&x.length?["Resources",...N.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const F=await E.signMessage(new TextEncoder().encode(v),"utf8");if(!F||!(F instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=F}}try{const{data:_,error:w}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:tl(g)},!((y=t.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:wn});if(w)throw w;if(!_||!_.session||!_.user){const S=new mc;return this._returnResult({data:{user:null,session:null},error:S})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:w})}catch(_){if(It(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async _exchangeCodeForSession(t){const r=await qo(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new VD;const{data:o,error:l}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:wn});if(await $s(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!o||!o.session||!o.user){const u=new mc;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:n??null}),error:l})}catch(o){if(await $s(this.storage,`${this.storageKey}-code-verifier`),It(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(t){try{const{options:r,provider:s,token:n,access_token:o,nonce:l}=t,u=await qt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:o,nonce:l,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:wn}),{data:d,error:h}=u;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!d||!d.session||!d.user){const m=new mc;return this._returnResult({data:{user:null,session:null},error:m})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:h})}catch(r){if(It(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,s,n,o,l;try{if("email"in t){const{email:u,options:d}=t;let h=null,m=null;this.flowType==="pkce"&&([h,m]=await pc(this.storage,this.storageKey));const{error:x}=await qt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=d?.data)!==null&&r!==void 0?r:{},create_user:(s=d?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:h,code_challenge_method:m},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in t){const{phone:u,options:d}=t,{data:h,error:m}=await qt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(n=d?.data)!==null&&n!==void 0?n:{},create_user:(o=d?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(l=d?.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:m})}throw new Fh("You must provide either an email or phone number.")}catch(u){if(await $s(this.storage,`${this.storageKey}-code-verifier`),It(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var r,s;try{let n,o;"options"in t&&(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo,o=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:l,error:u}=await qt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:n,xform:wn});if(u)throw u;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,h=l.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(n){if(It(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(t){var r,s,n,o,l;try{let u=null,d=null;this.flowType==="pkce"&&([u,d]=await pc(this.storage,this.storageKey));const h=await qt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=t?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:d}),headers:this.headers,xform:yO});return!((o=h.data)===null||o===void 0)&&o.url&&qs()&&!(!((l=t.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(u){if(await $s(this.storage,`${this.storageKey}-code-verifier`),It(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new Ia;const{error:n}=await qt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(t){if(It(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:n,options:o}=t,{error:l}=await qt(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in t){const{phone:s,type:n,options:o}=t,{data:l,error:u}=await qt(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l?.message_id},error:u})}throw new Fh("You must provide either an email or phone number and a type")}catch(r){if(It(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await qo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<Yx:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const l=await qo(this.userStorage,this.storageKey+"-user");l?.user?t.user=l.user:t.user=Qx()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};t.user=mO(t.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:n,error:o}=await this._callRefreshToken(t.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await qt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:uo}):await this._useSession(async r=>{var s,n,o;const{data:l,error:u}=r;if(u)throw u;return!(!((s=l.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ia}:await qt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0,xform:uo})})}catch(r){if(It(r))return WD(r)&&(await this._removeSession(),await $s(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:n,error:o}=s;if(o)throw o;if(!n.session)throw new Ia;const l=n.session;let u=null,d=null;this.flowType==="pkce"&&t.email!=null&&([u,d]=await pc(this.storage,this.storageKey));const{data:h,error:m}=await qt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:d}),jwt:l.access_token,xform:uo});if(m)throw m;return l.user=h.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(s){if(await $s(this.storage,`${this.storageKey}-code-verifier`),It(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ia;const r=Date.now()/1e3;let s=r,n=!0,o=null;const{payload:l}=Zx(t.access_token);if(l.exp&&(s=l.exp,n=s<=r),n){const{data:u,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!u)return{data:{user:null,session:null},error:null};o=u}else{const{data:u,error:d}=await this._getUser(t.access_token);if(d)throw d;o={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(r){if(It(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:l,error:u}=r;if(u)throw u;t=(s=l.session)!==null&&s!==void 0?s:void 0}if(!t?.refresh_token)throw new Ia;const{data:n,error:o}=await this._callRefreshToken(t.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(It(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!qs())throw new Lh("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Lh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new WN("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Lh("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new WN("No code detected.");const{data:S,error:N}=await this._exchangeCodeForSession(t.code);if(N)throw N;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:S.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:o,refresh_token:l,expires_in:u,expires_at:d,token_type:h}=t;if(!o||!u||!l||!h)throw new Lh("No session defined in URL");const m=Math.round(Date.now()/1e3),x=parseInt(u);let y=m+x;d&&(y=parseInt(d));const b=y-m;b*1e3<=Tc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${x}s`);const v=y-x;m-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,y,m):m-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,y,m);const{data:g,error:_}=await this._getUser(o);if(_)throw _;const w={provider_token:s,provider_refresh_token:n,access_token:o,expires_in:x,expires_at:y,refresh_token:l,token_type:h,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:t.type},error:null})}catch(s){if(It(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await qo(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:o}=r;if(o)return this._returnResult({error:o});const l=(s=n.session)===null||s===void 0?void 0:s.access_token;if(l){const{error:u}=await this.admin.signOut(l,t);if(u&&!(HD(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await $s(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=eO(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,n;try{const{data:{session:o},error:l}=r;if(l)throw l;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await pc(this.storage,this.storageKey,!0));try{return await qt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(await $s(this.storage,`${this.storageKey}-code-verifier`),It(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(It(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:n}=await this._useSession(async o=>{var l,u,d,h,m;const{data:x,error:y}=o;if(y)throw y;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await qt(this.fetch,"GET",b,{headers:this.headers,jwt:(m=(h=x.session)===null||h===void 0?void 0:h.access_token)!==null&&m!==void 0?m:void 0})});if(n)throw n;return qs()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:t.provider,url:s?.url},error:null})}catch(s){if(It(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:o}}=r;if(n)throw n;const{options:l,provider:u,token:d,access_token:h,nonce:m}=t,x=await qt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=o?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:u,id_token:d,access_token:h,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:wn}),{data:y,error:b}=x;return b?this._returnResult({data:{user:null,session:null},error:b}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new mc}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:b}))}catch(n){if(await $s(this.storage,`${this.storageKey}-code-verifier`),It(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,n;const{data:o,error:l}=r;if(l)throw l;return await qt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(It(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await aO(async n=>(n>0&&await sO(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await qt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:wn})),(n,o)=>{const l=200*Math.pow(2,n);return o&&Jx(o)&&Date.now()+l-s<Tc})}catch(s){if(this._debug(r,"error",s),It(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),qs()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await qo(this.storage,this.storageKey);if(n&&this.userStorage){let l=await qo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:n.user},await Ac(this.userStorage,this.storageKey+"-user",l)),n.user=(t=l?.user)!==null&&t!==void 0?t:Qx()}else if(n&&!n.user&&!n.user){const l=await qo(this.storage,this.storageKey+"-user");l&&l?.user?(n.user=l.user,await $s(this.storage,this.storageKey+"-user"),await Ac(this.storage,this.storageKey,n)):n.user=Qx()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const o=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Yx;if(this._debug(s,`session has${o?"":" not"} expired with margin of ${Yx}s`),o){if(this.autoRefreshToken&&n.refresh_token){const{error:l}=await this._callRefreshToken(n.refresh_token);l&&(console.error(l),Jx(l)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:u}=await this._getUser(n.access_token);!u&&l?.user?(n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(s,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new Ia;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new sm;const{data:o,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!o.session)throw new Ia;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const u={data:o.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(o){if(this._debug(n,"error",o),It(o)){const l={data:null,error:o};return Jx(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(o),o}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,r,s=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const o=[],l=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(d){o.push(d)}});if(await Promise.all(l),o.length>0){for(let u=0;u<o.length;u+=1)console.error(o[u]);throw o[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await $s(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Ac(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const o=YN(n);await Ac(this.storage,this.storageKey,o)}else{const n=YN(r);await Ac(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await $s(this.storage,this.storageKey),await $s(this.storage,this.storageKey+"-code-verifier"),await $s(this.storage,this.storageKey+"-user"),this.userStorage&&await $s(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&qs()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Tc);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-t)/Tc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Tc}ms, refresh threshold is ${Ty} ticks`),n<=Ty&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof PE)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qs()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[o,l]=await pc(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(l)}`});n.push(u.toString())}if(s?.queryParams){const o=new URLSearchParams(s.queryParams);n.push(o.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:n,error:o}=r;return o?this._returnResult({data:null,error:o}):await qt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(It(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,n;const{data:o,error:l}=r;if(l)return this._returnResult({data:null,error:l});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:h}=await qt(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(s=o?.session)===null||s===void 0?void 0:s.access_token});return h?this._returnResult({data:null,error:h}):(t.factorType==="totp"&&d.type==="totp"&&(!((n=d?.totp)===null||n===void 0)&&n.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(r){if(It(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?FO(t.webauthn.credential_response):LO(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:d}=await qt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:d}))})}catch(r){if(It(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=await qt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});if(l.error)return l;const{data:u}=l;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:DO(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:OO(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(It(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const o of(t=r?.factors)!==null&&t!==void 0?t:[])n.all.push(o),o.status==="verified"&&n[o.factor_type].push(o);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Zx(s.access_token);let l=null;o.aal&&(l=o.aal);let u=l;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(m=>m.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const h=o.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await qt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new Ia})})}catch(r){if(It(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:n},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!n)return this._returnResult({data:null,error:new Ia});const l=await qt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return l.data&&l.data.redirect_url&&qs()&&!r?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(s){if(It(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:n},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!n)return this._returnResult({data:null,error:new Ia});const l=await qt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return l.data&&l.data.redirect_url&&qs()&&!r?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(s){if(It(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await qt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new Ia})})}catch(t){if(It(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?(await qt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ia})})}catch(r){if(It(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(u=>u.kid===t);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(u=>u.kid===t),s&&this.jwks_cached_at+$D>n)return s;const{data:o,error:l}=await qt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=n,s=o.keys.find(u=>u.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:b,error:v}=await this.getSession();if(v||!b.session)return this._returnResult({data:null,error:v});s=b.session.access_token}const{header:n,payload:o,signature:l,raw:{header:u,payload:d}}=Zx(s);r?.allowExpired||dO(o.exp);const h=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!h){const{error:b}=await this.getUser(s);if(b)throw b;return{data:{claims:o,header:n,signature:l},error:null}}const m=fO(n.alg),x=await crypto.subtle.importKey("jwk",h,m,!0,["verify"]);if(!await crypto.subtle.verify(m,x,l,ZD(`${u}.${d}`)))throw new Ry("Invalid JWT signature");return{data:{claims:o,header:n,signature:l},error:null}}catch(s){if(It(s))return this._returnResult({data:null,error:s});throw s}}}Fd.nextInstanceID={};const HO=Fd,WO="2.90.1";let dd="";typeof Deno<"u"?dd="deno":typeof document<"u"?dd="web":typeof navigator<"u"&&navigator.product==="ReactNative"?dd="react-native":dd="node";const GO={"X-Client-Info":`supabase-js-${dd}/${WO}`},VO={headers:GO},KO={schema:"public"},XO={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},YO={};function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ld(e)}function JO(e,t){if(Ld(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(Ld(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZO(e){var t=JO(e,"string");return Ld(t)=="symbol"?t:t+""}function QO(e,t,r){return(t=ZO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ns(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s4(Object(r),!0).forEach(function(s){QO(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s4(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const e7=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),t7=()=>Headers,r7=(e,t,r)=>{const s=e7(r),n=t7();return async(o,l)=>{var u;const d=(u=await t())!==null&&u!==void 0?u:e;let h=new n(l?.headers);return h.has("apikey")||h.set("apikey",e),h.has("Authorization")||h.set("Authorization",`Bearer ${d}`),s(o,ns(ns({},l),{},{headers:h}))}};function s7(e){return e.endsWith("/")?e:e+"/"}function a7(e,t){var r,s;const{db:n,auth:o,realtime:l,global:u}=e,{db:d,auth:h,realtime:m,global:x}=t,y={db:ns(ns({},d),n),auth:ns(ns({},h),o),realtime:ns(ns({},m),l),storage:{},global:ns(ns(ns({},x),u),{},{headers:ns(ns({},(r=x?.headers)!==null&&r!==void 0?r:{}),(s=u?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return e.accessToken?y.accessToken=e.accessToken:delete y.accessToken,y}function n7(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(s7(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var i7=class extends HO{constructor(e){super(e)}},o7=class{constructor(e,t,r){var s,n;this.supabaseUrl=e,this.supabaseKey=t;const o=n7(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,u={db:KO,realtime:YO,auth:ns(ns({},XO),{},{storageKey:l}),global:VO},d=a7(r??{},u);if(this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(n=d.global.headers)!==null&&n!==void 0?n:{},d.accessToken)this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(m,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}});else{var h;this.auth=this._initSupabaseAuthClient((h=d.auth)!==null&&h!==void 0?h:{},this.headers,d.global.fetch)}this.fetch=r7(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(ns({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(m=>this.realtime.setAuth(m)).catch(m=>console.warn("Failed to set initial Realtime auth token:",m)),this.rest=new UR(new URL("rest/v1",o).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new MD(this.storageUrl.href,this.headers,this.fetch,r?.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new LR(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:s}=await e.auth.getSession();return(t=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:n,storageKey:o,flowType:l,lock:u,debug:d,throwOnError:h},m,x){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new i7({url:this.authUrl.href,headers:ns(ns({},y),m),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:n,flowType:l,lock:u,debug:d,throwOnError:h,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new sD(this.realtimeUrl.href,ns(ns({},e),{},{params:ns(ns({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const l7=(e,t,r)=>new o7(e,t,r);function c7(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}c7()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const u7="https://khwzdwewgadvpglptvua.supabase.co",d7="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtod3pkd2V3Z2FkdnBnbHB0dnVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyNDIxODAsImV4cCI6MjA4MzgxODE4MH0.EiDPa3pJuEDNzfM-mho7PZ0NR83MGAH2XPf1lvP-9l4",Pe=l7(u7,d7),$E=K.createContext({}),f7=({children:e})=>{const[t,r]=K.useState(null),[s,n]=K.useState(null),[o,l]=K.useState(!0);K.useEffect(()=>{const y=localStorage.getItem("user");if(y){const b=JSON.parse(y);r(b),n(b)}l(!1)},[]);const x={user:t,profile:s,loading:o,signInWithPassword:async(y,b)=>{try{const{data:v,error:g}=await Pe.from("users").select("id, user_id, name, team, rank, role, password, created_at").eq("user_id",y).single();if(g||!v)return{error:{message:"    ."}};if(v.password&&v.password.startsWith("$2")){if(!await Wx.compare(b,v.password))return{error:{message:"    ."}}}else{if(v.password!==b)return{error:{message:"    ."}};const N=await Wx.hash(b,10);await Pe.from("users").update({password:N}).eq("user_id",y)}const{password:w,...S}=v;return localStorage.setItem("user",JSON.stringify(S)),r(S),n(S),{data:S,error:null}}catch{return{error:{message:"   ."}}}},signUp:async({id:y,password:b,name:v,team:g,rank:_})=>{try{const{data:w}=await Pe.from("users").select("user_id").eq("user_id",y).single();if(w)return{error:{message:"   ."}};const S=await Wx.hash(b,10),{data:N,error:E}=await Pe.from("users").insert([{user_id:y,password:S,name:v,team:g,rank:_,role:"user",created_at:new Date().toISOString()}]).select().single();return E?{error:{message:"   ."}}:{data:N,error:null}}catch{return{error:{message:"   ."}}}},signOut:async()=>(localStorage.removeItem("user"),r(null),n(null),{error:null}),updateProfile:async y=>{if(!t||!t.user_id)return{data:null,error:{message:" ."}};const{data:b,error:v}=await Pe.from("users").update(y).eq("user_id",t.user_id).select().single();if(!v&&b){const g={...t,...b};localStorage.setItem("user",JSON.stringify(g)),r(g),n(g)}return{data:b,error:v}},isAdmin:s?.role==="admin",isSubAdmin:s?.role==="sub_admin"};return a.jsx($E.Provider,{value:x,children:e})},qr=()=>{const e=K.useContext($E);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};const h7=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),m7=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,s)=>s?s.toUpperCase():r.toLowerCase()),a4=e=>{const t=m7(e);return t.charAt(0).toUpperCase()+t.slice(1)},qE=(...e)=>e.filter((t,r,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===r).join(" ").trim(),p7=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var x7={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const g7=K.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:n="",children:o,iconNode:l,...u},d)=>K.createElement("svg",{ref:d,...x7,width:t,height:t,stroke:e,strokeWidth:s?Number(r)*24/Number(t):r,className:qE("lucide",n),...!o&&!p7(u)&&{"aria-hidden":"true"},...u},[...l.map(([h,m])=>K.createElement(h,m)),...Array.isArray(o)?o:[o]]));const Tt=(e,t)=>{const r=K.forwardRef(({className:s,...n},o)=>K.createElement(g7,{ref:o,iconNode:t,className:qE(`lucide-${h7(a4(e))}`,`lucide-${e}`,s),...n}));return r.displayName=a4(e),r};const y7=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],n4=Tt("arrow-down",y7);const v7=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],sf=Tt("arrow-left",v7);const b7=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],HE=Tt("arrow-right",b7);const w7=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],i4=Tt("arrow-up",w7);const _7=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],N7=Tt("award",_7);const k7=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],WE=Tt("book-open",k7);const S7=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],GE=Tt("briefcase",S7);const E7=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],fl=Tt("building-2",E7);const j7=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],o4=Tt("building",j7);const T7=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],VE=Tt("calendar-days",T7);const A7=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ma=Tt("calendar",A7);const C7=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],R7=Tt("camera",C7);const D7=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],R0=Tt("check",D7);const O7=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Cn=Tt("chevron-down",O7);const F7=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],xa=Tt("chevron-left",F7);const L7=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Js=Tt("chevron-right",L7);const I7=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Wn=Tt("chevron-up",I7);const M7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Sn=Tt("circle-alert",M7);const B7=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ws=Tt("circle-check-big",B7);const P7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],D0=Tt("circle-plus",P7);const U7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],fo=Tt("circle-x",U7);const z7=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],p0=Tt("clipboard-list",z7);const $7=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ra=Tt("clock",$7);const q7=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],am=Tt("copy",q7);const H7=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Jr=Tt("download",H7);const W7=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],rl=Tt("external-link",W7);const G7=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],nm=Tt("eye",G7);const V7=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],K7=Tt("file-down",V7);const X7=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],im=Tt("file-spreadsheet",X7);const Y7=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Gs=Tt("file-text",Y7);const J7=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],Ea=Tt("file",J7);const Z7=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Q7=Tt("folder-open",Z7);const eF=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],tF=Tt("folder",eF);const rF=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],sF=Tt("funnel",rF);const aF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Dy=Tt("globe",aF);const nF=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],l4=Tt("history",nF);const iF=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],KE=Tt("house",iF);const oF=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],XE=Tt("image",oF);const lF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],cF=Tt("info",lF);const uF=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],dF=Tt("lock-open",uF);const fF=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],hl=Tt("lock",fF);const hF=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Lc=Tt("log-out",hF);const mF=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Oy=Tt("mail",mF);const pF=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Id=Tt("map-pin",pF);const xF=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],YE=Tt("maximize-2",xF);const gF=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],yF=Tt("megaphone",gF);const vF=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],Hc=Tt("paperclip",vF);const bF=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Wc=Tt("pen-line",bF);const wF=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],js=Tt("pen",wF);const _F=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],O0=Tt("phone",_F);const NF=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],c4=Tt("pin",NF);const kF=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],os=Tt("plus",kF);const SF=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],ia=Tt("printer",SF);const EF=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],il=Tt("refresh-cw",EF);const jF=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],TF=Tt("rotate-ccw",jF);const AF=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Fy=Tt("save",AF);const CF=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],qa=Tt("search",CF);const RF=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_l=Tt("settings",RF);const DF=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],OF=Tt("smartphone",DF);const FF=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],F0=Tt("square-pen",FF);const LF=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Md=Tt("tag",LF);const IF=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Xt=Tt("trash-2",IF);const MF=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],BF=Tt("trending-up",MF);const PF=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Nl=Tt("triangle-alert",PF);const UF=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Gn=Tt("upload",UF);const zF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],$F=Tt("user-plus",zF);const qF=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Si=Tt("user",qF);const HF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Gc=Tt("users",HF);const WF=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],mr=Tt("x",WF);class GF extends K.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){this.setState({errorInfo:r})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset?.()};handleGoHome=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.href="/"};render(){return this.state.hasError?this.props.fallback?this.props.fallback(this.state.error,this.handleReset):a.jsx("div",{className:"min-h-[400px] flex items-center justify-center p-8",children:a.jsxs("div",{className:"max-w-md w-full text-center",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-6 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx(Nl,{className:"w-8 h-8 text-red-500"})}),a.jsx("h2",{className:"text-xl font-bold text-toss-gray-900 mb-2",children:" "}),a.jsx("p",{className:"text-toss-gray-500 mb-6",children:this.props.message||"    .    ."}),!1,a.jsxs("div",{className:"flex gap-3 justify-center",children:[a.jsxs(Ye,{onClick:this.handleReset,variant:"secondary",className:"flex items-center gap-2",children:[a.jsx(il,{size:16})," "]}),a.jsxs(Ye,{onClick:this.handleGoHome,className:"flex items-center gap-2",children:[a.jsx(KE,{size:16}),""]})]})]})}):this.props.children}}const Ye=({children:e,variant:t="primary",size:r="md",disabled:s=!1,loading:n=!1,className:o="",...l})=>{const u="font-semibold transition-all duration-200 active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",d={primary:"bg-toss-blue text-white hover:bg-toss-blue-dark",secondary:"bg-toss-gray-100 text-toss-gray-800 hover:bg-toss-gray-200",ghost:"bg-transparent text-toss-gray-600 hover:bg-toss-gray-100",danger:"bg-red-500 text-white hover:bg-red-600"},h={sm:"py-2 px-4 text-sm rounded-toss",md:"py-3 px-6 rounded-toss",lg:"py-4 px-8 text-lg rounded-toss-lg"};return a.jsxs("button",{className:`${u} ${d[t]} ${h[r]} ${o}`,disabled:s||n,...l,children:[n&&a.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e]})},_t=({children:e,className:t="",padding:r="p-6",...s})=>a.jsx("div",{className:`bg-white rounded-toss-lg shadow-toss ${r} ${t}`,...s,children:e}),cr=({isOpen:e,onClose:t,title:r,children:s,size:n="default"})=>{if(!e)return null;const o={default:"max-w-2xl max-h-[90vh]",large:"max-w-4xl max-h-[95vh]",xl:"max-w-6xl max-h-[95vh]",full:"max-w-[95vw] max-h-[95vh]",a4:"max-w-[900px] max-h-[95vh]"};return a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),a.jsxs("div",{className:`relative bg-white rounded-toss-lg shadow-toss-lg w-full mx-4 overflow-auto ${o[n]||o.default}`,children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-toss-gray-100",children:[a.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:r}),a.jsx("button",{onClick:t,className:"text-toss-gray-500 hover:text-toss-gray-700",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("div",{className:"p-6",children:s})]})]})},VF=()=>{const{isAdmin:e,isSubAdmin:t}=qr(),[r,s]=K.useState(!1),[n,o]=K.useState({}),l=Ti(),u=x=>{o(y=>({...y,[x]:!y[x]}))};K.useEffect(()=>{l.pathname.startsWith("/worklogs")&&o(x=>({...x,worklogs:!0})),l.pathname.startsWith("/archive")&&o(x=>({...x,archive:!0})),l.pathname.startsWith("/admission")&&o(x=>({...x,admission:!0})),l.pathname.startsWith("/overseas-korean")&&o(x=>({...x,overseasKorean:!0}))},[l.pathname]);const d=[{to:"/",icon:KE,label:""},{to:"/notices",icon:yF,label:""},{to:"/events",icon:VE,label:""},{icon:p0,label:"",isSubmenu:!0,menuKey:"worklogs",pathPrefix:"/worklogs",subItems:[{to:"/worklogs/daily",label:" "},{to:"/worklogs/weekly",label:" "},{to:"/worklogs/monthly",label:" "}]},{to:"/rescue",icon:Nl,label:""},{icon:fl,label:"",isSubmenu:!0,menuKey:"admission",pathPrefix:"/admission",subItems:[{to:"/admission/ganghwa",label:""},{to:"/admission/bupyeong",label:""},{to:"/admission/nametag",label:" "}]},{to:"/overseas-korean/status",icon:Dy,label:""},{to:"/contacts",icon:O0,label:""},{to:"/meetings",icon:ma,label:""},{to:"/document-ledger",icon:WE,label:""},{to:"/document",icon:Gs,label:" "},{to:"/mypage",icon:Si,label:""}],h=[{href:"https://heony1216-eng.github.io/rescue-board/",icon:rl,label:""},{href:"https://login.ecount.com/",icon:rl,label:""},{href:"https://www.dropbox.com/home",icon:rl,label:""},{href:"https://auth.worksmobile.com/login/login?accessUrl=https%3A%2F%2Fdrive.worksmobile.com%2Fdrive%2Fweb%2Fmy%3FresourceKey%3Droot&isRefreshed=true",icon:rl,label:""}],m=({to:x,icon:y,label:b})=>a.jsxs(yy,{to:x,onClick:()=>s(!1),className:({isActive:v})=>`flex items-center gap-3 px-4 py-3 rounded-toss transition-all ${v?"bg-toss-blue text-white":"text-toss-gray-900 hover:bg-toss-blue/10 hover:text-toss-blue"}`,children:[a.jsx(y,{size:20}),a.jsx("span",{className:"font-medium",children:b})]});return a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>s(!0),className:"lg:hidden fixed top-4 left-4 z-40 p-2 bg-white rounded-toss shadow-toss",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),r&&a.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-40",onClick:()=>s(!1)}),a.jsxs("aside",{className:`fixed top-0 left-0 h-full w-64 bg-white shadow-toss-lg z-50 transform transition-transform duration-300 flex flex-col ${r?"translate-x-0":"-translate-x-full lg:translate-x-0"}`,children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-toss-gray-100 flex-shrink-0",children:[a.jsxs("h1",{className:"text-xl font-bold text-toss-gray-900",children:[a.jsx("span",{className:"text-toss-blue",children:""})," "]}),a.jsx("button",{onClick:()=>s(!1),className:"lg:hidden text-toss-gray-500",children:a.jsx(mr,{size:24})})]}),a.jsxs("nav",{className:"p-4 space-y-2 flex-1 overflow-y-auto",children:[a.jsxs("a",{href:"https://www.dropbox.com/scl/fi/vz0zmnbpr1kfzw2w3fu6g/.apk?rlkey=lp7l2m97ssh1nixykcjxwiaqf&st=m08bikmg&dl=1",target:"_blank",rel:"noopener noreferrer",onClick:()=>s(!1),className:"flex items-center gap-3 px-4 py-3 rounded-toss transition-all bg-toss-gray-100 text-toss-gray-600 hover:bg-toss-gray-200 mb-4",children:[a.jsx(OF,{size:20}),a.jsx("span",{className:"font-medium",children:" "})]}),d.map(x=>x.isSubmenu?a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>u(x.menuKey),className:`w-full flex items-center justify-between gap-3 px-4 py-3 rounded-toss transition-all ${l.pathname.startsWith(x.pathPrefix)?"bg-toss-blue/10 text-toss-blue":"text-toss-gray-900 hover:bg-toss-blue/10 hover:text-toss-blue"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(x.icon,{size:20}),a.jsx("span",{className:"font-medium",children:x.label})]}),a.jsx(Cn,{size:16,className:`transition-transform ${n[x.menuKey]?"rotate-180":""}`})]}),n[x.menuKey]&&a.jsx("div",{className:"ml-4 mt-1 space-y-1",children:x.subItems.map(y=>a.jsxs(yy,{to:y.to,end:y.to==="/admission",onClick:()=>s(!1),className:({isActive:b})=>`flex items-center gap-3 px-4 py-2 rounded-toss transition-all text-sm ${b?"bg-toss-blue text-white":"text-toss-gray-700 hover:bg-toss-blue/10 hover:text-toss-blue"}`,children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current"}),a.jsx("span",{className:"font-medium",children:y.label})]},y.to))})]},x.label):a.jsx(m,{...x},x.to)),a.jsx("div",{className:"pt-4 mt-4 border-t border-toss-gray-100",children:h.map(x=>a.jsxs("a",{href:x.href,target:"_blank",rel:"noopener noreferrer",onClick:()=>s(!1),className:"flex items-center gap-3 px-4 py-3 rounded-toss transition-all text-toss-gray-900 hover:bg-toss-blue/10 hover:text-toss-blue",children:[a.jsx(x.icon,{size:20}),a.jsx("span",{className:"font-medium",children:x.label})]},x.href))})]})]})]})},KF=()=>{const{profile:e,signOut:t,isAdmin:r}=qr(),s=au(),n=async()=>{await t(),s("/login")};return a.jsx("header",{className:"bg-white shadow-toss sticky top-0 z-30",children:a.jsxs("div",{className:"flex items-center justify-between px-4 lg:px-8 py-4",children:[a.jsx("div",{className:"lg:hidden w-10"})," ",a.jsxs("div",{className:"flex items-center gap-4 ml-auto",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-toss-blue/10 rounded-full flex items-center justify-center",children:a.jsx(Si,{size:20,className:"text-toss-blue"})}),a.jsxs("div",{className:"hidden sm:block",children:[a.jsxs("p",{className:"font-semibold text-toss-gray-900",children:[e?.name||"",r&&a.jsx("span",{className:"ml-2 text-xs bg-toss-blue text-white px-2 py-0.5 rounded-full",children:""})]}),a.jsxs("p",{className:"text-sm text-toss-gray-500",children:[e?.team&&`${e.team}  `,e?.rank||""]})]})]}),a.jsx("button",{onClick:n,className:"p-2 text-toss-gray-500 hover:text-toss-gray-700 hover:bg-toss-gray-100 rounded-toss transition-all",title:"",children:a.jsx(Lc,{size:20})})]})]})})},XF=()=>a.jsxs("div",{className:"min-h-screen bg-toss-gray-50 overflow-hidden",children:[a.jsx(VF,{}),a.jsxs("div",{className:"lg:ml-64 min-h-screen",children:[a.jsx(KF,{}),a.jsx("main",{className:"p-4 lg:p-8 overflow-x-hidden",children:a.jsx(M8,{})})]})]}),YF=()=>{const[e,t]=K.useState("user"),[r,s]=K.useState(""),[n,o]=K.useState(""),[l,u]=K.useState(!1),[d,h]=K.useState(!1),[m,x]=K.useState(""),{signInWithPassword:y}=qr(),b=au();K.useEffect(()=>{const g=localStorage.getItem("savedId");g&&(s(g),u(!0))},[]);const v=async g=>{g.preventDefault(),h(!0),x("");const{error:_}=await y(r,n);_?x(_.message||"    ."):(l?localStorage.setItem("savedId",r):localStorage.removeItem("savedId"),b("/")),h(!1)};return a.jsx("div",{className:"min-h-screen bg-toss-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsxs("h1",{className:"text-3xl font-bold text-toss-gray-900 mb-2",children:[a.jsx("span",{className:"text-toss-blue",children:""})," "]}),a.jsx("p",{className:"text-toss-gray-500",children:"  "})]}),a.jsxs(_t,{className:"mb-4",children:[a.jsxs("div",{className:"flex mb-6 bg-toss-gray-100 p-1 rounded-toss",children:[a.jsx("button",{onClick:()=>t("user"),className:`flex-1 py-2 px-4 rounded-toss text-sm font-medium transition-all ${e==="user"?"bg-white text-toss-gray-900 shadow-sm":"text-toss-gray-500"}`,children:" "}),a.jsx("button",{onClick:()=>t("admin"),className:`flex-1 py-2 px-4 rounded-toss text-sm font-medium transition-all ${e==="admin"?"bg-white text-toss-gray-900 shadow-sm":"text-toss-gray-500"}`,children:" "})]}),a.jsxs("form",{onSubmit:v,className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Si,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),a.jsx("input",{type:"text",value:r,onChange:g=>s(g.target.value),placeholder:e==="admin"?" ":"",required:!0,className:"w-full pl-12 pr-4 py-3 bg-toss-gray-100 border-0 rounded-toss text-toss-gray-900 placeholder-toss-gray-500 focus:ring-2 focus:ring-toss-blue focus:bg-white transition-all"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(hl,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),a.jsx("input",{type:"password",value:n,onChange:g=>o(g.target.value),placeholder:"",required:!0,className:"w-full pl-12 pr-4 py-3 bg-toss-gray-100 border-0 rounded-toss text-toss-gray-900 placeholder-toss-gray-500 focus:ring-2 focus:ring-toss-blue focus:bg-white transition-all"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"rememberMe",checked:l,onChange:g=>u(g.target.checked),className:"w-4 h-4 text-toss-blue bg-toss-gray-100 border-toss-gray-300 rounded focus:ring-toss-blue focus:ring-2"}),a.jsx("label",{htmlFor:"rememberMe",className:"ml-2 text-sm text-toss-gray-700 cursor-pointer",children:"  "})]}),m&&a.jsx("p",{className:"text-sm text-red-500 bg-red-50 p-3 rounded-toss",children:m}),a.jsxs(Ye,{type:"submit",className:"w-full",loading:d,children:["",a.jsx(HE,{size:18})]})]}),e==="user"&&a.jsx("div",{className:"mt-6 pt-6 border-t border-toss-gray-200",children:a.jsxs(Vs,{to:"/register",className:"flex items-center justify-center gap-2 w-full py-3 bg-toss-gray-100 text-toss-gray-700 rounded-toss hover:bg-toss-gray-200 transition-colors font-medium",children:[a.jsx($F,{size:18}),""]})})]}),a.jsx("p",{className:"text-center text-sm text-toss-gray-500",children:e==="user"?"   ":"  "})]})})},JF=()=>{const[e,t]=K.useState({id:"",password:"",confirmPassword:"",name:"",team:"",rank:""}),[r,s]=K.useState(!1),[n,o]=K.useState(""),[l,u]=K.useState(!1),{signUp:d}=qr(),h=au(),m=b=>{const{name:v,value:g}=b.target;t(_=>({..._,[v]:g}))},x=async b=>{if(b.preventDefault(),s(!0),o(""),e.password!==e.confirmPassword){o("  ."),s(!1);return}if(e.password.length<6){o(" 6  ."),s(!1);return}const{error:v}=await d({id:e.id,password:e.password,name:e.name,team:e.team,rank:e.rank});v?o(v.message||" .  ."):(u(!0),setTimeout(()=>{h("/login")},2e3)),s(!1)},y="w-full pl-12 pr-4 py-3 bg-toss-gray-100 border-0 rounded-toss text-toss-gray-900 placeholder-toss-gray-500 focus:ring-2 focus:ring-toss-blue focus:bg-white transition-all";return a.jsx("div",{className:"min-h-screen bg-toss-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsxs("h1",{className:"text-3xl font-bold text-toss-gray-900 mb-2",children:[a.jsx("span",{className:"text-toss-blue",children:""})," "]}),a.jsx("p",{className:"text-toss-gray-500",children:""})]}),a.jsx(_t,{className:"mb-4",children:l?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),a.jsx("h2",{className:"text-xl font-semibold text-toss-gray-900 mb-2",children:" !"}),a.jsx("p",{className:"text-toss-gray-500",children:"  ..."})]}):a.jsxs("form",{onSubmit:x,className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Si,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),a.jsx("input",{type:"text",name:"id",value:e.id,onChange:m,placeholder:" *",required:!0,className:y})]}),a.jsxs("div",{className:"relative",children:[a.jsx(hl,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),a.jsx("input",{type:"password",name:"password",value:e.password,onChange:m,placeholder:" * (6 )",required:!0,className:y})]}),a.jsxs("div",{className:"relative",children:[a.jsx(hl,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),a.jsx("input",{type:"password",name:"confirmPassword",value:e.confirmPassword,onChange:m,placeholder:"  *",required:!0,className:y})]}),a.jsx("div",{className:"border-t border-toss-gray-200 pt-4"}),a.jsxs("div",{className:"relative",children:[a.jsx(Si,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),a.jsx("input",{type:"text",name:"name",value:e.name,onChange:m,placeholder:" *",required:!0,className:y})]}),a.jsxs("div",{className:"relative",children:[a.jsx(GE,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),a.jsx("input",{type:"text",name:"team",value:e.team,onChange:m,placeholder:" (: , )",className:y})]}),a.jsxs("div",{className:"relative",children:[a.jsx(N7,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),a.jsx("input",{type:"text",name:"rank",value:e.rank,onChange:m,placeholder:" (: , )",className:y})]}),n&&a.jsx("p",{className:"text-sm text-red-500 bg-red-50 p-3 rounded-toss",children:n}),a.jsxs(Ye,{type:"submit",className:"w-full",loading:r,children:["",a.jsx(HE,{size:18})]})]})}),a.jsxs(Vs,{to:"/login",className:"flex items-center justify-center gap-2 text-sm text-toss-gray-500 hover:text-toss-blue transition-colors",children:[a.jsx(sf,{size:16})," "]})]})})},ZF=()=>{const{profile:e,isAdmin:t}=qr(),[r,s]=K.useState(0),[n,o]=K.useState([]),[l,u]=K.useState([]),[d,h]=K.useState(null),[m,x]=K.useState(!1),[y,b]=K.useState({daily:!1,weekly:!1,monthly:!1});K.useEffect(()=>{g(),N(),_(),e?.user_id&&v()},[e?.user_id]);const v=async()=>{if(!e?.user_id)return;const E=new Date,C=E.getHours(),F=E.getDay(),O=E.toISOString().split("T")[0],B={daily:!1,weekly:!1,monthly:!1};if(F>=1&&F<=5&&C>=15){const{data:H}=await Pe.from("work_logs").select("id").eq("user_id",e.user_id).eq("type","daily").eq("work_date",O).limit(1).maybeSingle();H||(B.daily=!0)}if(F===5&&C>=15){const H=new Date(E);H.setDate(E.getDate()-(F-1));const ue=H.toISOString().split("T")[0],Y=new Date(E).toISOString().split("T")[0],{data:I}=await Pe.from("work_logs").select("id").eq("user_id",e.user_id).eq("type","weekly").gte("work_date",ue).lte("work_date",Y).limit(1).maybeSingle();I||(B.weekly=!0)}const L=new Date(E.getFullYear(),E.getMonth()+1,0).getDate();if(E.getDate()===L&&C>=15){const H=new Date(E.getFullYear(),E.getMonth(),1).toISOString().split("T")[0],ue=O,{data:A}=await Pe.from("work_logs").select("id").eq("user_id",e.user_id).eq("type","monthly").gte("work_date",H).lte("work_date",ue).limit(1).maybeSingle();A||(B.monthly=!0)}b(B)},g=async()=>{try{const{count:E}=await Pe.from("rescue_situations").select("id",{count:"exact"}).eq("is_completed",!1);s(E||0)}catch(E){console.error("Error fetching rescue count:",E)}},_=async()=>{try{const{data:E}=await Pe.from("rescue_situations").select("*").eq("is_completed",!1).order("created_at",{ascending:!1}).limit(10);u(E||[])}catch(E){console.error("Error fetching rescues:",E)}},w=E=>{h(E),x(!0)},S=()=>{x(!1),h(null)},N=async()=>{try{const{data:E}=await Pe.from("notices").select("id, title, created_at, is_pinned").order("is_pinned",{ascending:!1}).order("created_at",{ascending:!1}).limit(5);o(E||[])}catch(E){console.error("Error fetching notices:",E)}};return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-2xl font-bold",children:e?.name?.charAt(0)||"U"})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-2xl font-bold mb-1",children:[", ",e?.name||"","!",t&&a.jsx("span",{className:"ml-2 text-xs bg-white/20 px-2 py-1 rounded-full",children:""})]}),a.jsxs("p",{className:"text-white/80",children:[e?.team&&`${e.team}  `,e?.position||" "]})]})]})}),(y.daily||y.weekly||y.monthly)&&a.jsx(_t,{className:"bg-amber-50 border border-amber-200",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(Sn,{size:20,className:"text-amber-600"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-bold text-amber-800 mb-2",children:"  "}),a.jsxs("div",{className:"space-y-2",children:[y.daily&&a.jsxs(Vs,{to:"/worklogs/daily",className:"flex items-center justify-between p-2 bg-white rounded-lg hover:bg-amber-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(p0,{size:16,className:"text-amber-600"}),a.jsx("span",{className:"text-sm text-amber-800",children:"   "})]}),a.jsx("span",{className:"text-xs text-amber-600 font-medium",children:" "})]}),y.weekly&&a.jsxs(Vs,{to:"/worklogs/weekly",className:"flex items-center justify-between p-2 bg-white rounded-lg hover:bg-amber-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(p0,{size:16,className:"text-amber-600"}),a.jsx("span",{className:"text-sm text-amber-800",children:"    "})]}),a.jsx("span",{className:"text-xs text-amber-600 font-medium",children:" "})]}),y.monthly&&a.jsxs(Vs,{to:"/worklogs/monthly",className:"flex items-center justify-between p-2 bg-white rounded-lg hover:bg-amber-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(p0,{size:16,className:"text-amber-600"}),a.jsx("span",{className:"text-sm text-amber-800",children:"    "})]}),a.jsx("span",{className:"text-xs text-amber-600 font-medium",children:" "})]})]})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs(_t,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Nl,{size:18,className:"text-orange-500"}),a.jsx("h3",{className:"text-base font-bold text-toss-gray-900",children:" "}),a.jsxs("span",{className:"text-xs bg-orange-100 text-orange-600 px-2 py-0.5 rounded-full font-medium",children:[r,""]})]}),a.jsx(Vs,{to:"/rescue",className:"text-sm text-toss-blue hover:underline",children:""})]}),l.length>0?a.jsx("div",{className:"space-y-2 max-h-[320px] overflow-y-auto",children:l.map(E=>a.jsxs("div",{onClick:()=>w(E),className:"block p-3 rounded-lg hover:bg-toss-gray-50 transition-colors border border-toss-gray-100 cursor-pointer",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("p",{className:"font-medium text-toss-gray-900 text-sm",children:E.name}),a.jsx("span",{className:"text-toss-gray-300",children:"|"}),a.jsx("p",{className:"text-sm text-toss-gray-600",children:E.location})]}),a.jsx("p",{className:"text-xs text-toss-gray-400",children:E.request_date||"-"})]}),a.jsx("p",{className:"text-sm text-toss-gray-700 line-clamp-2",children:E.status||"-"})]},E.id))}):a.jsx("p",{className:"text-center text-toss-gray-500 py-8 text-sm",children:"  "})]}),a.jsxs(_t,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-base font-bold text-toss-gray-900",children:" "}),a.jsx(Vs,{to:"/notices",className:"text-sm text-toss-blue hover:underline",children:""})]}),n.length>0?a.jsx("div",{className:"space-y-2 max-h-[320px] overflow-y-auto",children:n.map(E=>a.jsxs(Vs,{to:`/notices/${E.id}`,className:"block p-3 rounded-lg hover:bg-toss-gray-50 transition-colors border border-toss-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[E.is_pinned&&a.jsx("span",{className:"text-xs bg-toss-blue text-white px-2 py-0.5 rounded-full",children:""}),a.jsx("p",{className:"font-medium text-toss-gray-900 flex-1 truncate text-sm",children:E.title})]}),a.jsx("p",{className:"text-xs text-toss-gray-400 mt-1",children:new Date(E.created_at).toLocaleDateString("ko-KR")})]},E.id))}):a.jsx("p",{className:"text-center text-toss-gray-500 py-8 text-sm",children:"  "})]})]}),a.jsx(cr,{isOpen:m,onClose:S,title:" ",children:d&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Si,{size:16,className:"text-toss-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-toss-gray-500",children:""}),a.jsx("p",{className:"font-medium text-toss-gray-900",children:d.name||"-"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Id,{size:16,className:"text-toss-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-toss-gray-500",children:""}),a.jsx("p",{className:"font-medium text-toss-gray-900",children:d.location||"-"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O0,{size:16,className:"text-toss-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-toss-gray-500",children:""}),a.jsx("p",{className:"font-medium text-toss-gray-900",children:d.contact||"-"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ma,{size:16,className:"text-toss-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-toss-gray-500",children:""}),a.jsx("p",{className:"font-medium text-toss-gray-900",children:d.request_date||"-"})]})]})]}),(d.animal_type||d.animal_count)&&a.jsxs("div",{className:"p-3 bg-toss-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),a.jsxs("p",{className:"text-toss-gray-900",children:[d.animal_type||"-",d.animal_count&&` (${d.animal_count})`]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Gs,{size:16,className:"text-toss-gray-400"}),a.jsx("p",{className:"text-sm font-medium text-toss-gray-700",children:" "})]}),a.jsx("div",{className:"p-3 bg-orange-50 rounded-lg",children:a.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:d.status||"  "})})]}),d.notes&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("div",{className:"p-3 bg-toss-gray-50 rounded-lg",children:a.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:d.notes})})]}),a.jsx("div",{className:"pt-4 border-t border-toss-gray-100",children:a.jsx(Vs,{to:"/rescue",onClick:S,className:"block w-full text-center py-3 bg-toss-blue text-white rounded-lg hover:bg-blue-600 transition-colors",children:"  "})})]})})]})},u4=()=>{const{id:e}=uE(),t=au(),{isAdmin:r,isSubAdmin:s,profile:n}=qr(),[o,l]=K.useState([]),[u,d]=K.useState(null),[h,m]=K.useState(!1),[x,y]=K.useState(!1),[b,v]=K.useState(!0),[g,_]=K.useState({title:"",content:"",is_pinned:!1});K.useEffect(()=>{w()},[]),K.useEffect(()=>{e?S(e):d(null)},[e]);const w=async()=>{try{const{data:H,error:ue}=await Pe.from("notices").select("*, author:users(name)").order("is_pinned",{ascending:!1}).order("created_at",{ascending:!1});if(ue)throw ue;l(H||[])}catch(H){console.error("Error fetching notices:",H)}finally{v(!1)}},S=async H=>{try{const{data:ue,error:A}=await Pe.from("notices").select("*, author:users(name)").eq("id",H).single();if(A)throw A;d(ue)}catch(ue){console.error("Error fetching notice:",ue)}},N=async()=>{if(!g.title||!g.content){alert("  .");return}try{const{error:H}=await Pe.from("notices").insert({title:g.title,content:g.content,is_pinned:g.is_pinned,author_id:n.user_id});if(H)throw console.error("Notice insert error:",H),H;m(!1),_({title:"",content:"",is_pinned:!1}),w(),alert(" .")}catch(H){console.error("Error creating notice:",H),alert("  : "+H.message)}},E=async()=>{if(!F){alert("    .");return}try{const{error:H}=await Pe.from("notices").update({title:g.title,content:g.content,is_pinned:g.is_pinned,updated_at:new Date().toISOString()}).eq("id",F.id);if(H)throw H;m(!1),O(null),w(),u&&u.id===F.id&&S(F.id),alert(" .")}catch(H){console.error("Error updating notice:",H),alert("  .")}},C=async H=>{if(confirm(" ?"))try{const{error:ue}=await Pe.from("notices").delete().eq("id",H);if(ue)throw ue;t("/notices"),w()}catch(ue){console.error("Error deleting notice:",ue)}},[F,O]=K.useState(null),B=H=>{O(H),_({title:H.title,content:H.content,is_pinned:H.is_pinned}),y(!1),m(!0)},L=()=>{_({title:"",content:"",is_pinned:!1}),y(!0),m(!0)};return u?a.jsxs("div",{className:"space-y-6",children:[a.jsxs(Vs,{to:"/notices",className:"inline-flex items-center gap-2 text-toss-gray-500 hover:text-toss-gray-700",children:[a.jsx(xa,{size:20}),""]}),a.jsxs(_t,{children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsx("div",{className:"flex items-center gap-2",children:u.is_pinned&&a.jsxs("span",{className:"bg-toss-blue text-white text-xs px-2 py-1 rounded-full flex items-center gap-1",children:[a.jsx(c4,{size:12})," "]})}),(r||s)&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:H=>{H.preventDefault(),H.stopPropagation(),B(u)},className:"p-2 text-toss-gray-500 hover:bg-toss-gray-100 rounded-toss",children:a.jsx(F0,{size:18})}),a.jsx("button",{onClick:H=>{H.preventDefault(),H.stopPropagation(),C(u.id)},className:"p-2 text-red-500 hover:bg-red-50 rounded-toss",children:a.jsx(Xt,{size:18})})]})]}),a.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900 mb-2",children:u.title}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-toss-gray-500 mb-6 pb-6 border-b border-toss-gray-100",children:[a.jsx("span",{children:u.author?.name||""}),a.jsx("span",{children:new Date(u.created_at).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})})]}),a.jsx("div",{className:"prose max-w-none text-toss-gray-800 whitespace-pre-wrap leading-relaxed",children:u.content})]}),a.jsx(cr,{isOpen:h,onClose:()=>m(!1),title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("input",{type:"text",value:g.title,onChange:H=>_({...g,title:H.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue",placeholder:"  "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("textarea",{value:g.content,onChange:H=>_({...g,content:H.target.value}),rows:6,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:"  "})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:g.is_pinned,onChange:H=>_({...g,is_pinned:H.target.checked}),className:"w-5 h-5 rounded border-toss-gray-300 text-toss-blue focus:ring-toss-blue"}),a.jsx("span",{className:"text-sm text-toss-gray-700",children:" "})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>m(!1),className:"flex-1",children:""}),a.jsx(Ye,{onClick:E,className:"flex-1",children:""})]})]})})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:""}),(r||s)&&a.jsxs(Ye,{onClick:L,children:[a.jsx(os,{size:18}),"  "]})]}),a.jsx(_t,{padding:"p-0",children:b?a.jsx("div",{className:"p-8 text-center text-toss-gray-500",children:" ..."}):o.length>0?a.jsx("div",{className:"divide-y divide-toss-gray-100",children:o.map(H=>a.jsxs(Vs,{to:`/notices/${H.id}`,className:"block p-4 hover:bg-toss-gray-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[H.is_pinned&&a.jsxs("span",{className:"bg-toss-blue text-white text-xs px-2 py-0.5 rounded-full flex items-center gap-1",children:[a.jsx(c4,{size:10})," "]}),a.jsx("h3",{className:"font-medium text-toss-gray-900 flex-1 truncate",children:H.title}),a.jsx("span",{className:"text-sm text-toss-gray-400 shrink-0",children:new Date(H.created_at).toLocaleDateString("ko-KR")})]}),a.jsx("p",{className:"text-sm text-toss-gray-500 mt-1 truncate",children:H.content})]},H.id))}):a.jsx("div",{className:"p-8 text-center text-toss-gray-500",children:"  "})}),a.jsx(cr,{isOpen:h,onClose:()=>m(!1),title:x?"  ":" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("input",{type:"text",value:g.title,onChange:H=>_({...g,title:H.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue",placeholder:"  "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("textarea",{value:g.content,onChange:H=>_({...g,content:H.target.value}),rows:6,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:"  "})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:g.is_pinned,onChange:H=>_({...g,is_pinned:H.target.checked}),className:"w-5 h-5 rounded border-toss-gray-300 text-toss-blue focus:ring-toss-blue"}),a.jsx("span",{className:"text-sm text-toss-gray-700",children:" "})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>m(!1),className:"flex-1",children:""}),a.jsx(Ye,{onClick:x?N:E,className:"flex-1",children:x?"":""})]})]})})]})};var QF="rpc",e9="upload",t9="download",tg="app",rg="user",sg="team",r9="noauth",s9="cookie",L0="dropboxapi.com",d4="dropbox.com",Ly={api:"api",notify:"bolt",content:"api-content"},Re={};Re.accountSetProfilePhoto=function(e){return this.request("account/set_profile_photo",e,"user","api","rpc","account_info.write")};Re.authTokenFromOauth1=function(e){return this.request("auth/token/from_oauth1",e,"app","api","rpc",null)};Re.authTokenRevoke=function(){return this.request("auth/token/revoke",null,"user","api","rpc",null)};Re.checkApp=function(e){return this.request("check/app",e,"app","api","rpc",null)};Re.checkUser=function(e){return this.request("check/user",e,"user","api","rpc","account_info.read")};Re.contactsDeleteManualContacts=function(){return this.request("contacts/delete_manual_contacts",null,"user","api","rpc","contacts.write")};Re.contactsDeleteManualContactsBatch=function(e){return this.request("contacts/delete_manual_contacts_batch",e,"user","api","rpc","contacts.write")};Re.filePropertiesPropertiesAdd=function(e){return this.request("file_properties/properties/add",e,"user","api","rpc","files.metadata.write")};Re.filePropertiesPropertiesOverwrite=function(e){return this.request("file_properties/properties/overwrite",e,"user","api","rpc","files.metadata.write")};Re.filePropertiesPropertiesRemove=function(e){return this.request("file_properties/properties/remove",e,"user","api","rpc","files.metadata.write")};Re.filePropertiesPropertiesSearch=function(e){return this.request("file_properties/properties/search",e,"user","api","rpc","files.metadata.read")};Re.filePropertiesPropertiesSearchContinue=function(e){return this.request("file_properties/properties/search/continue",e,"user","api","rpc","files.metadata.read")};Re.filePropertiesPropertiesUpdate=function(e){return this.request("file_properties/properties/update",e,"user","api","rpc","files.metadata.write")};Re.filePropertiesTemplatesAddForTeam=function(e){return this.request("file_properties/templates/add_for_team",e,"team","api","rpc","files.team_metadata.write")};Re.filePropertiesTemplatesAddForUser=function(e){return this.request("file_properties/templates/add_for_user",e,"user","api","rpc","files.metadata.write")};Re.filePropertiesTemplatesGetForTeam=function(e){return this.request("file_properties/templates/get_for_team",e,"team","api","rpc","files.team_metadata.write")};Re.filePropertiesTemplatesGetForUser=function(e){return this.request("file_properties/templates/get_for_user",e,"user","api","rpc","files.metadata.read")};Re.filePropertiesTemplatesListForTeam=function(){return this.request("file_properties/templates/list_for_team",null,"team","api","rpc","files.team_metadata.write")};Re.filePropertiesTemplatesListForUser=function(){return this.request("file_properties/templates/list_for_user",null,"user","api","rpc","files.metadata.read")};Re.filePropertiesTemplatesRemoveForTeam=function(e){return this.request("file_properties/templates/remove_for_team",e,"team","api","rpc","files.team_metadata.write")};Re.filePropertiesTemplatesRemoveForUser=function(e){return this.request("file_properties/templates/remove_for_user",e,"user","api","rpc","files.metadata.write")};Re.filePropertiesTemplatesUpdateForTeam=function(e){return this.request("file_properties/templates/update_for_team",e,"team","api","rpc","files.team_metadata.write")};Re.filePropertiesTemplatesUpdateForUser=function(e){return this.request("file_properties/templates/update_for_user",e,"user","api","rpc","files.metadata.write")};Re.fileRequestsCount=function(){return this.request("file_requests/count",null,"user","api","rpc","file_requests.read")};Re.fileRequestsCreate=function(e){return this.request("file_requests/create",e,"user","api","rpc","file_requests.write")};Re.fileRequestsDelete=function(e){return this.request("file_requests/delete",e,"user","api","rpc","file_requests.write")};Re.fileRequestsDeleteAllClosed=function(){return this.request("file_requests/delete_all_closed",null,"user","api","rpc","file_requests.write")};Re.fileRequestsGet=function(e){return this.request("file_requests/get",e,"user","api","rpc","file_requests.read")};Re.fileRequestsListV2=function(e){return this.request("file_requests/list_v2",e,"user","api","rpc","file_requests.read")};Re.fileRequestsList=function(){return this.request("file_requests/list",null,"user","api","rpc","file_requests.read")};Re.fileRequestsListContinue=function(e){return this.request("file_requests/list/continue",e,"user","api","rpc","file_requests.read")};Re.fileRequestsUpdate=function(e){return this.request("file_requests/update",e,"user","api","rpc","file_requests.write")};Re.filesAlphaGetMetadata=function(e){return this.request("files/alpha/get_metadata",e,"user","api","rpc","files.metadata.read")};Re.filesAlphaUpload=function(e){return this.request("files/alpha/upload",e,"user","content","upload","files.content.write")};Re.filesCopyV2=function(e){return this.request("files/copy_v2",e,"user","api","rpc","files.content.write")};Re.filesCopy=function(e){return this.request("files/copy",e,"user","api","rpc","files.content.write")};Re.filesCopyBatchV2=function(e){return this.request("files/copy_batch_v2",e,"user","api","rpc","files.content.write")};Re.filesCopyBatch=function(e){return this.request("files/copy_batch",e,"user","api","rpc","files.content.write")};Re.filesCopyBatchCheckV2=function(e){return this.request("files/copy_batch/check_v2",e,"user","api","rpc","files.content.write")};Re.filesCopyBatchCheck=function(e){return this.request("files/copy_batch/check",e,"user","api","rpc","files.content.write")};Re.filesCopyReferenceGet=function(e){return this.request("files/copy_reference/get",e,"user","api","rpc","files.content.write")};Re.filesCopyReferenceSave=function(e){return this.request("files/copy_reference/save",e,"user","api","rpc","files.content.write")};Re.filesCreateFolderV2=function(e){return this.request("files/create_folder_v2",e,"user","api","rpc","files.content.write")};Re.filesCreateFolder=function(e){return this.request("files/create_folder",e,"user","api","rpc","files.content.write")};Re.filesCreateFolderBatch=function(e){return this.request("files/create_folder_batch",e,"user","api","rpc","files.content.write")};Re.filesCreateFolderBatchCheck=function(e){return this.request("files/create_folder_batch/check",e,"user","api","rpc","files.content.write")};Re.filesDeleteV2=function(e){return this.request("files/delete_v2",e,"user","api","rpc","files.content.write")};Re.filesDelete=function(e){return this.request("files/delete",e,"user","api","rpc","files.content.write")};Re.filesDeleteBatch=function(e){return this.request("files/delete_batch",e,"user","api","rpc","files.content.write")};Re.filesDeleteBatchCheck=function(e){return this.request("files/delete_batch/check",e,"user","api","rpc","files.content.write")};Re.filesDownload=function(e){return this.request("files/download",e,"user","content","download","files.content.read")};Re.filesDownloadZip=function(e){return this.request("files/download_zip",e,"user","content","download","files.content.read")};Re.filesExport=function(e){return this.request("files/export",e,"user","content","download","files.content.read")};Re.filesGetFileLockBatch=function(e){return this.request("files/get_file_lock_batch",e,"user","api","rpc","files.content.read")};Re.filesGetMetadata=function(e){return this.request("files/get_metadata",e,"user","api","rpc","files.metadata.read")};Re.filesGetPreview=function(e){return this.request("files/get_preview",e,"user","content","download","files.content.read")};Re.filesGetTemporaryLink=function(e){return this.request("files/get_temporary_link",e,"user","api","rpc","files.content.read")};Re.filesGetTemporaryUploadLink=function(e){return this.request("files/get_temporary_upload_link",e,"user","api","rpc","files.content.write")};Re.filesGetThumbnail=function(e){return this.request("files/get_thumbnail",e,"user","content","download","files.content.read")};Re.filesGetThumbnailV2=function(e){return this.request("files/get_thumbnail_v2",e,"app, user","content","download","files.content.read")};Re.filesGetThumbnailBatch=function(e){return this.request("files/get_thumbnail_batch",e,"user","content","rpc","files.content.read")};Re.filesListFolder=function(e){return this.request("files/list_folder",e,"app, user","api","rpc","files.metadata.read")};Re.filesListFolderContinue=function(e){return this.request("files/list_folder/continue",e,"app, user","api","rpc","files.metadata.read")};Re.filesListFolderGetLatestCursor=function(e){return this.request("files/list_folder/get_latest_cursor",e,"user","api","rpc","files.metadata.read")};Re.filesListFolderLongpoll=function(e){return this.request("files/list_folder/longpoll",e,"noauth","notify","rpc","files.metadata.read")};Re.filesListRevisions=function(e){return this.request("files/list_revisions",e,"user","api","rpc","files.metadata.read")};Re.filesLockFileBatch=function(e){return this.request("files/lock_file_batch",e,"user","api","rpc","files.content.write")};Re.filesMoveV2=function(e){return this.request("files/move_v2",e,"user","api","rpc","files.content.write")};Re.filesMove=function(e){return this.request("files/move",e,"user","api","rpc","files.content.write")};Re.filesMoveBatchV2=function(e){return this.request("files/move_batch_v2",e,"user","api","rpc","files.content.write")};Re.filesMoveBatch=function(e){return this.request("files/move_batch",e,"user","api","rpc","files.content.write")};Re.filesMoveBatchCheckV2=function(e){return this.request("files/move_batch/check_v2",e,"user","api","rpc","files.content.write")};Re.filesMoveBatchCheck=function(e){return this.request("files/move_batch/check",e,"user","api","rpc","files.content.write")};Re.filesPaperCreate=function(e){return this.request("files/paper/create",e,"user","api","upload","files.content.write")};Re.filesPaperUpdate=function(e){return this.request("files/paper/update",e,"user","api","upload","files.content.write")};Re.filesPermanentlyDelete=function(e){return this.request("files/permanently_delete",e,"user","api","rpc","files.permanent_delete")};Re.filesPropertiesAdd=function(e){return this.request("files/properties/add",e,"user","api","rpc","files.metadata.write")};Re.filesPropertiesOverwrite=function(e){return this.request("files/properties/overwrite",e,"user","api","rpc","files.metadata.write")};Re.filesPropertiesRemove=function(e){return this.request("files/properties/remove",e,"user","api","rpc","files.metadata.write")};Re.filesPropertiesTemplateGet=function(e){return this.request("files/properties/template/get",e,"user","api","rpc","files.metadata.read")};Re.filesPropertiesTemplateList=function(){return this.request("files/properties/template/list",null,"user","api","rpc","files.metadata.read")};Re.filesPropertiesUpdate=function(e){return this.request("files/properties/update",e,"user","api","rpc","files.metadata.write")};Re.filesRestore=function(e){return this.request("files/restore",e,"user","api","rpc","files.content.write")};Re.filesSaveUrl=function(e){return this.request("files/save_url",e,"user","api","rpc","files.content.write")};Re.filesSaveUrlCheckJobStatus=function(e){return this.request("files/save_url/check_job_status",e,"user","api","rpc","files.content.write")};Re.filesSearch=function(e){return this.request("files/search",e,"user","api","rpc","files.metadata.read")};Re.filesSearchV2=function(e){return this.request("files/search_v2",e,"user","api","rpc","files.metadata.read")};Re.filesSearchContinueV2=function(e){return this.request("files/search/continue_v2",e,"user","api","rpc","files.metadata.read")};Re.filesTagsAdd=function(e){return this.request("files/tags/add",e,"user","api","rpc","files.metadata.write")};Re.filesTagsGet=function(e){return this.request("files/tags/get",e,"user","api","rpc","files.metadata.read")};Re.filesTagsRemove=function(e){return this.request("files/tags/remove",e,"user","api","rpc","files.metadata.write")};Re.filesUnlockFileBatch=function(e){return this.request("files/unlock_file_batch",e,"user","api","rpc","files.content.write")};Re.filesUpload=function(e){return this.request("files/upload",e,"user","content","upload","files.content.write")};Re.filesUploadSessionAppendV2=function(e){return this.request("files/upload_session/append_v2",e,"user","content","upload","files.content.write")};Re.filesUploadSessionAppend=function(e){return this.request("files/upload_session/append",e,"user","content","upload","files.content.write")};Re.filesUploadSessionFinish=function(e){return this.request("files/upload_session/finish",e,"user","content","upload","files.content.write")};Re.filesUploadSessionFinishBatch=function(e){return this.request("files/upload_session/finish_batch",e,"user","api","rpc","files.content.write")};Re.filesUploadSessionFinishBatchV2=function(e){return this.request("files/upload_session/finish_batch_v2",e,"user","api","rpc","files.content.write")};Re.filesUploadSessionFinishBatchCheck=function(e){return this.request("files/upload_session/finish_batch/check",e,"user","api","rpc","files.content.write")};Re.filesUploadSessionStart=function(e){return this.request("files/upload_session/start",e,"user","content","upload","files.content.write")};Re.filesUploadSessionStartBatch=function(e){return this.request("files/upload_session/start_batch",e,"user","api","rpc","files.content.write")};Re.openidUserinfo=function(e){return this.request("openid/userinfo",e,"user","api","rpc","openid")};Re.paperDocsArchive=function(e){return this.request("paper/docs/archive",e,"user","api","rpc","files.content.write")};Re.paperDocsCreate=function(e){return this.request("paper/docs/create",e,"user","api","upload","files.content.write")};Re.paperDocsDownload=function(e){return this.request("paper/docs/download",e,"user","api","download","files.content.read")};Re.paperDocsFolderUsersList=function(e){return this.request("paper/docs/folder_users/list",e,"user","api","rpc","sharing.read")};Re.paperDocsFolderUsersListContinue=function(e){return this.request("paper/docs/folder_users/list/continue",e,"user","api","rpc","sharing.read")};Re.paperDocsGetFolderInfo=function(e){return this.request("paper/docs/get_folder_info",e,"user","api","rpc","sharing.read")};Re.paperDocsList=function(e){return this.request("paper/docs/list",e,"user","api","rpc","files.metadata.read")};Re.paperDocsListContinue=function(e){return this.request("paper/docs/list/continue",e,"user","api","rpc","files.metadata.read")};Re.paperDocsPermanentlyDelete=function(e){return this.request("paper/docs/permanently_delete",e,"user","api","rpc","files.permanent_delete")};Re.paperDocsSharingPolicyGet=function(e){return this.request("paper/docs/sharing_policy/get",e,"user","api","rpc","sharing.read")};Re.paperDocsSharingPolicySet=function(e){return this.request("paper/docs/sharing_policy/set",e,"user","api","rpc","sharing.write")};Re.paperDocsUpdate=function(e){return this.request("paper/docs/update",e,"user","api","upload","files.content.write")};Re.paperDocsUsersAdd=function(e){return this.request("paper/docs/users/add",e,"user","api","rpc","sharing.write")};Re.paperDocsUsersList=function(e){return this.request("paper/docs/users/list",e,"user","api","rpc","sharing.read")};Re.paperDocsUsersListContinue=function(e){return this.request("paper/docs/users/list/continue",e,"user","api","rpc","sharing.read")};Re.paperDocsUsersRemove=function(e){return this.request("paper/docs/users/remove",e,"user","api","rpc","sharing.write")};Re.paperFoldersCreate=function(e){return this.request("paper/folders/create",e,"user","api","rpc","files.content.write")};Re.sharingAddFileMember=function(e){return this.request("sharing/add_file_member",e,"user","api","rpc","sharing.write")};Re.sharingAddFolderMember=function(e){return this.request("sharing/add_folder_member",e,"user","api","rpc","sharing.write")};Re.sharingCheckJobStatus=function(e){return this.request("sharing/check_job_status",e,"user","api","rpc","sharing.write")};Re.sharingCheckRemoveMemberJobStatus=function(e){return this.request("sharing/check_remove_member_job_status",e,"user","api","rpc","sharing.write")};Re.sharingCheckShareJobStatus=function(e){return this.request("sharing/check_share_job_status",e,"user","api","rpc","sharing.write")};Re.sharingCreateSharedLink=function(e){return this.request("sharing/create_shared_link",e,"user","api","rpc","sharing.write")};Re.sharingCreateSharedLinkWithSettings=function(e){return this.request("sharing/create_shared_link_with_settings",e,"user","api","rpc","sharing.write")};Re.sharingGetFileMetadata=function(e){return this.request("sharing/get_file_metadata",e,"user","api","rpc","sharing.read")};Re.sharingGetFileMetadataBatch=function(e){return this.request("sharing/get_file_metadata/batch",e,"user","api","rpc","sharing.read")};Re.sharingGetFolderMetadata=function(e){return this.request("sharing/get_folder_metadata",e,"user","api","rpc","sharing.read")};Re.sharingGetSharedLinkFile=function(e){return this.request("sharing/get_shared_link_file",e,"user","content","download","sharing.read")};Re.sharingGetSharedLinkMetadata=function(e){return this.request("sharing/get_shared_link_metadata",e,"app, user","api","rpc","sharing.read")};Re.sharingGetSharedLinks=function(e){return this.request("sharing/get_shared_links",e,"user","api","rpc","sharing.read")};Re.sharingListFileMembers=function(e){return this.request("sharing/list_file_members",e,"user","api","rpc","sharing.read")};Re.sharingListFileMembersBatch=function(e){return this.request("sharing/list_file_members/batch",e,"user","api","rpc","sharing.read")};Re.sharingListFileMembersContinue=function(e){return this.request("sharing/list_file_members/continue",e,"user","api","rpc","sharing.read")};Re.sharingListFolderMembers=function(e){return this.request("sharing/list_folder_members",e,"user","api","rpc","sharing.read")};Re.sharingListFolderMembersContinue=function(e){return this.request("sharing/list_folder_members/continue",e,"user","api","rpc","sharing.read")};Re.sharingListFolders=function(e){return this.request("sharing/list_folders",e,"user","api","rpc","sharing.read")};Re.sharingListFoldersContinue=function(e){return this.request("sharing/list_folders/continue",e,"user","api","rpc","sharing.read")};Re.sharingListMountableFolders=function(e){return this.request("sharing/list_mountable_folders",e,"user","api","rpc","sharing.read")};Re.sharingListMountableFoldersContinue=function(e){return this.request("sharing/list_mountable_folders/continue",e,"user","api","rpc","sharing.read")};Re.sharingListReceivedFiles=function(e){return this.request("sharing/list_received_files",e,"user","api","rpc","sharing.read")};Re.sharingListReceivedFilesContinue=function(e){return this.request("sharing/list_received_files/continue",e,"user","api","rpc","sharing.read")};Re.sharingListSharedLinks=function(e){return this.request("sharing/list_shared_links",e,"user","api","rpc","sharing.read")};Re.sharingModifySharedLinkSettings=function(e){return this.request("sharing/modify_shared_link_settings",e,"user","api","rpc","sharing.write")};Re.sharingMountFolder=function(e){return this.request("sharing/mount_folder",e,"user","api","rpc","sharing.write")};Re.sharingRelinquishFileMembership=function(e){return this.request("sharing/relinquish_file_membership",e,"user","api","rpc","sharing.write")};Re.sharingRelinquishFolderMembership=function(e){return this.request("sharing/relinquish_folder_membership",e,"user","api","rpc","sharing.write")};Re.sharingRemoveFileMember=function(e){return this.request("sharing/remove_file_member",e,"user","api","rpc","sharing.write")};Re.sharingRemoveFileMember2=function(e){return this.request("sharing/remove_file_member_2",e,"user","api","rpc","sharing.write")};Re.sharingRemoveFolderMember=function(e){return this.request("sharing/remove_folder_member",e,"user","api","rpc","sharing.write")};Re.sharingRevokeSharedLink=function(e){return this.request("sharing/revoke_shared_link",e,"user","api","rpc","sharing.write")};Re.sharingSetAccessInheritance=function(e){return this.request("sharing/set_access_inheritance",e,"user","api","rpc","sharing.write")};Re.sharingShareFolder=function(e){return this.request("sharing/share_folder",e,"user","api","rpc","sharing.write")};Re.sharingTransferFolder=function(e){return this.request("sharing/transfer_folder",e,"user","api","rpc","sharing.write")};Re.sharingUnmountFolder=function(e){return this.request("sharing/unmount_folder",e,"user","api","rpc","sharing.write")};Re.sharingUnshareFile=function(e){return this.request("sharing/unshare_file",e,"user","api","rpc","sharing.write")};Re.sharingUnshareFolder=function(e){return this.request("sharing/unshare_folder",e,"user","api","rpc","sharing.write")};Re.sharingUpdateFileMember=function(e){return this.request("sharing/update_file_member",e,"user","api","rpc","sharing.write")};Re.sharingUpdateFolderMember=function(e){return this.request("sharing/update_folder_member",e,"user","api","rpc","sharing.write")};Re.sharingUpdateFolderPolicy=function(e){return this.request("sharing/update_folder_policy",e,"user","api","rpc","sharing.write")};Re.teamDevicesListMemberDevices=function(e){return this.request("team/devices/list_member_devices",e,"team","api","rpc","sessions.list")};Re.teamDevicesListMembersDevices=function(e){return this.request("team/devices/list_members_devices",e,"team","api","rpc","sessions.list")};Re.teamDevicesListTeamDevices=function(e){return this.request("team/devices/list_team_devices",e,"team","api","rpc","sessions.list")};Re.teamDevicesRevokeDeviceSession=function(e){return this.request("team/devices/revoke_device_session",e,"team","api","rpc","sessions.modify")};Re.teamDevicesRevokeDeviceSessionBatch=function(e){return this.request("team/devices/revoke_device_session_batch",e,"team","api","rpc","sessions.modify")};Re.teamFeaturesGetValues=function(e){return this.request("team/features/get_values",e,"team","api","rpc","team_info.read")};Re.teamGetInfo=function(){return this.request("team/get_info",null,"team","api","rpc","team_info.read")};Re.teamGroupsCreate=function(e){return this.request("team/groups/create",e,"team","api","rpc","groups.write")};Re.teamGroupsDelete=function(e){return this.request("team/groups/delete",e,"team","api","rpc","groups.write")};Re.teamGroupsGetInfo=function(e){return this.request("team/groups/get_info",e,"team","api","rpc","groups.read")};Re.teamGroupsJobStatusGet=function(e){return this.request("team/groups/job_status/get",e,"team","api","rpc","groups.write")};Re.teamGroupsList=function(e){return this.request("team/groups/list",e,"team","api","rpc","groups.read")};Re.teamGroupsListContinue=function(e){return this.request("team/groups/list/continue",e,"team","api","rpc","groups.read")};Re.teamGroupsMembersAdd=function(e){return this.request("team/groups/members/add",e,"team","api","rpc","groups.write")};Re.teamGroupsMembersList=function(e){return this.request("team/groups/members/list",e,"team","api","rpc","groups.read")};Re.teamGroupsMembersListContinue=function(e){return this.request("team/groups/members/list/continue",e,"team","api","rpc","groups.read")};Re.teamGroupsMembersRemove=function(e){return this.request("team/groups/members/remove",e,"team","api","rpc","groups.write")};Re.teamGroupsMembersSetAccessType=function(e){return this.request("team/groups/members/set_access_type",e,"team","api","rpc","groups.write")};Re.teamGroupsUpdate=function(e){return this.request("team/groups/update",e,"team","api","rpc","groups.write")};Re.teamLegalHoldsCreatePolicy=function(e){return this.request("team/legal_holds/create_policy",e,"team","api","rpc","team_data.governance.write")};Re.teamLegalHoldsGetPolicy=function(e){return this.request("team/legal_holds/get_policy",e,"team","api","rpc","team_data.governance.write")};Re.teamLegalHoldsListHeldRevisions=function(e){return this.request("team/legal_holds/list_held_revisions",e,"team","api","rpc","team_data.governance.write")};Re.teamLegalHoldsListHeldRevisionsContinue=function(e){return this.request("team/legal_holds/list_held_revisions_continue",e,"team","api","rpc","team_data.governance.write")};Re.teamLegalHoldsListPolicies=function(e){return this.request("team/legal_holds/list_policies",e,"team","api","rpc","team_data.governance.write")};Re.teamLegalHoldsReleasePolicy=function(e){return this.request("team/legal_holds/release_policy",e,"team","api","rpc","team_data.governance.write")};Re.teamLegalHoldsUpdatePolicy=function(e){return this.request("team/legal_holds/update_policy",e,"team","api","rpc","team_data.governance.write")};Re.teamLinkedAppsListMemberLinkedApps=function(e){return this.request("team/linked_apps/list_member_linked_apps",e,"team","api","rpc","sessions.list")};Re.teamLinkedAppsListMembersLinkedApps=function(e){return this.request("team/linked_apps/list_members_linked_apps",e,"team","api","rpc","sessions.list")};Re.teamLinkedAppsListTeamLinkedApps=function(e){return this.request("team/linked_apps/list_team_linked_apps",e,"team","api","rpc","sessions.list")};Re.teamLinkedAppsRevokeLinkedApp=function(e){return this.request("team/linked_apps/revoke_linked_app",e,"team","api","rpc","sessions.modify")};Re.teamLinkedAppsRevokeLinkedAppBatch=function(e){return this.request("team/linked_apps/revoke_linked_app_batch",e,"team","api","rpc","sessions.modify")};Re.teamMemberSpaceLimitsExcludedUsersAdd=function(e){return this.request("team/member_space_limits/excluded_users/add",e,"team","api","rpc","members.write")};Re.teamMemberSpaceLimitsExcludedUsersList=function(e){return this.request("team/member_space_limits/excluded_users/list",e,"team","api","rpc","members.read")};Re.teamMemberSpaceLimitsExcludedUsersListContinue=function(e){return this.request("team/member_space_limits/excluded_users/list/continue",e,"team","api","rpc","members.read")};Re.teamMemberSpaceLimitsExcludedUsersRemove=function(e){return this.request("team/member_space_limits/excluded_users/remove",e,"team","api","rpc","members.write")};Re.teamMemberSpaceLimitsGetCustomQuota=function(e){return this.request("team/member_space_limits/get_custom_quota",e,"team","api","rpc","members.read")};Re.teamMemberSpaceLimitsRemoveCustomQuota=function(e){return this.request("team/member_space_limits/remove_custom_quota",e,"team","api","rpc","members.write")};Re.teamMemberSpaceLimitsSetCustomQuota=function(e){return this.request("team/member_space_limits/set_custom_quota",e,"team","api","rpc","members.read")};Re.teamMembersAddV2=function(e){return this.request("team/members/add_v2",e,"team","api","rpc","members.write")};Re.teamMembersAdd=function(e){return this.request("team/members/add",e,"team","api","rpc","members.write")};Re.teamMembersAddJobStatusGetV2=function(e){return this.request("team/members/add/job_status/get_v2",e,"team","api","rpc","members.write")};Re.teamMembersAddJobStatusGet=function(e){return this.request("team/members/add/job_status/get",e,"team","api","rpc","members.write")};Re.teamMembersDeleteProfilePhotoV2=function(e){return this.request("team/members/delete_profile_photo_v2",e,"team","api","rpc","members.write")};Re.teamMembersDeleteProfilePhoto=function(e){return this.request("team/members/delete_profile_photo",e,"team","api","rpc","members.write")};Re.teamMembersGetAvailableTeamMemberRoles=function(){return this.request("team/members/get_available_team_member_roles",null,"team","api","rpc","members.read")};Re.teamMembersGetInfoV2=function(e){return this.request("team/members/get_info_v2",e,"team","api","rpc","members.read")};Re.teamMembersGetInfo=function(e){return this.request("team/members/get_info",e,"team","api","rpc","members.read")};Re.teamMembersListV2=function(e){return this.request("team/members/list_v2",e,"team","api","rpc","members.read")};Re.teamMembersList=function(e){return this.request("team/members/list",e,"team","api","rpc","members.read")};Re.teamMembersListContinueV2=function(e){return this.request("team/members/list/continue_v2",e,"team","api","rpc","members.read")};Re.teamMembersListContinue=function(e){return this.request("team/members/list/continue",e,"team","api","rpc","members.read")};Re.teamMembersMoveFormerMemberFiles=function(e){return this.request("team/members/move_former_member_files",e,"team","api","rpc","members.write")};Re.teamMembersMoveFormerMemberFilesJobStatusCheck=function(e){return this.request("team/members/move_former_member_files/job_status/check",e,"team","api","rpc","members.write")};Re.teamMembersRecover=function(e){return this.request("team/members/recover",e,"team","api","rpc","members.delete")};Re.teamMembersRemove=function(e){return this.request("team/members/remove",e,"team","api","rpc","members.delete")};Re.teamMembersRemoveJobStatusGet=function(e){return this.request("team/members/remove/job_status/get",e,"team","api","rpc","members.delete")};Re.teamMembersSecondaryEmailsAdd=function(e){return this.request("team/members/secondary_emails/add",e,"team","api","rpc","members.write")};Re.teamMembersSecondaryEmailsDelete=function(e){return this.request("team/members/secondary_emails/delete",e,"team","api","rpc","members.write")};Re.teamMembersSecondaryEmailsResendVerificationEmails=function(e){return this.request("team/members/secondary_emails/resend_verification_emails",e,"team","api","rpc","members.write")};Re.teamMembersSendWelcomeEmail=function(e){return this.request("team/members/send_welcome_email",e,"team","api","rpc","members.write")};Re.teamMembersSetAdminPermissionsV2=function(e){return this.request("team/members/set_admin_permissions_v2",e,"team","api","rpc","members.write")};Re.teamMembersSetAdminPermissions=function(e){return this.request("team/members/set_admin_permissions",e,"team","api","rpc","members.write")};Re.teamMembersSetProfileV2=function(e){return this.request("team/members/set_profile_v2",e,"team","api","rpc","members.write")};Re.teamMembersSetProfile=function(e){return this.request("team/members/set_profile",e,"team","api","rpc","members.write")};Re.teamMembersSetProfilePhotoV2=function(e){return this.request("team/members/set_profile_photo_v2",e,"team","api","rpc","members.write")};Re.teamMembersSetProfilePhoto=function(e){return this.request("team/members/set_profile_photo",e,"team","api","rpc","members.write")};Re.teamMembersSuspend=function(e){return this.request("team/members/suspend",e,"team","api","rpc","members.write")};Re.teamMembersUnsuspend=function(e){return this.request("team/members/unsuspend",e,"team","api","rpc","members.write")};Re.teamNamespacesList=function(e){return this.request("team/namespaces/list",e,"team","api","rpc","team_data.member")};Re.teamNamespacesListContinue=function(e){return this.request("team/namespaces/list/continue",e,"team","api","rpc","team_data.member")};Re.teamPropertiesTemplateAdd=function(e){return this.request("team/properties/template/add",e,"team","api","rpc","files.team_metadata.write")};Re.teamPropertiesTemplateGet=function(e){return this.request("team/properties/template/get",e,"team","api","rpc","files.team_metadata.write")};Re.teamPropertiesTemplateList=function(){return this.request("team/properties/template/list",null,"team","api","rpc","files.team_metadata.write")};Re.teamPropertiesTemplateUpdate=function(e){return this.request("team/properties/template/update",e,"team","api","rpc","files.team_metadata.write")};Re.teamReportsGetActivity=function(e){return this.request("team/reports/get_activity",e,"team","api","rpc","team_info.read")};Re.teamReportsGetDevices=function(e){return this.request("team/reports/get_devices",e,"team","api","rpc","team_info.read")};Re.teamReportsGetMembership=function(e){return this.request("team/reports/get_membership",e,"team","api","rpc","team_info.read")};Re.teamReportsGetStorage=function(e){return this.request("team/reports/get_storage",e,"team","api","rpc","team_info.read")};Re.teamSharingAllowlistAdd=function(e){return this.request("team/sharing_allowlist/add",e,"team","api","rpc","team_info.write")};Re.teamSharingAllowlistList=function(e){return this.request("team/sharing_allowlist/list",e,"team","api","rpc","team_info.read")};Re.teamSharingAllowlistListContinue=function(e){return this.request("team/sharing_allowlist/list/continue",e,"team","api","rpc","team_info.read")};Re.teamSharingAllowlistRemove=function(e){return this.request("team/sharing_allowlist/remove",e,"team","api","rpc","team_info.write")};Re.teamTeamFolderActivate=function(e){return this.request("team/team_folder/activate",e,"team","api","rpc","team_data.content.write")};Re.teamTeamFolderArchive=function(e){return this.request("team/team_folder/archive",e,"team","api","rpc","team_data.content.write")};Re.teamTeamFolderArchiveCheck=function(e){return this.request("team/team_folder/archive/check",e,"team","api","rpc","team_data.content.write")};Re.teamTeamFolderCreate=function(e){return this.request("team/team_folder/create",e,"team","api","rpc","team_data.content.write")};Re.teamTeamFolderGetInfo=function(e){return this.request("team/team_folder/get_info",e,"team","api","rpc","team_data.content.read")};Re.teamTeamFolderList=function(e){return this.request("team/team_folder/list",e,"team","api","rpc","team_data.content.read")};Re.teamTeamFolderListContinue=function(e){return this.request("team/team_folder/list/continue",e,"team","api","rpc","team_data.content.read")};Re.teamTeamFolderPermanentlyDelete=function(e){return this.request("team/team_folder/permanently_delete",e,"team","api","rpc","team_data.content.write")};Re.teamTeamFolderRename=function(e){return this.request("team/team_folder/rename",e,"team","api","rpc","team_data.content.write")};Re.teamTeamFolderUpdateSyncSettings=function(e){return this.request("team/team_folder/update_sync_settings",e,"team","api","rpc","team_data.content.write")};Re.teamTokenGetAuthenticatedAdmin=function(){return this.request("team/token/get_authenticated_admin",null,"team","api","rpc","team_info.read")};Re.teamLogGetEvents=function(e){return this.request("team_log/get_events",e,"team","api","rpc","events.read")};Re.teamLogGetEventsContinue=function(e){return this.request("team_log/get_events/continue",e,"team","api","rpc","events.read")};Re.usersFeaturesGetValues=function(e){return this.request("users/features/get_values",e,"user","api","rpc","account_info.read")};Re.usersGetAccount=function(e){return this.request("users/get_account",e,"user","api","rpc","sharing.read")};Re.usersGetAccountBatch=function(e){return this.request("users/get_account_batch",e,"user","api","rpc","sharing.read")};Re.usersGetCurrentAccount=function(){return this.request("users/get_current_account",null,"user","api","rpc","account_info.read")};Re.usersGetSpaceUsage=function(){return this.request("users/get_space_usage",null,"user","api","rpc","account_info.read")};function a9(e){var t="000".concat(e.charCodeAt(0).toString(16)).slice(-4);return"\\u".concat(t)}var ag=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:L0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";return s?(r!==L0&&Ly[t]!==void 0&&(t=Ly[t],s="-"),"https://".concat(t).concat(s).concat(r,"/2/")):"https://".concat(r,"/2/")},n9=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:d4;return t!==d4&&(t="meta-".concat(t)),"https://".concat(t,"/oauth2/authorize")},f4=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:L0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:".",s="api";return t!==L0&&(s=Ly[s],r="-"),"https://".concat(s).concat(r).concat(t,"/oauth2/token")};function h4(e){return JSON.stringify(e).replace(/[\u007f-\uffff]/g,a9)}function i9(e){return new Date(Date.now()+e*1e3)}function m4(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope||typeof module>"u"||typeof window<"u"}function ng(){return typeof window<"u"}function ig(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function Ih(e){var t=e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");return t}function x0(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?x0=function(r){return typeof r}:x0=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},x0(e)}function o9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l9(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bd(e,t)}function c9(e){var t=JE();return function(){var s=Pd(e),n;if(t){var o=Pd(this).constructor;n=Reflect.construct(s,arguments,o)}else n=s.apply(this,arguments);return u9(this,n)}}function u9(e,t){return t&&(x0(t)==="object"||typeof t=="function")?t:d9(e)}function d9(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Iy(e){var t=typeof Map=="function"?new Map:void 0;return Iy=function(s){if(s===null||!f9(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(s))return t.get(s);t.set(s,n)}function n(){return g0(s,arguments,Pd(this).constructor)}return n.prototype=Object.create(s.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Bd(n,s)},Iy(e)}function g0(e,t,r){return JE()?g0=Reflect.construct:g0=function(n,o,l){var u=[null];u.push.apply(u,o);var d=Function.bind.apply(n,u),h=new d;return l&&Bd(h,l.prototype),h},g0.apply(null,arguments)}function JE(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function f9(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function Bd(e,t){return Bd=Object.setPrototypeOf||function(s,n){return s.__proto__=n,s},Bd(e,t)}function Pd(e){return Pd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Pd(e)}var h9=(function(e){l9(r,e);var t=c9(r);function r(s,n,o){var l;return o9(this,r),l=t.call(this,"Response failed with a ".concat(s," code")),l.name="DropboxResponseError",l.status=s,l.headers=n,l.error=o,l}return r})(Iy(Error));function m9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ZE=function e(t,r,s){m9(this,e),this.status=t,this.headers=r,this.result=s};function QE(e){return e.text().then(function(t){var r;try{r=JSON.parse(t)}catch{r=t}throw new h9(e.status,e.headers,r)})}function I0(e){return e.ok?e.text().then(function(t){var r;try{r=JSON.parse(t)}catch{r=t}return new ZE(e.status,e.headers,r)}):QE(e)}function p9(e){return e.ok?new Promise(function(t){m4()?e.blob().then(function(r){return t(r)}):e.buffer().then(function(r){return t(r)})}).then(function(t){var r=JSON.parse(e.headers.get("dropbox-api-result"));return m4()?r.fileBlob=t:r.fileBinary=t,new ZE(e.status,e.headers,r)}):QE(e)}function x9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g9(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function y9(e,t,r){return t&&g9(e.prototype,t),e}var Mh,Ho,og,v9=300*1e3,p4=128,b9=["legacy","offline","online"],w9=["code","token"],_9=["none","user","team"],N9=(function(){function e(t){x9(this,e),t=t||{},ng()?(Mh=window.fetch.bind(window),Ho=window.crypto||window.msCrypto):ig()?(Mh=self.fetch.bind(self),Ho=self.crypto):(Mh=require("node-fetch"),Ho=require("crypto")),typeof TextEncoder>"u"?og=require("util").TextEncoder:og=TextEncoder,this.fetch=t.fetch||Mh,this.accessToken=t.accessToken,this.accessTokenExpiresAt=t.accessTokenExpiresAt,this.refreshToken=t.refreshToken,this.clientId=t.clientId,this.clientSecret=t.clientSecret,this.domain=t.domain,this.domainDelimiter=t.domainDelimiter,this.customHeaders=t.customHeaders,this.dataOnBody=t.dataOnBody}return y9(e,[{key:"setAccessToken",value:function(r){this.accessToken=r}},{key:"getAccessToken",value:function(){return this.accessToken}},{key:"setClientId",value:function(r){this.clientId=r}},{key:"getClientId",value:function(){return this.clientId}},{key:"setClientSecret",value:function(r){this.clientSecret=r}},{key:"getClientSecret",value:function(){return this.clientSecret}},{key:"getRefreshToken",value:function(){return this.refreshToken}},{key:"setRefreshToken",value:function(r){this.refreshToken=r}},{key:"getAccessTokenExpiresAt",value:function(){return this.accessTokenExpiresAt}},{key:"setAccessTokenExpiresAt",value:function(r){this.accessTokenExpiresAt=r}},{key:"setCodeVerifier",value:function(r){this.codeVerifier=r}},{key:"getCodeVerifier",value:function(){return this.codeVerifier}},{key:"generateCodeChallenge",value:function(){var r=this,s=new og,n=s.encode(this.codeVerifier),o;if(ng()||ig())return Ho.subtle.digest("SHA-256",n).then(function(u){var d=btoa(String.fromCharCode.apply(null,new Uint8Array(u)));o=Ih(d).substr(0,128),r.codeChallenge=o});var l=Ho.createHash("sha256").update(n).digest();return o=Ih(l),this.codeChallenge=o,Promise.resolve()}},{key:"generatePKCECodes",value:function(){var r;if(ng()||ig()){var s=new Uint8Array(p4),n=Ho.getRandomValues(s),o=btoa(n);r=Ih(o).substr(0,128)}else{var l=Ho.randomBytes(p4);r=Ih(l).substr(0,128)}return this.codeVerifier=r,this.generateCodeChallenge()}},{key:"getAuthenticationUrl",value:function(r,s){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"token",l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,d=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"none",h=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,m=this.getClientId(),x=n9(this.domain);if(!m)throw new Error("A client id is required. You can set the client id using .setClientId().");if(o!=="code"&&!r)throw new Error("A redirect uri is required.");if(!w9.includes(o))throw new Error("Authorization type must be code or token");if(l&&!b9.includes(l))throw new Error("Token Access Type must be legacy, offline, or online");if(u&&!(u instanceof Array))throw new Error("Scope must be an array of strings");if(!_9.includes(d))throw new Error("includeGrantedScopes must be none, user, or team");var y;return o==="code"?y="".concat(x,"?response_type=code&client_id=").concat(m):y="".concat(x,"?response_type=token&client_id=").concat(m),r&&(y+="&redirect_uri=".concat(r)),s&&(y+="&state=".concat(s)),l&&(y+="&token_access_type=".concat(l)),u&&(y+="&scope=".concat(u.join(" "))),d!=="none"&&(y+="&include_granted_scopes=".concat(d)),h?this.generatePKCECodes().then(function(){return y+="&code_challenge_method=S256",y+="&code_challenge=".concat(n.codeChallenge),y}):Promise.resolve(y)}},{key:"getAccessTokenFromCode",value:function(r,s){var n=this.getClientId(),o=this.getClientSecret();if(!n)throw new Error("A client id is required. You can set the client id using .setClientId().");var l=f4(this.domain,this.domainDelimiter);if(l+="?grant_type=authorization_code",l+="&code=".concat(s),l+="&client_id=".concat(n),o)l+="&client_secret=".concat(o);else{if(!this.codeVerifier)throw new Error("You must use PKCE when generating the authorization URL to not include a client secret");l+="&code_verifier=".concat(this.codeVerifier)}r&&(l+="&redirect_uri=".concat(r));var u={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}};return this.fetch(l,u).then(function(d){return I0(d)})}},{key:"checkAndRefreshAccessToken",value:function(){var r=this.getRefreshToken()&&this.getClientId(),s=!this.getAccessTokenExpiresAt()||new Date(Date.now()+v9)>=this.getAccessTokenExpiresAt(),n=!this.getAccessToken();return(s||n)&&r?this.refreshAccessToken():Promise.resolve()}},{key:"refreshAccessToken",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.getClientId(),o=this.getClientSecret();if(!n)throw new Error("A client id is required. You can set the client id using .setClientId().");if(s&&!(s instanceof Array))throw new Error("Scope must be an array of strings");var l=f4(this.domain,this.domainDelimiter),u={headers:{"Content-Type":"application/json"},method:"POST"};if(this.dataOnBody){var d={grant_type:"refresh_token",client_id:n,refresh_token:this.getRefreshToken()};o&&(d.client_secret=o),s&&(d.scope=s.join(" ")),u.body=d}else l+="?grant_type=refresh_token&refresh_token=".concat(this.getRefreshToken()),l+="&client_id=".concat(n),o&&(l+="&client_secret=".concat(o)),s&&(l+="&scope=".concat(s.join(" ")));return this.fetch(l,u).then(function(h){return I0(h)}).then(function(h){r.setAccessToken(h.result.access_token),r.setAccessTokenExpiresAt(i9(h.result.expires_in))})}}]),e})();function k9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S9(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function E9(e,t,r){return t&&S9(e.prototype,t),e}var j9=typeof btoa>"u"?function(e){return Buffer.from(e).toString("base64")}:btoa,T9=(function(){function e(t){k9(this,e),t=t||{},t.auth?this.auth=t.auth:this.auth=new N9(t),this.fetch=t.fetch||this.auth.fetch,this.selectUser=t.selectUser,this.selectAdmin=t.selectAdmin,this.pathRoot=t.pathRoot,this.domain=t.domain||this.auth.domain,this.domainDelimiter=t.domainDelimiter||this.auth.domainDelimiter,this.customHeaders=t.customHeaders||this.auth.customHeaders,Object.assign(this,Re)}return E9(e,[{key:"request",value:function(r,s,n,o,l){switch(l){case QF:return this.rpcRequest(r,s,n,o);case t9:return this.downloadRequest(r,s,n,o);case e9:return this.uploadRequest(r,s,n,o);default:throw new Error("Invalid request style: ".concat(l))}}},{key:"rpcRequest",value:function(r,s,n,o){var l=this;return this.auth.checkAndRefreshAccessToken().then(function(){var u={method:"POST",body:s?JSON.stringify(s):null,headers:{}};return s&&(u.headers["Content-Type"]="application/json"),l.setAuthHeaders(n,u),l.setCommonHeaders(u),u}).then(function(u){return l.fetch(ag(o,l.domain,l.domainDelimiter)+r,u)}).then(function(u){return I0(u)})}},{key:"downloadRequest",value:function(r,s,n,o){var l=this;return this.auth.checkAndRefreshAccessToken().then(function(){var u={method:"POST",headers:{"Dropbox-API-Arg":h4(s)}};return l.setAuthHeaders(n,u),l.setCommonHeaders(u),u}).then(function(u){return l.fetch(ag(o,l.domain,l.domainDelimiter)+r,u)}).then(function(u){return p9(u)})}},{key:"uploadRequest",value:function(r,s,n,o){var l=this;return this.auth.checkAndRefreshAccessToken().then(function(){var u=s.contents;delete s.contents;var d={body:u,method:"POST",headers:{"Content-Type":"application/octet-stream","Dropbox-API-Arg":h4(s)}};return l.setAuthHeaders(n,d),l.setCommonHeaders(d),d}).then(function(u){return l.fetch(ag(o,l.domain,l.domainDelimiter)+r,u)}).then(function(u){return I0(u)})}},{key:"setAuthHeaders",value:function(r,s){if(r.split(",").length>1){var n=r.replace(" ","").split(",");n.includes(rg)&&this.auth.getAccessToken()?r=rg:n.includes(sg)&&this.auth.getAccessToken()?r=sg:n.includes(tg)&&(r=tg)}switch(r){case tg:if(this.auth.clientId&&this.auth.clientSecret){var o=j9("".concat(this.auth.clientId,":").concat(this.auth.clientSecret));s.headers.Authorization="Basic ".concat(o)}break;case sg:case rg:this.auth.getAccessToken()&&(s.headers.Authorization="Bearer ".concat(this.auth.getAccessToken()));break;case r9:case s9:break;default:throw new Error("Unhandled auth type: ".concat(r))}}},{key:"setCommonHeaders",value:function(r){var s=this;if(this.selectUser&&(r.headers["Dropbox-API-Select-User"]=this.selectUser),this.selectAdmin&&(r.headers["Dropbox-API-Select-Admin"]=this.selectAdmin),this.pathRoot&&(r.headers["Dropbox-API-Path-Root"]=this.pathRoot),this.customHeaders){var n=Object.keys(this.customHeaders);n.forEach(function(o){r.headers[o]=s.customHeaders[o]})}}}]),e})();const A9="fvr4cismfdje3d8",C9="ov7ykh1arjvag8q",R9="wCxiziVcNH0AAAAAAAAAATYQOTE7ajbAsA4aSyDz0_B0YMpZ5jqrelvDPamyPrf4";let Bh=null,lg=null;const D9=async()=>{if(Bh&&lg&&Date.now()<lg-6e5)return Bh;const e=await fetch("https://api.dropbox.com/oauth2/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:R9,client_id:A9,client_secret:C9})});if(!e.ok){const r=await e.json();throw console.error("Token refresh error:",r),new Error("Access Token  : "+(r.error_description||r.error))}const t=await e.json();return Bh=t.access_token,lg=Date.now()+t.expires_in*1e3,Bh},kl=async()=>{const e=await D9();return new T9({accessToken:e})},y0=async(e,t="/intranet")=>{try{const r=await kl(),n=`${Date.now()}_${e.name}`,o=`${t}/${n}`,l=await e.arrayBuffer(),u=await r.filesUpload({path:o,contents:l,mode:{".tag":"add"},autorename:!0});let d;try{d=(await r.sharingCreateSharedLinkWithSettings({path:u.result.path_display,settings:{requested_visibility:{".tag":"public"},audience:{".tag":"public"},access:{".tag":"viewer"}}})).result.url}catch(m){if(m.error?.error?.[".tag"]==="shared_link_already_exists")d=(await r.sharingListSharedLinks({path:u.result.path_display})).result.links[0]?.url;else throw m}return{url:d.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0",""),name:e.name,path:u.result.path_display,size:e.size}}catch(r){throw console.error("Dropbox upload error:",r),console.error("Error details:",JSON.stringify(r,null,2)),r.error&&console.error("Error response:",r.error),new Error("  : "+(r.error?.error_summary||r.message||"   "))}},af=async(e,t="/intranet")=>{const r=[];for(const s of e){const n=await y0(s,t);r.push(n)}return r},O9=async e=>{try{return await(await kl()).filesDeleteV2({path:e}),!0}catch(t){return console.error("Dropbox delete error:",t),!1}},v0=async e=>{try{if(!e)return!1;let t=e.replace("dl.dropboxusercontent.com","www.dropbox.com");t.includes("dl=")||(t+=t.includes("?")?"&dl=0":"?dl=0");const r=await kl(),s=await r.sharingGetSharedLinkMetadata({url:t});return s.result?.path_lower?(await r.filesDeleteV2({path:s.result.path_lower}),!0):!1}catch(t){return console.error("Dropbox delete by URL error:",t),!!(t.error?.error?.[".tag"]==="path"||t.error?.error_summary?.includes("not_found"))}},om=async e=>{if(!(!e||e.length===0))for(const t of e){const r=typeof t=="string"?t:t?.url;r&&await v0(r)}},F9=async(e="")=>{try{return(await(await kl()).filesListFolder({path:e})).result.entries.map(n=>({name:n.name,path:n.path_display,id:n.id,isFolder:n[".tag"]==="folder",size:n.size||0,modified:n.client_modified||n.server_modified}))}catch(t){throw console.error("Dropbox list files error:",t),new Error("   : "+(t.error?.error_summary||t.message))}},L9=async e=>{try{return(await(await kl()).filesGetTemporaryLink({path:e})).result.link}catch(t){throw console.error("Dropbox get download link error:",t),new Error("   .")}},I9=async(e,t="/")=>{try{const r=await kl(),s=`${t}/${e.name}`,n=await e.arrayBuffer();return{path:(await r.filesUpload({path:s,contents:n,mode:{".tag":"overwrite"},autorename:!1})).result.path_display,name:e.name,size:e.size}}catch(r){throw console.error("Dropbox upload error:",r),new Error("  : "+(r.error?.error_summary||r.message))}},x4=async e=>{try{return await(await kl()).filesCreateFolderV2({path:e,autorename:!1}),!0}catch(t){if(t.error?.error?.[".tag"]==="path"&&t.error?.error?.path?.[".tag"]==="conflict")return!0;throw console.error("Dropbox create folder error:",t),new Error("  : "+(t.error?.error_summary||t.message))}};var M9=Object.defineProperty,B9=Object.defineProperties,P9=Object.getOwnPropertyDescriptors,g4=Object.getOwnPropertySymbols,U9=Object.prototype.hasOwnProperty,z9=Object.prototype.propertyIsEnumerable,My=(e,t,r)=>t in e?M9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,rr=(e,t)=>{for(var r in t||(t={}))U9.call(t,r)&&My(e,r,t[r]);if(g4)for(var r of g4(t))z9.call(t,r)&&My(e,r,t[r]);return e},Ei=(e,t)=>B9(e,P9(t)),Ze=(e,t,r)=>My(e,typeof t!="symbol"?t+"":t,r),$9=(e,t,r)=>new Promise((s,n)=>{var o=d=>{try{u(r.next(d))}catch(h){n(h)}},l=d=>{try{u(r.throw(d))}catch(h){n(h)}},u=d=>d.done?s(d.value):Promise.resolve(d.value).then(o,l);u((r=r.apply(e,t)).next())});class M0{constructor(t){Ze(this,"rootKey"),this.rootKey=t}}const q9=Object.seal({});class et extends M0{constructor(t){super(t),Ze(this,"root"),this.root=new Array}prepForXml(t){var r;t.stack.push(this);const s=this.root.map(n=>n instanceof M0?n.prepForXml(t):n).filter(n=>n!==void 0);return t.stack.pop(),{[this.rootKey]:s.length?s.length===1&&((r=s[0])!=null&&r._attr)?s[0]:s:q9}}addChildElement(t){return this.root.push(t),this}}class Ci extends et{prepForXml(t){const r=super.prepForXml(t);if(r&&(typeof r[this.rootKey]!="object"||Object.keys(r[this.rootKey]).length))return r}}class Ct extends M0{constructor(t){super("_attr"),Ze(this,"xmlKeys"),this.root=t}prepForXml(t){const r={};return Object.entries(this.root).forEach(([s,n])=>{if(n!==void 0){const o=this.xmlKeys&&this.xmlKeys[s]||s;r[o]=n}}),{_attr:r}}}class Ri extends M0{constructor(t){super("_attr"),this.root=t}prepForXml(t){return{_attr:Object.values(this.root).filter(({value:s})=>s!==void 0).reduce((s,{key:n,value:o})=>Ei(rr({},s),{[n]:o}),{})}}}class us extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}}var $n=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var cg={},Ph={exports:{}},y4;function wv(){if(y4)return Ph.exports;y4=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(C,F,O){return Function.prototype.apply.call(C,F,O)},r;e&&typeof e.ownKeys=="function"?r=e.ownKeys:Object.getOwnPropertySymbols?r=function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:r=function(C){return Object.getOwnPropertyNames(C)};function s(E){console&&console.warn&&console.warn(E)}var n=Number.isNaN||function(C){return C!==C};function o(){o.init.call(this)}Ph.exports=o,Ph.exports.once=w,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var l=10;function u(E){if(typeof E!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(E){if(typeof E!="number"||E<0||n(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");l=E}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(C){if(typeof C!="number"||C<0||n(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this};function d(E){return E._maxListeners===void 0?o.defaultMaxListeners:E._maxListeners}o.prototype.getMaxListeners=function(){return d(this)},o.prototype.emit=function(C){for(var F=[],O=1;O<arguments.length;O++)F.push(arguments[O]);var B=C==="error",L=this._events;if(L!==void 0)B=B&&L.error===void 0;else if(!B)return!1;if(B){var H;if(F.length>0&&(H=F[0]),H instanceof Error)throw H;var ue=new Error("Unhandled error."+(H?" ("+H.message+")":""));throw ue.context=H,ue}var A=L[C];if(A===void 0)return!1;if(typeof A=="function")t(A,this,F);else for(var Y=A.length,I=v(A,Y),O=0;O<Y;++O)t(I[O],this,F);return!0};function h(E,C,F,O){var B,L,H;if(u(F),L=E._events,L===void 0?(L=E._events=Object.create(null),E._eventsCount=0):(L.newListener!==void 0&&(E.emit("newListener",C,F.listener?F.listener:F),L=E._events),H=L[C]),H===void 0)H=L[C]=F,++E._eventsCount;else if(typeof H=="function"?H=L[C]=O?[F,H]:[H,F]:O?H.unshift(F):H.push(F),B=d(E),B>0&&H.length>B&&!H.warned){H.warned=!0;var ue=new Error("Possible EventEmitter memory leak detected. "+H.length+" "+String(C)+" listeners added. Use emitter.setMaxListeners() to increase limit");ue.name="MaxListenersExceededWarning",ue.emitter=E,ue.type=C,ue.count=H.length,s(ue)}return E}o.prototype.addListener=function(C,F){return h(this,C,F,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(C,F){return h(this,C,F,!0)};function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function x(E,C,F){var O={fired:!1,wrapFn:void 0,target:E,type:C,listener:F},B=m.bind(O);return B.listener=F,O.wrapFn=B,B}o.prototype.once=function(C,F){return u(F),this.on(C,x(this,C,F)),this},o.prototype.prependOnceListener=function(C,F){return u(F),this.prependListener(C,x(this,C,F)),this},o.prototype.removeListener=function(C,F){var O,B,L,H,ue;if(u(F),B=this._events,B===void 0)return this;if(O=B[C],O===void 0)return this;if(O===F||O.listener===F)--this._eventsCount===0?this._events=Object.create(null):(delete B[C],B.removeListener&&this.emit("removeListener",C,O.listener||F));else if(typeof O!="function"){for(L=-1,H=O.length-1;H>=0;H--)if(O[H]===F||O[H].listener===F){ue=O[H].listener,L=H;break}if(L<0)return this;L===0?O.shift():g(O,L),O.length===1&&(B[C]=O[0]),B.removeListener!==void 0&&this.emit("removeListener",C,ue||F)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(C){var F,O,B;if(O=this._events,O===void 0)return this;if(O.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):O[C]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete O[C]),this;if(arguments.length===0){var L=Object.keys(O),H;for(B=0;B<L.length;++B)H=L[B],H!=="removeListener"&&this.removeAllListeners(H);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(F=O[C],typeof F=="function")this.removeListener(C,F);else if(F!==void 0)for(B=F.length-1;B>=0;B--)this.removeListener(C,F[B]);return this};function y(E,C,F){var O=E._events;if(O===void 0)return[];var B=O[C];return B===void 0?[]:typeof B=="function"?F?[B.listener||B]:[B]:F?_(B):v(B,B.length)}o.prototype.listeners=function(C){return y(this,C,!0)},o.prototype.rawListeners=function(C){return y(this,C,!1)},o.listenerCount=function(E,C){return typeof E.listenerCount=="function"?E.listenerCount(C):b.call(E,C)},o.prototype.listenerCount=b;function b(E){var C=this._events;if(C!==void 0){var F=C[E];if(typeof F=="function")return 1;if(F!==void 0)return F.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function v(E,C){for(var F=new Array(C),O=0;O<C;++O)F[O]=E[O];return F}function g(E,C){for(;C+1<E.length;C++)E[C]=E[C+1];E.pop()}function _(E){for(var C=new Array(E.length),F=0;F<C.length;++F)C[F]=E[F].listener||E[F];return C}function w(E,C){return new Promise(function(F,O){function B(H){E.removeListener(C,L),O(H)}function L(){typeof E.removeListener=="function"&&E.removeListener("error",B),F([].slice.call(arguments))}N(E,C,L,{once:!0}),C!=="error"&&S(E,B,{once:!0})})}function S(E,C,F){typeof E.on=="function"&&N(E,"error",C,F)}function N(E,C,F,O){if(typeof E.on=="function")O.once?E.once(C,F):E.on(C,F);else if(typeof E.addEventListener=="function")E.addEventListener(C,function B(L){O.once&&E.removeEventListener(C,B),F(L)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E)}return Ph.exports}var Uh={exports:{}},v4;function bo(){return v4||(v4=1,typeof Object.create=="function"?Uh.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Uh.exports=function(t,r){if(r){t.super_=r;var s=function(){};s.prototype=r.prototype,t.prototype=new s,t.prototype.constructor=t}}),Uh.exports}function H9(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ej={exports:{}},gs=ej.exports={},Pn,Un;function By(){throw new Error("setTimeout has not been defined")}function Py(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Pn=setTimeout:Pn=By}catch{Pn=By}try{typeof clearTimeout=="function"?Un=clearTimeout:Un=Py}catch{Un=Py}})();function tj(e){if(Pn===setTimeout)return setTimeout(e,0);if((Pn===By||!Pn)&&setTimeout)return Pn=setTimeout,setTimeout(e,0);try{return Pn(e,0)}catch{try{return Pn.call(null,e,0)}catch{return Pn.call(this,e,0)}}}function W9(e){if(Un===clearTimeout)return clearTimeout(e);if((Un===Py||!Un)&&clearTimeout)return Un=clearTimeout,clearTimeout(e);try{return Un(e)}catch{try{return Un.call(null,e)}catch{return Un.call(this,e)}}}var gi=[],Ic=!1,sl,b0=-1;function G9(){!Ic||!sl||(Ic=!1,sl.length?gi=sl.concat(gi):b0=-1,gi.length&&rj())}function rj(){if(!Ic){var e=tj(G9);Ic=!0;for(var t=gi.length;t;){for(sl=gi,gi=[];++b0<t;)sl&&sl[b0].run();b0=-1,t=gi.length}sl=null,Ic=!1,W9(e)}}gs.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];gi.push(new sj(e,t)),gi.length===1&&!Ic&&tj(rj)};function sj(e,t){this.fun=e,this.array=t}sj.prototype.run=function(){this.fun.apply(null,this.array)};gs.title="browser";gs.browser=!0;gs.env={};gs.argv=[];gs.version="";gs.versions={};function Di(){}gs.on=Di;gs.addListener=Di;gs.once=Di;gs.off=Di;gs.removeListener=Di;gs.removeAllListeners=Di;gs.emit=Di;gs.prependListener=Di;gs.prependOnceListener=Di;gs.listeners=function(e){return[]};gs.binding=function(e){throw new Error("process.binding is not supported")};gs.cwd=function(){return"/"};gs.chdir=function(e){throw new Error("process.chdir is not supported")};gs.umask=function(){return 0};var V9=ej.exports;const sr=H9(V9);var ug,b4;function aj(){return b4||(b4=1,ug=wv().EventEmitter),ug}var dg={},ed={},w4;function K9(){if(w4)return ed;w4=1,ed.byteLength=u,ed.toByteArray=h,ed.fromByteArray=y;for(var e=[],t=[],r=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,o=s.length;n<o;++n)e[n]=s[n],t[s.charCodeAt(n)]=n;t[45]=62,t[95]=63;function l(b){var v=b.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=b.indexOf("=");g===-1&&(g=v);var _=g===v?0:4-g%4;return[g,_]}function u(b){var v=l(b),g=v[0],_=v[1];return(g+_)*3/4-_}function d(b,v,g){return(v+g)*3/4-g}function h(b){var v,g=l(b),_=g[0],w=g[1],S=new r(d(b,_,w)),N=0,E=w>0?_-4:_,C;for(C=0;C<E;C+=4)v=t[b.charCodeAt(C)]<<18|t[b.charCodeAt(C+1)]<<12|t[b.charCodeAt(C+2)]<<6|t[b.charCodeAt(C+3)],S[N++]=v>>16&255,S[N++]=v>>8&255,S[N++]=v&255;return w===2&&(v=t[b.charCodeAt(C)]<<2|t[b.charCodeAt(C+1)]>>4,S[N++]=v&255),w===1&&(v=t[b.charCodeAt(C)]<<10|t[b.charCodeAt(C+1)]<<4|t[b.charCodeAt(C+2)]>>2,S[N++]=v>>8&255,S[N++]=v&255),S}function m(b){return e[b>>18&63]+e[b>>12&63]+e[b>>6&63]+e[b&63]}function x(b,v,g){for(var _,w=[],S=v;S<g;S+=3)_=(b[S]<<16&16711680)+(b[S+1]<<8&65280)+(b[S+2]&255),w.push(m(_));return w.join("")}function y(b){for(var v,g=b.length,_=g%3,w=[],S=16383,N=0,E=g-_;N<E;N+=S)w.push(x(b,N,N+S>E?E:N+S));return _===1?(v=b[g-1],w.push(e[v>>2]+e[v<<4&63]+"==")):_===2&&(v=(b[g-2]<<8)+b[g-1],w.push(e[v>>10]+e[v>>4&63]+e[v<<2&63]+"=")),w.join("")}return ed}var zh={};var _4;function X9(){return _4||(_4=1,zh.read=function(e,t,r,s,n){var o,l,u=n*8-s-1,d=(1<<u)-1,h=d>>1,m=-7,x=r?n-1:0,y=r?-1:1,b=e[t+x];for(x+=y,o=b&(1<<-m)-1,b>>=-m,m+=u;m>0;o=o*256+e[t+x],x+=y,m-=8);for(l=o&(1<<-m)-1,o>>=-m,m+=s;m>0;l=l*256+e[t+x],x+=y,m-=8);if(o===0)o=1-h;else{if(o===d)return l?NaN:(b?-1:1)*(1/0);l=l+Math.pow(2,s),o=o-h}return(b?-1:1)*l*Math.pow(2,o-s)},zh.write=function(e,t,r,s,n,o){var l,u,d,h=o*8-n-1,m=(1<<h)-1,x=m>>1,y=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=s?0:o-1,v=s?1:-1,g=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,l=m):(l=Math.floor(Math.log(t)/Math.LN2),t*(d=Math.pow(2,-l))<1&&(l--,d*=2),l+x>=1?t+=y/d:t+=y*Math.pow(2,1-x),t*d>=2&&(l++,d/=2),l+x>=m?(u=0,l=m):l+x>=1?(u=(t*d-1)*Math.pow(2,n),l=l+x):(u=t*Math.pow(2,x-1)*Math.pow(2,n),l=0));n>=8;e[r+b]=u&255,b+=v,u/=256,n-=8);for(l=l<<n|u,h+=n;h>0;e[r+b]=l&255,b+=v,l/=256,h-=8);e[r+b-v]|=g*128}),zh}var N4;function lm(){return N4||(N4=1,(function(e){var t=K9(),r=X9(),s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=S,e.INSPECT_MAX_BYTES=50;var n=2147483647;e.kMaxLength=n,u.TYPED_ARRAY_SUPPORT=o(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var z=new Uint8Array(1),T={foo:function(){return 42}};return Object.setPrototypeOf(T,Uint8Array.prototype),Object.setPrototypeOf(z,T),z.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function l(z){if(z>n)throw new RangeError('The value "'+z+'" is invalid for option "size"');var T=new Uint8Array(z);return Object.setPrototypeOf(T,u.prototype),T}function u(z,T,R){if(typeof z=="number"){if(typeof T=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return x(z)}return d(z,T,R)}u.poolSize=8192;function d(z,T,R){if(typeof z=="string")return y(z,T);if(ArrayBuffer.isView(z))return v(z);if(z==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z);if(G(z,ArrayBuffer)||z&&G(z.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(G(z,SharedArrayBuffer)||z&&G(z.buffer,SharedArrayBuffer)))return g(z,T,R);if(typeof z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var q=z.valueOf&&z.valueOf();if(q!=null&&q!==z)return u.from(q,T,R);var me=_(z);if(me)return me;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof z[Symbol.toPrimitive]=="function")return u.from(z[Symbol.toPrimitive]("string"),T,R);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z)}u.from=function(z,T,R){return d(z,T,R)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function h(z){if(typeof z!="number")throw new TypeError('"size" argument must be of type number');if(z<0)throw new RangeError('The value "'+z+'" is invalid for option "size"')}function m(z,T,R){return h(z),z<=0?l(z):T!==void 0?typeof R=="string"?l(z).fill(T,R):l(z).fill(T):l(z)}u.alloc=function(z,T,R){return m(z,T,R)};function x(z){return h(z),l(z<0?0:w(z)|0)}u.allocUnsafe=function(z){return x(z)},u.allocUnsafeSlow=function(z){return x(z)};function y(z,T){if((typeof T!="string"||T==="")&&(T="utf8"),!u.isEncoding(T))throw new TypeError("Unknown encoding: "+T);var R=N(z,T)|0,q=l(R),me=q.write(z,T);return me!==R&&(q=q.slice(0,me)),q}function b(z){for(var T=z.length<0?0:w(z.length)|0,R=l(T),q=0;q<T;q+=1)R[q]=z[q]&255;return R}function v(z){if(G(z,Uint8Array)){var T=new Uint8Array(z);return g(T.buffer,T.byteOffset,T.byteLength)}return b(z)}function g(z,T,R){if(T<0||z.byteLength<T)throw new RangeError('"offset" is outside of buffer bounds');if(z.byteLength<T+(R||0))throw new RangeError('"length" is outside of buffer bounds');var q;return T===void 0&&R===void 0?q=new Uint8Array(z):R===void 0?q=new Uint8Array(z,T):q=new Uint8Array(z,T,R),Object.setPrototypeOf(q,u.prototype),q}function _(z){if(u.isBuffer(z)){var T=w(z.length)|0,R=l(T);return R.length===0||z.copy(R,0,0,T),R}if(z.length!==void 0)return typeof z.length!="number"||k(z.length)?l(0):b(z);if(z.type==="Buffer"&&Array.isArray(z.data))return b(z.data)}function w(z){if(z>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return z|0}function S(z){return+z!=z&&(z=0),u.alloc(+z)}u.isBuffer=function(T){return T!=null&&T._isBuffer===!0&&T!==u.prototype},u.compare=function(T,R){if(G(T,Uint8Array)&&(T=u.from(T,T.offset,T.byteLength)),G(R,Uint8Array)&&(R=u.from(R,R.offset,R.byteLength)),!u.isBuffer(T)||!u.isBuffer(R))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(T===R)return 0;for(var q=T.length,me=R.length,_e=0,le=Math.min(q,me);_e<le;++_e)if(T[_e]!==R[_e]){q=T[_e],me=R[_e];break}return q<me?-1:me<q?1:0},u.isEncoding=function(T){switch(String(T).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(T,R){if(!Array.isArray(T))throw new TypeError('"list" argument must be an Array of Buffers');if(T.length===0)return u.alloc(0);var q;if(R===void 0)for(R=0,q=0;q<T.length;++q)R+=T[q].length;var me=u.allocUnsafe(R),_e=0;for(q=0;q<T.length;++q){var le=T[q];if(G(le,Uint8Array))_e+le.length>me.length?u.from(le).copy(me,_e):Uint8Array.prototype.set.call(me,le,_e);else if(u.isBuffer(le))le.copy(me,_e);else throw new TypeError('"list" argument must be an Array of Buffers');_e+=le.length}return me};function N(z,T){if(u.isBuffer(z))return z.length;if(ArrayBuffer.isView(z)||G(z,ArrayBuffer))return z.byteLength;if(typeof z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof z);var R=z.length,q=arguments.length>2&&arguments[2]===!0;if(!q&&R===0)return 0;for(var me=!1;;)switch(T){case"ascii":case"latin1":case"binary":return R;case"utf8":case"utf-8":return U(z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R*2;case"hex":return R>>>1;case"base64":return ie(z).length;default:if(me)return q?-1:U(z).length;T=(""+T).toLowerCase(),me=!0}}u.byteLength=N;function E(z,T,R){var q=!1;if((T===void 0||T<0)&&(T=0),T>this.length||((R===void 0||R>this.length)&&(R=this.length),R<=0)||(R>>>=0,T>>>=0,R<=T))return"";for(z||(z="utf8");;)switch(z){case"hex":return te(this,T,R);case"utf8":case"utf-8":return I(this,T,R);case"ascii":return re(this,T,R);case"latin1":case"binary":return ve(this,T,R);case"base64":return Y(this,T,R);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ke(this,T,R);default:if(q)throw new TypeError("Unknown encoding: "+z);z=(z+"").toLowerCase(),q=!0}}u.prototype._isBuffer=!0;function C(z,T,R){var q=z[T];z[T]=z[R],z[R]=q}u.prototype.swap16=function(){var T=this.length;if(T%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var R=0;R<T;R+=2)C(this,R,R+1);return this},u.prototype.swap32=function(){var T=this.length;if(T%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var R=0;R<T;R+=4)C(this,R,R+3),C(this,R+1,R+2);return this},u.prototype.swap64=function(){var T=this.length;if(T%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var R=0;R<T;R+=8)C(this,R,R+7),C(this,R+1,R+6),C(this,R+2,R+5),C(this,R+3,R+4);return this},u.prototype.toString=function(){var T=this.length;return T===0?"":arguments.length===0?I(this,0,T):E.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(T){if(!u.isBuffer(T))throw new TypeError("Argument must be a Buffer");return this===T?!0:u.compare(this,T)===0},u.prototype.inspect=function(){var T="",R=e.INSPECT_MAX_BYTES;return T=this.toString("hex",0,R).replace(/(.{2})/g,"$1 ").trim(),this.length>R&&(T+=" ... "),"<Buffer "+T+">"},s&&(u.prototype[s]=u.prototype.inspect),u.prototype.compare=function(T,R,q,me,_e){if(G(T,Uint8Array)&&(T=u.from(T,T.offset,T.byteLength)),!u.isBuffer(T))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof T);if(R===void 0&&(R=0),q===void 0&&(q=T?T.length:0),me===void 0&&(me=0),_e===void 0&&(_e=this.length),R<0||q>T.length||me<0||_e>this.length)throw new RangeError("out of range index");if(me>=_e&&R>=q)return 0;if(me>=_e)return-1;if(R>=q)return 1;if(R>>>=0,q>>>=0,me>>>=0,_e>>>=0,this===T)return 0;for(var le=_e-me,Ae=q-R,Me=Math.min(le,Ae),Ee=this.slice(me,_e),Ce=T.slice(R,q),Je=0;Je<Me;++Je)if(Ee[Je]!==Ce[Je]){le=Ee[Je],Ae=Ce[Je];break}return le<Ae?-1:Ae<le?1:0};function F(z,T,R,q,me){if(z.length===0)return-1;if(typeof R=="string"?(q=R,R=0):R>2147483647?R=2147483647:R<-2147483648&&(R=-2147483648),R=+R,k(R)&&(R=me?0:z.length-1),R<0&&(R=z.length+R),R>=z.length){if(me)return-1;R=z.length-1}else if(R<0)if(me)R=0;else return-1;if(typeof T=="string"&&(T=u.from(T,q)),u.isBuffer(T))return T.length===0?-1:O(z,T,R,q,me);if(typeof T=="number")return T=T&255,typeof Uint8Array.prototype.indexOf=="function"?me?Uint8Array.prototype.indexOf.call(z,T,R):Uint8Array.prototype.lastIndexOf.call(z,T,R):O(z,[T],R,q,me);throw new TypeError("val must be string, number or Buffer")}function O(z,T,R,q,me){var _e=1,le=z.length,Ae=T.length;if(q!==void 0&&(q=String(q).toLowerCase(),q==="ucs2"||q==="ucs-2"||q==="utf16le"||q==="utf-16le")){if(z.length<2||T.length<2)return-1;_e=2,le/=2,Ae/=2,R/=2}function Me(tt,De){return _e===1?tt[De]:tt.readUInt16BE(De*_e)}var Ee;if(me){var Ce=-1;for(Ee=R;Ee<le;Ee++)if(Me(z,Ee)===Me(T,Ce===-1?0:Ee-Ce)){if(Ce===-1&&(Ce=Ee),Ee-Ce+1===Ae)return Ce*_e}else Ce!==-1&&(Ee-=Ee-Ce),Ce=-1}else for(R+Ae>le&&(R=le-Ae),Ee=R;Ee>=0;Ee--){for(var Je=!0,$e=0;$e<Ae;$e++)if(Me(z,Ee+$e)!==Me(T,$e)){Je=!1;break}if(Je)return Ee}return-1}u.prototype.includes=function(T,R,q){return this.indexOf(T,R,q)!==-1},u.prototype.indexOf=function(T,R,q){return F(this,T,R,q,!0)},u.prototype.lastIndexOf=function(T,R,q){return F(this,T,R,q,!1)};function B(z,T,R,q){R=Number(R)||0;var me=z.length-R;q?(q=Number(q),q>me&&(q=me)):q=me;var _e=T.length;q>_e/2&&(q=_e/2);for(var le=0;le<q;++le){var Ae=parseInt(T.substr(le*2,2),16);if(k(Ae))return le;z[R+le]=Ae}return le}function L(z,T,R,q){return W(U(T,z.length-R),z,R,q)}function H(z,T,R,q){return W(ce(T),z,R,q)}function ue(z,T,R,q){return W(ie(T),z,R,q)}function A(z,T,R,q){return W(ne(T,z.length-R),z,R,q)}u.prototype.write=function(T,R,q,me){if(R===void 0)me="utf8",q=this.length,R=0;else if(q===void 0&&typeof R=="string")me=R,q=this.length,R=0;else if(isFinite(R))R=R>>>0,isFinite(q)?(q=q>>>0,me===void 0&&(me="utf8")):(me=q,q=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var _e=this.length-R;if((q===void 0||q>_e)&&(q=_e),T.length>0&&(q<0||R<0)||R>this.length)throw new RangeError("Attempt to write outside buffer bounds");me||(me="utf8");for(var le=!1;;)switch(me){case"hex":return B(this,T,R,q);case"utf8":case"utf-8":return L(this,T,R,q);case"ascii":case"latin1":case"binary":return H(this,T,R,q);case"base64":return ue(this,T,R,q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,T,R,q);default:if(le)throw new TypeError("Unknown encoding: "+me);me=(""+me).toLowerCase(),le=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Y(z,T,R){return T===0&&R===z.length?t.fromByteArray(z):t.fromByteArray(z.slice(T,R))}function I(z,T,R){R=Math.min(z.length,R);for(var q=[],me=T;me<R;){var _e=z[me],le=null,Ae=_e>239?4:_e>223?3:_e>191?2:1;if(me+Ae<=R){var Me,Ee,Ce,Je;switch(Ae){case 1:_e<128&&(le=_e);break;case 2:Me=z[me+1],(Me&192)===128&&(Je=(_e&31)<<6|Me&63,Je>127&&(le=Je));break;case 3:Me=z[me+1],Ee=z[me+2],(Me&192)===128&&(Ee&192)===128&&(Je=(_e&15)<<12|(Me&63)<<6|Ee&63,Je>2047&&(Je<55296||Je>57343)&&(le=Je));break;case 4:Me=z[me+1],Ee=z[me+2],Ce=z[me+3],(Me&192)===128&&(Ee&192)===128&&(Ce&192)===128&&(Je=(_e&15)<<18|(Me&63)<<12|(Ee&63)<<6|Ce&63,Je>65535&&Je<1114112&&(le=Je))}}le===null?(le=65533,Ae=1):le>65535&&(le-=65536,q.push(le>>>10&1023|55296),le=56320|le&1023),q.push(le),me+=Ae}return Q(q)}var ae=4096;function Q(z){var T=z.length;if(T<=ae)return String.fromCharCode.apply(String,z);for(var R="",q=0;q<T;)R+=String.fromCharCode.apply(String,z.slice(q,q+=ae));return R}function re(z,T,R){var q="";R=Math.min(z.length,R);for(var me=T;me<R;++me)q+=String.fromCharCode(z[me]&127);return q}function ve(z,T,R){var q="";R=Math.min(z.length,R);for(var me=T;me<R;++me)q+=String.fromCharCode(z[me]);return q}function te(z,T,R){var q=z.length;(!T||T<0)&&(T=0),(!R||R<0||R>q)&&(R=q);for(var me="",_e=T;_e<R;++_e)me+=de[z[_e]];return me}function ke(z,T,R){for(var q=z.slice(T,R),me="",_e=0;_e<q.length-1;_e+=2)me+=String.fromCharCode(q[_e]+q[_e+1]*256);return me}u.prototype.slice=function(T,R){var q=this.length;T=~~T,R=R===void 0?q:~~R,T<0?(T+=q,T<0&&(T=0)):T>q&&(T=q),R<0?(R+=q,R<0&&(R=0)):R>q&&(R=q),R<T&&(R=T);var me=this.subarray(T,R);return Object.setPrototypeOf(me,u.prototype),me};function Z(z,T,R){if(z%1!==0||z<0)throw new RangeError("offset is not uint");if(z+T>R)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(T,R,q){T=T>>>0,R=R>>>0,q||Z(T,R,this.length);for(var me=this[T],_e=1,le=0;++le<R&&(_e*=256);)me+=this[T+le]*_e;return me},u.prototype.readUintBE=u.prototype.readUIntBE=function(T,R,q){T=T>>>0,R=R>>>0,q||Z(T,R,this.length);for(var me=this[T+--R],_e=1;R>0&&(_e*=256);)me+=this[T+--R]*_e;return me},u.prototype.readUint8=u.prototype.readUInt8=function(T,R){return T=T>>>0,R||Z(T,1,this.length),this[T]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(T,R){return T=T>>>0,R||Z(T,2,this.length),this[T]|this[T+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(T,R){return T=T>>>0,R||Z(T,2,this.length),this[T]<<8|this[T+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(T,R){return T=T>>>0,R||Z(T,4,this.length),(this[T]|this[T+1]<<8|this[T+2]<<16)+this[T+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(T,R){return T=T>>>0,R||Z(T,4,this.length),this[T]*16777216+(this[T+1]<<16|this[T+2]<<8|this[T+3])},u.prototype.readIntLE=function(T,R,q){T=T>>>0,R=R>>>0,q||Z(T,R,this.length);for(var me=this[T],_e=1,le=0;++le<R&&(_e*=256);)me+=this[T+le]*_e;return _e*=128,me>=_e&&(me-=Math.pow(2,8*R)),me},u.prototype.readIntBE=function(T,R,q){T=T>>>0,R=R>>>0,q||Z(T,R,this.length);for(var me=R,_e=1,le=this[T+--me];me>0&&(_e*=256);)le+=this[T+--me]*_e;return _e*=128,le>=_e&&(le-=Math.pow(2,8*R)),le},u.prototype.readInt8=function(T,R){return T=T>>>0,R||Z(T,1,this.length),this[T]&128?(255-this[T]+1)*-1:this[T]},u.prototype.readInt16LE=function(T,R){T=T>>>0,R||Z(T,2,this.length);var q=this[T]|this[T+1]<<8;return q&32768?q|4294901760:q},u.prototype.readInt16BE=function(T,R){T=T>>>0,R||Z(T,2,this.length);var q=this[T+1]|this[T]<<8;return q&32768?q|4294901760:q},u.prototype.readInt32LE=function(T,R){return T=T>>>0,R||Z(T,4,this.length),this[T]|this[T+1]<<8|this[T+2]<<16|this[T+3]<<24},u.prototype.readInt32BE=function(T,R){return T=T>>>0,R||Z(T,4,this.length),this[T]<<24|this[T+1]<<16|this[T+2]<<8|this[T+3]},u.prototype.readFloatLE=function(T,R){return T=T>>>0,R||Z(T,4,this.length),r.read(this,T,!0,23,4)},u.prototype.readFloatBE=function(T,R){return T=T>>>0,R||Z(T,4,this.length),r.read(this,T,!1,23,4)},u.prototype.readDoubleLE=function(T,R){return T=T>>>0,R||Z(T,8,this.length),r.read(this,T,!0,52,8)},u.prototype.readDoubleBE=function(T,R){return T=T>>>0,R||Z(T,8,this.length),r.read(this,T,!1,52,8)};function M(z,T,R,q,me,_e){if(!u.isBuffer(z))throw new TypeError('"buffer" argument must be a Buffer instance');if(T>me||T<_e)throw new RangeError('"value" argument is out of bounds');if(R+q>z.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(T,R,q,me){if(T=+T,R=R>>>0,q=q>>>0,!me){var _e=Math.pow(2,8*q)-1;M(this,T,R,q,_e,0)}var le=1,Ae=0;for(this[R]=T&255;++Ae<q&&(le*=256);)this[R+Ae]=T/le&255;return R+q},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(T,R,q,me){if(T=+T,R=R>>>0,q=q>>>0,!me){var _e=Math.pow(2,8*q)-1;M(this,T,R,q,_e,0)}var le=q-1,Ae=1;for(this[R+le]=T&255;--le>=0&&(Ae*=256);)this[R+le]=T/Ae&255;return R+q},u.prototype.writeUint8=u.prototype.writeUInt8=function(T,R,q){return T=+T,R=R>>>0,q||M(this,T,R,1,255,0),this[R]=T&255,R+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(T,R,q){return T=+T,R=R>>>0,q||M(this,T,R,2,65535,0),this[R]=T&255,this[R+1]=T>>>8,R+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(T,R,q){return T=+T,R=R>>>0,q||M(this,T,R,2,65535,0),this[R]=T>>>8,this[R+1]=T&255,R+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(T,R,q){return T=+T,R=R>>>0,q||M(this,T,R,4,4294967295,0),this[R+3]=T>>>24,this[R+2]=T>>>16,this[R+1]=T>>>8,this[R]=T&255,R+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(T,R,q){return T=+T,R=R>>>0,q||M(this,T,R,4,4294967295,0),this[R]=T>>>24,this[R+1]=T>>>16,this[R+2]=T>>>8,this[R+3]=T&255,R+4},u.prototype.writeIntLE=function(T,R,q,me){if(T=+T,R=R>>>0,!me){var _e=Math.pow(2,8*q-1);M(this,T,R,q,_e-1,-_e)}var le=0,Ae=1,Me=0;for(this[R]=T&255;++le<q&&(Ae*=256);)T<0&&Me===0&&this[R+le-1]!==0&&(Me=1),this[R+le]=(T/Ae>>0)-Me&255;return R+q},u.prototype.writeIntBE=function(T,R,q,me){if(T=+T,R=R>>>0,!me){var _e=Math.pow(2,8*q-1);M(this,T,R,q,_e-1,-_e)}var le=q-1,Ae=1,Me=0;for(this[R+le]=T&255;--le>=0&&(Ae*=256);)T<0&&Me===0&&this[R+le+1]!==0&&(Me=1),this[R+le]=(T/Ae>>0)-Me&255;return R+q},u.prototype.writeInt8=function(T,R,q){return T=+T,R=R>>>0,q||M(this,T,R,1,127,-128),T<0&&(T=255+T+1),this[R]=T&255,R+1},u.prototype.writeInt16LE=function(T,R,q){return T=+T,R=R>>>0,q||M(this,T,R,2,32767,-32768),this[R]=T&255,this[R+1]=T>>>8,R+2},u.prototype.writeInt16BE=function(T,R,q){return T=+T,R=R>>>0,q||M(this,T,R,2,32767,-32768),this[R]=T>>>8,this[R+1]=T&255,R+2},u.prototype.writeInt32LE=function(T,R,q){return T=+T,R=R>>>0,q||M(this,T,R,4,2147483647,-2147483648),this[R]=T&255,this[R+1]=T>>>8,this[R+2]=T>>>16,this[R+3]=T>>>24,R+4},u.prototype.writeInt32BE=function(T,R,q){return T=+T,R=R>>>0,q||M(this,T,R,4,2147483647,-2147483648),T<0&&(T=4294967295+T+1),this[R]=T>>>24,this[R+1]=T>>>16,this[R+2]=T>>>8,this[R+3]=T&255,R+4};function J(z,T,R,q,me,_e){if(R+q>z.length)throw new RangeError("Index out of range");if(R<0)throw new RangeError("Index out of range")}function V(z,T,R,q,me){return T=+T,R=R>>>0,me||J(z,T,R,4),r.write(z,T,R,q,23,4),R+4}u.prototype.writeFloatLE=function(T,R,q){return V(this,T,R,!0,q)},u.prototype.writeFloatBE=function(T,R,q){return V(this,T,R,!1,q)};function X(z,T,R,q,me){return T=+T,R=R>>>0,me||J(z,T,R,8),r.write(z,T,R,q,52,8),R+8}u.prototype.writeDoubleLE=function(T,R,q){return X(this,T,R,!0,q)},u.prototype.writeDoubleBE=function(T,R,q){return X(this,T,R,!1,q)},u.prototype.copy=function(T,R,q,me){if(!u.isBuffer(T))throw new TypeError("argument should be a Buffer");if(q||(q=0),!me&&me!==0&&(me=this.length),R>=T.length&&(R=T.length),R||(R=0),me>0&&me<q&&(me=q),me===q||T.length===0||this.length===0)return 0;if(R<0)throw new RangeError("targetStart out of bounds");if(q<0||q>=this.length)throw new RangeError("Index out of range");if(me<0)throw new RangeError("sourceEnd out of bounds");me>this.length&&(me=this.length),T.length-R<me-q&&(me=T.length-R+q);var _e=me-q;return this===T&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(R,q,me):Uint8Array.prototype.set.call(T,this.subarray(q,me),R),_e},u.prototype.fill=function(T,R,q,me){if(typeof T=="string"){if(typeof R=="string"?(me=R,R=0,q=this.length):typeof q=="string"&&(me=q,q=this.length),me!==void 0&&typeof me!="string")throw new TypeError("encoding must be a string");if(typeof me=="string"&&!u.isEncoding(me))throw new TypeError("Unknown encoding: "+me);if(T.length===1){var _e=T.charCodeAt(0);(me==="utf8"&&_e<128||me==="latin1")&&(T=_e)}}else typeof T=="number"?T=T&255:typeof T=="boolean"&&(T=Number(T));if(R<0||this.length<R||this.length<q)throw new RangeError("Out of range index");if(q<=R)return this;R=R>>>0,q=q===void 0?this.length:q>>>0,T||(T=0);var le;if(typeof T=="number")for(le=R;le<q;++le)this[le]=T;else{var Ae=u.isBuffer(T)?T:u.from(T,me),Me=Ae.length;if(Me===0)throw new TypeError('The value "'+T+'" is invalid for argument "value"');for(le=0;le<q-R;++le)this[le+R]=Ae[le%Me]}return this};var se=/[^+/0-9A-Za-z-_]/g;function P(z){if(z=z.split("=")[0],z=z.trim().replace(se,""),z.length<2)return"";for(;z.length%4!==0;)z=z+"=";return z}function U(z,T){T=T||1/0;for(var R,q=z.length,me=null,_e=[],le=0;le<q;++le){if(R=z.charCodeAt(le),R>55295&&R<57344){if(!me){if(R>56319){(T-=3)>-1&&_e.push(239,191,189);continue}else if(le+1===q){(T-=3)>-1&&_e.push(239,191,189);continue}me=R;continue}if(R<56320){(T-=3)>-1&&_e.push(239,191,189),me=R;continue}R=(me-55296<<10|R-56320)+65536}else me&&(T-=3)>-1&&_e.push(239,191,189);if(me=null,R<128){if((T-=1)<0)break;_e.push(R)}else if(R<2048){if((T-=2)<0)break;_e.push(R>>6|192,R&63|128)}else if(R<65536){if((T-=3)<0)break;_e.push(R>>12|224,R>>6&63|128,R&63|128)}else if(R<1114112){if((T-=4)<0)break;_e.push(R>>18|240,R>>12&63|128,R>>6&63|128,R&63|128)}else throw new Error("Invalid code point")}return _e}function ce(z){for(var T=[],R=0;R<z.length;++R)T.push(z.charCodeAt(R)&255);return T}function ne(z,T){for(var R,q,me,_e=[],le=0;le<z.length&&!((T-=2)<0);++le)R=z.charCodeAt(le),q=R>>8,me=R%256,_e.push(me),_e.push(q);return _e}function ie(z){return t.toByteArray(P(z))}function W(z,T,R,q){for(var me=0;me<q&&!(me+R>=T.length||me>=z.length);++me)T[me+R]=z[me];return me}function G(z,T){return z instanceof T||z!=null&&z.constructor!=null&&z.constructor.name!=null&&z.constructor.name===T.name}function k(z){return z!==z}var de=(function(){for(var z="0123456789abcdef",T=new Array(256),R=0;R<16;++R)for(var q=R*16,me=0;me<16;++me)T[q+me]=z[R]+z[me];return T})()})(dg)),dg}var fg={},hg={},mg,k4;function nj(){return k4||(k4=1,mg=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),s=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(s)!=="[object Symbol]")return!1;var n=42;t[r]=n;for(var o in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var l=Object.getOwnPropertySymbols(t);if(l.length!==1||l[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(t,r);if(u.value!==n||u.enumerable!==!0)return!1}return!0}),mg}var pg,S4;function _v(){if(S4)return pg;S4=1;var e=nj();return pg=function(){return e()&&!!Symbol.toStringTag},pg}var xg,E4;function ij(){return E4||(E4=1,xg=Object),xg}var gg,j4;function Y9(){return j4||(j4=1,gg=Error),gg}var yg,T4;function J9(){return T4||(T4=1,yg=EvalError),yg}var vg,A4;function Z9(){return A4||(A4=1,vg=RangeError),vg}var bg,C4;function Q9(){return C4||(C4=1,bg=ReferenceError),bg}var wg,R4;function oj(){return R4||(R4=1,wg=SyntaxError),wg}var _g,D4;function nf(){return D4||(D4=1,_g=TypeError),_g}var Ng,O4;function eL(){return O4||(O4=1,Ng=URIError),Ng}var kg,F4;function tL(){return F4||(F4=1,kg=Math.abs),kg}var Sg,L4;function rL(){return L4||(L4=1,Sg=Math.floor),Sg}var Eg,I4;function sL(){return I4||(I4=1,Eg=Math.max),Eg}var jg,M4;function aL(){return M4||(M4=1,jg=Math.min),jg}var Tg,B4;function nL(){return B4||(B4=1,Tg=Math.pow),Tg}var Ag,P4;function iL(){return P4||(P4=1,Ag=Math.round),Ag}var Cg,U4;function oL(){return U4||(U4=1,Cg=Number.isNaN||function(t){return t!==t}),Cg}var Rg,z4;function lL(){if(z4)return Rg;z4=1;var e=oL();return Rg=function(r){return e(r)||r===0?r:r<0?-1:1},Rg}var Dg,$4;function cL(){return $4||($4=1,Dg=Object.getOwnPropertyDescriptor),Dg}var Og,q4;function of(){if(q4)return Og;q4=1;var e=cL();if(e)try{e([],"length")}catch{e=null}return Og=e,Og}var Fg,H4;function cm(){if(H4)return Fg;H4=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return Fg=e,Fg}var Lg,W4;function uL(){if(W4)return Lg;W4=1;var e=typeof Symbol<"u"&&Symbol,t=nj();return Lg=function(){return typeof e!="function"||typeof Symbol!="function"||typeof e("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},Lg}var Ig,G4;function lj(){return G4||(G4=1,Ig=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Ig}var Mg,V4;function cj(){if(V4)return Mg;V4=1;var e=ij();return Mg=e.getPrototypeOf||null,Mg}var Bg,K4;function dL(){if(K4)return Bg;K4=1;var e="Function.prototype.bind called on incompatible ",t=Object.prototype.toString,r=Math.max,s="[object Function]",n=function(d,h){for(var m=[],x=0;x<d.length;x+=1)m[x]=d[x];for(var y=0;y<h.length;y+=1)m[y+d.length]=h[y];return m},o=function(d,h){for(var m=[],x=h,y=0;x<d.length;x+=1,y+=1)m[y]=d[x];return m},l=function(u,d){for(var h="",m=0;m<u.length;m+=1)h+=u[m],m+1<u.length&&(h+=d);return h};return Bg=function(d){var h=this;if(typeof h!="function"||t.apply(h)!==s)throw new TypeError(e+h);for(var m=o(arguments,1),x,y=function(){if(this instanceof x){var w=h.apply(this,n(m,arguments));return Object(w)===w?w:this}return h.apply(d,n(m,arguments))},b=r(0,h.length-m.length),v=[],g=0;g<b;g++)v[g]="$"+g;if(x=Function("binder","return function ("+l(v,",")+"){ return binder.apply(this,arguments); }")(y),h.prototype){var _=function(){};_.prototype=h.prototype,x.prototype=new _,_.prototype=null}return x},Bg}var Pg,X4;function lf(){if(X4)return Pg;X4=1;var e=dL();return Pg=Function.prototype.bind||e,Pg}var Ug,Y4;function Nv(){return Y4||(Y4=1,Ug=Function.prototype.call),Ug}var zg,J4;function uj(){return J4||(J4=1,zg=Function.prototype.apply),zg}var $g,Z4;function fL(){return Z4||(Z4=1,$g=typeof Reflect<"u"&&Reflect&&Reflect.apply),$g}var qg,Q4;function hL(){if(Q4)return qg;Q4=1;var e=lf(),t=uj(),r=Nv(),s=fL();return qg=s||e.call(r,t),qg}var Hg,ek;function mL(){if(ek)return Hg;ek=1;var e=lf(),t=nf(),r=Nv(),s=hL();return Hg=function(o){if(o.length<1||typeof o[0]!="function")throw new t("a function is required");return s(e,r,o)},Hg}var Wg,tk;function pL(){if(tk)return Wg;tk=1;var e=mL(),t=of(),r;try{r=[].__proto__===Array.prototype}catch(l){if(!l||typeof l!="object"||!("code"in l)||l.code!=="ERR_PROTO_ACCESS")throw l}var s=!!r&&t&&t(Object.prototype,"__proto__"),n=Object,o=n.getPrototypeOf;return Wg=s&&typeof s.get=="function"?e([s.get]):typeof o=="function"?(function(u){return o(u==null?u:n(u))}):!1,Wg}var Gg,rk;function xL(){if(rk)return Gg;rk=1;var e=lj(),t=cj(),r=pL();return Gg=e?function(n){return e(n)}:t?function(n){if(!n||typeof n!="object"&&typeof n!="function")throw new TypeError("getProto: not an object");return t(n)}:r?function(n){return r(n)}:null,Gg}var Vg,sk;function gL(){if(sk)return Vg;sk=1;var e=Function.prototype.call,t=Object.prototype.hasOwnProperty,r=lf();return Vg=r.call(e,t),Vg}var Kg,ak;function kv(){if(ak)return Kg;ak=1;var e,t=ij(),r=Y9(),s=J9(),n=Z9(),o=Q9(),l=oj(),u=nf(),d=eL(),h=tL(),m=rL(),x=sL(),y=aL(),b=nL(),v=iL(),g=lL(),_=Function,w=function(ce){try{return _('"use strict"; return ('+ce+").constructor;")()}catch{}},S=of(),N=cm(),E=function(){throw new u},C=S?(function(){try{return arguments.callee,E}catch{try{return S(arguments,"callee").get}catch{return E}}})():E,F=uL()(),O=xL(),B=cj(),L=lj(),H=uj(),ue=Nv(),A={},Y=typeof Uint8Array>"u"||!O?e:O(Uint8Array),I={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?e:ArrayBuffer,"%ArrayIteratorPrototype%":F&&O?O([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":A,"%AsyncGenerator%":A,"%AsyncGeneratorFunction%":A,"%AsyncIteratorPrototype%":A,"%Atomics%":typeof Atomics>"u"?e:Atomics,"%BigInt%":typeof BigInt>"u"?e:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?e:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":s,"%Float16Array%":typeof Float16Array>"u"?e:Float16Array,"%Float32Array%":typeof Float32Array>"u"?e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?e:FinalizationRegistry,"%Function%":_,"%GeneratorFunction%":A,"%Int8Array%":typeof Int8Array>"u"?e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":F&&O?O(O([][Symbol.iterator]())):e,"%JSON%":typeof JSON=="object"?JSON:e,"%Map%":typeof Map>"u"?e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!F||!O?e:O(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":S,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?e:Promise,"%Proxy%":typeof Proxy>"u"?e:Proxy,"%RangeError%":n,"%ReferenceError%":o,"%Reflect%":typeof Reflect>"u"?e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!F||!O?e:O(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":F&&O?O(""[Symbol.iterator]()):e,"%Symbol%":F?Symbol:e,"%SyntaxError%":l,"%ThrowTypeError%":C,"%TypedArray%":Y,"%TypeError%":u,"%Uint8Array%":typeof Uint8Array>"u"?e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?e:Uint32Array,"%URIError%":d,"%WeakMap%":typeof WeakMap>"u"?e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?e:WeakSet,"%Function.prototype.call%":ue,"%Function.prototype.apply%":H,"%Object.defineProperty%":N,"%Object.getPrototypeOf%":B,"%Math.abs%":h,"%Math.floor%":m,"%Math.max%":x,"%Math.min%":y,"%Math.pow%":b,"%Math.round%":v,"%Math.sign%":g,"%Reflect.getPrototypeOf%":L};if(O)try{null.error}catch(ce){var ae=O(O(ce));I["%Error.prototype%"]=ae}var Q=function ce(ne){var ie;if(ne==="%AsyncFunction%")ie=w("async function () {}");else if(ne==="%GeneratorFunction%")ie=w("function* () {}");else if(ne==="%AsyncGeneratorFunction%")ie=w("async function* () {}");else if(ne==="%AsyncGenerator%"){var W=ce("%AsyncGeneratorFunction%");W&&(ie=W.prototype)}else if(ne==="%AsyncIteratorPrototype%"){var G=ce("%AsyncGenerator%");G&&O&&(ie=O(G.prototype))}return I[ne]=ie,ie},re={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ve=lf(),te=gL(),ke=ve.call(ue,Array.prototype.concat),Z=ve.call(H,Array.prototype.splice),M=ve.call(ue,String.prototype.replace),J=ve.call(ue,String.prototype.slice),V=ve.call(ue,RegExp.prototype.exec),X=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,se=/\\(\\)?/g,P=function(ne){var ie=J(ne,0,1),W=J(ne,-1);if(ie==="%"&&W!=="%")throw new l("invalid intrinsic syntax, expected closing `%`");if(W==="%"&&ie!=="%")throw new l("invalid intrinsic syntax, expected opening `%`");var G=[];return M(ne,X,function(k,de,z,T){G[G.length]=z?M(T,se,"$1"):de||k}),G},U=function(ne,ie){var W=ne,G;if(te(re,W)&&(G=re[W],W="%"+G[0]+"%"),te(I,W)){var k=I[W];if(k===A&&(k=Q(W)),typeof k>"u"&&!ie)throw new u("intrinsic "+ne+" exists, but is not available. Please file an issue!");return{alias:G,name:W,value:k}}throw new l("intrinsic "+ne+" does not exist!")};return Kg=function(ne,ie){if(typeof ne!="string"||ne.length===0)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof ie!="boolean")throw new u('"allowMissing" argument must be a boolean');if(V(/^%?[^%]*%?$/,ne)===null)throw new l("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var W=P(ne),G=W.length>0?W[0]:"",k=U("%"+G+"%",ie),de=k.name,z=k.value,T=!1,R=k.alias;R&&(G=R[0],Z(W,ke([0,1],R)));for(var q=1,me=!0;q<W.length;q+=1){var _e=W[q],le=J(_e,0,1),Ae=J(_e,-1);if((le==='"'||le==="'"||le==="`"||Ae==='"'||Ae==="'"||Ae==="`")&&le!==Ae)throw new l("property names with quotes must have matching quotes");if((_e==="constructor"||!me)&&(T=!0),G+="."+_e,de="%"+G+"%",te(I,de))z=I[de];else if(z!=null){if(!(_e in z)){if(!ie)throw new u("base intrinsic for "+ne+" exists, but the property is not available.");return}if(S&&q+1>=W.length){var Me=S(z,_e);me=!!Me,me&&"get"in Me&&!("originalValue"in Me.get)?z=Me.get:z=z[_e]}else me=te(z,_e),z=z[_e];me&&!T&&(I[de]=z)}}return z},Kg}var Xg={exports:{}},Yg,nk;function yL(){if(nk)return Yg;nk=1;var e=cm(),t=oj(),r=nf(),s=of();return Yg=function(o,l,u){if(!o||typeof o!="object"&&typeof o!="function")throw new r("`obj` must be an object or a function`");if(typeof l!="string"&&typeof l!="symbol")throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new r("`loose`, if provided, must be a boolean");var d=arguments.length>3?arguments[3]:null,h=arguments.length>4?arguments[4]:null,m=arguments.length>5?arguments[5]:null,x=arguments.length>6?arguments[6]:!1,y=!!s&&s(o,l);if(e)e(o,l,{configurable:m===null&&y?y.configurable:!m,enumerable:d===null&&y?y.enumerable:!d,value:u,writable:h===null&&y?y.writable:!h});else if(x||!d&&!h&&!m)o[l]=u;else throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Yg}var Jg,ik;function vL(){if(ik)return Jg;ik=1;var e=cm(),t=function(){return!!e};return t.hasArrayLengthDefineBug=function(){if(!e)return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},Jg=t,Jg}var Zg,ok;function bL(){if(ok)return Zg;ok=1;var e=kv(),t=yL(),r=vL()(),s=of(),n=nf(),o=e("%Math.floor%");return Zg=function(u,d){if(typeof u!="function")throw new n("`fn` is not a function");if(typeof d!="number"||d<0||d>4294967295||o(d)!==d)throw new n("`length` must be a positive 32-bit integer");var h=arguments.length>2&&!!arguments[2],m=!0,x=!0;if("length"in u&&s){var y=s(u,"length");y&&!y.configurable&&(m=!1),y&&!y.writable&&(x=!1)}return(m||x||!h)&&(r?t(u,"length",d,!0,!0):t(u,"length",d)),u},Zg}var lk;function dj(){return lk||(lk=1,(function(e){var t=lf(),r=kv(),s=bL(),n=nf(),o=r("%Function.prototype.apply%"),l=r("%Function.prototype.call%"),u=r("%Reflect.apply%",!0)||t.call(l,o),d=cm(),h=r("%Math.max%");e.exports=function(y){if(typeof y!="function")throw new n("a function is required");var b=u(t,l,arguments);return s(b,1+h(0,y.length-(arguments.length-1)),!0)};var m=function(){return u(t,o,arguments)};d?d(e.exports,"apply",{value:m}):e.exports.apply=m})(Xg)),Xg.exports}var Qg,ck;function fj(){if(ck)return Qg;ck=1;var e=kv(),t=dj(),r=t(e("String.prototype.indexOf"));return Qg=function(n,o){var l=e(n,!!o);return typeof l=="function"&&r(n,".prototype.")>-1?t(l):l},Qg}var e1,uk;function wL(){if(uk)return e1;uk=1;var e=_v()(),t=fj(),r=t("Object.prototype.toString"),s=function(u){return e&&u&&typeof u=="object"&&Symbol.toStringTag in u?!1:r(u)==="[object Arguments]"},n=function(u){return s(u)?!0:u!==null&&typeof u=="object"&&typeof u.length=="number"&&u.length>=0&&r(u)!=="[object Array]"&&r(u.callee)==="[object Function]"},o=(function(){return s(arguments)})();return s.isLegacyArguments=n,e1=o?s:n,e1}var t1,dk;function _L(){if(dk)return t1;dk=1;var e=Object.prototype.toString,t=Function.prototype.toString,r=/^\s*(?:function)?\*/,s=_v()(),n=Object.getPrototypeOf,o=function(){if(!s)return!1;try{return Function("return function*() {}")()}catch{}},l;return t1=function(d){if(typeof d!="function")return!1;if(r.test(t.call(d)))return!0;if(!s){var h=e.call(d);return h==="[object GeneratorFunction]"}if(!n)return!1;if(typeof l>"u"){var m=o();l=m?n(m):!1}return n(d)===l},t1}var r1,fk;function NL(){if(fk)return r1;fk=1;var e=Function.prototype.toString,t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,s;if(typeof t=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw s}}),s={},t(function(){throw 42},null,r)}catch(S){S!==s&&(t=null)}else t=null;var n=/^\s*class\b/,o=function(N){try{var E=e.call(N);return n.test(E)}catch{return!1}},l=function(N){try{return o(N)?!1:(e.call(N),!0)}catch{return!1}},u=Object.prototype.toString,d="[object Object]",h="[object Function]",m="[object GeneratorFunction]",x="[object HTMLAllCollection]",y="[object HTML document.all class]",b="[object HTMLCollection]",v=typeof Symbol=="function"&&!!Symbol.toStringTag,g=!(0 in[,]),_=function(){return!1};if(typeof document=="object"){var w=document.all;u.call(w)===u.call(document.all)&&(_=function(N){if((g||!N)&&(typeof N>"u"||typeof N=="object"))try{var E=u.call(N);return(E===x||E===y||E===b||E===d)&&N("")==null}catch{}return!1})}return r1=t?function(N){if(_(N))return!0;if(!N||typeof N!="function"&&typeof N!="object")return!1;try{t(N,null,r)}catch(E){if(E!==s)return!1}return!o(N)&&l(N)}:function(N){if(_(N))return!0;if(!N||typeof N!="function"&&typeof N!="object")return!1;if(v)return l(N);if(o(N))return!1;var E=u.call(N);return E!==h&&E!==m&&!/^\[object HTML/.test(E)?!1:l(N)},r1}var s1,hk;function kL(){if(hk)return s1;hk=1;var e=NL(),t=Object.prototype.toString,r=Object.prototype.hasOwnProperty,s=function(d,h,m){for(var x=0,y=d.length;x<y;x++)r.call(d,x)&&(m==null?h(d[x],x,d):h.call(m,d[x],x,d))},n=function(d,h,m){for(var x=0,y=d.length;x<y;x++)m==null?h(d.charAt(x),x,d):h.call(m,d.charAt(x),x,d)},o=function(d,h,m){for(var x in d)r.call(d,x)&&(m==null?h(d[x],x,d):h.call(m,d[x],x,d))},l=function(d,h,m){if(!e(h))throw new TypeError("iterator must be a function");var x;arguments.length>=3&&(x=m),t.call(d)==="[object Array]"?s(d,h,x):typeof d=="string"?n(d,h,x):o(d,h,x)};return s1=l,s1}var a1,mk;function SL(){return mk||(mk=1,a1=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),a1}var n1,pk;function EL(){if(pk)return n1;pk=1;var e=SL(),t=typeof globalThis>"u"?$n:globalThis;return n1=function(){for(var s=[],n=0;n<e.length;n++)typeof t[e[n]]=="function"&&(s[s.length]=e[n]);return s},n1}var i1,xk;function hj(){if(xk)return i1;xk=1;var e=kL(),t=EL(),r=dj(),s=fj(),n=of(),o=s("Object.prototype.toString"),l=_v()(),u=typeof globalThis>"u"?$n:globalThis,d=t(),h=s("String.prototype.slice"),m=Object.getPrototypeOf,x=s("Array.prototype.indexOf",!0)||function(_,w){for(var S=0;S<_.length;S+=1)if(_[S]===w)return S;return-1},y={__proto__:null};l&&n&&m?e(d,function(g){var _=new u[g];if(Symbol.toStringTag in _){var w=m(_),S=n(w,Symbol.toStringTag);if(!S){var N=m(w);S=n(N,Symbol.toStringTag)}y["$"+g]=r(S.get)}}):e(d,function(g){var _=new u[g],w=_.slice||_.set;w&&(y["$"+g]=r(w))});var b=function(_){var w=!1;return e(y,function(S,N){if(!w)try{"$"+S(_)===N&&(w=h(N,1))}catch{}}),w},v=function(_){var w=!1;return e(y,function(S,N){if(!w)try{S(_),w=h(N,1)}catch{}}),w};return i1=function(_){if(!_||typeof _!="object")return!1;if(!l){var w=h(o(_),8,-1);return x(d,w)>-1?w:w!=="Object"?!1:v(_)}return n?b(_):null},i1}var o1,gk;function jL(){if(gk)return o1;gk=1;var e=hj();return o1=function(r){return!!e(r)},o1}var yk;function TL(){return yk||(yk=1,(function(e){var t=wL(),r=_L(),s=hj(),n=jL();function o(q){return q.call.bind(q)}var l=typeof BigInt<"u",u=typeof Symbol<"u",d=o(Object.prototype.toString),h=o(Number.prototype.valueOf),m=o(String.prototype.valueOf),x=o(Boolean.prototype.valueOf);if(l)var y=o(BigInt.prototype.valueOf);if(u)var b=o(Symbol.prototype.valueOf);function v(q,me){if(typeof q!="object")return!1;try{return me(q),!0}catch{return!1}}e.isArgumentsObject=t,e.isGeneratorFunction=r,e.isTypedArray=n;function g(q){return typeof Promise<"u"&&q instanceof Promise||q!==null&&typeof q=="object"&&typeof q.then=="function"&&typeof q.catch=="function"}e.isPromise=g;function _(q){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(q):n(q)||J(q)}e.isArrayBufferView=_;function w(q){return s(q)==="Uint8Array"}e.isUint8Array=w;function S(q){return s(q)==="Uint8ClampedArray"}e.isUint8ClampedArray=S;function N(q){return s(q)==="Uint16Array"}e.isUint16Array=N;function E(q){return s(q)==="Uint32Array"}e.isUint32Array=E;function C(q){return s(q)==="Int8Array"}e.isInt8Array=C;function F(q){return s(q)==="Int16Array"}e.isInt16Array=F;function O(q){return s(q)==="Int32Array"}e.isInt32Array=O;function B(q){return s(q)==="Float32Array"}e.isFloat32Array=B;function L(q){return s(q)==="Float64Array"}e.isFloat64Array=L;function H(q){return s(q)==="BigInt64Array"}e.isBigInt64Array=H;function ue(q){return s(q)==="BigUint64Array"}e.isBigUint64Array=ue;function A(q){return d(q)==="[object Map]"}A.working=typeof Map<"u"&&A(new Map);function Y(q){return typeof Map>"u"?!1:A.working?A(q):q instanceof Map}e.isMap=Y;function I(q){return d(q)==="[object Set]"}I.working=typeof Set<"u"&&I(new Set);function ae(q){return typeof Set>"u"?!1:I.working?I(q):q instanceof Set}e.isSet=ae;function Q(q){return d(q)==="[object WeakMap]"}Q.working=typeof WeakMap<"u"&&Q(new WeakMap);function re(q){return typeof WeakMap>"u"?!1:Q.working?Q(q):q instanceof WeakMap}e.isWeakMap=re;function ve(q){return d(q)==="[object WeakSet]"}ve.working=typeof WeakSet<"u"&&ve(new WeakSet);function te(q){return ve(q)}e.isWeakSet=te;function ke(q){return d(q)==="[object ArrayBuffer]"}ke.working=typeof ArrayBuffer<"u"&&ke(new ArrayBuffer);function Z(q){return typeof ArrayBuffer>"u"?!1:ke.working?ke(q):q instanceof ArrayBuffer}e.isArrayBuffer=Z;function M(q){return d(q)==="[object DataView]"}M.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&M(new DataView(new ArrayBuffer(1),0,1));function J(q){return typeof DataView>"u"?!1:M.working?M(q):q instanceof DataView}e.isDataView=J;var V=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function X(q){return d(q)==="[object SharedArrayBuffer]"}function se(q){return typeof V>"u"?!1:(typeof X.working>"u"&&(X.working=X(new V)),X.working?X(q):q instanceof V)}e.isSharedArrayBuffer=se;function P(q){return d(q)==="[object AsyncFunction]"}e.isAsyncFunction=P;function U(q){return d(q)==="[object Map Iterator]"}e.isMapIterator=U;function ce(q){return d(q)==="[object Set Iterator]"}e.isSetIterator=ce;function ne(q){return d(q)==="[object Generator]"}e.isGeneratorObject=ne;function ie(q){return d(q)==="[object WebAssembly.Module]"}e.isWebAssemblyCompiledModule=ie;function W(q){return v(q,h)}e.isNumberObject=W;function G(q){return v(q,m)}e.isStringObject=G;function k(q){return v(q,x)}e.isBooleanObject=k;function de(q){return l&&v(q,y)}e.isBigIntObject=de;function z(q){return u&&v(q,b)}e.isSymbolObject=z;function T(q){return W(q)||G(q)||k(q)||de(q)||z(q)}e.isBoxedPrimitive=T;function R(q){return typeof Uint8Array<"u"&&(Z(q)||se(q))}e.isAnyArrayBuffer=R,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(q){Object.defineProperty(e,q,{enumerable:!1,value:function(){throw new Error(q+" is not supported in userland")}})})})(hg)),hg}var l1,vk;function AL(){return vk||(vk=1,l1=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}),l1}var bk;function mj(){return bk||(bk=1,(function(e){var t=Object.getOwnPropertyDescriptors||function(J){for(var V=Object.keys(J),X={},se=0;se<V.length;se++)X[V[se]]=Object.getOwnPropertyDescriptor(J,V[se]);return X},r=/%[sdj%]/g;e.format=function(M){if(!C(M)){for(var J=[],V=0;V<arguments.length;V++)J.push(l(arguments[V]));return J.join(" ")}for(var V=1,X=arguments,se=X.length,P=String(M).replace(r,function(ce){if(ce==="%%")return"%";if(V>=se)return ce;switch(ce){case"%s":return String(X[V++]);case"%d":return Number(X[V++]);case"%j":try{return JSON.stringify(X[V++])}catch{return"[Circular]"}default:return ce}}),U=X[V];V<se;U=X[++V])S(U)||!L(U)?P+=" "+U:P+=" "+l(U);return P},e.deprecate=function(M,J){if(typeof sr<"u"&&sr.noDeprecation===!0)return M;if(typeof sr>"u")return function(){return e.deprecate(M,J).apply(this,arguments)};var V=!1;function X(){if(!V){if(sr.throwDeprecation)throw new Error(J);sr.traceDeprecation?console.trace(J):console.error(J),V=!0}return M.apply(this,arguments)}return X};var s={},n=/^$/;if(sr.env.NODE_DEBUG){var o=sr.env.NODE_DEBUG;o=o.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),n=new RegExp("^"+o+"$","i")}e.debuglog=function(M){if(M=M.toUpperCase(),!s[M])if(n.test(M)){var J=sr.pid;s[M]=function(){var V=e.format.apply(e,arguments);console.error("%s %d: %s",M,J,V)}}else s[M]=function(){};return s[M]};function l(M,J){var V={seen:[],stylize:d};return arguments.length>=3&&(V.depth=arguments[2]),arguments.length>=4&&(V.colors=arguments[3]),w(J)?V.showHidden=J:J&&e._extend(V,J),O(V.showHidden)&&(V.showHidden=!1),O(V.depth)&&(V.depth=2),O(V.colors)&&(V.colors=!1),O(V.customInspect)&&(V.customInspect=!0),V.colors&&(V.stylize=u),m(V,M,V.depth)}e.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function u(M,J){var V=l.styles[J];return V?"\x1B["+l.colors[V][0]+"m"+M+"\x1B["+l.colors[V][1]+"m":M}function d(M,J){return M}function h(M){var J={};return M.forEach(function(V,X){J[V]=!0}),J}function m(M,J,V){if(M.customInspect&&J&&A(J.inspect)&&J.inspect!==e.inspect&&!(J.constructor&&J.constructor.prototype===J)){var X=J.inspect(V,M);return C(X)||(X=m(M,X,V)),X}var se=x(M,J);if(se)return se;var P=Object.keys(J),U=h(P);if(M.showHidden&&(P=Object.getOwnPropertyNames(J)),ue(J)&&(P.indexOf("message")>=0||P.indexOf("description")>=0))return y(J);if(P.length===0){if(A(J)){var ce=J.name?": "+J.name:"";return M.stylize("[Function"+ce+"]","special")}if(B(J))return M.stylize(RegExp.prototype.toString.call(J),"regexp");if(H(J))return M.stylize(Date.prototype.toString.call(J),"date");if(ue(J))return y(J)}var ne="",ie=!1,W=["{","}"];if(_(J)&&(ie=!0,W=["[","]"]),A(J)){var G=J.name?": "+J.name:"";ne=" [Function"+G+"]"}if(B(J)&&(ne=" "+RegExp.prototype.toString.call(J)),H(J)&&(ne=" "+Date.prototype.toUTCString.call(J)),ue(J)&&(ne=" "+y(J)),P.length===0&&(!ie||J.length==0))return W[0]+ne+W[1];if(V<0)return B(J)?M.stylize(RegExp.prototype.toString.call(J),"regexp"):M.stylize("[Object]","special");M.seen.push(J);var k;return ie?k=b(M,J,V,U,P):k=P.map(function(de){return v(M,J,V,U,de,ie)}),M.seen.pop(),g(k,ne,W)}function x(M,J){if(O(J))return M.stylize("undefined","undefined");if(C(J)){var V="'"+JSON.stringify(J).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return M.stylize(V,"string")}if(E(J))return M.stylize(""+J,"number");if(w(J))return M.stylize(""+J,"boolean");if(S(J))return M.stylize("null","null")}function y(M){return"["+Error.prototype.toString.call(M)+"]"}function b(M,J,V,X,se){for(var P=[],U=0,ce=J.length;U<ce;++U)ve(J,String(U))?P.push(v(M,J,V,X,String(U),!0)):P.push("");return se.forEach(function(ne){ne.match(/^\d+$/)||P.push(v(M,J,V,X,ne,!0))}),P}function v(M,J,V,X,se,P){var U,ce,ne;if(ne=Object.getOwnPropertyDescriptor(J,se)||{value:J[se]},ne.get?ne.set?ce=M.stylize("[Getter/Setter]","special"):ce=M.stylize("[Getter]","special"):ne.set&&(ce=M.stylize("[Setter]","special")),ve(X,se)||(U="["+se+"]"),ce||(M.seen.indexOf(ne.value)<0?(S(V)?ce=m(M,ne.value,null):ce=m(M,ne.value,V-1),ce.indexOf(`
`)>-1&&(P?ce=ce.split(`
`).map(function(ie){return"  "+ie}).join(`
`).slice(2):ce=`
`+ce.split(`
`).map(function(ie){return"   "+ie}).join(`
`))):ce=M.stylize("[Circular]","special")),O(U)){if(P&&se.match(/^\d+$/))return ce;U=JSON.stringify(""+se),U.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(U=U.slice(1,-1),U=M.stylize(U,"name")):(U=U.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),U=M.stylize(U,"string"))}return U+": "+ce}function g(M,J,V){var X=M.reduce(function(se,P){return P.indexOf(`
`)>=0,se+P.replace(/\u001b\[\d\d?m/g,"").length+1},0);return X>60?V[0]+(J===""?"":J+`
 `)+" "+M.join(`,
  `)+" "+V[1]:V[0]+J+" "+M.join(", ")+" "+V[1]}e.types=TL();function _(M){return Array.isArray(M)}e.isArray=_;function w(M){return typeof M=="boolean"}e.isBoolean=w;function S(M){return M===null}e.isNull=S;function N(M){return M==null}e.isNullOrUndefined=N;function E(M){return typeof M=="number"}e.isNumber=E;function C(M){return typeof M=="string"}e.isString=C;function F(M){return typeof M=="symbol"}e.isSymbol=F;function O(M){return M===void 0}e.isUndefined=O;function B(M){return L(M)&&I(M)==="[object RegExp]"}e.isRegExp=B,e.types.isRegExp=B;function L(M){return typeof M=="object"&&M!==null}e.isObject=L;function H(M){return L(M)&&I(M)==="[object Date]"}e.isDate=H,e.types.isDate=H;function ue(M){return L(M)&&(I(M)==="[object Error]"||M instanceof Error)}e.isError=ue,e.types.isNativeError=ue;function A(M){return typeof M=="function"}e.isFunction=A;function Y(M){return M===null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||typeof M=="symbol"||typeof M>"u"}e.isPrimitive=Y,e.isBuffer=AL();function I(M){return Object.prototype.toString.call(M)}function ae(M){return M<10?"0"+M.toString(10):M.toString(10)}var Q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function re(){var M=new Date,J=[ae(M.getHours()),ae(M.getMinutes()),ae(M.getSeconds())].join(":");return[M.getDate(),Q[M.getMonth()],J].join(" ")}e.log=function(){console.log("%s - %s",re(),e.format.apply(e,arguments))},e.inherits=bo(),e._extend=function(M,J){if(!J||!L(J))return M;for(var V=Object.keys(J),X=V.length;X--;)M[V[X]]=J[V[X]];return M};function ve(M,J){return Object.prototype.hasOwnProperty.call(M,J)}var te=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;e.promisify=function(J){if(typeof J!="function")throw new TypeError('The "original" argument must be of type Function');if(te&&J[te]){var V=J[te];if(typeof V!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(V,te,{value:V,enumerable:!1,writable:!1,configurable:!0}),V}function V(){for(var X,se,P=new Promise(function(ne,ie){X=ne,se=ie}),U=[],ce=0;ce<arguments.length;ce++)U.push(arguments[ce]);U.push(function(ne,ie){ne?se(ne):X(ie)});try{J.apply(this,U)}catch(ne){se(ne)}return P}return Object.setPrototypeOf(V,Object.getPrototypeOf(J)),te&&Object.defineProperty(V,te,{value:V,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(V,t(J))},e.promisify.custom=te;function ke(M,J){if(!M){var V=new Error("Promise was rejected with a falsy value");V.reason=M,M=V}return J(M)}function Z(M){if(typeof M!="function")throw new TypeError('The "original" argument must be of type Function');function J(){for(var V=[],X=0;X<arguments.length;X++)V.push(arguments[X]);var se=V.pop();if(typeof se!="function")throw new TypeError("The last argument must be of type Function");var P=this,U=function(){return se.apply(P,arguments)};M.apply(this,V).then(function(ce){sr.nextTick(U.bind(null,null,ce))},function(ce){sr.nextTick(ke.bind(null,ce,U))})}return Object.setPrototypeOf(J,Object.getPrototypeOf(M)),Object.defineProperties(J,t(M)),J}e.callbackify=Z})(fg)),fg}var c1,wk;function CL(){if(wk)return c1;wk=1;function e(y,b){var v=Object.keys(y);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(y);b&&(g=g.filter(function(_){return Object.getOwnPropertyDescriptor(y,_).enumerable})),v.push.apply(v,g)}return v}function t(y){for(var b=1;b<arguments.length;b++){var v=arguments[b]!=null?arguments[b]:{};b%2?e(Object(v),!0).forEach(function(g){r(y,g,v[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(v)):e(Object(v)).forEach(function(g){Object.defineProperty(y,g,Object.getOwnPropertyDescriptor(v,g))})}return y}function r(y,b,v){return b in y?Object.defineProperty(y,b,{value:v,enumerable:!0,configurable:!0,writable:!0}):y[b]=v,y}function s(y,b){if(!(y instanceof b))throw new TypeError("Cannot call a class as a function")}function n(y,b){for(var v=0;v<b.length;v++){var g=b[v];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(y,g.key,g)}}function o(y,b,v){return b&&n(y.prototype,b),y}var l=lm(),u=l.Buffer,d=mj(),h=d.inspect,m=h&&h.custom||"inspect";function x(y,b,v){u.prototype.copy.call(y,b,v)}return c1=(function(){function y(){s(this,y),this.head=null,this.tail=null,this.length=0}return o(y,[{key:"push",value:function(v){var g={data:v,next:null};this.length>0?this.tail.next=g:this.head=g,this.tail=g,++this.length}},{key:"unshift",value:function(v){var g={data:v,next:this.head};this.length===0&&(this.tail=g),this.head=g,++this.length}},{key:"shift",value:function(){if(this.length!==0){var v=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,v}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(v){if(this.length===0)return"";for(var g=this.head,_=""+g.data;g=g.next;)_+=v+g.data;return _}},{key:"concat",value:function(v){if(this.length===0)return u.alloc(0);for(var g=u.allocUnsafe(v>>>0),_=this.head,w=0;_;)x(_.data,g,w),w+=_.data.length,_=_.next;return g}},{key:"consume",value:function(v,g){var _;return v<this.head.data.length?(_=this.head.data.slice(0,v),this.head.data=this.head.data.slice(v)):v===this.head.data.length?_=this.shift():_=g?this._getString(v):this._getBuffer(v),_}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(v){var g=this.head,_=1,w=g.data;for(v-=w.length;g=g.next;){var S=g.data,N=v>S.length?S.length:v;if(N===S.length?w+=S:w+=S.slice(0,v),v-=N,v===0){N===S.length?(++_,g.next?this.head=g.next:this.head=this.tail=null):(this.head=g,g.data=S.slice(N));break}++_}return this.length-=_,w}},{key:"_getBuffer",value:function(v){var g=u.allocUnsafe(v),_=this.head,w=1;for(_.data.copy(g),v-=_.data.length;_=_.next;){var S=_.data,N=v>S.length?S.length:v;if(S.copy(g,g.length-v,0,N),v-=N,v===0){N===S.length?(++w,_.next?this.head=_.next:this.head=this.tail=null):(this.head=_,_.data=S.slice(N));break}++w}return this.length-=w,g}},{key:m,value:function(v,g){return h(this,t({},g,{depth:0,customInspect:!1}))}}]),y})(),c1}var u1,_k;function pj(){if(_k)return u1;_k=1;function e(l,u){var d=this,h=this._readableState&&this._readableState.destroyed,m=this._writableState&&this._writableState.destroyed;return h||m?(u?u(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,sr.nextTick(n,this,l)):sr.nextTick(n,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(x){!u&&x?d._writableState?d._writableState.errorEmitted?sr.nextTick(r,d):(d._writableState.errorEmitted=!0,sr.nextTick(t,d,x)):sr.nextTick(t,d,x):u?(sr.nextTick(r,d),u(x)):sr.nextTick(r,d)}),this)}function t(l,u){n(l,u),r(l)}function r(l){l._writableState&&!l._writableState.emitClose||l._readableState&&!l._readableState.emitClose||l.emit("close")}function s(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function n(l,u){l.emit("error",u)}function o(l,u){var d=l._readableState,h=l._writableState;d&&d.autoDestroy||h&&h.autoDestroy?l.destroy(u):l.emit("error",u)}return u1={destroy:e,undestroy:s,errorOrDestroy:o},u1}var d1={},Nk;function nu(){if(Nk)return d1;Nk=1;function e(u,d){u.prototype=Object.create(d.prototype),u.prototype.constructor=u,u.__proto__=d}var t={};function r(u,d,h){h||(h=Error);function m(y,b,v){return typeof d=="string"?d:d(y,b,v)}var x=(function(y){e(b,y);function b(v,g,_){return y.call(this,m(v,g,_))||this}return b})(h);x.prototype.name=h.name,x.prototype.code=u,t[u]=x}function s(u,d){if(Array.isArray(u)){var h=u.length;return u=u.map(function(m){return String(m)}),h>2?"one of ".concat(d," ").concat(u.slice(0,h-1).join(", "),", or ")+u[h-1]:h===2?"one of ".concat(d," ").concat(u[0]," or ").concat(u[1]):"of ".concat(d," ").concat(u[0])}else return"of ".concat(d," ").concat(String(u))}function n(u,d,h){return u.substr(0,d.length)===d}function o(u,d,h){return(h===void 0||h>u.length)&&(h=u.length),u.substring(h-d.length,h)===d}function l(u,d,h){return typeof h!="number"&&(h=0),h+d.length>u.length?!1:u.indexOf(d,h)!==-1}return r("ERR_INVALID_OPT_VALUE",function(u,d){return'The value "'+d+'" is invalid for option "'+u+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(u,d,h){var m;typeof d=="string"&&n(d,"not ")?(m="must not be",d=d.replace(/^not /,"")):m="must be";var x;if(o(u," argument"))x="The ".concat(u," ").concat(m," ").concat(s(d,"type"));else{var y=l(u,".")?"property":"argument";x='The "'.concat(u,'" ').concat(y," ").concat(m," ").concat(s(d,"type"))}return x+=". Received type ".concat(typeof h),x},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),d1.codes=t,d1}var f1,kk;function xj(){if(kk)return f1;kk=1;var e=nu().codes.ERR_INVALID_OPT_VALUE;function t(s,n,o){return s.highWaterMark!=null?s.highWaterMark:n?s[o]:null}function r(s,n,o,l){var u=t(n,l,o);if(u!=null){if(!(isFinite(u)&&Math.floor(u)===u)||u<0){var d=l?o:"highWaterMark";throw new e(d,u)}return Math.floor(u)}return s.objectMode?16:16*1024}return f1={getHighWaterMark:r},f1}var h1,Sk;function RL(){if(Sk)return h1;Sk=1,h1=e;function e(r,s){if(t("noDeprecation"))return r;var n=!1;function o(){if(!n){if(t("throwDeprecation"))throw new Error(s);t("traceDeprecation")?console.trace(s):console.warn(s),n=!0}return r.apply(this,arguments)}return o}function t(r){try{if(!$n.localStorage)return!1}catch{return!1}var s=$n.localStorage[r];return s==null?!1:String(s).toLowerCase()==="true"}return h1}var m1,Ek;function gj(){if(Ek)return m1;Ek=1,m1=B;function e(se){var P=this;this.next=null,this.entry=null,this.finish=function(){X(P,se)}}var t;B.WritableState=F;var r={deprecate:RL()},s=aj(),n=lm().Buffer,o=$n.Uint8Array||function(){};function l(se){return n.from(se)}function u(se){return n.isBuffer(se)||se instanceof o}var d=pj(),h=xj(),m=h.getHighWaterMark,x=nu().codes,y=x.ERR_INVALID_ARG_TYPE,b=x.ERR_METHOD_NOT_IMPLEMENTED,v=x.ERR_MULTIPLE_CALLBACK,g=x.ERR_STREAM_CANNOT_PIPE,_=x.ERR_STREAM_DESTROYED,w=x.ERR_STREAM_NULL_VALUES,S=x.ERR_STREAM_WRITE_AFTER_END,N=x.ERR_UNKNOWN_ENCODING,E=d.errorOrDestroy;bo()(B,s);function C(){}function F(se,P,U){t=t||Vc(),se=se||{},typeof U!="boolean"&&(U=P instanceof t),this.objectMode=!!se.objectMode,U&&(this.objectMode=this.objectMode||!!se.writableObjectMode),this.highWaterMark=m(this,se,"writableHighWaterMark",U),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var ce=se.decodeStrings===!1;this.decodeStrings=!ce,this.defaultEncoding=se.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ne){Q(P,ne)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=se.emitClose!==!1,this.autoDestroy=!!se.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}F.prototype.getBuffer=function(){for(var P=this.bufferedRequest,U=[];P;)U.push(P),P=P.next;return U},(function(){try{Object.defineProperty(F.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var O;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(O=Function.prototype[Symbol.hasInstance],Object.defineProperty(B,Symbol.hasInstance,{value:function(P){return O.call(this,P)?!0:this!==B?!1:P&&P._writableState instanceof F}})):O=function(P){return P instanceof this};function B(se){t=t||Vc();var P=this instanceof t;if(!P&&!O.call(B,this))return new B(se);this._writableState=new F(se,this,P),this.writable=!0,se&&(typeof se.write=="function"&&(this._write=se.write),typeof se.writev=="function"&&(this._writev=se.writev),typeof se.destroy=="function"&&(this._destroy=se.destroy),typeof se.final=="function"&&(this._final=se.final)),s.call(this)}B.prototype.pipe=function(){E(this,new g)};function L(se,P){var U=new S;E(se,U),sr.nextTick(P,U)}function H(se,P,U,ce){var ne;return U===null?ne=new w:typeof U!="string"&&!P.objectMode&&(ne=new y("chunk",["string","Buffer"],U)),ne?(E(se,ne),sr.nextTick(ce,ne),!1):!0}B.prototype.write=function(se,P,U){var ce=this._writableState,ne=!1,ie=!ce.objectMode&&u(se);return ie&&!n.isBuffer(se)&&(se=l(se)),typeof P=="function"&&(U=P,P=null),ie?P="buffer":P||(P=ce.defaultEncoding),typeof U!="function"&&(U=C),ce.ending?L(this,U):(ie||H(this,ce,se,U))&&(ce.pendingcb++,ne=A(this,ce,ie,se,P,U)),ne},B.prototype.cork=function(){this._writableState.corked++},B.prototype.uncork=function(){var se=this._writableState;se.corked&&(se.corked--,!se.writing&&!se.corked&&!se.bufferProcessing&&se.bufferedRequest&&te(this,se))},B.prototype.setDefaultEncoding=function(P){if(typeof P=="string"&&(P=P.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((P+"").toLowerCase())>-1))throw new N(P);return this._writableState.defaultEncoding=P,this},Object.defineProperty(B.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ue(se,P,U){return!se.objectMode&&se.decodeStrings!==!1&&typeof P=="string"&&(P=n.from(P,U)),P}Object.defineProperty(B.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function A(se,P,U,ce,ne,ie){if(!U){var W=ue(P,ce,ne);ce!==W&&(U=!0,ne="buffer",ce=W)}var G=P.objectMode?1:ce.length;P.length+=G;var k=P.length<P.highWaterMark;if(k||(P.needDrain=!0),P.writing||P.corked){var de=P.lastBufferedRequest;P.lastBufferedRequest={chunk:ce,encoding:ne,isBuf:U,callback:ie,next:null},de?de.next=P.lastBufferedRequest:P.bufferedRequest=P.lastBufferedRequest,P.bufferedRequestCount+=1}else Y(se,P,!1,G,ce,ne,ie);return k}function Y(se,P,U,ce,ne,ie,W){P.writelen=ce,P.writecb=W,P.writing=!0,P.sync=!0,P.destroyed?P.onwrite(new _("write")):U?se._writev(ne,P.onwrite):se._write(ne,ie,P.onwrite),P.sync=!1}function I(se,P,U,ce,ne){--P.pendingcb,U?(sr.nextTick(ne,ce),sr.nextTick(J,se,P),se._writableState.errorEmitted=!0,E(se,ce)):(ne(ce),se._writableState.errorEmitted=!0,E(se,ce),J(se,P))}function ae(se){se.writing=!1,se.writecb=null,se.length-=se.writelen,se.writelen=0}function Q(se,P){var U=se._writableState,ce=U.sync,ne=U.writecb;if(typeof ne!="function")throw new v;if(ae(U),P)I(se,U,ce,P,ne);else{var ie=ke(U)||se.destroyed;!ie&&!U.corked&&!U.bufferProcessing&&U.bufferedRequest&&te(se,U),ce?sr.nextTick(re,se,U,ie,ne):re(se,U,ie,ne)}}function re(se,P,U,ce){U||ve(se,P),P.pendingcb--,ce(),J(se,P)}function ve(se,P){P.length===0&&P.needDrain&&(P.needDrain=!1,se.emit("drain"))}function te(se,P){P.bufferProcessing=!0;var U=P.bufferedRequest;if(se._writev&&U&&U.next){var ce=P.bufferedRequestCount,ne=new Array(ce),ie=P.corkedRequestsFree;ie.entry=U;for(var W=0,G=!0;U;)ne[W]=U,U.isBuf||(G=!1),U=U.next,W+=1;ne.allBuffers=G,Y(se,P,!0,P.length,ne,"",ie.finish),P.pendingcb++,P.lastBufferedRequest=null,ie.next?(P.corkedRequestsFree=ie.next,ie.next=null):P.corkedRequestsFree=new e(P),P.bufferedRequestCount=0}else{for(;U;){var k=U.chunk,de=U.encoding,z=U.callback,T=P.objectMode?1:k.length;if(Y(se,P,!1,T,k,de,z),U=U.next,P.bufferedRequestCount--,P.writing)break}U===null&&(P.lastBufferedRequest=null)}P.bufferedRequest=U,P.bufferProcessing=!1}B.prototype._write=function(se,P,U){U(new b("_write()"))},B.prototype._writev=null,B.prototype.end=function(se,P,U){var ce=this._writableState;return typeof se=="function"?(U=se,se=null,P=null):typeof P=="function"&&(U=P,P=null),se!=null&&this.write(se,P),ce.corked&&(ce.corked=1,this.uncork()),ce.ending||V(this,ce,U),this},Object.defineProperty(B.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function ke(se){return se.ending&&se.length===0&&se.bufferedRequest===null&&!se.finished&&!se.writing}function Z(se,P){se._final(function(U){P.pendingcb--,U&&E(se,U),P.prefinished=!0,se.emit("prefinish"),J(se,P)})}function M(se,P){!P.prefinished&&!P.finalCalled&&(typeof se._final=="function"&&!P.destroyed?(P.pendingcb++,P.finalCalled=!0,sr.nextTick(Z,se,P)):(P.prefinished=!0,se.emit("prefinish")))}function J(se,P){var U=ke(P);if(U&&(M(se,P),P.pendingcb===0&&(P.finished=!0,se.emit("finish"),P.autoDestroy))){var ce=se._readableState;(!ce||ce.autoDestroy&&ce.endEmitted)&&se.destroy()}return U}function V(se,P,U){P.ending=!0,J(se,P),U&&(P.finished?sr.nextTick(U):se.once("finish",U)),P.ended=!0,se.writable=!1}function X(se,P,U){var ce=se.entry;for(se.entry=null;ce;){var ne=ce.callback;P.pendingcb--,ne(U),ce=ce.next}P.corkedRequestsFree.next=se}return Object.defineProperty(B.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(P){this._writableState&&(this._writableState.destroyed=P)}}),B.prototype.destroy=d.destroy,B.prototype._undestroy=d.undestroy,B.prototype._destroy=function(se,P){P(se)},m1}var p1,jk;function Vc(){if(jk)return p1;jk=1;var e=Object.keys||function(h){var m=[];for(var x in h)m.push(x);return m};p1=l;var t=yj(),r=gj();bo()(l,t);for(var s=e(r.prototype),n=0;n<s.length;n++){var o=s[n];l.prototype[o]||(l.prototype[o]=r.prototype[o])}function l(h){if(!(this instanceof l))return new l(h);t.call(this,h),r.call(this,h),this.allowHalfOpen=!0,h&&(h.readable===!1&&(this.readable=!1),h.writable===!1&&(this.writable=!1),h.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",u)))}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function u(){this._writableState.ended||sr.nextTick(d,this)}function d(h){h.end()}return Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(m){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=m,this._writableState.destroyed=m)}}),p1}var x1={},$h={exports:{}},Tk;function DL(){return Tk||(Tk=1,(function(e,t){var r=lm(),s=r.Buffer;function n(l,u){for(var d in l)u[d]=l[d]}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=r:(n(r,t),t.Buffer=o);function o(l,u,d){return s(l,u,d)}n(s,o),o.from=function(l,u,d){if(typeof l=="number")throw new TypeError("Argument must not be a number");return s(l,u,d)},o.alloc=function(l,u,d){if(typeof l!="number")throw new TypeError("Argument must be a number");var h=s(l);return u!==void 0?typeof d=="string"?h.fill(u,d):h.fill(u):h.fill(0),h},o.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return s(l)},o.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(l)}})($h,$h.exports)),$h.exports}var Ak;function Uy(){if(Ak)return x1;Ak=1;var e=DL().Buffer,t=e.isEncoding||function(w){switch(w=""+w,w&&w.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(w){if(!w)return"utf8";for(var S;;)switch(w){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return w;default:if(S)return;w=(""+w).toLowerCase(),S=!0}}function s(w){var S=r(w);if(typeof S!="string"&&(e.isEncoding===t||!t(w)))throw new Error("Unknown encoding: "+w);return S||w}x1.StringDecoder=n;function n(w){this.encoding=s(w);var S;switch(this.encoding){case"utf16le":this.text=x,this.end=y,S=4;break;case"utf8":this.fillLast=d,S=4;break;case"base64":this.text=b,this.end=v,S=3;break;default:this.write=g,this.end=_;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(S)}n.prototype.write=function(w){if(w.length===0)return"";var S,N;if(this.lastNeed){if(S=this.fillLast(w),S===void 0)return"";N=this.lastNeed,this.lastNeed=0}else N=0;return N<w.length?S?S+this.text(w,N):this.text(w,N):S||""},n.prototype.end=m,n.prototype.text=h,n.prototype.fillLast=function(w){if(this.lastNeed<=w.length)return w.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);w.copy(this.lastChar,this.lastTotal-this.lastNeed,0,w.length),this.lastNeed-=w.length};function o(w){return w<=127?0:w>>5===6?2:w>>4===14?3:w>>3===30?4:w>>6===2?-1:-2}function l(w,S,N){var E=S.length-1;if(E<N)return 0;var C=o(S[E]);return C>=0?(C>0&&(w.lastNeed=C-1),C):--E<N||C===-2?0:(C=o(S[E]),C>=0?(C>0&&(w.lastNeed=C-2),C):--E<N||C===-2?0:(C=o(S[E]),C>=0?(C>0&&(C===2?C=0:w.lastNeed=C-3),C):0))}function u(w,S,N){if((S[0]&192)!==128)return w.lastNeed=0,"";if(w.lastNeed>1&&S.length>1){if((S[1]&192)!==128)return w.lastNeed=1,"";if(w.lastNeed>2&&S.length>2&&(S[2]&192)!==128)return w.lastNeed=2,""}}function d(w){var S=this.lastTotal-this.lastNeed,N=u(this,w);if(N!==void 0)return N;if(this.lastNeed<=w.length)return w.copy(this.lastChar,S,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);w.copy(this.lastChar,S,0,w.length),this.lastNeed-=w.length}function h(w,S){var N=l(this,w,S);if(!this.lastNeed)return w.toString("utf8",S);this.lastTotal=N;var E=w.length-(N-this.lastNeed);return w.copy(this.lastChar,0,E),w.toString("utf8",S,E)}function m(w){var S=w&&w.length?this.write(w):"";return this.lastNeed?S+"":S}function x(w,S){if((w.length-S)%2===0){var N=w.toString("utf16le",S);if(N){var E=N.charCodeAt(N.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=w[w.length-2],this.lastChar[1]=w[w.length-1],N.slice(0,-1)}return N}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=w[w.length-1],w.toString("utf16le",S,w.length-1)}function y(w){var S=w&&w.length?this.write(w):"";if(this.lastNeed){var N=this.lastTotal-this.lastNeed;return S+this.lastChar.toString("utf16le",0,N)}return S}function b(w,S){var N=(w.length-S)%3;return N===0?w.toString("base64",S):(this.lastNeed=3-N,this.lastTotal=3,N===1?this.lastChar[0]=w[w.length-1]:(this.lastChar[0]=w[w.length-2],this.lastChar[1]=w[w.length-1]),w.toString("base64",S,w.length-N))}function v(w){var S=w&&w.length?this.write(w):"";return this.lastNeed?S+this.lastChar.toString("base64",0,3-this.lastNeed):S}function g(w){return w.toString(this.encoding)}function _(w){return w&&w.length?this.write(w):""}return x1}var g1,Ck;function Sv(){if(Ck)return g1;Ck=1;var e=nu().codes.ERR_STREAM_PREMATURE_CLOSE;function t(o){var l=!1;return function(){if(!l){l=!0;for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];o.apply(this,d)}}}function r(){}function s(o){return o.setHeader&&typeof o.abort=="function"}function n(o,l,u){if(typeof l=="function")return n(o,null,l);l||(l={}),u=t(u||r);var d=l.readable||l.readable!==!1&&o.readable,h=l.writable||l.writable!==!1&&o.writable,m=function(){o.writable||y()},x=o._writableState&&o._writableState.finished,y=function(){h=!1,x=!0,d||u.call(o)},b=o._readableState&&o._readableState.endEmitted,v=function(){d=!1,b=!0,h||u.call(o)},g=function(N){u.call(o,N)},_=function(){var N;if(d&&!b)return(!o._readableState||!o._readableState.ended)&&(N=new e),u.call(o,N);if(h&&!x)return(!o._writableState||!o._writableState.ended)&&(N=new e),u.call(o,N)},w=function(){o.req.on("finish",y)};return s(o)?(o.on("complete",y),o.on("abort",_),o.req?w():o.on("request",w)):h&&!o._writableState&&(o.on("end",m),o.on("close",m)),o.on("end",v),o.on("finish",y),l.error!==!1&&o.on("error",g),o.on("close",_),function(){o.removeListener("complete",y),o.removeListener("abort",_),o.removeListener("request",w),o.req&&o.req.removeListener("finish",y),o.removeListener("end",m),o.removeListener("close",m),o.removeListener("finish",y),o.removeListener("end",v),o.removeListener("error",g),o.removeListener("close",_)}}return g1=n,g1}var y1,Rk;function OL(){if(Rk)return y1;Rk=1;var e;function t(w,S,N){return S in w?Object.defineProperty(w,S,{value:N,enumerable:!0,configurable:!0,writable:!0}):w[S]=N,w}var r=Sv(),s=Symbol("lastResolve"),n=Symbol("lastReject"),o=Symbol("error"),l=Symbol("ended"),u=Symbol("lastPromise"),d=Symbol("handlePromise"),h=Symbol("stream");function m(w,S){return{value:w,done:S}}function x(w){var S=w[s];if(S!==null){var N=w[h].read();N!==null&&(w[u]=null,w[s]=null,w[n]=null,S(m(N,!1)))}}function y(w){sr.nextTick(x,w)}function b(w,S){return function(N,E){w.then(function(){if(S[l]){N(m(void 0,!0));return}S[d](N,E)},E)}}var v=Object.getPrototypeOf(function(){}),g=Object.setPrototypeOf((e={get stream(){return this[h]},next:function(){var S=this,N=this[o];if(N!==null)return Promise.reject(N);if(this[l])return Promise.resolve(m(void 0,!0));if(this[h].destroyed)return new Promise(function(O,B){sr.nextTick(function(){S[o]?B(S[o]):O(m(void 0,!0))})});var E=this[u],C;if(E)C=new Promise(b(E,this));else{var F=this[h].read();if(F!==null)return Promise.resolve(m(F,!1));C=new Promise(this[d])}return this[u]=C,C}},t(e,Symbol.asyncIterator,function(){return this}),t(e,"return",function(){var S=this;return new Promise(function(N,E){S[h].destroy(null,function(C){if(C){E(C);return}N(m(void 0,!0))})})}),e),v),_=function(S){var N,E=Object.create(g,(N={},t(N,h,{value:S,writable:!0}),t(N,s,{value:null,writable:!0}),t(N,n,{value:null,writable:!0}),t(N,o,{value:null,writable:!0}),t(N,l,{value:S._readableState.endEmitted,writable:!0}),t(N,d,{value:function(F,O){var B=E[h].read();B?(E[u]=null,E[s]=null,E[n]=null,F(m(B,!1))):(E[s]=F,E[n]=O)},writable:!0}),N));return E[u]=null,r(S,function(C){if(C&&C.code!=="ERR_STREAM_PREMATURE_CLOSE"){var F=E[n];F!==null&&(E[u]=null,E[s]=null,E[n]=null,F(C)),E[o]=C;return}var O=E[s];O!==null&&(E[u]=null,E[s]=null,E[n]=null,O(m(void 0,!0))),E[l]=!0}),S.on("readable",y.bind(null,E)),E};return y1=_,y1}var v1,Dk;function FL(){return Dk||(Dk=1,v1=function(){throw new Error("Readable.from is not available in the browser")}),v1}var b1,Ok;function yj(){if(Ok)return b1;Ok=1,b1=L;var e;L.ReadableState=B,wv().EventEmitter;var t=function(W,G){return W.listeners(G).length},r=aj(),s=lm().Buffer,n=$n.Uint8Array||function(){};function o(ie){return s.from(ie)}function l(ie){return s.isBuffer(ie)||ie instanceof n}var u=mj(),d;u&&u.debuglog?d=u.debuglog("stream"):d=function(){};var h=CL(),m=pj(),x=xj(),y=x.getHighWaterMark,b=nu().codes,v=b.ERR_INVALID_ARG_TYPE,g=b.ERR_STREAM_PUSH_AFTER_EOF,_=b.ERR_METHOD_NOT_IMPLEMENTED,w=b.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,S,N,E;bo()(L,r);var C=m.errorOrDestroy,F=["error","close","destroy","pause","resume"];function O(ie,W,G){if(typeof ie.prependListener=="function")return ie.prependListener(W,G);!ie._events||!ie._events[W]?ie.on(W,G):Array.isArray(ie._events[W])?ie._events[W].unshift(G):ie._events[W]=[G,ie._events[W]]}function B(ie,W,G){e=e||Vc(),ie=ie||{},typeof G!="boolean"&&(G=W instanceof e),this.objectMode=!!ie.objectMode,G&&(this.objectMode=this.objectMode||!!ie.readableObjectMode),this.highWaterMark=y(this,ie,"readableHighWaterMark",G),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=ie.emitClose!==!1,this.autoDestroy=!!ie.autoDestroy,this.destroyed=!1,this.defaultEncoding=ie.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,ie.encoding&&(S||(S=Uy().StringDecoder),this.decoder=new S(ie.encoding),this.encoding=ie.encoding)}function L(ie){if(e=e||Vc(),!(this instanceof L))return new L(ie);var W=this instanceof e;this._readableState=new B(ie,this,W),this.readable=!0,ie&&(typeof ie.read=="function"&&(this._read=ie.read),typeof ie.destroy=="function"&&(this._destroy=ie.destroy)),r.call(this)}Object.defineProperty(L.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(W){this._readableState&&(this._readableState.destroyed=W)}}),L.prototype.destroy=m.destroy,L.prototype._undestroy=m.undestroy,L.prototype._destroy=function(ie,W){W(ie)},L.prototype.push=function(ie,W){var G=this._readableState,k;return G.objectMode?k=!0:typeof ie=="string"&&(W=W||G.defaultEncoding,W!==G.encoding&&(ie=s.from(ie,W),W=""),k=!0),H(this,ie,W,!1,k)},L.prototype.unshift=function(ie){return H(this,ie,null,!0,!1)};function H(ie,W,G,k,de){d("readableAddChunk",W);var z=ie._readableState;if(W===null)z.reading=!1,Q(ie,z);else{var T;if(de||(T=A(z,W)),T)C(ie,T);else if(z.objectMode||W&&W.length>0)if(typeof W!="string"&&!z.objectMode&&Object.getPrototypeOf(W)!==s.prototype&&(W=o(W)),k)z.endEmitted?C(ie,new w):ue(ie,z,W,!0);else if(z.ended)C(ie,new g);else{if(z.destroyed)return!1;z.reading=!1,z.decoder&&!G?(W=z.decoder.write(W),z.objectMode||W.length!==0?ue(ie,z,W,!1):te(ie,z)):ue(ie,z,W,!1)}else k||(z.reading=!1,te(ie,z))}return!z.ended&&(z.length<z.highWaterMark||z.length===0)}function ue(ie,W,G,k){W.flowing&&W.length===0&&!W.sync?(W.awaitDrain=0,ie.emit("data",G)):(W.length+=W.objectMode?1:G.length,k?W.buffer.unshift(G):W.buffer.push(G),W.needReadable&&re(ie)),te(ie,W)}function A(ie,W){var G;return!l(W)&&typeof W!="string"&&W!==void 0&&!ie.objectMode&&(G=new v("chunk",["string","Buffer","Uint8Array"],W)),G}L.prototype.isPaused=function(){return this._readableState.flowing===!1},L.prototype.setEncoding=function(ie){S||(S=Uy().StringDecoder);var W=new S(ie);this._readableState.decoder=W,this._readableState.encoding=this._readableState.decoder.encoding;for(var G=this._readableState.buffer.head,k="";G!==null;)k+=W.write(G.data),G=G.next;return this._readableState.buffer.clear(),k!==""&&this._readableState.buffer.push(k),this._readableState.length=k.length,this};var Y=1073741824;function I(ie){return ie>=Y?ie=Y:(ie--,ie|=ie>>>1,ie|=ie>>>2,ie|=ie>>>4,ie|=ie>>>8,ie|=ie>>>16,ie++),ie}function ae(ie,W){return ie<=0||W.length===0&&W.ended?0:W.objectMode?1:ie!==ie?W.flowing&&W.length?W.buffer.head.data.length:W.length:(ie>W.highWaterMark&&(W.highWaterMark=I(ie)),ie<=W.length?ie:W.ended?W.length:(W.needReadable=!0,0))}L.prototype.read=function(ie){d("read",ie),ie=parseInt(ie,10);var W=this._readableState,G=ie;if(ie!==0&&(W.emittedReadable=!1),ie===0&&W.needReadable&&((W.highWaterMark!==0?W.length>=W.highWaterMark:W.length>0)||W.ended))return d("read: emitReadable",W.length,W.ended),W.length===0&&W.ended?U(this):re(this),null;if(ie=ae(ie,W),ie===0&&W.ended)return W.length===0&&U(this),null;var k=W.needReadable;d("need readable",k),(W.length===0||W.length-ie<W.highWaterMark)&&(k=!0,d("length less than watermark",k)),W.ended||W.reading?(k=!1,d("reading or ended",k)):k&&(d("do read"),W.reading=!0,W.sync=!0,W.length===0&&(W.needReadable=!0),this._read(W.highWaterMark),W.sync=!1,W.reading||(ie=ae(G,W)));var de;return ie>0?de=P(ie,W):de=null,de===null?(W.needReadable=W.length<=W.highWaterMark,ie=0):(W.length-=ie,W.awaitDrain=0),W.length===0&&(W.ended||(W.needReadable=!0),G!==ie&&W.ended&&U(this)),de!==null&&this.emit("data",de),de};function Q(ie,W){if(d("onEofChunk"),!W.ended){if(W.decoder){var G=W.decoder.end();G&&G.length&&(W.buffer.push(G),W.length+=W.objectMode?1:G.length)}W.ended=!0,W.sync?re(ie):(W.needReadable=!1,W.emittedReadable||(W.emittedReadable=!0,ve(ie)))}}function re(ie){var W=ie._readableState;d("emitReadable",W.needReadable,W.emittedReadable),W.needReadable=!1,W.emittedReadable||(d("emitReadable",W.flowing),W.emittedReadable=!0,sr.nextTick(ve,ie))}function ve(ie){var W=ie._readableState;d("emitReadable_",W.destroyed,W.length,W.ended),!W.destroyed&&(W.length||W.ended)&&(ie.emit("readable"),W.emittedReadable=!1),W.needReadable=!W.flowing&&!W.ended&&W.length<=W.highWaterMark,se(ie)}function te(ie,W){W.readingMore||(W.readingMore=!0,sr.nextTick(ke,ie,W))}function ke(ie,W){for(;!W.reading&&!W.ended&&(W.length<W.highWaterMark||W.flowing&&W.length===0);){var G=W.length;if(d("maybeReadMore read 0"),ie.read(0),G===W.length)break}W.readingMore=!1}L.prototype._read=function(ie){C(this,new _("_read()"))},L.prototype.pipe=function(ie,W){var G=this,k=this._readableState;switch(k.pipesCount){case 0:k.pipes=ie;break;case 1:k.pipes=[k.pipes,ie];break;default:k.pipes.push(ie);break}k.pipesCount+=1,d("pipe count=%d opts=%j",k.pipesCount,W);var de=(!W||W.end!==!1)&&ie!==sr.stdout&&ie!==sr.stderr,z=de?R:Ce;k.endEmitted?sr.nextTick(z):G.once("end",z),ie.on("unpipe",T);function T(Je,$e){d("onunpipe"),Je===G&&$e&&$e.hasUnpiped===!1&&($e.hasUnpiped=!0,_e())}function R(){d("onend"),ie.end()}var q=Z(G);ie.on("drain",q);var me=!1;function _e(){d("cleanup"),ie.removeListener("close",Me),ie.removeListener("finish",Ee),ie.removeListener("drain",q),ie.removeListener("error",Ae),ie.removeListener("unpipe",T),G.removeListener("end",R),G.removeListener("end",Ce),G.removeListener("data",le),me=!0,k.awaitDrain&&(!ie._writableState||ie._writableState.needDrain)&&q()}G.on("data",le);function le(Je){d("ondata");var $e=ie.write(Je);d("dest.write",$e),$e===!1&&((k.pipesCount===1&&k.pipes===ie||k.pipesCount>1&&ne(k.pipes,ie)!==-1)&&!me&&(d("false write response, pause",k.awaitDrain),k.awaitDrain++),G.pause())}function Ae(Je){d("onerror",Je),Ce(),ie.removeListener("error",Ae),t(ie,"error")===0&&C(ie,Je)}O(ie,"error",Ae);function Me(){ie.removeListener("finish",Ee),Ce()}ie.once("close",Me);function Ee(){d("onfinish"),ie.removeListener("close",Me),Ce()}ie.once("finish",Ee);function Ce(){d("unpipe"),G.unpipe(ie)}return ie.emit("pipe",G),k.flowing||(d("pipe resume"),G.resume()),ie};function Z(ie){return function(){var G=ie._readableState;d("pipeOnDrain",G.awaitDrain),G.awaitDrain&&G.awaitDrain--,G.awaitDrain===0&&t(ie,"data")&&(G.flowing=!0,se(ie))}}L.prototype.unpipe=function(ie){var W=this._readableState,G={hasUnpiped:!1};if(W.pipesCount===0)return this;if(W.pipesCount===1)return ie&&ie!==W.pipes?this:(ie||(ie=W.pipes),W.pipes=null,W.pipesCount=0,W.flowing=!1,ie&&ie.emit("unpipe",this,G),this);if(!ie){var k=W.pipes,de=W.pipesCount;W.pipes=null,W.pipesCount=0,W.flowing=!1;for(var z=0;z<de;z++)k[z].emit("unpipe",this,{hasUnpiped:!1});return this}var T=ne(W.pipes,ie);return T===-1?this:(W.pipes.splice(T,1),W.pipesCount-=1,W.pipesCount===1&&(W.pipes=W.pipes[0]),ie.emit("unpipe",this,G),this)},L.prototype.on=function(ie,W){var G=r.prototype.on.call(this,ie,W),k=this._readableState;return ie==="data"?(k.readableListening=this.listenerCount("readable")>0,k.flowing!==!1&&this.resume()):ie==="readable"&&!k.endEmitted&&!k.readableListening&&(k.readableListening=k.needReadable=!0,k.flowing=!1,k.emittedReadable=!1,d("on readable",k.length,k.reading),k.length?re(this):k.reading||sr.nextTick(J,this)),G},L.prototype.addListener=L.prototype.on,L.prototype.removeListener=function(ie,W){var G=r.prototype.removeListener.call(this,ie,W);return ie==="readable"&&sr.nextTick(M,this),G},L.prototype.removeAllListeners=function(ie){var W=r.prototype.removeAllListeners.apply(this,arguments);return(ie==="readable"||ie===void 0)&&sr.nextTick(M,this),W};function M(ie){var W=ie._readableState;W.readableListening=ie.listenerCount("readable")>0,W.resumeScheduled&&!W.paused?W.flowing=!0:ie.listenerCount("data")>0&&ie.resume()}function J(ie){d("readable nexttick read 0"),ie.read(0)}L.prototype.resume=function(){var ie=this._readableState;return ie.flowing||(d("resume"),ie.flowing=!ie.readableListening,V(this,ie)),ie.paused=!1,this};function V(ie,W){W.resumeScheduled||(W.resumeScheduled=!0,sr.nextTick(X,ie,W))}function X(ie,W){d("resume",W.reading),W.reading||ie.read(0),W.resumeScheduled=!1,ie.emit("resume"),se(ie),W.flowing&&!W.reading&&ie.read(0)}L.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function se(ie){var W=ie._readableState;for(d("flow",W.flowing);W.flowing&&ie.read()!==null;);}L.prototype.wrap=function(ie){var W=this,G=this._readableState,k=!1;ie.on("end",function(){if(d("wrapped end"),G.decoder&&!G.ended){var T=G.decoder.end();T&&T.length&&W.push(T)}W.push(null)}),ie.on("data",function(T){if(d("wrapped data"),G.decoder&&(T=G.decoder.write(T)),!(G.objectMode&&T==null)&&!(!G.objectMode&&(!T||!T.length))){var R=W.push(T);R||(k=!0,ie.pause())}});for(var de in ie)this[de]===void 0&&typeof ie[de]=="function"&&(this[de]=(function(R){return function(){return ie[R].apply(ie,arguments)}})(de));for(var z=0;z<F.length;z++)ie.on(F[z],this.emit.bind(this,F[z]));return this._read=function(T){d("wrapped _read",T),k&&(k=!1,ie.resume())},this},typeof Symbol=="function"&&(L.prototype[Symbol.asyncIterator]=function(){return N===void 0&&(N=OL()),N(this)}),Object.defineProperty(L.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(L.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(L.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(W){this._readableState&&(this._readableState.flowing=W)}}),L._fromList=P,Object.defineProperty(L.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function P(ie,W){if(W.length===0)return null;var G;return W.objectMode?G=W.buffer.shift():!ie||ie>=W.length?(W.decoder?G=W.buffer.join(""):W.buffer.length===1?G=W.buffer.first():G=W.buffer.concat(W.length),W.buffer.clear()):G=W.buffer.consume(ie,W.decoder),G}function U(ie){var W=ie._readableState;d("endReadable",W.endEmitted),W.endEmitted||(W.ended=!0,sr.nextTick(ce,W,ie))}function ce(ie,W){if(d("endReadableNT",ie.endEmitted,ie.length),!ie.endEmitted&&ie.length===0&&(ie.endEmitted=!0,W.readable=!1,W.emit("end"),ie.autoDestroy)){var G=W._writableState;(!G||G.autoDestroy&&G.finished)&&W.destroy()}}typeof Symbol=="function"&&(L.from=function(ie,W){return E===void 0&&(E=FL()),E(L,ie,W)});function ne(ie,W){for(var G=0,k=ie.length;G<k;G++)if(ie[G]===W)return G;return-1}return b1}var w1,Fk;function vj(){if(Fk)return w1;Fk=1,w1=u;var e=nu().codes,t=e.ERR_METHOD_NOT_IMPLEMENTED,r=e.ERR_MULTIPLE_CALLBACK,s=e.ERR_TRANSFORM_ALREADY_TRANSFORMING,n=e.ERR_TRANSFORM_WITH_LENGTH_0,o=Vc();bo()(u,o);function l(m,x){var y=this._transformState;y.transforming=!1;var b=y.writecb;if(b===null)return this.emit("error",new r);y.writechunk=null,y.writecb=null,x!=null&&this.push(x),b(m);var v=this._readableState;v.reading=!1,(v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}function u(m){if(!(this instanceof u))return new u(m);o.call(this,m),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,m&&(typeof m.transform=="function"&&(this._transform=m.transform),typeof m.flush=="function"&&(this._flush=m.flush)),this.on("prefinish",d)}function d(){var m=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(x,y){h(m,x,y)}):h(this,null,null)}u.prototype.push=function(m,x){return this._transformState.needTransform=!1,o.prototype.push.call(this,m,x)},u.prototype._transform=function(m,x,y){y(new t("_transform()"))},u.prototype._write=function(m,x,y){var b=this._transformState;if(b.writecb=y,b.writechunk=m,b.writeencoding=x,!b.transforming){var v=this._readableState;(b.needTransform||v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}},u.prototype._read=function(m){var x=this._transformState;x.writechunk!==null&&!x.transforming?(x.transforming=!0,this._transform(x.writechunk,x.writeencoding,x.afterTransform)):x.needTransform=!0},u.prototype._destroy=function(m,x){o.prototype._destroy.call(this,m,function(y){x(y)})};function h(m,x,y){if(x)return m.emit("error",x);if(y!=null&&m.push(y),m._writableState.length)throw new n;if(m._transformState.transforming)throw new s;return m.push(null)}return w1}var _1,Lk;function LL(){if(Lk)return _1;Lk=1,_1=t;var e=vj();bo()(t,e);function t(r){if(!(this instanceof t))return new t(r);e.call(this,r)}return t.prototype._transform=function(r,s,n){n(null,r)},_1}var N1,Ik;function IL(){if(Ik)return N1;Ik=1;var e;function t(y){var b=!1;return function(){b||(b=!0,y.apply(void 0,arguments))}}var r=nu().codes,s=r.ERR_MISSING_ARGS,n=r.ERR_STREAM_DESTROYED;function o(y){if(y)throw y}function l(y){return y.setHeader&&typeof y.abort=="function"}function u(y,b,v,g){g=t(g);var _=!1;y.on("close",function(){_=!0}),e===void 0&&(e=Sv()),e(y,{readable:b,writable:v},function(S){if(S)return g(S);_=!0,g()});var w=!1;return function(S){if(!_&&!w){if(w=!0,l(y))return y.abort();if(typeof y.destroy=="function")return y.destroy();g(S||new n("pipe"))}}}function d(y){y()}function h(y,b){return y.pipe(b)}function m(y){return!y.length||typeof y[y.length-1]!="function"?o:y.pop()}function x(){for(var y=arguments.length,b=new Array(y),v=0;v<y;v++)b[v]=arguments[v];var g=m(b);if(Array.isArray(b[0])&&(b=b[0]),b.length<2)throw new s("streams");var _,w=b.map(function(S,N){var E=N<b.length-1,C=N>0;return u(S,E,C,function(F){_||(_=F),F&&w.forEach(d),!E&&(w.forEach(d),g(_))})});return b.reduce(h)}return N1=x,N1}var k1,Mk;function Ev(){if(Mk)return k1;Mk=1,k1=r;var e=wv().EventEmitter,t=bo();t(r,e),r.Readable=yj(),r.Writable=gj(),r.Duplex=Vc(),r.Transform=vj(),r.PassThrough=LL(),r.finished=Sv(),r.pipeline=IL(),r.Stream=r;function r(){e.call(this)}return r.prototype.pipe=function(s,n){var o=this;function l(b){s.writable&&s.write(b)===!1&&o.pause&&o.pause()}o.on("data",l);function u(){o.readable&&o.resume&&o.resume()}s.on("drain",u),!s._isStdio&&(!n||n.end!==!1)&&(o.on("end",h),o.on("close",m));var d=!1;function h(){d||(d=!0,s.end())}function m(){d||(d=!0,typeof s.destroy=="function"&&s.destroy())}function x(b){if(y(),e.listenerCount(this,"error")===0)throw b}o.on("error",x),s.on("error",x);function y(){o.removeListener("data",l),s.removeListener("drain",u),o.removeListener("end",h),o.removeListener("close",m),o.removeListener("error",x),s.removeListener("error",x),o.removeListener("end",y),o.removeListener("close",y),s.removeListener("close",y)}return o.on("end",y),o.on("close",y),s.on("close",y),s.emit("pipe",o),s},k1}var Bk;function ML(){return Bk||(Bk=1,(function(e){(function(t){t.parser=function(P,U){return new s(P,U)},t.SAXParser=s,t.SAXStream=m,t.createStream=h,t.MAX_BUFFER_LENGTH=64*1024;var r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function s(P,U){if(!(this instanceof s))return new s(P,U);var ce=this;o(ce),ce.q=ce.c="",ce.bufferCheckPosition=t.MAX_BUFFER_LENGTH,ce.opt=U||{},ce.opt.lowercase=ce.opt.lowercase||ce.opt.lowercasetags,ce.looseCase=ce.opt.lowercase?"toLowerCase":"toUpperCase",ce.tags=[],ce.closed=ce.closedRoot=ce.sawRoot=!1,ce.tag=ce.error=null,ce.strict=!!P,ce.noscript=!!(P||ce.opt.noscript),ce.state=L.BEGIN,ce.strictEntities=ce.opt.strictEntities,ce.ENTITIES=ce.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),ce.attribList=[],ce.opt.xmlns&&(ce.ns=Object.create(g)),ce.trackPosition=ce.opt.position!==!1,ce.trackPosition&&(ce.position=ce.line=ce.column=0),ue(ce,"onready")}Object.create||(Object.create=function(P){function U(){}U.prototype=P;var ce=new U;return ce}),Object.keys||(Object.keys=function(P){var U=[];for(var ce in P)P.hasOwnProperty(ce)&&U.push(ce);return U});function n(P){for(var U=Math.max(t.MAX_BUFFER_LENGTH,10),ce=0,ne=0,ie=r.length;ne<ie;ne++){var W=P[r[ne]].length;if(W>U)switch(r[ne]){case"textNode":Y(P);break;case"cdata":A(P,"oncdata",P.cdata),P.cdata="";break;case"script":A(P,"onscript",P.script),P.script="";break;default:ae(P,"Max buffer length exceeded: "+r[ne])}ce=Math.max(ce,W)}var G=t.MAX_BUFFER_LENGTH-ce;P.bufferCheckPosition=G+P.position}function o(P){for(var U=0,ce=r.length;U<ce;U++)P[r[U]]=""}function l(P){Y(P),P.cdata!==""&&(A(P,"oncdata",P.cdata),P.cdata=""),P.script!==""&&(A(P,"onscript",P.script),P.script="")}s.prototype={end:function(){Q(this)},write:se,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){l(this)}};var u;try{u=Ev().Stream}catch{u=function(){}}var d=t.EVENTS.filter(function(P){return P!=="error"&&P!=="end"});function h(P,U){return new m(P,U)}function m(P,U){if(!(this instanceof m))return new m(P,U);u.apply(this),this._parser=new s(P,U),this.writable=!0,this.readable=!0;var ce=this;this._parser.onend=function(){ce.emit("end")},this._parser.onerror=function(ne){ce.emit("error",ne),ce._parser.error=null},this._decoder=null,d.forEach(function(ne){Object.defineProperty(ce,"on"+ne,{get:function(){return ce._parser["on"+ne]},set:function(ie){if(!ie)return ce.removeAllListeners(ne),ce._parser["on"+ne]=ie,ie;ce.on(ne,ie)},enumerable:!0,configurable:!1})})}m.prototype=Object.create(u.prototype,{constructor:{value:m}}),m.prototype.write=function(P){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(P)){if(!this._decoder){var U=Uy().StringDecoder;this._decoder=new U("utf8")}P=this._decoder.write(P)}return this._parser.write(P.toString()),this.emit("data",P),!0},m.prototype.end=function(P){return P&&P.length&&this.write(P),this._parser.end(),!0},m.prototype.on=function(P,U){var ce=this;return!ce._parser["on"+P]&&d.indexOf(P)!==-1&&(ce._parser["on"+P]=function(){var ne=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);ne.splice(0,0,P),ce.emit.apply(ce,ne)}),u.prototype.on.call(ce,P,U)};var x="[CDATA[",y="DOCTYPE",b="http://www.w3.org/XML/1998/namespace",v="http://www.w3.org/2000/xmlns/",g={xml:b,xmlns:v},_=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,w=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,S=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,N=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function E(P){return P===" "||P===`
`||P==="\r"||P==="	"}function C(P){return P==='"'||P==="'"}function F(P){return P===">"||E(P)}function O(P,U){return P.test(U)}function B(P,U){return!O(P,U)}var L=0;t.STATE={BEGIN:L++,BEGIN_WHITESPACE:L++,TEXT:L++,TEXT_ENTITY:L++,OPEN_WAKA:L++,SGML_DECL:L++,SGML_DECL_QUOTED:L++,DOCTYPE:L++,DOCTYPE_QUOTED:L++,DOCTYPE_DTD:L++,DOCTYPE_DTD_QUOTED:L++,COMMENT_STARTING:L++,COMMENT:L++,COMMENT_ENDING:L++,COMMENT_ENDED:L++,CDATA:L++,CDATA_ENDING:L++,CDATA_ENDING_2:L++,PROC_INST:L++,PROC_INST_BODY:L++,PROC_INST_ENDING:L++,OPEN_TAG:L++,OPEN_TAG_SLASH:L++,ATTRIB:L++,ATTRIB_NAME:L++,ATTRIB_NAME_SAW_WHITE:L++,ATTRIB_VALUE:L++,ATTRIB_VALUE_QUOTED:L++,ATTRIB_VALUE_CLOSED:L++,ATTRIB_VALUE_UNQUOTED:L++,ATTRIB_VALUE_ENTITY_Q:L++,ATTRIB_VALUE_ENTITY_U:L++,CLOSE_TAG:L++,CLOSE_TAG_SAW_WHITE:L++,SCRIPT:L++,SCRIPT_ENDING:L++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(P){var U=t.ENTITIES[P],ce=typeof U=="number"?String.fromCharCode(U):U;t.ENTITIES[P]=ce});for(var H in t.STATE)t.STATE[t.STATE[H]]=H;L=t.STATE;function ue(P,U,ce){P[U]&&P[U](ce)}function A(P,U,ce){P.textNode&&Y(P),ue(P,U,ce)}function Y(P){P.textNode=I(P.opt,P.textNode),P.textNode&&ue(P,"ontext",P.textNode),P.textNode=""}function I(P,U){return P.trim&&(U=U.trim()),P.normalize&&(U=U.replace(/\s+/g," ")),U}function ae(P,U){return Y(P),P.trackPosition&&(U+=`
Line: `+P.line+`
Column: `+P.column+`
Char: `+P.c),U=new Error(U),P.error=U,ue(P,"onerror",U),P}function Q(P){return P.sawRoot&&!P.closedRoot&&re(P,"Unclosed root tag"),P.state!==L.BEGIN&&P.state!==L.BEGIN_WHITESPACE&&P.state!==L.TEXT&&ae(P,"Unexpected end"),Y(P),P.c="",P.closed=!0,ue(P,"onend"),s.call(P,P.strict,P.opt),P}function re(P,U){if(typeof P!="object"||!(P instanceof s))throw new Error("bad call to strictFail");P.strict&&ae(P,U)}function ve(P){P.strict||(P.tagName=P.tagName[P.looseCase]());var U=P.tags[P.tags.length-1]||P,ce=P.tag={name:P.tagName,attributes:{}};P.opt.xmlns&&(ce.ns=U.ns),P.attribList.length=0,A(P,"onopentagstart",ce)}function te(P,U){var ce=P.indexOf(":"),ne=ce<0?["",P]:P.split(":"),ie=ne[0],W=ne[1];return U&&P==="xmlns"&&(ie="xmlns",W=""),{prefix:ie,local:W}}function ke(P){if(P.strict||(P.attribName=P.attribName[P.looseCase]()),P.attribList.indexOf(P.attribName)!==-1||P.tag.attributes.hasOwnProperty(P.attribName)){P.attribName=P.attribValue="";return}if(P.opt.xmlns){var U=te(P.attribName,!0),ce=U.prefix,ne=U.local;if(ce==="xmlns")if(ne==="xml"&&P.attribValue!==b)re(P,"xml: prefix must be bound to "+b+`
Actual: `+P.attribValue);else if(ne==="xmlns"&&P.attribValue!==v)re(P,"xmlns: prefix must be bound to "+v+`
Actual: `+P.attribValue);else{var ie=P.tag,W=P.tags[P.tags.length-1]||P;ie.ns===W.ns&&(ie.ns=Object.create(W.ns)),ie.ns[ne]=P.attribValue}P.attribList.push([P.attribName,P.attribValue])}else P.tag.attributes[P.attribName]=P.attribValue,A(P,"onattribute",{name:P.attribName,value:P.attribValue});P.attribName=P.attribValue=""}function Z(P,U){if(P.opt.xmlns){var ce=P.tag,ne=te(P.tagName);ce.prefix=ne.prefix,ce.local=ne.local,ce.uri=ce.ns[ne.prefix]||"",ce.prefix&&!ce.uri&&(re(P,"Unbound namespace prefix: "+JSON.stringify(P.tagName)),ce.uri=ne.prefix);var ie=P.tags[P.tags.length-1]||P;ce.ns&&ie.ns!==ce.ns&&Object.keys(ce.ns).forEach(function(le){A(P,"onopennamespace",{prefix:le,uri:ce.ns[le]})});for(var W=0,G=P.attribList.length;W<G;W++){var k=P.attribList[W],de=k[0],z=k[1],T=te(de,!0),R=T.prefix,q=T.local,me=R===""?"":ce.ns[R]||"",_e={name:de,value:z,prefix:R,local:q,uri:me};R&&R!=="xmlns"&&!me&&(re(P,"Unbound namespace prefix: "+JSON.stringify(R)),_e.uri=R),P.tag.attributes[de]=_e,A(P,"onattribute",_e)}P.attribList.length=0}P.tag.isSelfClosing=!!U,P.sawRoot=!0,P.tags.push(P.tag),A(P,"onopentag",P.tag),U||(!P.noscript&&P.tagName.toLowerCase()==="script"?P.state=L.SCRIPT:P.state=L.TEXT,P.tag=null,P.tagName=""),P.attribName=P.attribValue="",P.attribList.length=0}function M(P){if(!P.tagName){re(P,"Weird empty close tag."),P.textNode+="</>",P.state=L.TEXT;return}if(P.script){if(P.tagName!=="script"){P.script+="</"+P.tagName+">",P.tagName="",P.state=L.SCRIPT;return}A(P,"onscript",P.script),P.script=""}var U=P.tags.length,ce=P.tagName;P.strict||(ce=ce[P.looseCase]());for(var ne=ce;U--;){var ie=P.tags[U];if(ie.name!==ne)re(P,"Unexpected close tag");else break}if(U<0){re(P,"Unmatched closing tag: "+P.tagName),P.textNode+="</"+P.tagName+">",P.state=L.TEXT;return}P.tagName=ce;for(var W=P.tags.length;W-- >U;){var G=P.tag=P.tags.pop();P.tagName=P.tag.name,A(P,"onclosetag",P.tagName);var k={};for(var de in G.ns)k[de]=G.ns[de];var z=P.tags[P.tags.length-1]||P;P.opt.xmlns&&G.ns!==z.ns&&Object.keys(G.ns).forEach(function(T){var R=G.ns[T];A(P,"onclosenamespace",{prefix:T,uri:R})})}U===0&&(P.closedRoot=!0),P.tagName=P.attribValue=P.attribName="",P.attribList.length=0,P.state=L.TEXT}function J(P){var U=P.entity,ce=U.toLowerCase(),ne,ie="";return P.ENTITIES[U]?P.ENTITIES[U]:P.ENTITIES[ce]?P.ENTITIES[ce]:(U=ce,U.charAt(0)==="#"&&(U.charAt(1)==="x"?(U=U.slice(2),ne=parseInt(U,16),ie=ne.toString(16)):(U=U.slice(1),ne=parseInt(U,10),ie=ne.toString(10))),U=U.replace(/^0+/,""),isNaN(ne)||ie.toLowerCase()!==U?(re(P,"Invalid character entity"),"&"+P.entity+";"):String.fromCodePoint(ne))}function V(P,U){U==="<"?(P.state=L.OPEN_WAKA,P.startTagPosition=P.position):E(U)||(re(P,"Non-whitespace before first tag."),P.textNode=U,P.state=L.TEXT)}function X(P,U){var ce="";return U<P.length&&(ce=P.charAt(U)),ce}function se(P){var U=this;if(this.error)throw this.error;if(U.closed)return ae(U,"Cannot write after close. Assign an onready handler.");if(P===null)return Q(U);typeof P=="object"&&(P=P.toString());for(var ce=0,ne="";ne=X(P,ce++),U.c=ne,!!ne;)switch(U.trackPosition&&(U.position++,ne===`
`?(U.line++,U.column=0):U.column++),U.state){case L.BEGIN:if(U.state=L.BEGIN_WHITESPACE,ne==="\uFEFF")continue;V(U,ne);continue;case L.BEGIN_WHITESPACE:V(U,ne);continue;case L.TEXT:if(U.sawRoot&&!U.closedRoot){for(var ie=ce-1;ne&&ne!=="<"&&ne!=="&";)ne=X(P,ce++),ne&&U.trackPosition&&(U.position++,ne===`
`?(U.line++,U.column=0):U.column++);U.textNode+=P.substring(ie,ce-1)}ne==="<"&&!(U.sawRoot&&U.closedRoot&&!U.strict)?(U.state=L.OPEN_WAKA,U.startTagPosition=U.position):(!E(ne)&&(!U.sawRoot||U.closedRoot)&&re(U,"Text data outside of root node."),ne==="&"?U.state=L.TEXT_ENTITY:U.textNode+=ne);continue;case L.SCRIPT:ne==="<"?U.state=L.SCRIPT_ENDING:U.script+=ne;continue;case L.SCRIPT_ENDING:ne==="/"?U.state=L.CLOSE_TAG:(U.script+="<"+ne,U.state=L.SCRIPT);continue;case L.OPEN_WAKA:if(ne==="!")U.state=L.SGML_DECL,U.sgmlDecl="";else if(!E(ne))if(O(_,ne))U.state=L.OPEN_TAG,U.tagName=ne;else if(ne==="/")U.state=L.CLOSE_TAG,U.tagName="";else if(ne==="?")U.state=L.PROC_INST,U.procInstName=U.procInstBody="";else{if(re(U,"Unencoded <"),U.startTagPosition+1<U.position){var W=U.position-U.startTagPosition;ne=new Array(W).join(" ")+ne}U.textNode+="<"+ne,U.state=L.TEXT}continue;case L.SGML_DECL:(U.sgmlDecl+ne).toUpperCase()===x?(A(U,"onopencdata"),U.state=L.CDATA,U.sgmlDecl="",U.cdata=""):U.sgmlDecl+ne==="--"?(U.state=L.COMMENT,U.comment="",U.sgmlDecl=""):(U.sgmlDecl+ne).toUpperCase()===y?(U.state=L.DOCTYPE,(U.doctype||U.sawRoot)&&re(U,"Inappropriately located doctype declaration"),U.doctype="",U.sgmlDecl=""):ne===">"?(A(U,"onsgmldeclaration",U.sgmlDecl),U.sgmlDecl="",U.state=L.TEXT):(C(ne)&&(U.state=L.SGML_DECL_QUOTED),U.sgmlDecl+=ne);continue;case L.SGML_DECL_QUOTED:ne===U.q&&(U.state=L.SGML_DECL,U.q=""),U.sgmlDecl+=ne;continue;case L.DOCTYPE:ne===">"?(U.state=L.TEXT,A(U,"ondoctype",U.doctype),U.doctype=!0):(U.doctype+=ne,ne==="["?U.state=L.DOCTYPE_DTD:C(ne)&&(U.state=L.DOCTYPE_QUOTED,U.q=ne));continue;case L.DOCTYPE_QUOTED:U.doctype+=ne,ne===U.q&&(U.q="",U.state=L.DOCTYPE);continue;case L.DOCTYPE_DTD:U.doctype+=ne,ne==="]"?U.state=L.DOCTYPE:C(ne)&&(U.state=L.DOCTYPE_DTD_QUOTED,U.q=ne);continue;case L.DOCTYPE_DTD_QUOTED:U.doctype+=ne,ne===U.q&&(U.state=L.DOCTYPE_DTD,U.q="");continue;case L.COMMENT:ne==="-"?U.state=L.COMMENT_ENDING:U.comment+=ne;continue;case L.COMMENT_ENDING:ne==="-"?(U.state=L.COMMENT_ENDED,U.comment=I(U.opt,U.comment),U.comment&&A(U,"oncomment",U.comment),U.comment=""):(U.comment+="-"+ne,U.state=L.COMMENT);continue;case L.COMMENT_ENDED:ne!==">"?(re(U,"Malformed comment"),U.comment+="--"+ne,U.state=L.COMMENT):U.state=L.TEXT;continue;case L.CDATA:ne==="]"?U.state=L.CDATA_ENDING:U.cdata+=ne;continue;case L.CDATA_ENDING:ne==="]"?U.state=L.CDATA_ENDING_2:(U.cdata+="]"+ne,U.state=L.CDATA);continue;case L.CDATA_ENDING_2:ne===">"?(U.cdata&&A(U,"oncdata",U.cdata),A(U,"onclosecdata"),U.cdata="",U.state=L.TEXT):ne==="]"?U.cdata+="]":(U.cdata+="]]"+ne,U.state=L.CDATA);continue;case L.PROC_INST:ne==="?"?U.state=L.PROC_INST_ENDING:E(ne)?U.state=L.PROC_INST_BODY:U.procInstName+=ne;continue;case L.PROC_INST_BODY:if(!U.procInstBody&&E(ne))continue;ne==="?"?U.state=L.PROC_INST_ENDING:U.procInstBody+=ne;continue;case L.PROC_INST_ENDING:ne===">"?(A(U,"onprocessinginstruction",{name:U.procInstName,body:U.procInstBody}),U.procInstName=U.procInstBody="",U.state=L.TEXT):(U.procInstBody+="?"+ne,U.state=L.PROC_INST_BODY);continue;case L.OPEN_TAG:O(w,ne)?U.tagName+=ne:(ve(U),ne===">"?Z(U):ne==="/"?U.state=L.OPEN_TAG_SLASH:(E(ne)||re(U,"Invalid character in tag name"),U.state=L.ATTRIB));continue;case L.OPEN_TAG_SLASH:ne===">"?(Z(U,!0),M(U)):(re(U,"Forward-slash in opening tag not followed by >"),U.state=L.ATTRIB);continue;case L.ATTRIB:if(E(ne))continue;ne===">"?Z(U):ne==="/"?U.state=L.OPEN_TAG_SLASH:O(_,ne)?(U.attribName=ne,U.attribValue="",U.state=L.ATTRIB_NAME):re(U,"Invalid attribute name");continue;case L.ATTRIB_NAME:ne==="="?U.state=L.ATTRIB_VALUE:ne===">"?(re(U,"Attribute without value"),U.attribValue=U.attribName,ke(U),Z(U)):E(ne)?U.state=L.ATTRIB_NAME_SAW_WHITE:O(w,ne)?U.attribName+=ne:re(U,"Invalid attribute name");continue;case L.ATTRIB_NAME_SAW_WHITE:if(ne==="=")U.state=L.ATTRIB_VALUE;else{if(E(ne))continue;re(U,"Attribute without value"),U.tag.attributes[U.attribName]="",U.attribValue="",A(U,"onattribute",{name:U.attribName,value:""}),U.attribName="",ne===">"?Z(U):O(_,ne)?(U.attribName=ne,U.state=L.ATTRIB_NAME):(re(U,"Invalid attribute name"),U.state=L.ATTRIB)}continue;case L.ATTRIB_VALUE:if(E(ne))continue;C(ne)?(U.q=ne,U.state=L.ATTRIB_VALUE_QUOTED):(re(U,"Unquoted attribute value"),U.state=L.ATTRIB_VALUE_UNQUOTED,U.attribValue=ne);continue;case L.ATTRIB_VALUE_QUOTED:if(ne!==U.q){ne==="&"?U.state=L.ATTRIB_VALUE_ENTITY_Q:U.attribValue+=ne;continue}ke(U),U.q="",U.state=L.ATTRIB_VALUE_CLOSED;continue;case L.ATTRIB_VALUE_CLOSED:E(ne)?U.state=L.ATTRIB:ne===">"?Z(U):ne==="/"?U.state=L.OPEN_TAG_SLASH:O(_,ne)?(re(U,"No whitespace between attributes"),U.attribName=ne,U.attribValue="",U.state=L.ATTRIB_NAME):re(U,"Invalid attribute name");continue;case L.ATTRIB_VALUE_UNQUOTED:if(!F(ne)){ne==="&"?U.state=L.ATTRIB_VALUE_ENTITY_U:U.attribValue+=ne;continue}ke(U),ne===">"?Z(U):U.state=L.ATTRIB;continue;case L.CLOSE_TAG:if(U.tagName)ne===">"?M(U):O(w,ne)?U.tagName+=ne:U.script?(U.script+="</"+U.tagName,U.tagName="",U.state=L.SCRIPT):(E(ne)||re(U,"Invalid tagname in closing tag"),U.state=L.CLOSE_TAG_SAW_WHITE);else{if(E(ne))continue;B(_,ne)?U.script?(U.script+="</"+ne,U.state=L.SCRIPT):re(U,"Invalid tagname in closing tag."):U.tagName=ne}continue;case L.CLOSE_TAG_SAW_WHITE:if(E(ne))continue;ne===">"?M(U):re(U,"Invalid characters in closing tag");continue;case L.TEXT_ENTITY:case L.ATTRIB_VALUE_ENTITY_Q:case L.ATTRIB_VALUE_ENTITY_U:var G,k;switch(U.state){case L.TEXT_ENTITY:G=L.TEXT,k="textNode";break;case L.ATTRIB_VALUE_ENTITY_Q:G=L.ATTRIB_VALUE_QUOTED,k="attribValue";break;case L.ATTRIB_VALUE_ENTITY_U:G=L.ATTRIB_VALUE_UNQUOTED,k="attribValue";break}ne===";"?(U[k]+=J(U),U.entity="",U.state=G):O(U.entity.length?N:S,ne)?U.entity+=ne:(re(U,"Invalid character in entity name"),U[k]+="&"+U.entity+ne,U.entity="",U.state=G);continue;default:throw new Error(U,"Unknown state: "+U.state)}return U.position>=U.bufferCheckPosition&&n(U),U}String.fromCodePoint||(function(){var P=String.fromCharCode,U=Math.floor,ce=function(){var ne=16384,ie=[],W,G,k=-1,de=arguments.length;if(!de)return"";for(var z="";++k<de;){var T=Number(arguments[k]);if(!isFinite(T)||T<0||T>1114111||U(T)!==T)throw RangeError("Invalid code point: "+T);T<=65535?ie.push(T):(T-=65536,W=(T>>10)+55296,G=T%1024+56320,ie.push(W,G)),(k+1===de||ie.length>ne)&&(z+=P.apply(null,ie),ie.length=0)}return z};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:ce,configurable:!0,writable:!0}):String.fromCodePoint=ce})()})(e)})(cg)),cg}var S1,Pk;function jv(){return Pk||(Pk=1,S1={isArray:function(e){return Array.isArray?Array.isArray(e):Object.prototype.toString.call(e)==="[object Array]"}}),S1}var E1,Uk;function Tv(){if(Uk)return E1;Uk=1;var e=jv().isArray;return E1={copyOptions:function(t){var r,s={};for(r in t)t.hasOwnProperty(r)&&(s[r]=t[r]);return s},ensureFlagExists:function(t,r){(!(t in r)||typeof r[t]!="boolean")&&(r[t]=!1)},ensureSpacesExists:function(t){(!("spaces"in t)||typeof t.spaces!="number"&&typeof t.spaces!="string")&&(t.spaces=0)},ensureAlwaysArrayExists:function(t){(!("alwaysArray"in t)||typeof t.alwaysArray!="boolean"&&!e(t.alwaysArray))&&(t.alwaysArray=!1)},ensureKeyExists:function(t,r){(!(t+"Key"in r)||typeof r[t+"Key"]!="string")&&(r[t+"Key"]=r.compact?"_"+t:t)},checkFnExists:function(t,r){return t+"Fn"in r}},E1}var j1,zk;function bj(){if(zk)return j1;zk=1;var e=ML(),t=Tv(),r=jv().isArray,s,n;function o(w){return s=t.copyOptions(w),t.ensureFlagExists("ignoreDeclaration",s),t.ensureFlagExists("ignoreInstruction",s),t.ensureFlagExists("ignoreAttributes",s),t.ensureFlagExists("ignoreText",s),t.ensureFlagExists("ignoreComment",s),t.ensureFlagExists("ignoreCdata",s),t.ensureFlagExists("ignoreDoctype",s),t.ensureFlagExists("compact",s),t.ensureFlagExists("alwaysChildren",s),t.ensureFlagExists("addParent",s),t.ensureFlagExists("trim",s),t.ensureFlagExists("nativeType",s),t.ensureFlagExists("nativeTypeAttributes",s),t.ensureFlagExists("sanitize",s),t.ensureFlagExists("instructionHasAttributes",s),t.ensureFlagExists("captureSpacesBetweenElements",s),t.ensureAlwaysArrayExists(s),t.ensureKeyExists("declaration",s),t.ensureKeyExists("instruction",s),t.ensureKeyExists("attributes",s),t.ensureKeyExists("text",s),t.ensureKeyExists("comment",s),t.ensureKeyExists("cdata",s),t.ensureKeyExists("doctype",s),t.ensureKeyExists("type",s),t.ensureKeyExists("name",s),t.ensureKeyExists("elements",s),t.ensureKeyExists("parent",s),t.checkFnExists("doctype",s),t.checkFnExists("instruction",s),t.checkFnExists("cdata",s),t.checkFnExists("comment",s),t.checkFnExists("text",s),t.checkFnExists("instructionName",s),t.checkFnExists("elementName",s),t.checkFnExists("attributeName",s),t.checkFnExists("attributeValue",s),t.checkFnExists("attributes",s),s}function l(w){var S=Number(w);if(!isNaN(S))return S;var N=w.toLowerCase();return N==="true"?!0:N==="false"?!1:w}function u(w,S){var N;if(s.compact){if(!n[s[w+"Key"]]&&(r(s.alwaysArray)?s.alwaysArray.indexOf(s[w+"Key"])!==-1:s.alwaysArray)&&(n[s[w+"Key"]]=[]),n[s[w+"Key"]]&&!r(n[s[w+"Key"]])&&(n[s[w+"Key"]]=[n[s[w+"Key"]]]),w+"Fn"in s&&typeof S=="string"&&(S=s[w+"Fn"](S,n)),w==="instruction"&&("instructionFn"in s||"instructionNameFn"in s)){for(N in S)if(S.hasOwnProperty(N))if("instructionFn"in s)S[N]=s.instructionFn(S[N],N,n);else{var E=S[N];delete S[N],S[s.instructionNameFn(N,E,n)]=E}}r(n[s[w+"Key"]])?n[s[w+"Key"]].push(S):n[s[w+"Key"]]=S}else{n[s.elementsKey]||(n[s.elementsKey]=[]);var C={};if(C[s.typeKey]=w,w==="instruction"){for(N in S)if(S.hasOwnProperty(N))break;C[s.nameKey]="instructionNameFn"in s?s.instructionNameFn(N,S,n):N,s.instructionHasAttributes?(C[s.attributesKey]=S[N][s.attributesKey],"instructionFn"in s&&(C[s.attributesKey]=s.instructionFn(C[s.attributesKey],N,n))):("instructionFn"in s&&(S[N]=s.instructionFn(S[N],N,n)),C[s.instructionKey]=S[N])}else w+"Fn"in s&&(S=s[w+"Fn"](S,n)),C[s[w+"Key"]]=S;s.addParent&&(C[s.parentKey]=n),n[s.elementsKey].push(C)}}function d(w){if("attributesFn"in s&&w&&(w=s.attributesFn(w,n)),(s.trim||"attributeValueFn"in s||"attributeNameFn"in s||s.nativeTypeAttributes)&&w){var S;for(S in w)if(w.hasOwnProperty(S)&&(s.trim&&(w[S]=w[S].trim()),s.nativeTypeAttributes&&(w[S]=l(w[S])),"attributeValueFn"in s&&(w[S]=s.attributeValueFn(w[S],S,n)),"attributeNameFn"in s)){var N=w[S];delete w[S],w[s.attributeNameFn(S,w[S],n)]=N}}return w}function h(w){var S={};if(w.body&&(w.name.toLowerCase()==="xml"||s.instructionHasAttributes)){for(var N=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,E;(E=N.exec(w.body))!==null;)S[E[1]]=E[2]||E[3]||E[4];S=d(S)}if(w.name.toLowerCase()==="xml"){if(s.ignoreDeclaration)return;n[s.declarationKey]={},Object.keys(S).length&&(n[s.declarationKey][s.attributesKey]=S),s.addParent&&(n[s.declarationKey][s.parentKey]=n)}else{if(s.ignoreInstruction)return;s.trim&&(w.body=w.body.trim());var C={};s.instructionHasAttributes&&Object.keys(S).length?(C[w.name]={},C[w.name][s.attributesKey]=S):C[w.name]=w.body,u("instruction",C)}}function m(w,S){var N;if(typeof w=="object"&&(S=w.attributes,w=w.name),S=d(S),"elementNameFn"in s&&(w=s.elementNameFn(w,n)),s.compact){if(N={},!s.ignoreAttributes&&S&&Object.keys(S).length){N[s.attributesKey]={};var E;for(E in S)S.hasOwnProperty(E)&&(N[s.attributesKey][E]=S[E])}!(w in n)&&(r(s.alwaysArray)?s.alwaysArray.indexOf(w)!==-1:s.alwaysArray)&&(n[w]=[]),n[w]&&!r(n[w])&&(n[w]=[n[w]]),r(n[w])?n[w].push(N):n[w]=N}else n[s.elementsKey]||(n[s.elementsKey]=[]),N={},N[s.typeKey]="element",N[s.nameKey]=w,!s.ignoreAttributes&&S&&Object.keys(S).length&&(N[s.attributesKey]=S),s.alwaysChildren&&(N[s.elementsKey]=[]),n[s.elementsKey].push(N);N[s.parentKey]=n,n=N}function x(w){s.ignoreText||!w.trim()&&!s.captureSpacesBetweenElements||(s.trim&&(w=w.trim()),s.nativeType&&(w=l(w)),s.sanitize&&(w=w.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),u("text",w))}function y(w){s.ignoreComment||(s.trim&&(w=w.trim()),u("comment",w))}function b(w){var S=n[s.parentKey];s.addParent||delete n[s.parentKey],n=S}function v(w){s.ignoreCdata||(s.trim&&(w=w.trim()),u("cdata",w))}function g(w){s.ignoreDoctype||(w=w.replace(/^ /,""),s.trim&&(w=w.trim()),u("doctype",w))}function _(w){w.note=w}return j1=function(w,S){var N=e.parser(!0,{}),E={};if(n=E,s=o(S),N.opt={strictEntities:!0},N.onopentag=m,N.ontext=x,N.oncomment=y,N.onclosetag=b,N.onerror=_,N.oncdata=v,N.ondoctype=g,N.onprocessinginstruction=h,N.write(w).close(),E[s.elementsKey]){var C=E[s.elementsKey];delete E[s.elementsKey],E[s.elementsKey]=C,delete E.text}return E},j1}var T1,$k;function BL(){if($k)return T1;$k=1;var e=Tv(),t=bj();function r(s){var n=e.copyOptions(s);return e.ensureSpacesExists(n),n}return T1=function(s,n){var o,l,u,d;return o=r(n),l=t(s,o),d="compact"in o&&o.compact?"_parent":"parent","addParent"in o&&o.addParent?u=JSON.stringify(l,function(h,m){return h===d?"_":m},o.spaces):u=JSON.stringify(l,null,o.spaces),u.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},T1}var A1,qk;function wj(){if(qk)return A1;qk=1;var e=Tv(),t=jv().isArray,r,s;function n(N){var E=e.copyOptions(N);return e.ensureFlagExists("ignoreDeclaration",E),e.ensureFlagExists("ignoreInstruction",E),e.ensureFlagExists("ignoreAttributes",E),e.ensureFlagExists("ignoreText",E),e.ensureFlagExists("ignoreComment",E),e.ensureFlagExists("ignoreCdata",E),e.ensureFlagExists("ignoreDoctype",E),e.ensureFlagExists("compact",E),e.ensureFlagExists("indentText",E),e.ensureFlagExists("indentCdata",E),e.ensureFlagExists("indentAttributes",E),e.ensureFlagExists("indentInstruction",E),e.ensureFlagExists("fullTagEmptyElement",E),e.ensureFlagExists("noQuotesForNativeAttributes",E),e.ensureSpacesExists(E),typeof E.spaces=="number"&&(E.spaces=Array(E.spaces+1).join(" ")),e.ensureKeyExists("declaration",E),e.ensureKeyExists("instruction",E),e.ensureKeyExists("attributes",E),e.ensureKeyExists("text",E),e.ensureKeyExists("comment",E),e.ensureKeyExists("cdata",E),e.ensureKeyExists("doctype",E),e.ensureKeyExists("type",E),e.ensureKeyExists("name",E),e.ensureKeyExists("elements",E),e.checkFnExists("doctype",E),e.checkFnExists("instruction",E),e.checkFnExists("cdata",E),e.checkFnExists("comment",E),e.checkFnExists("text",E),e.checkFnExists("instructionName",E),e.checkFnExists("elementName",E),e.checkFnExists("attributeName",E),e.checkFnExists("attributeValue",E),e.checkFnExists("attributes",E),e.checkFnExists("fullTagEmptyElement",E),E}function o(N,E,C){return(!C&&N.spaces?`
`:"")+Array(E+1).join(N.spaces)}function l(N,E,C){if(E.ignoreAttributes)return"";"attributesFn"in E&&(N=E.attributesFn(N,s,r));var F,O,B,L,H=[];for(F in N)N.hasOwnProperty(F)&&N[F]!==null&&N[F]!==void 0&&(L=E.noQuotesForNativeAttributes&&typeof N[F]!="string"?"":'"',O=""+N[F],O=O.replace(/"/g,"&quot;"),B="attributeNameFn"in E?E.attributeNameFn(F,O,s,r):F,H.push(E.spaces&&E.indentAttributes?o(E,C+1,!1):" "),H.push(B+"="+L+("attributeValueFn"in E?E.attributeValueFn(O,F,s,r):O)+L));return N&&Object.keys(N).length&&E.spaces&&E.indentAttributes&&H.push(o(E,C,!1)),H.join("")}function u(N,E,C){return r=N,s="xml",E.ignoreDeclaration?"":"<?xml"+l(N[E.attributesKey],E,C)+"?>"}function d(N,E,C){if(E.ignoreInstruction)return"";var F;for(F in N)if(N.hasOwnProperty(F))break;var O="instructionNameFn"in E?E.instructionNameFn(F,N[F],s,r):F;if(typeof N[F]=="object")return r=N,s=O,"<?"+O+l(N[F][E.attributesKey],E,C)+"?>";var B=N[F]?N[F]:"";return"instructionFn"in E&&(B=E.instructionFn(B,F,s,r)),"<?"+O+(B?" "+B:"")+"?>"}function h(N,E){return E.ignoreComment?"":"<!--"+("commentFn"in E?E.commentFn(N,s,r):N)+"-->"}function m(N,E){return E.ignoreCdata?"":"<![CDATA["+("cdataFn"in E?E.cdataFn(N,s,r):N.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function x(N,E){return E.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in E?E.doctypeFn(N,s,r):N)+">"}function y(N,E){return E.ignoreText?"":(N=""+N,N=N.replace(/&amp;/g,"&"),N=N.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in E?E.textFn(N,s,r):N)}function b(N,E){var C;if(N.elements&&N.elements.length)for(C=0;C<N.elements.length;++C)switch(N.elements[C][E.typeKey]){case"text":if(E.indentText)return!0;break;case"cdata":if(E.indentCdata)return!0;break;case"instruction":if(E.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function v(N,E,C){r=N,s=N.name;var F=[],O="elementNameFn"in E?E.elementNameFn(N.name,N):N.name;F.push("<"+O),N[E.attributesKey]&&F.push(l(N[E.attributesKey],E,C));var B=N[E.elementsKey]&&N[E.elementsKey].length||N[E.attributesKey]&&N[E.attributesKey]["xml:space"]==="preserve";return B||("fullTagEmptyElementFn"in E?B=E.fullTagEmptyElementFn(N.name,N):B=E.fullTagEmptyElement),B?(F.push(">"),N[E.elementsKey]&&N[E.elementsKey].length&&(F.push(g(N[E.elementsKey],E,C+1)),r=N,s=N.name),F.push(E.spaces&&b(N,E)?`
`+Array(C+1).join(E.spaces):""),F.push("</"+O+">")):F.push("/>"),F.join("")}function g(N,E,C,F){return N.reduce(function(O,B){var L=o(E,C,F&&!O);switch(B.type){case"element":return O+L+v(B,E,C);case"comment":return O+L+h(B[E.commentKey],E);case"doctype":return O+L+x(B[E.doctypeKey],E);case"cdata":return O+(E.indentCdata?L:"")+m(B[E.cdataKey],E);case"text":return O+(E.indentText?L:"")+y(B[E.textKey],E);case"instruction":var H={};return H[B[E.nameKey]]=B[E.attributesKey]?B:B[E.instructionKey],O+(E.indentInstruction?L:"")+d(H,E,C)}},"")}function _(N,E,C){var F;for(F in N)if(N.hasOwnProperty(F))switch(F){case E.parentKey:case E.attributesKey:break;case E.textKey:if(E.indentText||C)return!0;break;case E.cdataKey:if(E.indentCdata||C)return!0;break;case E.instructionKey:if(E.indentInstruction||C)return!0;break;case E.doctypeKey:case E.commentKey:return!0;default:return!0}return!1}function w(N,E,C,F,O){r=N,s=E;var B="elementNameFn"in C?C.elementNameFn(E,N):E;if(typeof N>"u"||N===null||N==="")return"fullTagEmptyElementFn"in C&&C.fullTagEmptyElementFn(E,N)||C.fullTagEmptyElement?"<"+B+"></"+B+">":"<"+B+"/>";var L=[];if(E){if(L.push("<"+B),typeof N!="object")return L.push(">"+y(N,C)+"</"+B+">"),L.join("");N[C.attributesKey]&&L.push(l(N[C.attributesKey],C,F));var H=_(N,C,!0)||N[C.attributesKey]&&N[C.attributesKey]["xml:space"]==="preserve";if(H||("fullTagEmptyElementFn"in C?H=C.fullTagEmptyElementFn(E,N):H=C.fullTagEmptyElement),H)L.push(">");else return L.push("/>"),L.join("")}return L.push(S(N,C,F+1,!1)),r=N,s=E,E&&L.push((O?o(C,F,!1):"")+"</"+B+">"),L.join("")}function S(N,E,C,F){var O,B,L,H=[];for(B in N)if(N.hasOwnProperty(B))for(L=t(N[B])?N[B]:[N[B]],O=0;O<L.length;++O){switch(B){case E.declarationKey:H.push(u(L[O],E,C));break;case E.instructionKey:H.push((E.indentInstruction?o(E,C,F):"")+d(L[O],E,C));break;case E.attributesKey:case E.parentKey:break;case E.textKey:H.push((E.indentText?o(E,C,F):"")+y(L[O],E));break;case E.cdataKey:H.push((E.indentCdata?o(E,C,F):"")+m(L[O],E));break;case E.doctypeKey:H.push(o(E,C,F)+x(L[O],E));break;case E.commentKey:H.push(o(E,C,F)+h(L[O],E));break;default:H.push(o(E,C,F)+w(L[O],B,E,C,_(L[O],E)))}F=F&&!H.length}return H.join("")}return A1=function(N,E){E=n(E);var C=[];return r=N,s="_root_",E.compact?C.push(S(N,E,0,!0)):(N[E.declarationKey]&&C.push(u(N[E.declarationKey],E,0)),N[E.elementsKey]&&N[E.elementsKey].length&&C.push(g(N[E.elementsKey],E,0,!C.length))),C.join("")},A1}var C1,Hk;function PL(){if(Hk)return C1;Hk=1;var e=wj();return C1=function(t,r){t instanceof Buffer&&(t=t.toString());var s=null;if(typeof t=="string")try{s=JSON.parse(t)}catch{throw new Error("The JSON structure is invalid")}else s=t;return e(s,r)},C1}var R1,Wk;function UL(){if(Wk)return R1;Wk=1;var e=bj(),t=BL(),r=wj(),s=PL();return R1={xml2js:e,xml2json:t,js2xml:r,json2xml:s},R1}var _j=UL();const Av=e=>{switch(e.type){case void 0:case"element":const t=new $L(e.name,e.attributes),r=e.elements||[];for(const s of r){const n=Av(s);n!==void 0&&t.push(n)}return t;case"text":return e.text;default:return}};class zL extends Ct{}class $L extends et{static fromXmlString(t){const r=_j.xml2js(t,{compact:!1});return Av(r)}constructor(t,r){super(t),r&&this.root.push(new zL(r))}push(t){this.root.push(t)}}class qL extends et{constructor(t){super(""),this._attr=t}prepForXml(t){return{_attr:this._attr}}}class Nj extends et{constructor(t,r){super(t),r&&(this.root=r.root)}}const la=e=>{if(isNaN(e))throw new Error(`Invalid value '${e}' specified. Must be an integer.`);return Math.floor(e)},um=e=>{const t=la(e);if(t<0)throw new Error(`Invalid value '${e}' specified. Must be a positive integer.`);return t},kj=(e,t)=>{const r=t*2;if(e.length!==r||isNaN(+`0x${e}`))throw new Error(`Invalid hex value '${e}'. Expected ${r} digit hex value`);return e},Gk=e=>kj(e,1),Cv=e=>{const t=e.slice(-2),r=e.substring(0,e.length-2);return`${Number(r)}${t}`},Sj=e=>{const t=Cv(e);if(parseFloat(t)<0)throw new Error(`Invalid value '${t}' specified. Expected a positive number.`);return t},Kc=e=>{if(e==="auto")return e;const t=e.charAt(0)==="#"?e.substring(1):e;return kj(t,3)},yi=e=>typeof e=="string"?Cv(e):la(e),HL=e=>typeof e=="string"?Sj(e):um(e),Xs=e=>typeof e=="string"?Sj(e):um(e),WL=e=>{const t=e.substring(0,e.length-1);return`${Number(t)}%`},Ej=e=>typeof e=="number"?la(e):e.slice(-1)==="%"?WL(e):Cv(e),GL=um,VL=um,KL=e=>e.toISOString();class mt extends et{constructor(t,r=!0){super(t),r!==!0&&this.root.push(new us({val:r}))}}class D1 extends et{constructor(t,r){super(t),this.root.push(new us({val:HL(r)}))}}class ol extends et{constructor(t,r){super(t),this.root.push(new us({val:r}))}}const td=(e,t)=>new Or({name:e,attributes:{value:{key:"w:val",value:t}}});class gd extends et{constructor(t,r){super(t),this.root.push(new us({val:r}))}}class XL extends et{constructor(t,r){super(t),this.root.push(new us({val:r}))}}class Wo extends et{constructor(t,r){super(t),this.root.push(r)}}class Or extends et{constructor({name:t,attributes:r,children:s}){super(t),r&&this.root.push(new Ri(r)),s&&this.root.push(...s)}}const Ft={START:"start",CENTER:"center",LEFT:"left",RIGHT:"right"};class YL extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{val:"w:val"})}}class jj extends et{constructor(t){super("w:jc"),this.root.push(new YL({val:t}))}}class Br extends et{constructor(t,{color:r,size:s,space:n,style:o}){super(t),this.root.push(new JL({style:o,color:r===void 0?void 0:Kc(r),size:s===void 0?void 0:GL(s),space:n===void 0?void 0:VL(n)}))}}class JL extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}}const nr={SINGLE:"single",NONE:"none"};class ZL extends Ci{constructor(t){super("w:pBdr"),t.top&&this.root.push(new Br("w:top",t.top)),t.bottom&&this.root.push(new Br("w:bottom",t.bottom)),t.left&&this.root.push(new Br("w:left",t.left)),t.right&&this.root.push(new Br("w:right",t.right))}}class QL extends et{constructor(){super("w:pBdr");const t=new Br("w:bottom",{color:"auto",space:1,style:nr.SINGLE,size:6});this.root.push(t)}}class eI extends et{constructor({start:t,end:r,left:s,right:n,hanging:o,firstLine:l}){super("w:ind"),this.root.push(new Ri({start:{key:"w:start",value:t===void 0?void 0:yi(t)},end:{key:"w:end",value:r===void 0?void 0:yi(r)},left:{key:"w:left",value:s===void 0?void 0:yi(s)},right:{key:"w:right",value:n===void 0?void 0:yi(n)},hanging:{key:"w:hanging",value:o===void 0?void 0:Xs(o)},firstLine:{key:"w:firstLine",value:l===void 0?void 0:Xs(l)}}))}}let tI=class extends et{constructor(){super("w:br")}};const Rv={BEGIN:"begin",END:"end",SEPARATE:"separate"};class Dv extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}}class qh extends et{constructor(t){super("w:fldChar"),this.root.push(new Dv({type:Rv.BEGIN,dirty:t}))}}class Hh extends et{constructor(t){super("w:fldChar"),this.root.push(new Dv({type:Rv.SEPARATE,dirty:t}))}}class Wh extends et{constructor(t){super("w:fldChar"),this.root.push(new Dv({type:Rv.END,dirty:t}))}}const Xc={DEFAULT:"default",PRESERVE:"preserve"};class Yc extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{space:"xml:space"})}}class rI extends et{constructor(){super("w:instrText"),this.root.push(new Yc({space:Xc.PRESERVE})),this.root.push("PAGE")}}class sI extends et{constructor(){super("w:instrText"),this.root.push(new Yc({space:Xc.PRESERVE})),this.root.push("NUMPAGES")}}class aI extends et{constructor(){super("w:instrText"),this.root.push(new Yc({space:Xc.PRESERVE})),this.root.push("SECTIONPAGES")}}class nI extends et{constructor(){super("w:instrText"),this.root.push(new Yc({space:Xc.PRESERVE})),this.root.push("SECTION")}}class iI extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}}class dm extends et{constructor({fill:t,color:r,type:s}){super("w:shd"),this.root.push(new iI({fill:t===void 0?void 0:Kc(t),color:r===void 0?void 0:Kc(r),type:s}))}}class oI extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}}const lI={DOT:"dot"};class cI extends et{constructor(t){super("w:em"),this.root.push(new us({val:t}))}}class uI extends cI{constructor(t=lI.DOT){super(t)}}class dI extends et{constructor(t){super("w:spacing"),this.root.push(new us({val:yi(t)}))}}class fI extends et{constructor(t){super("w:color"),this.root.push(new us({val:Kc(t)}))}}class hI extends et{constructor(t){super("w:highlight"),this.root.push(new us({val:t}))}}class mI extends et{constructor(t){super("w:highlightCs"),this.root.push(new us({val:t}))}}const pI=e=>new Or({name:"w:lang",attributes:{value:{key:"w:val",value:e.value},eastAsia:{key:"w:eastAsia",value:e.eastAsia},bidirectional:{key:"w:bidi",value:e.bidirectional}}});class Vk extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}}class O1 extends et{constructor(t,r){if(super("w:rFonts"),typeof t=="string"){const s=t;this.root.push(new Vk({ascii:s,cs:s,eastAsia:s,hAnsi:s,hint:r}))}else{const s=t;this.root.push(new Vk(s))}}}let Tj=class extends et{constructor(t){super("w:vertAlign"),this.root.push(new us({val:t}))}};class xI extends Tj{constructor(){super("superscript")}}class gI extends Tj{constructor(){super("subscript")}}const Aj={SINGLE:"single"};class yI extends et{constructor(t=Aj.SINGLE,r){super("w:u"),this.root.push(new us({val:t,color:r===void 0?void 0:Kc(r)}))}}class Sl extends Ci{constructor(t){var r,s;if(super("w:rPr"),!t)return;t.style&&this.push(new ol("w:rStyle",t.style)),t.font&&(typeof t.font=="string"?this.push(new O1(t.font)):"name"in t.font?this.push(new O1(t.font.name,t.font.hint)):this.push(new O1(t.font))),t.bold!==void 0&&this.push(new mt("w:b",t.bold)),(t.boldComplexScript===void 0&&t.bold!==void 0||t.boldComplexScript)&&this.push(new mt("w:bCs",(r=t.boldComplexScript)!=null?r:t.bold)),t.italics!==void 0&&this.push(new mt("w:i",t.italics)),(t.italicsComplexScript===void 0&&t.italics!==void 0||t.italicsComplexScript)&&this.push(new mt("w:iCs",(s=t.italicsComplexScript)!=null?s:t.italics)),t.smallCaps!==void 0?this.push(new mt("w:smallCaps",t.smallCaps)):t.allCaps!==void 0&&this.push(new mt("w:caps",t.allCaps)),t.strike!==void 0&&this.push(new mt("w:strike",t.strike)),t.doubleStrike!==void 0&&this.push(new mt("w:dstrike",t.doubleStrike)),t.emboss!==void 0&&this.push(new mt("w:emboss",t.emboss)),t.imprint!==void 0&&this.push(new mt("w:imprint",t.imprint)),t.noProof!==void 0&&this.push(new mt("w:noProof",t.noProof)),t.snapToGrid!==void 0&&this.push(new mt("w:snapToGrid",t.snapToGrid)),t.vanish&&this.push(new mt("w:vanish",t.vanish)),t.color&&this.push(new fI(t.color)),t.characterSpacing&&this.push(new dI(t.characterSpacing)),t.scale!==void 0&&this.push(new gd("w:w",t.scale)),t.kern&&this.push(new D1("w:kern",t.kern)),t.position&&this.push(new ol("w:position",t.position)),t.size!==void 0&&this.push(new D1("w:sz",t.size));const n=t.sizeComplexScript===void 0||t.sizeComplexScript===!0?t.size:t.sizeComplexScript;n&&this.push(new D1("w:szCs",n)),t.highlight&&this.push(new hI(t.highlight));const o=t.highlightComplexScript===void 0||t.highlightComplexScript===!0?t.highlight:t.highlightComplexScript;o&&this.push(new mI(o)),t.underline&&this.push(new yI(t.underline.type,t.underline.color)),t.effect&&this.push(new ol("w:effect",t.effect)),t.border&&this.push(new Br("w:bdr",t.border)),t.shading&&this.push(new dm(t.shading)),t.subScript&&this.push(new gI),t.superScript&&this.push(new xI),t.rightToLeft!==void 0&&this.push(new mt("w:rtl",t.rightToLeft)),t.emphasisMark&&this.push(new uI(t.emphasisMark.type)),t.language&&this.push(pI(t.language)),t.specVanish&&this.push(new mt("w:specVanish",t.vanish)),t.math&&this.push(new mt("w:oMath",t.math)),t.revision&&this.push(new vI(t.revision))}push(t){this.root.push(t)}}class vI extends et{constructor(t){super("w:rPrChange"),this.root.push(new oI({id:t.id,author:t.author,date:t.date})),this.addChildElement(new Sl(t))}}class Kk extends et{constructor(t){var r;super("w:t"),typeof t=="string"?(this.root.push(new Yc({space:Xc.PRESERVE})),this.root.push(t)):(this.root.push(new Yc({space:(r=t.space)!=null?r:Xc.DEFAULT})),this.root.push(t.text))}}const Gh={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"};class cf extends et{constructor(t){if(super("w:r"),Ze(this,"properties"),this.properties=new Sl(t),this.root.push(this.properties),t.break)for(let r=0;r<t.break;r++)this.root.push(new tI);if(t.children)for(const r of t.children){if(typeof r=="string"){switch(r){case Gh.CURRENT:this.root.push(new qh),this.root.push(new rI),this.root.push(new Hh),this.root.push(new Wh);break;case Gh.TOTAL_PAGES:this.root.push(new qh),this.root.push(new sI),this.root.push(new Hh),this.root.push(new Wh);break;case Gh.TOTAL_PAGES_IN_SECTION:this.root.push(new qh),this.root.push(new aI),this.root.push(new Hh),this.root.push(new Wh);break;case Gh.CURRENT_SECTION:this.root.push(new qh),this.root.push(new nI),this.root.push(new Hh),this.root.push(new Wh);break;default:this.root.push(new Kk(r));break}continue}this.root.push(r)}else t.text!==void 0&&this.root.push(new Kk(t.text))}}class Dt extends cf{constructor(t){super(typeof t=="string"?{text:t}:t)}}var F1={},Mr={},L1,Xk;function uf(){if(Xk)return L1;Xk=1,L1=e;function e(t,r){if(!t)throw new Error(r||"Assertion failed")}return e.equal=function(r,s,n){if(r!=s)throw new Error(n||"Assertion failed: "+r+" != "+s)},L1}var Yk;function Vn(){if(Yk)return Mr;Yk=1;var e=uf(),t=bo();Mr.inherits=t;function r(A,Y){return(A.charCodeAt(Y)&64512)!==55296||Y<0||Y+1>=A.length?!1:(A.charCodeAt(Y+1)&64512)===56320}function s(A,Y){if(Array.isArray(A))return A.slice();if(!A)return[];var I=[];if(typeof A=="string")if(Y){if(Y==="hex")for(A=A.replace(/[^a-z0-9]+/ig,""),A.length%2!==0&&(A="0"+A),Q=0;Q<A.length;Q+=2)I.push(parseInt(A[Q]+A[Q+1],16))}else for(var ae=0,Q=0;Q<A.length;Q++){var re=A.charCodeAt(Q);re<128?I[ae++]=re:re<2048?(I[ae++]=re>>6|192,I[ae++]=re&63|128):r(A,Q)?(re=65536+((re&1023)<<10)+(A.charCodeAt(++Q)&1023),I[ae++]=re>>18|240,I[ae++]=re>>12&63|128,I[ae++]=re>>6&63|128,I[ae++]=re&63|128):(I[ae++]=re>>12|224,I[ae++]=re>>6&63|128,I[ae++]=re&63|128)}else for(Q=0;Q<A.length;Q++)I[Q]=A[Q]|0;return I}Mr.toArray=s;function n(A){for(var Y="",I=0;I<A.length;I++)Y+=u(A[I].toString(16));return Y}Mr.toHex=n;function o(A){var Y=A>>>24|A>>>8&65280|A<<8&16711680|(A&255)<<24;return Y>>>0}Mr.htonl=o;function l(A,Y){for(var I="",ae=0;ae<A.length;ae++){var Q=A[ae];Y==="little"&&(Q=o(Q)),I+=d(Q.toString(16))}return I}Mr.toHex32=l;function u(A){return A.length===1?"0"+A:A}Mr.zero2=u;function d(A){return A.length===7?"0"+A:A.length===6?"00"+A:A.length===5?"000"+A:A.length===4?"0000"+A:A.length===3?"00000"+A:A.length===2?"000000"+A:A.length===1?"0000000"+A:A}Mr.zero8=d;function h(A,Y,I,ae){var Q=I-Y;e(Q%4===0);for(var re=new Array(Q/4),ve=0,te=Y;ve<re.length;ve++,te+=4){var ke;ae==="big"?ke=A[te]<<24|A[te+1]<<16|A[te+2]<<8|A[te+3]:ke=A[te+3]<<24|A[te+2]<<16|A[te+1]<<8|A[te],re[ve]=ke>>>0}return re}Mr.join32=h;function m(A,Y){for(var I=new Array(A.length*4),ae=0,Q=0;ae<A.length;ae++,Q+=4){var re=A[ae];Y==="big"?(I[Q]=re>>>24,I[Q+1]=re>>>16&255,I[Q+2]=re>>>8&255,I[Q+3]=re&255):(I[Q+3]=re>>>24,I[Q+2]=re>>>16&255,I[Q+1]=re>>>8&255,I[Q]=re&255)}return I}Mr.split32=m;function x(A,Y){return A>>>Y|A<<32-Y}Mr.rotr32=x;function y(A,Y){return A<<Y|A>>>32-Y}Mr.rotl32=y;function b(A,Y){return A+Y>>>0}Mr.sum32=b;function v(A,Y,I){return A+Y+I>>>0}Mr.sum32_3=v;function g(A,Y,I,ae){return A+Y+I+ae>>>0}Mr.sum32_4=g;function _(A,Y,I,ae,Q){return A+Y+I+ae+Q>>>0}Mr.sum32_5=_;function w(A,Y,I,ae){var Q=A[Y],re=A[Y+1],ve=ae+re>>>0,te=(ve<ae?1:0)+I+Q;A[Y]=te>>>0,A[Y+1]=ve}Mr.sum64=w;function S(A,Y,I,ae){var Q=Y+ae>>>0,re=(Q<Y?1:0)+A+I;return re>>>0}Mr.sum64_hi=S;function N(A,Y,I,ae){var Q=Y+ae;return Q>>>0}Mr.sum64_lo=N;function E(A,Y,I,ae,Q,re,ve,te){var ke=0,Z=Y;Z=Z+ae>>>0,ke+=Z<Y?1:0,Z=Z+re>>>0,ke+=Z<re?1:0,Z=Z+te>>>0,ke+=Z<te?1:0;var M=A+I+Q+ve+ke;return M>>>0}Mr.sum64_4_hi=E;function C(A,Y,I,ae,Q,re,ve,te){var ke=Y+ae+re+te;return ke>>>0}Mr.sum64_4_lo=C;function F(A,Y,I,ae,Q,re,ve,te,ke,Z){var M=0,J=Y;J=J+ae>>>0,M+=J<Y?1:0,J=J+re>>>0,M+=J<re?1:0,J=J+te>>>0,M+=J<te?1:0,J=J+Z>>>0,M+=J<Z?1:0;var V=A+I+Q+ve+ke+M;return V>>>0}Mr.sum64_5_hi=F;function O(A,Y,I,ae,Q,re,ve,te,ke,Z){var M=Y+ae+re+te+Z;return M>>>0}Mr.sum64_5_lo=O;function B(A,Y,I){var ae=Y<<32-I|A>>>I;return ae>>>0}Mr.rotr64_hi=B;function L(A,Y,I){var ae=A<<32-I|Y>>>I;return ae>>>0}Mr.rotr64_lo=L;function H(A,Y,I){return A>>>I}Mr.shr64_hi=H;function ue(A,Y,I){var ae=A<<32-I|Y>>>I;return ae>>>0}return Mr.shr64_lo=ue,Mr}var I1={},Jk;function df(){if(Jk)return I1;Jk=1;var e=Vn(),t=uf();function r(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return I1.BlockHash=r,r.prototype.update=function(n,o){if(n=e.toArray(n,o),this.pending?this.pending=this.pending.concat(n):this.pending=n,this.pendingTotal+=n.length,this.pending.length>=this._delta8){n=this.pending;var l=n.length%this._delta8;this.pending=n.slice(n.length-l,n.length),this.pending.length===0&&(this.pending=null),n=e.join32(n,0,n.length-l,this.endian);for(var u=0;u<n.length;u+=this._delta32)this._update(n,u,u+this._delta32)}return this},r.prototype.digest=function(n){return this.update(this._pad()),t(this.pending===null),this._digest(n)},r.prototype._pad=function(){var n=this.pendingTotal,o=this._delta8,l=o-(n+this.padLength)%o,u=new Array(l+this.padLength);u[0]=128;for(var d=1;d<l;d++)u[d]=0;if(n<<=3,this.endian==="big"){for(var h=8;h<this.padLength;h++)u[d++]=0;u[d++]=0,u[d++]=0,u[d++]=0,u[d++]=0,u[d++]=n>>>24&255,u[d++]=n>>>16&255,u[d++]=n>>>8&255,u[d++]=n&255}else for(u[d++]=n&255,u[d++]=n>>>8&255,u[d++]=n>>>16&255,u[d++]=n>>>24&255,u[d++]=0,u[d++]=0,u[d++]=0,u[d++]=0,h=8;h<this.padLength;h++)u[d++]=0;return u},I1}var Go={},Ln={},Zk;function Cj(){if(Zk)return Ln;Zk=1;var e=Vn(),t=e.rotr32;function r(m,x,y,b){if(m===0)return s(x,y,b);if(m===1||m===3)return o(x,y,b);if(m===2)return n(x,y,b)}Ln.ft_1=r;function s(m,x,y){return m&x^~m&y}Ln.ch32=s;function n(m,x,y){return m&x^m&y^x&y}Ln.maj32=n;function o(m,x,y){return m^x^y}Ln.p32=o;function l(m){return t(m,2)^t(m,13)^t(m,22)}Ln.s0_256=l;function u(m){return t(m,6)^t(m,11)^t(m,25)}Ln.s1_256=u;function d(m){return t(m,7)^t(m,18)^m>>>3}Ln.g0_256=d;function h(m){return t(m,17)^t(m,19)^m>>>10}return Ln.g1_256=h,Ln}var M1,Qk;function bI(){if(Qk)return M1;Qk=1;var e=Vn(),t=df(),r=Cj(),s=e.rotl32,n=e.sum32,o=e.sum32_5,l=r.ft_1,u=t.BlockHash,d=[1518500249,1859775393,2400959708,3395469782];function h(){if(!(this instanceof h))return new h;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return e.inherits(h,u),M1=h,h.blockSize=512,h.outSize=160,h.hmacStrength=80,h.padLength=64,h.prototype._update=function(x,y){for(var b=this.W,v=0;v<16;v++)b[v]=x[y+v];for(;v<b.length;v++)b[v]=s(b[v-3]^b[v-8]^b[v-14]^b[v-16],1);var g=this.h[0],_=this.h[1],w=this.h[2],S=this.h[3],N=this.h[4];for(v=0;v<b.length;v++){var E=~~(v/20),C=o(s(g,5),l(E,_,w,S),N,b[v],d[E]);N=S,S=w,w=s(_,30),_=g,g=C}this.h[0]=n(this.h[0],g),this.h[1]=n(this.h[1],_),this.h[2]=n(this.h[2],w),this.h[3]=n(this.h[3],S),this.h[4]=n(this.h[4],N)},h.prototype._digest=function(x){return x==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")},M1}var B1,eS;function Rj(){if(eS)return B1;eS=1;var e=Vn(),t=df(),r=Cj(),s=uf(),n=e.sum32,o=e.sum32_4,l=e.sum32_5,u=r.ch32,d=r.maj32,h=r.s0_256,m=r.s1_256,x=r.g0_256,y=r.g1_256,b=t.BlockHash,v=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function g(){if(!(this instanceof g))return new g;b.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=v,this.W=new Array(64)}return e.inherits(g,b),B1=g,g.blockSize=512,g.outSize=256,g.hmacStrength=192,g.padLength=64,g.prototype._update=function(w,S){for(var N=this.W,E=0;E<16;E++)N[E]=w[S+E];for(;E<N.length;E++)N[E]=o(y(N[E-2]),N[E-7],x(N[E-15]),N[E-16]);var C=this.h[0],F=this.h[1],O=this.h[2],B=this.h[3],L=this.h[4],H=this.h[5],ue=this.h[6],A=this.h[7];for(s(this.k.length===N.length),E=0;E<N.length;E++){var Y=l(A,m(L),u(L,H,ue),this.k[E],N[E]),I=n(h(C),d(C,F,O));A=ue,ue=H,H=L,L=n(B,Y),B=O,O=F,F=C,C=n(Y,I)}this.h[0]=n(this.h[0],C),this.h[1]=n(this.h[1],F),this.h[2]=n(this.h[2],O),this.h[3]=n(this.h[3],B),this.h[4]=n(this.h[4],L),this.h[5]=n(this.h[5],H),this.h[6]=n(this.h[6],ue),this.h[7]=n(this.h[7],A)},g.prototype._digest=function(w){return w==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")},B1}var P1,tS;function wI(){if(tS)return P1;tS=1;var e=Vn(),t=Rj();function r(){if(!(this instanceof r))return new r;t.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return e.inherits(r,t),P1=r,r.blockSize=512,r.outSize=224,r.hmacStrength=192,r.padLength=64,r.prototype._digest=function(n){return n==="hex"?e.toHex32(this.h.slice(0,7),"big"):e.split32(this.h.slice(0,7),"big")},P1}var U1,rS;function Dj(){if(rS)return U1;rS=1;var e=Vn(),t=df(),r=uf(),s=e.rotr64_hi,n=e.rotr64_lo,o=e.shr64_hi,l=e.shr64_lo,u=e.sum64,d=e.sum64_hi,h=e.sum64_lo,m=e.sum64_4_hi,x=e.sum64_4_lo,y=e.sum64_5_hi,b=e.sum64_5_lo,v=t.BlockHash,g=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function _(){if(!(this instanceof _))return new _;v.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=g,this.W=new Array(160)}e.inherits(_,v),U1=_,_.blockSize=1024,_.outSize=512,_.hmacStrength=192,_.padLength=128,_.prototype._prepareBlock=function(I,ae){for(var Q=this.W,re=0;re<32;re++)Q[re]=I[ae+re];for(;re<Q.length;re+=2){var ve=ue(Q[re-4],Q[re-3]),te=A(Q[re-4],Q[re-3]),ke=Q[re-14],Z=Q[re-13],M=L(Q[re-30],Q[re-29]),J=H(Q[re-30],Q[re-29]),V=Q[re-32],X=Q[re-31];Q[re]=m(ve,te,ke,Z,M,J,V,X),Q[re+1]=x(ve,te,ke,Z,M,J,V,X)}},_.prototype._update=function(I,ae){this._prepareBlock(I,ae);var Q=this.W,re=this.h[0],ve=this.h[1],te=this.h[2],ke=this.h[3],Z=this.h[4],M=this.h[5],J=this.h[6],V=this.h[7],X=this.h[8],se=this.h[9],P=this.h[10],U=this.h[11],ce=this.h[12],ne=this.h[13],ie=this.h[14],W=this.h[15];r(this.k.length===Q.length);for(var G=0;G<Q.length;G+=2){var k=ie,de=W,z=O(X,se),T=B(X,se),R=w(X,se,P,U,ce),q=S(X,se,P,U,ce,ne),me=this.k[G],_e=this.k[G+1],le=Q[G],Ae=Q[G+1],Me=y(k,de,z,T,R,q,me,_e,le,Ae),Ee=b(k,de,z,T,R,q,me,_e,le,Ae);k=C(re,ve),de=F(re,ve),z=N(re,ve,te,ke,Z),T=E(re,ve,te,ke,Z,M);var Ce=d(k,de,z,T),Je=h(k,de,z,T);ie=ce,W=ne,ce=P,ne=U,P=X,U=se,X=d(J,V,Me,Ee),se=h(V,V,Me,Ee),J=Z,V=M,Z=te,M=ke,te=re,ke=ve,re=d(Me,Ee,Ce,Je),ve=h(Me,Ee,Ce,Je)}u(this.h,0,re,ve),u(this.h,2,te,ke),u(this.h,4,Z,M),u(this.h,6,J,V),u(this.h,8,X,se),u(this.h,10,P,U),u(this.h,12,ce,ne),u(this.h,14,ie,W)},_.prototype._digest=function(I){return I==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")};function w(Y,I,ae,Q,re){var ve=Y&ae^~Y&re;return ve<0&&(ve+=4294967296),ve}function S(Y,I,ae,Q,re,ve){var te=I&Q^~I&ve;return te<0&&(te+=4294967296),te}function N(Y,I,ae,Q,re){var ve=Y&ae^Y&re^ae&re;return ve<0&&(ve+=4294967296),ve}function E(Y,I,ae,Q,re,ve){var te=I&Q^I&ve^Q&ve;return te<0&&(te+=4294967296),te}function C(Y,I){var ae=s(Y,I,28),Q=s(I,Y,2),re=s(I,Y,7),ve=ae^Q^re;return ve<0&&(ve+=4294967296),ve}function F(Y,I){var ae=n(Y,I,28),Q=n(I,Y,2),re=n(I,Y,7),ve=ae^Q^re;return ve<0&&(ve+=4294967296),ve}function O(Y,I){var ae=s(Y,I,14),Q=s(Y,I,18),re=s(I,Y,9),ve=ae^Q^re;return ve<0&&(ve+=4294967296),ve}function B(Y,I){var ae=n(Y,I,14),Q=n(Y,I,18),re=n(I,Y,9),ve=ae^Q^re;return ve<0&&(ve+=4294967296),ve}function L(Y,I){var ae=s(Y,I,1),Q=s(Y,I,8),re=o(Y,I,7),ve=ae^Q^re;return ve<0&&(ve+=4294967296),ve}function H(Y,I){var ae=n(Y,I,1),Q=n(Y,I,8),re=l(Y,I,7),ve=ae^Q^re;return ve<0&&(ve+=4294967296),ve}function ue(Y,I){var ae=s(Y,I,19),Q=s(I,Y,29),re=o(Y,I,6),ve=ae^Q^re;return ve<0&&(ve+=4294967296),ve}function A(Y,I){var ae=n(Y,I,19),Q=n(I,Y,29),re=l(Y,I,6),ve=ae^Q^re;return ve<0&&(ve+=4294967296),ve}return U1}var z1,sS;function _I(){if(sS)return z1;sS=1;var e=Vn(),t=Dj();function r(){if(!(this instanceof r))return new r;t.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return e.inherits(r,t),z1=r,r.blockSize=1024,r.outSize=384,r.hmacStrength=192,r.padLength=128,r.prototype._digest=function(n){return n==="hex"?e.toHex32(this.h.slice(0,12),"big"):e.split32(this.h.slice(0,12),"big")},z1}var aS;function NI(){return aS||(aS=1,Go.sha1=bI(),Go.sha224=wI(),Go.sha256=Rj(),Go.sha384=_I(),Go.sha512=Dj()),Go}var $1={},nS;function kI(){if(nS)return $1;nS=1;var e=Vn(),t=df(),r=e.rotl32,s=e.sum32,n=e.sum32_3,o=e.sum32_4,l=t.BlockHash;function u(){if(!(this instanceof u))return new u;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}e.inherits(u,l),$1.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(_,w){for(var S=this.h[0],N=this.h[1],E=this.h[2],C=this.h[3],F=this.h[4],O=S,B=N,L=E,H=C,ue=F,A=0;A<80;A++){var Y=s(r(o(S,d(A,N,E,C),_[x[A]+w],h(A)),b[A]),F);S=F,F=C,C=r(E,10),E=N,N=Y,Y=s(r(o(O,d(79-A,B,L,H),_[y[A]+w],m(A)),v[A]),ue),O=ue,ue=H,H=r(L,10),L=B,B=Y}Y=n(this.h[1],E,H),this.h[1]=n(this.h[2],C,ue),this.h[2]=n(this.h[3],F,O),this.h[3]=n(this.h[4],S,B),this.h[4]=n(this.h[0],N,L),this.h[0]=Y},u.prototype._digest=function(_){return _==="hex"?e.toHex32(this.h,"little"):e.split32(this.h,"little")};function d(g,_,w,S){return g<=15?_^w^S:g<=31?_&w|~_&S:g<=47?(_|~w)^S:g<=63?_&S|w&~S:_^(w|~S)}function h(g){return g<=15?0:g<=31?1518500249:g<=47?1859775393:g<=63?2400959708:2840853838}function m(g){return g<=15?1352829926:g<=31?1548603684:g<=47?1836072691:g<=63?2053994217:0}var x=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],y=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],b=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],v=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return $1}var q1,iS;function SI(){if(iS)return q1;iS=1;var e=Vn(),t=uf();function r(s,n,o){if(!(this instanceof r))return new r(s,n,o);this.Hash=s,this.blockSize=s.blockSize/8,this.outSize=s.outSize/8,this.inner=null,this.outer=null,this._init(e.toArray(n,o))}return q1=r,r.prototype._init=function(n){n.length>this.blockSize&&(n=new this.Hash().update(n).digest()),t(n.length<=this.blockSize);for(var o=n.length;o<this.blockSize;o++)n.push(0);for(o=0;o<n.length;o++)n[o]^=54;for(this.inner=new this.Hash().update(n),o=0;o<n.length;o++)n[o]^=106;this.outer=new this.Hash().update(n)},r.prototype.update=function(n,o){return this.inner.update(n,o),this},r.prototype.digest=function(n){return this.outer.update(this.inner.digest()),this.outer.digest(n)},q1}var oS;function EI(){return oS||(oS=1,(function(e){var t=e;t.utils=Vn(),t.common=df(),t.sha=NI(),t.ripemd=kI(),t.hmac=SI(),t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160})(F1)),F1}var jI=EI();const TI=bv(jI);let AI="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",CI=(e,t=21)=>(r=t)=>{let s="",n=r|0;for(;n--;)s+=e[Math.random()*e.length|0];return s},RI=(e=21)=>{let t="",r=e|0;for(;r--;)t+=AI[Math.random()*64|0];return t};const kr=e=>Math.floor(e*72*20),fm=(e=0)=>{let t=e;return()=>++t},DI=()=>fm(),OI=()=>fm(1),FI=()=>fm(),LI=()=>fm(),II=()=>RI().toLowerCase(),lS=e=>TI.sha1().update(e instanceof ArrayBuffer?new Uint8Array(e):e).digest("hex"),rd=e=>CI("1234567890abcdef",e)(),MI=()=>`${rd(8)}-${rd(4)}-${rd(4)}-${rd(4)}-${rd(12)}`,BI={PAGE:"page"},PI={PAGE:"page"},UI=()=>new Or({name:"wp:simplePos",attributes:{x:{key:"x",value:0},y:{key:"y",value:0}}}),Oj=e=>new Or({name:"wp:align",children:[e]}),Fj=e=>new Or({name:"wp:posOffset",children:[e.toString()]}),zI=({relative:e,align:t,offset:r})=>new Or({name:"wp:positionH",attributes:{relativeFrom:{key:"relativeFrom",value:e??BI.PAGE}},children:[(()=>{if(t)return Oj(t);if(r!==void 0)return Fj(r);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]}),$I=({relative:e,align:t,offset:r})=>new Or({name:"wp:positionV",attributes:{relativeFrom:{key:"relativeFrom",value:e??PI.PAGE}},children:[(()=>{if(t)return Oj(t);if(r!==void 0)return Fj(r);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]});class qI extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{uri:"uri"})}}const HI=e=>new Or({name:"asvg:svgBlip",attributes:{asvg:{key:"xmlns:asvg",value:"http://schemas.microsoft.com/office/drawing/2016/SVG/main"},embed:{key:"r:embed",value:`rId{${e.fileName}}`}}}),WI=e=>new Or({name:"a:ext",attributes:{uri:{key:"uri",value:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"}},children:[HI(e)]}),GI=e=>new Or({name:"a:extLst",children:[WI(e)]}),VI=e=>new Or({name:"a:blip",attributes:{embed:{key:"r:embed",value:`rId{${e.type==="svg"?e.fallback.fileName:e.fileName}}`},cstate:{key:"cstate",value:"none"}},children:e.type==="svg"?[GI(e)]:[]});class KI extends et{constructor(){super("a:srcRect")}}class XI extends et{constructor(){super("a:fillRect")}}class YI extends et{constructor(){super("a:stretch"),this.root.push(new XI)}}class JI extends et{constructor(t){super("pic:blipFill"),this.root.push(VI(t)),this.root.push(new KI),this.root.push(new YI)}}class ZI extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{noChangeAspect:"noChangeAspect",noChangeArrowheads:"noChangeArrowheads"})}}class QI extends et{constructor(){super("a:picLocks"),this.root.push(new ZI({noChangeAspect:1,noChangeArrowheads:1}))}}class eM extends et{constructor(){super("pic:cNvPicPr"),this.root.push(new QI)}}const Lj=(e,t)=>new Or({name:"a:hlinkClick",attributes:Ei(rr({},t?{xmlns:{key:"xmlns:a",value:"http://schemas.openxmlformats.org/drawingml/2006/main"}}:{}),{id:{key:"r:id",value:`rId${e}`}})});class tM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{id:"id",name:"name",descr:"descr"})}}class rM extends et{constructor(){super("pic:cNvPr"),this.root.push(new tM({id:0,name:"",descr:""}))}prepForXml(t){for(let r=t.stack.length-1;r>=0;r--){const s=t.stack[r];if(s instanceof Ov){this.root.push(Lj(s.linkId,!1));break}}return super.prepForXml(t)}}class sM extends et{constructor(){super("pic:nvPicPr"),this.root.push(new rM),this.root.push(new eM)}}class aM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{xmlns:"xmlns:pic"})}}class nM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{cx:"cx",cy:"cy"})}}class iM extends et{constructor(t,r){super("a:ext"),Ze(this,"attributes"),this.attributes=new nM({cx:t,cy:r}),this.root.push(this.attributes)}}class oM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{x:"x",y:"y"})}}class lM extends et{constructor(){super("a:off"),this.root.push(new oM({x:0,y:0}))}}class cM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{flipVertical:"flipV",flipHorizontal:"flipH",rotation:"rot"})}}class uM extends et{constructor(t){var r,s;super("a:xfrm"),Ze(this,"extents"),this.root.push(new cM({flipVertical:(r=t.flip)==null?void 0:r.vertical,flipHorizontal:(s=t.flip)==null?void 0:s.horizontal,rotation:t.rotation})),this.extents=new iM(t.emus.x,t.emus.y),this.root.push(new lM),this.root.push(this.extents)}}const Ij=()=>new Or({name:"a:noFill"}),dM=e=>new Or({name:"a:srgbClr",attributes:{value:{key:"val",value:e.value}}}),fM=e=>new Or({name:"a:schemeClr",attributes:{value:{key:"val",value:e.value}}}),cS=e=>new Or({name:"a:solidFill",children:[e.type==="rgb"?dM(e):fM(e)]}),hM=e=>new Or({name:"a:ln",attributes:{width:{key:"w",value:e.width},cap:{key:"cap",value:e.cap},compoundLine:{key:"cmpd",value:e.compoundLine},align:{key:"algn",value:e.align}},children:[e.type==="noFill"?Ij():e.solidFillType==="rgb"?cS({type:"rgb",value:e.value}):cS({type:"scheme",value:e.value})]});class mM extends et{constructor(){super("a:avLst")}}class pM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{prst:"prst"})}}class xM extends et{constructor(){super("a:prstGeom"),this.root.push(new pM({prst:"rect"})),this.root.push(new mM)}}class gM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{bwMode:"bwMode"})}}class yM extends et{constructor({outline:t,transform:r}){super("pic:spPr"),Ze(this,"form"),this.root.push(new gM({bwMode:"auto"})),this.form=new uM(r),this.root.push(this.form),this.root.push(new xM),t&&(this.root.push(Ij()),this.root.push(hM(t)))}}class vM extends et{constructor({mediaData:t,transform:r,outline:s}){super("pic:pic"),this.root.push(new aM({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.root.push(new sM),this.root.push(new JI(t)),this.root.push(new yM({transform:r,outline:s}))}}class bM extends et{constructor({mediaData:t,transform:r,outline:s}){super("a:graphicData"),Ze(this,"pic"),this.root.push(new qI({uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.pic=new vM({mediaData:t,transform:r,outline:s}),this.root.push(this.pic)}}class wM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{a:"xmlns:a"})}}class Mj extends et{constructor({mediaData:t,transform:r,outline:s}){super("a:graphic"),Ze(this,"data"),this.root.push(new wM({a:"http://schemas.openxmlformats.org/drawingml/2006/main"})),this.data=new bM({mediaData:t,transform:r,outline:s}),this.root.push(this.data)}}const Vh={NONE:0,SQUARE:1,TIGHT:2,TOP_AND_BOTTOM:3},_M={BOTH_SIDES:"bothSides"};class uS extends et{constructor(){super("wp:wrapNone")}}class NM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",wrapText:"wrapText"})}}class kM extends et{constructor(t,r={top:0,bottom:0,left:0,right:0}){super("wp:wrapSquare"),this.root.push(new NM({wrapText:t.side||_M.BOTH_SIDES,distT:r.top,distB:r.bottom,distL:r.left,distR:r.right}))}}class SM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{distT:"distT",distB:"distB"})}}class EM extends et{constructor(t={top:0,bottom:0}){super("wp:wrapTight"),this.root.push(new SM({distT:t.top,distB:t.bottom}))}}class jM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{distT:"distT",distB:"distB"})}}class TM extends et{constructor(t={top:0,bottom:0}){super("wp:wrapTopAndBottom"),this.root.push(new jM({distT:t.top,distB:t.bottom}))}}class Bj extends et{constructor({name:t,description:r,title:s}={name:"",description:"",title:""}){super("wp:docPr"),Ze(this,"docPropertiesUniqueNumericId",FI());const n={id:{key:"id",value:this.docPropertiesUniqueNumericId()},name:{key:"name",value:t}};r!=null&&(n.description={key:"descr",value:r}),s!=null&&(n.title={key:"title",value:s}),this.root.push(new Ri(n))}prepForXml(t){for(let r=t.stack.length-1;r>=0;r--){const s=t.stack[r];if(s instanceof Ov){this.root.push(Lj(s.linkId,!0));break}}return super.prepForXml(t)}}const Pj=({top:e,right:t,bottom:r,left:s})=>new Or({name:"wp:effectExtent",attributes:{top:{key:"t",value:e},right:{key:"r",value:t},bottom:{key:"b",value:r},left:{key:"l",value:s}}}),Uj=({x:e,y:t})=>new Or({name:"wp:extent",attributes:{x:{key:"cx",value:e},y:{key:"cy",value:t}}});class AM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{xmlns:"xmlns:a",noChangeAspect:"noChangeAspect"})}}class CM extends et{constructor(){super("a:graphicFrameLocks"),this.root.push(new AM({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:1}))}}const zj=()=>new Or({name:"wp:cNvGraphicFramePr",children:[new CM]});class RM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",allowOverlap:"allowOverlap",behindDoc:"behindDoc",layoutInCell:"layoutInCell",locked:"locked",relativeHeight:"relativeHeight",simplePos:"simplePos"})}}class DM extends et{constructor({mediaData:t,transform:r,drawingOptions:s}){super("wp:anchor");const n=rr({allowOverlap:!0,behindDocument:!1,lockAnchor:!1,layoutInCell:!0,verticalPosition:{},horizontalPosition:{}},s.floating);if(this.root.push(new RM({distT:n.margins&&n.margins.top||0,distB:n.margins&&n.margins.bottom||0,distL:n.margins&&n.margins.left||0,distR:n.margins&&n.margins.right||0,simplePos:"0",allowOverlap:n.allowOverlap===!0?"1":"0",behindDoc:n.behindDocument===!0?"1":"0",locked:n.lockAnchor===!0?"1":"0",layoutInCell:n.layoutInCell===!0?"1":"0",relativeHeight:n.zIndex?n.zIndex:r.emus.y})),this.root.push(UI()),this.root.push(zI(n.horizontalPosition)),this.root.push($I(n.verticalPosition)),this.root.push(Uj({x:r.emus.x,y:r.emus.y})),this.root.push(Pj({top:0,right:0,bottom:0,left:0})),s.floating!==void 0&&s.floating.wrap!==void 0)switch(s.floating.wrap.type){case Vh.SQUARE:this.root.push(new kM(s.floating.wrap,s.floating.margins));break;case Vh.TIGHT:this.root.push(new EM(s.floating.margins));break;case Vh.TOP_AND_BOTTOM:this.root.push(new TM(s.floating.margins));break;case Vh.NONE:default:this.root.push(new uS)}else this.root.push(new uS);this.root.push(new Bj(s.docProperties)),this.root.push(zj()),this.root.push(new Mj({mediaData:t,transform:r,outline:s.outline}))}}const OM=({mediaData:e,transform:t,docProperties:r,outline:s})=>{var n,o,l,u;return new Or({name:"wp:inline",attributes:{distanceTop:{key:"distT",value:0},distanceBottom:{key:"distB",value:0},distanceLeft:{key:"distL",value:0},distanceRight:{key:"distR",value:0}},children:[Uj({x:t.emus.x,y:t.emus.y}),Pj(s?{top:((n=s.width)!=null?n:9525)*2,right:((o=s.width)!=null?o:9525)*2,bottom:((l=s.width)!=null?l:9525)*2,left:((u=s.width)!=null?u:9525)*2}:{top:0,right:0,bottom:0,left:0}),new Bj(r),zj(),new Mj({mediaData:e,transform:t,outline:s})]})};class FM extends et{constructor(t,r={}){super("w:drawing"),r.floating?this.root.push(new DM({mediaData:t,transform:t.transformation,drawingOptions:r})):this.root.push(OM({mediaData:t,transform:t.transformation,docProperties:r.docProperties,outline:r.outline}))}}const LM=e=>{if(typeof atob=="function"){const t=";base64,",r=e.indexOf(t),s=r===-1?0:r+t.length;return new Uint8Array(atob(e.substring(s)).split("").map(n=>n.charCodeAt(0)))}else{const t=require("buffer");return new t.Buffer(e,"base64")}},IM=e=>typeof e=="string"?LM(e):e,H1=(e,t)=>({data:IM(e.data),fileName:t,transformation:{pixels:{x:Math.round(e.transformation.width),y:Math.round(e.transformation.height)},emus:{x:Math.round(e.transformation.width*9525),y:Math.round(e.transformation.height*9525)},flip:e.transformation.flip,rotation:e.transformation.rotation?e.transformation.rotation*6e4:void 0}});class dS extends cf{constructor(t){super({}),Ze(this,"imageData");const s=`${lS(t.data)}.${t.type}`;this.imageData=t.type==="svg"?Ei(rr({type:t.type},H1(t,s)),{fallback:rr({type:t.fallback.type},H1(Ei(rr({},t.fallback),{transformation:t.transformation}),`${lS(t.fallback.data)}.${t.fallback.type}`))}):rr({type:t.type},H1(t,s));const n=new FM(this.imageData,{floating:t.floating,docProperties:t.altText,outline:t.outline});this.root.push(n)}prepForXml(t){return t.file.Media.addImage(this.imageData.fileName,this.imageData),this.imageData.type==="svg"&&t.file.Media.addImage(this.imageData.fallback.fileName,this.imageData.fallback),super.prepForXml(t)}}class MM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{xmlns:"xmlns"})}}class BM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}}const PM={EXTERNAL:"External"};class UM extends et{constructor(t,r,s,n){super("Relationship"),this.root.push(new BM({id:t,type:r,target:s,targetMode:n}))}}class El extends et{constructor(){super("Relationships"),this.root.push(new MM({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(t,r,s,n){const o=new UM(`rId${t}`,r,s,n);return this.root.push(o),o}get RelationshipCount(){return this.root.length-1}}class zM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}}class $M extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}}class qM extends et{constructor({id:t,initials:r,author:s,date:n=new Date,children:o}){super("w:comment"),this.root.push(new zM({id:t,initials:r,author:s,date:n.toISOString()}));for(const l of o)this.root.push(l)}}class HM extends et{constructor({children:t}){super("w:comments"),Ze(this,"relationships"),this.root.push(new $M({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(const r of t)this.root.push(new qM(r));this.relationships=new El}get Relationships(){return this.relationships}}class WM extends et{constructor(){super("w:pageBreakBefore")}}const zy={AUTO:"auto"};class GM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule",beforeAutoSpacing:"w:beforeAutospacing",afterAutoSpacing:"w:afterAutospacing"})}}class VM extends et{constructor(t){super("w:spacing"),this.root.push(new GM(t))}}let Kh=class extends et{constructor(t){super("w:pStyle"),this.root.push(new us({val:t}))}};class KM extends et{constructor(t){super("w:tabs");for(const r of t)this.root.push(new YM(r))}}const fS={LEFT:"left",RIGHT:"right"};class XM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}}class YM extends et{constructor({type:t,position:r,leader:s}){super("w:tab"),this.root.push(new XM({val:t,pos:r,leader:s}))}}class W1 extends et{constructor(t,r){super("w:numPr"),this.root.push(new JM(r)),this.root.push(new ZM(t))}}class JM extends et{constructor(t){if(super("w:ilvl"),t>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new us({val:t}))}}class ZM extends et{constructor(t){super("w:numId"),this.root.push(new us({val:typeof t=="string"?`{${t}}`:t}))}}class $j extends et{constructor(){super(...arguments),Ze(this,"fileChild",Symbol())}}class QM extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}}class Ov extends et{constructor(t,r,s){super("w:hyperlink"),Ze(this,"linkId"),this.linkId=r;const n={history:1,anchor:s||void 0,id:s?void 0:`rId${this.linkId}`},o=new QM(n);this.root.push(o),t.forEach(l=>{this.root.push(l)})}}class eB extends et{constructor(t){super("w:externalHyperlink"),this.options=t}}class tB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{id:"w:id",name:"w:name"})}}class rB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{id:"w:id"})}}class sB{constructor(t){Ze(this,"bookmarkUniqueNumericId",LI()),Ze(this,"start"),Ze(this,"children"),Ze(this,"end");const r=this.bookmarkUniqueNumericId();this.start=new aB(t.id,r),this.children=t.children,this.end=new nB(r)}}class aB extends et{constructor(t,r){super("w:bookmarkStart");const s=new tB({name:t,id:r});this.root.push(s)}}class nB extends et{constructor(t){super("w:bookmarkEnd");const r=new rB({id:t});this.root.push(r)}}class iB extends et{constructor(t){super("w:outlineLvl"),this.level=t,this.root.push(new us({val:t}))}}const oB={TOP:"top",CENTER:"center",BOTTOM:"bottom"};Ei(rr({},oB),{BOTH:"both"});class lB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{verticalAlign:"w:val"})}}class qj extends et{constructor(t){super("w:vAlign"),this.root.push(new lB({verticalAlign:t}))}}class cB extends et{constructor({space:t,count:r,separate:s,equalWidth:n,children:o}){super("w:cols"),this.root.push(new Ri({space:{key:"w:space",value:t===void 0?void 0:Xs(t)},count:{key:"w:num",value:r===void 0?void 0:la(r)},separate:{key:"w:sep",value:s},equalWidth:{key:"w:equalWidth",value:n}})),!n&&o&&o.forEach(l=>this.addChildElement(l))}}const uB=({type:e,linePitch:t,charSpace:r})=>new Or({name:"w:docGrid",attributes:{type:{key:"w:type",value:e},linePitch:{key:"w:linePitch",value:la(t)},charSpace:{key:"w:charSpace",value:r?la(r):void 0}}}),Mc={DEFAULT:"default",FIRST:"first",EVEN:"even"};class dB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{type:"w:type",id:"r:id"})}}const hS={HEADER:"w:headerReference",FOOTER:"w:footerReference"};class G1 extends et{constructor(t,r){super(t),this.root.push(new dB({type:r.type||Mc.DEFAULT,id:`rId${r.id}`}))}}const fB=({countBy:e,start:t,restart:r,distance:s})=>new Or({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:e===void 0?void 0:la(e)},start:{key:"w:start",value:t===void 0?void 0:la(t)},restart:{key:"w:restart",value:r},distance:{key:"w:distance",value:s===void 0?void 0:Xs(s)}}});class mS extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}}class hB extends Ci{constructor(t){if(super("w:pgBorders"),!t)return this;t.pageBorders?this.root.push(new mS({display:t.pageBorders.display,offsetFrom:t.pageBorders.offsetFrom,zOrder:t.pageBorders.zOrder})):this.root.push(new mS({})),t.pageBorderTop&&this.root.push(new Br("w:top",t.pageBorderTop)),t.pageBorderLeft&&this.root.push(new Br("w:left",t.pageBorderLeft)),t.pageBorderBottom&&this.root.push(new Br("w:bottom",t.pageBorderBottom)),t.pageBorderRight&&this.root.push(new Br("w:right",t.pageBorderRight))}}class mB extends et{constructor(t,r,s,n,o,l,u){super("w:pgMar"),this.root.push(new Ri({top:{key:"w:top",value:yi(t)},right:{key:"w:right",value:Xs(r)},bottom:{key:"w:bottom",value:yi(s)},left:{key:"w:left",value:Xs(n)},header:{key:"w:header",value:Xs(o)},footer:{key:"w:footer",value:Xs(l)},gutter:{key:"w:gutter",value:Xs(u)}}))}}class pB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}}class xB extends et{constructor({start:t,formatType:r,separator:s}){super("w:pgNumType"),this.root.push(new pB({start:t===void 0?void 0:la(t),formatType:r,separator:s}))}}const $y={PORTRAIT:"portrait",LANDSCAPE:"landscape"},gB=({width:e,height:t,orientation:r,code:s})=>{const n=Xs(e),o=Xs(t);return new Or({name:"w:pgSz",attributes:{width:{key:"w:w",value:r===$y.LANDSCAPE?o:n},height:{key:"w:h",value:r===$y.LANDSCAPE?n:o},orientation:{key:"w:orient",value:r},code:{key:"w:code",value:s}}})};class yB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{val:"w:val"})}}class vB extends et{constructor(t){super("w:textDirection"),this.root.push(new yB({val:t}))}}class bB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{val:"w:val"})}}class wB extends et{constructor(t){super("w:type"),this.root.push(new bB({val:t}))}}const Vo={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},V1={WIDTH:11906,HEIGHT:16838,ORIENTATION:$y.PORTRAIT};class _B extends et{constructor({page:{size:{width:t=V1.WIDTH,height:r=V1.HEIGHT,orientation:s=V1.ORIENTATION}={},margin:{top:n=Vo.TOP,right:o=Vo.RIGHT,bottom:l=Vo.BOTTOM,left:u=Vo.LEFT,header:d=Vo.HEADER,footer:h=Vo.FOOTER,gutter:m=Vo.GUTTER}={},pageNumbers:x={},borders:y,textDirection:b}={},grid:{linePitch:v=360,charSpace:g,type:_}={},headerWrapperGroup:w={},footerWrapperGroup:S={},lineNumbers:N,titlePage:E,verticalAlign:C,column:F,type:O}={}){super("w:sectPr"),this.addHeaderFooterGroup(hS.HEADER,w),this.addHeaderFooterGroup(hS.FOOTER,S),O&&this.root.push(new wB(O)),this.root.push(gB({width:t,height:r,orientation:s})),this.root.push(new mB(n,o,l,u,d,h,m)),y&&this.root.push(new hB(y)),N&&this.root.push(fB(N)),this.root.push(new xB(x)),F&&this.root.push(new cB(F)),C&&this.root.push(new qj(C)),E!==void 0&&this.root.push(new mt("w:titlePg",E)),b&&this.root.push(new vB(b)),this.root.push(uB({linePitch:v,charSpace:g,type:_}))}addHeaderFooterGroup(t,r){r.default&&this.root.push(new G1(t,{type:Mc.DEFAULT,id:r.default.View.ReferenceId})),r.first&&this.root.push(new G1(t,{type:Mc.FIRST,id:r.first.View.ReferenceId})),r.even&&this.root.push(new G1(t,{type:Mc.EVEN,id:r.even.View.ReferenceId}))}}class NB extends et{constructor(){super("w:body"),Ze(this,"sections",[])}addSection(t){const r=this.sections.pop();this.root.push(this.createSectionParagraph(r)),this.sections.push(new _B(t))}prepForXml(t){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(t)}push(t){this.root.push(t)}createSectionParagraph(t){const r=new ot({}),s=new Jc({});return s.push(t),r.addChildElement(s),r}}const pS={wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"};class hm extends Ct{constructor(t,r){super(rr({Ignorable:r},Object.fromEntries(t.map(s=>[s,pS[s]])))),Ze(this,"xmlKeys",rr({Ignorable:"mc:Ignorable"},Object.fromEntries(Object.keys(pS).map(s=>[s,`xmlns:${s}`]))))}}class kB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}}class SB extends et{constructor(t){super("w:background"),this.root.push(new kB({color:t.color===void 0?void 0:Kc(t.color),themeColor:t.themeColor,themeShade:t.themeShade===void 0?void 0:Gk(t.themeShade),themeTint:t.themeTint===void 0?void 0:Gk(t.themeTint)}))}}class EB extends et{constructor(t){super("w:document"),Ze(this,"body"),this.root.push(new hm(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps","cx","cx1","cx2","cx3","cx4","cx5","cx6","cx7","cx8","aink","am3d","w16cex","w16cid","w16","w16sdtdh","w16se"],"w14 w15 wp14")),this.body=new NB,t.background&&this.root.push(new SB(t.background)),this.root.push(this.body)}add(t){return this.body.push(t),this}get Body(){return this.body}}class Hj{constructor(t){Ze(this,"document"),Ze(this,"relationships"),this.document=new EB(t),this.relationships=new El}get View(){return this.document}get Relationships(){return this.relationships}}class jB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{val:"w:val"})}}class TB extends et{constructor(){super("w:wordWrap"),this.root.push(new jB({val:0}))}}const AB=e=>{var t,r;return new Or({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:e.anchorLock},dropCap:{key:"w:dropCap",value:e.dropCap},width:{key:"w:w",value:e.width},height:{key:"w:h",value:e.height},x:{key:"w:x",value:e.position?e.position.x:void 0},y:{key:"w:y",value:e.position?e.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:e.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:e.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(t=e.space)==null?void 0:t.horizontal},spaceVertical:{key:"w:vSpace",value:(r=e.space)==null?void 0:r.vertical},rule:{key:"w:hRule",value:e.rule},alignmentX:{key:"w:xAlign",value:e.alignment?e.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:e.alignment?e.alignment.y:void 0},lines:{key:"w:lines",value:e.lines},wrap:{key:"w:wrap",value:e.wrap}}})};class Jc extends Ci{constructor(t){var r,s;if(super("w:pPr"),Ze(this,"numberingReferences",[]),!t)return this;t.heading&&this.push(new Kh(t.heading)),t.bullet&&this.push(new Kh("ListParagraph")),t.numbering&&!t.style&&!t.heading&&(t.numbering.custom||this.push(new Kh("ListParagraph"))),t.style&&this.push(new Kh(t.style)),t.keepNext!==void 0&&this.push(new mt("w:keepNext",t.keepNext)),t.keepLines!==void 0&&this.push(new mt("w:keepLines",t.keepLines)),t.pageBreakBefore&&this.push(new WM),t.frame&&this.push(AB(t.frame)),t.widowControl!==void 0&&this.push(new mt("w:widowControl",t.widowControl)),t.bullet&&this.push(new W1(1,t.bullet.level)),t.numbering?(this.numberingReferences.push({reference:t.numbering.reference,instance:(r=t.numbering.instance)!=null?r:0}),this.push(new W1(`${t.numbering.reference}-${(s=t.numbering.instance)!=null?s:0}`,t.numbering.level))):t.numbering===!1&&this.push(new W1(0,0)),t.border&&this.push(new ZL(t.border)),t.thematicBreak&&this.push(new QL),t.shading&&this.push(new dm(t.shading)),t.wordWrap&&this.push(new TB),t.overflowPunctuation&&this.push(new mt("w:overflowPunct",t.overflowPunctuation));const n=[...t.rightTabStop!==void 0?[{type:fS.RIGHT,position:t.rightTabStop}]:[],...t.tabStops?t.tabStops:[],...t.leftTabStop!==void 0?[{type:fS.LEFT,position:t.leftTabStop}]:[]];n.length>0&&this.push(new KM(n)),t.bidirectional!==void 0&&this.push(new mt("w:bidi",t.bidirectional)),t.spacing&&this.push(new VM(t.spacing)),t.indent&&this.push(new eI(t.indent)),t.contextualSpacing!==void 0&&this.push(new mt("w:contextualSpacing",t.contextualSpacing)),t.alignment&&this.push(new jj(t.alignment)),t.outlineLevel!==void 0&&this.push(new iB(t.outlineLevel)),t.suppressLineNumbers!==void 0&&this.push(new mt("w:suppressLineNumbers",t.suppressLineNumbers)),t.autoSpaceEastAsianText!==void 0&&this.push(new mt("w:autoSpaceDN",t.autoSpaceEastAsianText)),t.run&&this.push(new Sl(t.run))}push(t){this.root.push(t)}prepForXml(t){if(t.viewWrapper instanceof Hj)for(const r of this.numberingReferences)t.file.Numbering.createConcreteNumberingInstance(r.reference,r.instance);return super.prepForXml(t)}}class ot extends $j{constructor(t){if(super("w:p"),Ze(this,"properties"),typeof t=="string")return this.properties=new Jc({}),this.root.push(this.properties),this.root.push(new Dt(t)),this;if(this.properties=new Jc(t),this.root.push(this.properties),t.text&&this.root.push(new Dt(t.text)),t.children)for(const r of t.children){if(r instanceof sB){this.root.push(r.start);for(const s of r.children)this.root.push(s);this.root.push(r.end);continue}this.root.push(r)}}prepForXml(t){for(const r of this.root)if(r instanceof eB){const s=this.root.indexOf(r),n=new Ov(r.options.children,II());t.viewWrapper.Relationships.createRelationship(n.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",r.options.link,PM.EXTERNAL),this.root[s]=n}return super.prepForXml(t)}addRunToFront(t){return this.root.splice(1,0,t),this}}class CB extends et{constructor(t){super("w:tblGrid");for(const r of t)this.root.push(new RB(r))}}class RB extends et{constructor(t){super("w:gridCol"),t!==void 0&&this.root.push(new Ri({width:{key:"w:w",value:Xs(t)}}))}}const Wj={TABLE:"w:tblCellMar",TABLE_CELL:"w:tcMar"};class Gj extends Ci{constructor(t,{marginUnitType:r=Bt.DXA,top:s,left:n,bottom:o,right:l}){super(t),s!==void 0&&this.root.push(new al("w:top",{type:r,size:s})),n!==void 0&&this.root.push(new al("w:left",{type:r,size:n})),o!==void 0&&this.root.push(new al("w:bottom",{type:r,size:o})),l!==void 0&&this.root.push(new al("w:right",{type:r,size:l}))}}const Bt={AUTO:"auto",DXA:"dxa",PERCENTAGE:"pct"};class al extends et{constructor(t,{type:r=Bt.AUTO,size:s}){super(t);let n=s;r===Bt.PERCENTAGE&&typeof s=="number"&&(n=`${s}%`),this.root.push(new Ri({type:{key:"w:type",value:r},size:{key:"w:w",value:Ej(n)}}))}}class DB extends Ci{constructor(t){super("w:tcBorders"),t.top&&this.root.push(new Br("w:top",t.top)),t.start&&this.root.push(new Br("w:start",t.start)),t.left&&this.root.push(new Br("w:left",t.left)),t.bottom&&this.root.push(new Br("w:bottom",t.bottom)),t.end&&this.root.push(new Br("w:end",t.end)),t.right&&this.root.push(new Br("w:right",t.right))}}class OB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{val:"w:val"})}}class FB extends et{constructor(t){super("w:gridSpan"),this.root.push(new OB({val:la(t)}))}}const Vj={CONTINUE:"continue",RESTART:"restart"};class LB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{val:"w:val"})}}class xS extends et{constructor(t){super("w:vMerge"),this.root.push(new LB({val:t}))}}class IB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{val:"w:val"})}}class MB extends et{constructor(t){super("w:textDirection"),this.root.push(new IB({val:t}))}}class BB extends Ci{constructor(t){super("w:tcPr"),t.width&&this.root.push(new al("w:tcW",t.width)),t.columnSpan&&this.root.push(new FB(t.columnSpan)),t.verticalMerge?this.root.push(new xS(t.verticalMerge)):t.rowSpan&&t.rowSpan>1&&this.root.push(new xS(Vj.RESTART)),t.borders&&this.root.push(new DB(t.borders)),t.shading&&this.root.push(new dm(t.shading)),t.margins&&this.root.push(new Gj(Wj.TABLE_CELL,t.margins)),t.textDirection&&this.root.push(new MB(t.textDirection)),t.verticalAlign&&this.root.push(new qj(t.verticalAlign))}}class gt extends et{constructor(t){super("w:tc"),this.options=t,this.root.push(new BB(t));for(const r of t.children)this.root.push(r)}prepForXml(t){return this.root[this.root.length-1]instanceof ot||this.root.push(new ot({})),super.prepForXml(t)}}const vc={style:nr.NONE,size:0,color:"auto"},bc={style:nr.SINGLE,size:4,color:"auto"};class Kj extends et{constructor(t){super("w:tblBorders"),t.top?this.root.push(new Br("w:top",t.top)):this.root.push(new Br("w:top",bc)),t.left?this.root.push(new Br("w:left",t.left)):this.root.push(new Br("w:left",bc)),t.bottom?this.root.push(new Br("w:bottom",t.bottom)):this.root.push(new Br("w:bottom",bc)),t.right?this.root.push(new Br("w:right",t.right)):this.root.push(new Br("w:right",bc)),t.insideHorizontal?this.root.push(new Br("w:insideH",t.insideHorizontal)):this.root.push(new Br("w:insideH",bc)),t.insideVertical?this.root.push(new Br("w:insideV",t.insideVertical)):this.root.push(new Br("w:insideV",bc))}}Ze(Kj,"NONE",{top:vc,bottom:vc,left:vc,right:vc,insideHorizontal:vc,insideVertical:vc});class PB extends et{constructor({horizontalAnchor:t,verticalAnchor:r,absoluteHorizontalPosition:s,relativeHorizontalPosition:n,absoluteVerticalPosition:o,relativeVerticalPosition:l,bottomFromText:u,topFromText:d,leftFromText:h,rightFromText:m,overlap:x}){super("w:tblpPr"),this.root.push(new Ri({leftFromText:{key:"w:leftFromText",value:h===void 0?void 0:Xs(h)},rightFromText:{key:"w:rightFromText",value:m===void 0?void 0:Xs(m)},topFromText:{key:"w:topFromText",value:d===void 0?void 0:Xs(d)},bottomFromText:{key:"w:bottomFromText",value:u===void 0?void 0:Xs(u)},absoluteHorizontalPosition:{key:"w:tblpX",value:s===void 0?void 0:yi(s)},absoluteVerticalPosition:{key:"w:tblpY",value:o===void 0?void 0:yi(o)},horizontalAnchor:{key:"w:horzAnchor",value:t===void 0?void 0:t},relativeHorizontalPosition:{key:"w:tblpXSpec",value:n},relativeVerticalPosition:{key:"w:tblpYSpec",value:l},verticalAnchor:{key:"w:vertAnchor",value:r}})),x&&this.root.push(new XL("w:tblOverlap",x))}}class UB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{type:"w:type"})}}class zB extends et{constructor(t){super("w:tblLayout"),this.root.push(new UB({type:t}))}}const $B={DXA:"dxa"};class Xj extends et{constructor({type:t=$B.DXA,value:r}){super("w:tblCellSpacing"),this.root.push(new Ri({type:{key:"w:type",value:t},value:{key:"w:w",value:Ej(r)}}))}}class qB extends Ci{constructor(t){super("w:tblPr"),t.style&&this.root.push(new ol("w:tblStyle",t.style)),t.float&&this.root.push(new PB(t.float)),t.visuallyRightToLeft!==void 0&&this.root.push(new mt("w:bidiVisual",t.visuallyRightToLeft)),t.width&&this.root.push(new al("w:tblW",t.width)),t.alignment&&this.root.push(new jj(t.alignment)),t.indent&&this.root.push(new al("w:tblInd",t.indent)),t.borders&&this.root.push(new Kj(t.borders)),t.shading&&this.root.push(new dm(t.shading)),t.layout&&this.root.push(new zB(t.layout)),t.cellMargin&&this.root.push(new Gj(Wj.TABLE,t.cellMargin)),t.cellSpacing&&this.root.push(new Xj(t.cellSpacing))}}class Sa extends $j{constructor({rows:t,width:r,columnWidths:s=Array(Math.max(...t.map(b=>b.CellCount))).fill(100),margins:n,indent:o,float:l,layout:u,style:d,borders:h,alignment:m,visuallyRightToLeft:x,cellSpacing:y}){super("w:tbl"),this.root.push(new qB({borders:h??{},width:r??{size:100},indent:o,float:l,layout:u,style:d,alignment:m,cellMargin:n,visuallyRightToLeft:x,cellSpacing:y})),this.root.push(new CB(s));for(const b of t)this.root.push(b);t.forEach((b,v)=>{if(v===t.length-1)return;let g=0;b.cells.forEach(_=>{if(_.options.rowSpan&&_.options.rowSpan>1){const w=new gt({rowSpan:_.options.rowSpan-1,columnSpan:_.options.columnSpan,borders:_.options.borders,children:[],verticalMerge:Vj.CONTINUE});t[v+1].addCellToColumnIndex(w,g)}g+=_.options.columnSpan||1})})}}class HB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{value:"w:val",rule:"w:hRule"})}}class WB extends et{constructor(t,r){super("w:trHeight"),this.root.push(new HB({value:Xs(t),rule:r}))}}class GB extends Ci{constructor(t){super("w:trPr"),t.cantSplit!==void 0&&this.root.push(new mt("w:cantSplit",t.cantSplit)),t.tableHeader!==void 0&&this.root.push(new mt("w:tblHeader",t.tableHeader)),t.height&&this.root.push(new WB(t.height.value,t.height.rule)),t.cellSpacing&&this.root.push(new Xj(t.cellSpacing))}}class pr extends et{constructor(t){super("w:tr"),this.options=t,this.root.push(new GB(t));for(const r of t.children)this.root.push(r)}get CellCount(){return this.options.children.length}get cells(){return this.root.filter(t=>t instanceof gt)}addCellToIndex(t,r){this.root.splice(r+1,0,t)}addCellToColumnIndex(t,r){const s=this.columnIndexToRootIndex(r,!0);this.addCellToIndex(t,s-1)}rootIndexToColumnIndex(t){if(t<1||t>=this.root.length)throw new Error(`cell 'rootIndex' should between 1 to ${this.root.length-1}`);let r=0;for(let s=1;s<t;s++){const n=this.root[s];r+=n.options.columnSpan||1}return r}columnIndexToRootIndex(t,r=!1){if(t<0)throw new Error("cell 'columnIndex' should not less than zero");let s=0,n=1;for(;s<=t;){if(n>=this.root.length){if(r)return this.root.length;throw new Error(`cell 'columnIndex' should not great than ${s-1}`)}const o=this.root[n];n+=1,s+=o&&o.options.columnSpan||1}return n-1}}class VB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class KB extends et{constructor(){super("Properties"),this.root.push(new VB({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class XB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{xmlns:"xmlns"})}}class YB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}}class mi extends et{constructor(t,r){super("Default"),this.root.push(new YB({contentType:t,extension:r}))}}class JB extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}}class an extends et{constructor(t,r){super("Override"),this.root.push(new JB({contentType:t,partName:r}))}}class ZB extends et{constructor(){super("Types"),this.root.push(new XB({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new mi("image/png","png")),this.root.push(new mi("image/jpeg","jpeg")),this.root.push(new mi("image/jpeg","jpg")),this.root.push(new mi("image/bmp","bmp")),this.root.push(new mi("image/gif","gif")),this.root.push(new mi("image/svg+xml","svg")),this.root.push(new mi("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new mi("application/xml","xml")),this.root.push(new mi("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new an("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new an("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new an("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new an("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new an("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new an("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new an("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new an("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new an("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new an("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(t){this.root.push(new an("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${t}.xml`))}addHeader(t){this.root.push(new an("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${t}.xml`))}}class QB extends et{constructor(t){super("cp:coreProperties"),this.root.push(new hm(["cp","dc","dcterms","dcmitype","xsi"])),t.title&&this.root.push(new Wo("dc:title",t.title)),t.subject&&this.root.push(new Wo("dc:subject",t.subject)),t.creator&&this.root.push(new Wo("dc:creator",t.creator)),t.keywords&&this.root.push(new Wo("cp:keywords",t.keywords)),t.description&&this.root.push(new Wo("dc:description",t.description)),t.lastModifiedBy&&this.root.push(new Wo("cp:lastModifiedBy",t.lastModifiedBy)),t.revision&&this.root.push(new Wo("cp:revision",String(t.revision))),this.root.push(new gS("dcterms:created")),this.root.push(new gS("dcterms:modified"))}}class eP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{type:"xsi:type"})}}class gS extends et{constructor(t){super(t),this.root.push(new eP({type:"dcterms:W3CDTF"})),this.root.push(KL(new Date))}}class tP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class rP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}}class sP extends et{constructor(t,r){super("property"),this.root.push(new rP({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t.toString(),name:r.name})),this.root.push(new aP(r.value))}}class aP extends et{constructor(t){super("vt:lpwstr"),this.root.push(t)}}class nP extends et{constructor(t){super("Properties"),Ze(this,"nextId"),Ze(this,"properties",[]),this.root.push(new tP({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const r of t)this.addCustomProperty(r)}prepForXml(t){return this.properties.forEach(r=>this.root.push(r)),super.prepForXml(t)}addCustomProperty(t){this.properties.push(new sP(this.nextId++,t))}}const Xh=({id:e,fontKey:t,subsetted:r},s)=>new Or({name:s,attributes:rr({id:{key:"r:id",value:e}},t?{fontKey:{key:"w:fontKey",value:`{${t}}`}}:{}),children:[...r?[new mt("w:subsetted",r)]:[]]}),iP=({name:e,altName:t,panose1:r,charset:s,family:n,notTrueType:o,pitch:l,sig:u,embedRegular:d,embedBold:h,embedItalic:m,embedBoldItalic:x})=>new Or({name:"w:font",attributes:{name:{key:"w:name",value:e}},children:[...t?[td("w:altName",t)]:[],...r?[td("w:panose1",r)]:[],...s?[td("w:charset",s)]:[],td("w:family",n),...o?[new mt("w:notTrueType",o)]:[],td("w:pitch",l),...u?[new Or({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:u.usb0},usb1:{key:"w:usb1",value:u.usb1},usb2:{key:"w:usb2",value:u.usb2},usb3:{key:"w:usb3",value:u.usb3},csb0:{key:"w:csb0",value:u.csb0},csb1:{key:"w:csb1",value:u.csb1}}})]:[],...d?[Xh(d,"w:embedRegular")]:[],...h?[Xh(h,"w:embedBold")]:[],...m?[Xh(m,"w:embedItalic")]:[],...x?[Xh(x,"w:embedBoldItalic")]:[]]}),oP=({name:e,index:t,fontKey:r,characterSet:s})=>iP({name:e,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:s,family:"auto",pitch:"variable",embedRegular:{fontKey:r,id:`rId${t}`}}),lP=e=>new Or({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:e.map((t,r)=>oP({name:t.name,index:r+1,fontKey:t.fontKey}))});class cP{constructor(t){Ze(this,"fontTable"),Ze(this,"relationships"),Ze(this,"fontOptionsWithKey",[]),this.options=t,this.fontOptionsWithKey=t.map(r=>Ei(rr({},r),{fontKey:MI()})),this.fontTable=lP(this.fontOptionsWithKey),this.relationships=new El;for(let r=0;r<t.length;r++)this.relationships.createRelationship(r+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${t[r].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}}class uP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}}let dP=class extends Nj{constructor(t,r){super("w:ftr",r),Ze(this,"refId"),this.refId=t,r||this.root.push(new uP({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(t){this.root.push(t)}};class fP{constructor(t,r,s){Ze(this,"footer"),Ze(this,"relationships"),this.media=t,this.footer=new dP(r,s),this.relationships=new El}add(t){this.footer.add(t)}addChildElement(t){this.footer.addChildElement(t)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class hP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{type:"w:type",id:"w:id"})}}class mP extends et{constructor(){super("w:footnoteRef")}}class pP extends cf{constructor(){super({style:"FootnoteReference"}),this.root.push(new mP)}}const yS={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"};class K1 extends et{constructor(t){super("w:footnote"),this.root.push(new hP({type:t.type,id:t.id}));for(let r=0;r<t.children.length;r++){const s=t.children[r];r===0&&s.addRunToFront(new pP),this.root.push(s)}}}class xP extends et{constructor(){super("w:continuationSeparator")}}class gP extends cf{constructor(){super({}),this.root.push(new xP)}}class yP extends et{constructor(){super("w:separator")}}class vP extends cf{constructor(){super({}),this.root.push(new yP)}}class bP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class wP extends et{constructor(){super("w:footnotes"),this.root.push(new bP({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const t=new K1({id:-1,type:yS.SEPERATOR,children:[new ot({spacing:{after:0,line:240,lineRule:zy.AUTO},children:[new vP]})]});this.root.push(t);const r=new K1({id:0,type:yS.CONTINUATION_SEPERATOR,children:[new ot({spacing:{after:0,line:240,lineRule:zy.AUTO},children:[new gP]})]});this.root.push(r)}createFootNote(t,r){const s=new K1({id:t,children:r});this.root.push(s)}}class _P{constructor(){Ze(this,"footnotess"),Ze(this,"relationships"),this.footnotess=new wP,this.relationships=new El}get View(){return this.footnotess}get Relationships(){return this.relationships}}class NP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}}let kP=class extends Nj{constructor(t,r){super("w:hdr",r),Ze(this,"refId"),this.refId=t,r||this.root.push(new NP({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(t){this.root.push(t)}};class SP{constructor(t,r,s){Ze(this,"header"),Ze(this,"relationships"),this.media=t,this.header=new kP(r,s),this.relationships=new El}add(t){return this.header.add(t),this}addChildElement(t){this.header.addChildElement(t)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class EP{constructor(){Ze(this,"map"),this.map=new Map}addImage(t,r){this.map.set(t,r)}get Array(){return Array.from(this.map.values())}}const pi={BULLET:"bullet"};class jP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}}class TP extends et{constructor(t){super("w:numFmt"),this.root.push(new us({val:t}))}}class AP extends et{constructor(t){super("w:lvlText"),this.root.push(new us({val:t}))}}class CP extends et{constructor(t){super("w:lvlJc"),this.root.push(new us({val:t}))}}class RP extends et{constructor(t){super("w:suff"),this.root.push(new us({val:t}))}}class DP extends et{constructor(){super("w:isLgl")}}class OP extends et{constructor({level:t,format:r,text:s,alignment:n=Ft.START,start:o=1,style:l,suffix:u,isLegalNumberingStyle:d}){if(super("w:lvl"),Ze(this,"paragraphProperties"),Ze(this,"runProperties"),this.root.push(new gd("w:start",la(o))),r&&this.root.push(new TP(r)),u&&this.root.push(new RP(u)),d&&this.root.push(new DP),s&&this.root.push(new AP(s)),this.root.push(new CP(n)),this.paragraphProperties=new Jc(l&&l.paragraph),this.runProperties=new Sl(l&&l.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),t>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new jP({ilvl:la(t),tentative:1}))}}class FP extends OP{}class LP extends et{constructor(t){super("w:multiLevelType"),this.root.push(new us({val:t}))}}class IP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}}class vS extends et{constructor(t,r){super("w:abstractNum"),Ze(this,"id"),this.root.push(new IP({abstractNumId:la(t),restartNumberingAfterBreak:0})),this.root.push(new LP("hybridMultilevel")),this.id=t;for(const s of r)this.root.push(new FP(s))}}class MP extends et{constructor(t){super("w:abstractNumId"),this.root.push(new us({val:t}))}}class BP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{numId:"w:numId"})}}class bS extends et{constructor(t){if(super("w:num"),Ze(this,"numId"),Ze(this,"reference"),Ze(this,"instance"),this.numId=t.numId,this.reference=t.reference,this.instance=t.instance,this.root.push(new BP({numId:la(t.numId)})),this.root.push(new MP(la(t.abstractNumId))),t.overrideLevels&&t.overrideLevels.length)for(const r of t.overrideLevels)this.root.push(new UP(r.num,r.start))}}class PP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{ilvl:"w:ilvl"})}}class UP extends et{constructor(t,r){super("w:lvlOverride"),this.root.push(new PP({ilvl:t})),r!==void 0&&this.root.push(new $P(r))}}class zP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{val:"w:val"})}}class $P extends et{constructor(t){super("w:startOverride"),this.root.push(new zP({val:t}))}}class qP extends et{constructor(t){super("w:numbering"),Ze(this,"abstractNumberingMap",new Map),Ze(this,"concreteNumberingMap",new Map),Ze(this,"referenceConfigMap",new Map),Ze(this,"abstractNumUniqueNumericId",DI()),Ze(this,"concreteNumUniqueNumericId",OI()),this.root.push(new hm(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps"],"w14 w15 wp14"));const r=new vS(this.abstractNumUniqueNumericId(),[{level:0,format:pi.BULLET,text:"",alignment:Ft.LEFT,style:{paragraph:{indent:{left:kr(.5),hanging:kr(.25)}}}},{level:1,format:pi.BULLET,text:"",alignment:Ft.LEFT,style:{paragraph:{indent:{left:kr(1),hanging:kr(.25)}}}},{level:2,format:pi.BULLET,text:"",alignment:Ft.LEFT,style:{paragraph:{indent:{left:2160,hanging:kr(.25)}}}},{level:3,format:pi.BULLET,text:"",alignment:Ft.LEFT,style:{paragraph:{indent:{left:2880,hanging:kr(.25)}}}},{level:4,format:pi.BULLET,text:"",alignment:Ft.LEFT,style:{paragraph:{indent:{left:3600,hanging:kr(.25)}}}},{level:5,format:pi.BULLET,text:"",alignment:Ft.LEFT,style:{paragraph:{indent:{left:4320,hanging:kr(.25)}}}},{level:6,format:pi.BULLET,text:"",alignment:Ft.LEFT,style:{paragraph:{indent:{left:5040,hanging:kr(.25)}}}},{level:7,format:pi.BULLET,text:"",alignment:Ft.LEFT,style:{paragraph:{indent:{left:5760,hanging:kr(.25)}}}},{level:8,format:pi.BULLET,text:"",alignment:Ft.LEFT,style:{paragraph:{indent:{left:6480,hanging:kr(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new bS({numId:1,abstractNumId:r.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",r);for(const s of t.config)this.abstractNumberingMap.set(s.reference,new vS(this.abstractNumUniqueNumericId(),s.levels)),this.referenceConfigMap.set(s.reference,s.levels)}prepForXml(t){for(const r of this.abstractNumberingMap.values())this.root.push(r);for(const r of this.concreteNumberingMap.values())this.root.push(r);return super.prepForXml(t)}createConcreteNumberingInstance(t,r){const s=this.abstractNumberingMap.get(t);if(!s)return;const n=`${t}-${r}`;if(this.concreteNumberingMap.has(n))return;const o=this.referenceConfigMap.get(t),l=o&&o[0].start,u={numId:this.concreteNumUniqueNumericId(),abstractNumId:s.id,reference:t,instance:r,overrideLevels:[l&&Number.isInteger(l)?{num:0,start:l}:{num:0,start:1}]};this.concreteNumberingMap.set(n,new bS(u))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class HP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}}class WP extends et{constructor(t){super("w:compatSetting"),this.root.push(new HP({version:t,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class GP extends et{constructor(t){super("w:compat"),t.version&&this.root.push(new WP(t.version)),t.useSingleBorderforContiguousCells&&this.root.push(new mt("w:useSingleBorderforContiguousCells",t.useSingleBorderforContiguousCells)),t.wordPerfectJustification&&this.root.push(new mt("w:wpJustification",t.wordPerfectJustification)),t.noTabStopForHangingIndent&&this.root.push(new mt("w:noTabHangInd",t.noTabStopForHangingIndent)),t.noLeading&&this.root.push(new mt("w:noLeading",t.noLeading)),t.spaceForUnderline&&this.root.push(new mt("w:spaceForUL",t.spaceForUnderline)),t.noColumnBalance&&this.root.push(new mt("w:noColumnBalance",t.noColumnBalance)),t.balanceSingleByteDoubleByteWidth&&this.root.push(new mt("w:balanceSingleByteDoubleByteWidth",t.balanceSingleByteDoubleByteWidth)),t.noExtraLineSpacing&&this.root.push(new mt("w:noExtraLineSpacing",t.noExtraLineSpacing)),t.doNotLeaveBackslashAlone&&this.root.push(new mt("w:doNotLeaveBackslashAlone",t.doNotLeaveBackslashAlone)),t.underlineTrailingSpaces&&this.root.push(new mt("w:ulTrailSpace",t.underlineTrailingSpaces)),t.doNotExpandShiftReturn&&this.root.push(new mt("w:doNotExpandShiftReturn",t.doNotExpandShiftReturn)),t.spacingInWholePoints&&this.root.push(new mt("w:spacingInWholePoints",t.spacingInWholePoints)),t.lineWrapLikeWord6&&this.root.push(new mt("w:lineWrapLikeWord6",t.lineWrapLikeWord6)),t.printBodyTextBeforeHeader&&this.root.push(new mt("w:printBodyTextBeforeHeader",t.printBodyTextBeforeHeader)),t.printColorsBlack&&this.root.push(new mt("w:printColBlack",t.printColorsBlack)),t.spaceWidth&&this.root.push(new mt("w:wpSpaceWidth",t.spaceWidth)),t.showBreaksInFrames&&this.root.push(new mt("w:showBreaksInFrames",t.showBreaksInFrames)),t.subFontBySize&&this.root.push(new mt("w:subFontBySize",t.subFontBySize)),t.suppressBottomSpacing&&this.root.push(new mt("w:suppressBottomSpacing",t.suppressBottomSpacing)),t.suppressTopSpacing&&this.root.push(new mt("w:suppressTopSpacing",t.suppressTopSpacing)),t.suppressSpacingAtTopOfPage&&this.root.push(new mt("w:suppressSpacingAtTopOfPage",t.suppressSpacingAtTopOfPage)),t.suppressTopSpacingWP&&this.root.push(new mt("w:suppressTopSpacingWP",t.suppressTopSpacingWP)),t.suppressSpBfAfterPgBrk&&this.root.push(new mt("w:suppressSpBfAfterPgBrk",t.suppressSpBfAfterPgBrk)),t.swapBordersFacingPages&&this.root.push(new mt("w:swapBordersFacingPages",t.swapBordersFacingPages)),t.convertMailMergeEsc&&this.root.push(new mt("w:convMailMergeEsc",t.convertMailMergeEsc)),t.truncateFontHeightsLikeWP6&&this.root.push(new mt("w:truncateFontHeightsLikeWP6",t.truncateFontHeightsLikeWP6)),t.macWordSmallCaps&&this.root.push(new mt("w:mwSmallCaps",t.macWordSmallCaps)),t.usePrinterMetrics&&this.root.push(new mt("w:usePrinterMetrics",t.usePrinterMetrics)),t.doNotSuppressParagraphBorders&&this.root.push(new mt("w:doNotSuppressParagraphBorders",t.doNotSuppressParagraphBorders)),t.wrapTrailSpaces&&this.root.push(new mt("w:wrapTrailSpaces",t.wrapTrailSpaces)),t.footnoteLayoutLikeWW8&&this.root.push(new mt("w:footnoteLayoutLikeWW8",t.footnoteLayoutLikeWW8)),t.shapeLayoutLikeWW8&&this.root.push(new mt("w:shapeLayoutLikeWW8",t.shapeLayoutLikeWW8)),t.alignTablesRowByRow&&this.root.push(new mt("w:alignTablesRowByRow",t.alignTablesRowByRow)),t.forgetLastTabAlignment&&this.root.push(new mt("w:forgetLastTabAlignment",t.forgetLastTabAlignment)),t.adjustLineHeightInTable&&this.root.push(new mt("w:adjustLineHeightInTable",t.adjustLineHeightInTable)),t.autoSpaceLikeWord95&&this.root.push(new mt("w:autoSpaceLikeWord95",t.autoSpaceLikeWord95)),t.noSpaceRaiseLower&&this.root.push(new mt("w:noSpaceRaiseLower",t.noSpaceRaiseLower)),t.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new mt("w:doNotUseHTMLParagraphAutoSpacing",t.doNotUseHTMLParagraphAutoSpacing)),t.layoutRawTableWidth&&this.root.push(new mt("w:layoutRawTableWidth",t.layoutRawTableWidth)),t.layoutTableRowsApart&&this.root.push(new mt("w:layoutTableRowsApart",t.layoutTableRowsApart)),t.useWord97LineBreakRules&&this.root.push(new mt("w:useWord97LineBreakRules",t.useWord97LineBreakRules)),t.doNotBreakWrappedTables&&this.root.push(new mt("w:doNotBreakWrappedTables",t.doNotBreakWrappedTables)),t.doNotSnapToGridInCell&&this.root.push(new mt("w:doNotSnapToGridInCell",t.doNotSnapToGridInCell)),t.selectFieldWithFirstOrLastCharacter&&this.root.push(new mt("w:selectFldWithFirstOrLastChar",t.selectFieldWithFirstOrLastCharacter)),t.applyBreakingRules&&this.root.push(new mt("w:applyBreakingRules",t.applyBreakingRules)),t.doNotWrapTextWithPunctuation&&this.root.push(new mt("w:doNotWrapTextWithPunct",t.doNotWrapTextWithPunctuation)),t.doNotUseEastAsianBreakRules&&this.root.push(new mt("w:doNotUseEastAsianBreakRules",t.doNotUseEastAsianBreakRules)),t.useWord2002TableStyleRules&&this.root.push(new mt("w:useWord2002TableStyleRules",t.useWord2002TableStyleRules)),t.growAutofit&&this.root.push(new mt("w:growAutofit",t.growAutofit)),t.useFELayout&&this.root.push(new mt("w:useFELayout",t.useFELayout)),t.useNormalStyleForList&&this.root.push(new mt("w:useNormalStyleForList",t.useNormalStyleForList)),t.doNotUseIndentAsNumberingTabStop&&this.root.push(new mt("w:doNotUseIndentAsNumberingTabStop",t.doNotUseIndentAsNumberingTabStop)),t.useAlternateEastAsianLineBreakRules&&this.root.push(new mt("w:useAltKinsokuLineBreakRules",t.useAlternateEastAsianLineBreakRules)),t.allowSpaceOfSameStyleInTable&&this.root.push(new mt("w:allowSpaceOfSameStyleInTable",t.allowSpaceOfSameStyleInTable)),t.doNotSuppressIndentation&&this.root.push(new mt("w:doNotSuppressIndentation",t.doNotSuppressIndentation)),t.doNotAutofitConstrainedTables&&this.root.push(new mt("w:doNotAutofitConstrainedTables",t.doNotAutofitConstrainedTables)),t.autofitToFirstFixedWidthCell&&this.root.push(new mt("w:autofitToFirstFixedWidthCell",t.autofitToFirstFixedWidthCell)),t.underlineTabInNumberingList&&this.root.push(new mt("w:underlineTabInNumList",t.underlineTabInNumberingList)),t.displayHangulFixedWidth&&this.root.push(new mt("w:displayHangulFixedWidth",t.displayHangulFixedWidth)),t.splitPgBreakAndParaMark&&this.root.push(new mt("w:splitPgBreakAndParaMark",t.splitPgBreakAndParaMark)),t.doNotVerticallyAlignCellWithSp&&this.root.push(new mt("w:doNotVertAlignCellWithSp",t.doNotVerticallyAlignCellWithSp)),t.doNotBreakConstrainedForcedTable&&this.root.push(new mt("w:doNotBreakConstrainedForcedTable",t.doNotBreakConstrainedForcedTable)),t.ignoreVerticalAlignmentInTextboxes&&this.root.push(new mt("w:doNotVertAlignInTxbx",t.ignoreVerticalAlignmentInTextboxes)),t.useAnsiKerningPairs&&this.root.push(new mt("w:useAnsiKerningPairs",t.useAnsiKerningPairs)),t.cachedColumnBalance&&this.root.push(new mt("w:cachedColBalance",t.cachedColumnBalance))}}class VP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class KP extends et{constructor(t){var r,s,n,o,l,u,d,h;super("w:settings"),this.root.push(new VP({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new mt("w:displayBackgroundShape",!0)),t.trackRevisions!==void 0&&this.root.push(new mt("w:trackRevisions",t.trackRevisions)),t.evenAndOddHeaders!==void 0&&this.root.push(new mt("w:evenAndOddHeaders",t.evenAndOddHeaders)),t.updateFields!==void 0&&this.root.push(new mt("w:updateFields",t.updateFields)),t.defaultTabStop!==void 0&&this.root.push(new gd("w:defaultTabStop",t.defaultTabStop)),((r=t.hyphenation)==null?void 0:r.autoHyphenation)!==void 0&&this.root.push(new mt("w:autoHyphenation",t.hyphenation.autoHyphenation)),((s=t.hyphenation)==null?void 0:s.hyphenationZone)!==void 0&&this.root.push(new gd("w:hyphenationZone",t.hyphenation.hyphenationZone)),((n=t.hyphenation)==null?void 0:n.consecutiveHyphenLimit)!==void 0&&this.root.push(new gd("w:consecutiveHyphenLimit",t.hyphenation.consecutiveHyphenLimit)),((o=t.hyphenation)==null?void 0:o.doNotHyphenateCaps)!==void 0&&this.root.push(new mt("w:doNotHyphenateCaps",t.hyphenation.doNotHyphenateCaps)),this.root.push(new GP(Ei(rr({},(l=t.compatibility)!=null?l:{}),{version:(h=(d=(u=t.compatibility)==null?void 0:u.version)!=null?d:t.compatibilityModeVersion)!=null?h:15})))}}class Yj extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{val:"w:val"})}}class XP extends et{constructor(t){super("w:name"),this.root.push(new Yj({val:t}))}}class YP extends et{constructor(t){super("w:uiPriority"),this.root.push(new Yj({val:la(t)}))}}class JP extends Ct{constructor(){super(...arguments),Ze(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}}class Jj extends et{constructor(t,r){super("w:style"),this.root.push(new JP(t)),r.name&&this.root.push(new XP(r.name)),r.basedOn&&this.root.push(new ol("w:basedOn",r.basedOn)),r.next&&this.root.push(new ol("w:next",r.next)),r.link&&this.root.push(new ol("w:link",r.link)),r.uiPriority!==void 0&&this.root.push(new YP(r.uiPriority)),r.semiHidden!==void 0&&this.root.push(new mt("w:semiHidden",r.semiHidden)),r.unhideWhenUsed!==void 0&&this.root.push(new mt("w:unhideWhenUsed",r.unhideWhenUsed)),r.quickFormat!==void 0&&this.root.push(new mt("w:qFormat",r.quickFormat))}}class mm extends Jj{constructor(t){super({type:"paragraph",styleId:t.id},t),Ze(this,"paragraphProperties"),Ze(this,"runProperties"),this.paragraphProperties=new Jc(t.paragraph),this.runProperties=new Sl(t.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class pm extends Jj{constructor(t){super({type:"character",styleId:t.id},rr({uiPriority:99,unhideWhenUsed:!0},t)),Ze(this,"runProperties"),this.runProperties=new Sl(t.run),this.root.push(this.runProperties)}}class wo extends mm{constructor(t){super(rr({basedOn:"Normal",next:"Normal",quickFormat:!0},t))}}class ZP extends wo{constructor(t){super(rr({id:"Title",name:"Title"},t))}}class QP extends wo{constructor(t){super(rr({id:"Heading1",name:"Heading 1"},t))}}class eU extends wo{constructor(t){super(rr({id:"Heading2",name:"Heading 2"},t))}}class tU extends wo{constructor(t){super(rr({id:"Heading3",name:"Heading 3"},t))}}class rU extends wo{constructor(t){super(rr({id:"Heading4",name:"Heading 4"},t))}}class sU extends wo{constructor(t){super(rr({id:"Heading5",name:"Heading 5"},t))}}class aU extends wo{constructor(t){super(rr({id:"Heading6",name:"Heading 6"},t))}}class nU extends wo{constructor(t){super(rr({id:"Strong",name:"Strong"},t))}}class iU extends mm{constructor(t){super(rr({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},t))}}class oU extends mm{constructor(t){super(rr({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:zy.AUTO}},run:{size:20}},t))}}class lU extends pm{constructor(t){super(rr({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},t))}}class cU extends pm{constructor(t){super(rr({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},t))}}class uU extends pm{constructor(t){super(rr({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:Aj.SINGLE}}},t))}}class qy extends et{constructor(t){if(super("w:styles"),t.initialStyles&&this.root.push(t.initialStyles),t.importedStyles)for(const r of t.importedStyles)this.root.push(r);if(t.paragraphStyles)for(const r of t.paragraphStyles)this.root.push(new mm(r));if(t.characterStyles)for(const r of t.characterStyles)this.root.push(new pm(r))}}class dU extends et{constructor(t){super("w:pPrDefault"),this.root.push(new Jc(t))}}class fU extends et{constructor(t){super("w:rPrDefault"),this.root.push(new Sl(t))}}class hU extends et{constructor(t){super("w:docDefaults"),Ze(this,"runPropertiesDefaults"),Ze(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new fU(t.run),this.paragraphPropertiesDefaults=new dU(t.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class mU{newInstance(t){const r=_j.xml2js(t,{compact:!1});let s;for(const l of r.elements||[])l.name==="w:styles"&&(s=l);if(s===void 0)throw new Error("can not find styles element");const n=s.elements||[];return new qy({initialStyles:new qL(s.attributes),importedStyles:n.map(l=>Av(l))})}}class wS{newInstance(t={}){var r;return{initialStyles:new hm(["mc","r","w","w14","w15"],"w14 w15"),importedStyles:[new hU((r=t.document)!=null?r:{}),new ZP(rr({run:{size:56}},t.title)),new QP(rr({run:{color:"2E74B5",size:32}},t.heading1)),new eU(rr({run:{color:"2E74B5",size:26}},t.heading2)),new tU(rr({run:{color:"1F4D78",size:24}},t.heading3)),new rU(rr({run:{color:"2E74B5",italics:!0}},t.heading4)),new sU(rr({run:{color:"2E74B5"}},t.heading5)),new aU(rr({run:{color:"1F4D78"}},t.heading6)),new nU(rr({run:{bold:!0}},t.strong)),new iU(t.listParagraph||{}),new uU(t.hyperlink||{}),new lU(t.footnoteReference||{}),new oU(t.footnoteText||{}),new cU(t.footnoteTextChar||{})]}}}let xm=class{constructor(t){Ze(this,"currentRelationshipId",1),Ze(this,"documentWrapper"),Ze(this,"headers",[]),Ze(this,"footers",[]),Ze(this,"coreProperties"),Ze(this,"numbering"),Ze(this,"media"),Ze(this,"fileRelationships"),Ze(this,"footnotesWrapper"),Ze(this,"settings"),Ze(this,"contentTypes"),Ze(this,"customProperties"),Ze(this,"appProperties"),Ze(this,"styles"),Ze(this,"comments"),Ze(this,"fontWrapper");var r,s,n,o,l,u,d,h,m,x,y,b;if(this.coreProperties=new QB(Ei(rr({},t),{creator:(r=t.creator)!=null?r:"Un-named",revision:(s=t.revision)!=null?s:1,lastModifiedBy:(n=t.lastModifiedBy)!=null?n:"Un-named"})),this.numbering=new qP(t.numbering?t.numbering:{config:[]}),this.comments=new HM((o=t.comments)!=null?o:{children:[]}),this.fileRelationships=new El,this.customProperties=new nP((l=t.customProperties)!=null?l:[]),this.appProperties=new KB,this.footnotesWrapper=new _P,this.contentTypes=new ZB,this.documentWrapper=new Hj({background:t.background}),this.settings=new KP({compatibilityModeVersion:t.compatabilityModeVersion,compatibility:t.compatibility,evenAndOddHeaders:!!t.evenAndOddHeaderAndFooters,trackRevisions:(u=t.features)==null?void 0:u.trackRevisions,updateFields:(d=t.features)==null?void 0:d.updateFields,defaultTabStop:t.defaultTabStop,hyphenation:{autoHyphenation:(h=t.hyphenation)==null?void 0:h.autoHyphenation,hyphenationZone:(m=t.hyphenation)==null?void 0:m.hyphenationZone,consecutiveHyphenLimit:(x=t.hyphenation)==null?void 0:x.consecutiveHyphenLimit,doNotHyphenateCaps:(y=t.hyphenation)==null?void 0:y.doNotHyphenateCaps}}),this.media=new EP,t.externalStyles!==void 0){const v=new mU;this.styles=v.newInstance(t.externalStyles)}else if(t.styles){const g=new wS().newInstance(t.styles.default);this.styles=new qy(rr(rr({},g),t.styles))}else{const v=new wS;this.styles=new qy(v.newInstance())}this.addDefaultRelationships();for(const v of t.sections)this.addSection(v);if(t.footnotes)for(const v in t.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(v),t.footnotes[v].children);this.fontWrapper=new cP((b=t.fonts)!=null?b:[])}addSection({headers:t={},footers:r={},children:s,properties:n}){this.documentWrapper.View.Body.addSection(Ei(rr({},n),{headerWrapperGroup:{default:t.default?this.createHeader(t.default):void 0,first:t.first?this.createHeader(t.first):void 0,even:t.even?this.createHeader(t.even):void 0},footerWrapperGroup:{default:r.default?this.createFooter(r.default):void 0,first:r.first?this.createFooter(r.first):void 0,even:r.even?this.createFooter(r.even):void 0}}));for(const o of s)this.documentWrapper.View.add(o)}createHeader(t){const r=new SP(this.media,this.currentRelationshipId++);for(const s of t.options.children)r.add(s);return this.addHeaderToDocument(r),r}createFooter(t){const r=new fP(this.media,this.currentRelationshipId++);for(const s of t.options.children)r.add(s);return this.addFooterToDocument(r),r}addHeaderToDocument(t,r=Mc.DEFAULT){this.headers.push({header:t,type:r}),this.documentWrapper.Relationships.createRelationship(t.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(t,r=Mc.DEFAULT){this.footers.push({footer:t,type:r}),this.documentWrapper.Relationships.createRelationship(t.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(t=>t.header)}get Footers(){return this.footers.map(t=>t.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}};var pU=Ev();function Yh(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var X1={exports:{}},_S;function xU(){return _S||(_S=1,(function(e,t){(function(r){e.exports=r()})(function(){return(function r(s,n,o){function l(h,m){if(!n[h]){if(!s[h]){var x=typeof Yh=="function"&&Yh;if(!m&&x)return x(h,!0);if(u)return u(h,!0);var y=new Error("Cannot find module '"+h+"'");throw y.code="MODULE_NOT_FOUND",y}var b=n[h]={exports:{}};s[h][0].call(b.exports,function(v){var g=s[h][1][v];return l(g||v)},b,b.exports,r,s,n,o)}return n[h].exports}for(var u=typeof Yh=="function"&&Yh,d=0;d<o.length;d++)l(o[d]);return l})({1:[function(r,s,n){var o=r("./utils"),l=r("./support"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(d){for(var h,m,x,y,b,v,g,_=[],w=0,S=d.length,N=S,E=o.getTypeOf(d)!=="string";w<d.length;)N=S-w,x=E?(h=d[w++],m=w<S?d[w++]:0,w<S?d[w++]:0):(h=d.charCodeAt(w++),m=w<S?d.charCodeAt(w++):0,w<S?d.charCodeAt(w++):0),y=h>>2,b=(3&h)<<4|m>>4,v=1<N?(15&m)<<2|x>>6:64,g=2<N?63&x:64,_.push(u.charAt(y)+u.charAt(b)+u.charAt(v)+u.charAt(g));return _.join("")},n.decode=function(d){var h,m,x,y,b,v,g=0,_=0,w="data:";if(d.substr(0,w.length)===w)throw new Error("Invalid base64 input, it looks like a data url.");var S,N=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===u.charAt(64)&&N--,d.charAt(d.length-2)===u.charAt(64)&&N--,N%1!=0)throw new Error("Invalid base64 input, bad content length.");for(S=l.uint8array?new Uint8Array(0|N):new Array(0|N);g<d.length;)h=u.indexOf(d.charAt(g++))<<2|(y=u.indexOf(d.charAt(g++)))>>4,m=(15&y)<<4|(b=u.indexOf(d.charAt(g++)))>>2,x=(3&b)<<6|(v=u.indexOf(d.charAt(g++))),S[_++]=h,b!==64&&(S[_++]=m),v!==64&&(S[_++]=x);return S}},{"./support":30,"./utils":32}],2:[function(r,s,n){var o=r("./external"),l=r("./stream/DataWorker"),u=r("./stream/Crc32Probe"),d=r("./stream/DataLengthProbe");function h(m,x,y,b,v){this.compressedSize=m,this.uncompressedSize=x,this.crc32=y,this.compression=b,this.compressedContent=v}h.prototype={getContentWorker:function(){var m=new l(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),x=this;return m.on("end",function(){if(this.streamInfo.data_length!==x.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),m},getCompressedWorker:function(){return new l(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(m,x,y){return m.pipe(new u).pipe(new d("uncompressedSize")).pipe(x.compressWorker(y)).pipe(new d("compressedSize")).withStreamInfo("compression",x)},s.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,s,n){var o=r("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},n.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,s,n){var o=r("./utils"),l=(function(){for(var u,d=[],h=0;h<256;h++){u=h;for(var m=0;m<8;m++)u=1&u?3988292384^u>>>1:u>>>1;d[h]=u}return d})();s.exports=function(u,d){return u!==void 0&&u.length?o.getTypeOf(u)!=="string"?(function(h,m,x,y){var b=l,v=y+x;h^=-1;for(var g=y;g<v;g++)h=h>>>8^b[255&(h^m[g])];return-1^h})(0|d,u,u.length,0):(function(h,m,x,y){var b=l,v=y+x;h^=-1;for(var g=y;g<v;g++)h=h>>>8^b[255&(h^m.charCodeAt(g))];return-1^h})(0|d,u,u.length,0):0}},{"./utils":32}],5:[function(r,s,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(r,s,n){var o=null;o=typeof Promise<"u"?Promise:r("lie"),s.exports={Promise:o}},{lie:37}],7:[function(r,s,n){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=r("pako"),u=r("./utils"),d=r("./stream/GenericWorker"),h=o?"uint8array":"array";function m(x,y){d.call(this,"FlateWorker/"+x),this._pako=null,this._pakoAction=x,this._pakoOptions=y,this.meta={}}n.magic="\b\0",u.inherits(m,d),m.prototype.processChunk=function(x){this.meta=x.meta,this._pako===null&&this._createPako(),this._pako.push(u.transformTo(h,x.data),!1)},m.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},m.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},m.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var x=this;this._pako.onData=function(y){x.push({data:y,meta:x.meta})}},n.compressWorker=function(x){return new m("Deflate",x)},n.uncompressWorker=function(){return new m("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,s,n){function o(b,v){var g,_="";for(g=0;g<v;g++)_+=String.fromCharCode(255&b),b>>>=8;return _}function l(b,v,g,_,w,S){var N,E,C=b.file,F=b.compression,O=S!==h.utf8encode,B=u.transformTo("string",S(C.name)),L=u.transformTo("string",h.utf8encode(C.name)),H=C.comment,ue=u.transformTo("string",S(H)),A=u.transformTo("string",h.utf8encode(H)),Y=L.length!==C.name.length,I=A.length!==H.length,ae="",Q="",re="",ve=C.dir,te=C.date,ke={crc32:0,compressedSize:0,uncompressedSize:0};v&&!g||(ke.crc32=b.crc32,ke.compressedSize=b.compressedSize,ke.uncompressedSize=b.uncompressedSize);var Z=0;v&&(Z|=8),O||!Y&&!I||(Z|=2048);var M=0,J=0;ve&&(M|=16),w==="UNIX"?(J=798,M|=(function(X,se){var P=X;return X||(P=se?16893:33204),(65535&P)<<16})(C.unixPermissions,ve)):(J=20,M|=(function(X){return 63&(X||0)})(C.dosPermissions)),N=te.getUTCHours(),N<<=6,N|=te.getUTCMinutes(),N<<=5,N|=te.getUTCSeconds()/2,E=te.getUTCFullYear()-1980,E<<=4,E|=te.getUTCMonth()+1,E<<=5,E|=te.getUTCDate(),Y&&(Q=o(1,1)+o(m(B),4)+L,ae+="up"+o(Q.length,2)+Q),I&&(re=o(1,1)+o(m(ue),4)+A,ae+="uc"+o(re.length,2)+re);var V="";return V+=`
\0`,V+=o(Z,2),V+=F.magic,V+=o(N,2),V+=o(E,2),V+=o(ke.crc32,4),V+=o(ke.compressedSize,4),V+=o(ke.uncompressedSize,4),V+=o(B.length,2),V+=o(ae.length,2),{fileRecord:x.LOCAL_FILE_HEADER+V+B+ae,dirRecord:x.CENTRAL_FILE_HEADER+o(J,2)+V+o(ue.length,2)+"\0\0\0\0"+o(M,4)+o(_,4)+B+ae+ue}}var u=r("../utils"),d=r("../stream/GenericWorker"),h=r("../utf8"),m=r("../crc32"),x=r("../signature");function y(b,v,g,_){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=g,this.encodeFileName=_,this.streamFiles=b,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}u.inherits(y,d),y.prototype.push=function(b){var v=b.meta.percent||0,g=this.entriesCount,_=this._sources.length;this.accumulate?this.contentBuffer.push(b):(this.bytesWritten+=b.data.length,d.prototype.push.call(this,{data:b.data,meta:{currentFile:this.currentFile,percent:g?(v+100*(g-_-1))/g:100}}))},y.prototype.openedSource=function(b){this.currentSourceOffset=this.bytesWritten,this.currentFile=b.file.name;var v=this.streamFiles&&!b.file.dir;if(v){var g=l(b,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(b){this.accumulate=!1;var v=this.streamFiles&&!b.file.dir,g=l(b,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),v)this.push({data:(function(_){return x.DATA_DESCRIPTOR+o(_.crc32,4)+o(_.compressedSize,4)+o(_.uncompressedSize,4)})(b),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var b=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var g=this.bytesWritten-b,_=(function(w,S,N,E,C){var F=u.transformTo("string",C(E));return x.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(w,2)+o(w,2)+o(S,4)+o(N,4)+o(F.length,2)+F})(this.dirRecords.length,g,b,this.zipComment,this.encodeFileName);this.push({data:_,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(b){this._sources.push(b);var v=this;return b.on("data",function(g){v.processChunk(g)}),b.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),b.on("error",function(g){v.error(g)}),this},y.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(b){var v=this._sources;if(!d.prototype.error.call(this,b))return!1;for(var g=0;g<v.length;g++)try{v[g].error(b)}catch{}return!0},y.prototype.lock=function(){d.prototype.lock.call(this);for(var b=this._sources,v=0;v<b.length;v++)b[v].lock()},s.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,s,n){var o=r("../compressions"),l=r("./ZipFileWorker");n.generateWorker=function(u,d,h){var m=new l(d.streamFiles,h,d.platform,d.encodeFileName),x=0;try{u.forEach(function(y,b){x++;var v=(function(S,N){var E=S||N,C=o[E];if(!C)throw new Error(E+" is not a valid compression method !");return C})(b.options.compression,d.compression),g=b.options.compressionOptions||d.compressionOptions||{},_=b.dir,w=b.date;b._compressWorker(v,g).withStreamInfo("file",{name:y,dir:_,date:w,comment:b.comment||"",unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions}).pipe(m)}),m.entriesCount=x}catch(y){m.error(y)}return m}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,s,n){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new o;for(var u in this)typeof this[u]!="function"&&(l[u]=this[u]);return l}}(o.prototype=r("./object")).loadAsync=r("./load"),o.support=r("./support"),o.defaults=r("./defaults"),o.version="3.10.1",o.loadAsync=function(l,u){return new o().loadAsync(l,u)},o.external=r("./external"),s.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,s,n){var o=r("./utils"),l=r("./external"),u=r("./utf8"),d=r("./zipEntries"),h=r("./stream/Crc32Probe"),m=r("./nodejsUtils");function x(y){return new l.Promise(function(b,v){var g=y.decompressed.getContentWorker().pipe(new h);g.on("error",function(_){v(_)}).on("end",function(){g.streamInfo.crc32!==y.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):b()}).resume()})}s.exports=function(y,b){var v=this;return b=o.extend(b||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:u.utf8decode}),m.isNode&&m.isStream(y)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",y,!0,b.optimizedBinaryString,b.base64).then(function(g){var _=new d(b);return _.load(g),_}).then(function(g){var _=[l.Promise.resolve(g)],w=g.files;if(b.checkCRC32)for(var S=0;S<w.length;S++)_.push(x(w[S]));return l.Promise.all(_)}).then(function(g){for(var _=g.shift(),w=_.files,S=0;S<w.length;S++){var N=w[S],E=N.fileNameStr,C=o.resolve(N.fileNameStr);v.file(C,N.decompressed,{binary:!0,optimizedBinaryString:!0,date:N.date,dir:N.dir,comment:N.fileCommentStr.length?N.fileCommentStr:null,unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions,createFolders:b.createFolders}),N.dir||(v.file(C).unsafeOriginalName=E)}return _.zipComment.length&&(v.comment=_.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,s,n){var o=r("../utils"),l=r("../stream/GenericWorker");function u(d,h){l.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(h)}o.inherits(u,l),u.prototype._bindStream=function(d){var h=this;(this._stream=d).pause(),d.on("data",function(m){h.push({data:m,meta:{percent:0}})}).on("error",function(m){h.isPaused?this.generatedError=m:h.error(m)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},u.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=u},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,s,n){var o=r("readable-stream").Readable;function l(u,d,h){o.call(this,d),this._helper=u;var m=this;u.on("data",function(x,y){m.push(x)||m._helper.pause(),h&&h(y)}).on("error",function(x){m.emit("error",x)}).on("end",function(){m.push(null)})}r("../utils").inherits(l,o),l.prototype._read=function(){this._helper.resume()},s.exports=l},{"../utils":32,"readable-stream":16}],14:[function(r,s,n){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,l);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,l)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var l=new Buffer(o);return l.fill(0),l},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(r,s,n){function o(C,F,O){var B,L=u.getTypeOf(F),H=u.extend(O||{},m);H.date=H.date||new Date,H.compression!==null&&(H.compression=H.compression.toUpperCase()),typeof H.unixPermissions=="string"&&(H.unixPermissions=parseInt(H.unixPermissions,8)),H.unixPermissions&&16384&H.unixPermissions&&(H.dir=!0),H.dosPermissions&&16&H.dosPermissions&&(H.dir=!0),H.dir&&(C=w(C)),H.createFolders&&(B=_(C))&&S.call(this,B,!0);var ue=L==="string"&&H.binary===!1&&H.base64===!1;O&&O.binary!==void 0||(H.binary=!ue),(F instanceof x&&F.uncompressedSize===0||H.dir||!F||F.length===0)&&(H.base64=!1,H.binary=!0,F="",H.compression="STORE",L="string");var A=null;A=F instanceof x||F instanceof d?F:v.isNode&&v.isStream(F)?new g(C,F):u.prepareContent(C,F,H.binary,H.optimizedBinaryString,H.base64);var Y=new y(C,A,H);this.files[C]=Y}var l=r("./utf8"),u=r("./utils"),d=r("./stream/GenericWorker"),h=r("./stream/StreamHelper"),m=r("./defaults"),x=r("./compressedObject"),y=r("./zipObject"),b=r("./generate"),v=r("./nodejsUtils"),g=r("./nodejs/NodejsStreamInputAdapter"),_=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var F=C.lastIndexOf("/");return 0<F?C.substring(0,F):""},w=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},S=function(C,F){return F=F!==void 0?F:m.createFolders,C=w(C),this.files[C]||o.call(this,C,null,{dir:!0,createFolders:F}),this.files[C]};function N(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var F,O,B;for(F in this.files)B=this.files[F],(O=F.slice(this.root.length,F.length))&&F.slice(0,this.root.length)===this.root&&C(O,B)},filter:function(C){var F=[];return this.forEach(function(O,B){C(O,B)&&F.push(B)}),F},file:function(C,F,O){if(arguments.length!==1)return C=this.root+C,o.call(this,C,F,O),this;if(N(C)){var B=C;return this.filter(function(H,ue){return!ue.dir&&B.test(H)})}var L=this.files[this.root+C];return L&&!L.dir?L:null},folder:function(C){if(!C)return this;if(N(C))return this.filter(function(L,H){return H.dir&&C.test(L)});var F=this.root+C,O=S.call(this,F),B=this.clone();return B.root=O.name,B},remove:function(C){C=this.root+C;var F=this.files[C];if(F||(C.slice(-1)!=="/"&&(C+="/"),F=this.files[C]),F&&!F.dir)delete this.files[C];else for(var O=this.filter(function(L,H){return H.name.slice(0,C.length)===C}),B=0;B<O.length;B++)delete this.files[O[B].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var F,O={};try{if((O=u.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");u.checkSupport(O.type),O.platform!=="darwin"&&O.platform!=="freebsd"&&O.platform!=="linux"&&O.platform!=="sunos"||(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var B=O.comment||this.comment||"";F=b.generateWorker(this,O,B)}catch(L){(F=new d("error")).error(L)}return new h(F,O.type||"string",O.mimeType)},generateAsync:function(C,F){return this.generateInternalStream(C).accumulate(F)},generateNodeStream:function(C,F){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(F)}};s.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,s,n){s.exports=r("stream")},{stream:void 0}],17:[function(r,s,n){var o=r("./DataReader");function l(u){o.call(this,u);for(var d=0;d<this.data.length;d++)u[d]=255&u[d]}r("../utils").inherits(l,o),l.prototype.byteAt=function(u){return this.data[this.zero+u]},l.prototype.lastIndexOfSignature=function(u){for(var d=u.charCodeAt(0),h=u.charCodeAt(1),m=u.charCodeAt(2),x=u.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===d&&this.data[y+1]===h&&this.data[y+2]===m&&this.data[y+3]===x)return y-this.zero;return-1},l.prototype.readAndCheckSignature=function(u){var d=u.charCodeAt(0),h=u.charCodeAt(1),m=u.charCodeAt(2),x=u.charCodeAt(3),y=this.readData(4);return d===y[0]&&h===y[1]&&m===y[2]&&x===y[3]},l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},s.exports=l},{"../utils":32,"./DataReader":18}],18:[function(r,s,n){var o=r("../utils");function l(u){this.data=u,this.length=u.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(u){this.checkIndex(this.index+u)},checkIndex:function(u){if(this.length<this.zero+u||u<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+u+"). Corrupted zip ?")},setIndex:function(u){this.checkIndex(u),this.index=u},skip:function(u){this.setIndex(this.index+u)},byteAt:function(){},readInt:function(u){var d,h=0;for(this.checkOffset(u),d=this.index+u-1;d>=this.index;d--)h=(h<<8)+this.byteAt(d);return this.index+=u,h},readString:function(u){return o.transformTo("string",this.readData(u))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var u=this.readInt(4);return new Date(Date.UTC(1980+(u>>25&127),(u>>21&15)-1,u>>16&31,u>>11&31,u>>5&63,(31&u)<<1))}},s.exports=l},{"../utils":32}],19:[function(r,s,n){var o=r("./Uint8ArrayReader");function l(u){o.call(this,u)}r("../utils").inherits(l,o),l.prototype.readData=function(u){this.checkOffset(u);var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},s.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,s,n){var o=r("./DataReader");function l(u){o.call(this,u)}r("../utils").inherits(l,o),l.prototype.byteAt=function(u){return this.data.charCodeAt(this.zero+u)},l.prototype.lastIndexOfSignature=function(u){return this.data.lastIndexOf(u)-this.zero},l.prototype.readAndCheckSignature=function(u){return u===this.readData(4)},l.prototype.readData=function(u){this.checkOffset(u);var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},s.exports=l},{"../utils":32,"./DataReader":18}],21:[function(r,s,n){var o=r("./ArrayReader");function l(u){o.call(this,u)}r("../utils").inherits(l,o),l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},s.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(r,s,n){var o=r("../utils"),l=r("../support"),u=r("./ArrayReader"),d=r("./StringReader"),h=r("./NodeBufferReader"),m=r("./Uint8ArrayReader");s.exports=function(x){var y=o.getTypeOf(x);return o.checkSupport(y),y!=="string"||l.uint8array?y==="nodebuffer"?new h(x):l.uint8array?new m(o.transformTo("uint8array",x)):new u(o.transformTo("array",x)):new d(x)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,s,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,s,n){var o=r("./GenericWorker"),l=r("../utils");function u(d){o.call(this,"ConvertWorker to "+d),this.destType=d}l.inherits(u,o),u.prototype.processChunk=function(d){this.push({data:l.transformTo(this.destType,d.data),meta:d.meta})},s.exports=u},{"../utils":32,"./GenericWorker":28}],25:[function(r,s,n){var o=r("./GenericWorker"),l=r("../crc32");function u(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(u,o),u.prototype.processChunk=function(d){this.streamInfo.crc32=l(d.data,this.streamInfo.crc32||0),this.push(d)},s.exports=u},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,s,n){var o=r("../utils"),l=r("./GenericWorker");function u(d){l.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}o.inherits(u,l),u.prototype.processChunk=function(d){if(d){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+d.data.length}l.prototype.processChunk.call(this,d)},s.exports=u},{"../utils":32,"./GenericWorker":28}],27:[function(r,s,n){var o=r("../utils"),l=r("./GenericWorker");function u(d){l.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(m){h.dataIsReady=!0,h.data=m,h.max=m&&m.length||0,h.type=o.getTypeOf(m),h.isPaused||h._tickAndRepeat()},function(m){h.error(m)})}o.inherits(u,l),u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},u.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},u.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,h);break;case"uint8array":d=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":d=this.data.slice(this.index,h)}return this.index=h,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=u},{"../utils":32,"./GenericWorker":28}],28:[function(r,s,n){function o(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,u){return this._listeners[l].push(u),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,u){if(this._listeners[l])for(var d=0;d<this._listeners[l].length;d++)this._listeners[l][d].call(this,u)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var u=this;return l.on("data",function(d){u.processChunk(d)}),l.on("end",function(){u.end()}),l.on("error",function(d){u.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,u){return this.extraStreamInfo[l]=u,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},s.exports=o},{}],29:[function(r,s,n){var o=r("../utils"),l=r("./ConvertWorker"),u=r("./GenericWorker"),d=r("../base64"),h=r("../support"),m=r("../external"),x=null;if(h.nodestream)try{x=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(v,g){return new m.Promise(function(_,w){var S=[],N=v._internalType,E=v._outputType,C=v._mimeType;v.on("data",function(F,O){S.push(F),g&&g(O)}).on("error",function(F){S=[],w(F)}).on("end",function(){try{var F=(function(O,B,L){switch(O){case"blob":return o.newBlob(o.transformTo("arraybuffer",B),L);case"base64":return d.encode(B);default:return o.transformTo(O,B)}})(E,(function(O,B){var L,H=0,ue=null,A=0;for(L=0;L<B.length;L++)A+=B[L].length;switch(O){case"string":return B.join("");case"array":return Array.prototype.concat.apply([],B);case"uint8array":for(ue=new Uint8Array(A),L=0;L<B.length;L++)ue.set(B[L],H),H+=B[L].length;return ue;case"nodebuffer":return Buffer.concat(B);default:throw new Error("concat : unsupported type '"+O+"'")}})(N,S),C);_(F)}catch(O){w(O)}S=[]}).resume()})}function b(v,g,_){var w=g;switch(g){case"blob":case"arraybuffer":w="uint8array";break;case"base64":w="string"}try{this._internalType=w,this._outputType=g,this._mimeType=_,o.checkSupport(w),this._worker=v.pipe(new l(w)),v.lock()}catch(S){this._worker=new u("error"),this._worker.error(S)}}b.prototype={accumulate:function(v){return y(this,v)},on:function(v,g){var _=this;return v==="data"?this._worker.on(v,function(w){g.call(_,w.data,w.meta)}):this._worker.on(v,function(){o.delay(g,arguments,_)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new x(this,{objectMode:this._outputType!=="nodebuffer"},v)}},s.exports=b},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,s,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var o=new ArrayBuffer(0);try{n.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(o),n.blob=l.getBlob("application/zip").size===0}catch{n.blob=!1}}}try{n.nodestream=!!r("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(r,s,n){for(var o=r("./utils"),l=r("./support"),u=r("./nodejsUtils"),d=r("./stream/GenericWorker"),h=new Array(256),m=0;m<256;m++)h[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;h[254]=h[254]=1;function x(){d.call(this,"utf-8 decode"),this.leftOver=null}function y(){d.call(this,"utf-8 encode")}n.utf8encode=function(b){return l.nodebuffer?u.newBufferFrom(b,"utf-8"):(function(v){var g,_,w,S,N,E=v.length,C=0;for(S=0;S<E;S++)(64512&(_=v.charCodeAt(S)))==55296&&S+1<E&&(64512&(w=v.charCodeAt(S+1)))==56320&&(_=65536+(_-55296<<10)+(w-56320),S++),C+=_<128?1:_<2048?2:_<65536?3:4;for(g=l.uint8array?new Uint8Array(C):new Array(C),S=N=0;N<C;S++)(64512&(_=v.charCodeAt(S)))==55296&&S+1<E&&(64512&(w=v.charCodeAt(S+1)))==56320&&(_=65536+(_-55296<<10)+(w-56320),S++),_<128?g[N++]=_:(_<2048?g[N++]=192|_>>>6:(_<65536?g[N++]=224|_>>>12:(g[N++]=240|_>>>18,g[N++]=128|_>>>12&63),g[N++]=128|_>>>6&63),g[N++]=128|63&_);return g})(b)},n.utf8decode=function(b){return l.nodebuffer?o.transformTo("nodebuffer",b).toString("utf-8"):(function(v){var g,_,w,S,N=v.length,E=new Array(2*N);for(g=_=0;g<N;)if((w=v[g++])<128)E[_++]=w;else if(4<(S=h[w]))E[_++]=65533,g+=S-1;else{for(w&=S===2?31:S===3?15:7;1<S&&g<N;)w=w<<6|63&v[g++],S--;1<S?E[_++]=65533:w<65536?E[_++]=w:(w-=65536,E[_++]=55296|w>>10&1023,E[_++]=56320|1023&w)}return E.length!==_&&(E.subarray?E=E.subarray(0,_):E.length=_),o.applyFromCharCode(E)})(b=o.transformTo(l.uint8array?"uint8array":"array",b))},o.inherits(x,d),x.prototype.processChunk=function(b){var v=o.transformTo(l.uint8array?"uint8array":"array",b.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var g=v;(v=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),v.set(g,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var _=(function(S,N){var E;for((N=N||S.length)>S.length&&(N=S.length),E=N-1;0<=E&&(192&S[E])==128;)E--;return E<0||E===0?N:E+h[S[E]]>N?E:N})(v),w=v;_!==v.length&&(l.uint8array?(w=v.subarray(0,_),this.leftOver=v.subarray(_,v.length)):(w=v.slice(0,_),this.leftOver=v.slice(_,v.length))),this.push({data:n.utf8decode(w),meta:b.meta})},x.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=x,o.inherits(y,d),y.prototype.processChunk=function(b){this.push({data:n.utf8encode(b.data),meta:b.meta})},n.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,s,n){var o=r("./support"),l=r("./base64"),u=r("./nodejsUtils"),d=r("./external");function h(g){return g}function m(g,_){for(var w=0;w<g.length;++w)_[w]=255&g.charCodeAt(w);return _}r("setimmediate"),n.newBlob=function(g,_){n.checkSupport("blob");try{return new Blob([g],{type:_})}catch{try{var w=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return w.append(g),w.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};var x={stringifyByChunk:function(g,_,w){var S=[],N=0,E=g.length;if(E<=w)return String.fromCharCode.apply(null,g);for(;N<E;)_==="array"||_==="nodebuffer"?S.push(String.fromCharCode.apply(null,g.slice(N,Math.min(N+w,E)))):S.push(String.fromCharCode.apply(null,g.subarray(N,Math.min(N+w,E)))),N+=w;return S.join("")},stringifyByChar:function(g){for(var _="",w=0;w<g.length;w++)_+=String.fromCharCode(g[w]);return _},applyCanBeUsed:{uint8array:(function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,u.allocBuffer(1)).length===1}catch{return!1}})()}};function y(g){var _=65536,w=n.getTypeOf(g),S=!0;if(w==="uint8array"?S=x.applyCanBeUsed.uint8array:w==="nodebuffer"&&(S=x.applyCanBeUsed.nodebuffer),S)for(;1<_;)try{return x.stringifyByChunk(g,w,_)}catch{_=Math.floor(_/2)}return x.stringifyByChar(g)}function b(g,_){for(var w=0;w<g.length;w++)_[w]=g[w];return _}n.applyFromCharCode=y;var v={};v.string={string:h,array:function(g){return m(g,new Array(g.length))},arraybuffer:function(g){return v.string.uint8array(g).buffer},uint8array:function(g){return m(g,new Uint8Array(g.length))},nodebuffer:function(g){return m(g,u.allocBuffer(g.length))}},v.array={string:y,array:h,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return u.newBufferFrom(g)}},v.arraybuffer={string:function(g){return y(new Uint8Array(g))},array:function(g){return b(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:h,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return u.newBufferFrom(new Uint8Array(g))}},v.uint8array={string:y,array:function(g){return b(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:h,nodebuffer:function(g){return u.newBufferFrom(g)}},v.nodebuffer={string:y,array:function(g){return b(g,new Array(g.length))},arraybuffer:function(g){return v.nodebuffer.uint8array(g).buffer},uint8array:function(g){return b(g,new Uint8Array(g.length))},nodebuffer:h},n.transformTo=function(g,_){if(_=_||"",!g)return _;n.checkSupport(g);var w=n.getTypeOf(_);return v[w][g](_)},n.resolve=function(g){for(var _=g.split("/"),w=[],S=0;S<_.length;S++){var N=_[S];N==="."||N===""&&S!==0&&S!==_.length-1||(N===".."?w.pop():w.push(N))}return w.join("/")},n.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":o.nodebuffer&&u.isBuffer(g)?"nodebuffer":o.uint8array&&g instanceof Uint8Array?"uint8array":o.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(g){if(!o[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(g){var _,w,S="";for(w=0;w<(g||"").length;w++)S+="\\x"+((_=g.charCodeAt(w))<16?"0":"")+_.toString(16).toUpperCase();return S},n.delay=function(g,_,w){setImmediate(function(){g.apply(w||null,_||[])})},n.inherits=function(g,_){function w(){}w.prototype=_.prototype,g.prototype=new w},n.extend=function(){var g,_,w={};for(g=0;g<arguments.length;g++)for(_ in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],_)&&w[_]===void 0&&(w[_]=arguments[g][_]);return w},n.prepareContent=function(g,_,w,S,N){return d.Promise.resolve(_).then(function(E){return o.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new d.Promise(function(C,F){var O=new FileReader;O.onload=function(B){C(B.target.result)},O.onerror=function(B){F(B.target.error)},O.readAsArrayBuffer(E)}):E}).then(function(E){var C=n.getTypeOf(E);return C?(C==="arraybuffer"?E=n.transformTo("uint8array",E):C==="string"&&(N?E=l.decode(E):w&&S!==!0&&(E=(function(F){return m(F,o.uint8array?new Uint8Array(F.length):new Array(F.length))})(E))),E):d.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,s,n){var o=r("./reader/readerFor"),l=r("./utils"),u=r("./signature"),d=r("./zipEntry"),h=r("./support");function m(x){this.files=[],this.loadOptions=x}m.prototype={checkSignature:function(x){if(!this.reader.readAndCheckSignature(x)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(y)+", expected "+l.pretty(x)+")")}},isSignature:function(x,y){var b=this.reader.index;this.reader.setIndex(x);var v=this.reader.readString(4)===y;return this.reader.setIndex(b),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var x=this.reader.readData(this.zipCommentLength),y=h.uint8array?"uint8array":"array",b=l.transformTo(y,x);this.zipComment=this.loadOptions.decodeFileName(b)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var x,y,b,v=this.zip64EndOfCentralSize-44;0<v;)x=this.reader.readInt(2),y=this.reader.readInt(4),b=this.reader.readData(y),this.zip64ExtensibleData[x]={id:x,length:y,value:b}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var x,y;for(x=0;x<this.files.length;x++)y=this.files[x],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var x;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(u.CENTRAL_FILE_HEADER);)(x=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(x);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var x=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if(x<0)throw this.isSignature(0,u.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(x);var y=x;if(this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(x=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(x),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,u.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var b=this.centralDirOffset+this.centralDirSize;this.zip64&&(b+=20,b+=12+this.zip64EndOfCentralSize);var v=y-b;if(0<v)this.isSignature(y,u.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(x){this.reader=o(x)},load:function(x){this.prepareReader(x),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=m},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,s,n){var o=r("./reader/readerFor"),l=r("./utils"),u=r("./compressedObject"),d=r("./crc32"),h=r("./utf8"),m=r("./compressions"),x=r("./support");function y(b,v){this.options=b,this.loadOptions=v}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(b){var v,g;if(b.skip(22),this.fileNameLength=b.readInt(2),g=b.readInt(2),this.fileName=b.readData(this.fileNameLength),b.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=(function(_){for(var w in m)if(Object.prototype.hasOwnProperty.call(m,w)&&m[w].magic===_)return m[w];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new u(this.compressedSize,this.uncompressedSize,this.crc32,v,b.readData(this.compressedSize))},readCentralPart:function(b){this.versionMadeBy=b.readInt(2),b.skip(2),this.bitFlag=b.readInt(2),this.compressionMethod=b.readString(2),this.date=b.readDate(),this.crc32=b.readInt(4),this.compressedSize=b.readInt(4),this.uncompressedSize=b.readInt(4);var v=b.readInt(2);if(this.extraFieldsLength=b.readInt(2),this.fileCommentLength=b.readInt(2),this.diskNumberStart=b.readInt(2),this.internalFileAttributes=b.readInt(2),this.externalFileAttributes=b.readInt(4),this.localHeaderOffset=b.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");b.skip(v),this.readExtraFields(b),this.parseZIP64ExtraField(b),this.fileComment=b.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var b=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),b==0&&(this.dosPermissions=63&this.externalFileAttributes),b==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var b=o(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=b.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=b.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=b.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=b.readInt(4))}},readExtraFields:function(b){var v,g,_,w=b.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});b.index+4<w;)v=b.readInt(2),g=b.readInt(2),_=b.readData(g),this.extraFields[v]={id:v,length:g,value:_};b.setIndex(w)},handleUTF8:function(){var b=x.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var g=l.transformTo(b,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var _=this.findExtraFieldUnicodeComment();if(_!==null)this.fileCommentStr=_;else{var w=l.transformTo(b,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(w)}}},findExtraFieldUnicodePath:function(){var b=this.extraFields[28789];if(b){var v=o(b.value);return v.readInt(1)!==1||d(this.fileName)!==v.readInt(4)?null:h.utf8decode(v.readData(b.length-5))}return null},findExtraFieldUnicodeComment:function(){var b=this.extraFields[25461];if(b){var v=o(b.value);return v.readInt(1)!==1||d(this.fileComment)!==v.readInt(4)?null:h.utf8decode(v.readData(b.length-5))}return null}},s.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,s,n){function o(v,g,_){this.name=v,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=g,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}}var l=r("./stream/StreamHelper"),u=r("./stream/DataWorker"),d=r("./utf8"),h=r("./compressedObject"),m=r("./stream/GenericWorker");o.prototype={internalStream:function(v){var g=null,_="string";try{if(!v)throw new Error("No output type specified.");var w=(_=v.toLowerCase())==="string"||_==="text";_!=="binarystring"&&_!=="text"||(_="string"),g=this._decompressWorker();var S=!this._dataBinary;S&&!w&&(g=g.pipe(new d.Utf8EncodeWorker)),!S&&w&&(g=g.pipe(new d.Utf8DecodeWorker))}catch(N){(g=new m("error")).error(N)}return new l(g,_,"")},async:function(v,g){return this.internalStream(v).accumulate(g)},nodeStream:function(v,g){return this.internalStream(v||"nodebuffer").toNodejsStream(g)},_compressWorker:function(v,g){if(this._data instanceof h&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new d.Utf8EncodeWorker)),h.createWorkerFrom(_,v,g)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof m?this._data:new u(this._data)}};for(var x=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},b=0;b<x.length;b++)o.prototype[x[b]]=y;s.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,s,n){(function(o){var l,u,d=o.MutationObserver||o.WebKitMutationObserver;if(d){var h=0,m=new d(v),x=o.document.createTextNode("");m.observe(x,{characterData:!0}),l=function(){x.data=h=++h%2}}else if(o.setImmediate||o.MessageChannel===void 0)l="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var g=o.document.createElement("script");g.onreadystatechange=function(){v(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},o.document.documentElement.appendChild(g)}:function(){setTimeout(v,0)};else{var y=new o.MessageChannel;y.port1.onmessage=v,l=function(){y.port2.postMessage(0)}}var b=[];function v(){var g,_;u=!0;for(var w=b.length;w;){for(_=b,b=[],g=-1;++g<w;)_[g]();w=b.length}u=!1}s.exports=function(g){b.push(g)!==1||u||l()}}).call(this,typeof $n<"u"?$n:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,s,n){var o=r("immediate");function l(){}var u={},d=["REJECTED"],h=["FULFILLED"],m=["PENDING"];function x(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,w!==l&&g(this,w)}function y(w,S,N){this.promise=w,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}function b(w,S,N){o(function(){var E;try{E=S(N)}catch(C){return u.reject(w,C)}E===w?u.reject(w,new TypeError("Cannot resolve promise with itself")):u.resolve(w,E)})}function v(w){var S=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof S=="function")return function(){S.apply(w,arguments)}}function g(w,S){var N=!1;function E(O){N||(N=!0,u.reject(w,O))}function C(O){N||(N=!0,u.resolve(w,O))}var F=_(function(){S(C,E)});F.status==="error"&&E(F.value)}function _(w,S){var N={};try{N.value=w(S),N.status="success"}catch(E){N.status="error",N.value=E}return N}(s.exports=x).prototype.finally=function(w){if(typeof w!="function")return this;var S=this.constructor;return this.then(function(N){return S.resolve(w()).then(function(){return N})},function(N){return S.resolve(w()).then(function(){throw N})})},x.prototype.catch=function(w){return this.then(null,w)},x.prototype.then=function(w,S){if(typeof w!="function"&&this.state===h||typeof S!="function"&&this.state===d)return this;var N=new this.constructor(l);return this.state!==m?b(N,this.state===h?w:S,this.outcome):this.queue.push(new y(N,w,S)),N},y.prototype.callFulfilled=function(w){u.resolve(this.promise,w)},y.prototype.otherCallFulfilled=function(w){b(this.promise,this.onFulfilled,w)},y.prototype.callRejected=function(w){u.reject(this.promise,w)},y.prototype.otherCallRejected=function(w){b(this.promise,this.onRejected,w)},u.resolve=function(w,S){var N=_(v,S);if(N.status==="error")return u.reject(w,N.value);var E=N.value;if(E)g(w,E);else{w.state=h,w.outcome=S;for(var C=-1,F=w.queue.length;++C<F;)w.queue[C].callFulfilled(S)}return w},u.reject=function(w,S){w.state=d,w.outcome=S;for(var N=-1,E=w.queue.length;++N<E;)w.queue[N].callRejected(S);return w},x.resolve=function(w){return w instanceof this?w:u.resolve(new this(l),w)},x.reject=function(w){var S=new this(l);return u.reject(S,w)},x.all=function(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=w.length,E=!1;if(!N)return this.resolve([]);for(var C=new Array(N),F=0,O=-1,B=new this(l);++O<N;)L(w[O],O);return B;function L(H,ue){S.resolve(H).then(function(A){C[ue]=A,++F!==N||E||(E=!0,u.resolve(B,C))},function(A){E||(E=!0,u.reject(B,A))})}},x.race=function(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=w.length,E=!1;if(!N)return this.resolve([]);for(var C=-1,F=new this(l);++C<N;)O=w[C],S.resolve(O).then(function(B){E||(E=!0,u.resolve(F,B))},function(B){E||(E=!0,u.reject(F,B))});var O;return F}},{immediate:36}],38:[function(r,s,n){var o={};(0,r("./lib/utils/common").assign)(o,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),s.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,s,n){var o=r("./zlib/deflate"),l=r("./utils/common"),u=r("./utils/strings"),d=r("./zlib/messages"),h=r("./zlib/zstream"),m=Object.prototype.toString,x=0,y=-1,b=0,v=8;function g(w){if(!(this instanceof g))return new g(w);this.options=l.assign({level:y,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:b,to:""},w||{});var S=this.options;S.raw&&0<S.windowBits?S.windowBits=-S.windowBits:S.gzip&&0<S.windowBits&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var N=o.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(N!==x)throw new Error(d[N]);if(S.header&&o.deflateSetHeader(this.strm,S.header),S.dictionary){var E;if(E=typeof S.dictionary=="string"?u.string2buf(S.dictionary):m.call(S.dictionary)==="[object ArrayBuffer]"?new Uint8Array(S.dictionary):S.dictionary,(N=o.deflateSetDictionary(this.strm,E))!==x)throw new Error(d[N]);this._dict_set=!0}}function _(w,S){var N=new g(S);if(N.push(w,!0),N.err)throw N.msg||d[N.err];return N.result}g.prototype.push=function(w,S){var N,E,C=this.strm,F=this.options.chunkSize;if(this.ended)return!1;E=S===~~S?S:S===!0?4:0,typeof w=="string"?C.input=u.string2buf(w):m.call(w)==="[object ArrayBuffer]"?C.input=new Uint8Array(w):C.input=w,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new l.Buf8(F),C.next_out=0,C.avail_out=F),(N=o.deflate(C,E))!==1&&N!==x)return this.onEnd(N),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(u.buf2binstring(l.shrinkBuf(C.output,C.next_out))):this.onData(l.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&N!==1);return E===4?(N=o.deflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===x):E!==2||(this.onEnd(x),!(C.avail_out=0))},g.prototype.onData=function(w){this.chunks.push(w)},g.prototype.onEnd=function(w){w===x&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},n.Deflate=g,n.deflate=_,n.deflateRaw=function(w,S){return(S=S||{}).raw=!0,_(w,S)},n.gzip=function(w,S){return(S=S||{}).gzip=!0,_(w,S)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,s,n){var o=r("./zlib/inflate"),l=r("./utils/common"),u=r("./utils/strings"),d=r("./zlib/constants"),h=r("./zlib/messages"),m=r("./zlib/zstream"),x=r("./zlib/gzheader"),y=Object.prototype.toString;function b(g){if(!(this instanceof b))return new b(g);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},g||{});var _=this.options;_.raw&&0<=_.windowBits&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),!(0<=_.windowBits&&_.windowBits<16)||g&&g.windowBits||(_.windowBits+=32),15<_.windowBits&&_.windowBits<48&&(15&_.windowBits)==0&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var w=o.inflateInit2(this.strm,_.windowBits);if(w!==d.Z_OK)throw new Error(h[w]);this.header=new x,o.inflateGetHeader(this.strm,this.header)}function v(g,_){var w=new b(_);if(w.push(g,!0),w.err)throw w.msg||h[w.err];return w.result}b.prototype.push=function(g,_){var w,S,N,E,C,F,O=this.strm,B=this.options.chunkSize,L=this.options.dictionary,H=!1;if(this.ended)return!1;S=_===~~_?_:_===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof g=="string"?O.input=u.binstring2buf(g):y.call(g)==="[object ArrayBuffer]"?O.input=new Uint8Array(g):O.input=g,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new l.Buf8(B),O.next_out=0,O.avail_out=B),(w=o.inflate(O,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&L&&(F=typeof L=="string"?u.string2buf(L):y.call(L)==="[object ArrayBuffer]"?new Uint8Array(L):L,w=o.inflateSetDictionary(this.strm,F)),w===d.Z_BUF_ERROR&&H===!0&&(w=d.Z_OK,H=!1),w!==d.Z_STREAM_END&&w!==d.Z_OK)return this.onEnd(w),!(this.ended=!0);O.next_out&&(O.avail_out!==0&&w!==d.Z_STREAM_END&&(O.avail_in!==0||S!==d.Z_FINISH&&S!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(N=u.utf8border(O.output,O.next_out),E=O.next_out-N,C=u.buf2string(O.output,N),O.next_out=E,O.avail_out=B-E,E&&l.arraySet(O.output,O.output,N,E,0),this.onData(C)):this.onData(l.shrinkBuf(O.output,O.next_out)))),O.avail_in===0&&O.avail_out===0&&(H=!0)}while((0<O.avail_in||O.avail_out===0)&&w!==d.Z_STREAM_END);return w===d.Z_STREAM_END&&(S=d.Z_FINISH),S===d.Z_FINISH?(w=o.inflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===d.Z_OK):S!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(O.avail_out=0))},b.prototype.onData=function(g){this.chunks.push(g)},b.prototype.onEnd=function(g){g===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},n.Inflate=b,n.inflate=v,n.inflateRaw=function(g,_){return(_=_||{}).raw=!0,v(g,_)},n.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,s,n){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(d){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var m=h.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var x in m)m.hasOwnProperty(x)&&(d[x]=m[x])}}return d},n.shrinkBuf=function(d,h){return d.length===h?d:d.subarray?d.subarray(0,h):(d.length=h,d)};var l={arraySet:function(d,h,m,x,y){if(h.subarray&&d.subarray)d.set(h.subarray(m,m+x),y);else for(var b=0;b<x;b++)d[y+b]=h[m+b]},flattenChunks:function(d){var h,m,x,y,b,v;for(h=x=0,m=d.length;h<m;h++)x+=d[h].length;for(v=new Uint8Array(x),h=y=0,m=d.length;h<m;h++)b=d[h],v.set(b,y),y+=b.length;return v}},u={arraySet:function(d,h,m,x,y){for(var b=0;b<x;b++)d[y+b]=h[m+b]},flattenChunks:function(d){return[].concat.apply([],d)}};n.setTyped=function(d){d?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,l)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,u))},n.setTyped(o)},{}],42:[function(r,s,n){var o=r("./common"),l=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var d=new o.Buf8(256),h=0;h<256;h++)d[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function m(x,y){if(y<65537&&(x.subarray&&u||!x.subarray&&l))return String.fromCharCode.apply(null,o.shrinkBuf(x,y));for(var b="",v=0;v<y;v++)b+=String.fromCharCode(x[v]);return b}d[254]=d[254]=1,n.string2buf=function(x){var y,b,v,g,_,w=x.length,S=0;for(g=0;g<w;g++)(64512&(b=x.charCodeAt(g)))==55296&&g+1<w&&(64512&(v=x.charCodeAt(g+1)))==56320&&(b=65536+(b-55296<<10)+(v-56320),g++),S+=b<128?1:b<2048?2:b<65536?3:4;for(y=new o.Buf8(S),g=_=0;_<S;g++)(64512&(b=x.charCodeAt(g)))==55296&&g+1<w&&(64512&(v=x.charCodeAt(g+1)))==56320&&(b=65536+(b-55296<<10)+(v-56320),g++),b<128?y[_++]=b:(b<2048?y[_++]=192|b>>>6:(b<65536?y[_++]=224|b>>>12:(y[_++]=240|b>>>18,y[_++]=128|b>>>12&63),y[_++]=128|b>>>6&63),y[_++]=128|63&b);return y},n.buf2binstring=function(x){return m(x,x.length)},n.binstring2buf=function(x){for(var y=new o.Buf8(x.length),b=0,v=y.length;b<v;b++)y[b]=x.charCodeAt(b);return y},n.buf2string=function(x,y){var b,v,g,_,w=y||x.length,S=new Array(2*w);for(b=v=0;b<w;)if((g=x[b++])<128)S[v++]=g;else if(4<(_=d[g]))S[v++]=65533,b+=_-1;else{for(g&=_===2?31:_===3?15:7;1<_&&b<w;)g=g<<6|63&x[b++],_--;1<_?S[v++]=65533:g<65536?S[v++]=g:(g-=65536,S[v++]=55296|g>>10&1023,S[v++]=56320|1023&g)}return m(S,v)},n.utf8border=function(x,y){var b;for((y=y||x.length)>x.length&&(y=x.length),b=y-1;0<=b&&(192&x[b])==128;)b--;return b<0||b===0?y:b+d[x[b]]>y?b:y}},{"./common":41}],43:[function(r,s,n){s.exports=function(o,l,u,d){for(var h=65535&o|0,m=o>>>16&65535|0,x=0;u!==0;){for(u-=x=2e3<u?2e3:u;m=m+(h=h+l[d++]|0)|0,--x;);h%=65521,m%=65521}return h|m<<16|0}},{}],44:[function(r,s,n){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,s,n){var o=(function(){for(var l,u=[],d=0;d<256;d++){l=d;for(var h=0;h<8;h++)l=1&l?3988292384^l>>>1:l>>>1;u[d]=l}return u})();s.exports=function(l,u,d,h){var m=o,x=h+d;l^=-1;for(var y=h;y<x;y++)l=l>>>8^m[255&(l^u[y])];return-1^l}},{}],46:[function(r,s,n){var o,l=r("../utils/common"),u=r("./trees"),d=r("./adler32"),h=r("./crc32"),m=r("./messages"),x=0,y=4,b=0,v=-2,g=-1,_=4,w=2,S=8,N=9,E=286,C=30,F=19,O=2*E+1,B=15,L=3,H=258,ue=H+L+1,A=42,Y=113,I=1,ae=2,Q=3,re=4;function ve(k,de){return k.msg=m[de],de}function te(k){return(k<<1)-(4<k?9:0)}function ke(k){for(var de=k.length;0<=--de;)k[de]=0}function Z(k){var de=k.state,z=de.pending;z>k.avail_out&&(z=k.avail_out),z!==0&&(l.arraySet(k.output,de.pending_buf,de.pending_out,z,k.next_out),k.next_out+=z,de.pending_out+=z,k.total_out+=z,k.avail_out-=z,de.pending-=z,de.pending===0&&(de.pending_out=0))}function M(k,de){u._tr_flush_block(k,0<=k.block_start?k.block_start:-1,k.strstart-k.block_start,de),k.block_start=k.strstart,Z(k.strm)}function J(k,de){k.pending_buf[k.pending++]=de}function V(k,de){k.pending_buf[k.pending++]=de>>>8&255,k.pending_buf[k.pending++]=255&de}function X(k,de){var z,T,R=k.max_chain_length,q=k.strstart,me=k.prev_length,_e=k.nice_match,le=k.strstart>k.w_size-ue?k.strstart-(k.w_size-ue):0,Ae=k.window,Me=k.w_mask,Ee=k.prev,Ce=k.strstart+H,Je=Ae[q+me-1],$e=Ae[q+me];k.prev_length>=k.good_match&&(R>>=2),_e>k.lookahead&&(_e=k.lookahead);do if(Ae[(z=de)+me]===$e&&Ae[z+me-1]===Je&&Ae[z]===Ae[q]&&Ae[++z]===Ae[q+1]){q+=2,z++;do;while(Ae[++q]===Ae[++z]&&Ae[++q]===Ae[++z]&&Ae[++q]===Ae[++z]&&Ae[++q]===Ae[++z]&&Ae[++q]===Ae[++z]&&Ae[++q]===Ae[++z]&&Ae[++q]===Ae[++z]&&Ae[++q]===Ae[++z]&&q<Ce);if(T=H-(Ce-q),q=Ce-H,me<T){if(k.match_start=de,_e<=(me=T))break;Je=Ae[q+me-1],$e=Ae[q+me]}}while((de=Ee[de&Me])>le&&--R!=0);return me<=k.lookahead?me:k.lookahead}function se(k){var de,z,T,R,q,me,_e,le,Ae,Me,Ee=k.w_size;do{if(R=k.window_size-k.lookahead-k.strstart,k.strstart>=Ee+(Ee-ue)){for(l.arraySet(k.window,k.window,Ee,Ee,0),k.match_start-=Ee,k.strstart-=Ee,k.block_start-=Ee,de=z=k.hash_size;T=k.head[--de],k.head[de]=Ee<=T?T-Ee:0,--z;);for(de=z=Ee;T=k.prev[--de],k.prev[de]=Ee<=T?T-Ee:0,--z;);R+=Ee}if(k.strm.avail_in===0)break;if(me=k.strm,_e=k.window,le=k.strstart+k.lookahead,Ae=R,Me=void 0,Me=me.avail_in,Ae<Me&&(Me=Ae),z=Me===0?0:(me.avail_in-=Me,l.arraySet(_e,me.input,me.next_in,Me,le),me.state.wrap===1?me.adler=d(me.adler,_e,Me,le):me.state.wrap===2&&(me.adler=h(me.adler,_e,Me,le)),me.next_in+=Me,me.total_in+=Me,Me),k.lookahead+=z,k.lookahead+k.insert>=L)for(q=k.strstart-k.insert,k.ins_h=k.window[q],k.ins_h=(k.ins_h<<k.hash_shift^k.window[q+1])&k.hash_mask;k.insert&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[q+L-1])&k.hash_mask,k.prev[q&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=q,q++,k.insert--,!(k.lookahead+k.insert<L)););}while(k.lookahead<ue&&k.strm.avail_in!==0)}function P(k,de){for(var z,T;;){if(k.lookahead<ue){if(se(k),k.lookahead<ue&&de===x)return I;if(k.lookahead===0)break}if(z=0,k.lookahead>=L&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+L-1])&k.hash_mask,z=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),z!==0&&k.strstart-z<=k.w_size-ue&&(k.match_length=X(k,z)),k.match_length>=L)if(T=u._tr_tally(k,k.strstart-k.match_start,k.match_length-L),k.lookahead-=k.match_length,k.match_length<=k.max_lazy_match&&k.lookahead>=L){for(k.match_length--;k.strstart++,k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+L-1])&k.hash_mask,z=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart,--k.match_length!=0;);k.strstart++}else k.strstart+=k.match_length,k.match_length=0,k.ins_h=k.window[k.strstart],k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+1])&k.hash_mask;else T=u._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++;if(T&&(M(k,!1),k.strm.avail_out===0))return I}return k.insert=k.strstart<L-1?k.strstart:L-1,de===y?(M(k,!0),k.strm.avail_out===0?Q:re):k.last_lit&&(M(k,!1),k.strm.avail_out===0)?I:ae}function U(k,de){for(var z,T,R;;){if(k.lookahead<ue){if(se(k),k.lookahead<ue&&de===x)return I;if(k.lookahead===0)break}if(z=0,k.lookahead>=L&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+L-1])&k.hash_mask,z=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),k.prev_length=k.match_length,k.prev_match=k.match_start,k.match_length=L-1,z!==0&&k.prev_length<k.max_lazy_match&&k.strstart-z<=k.w_size-ue&&(k.match_length=X(k,z),k.match_length<=5&&(k.strategy===1||k.match_length===L&&4096<k.strstart-k.match_start)&&(k.match_length=L-1)),k.prev_length>=L&&k.match_length<=k.prev_length){for(R=k.strstart+k.lookahead-L,T=u._tr_tally(k,k.strstart-1-k.prev_match,k.prev_length-L),k.lookahead-=k.prev_length-1,k.prev_length-=2;++k.strstart<=R&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+L-1])&k.hash_mask,z=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),--k.prev_length!=0;);if(k.match_available=0,k.match_length=L-1,k.strstart++,T&&(M(k,!1),k.strm.avail_out===0))return I}else if(k.match_available){if((T=u._tr_tally(k,0,k.window[k.strstart-1]))&&M(k,!1),k.strstart++,k.lookahead--,k.strm.avail_out===0)return I}else k.match_available=1,k.strstart++,k.lookahead--}return k.match_available&&(T=u._tr_tally(k,0,k.window[k.strstart-1]),k.match_available=0),k.insert=k.strstart<L-1?k.strstart:L-1,de===y?(M(k,!0),k.strm.avail_out===0?Q:re):k.last_lit&&(M(k,!1),k.strm.avail_out===0)?I:ae}function ce(k,de,z,T,R){this.good_length=k,this.max_lazy=de,this.nice_length=z,this.max_chain=T,this.func=R}function ne(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*O),this.dyn_dtree=new l.Buf16(2*(2*C+1)),this.bl_tree=new l.Buf16(2*(2*F+1)),ke(this.dyn_ltree),ke(this.dyn_dtree),ke(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(B+1),this.heap=new l.Buf16(2*E+1),ke(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*E+1),ke(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ie(k){var de;return k&&k.state?(k.total_in=k.total_out=0,k.data_type=w,(de=k.state).pending=0,de.pending_out=0,de.wrap<0&&(de.wrap=-de.wrap),de.status=de.wrap?A:Y,k.adler=de.wrap===2?0:1,de.last_flush=x,u._tr_init(de),b):ve(k,v)}function W(k){var de=ie(k);return de===b&&(function(z){z.window_size=2*z.w_size,ke(z.head),z.max_lazy_match=o[z.level].max_lazy,z.good_match=o[z.level].good_length,z.nice_match=o[z.level].nice_length,z.max_chain_length=o[z.level].max_chain,z.strstart=0,z.block_start=0,z.lookahead=0,z.insert=0,z.match_length=z.prev_length=L-1,z.match_available=0,z.ins_h=0})(k.state),de}function G(k,de,z,T,R,q){if(!k)return v;var me=1;if(de===g&&(de=6),T<0?(me=0,T=-T):15<T&&(me=2,T-=16),R<1||N<R||z!==S||T<8||15<T||de<0||9<de||q<0||_<q)return ve(k,v);T===8&&(T=9);var _e=new ne;return(k.state=_e).strm=k,_e.wrap=me,_e.gzhead=null,_e.w_bits=T,_e.w_size=1<<_e.w_bits,_e.w_mask=_e.w_size-1,_e.hash_bits=R+7,_e.hash_size=1<<_e.hash_bits,_e.hash_mask=_e.hash_size-1,_e.hash_shift=~~((_e.hash_bits+L-1)/L),_e.window=new l.Buf8(2*_e.w_size),_e.head=new l.Buf16(_e.hash_size),_e.prev=new l.Buf16(_e.w_size),_e.lit_bufsize=1<<R+6,_e.pending_buf_size=4*_e.lit_bufsize,_e.pending_buf=new l.Buf8(_e.pending_buf_size),_e.d_buf=1*_e.lit_bufsize,_e.l_buf=3*_e.lit_bufsize,_e.level=de,_e.strategy=q,_e.method=z,W(k)}o=[new ce(0,0,0,0,function(k,de){var z=65535;for(z>k.pending_buf_size-5&&(z=k.pending_buf_size-5);;){if(k.lookahead<=1){if(se(k),k.lookahead===0&&de===x)return I;if(k.lookahead===0)break}k.strstart+=k.lookahead,k.lookahead=0;var T=k.block_start+z;if((k.strstart===0||k.strstart>=T)&&(k.lookahead=k.strstart-T,k.strstart=T,M(k,!1),k.strm.avail_out===0)||k.strstart-k.block_start>=k.w_size-ue&&(M(k,!1),k.strm.avail_out===0))return I}return k.insert=0,de===y?(M(k,!0),k.strm.avail_out===0?Q:re):(k.strstart>k.block_start&&(M(k,!1),k.strm.avail_out),I)}),new ce(4,4,8,4,P),new ce(4,5,16,8,P),new ce(4,6,32,32,P),new ce(4,4,16,16,U),new ce(8,16,32,32,U),new ce(8,16,128,128,U),new ce(8,32,128,256,U),new ce(32,128,258,1024,U),new ce(32,258,258,4096,U)],n.deflateInit=function(k,de){return G(k,de,S,15,8,0)},n.deflateInit2=G,n.deflateReset=W,n.deflateResetKeep=ie,n.deflateSetHeader=function(k,de){return k&&k.state?k.state.wrap!==2?v:(k.state.gzhead=de,b):v},n.deflate=function(k,de){var z,T,R,q;if(!k||!k.state||5<de||de<0)return k?ve(k,v):v;if(T=k.state,!k.output||!k.input&&k.avail_in!==0||T.status===666&&de!==y)return ve(k,k.avail_out===0?-5:v);if(T.strm=k,z=T.last_flush,T.last_flush=de,T.status===A)if(T.wrap===2)k.adler=0,J(T,31),J(T,139),J(T,8),T.gzhead?(J(T,(T.gzhead.text?1:0)+(T.gzhead.hcrc?2:0)+(T.gzhead.extra?4:0)+(T.gzhead.name?8:0)+(T.gzhead.comment?16:0)),J(T,255&T.gzhead.time),J(T,T.gzhead.time>>8&255),J(T,T.gzhead.time>>16&255),J(T,T.gzhead.time>>24&255),J(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),J(T,255&T.gzhead.os),T.gzhead.extra&&T.gzhead.extra.length&&(J(T,255&T.gzhead.extra.length),J(T,T.gzhead.extra.length>>8&255)),T.gzhead.hcrc&&(k.adler=h(k.adler,T.pending_buf,T.pending,0)),T.gzindex=0,T.status=69):(J(T,0),J(T,0),J(T,0),J(T,0),J(T,0),J(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),J(T,3),T.status=Y);else{var me=S+(T.w_bits-8<<4)<<8;me|=(2<=T.strategy||T.level<2?0:T.level<6?1:T.level===6?2:3)<<6,T.strstart!==0&&(me|=32),me+=31-me%31,T.status=Y,V(T,me),T.strstart!==0&&(V(T,k.adler>>>16),V(T,65535&k.adler)),k.adler=1}if(T.status===69)if(T.gzhead.extra){for(R=T.pending;T.gzindex<(65535&T.gzhead.extra.length)&&(T.pending!==T.pending_buf_size||(T.gzhead.hcrc&&T.pending>R&&(k.adler=h(k.adler,T.pending_buf,T.pending-R,R)),Z(k),R=T.pending,T.pending!==T.pending_buf_size));)J(T,255&T.gzhead.extra[T.gzindex]),T.gzindex++;T.gzhead.hcrc&&T.pending>R&&(k.adler=h(k.adler,T.pending_buf,T.pending-R,R)),T.gzindex===T.gzhead.extra.length&&(T.gzindex=0,T.status=73)}else T.status=73;if(T.status===73)if(T.gzhead.name){R=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>R&&(k.adler=h(k.adler,T.pending_buf,T.pending-R,R)),Z(k),R=T.pending,T.pending===T.pending_buf_size)){q=1;break}q=T.gzindex<T.gzhead.name.length?255&T.gzhead.name.charCodeAt(T.gzindex++):0,J(T,q)}while(q!==0);T.gzhead.hcrc&&T.pending>R&&(k.adler=h(k.adler,T.pending_buf,T.pending-R,R)),q===0&&(T.gzindex=0,T.status=91)}else T.status=91;if(T.status===91)if(T.gzhead.comment){R=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>R&&(k.adler=h(k.adler,T.pending_buf,T.pending-R,R)),Z(k),R=T.pending,T.pending===T.pending_buf_size)){q=1;break}q=T.gzindex<T.gzhead.comment.length?255&T.gzhead.comment.charCodeAt(T.gzindex++):0,J(T,q)}while(q!==0);T.gzhead.hcrc&&T.pending>R&&(k.adler=h(k.adler,T.pending_buf,T.pending-R,R)),q===0&&(T.status=103)}else T.status=103;if(T.status===103&&(T.gzhead.hcrc?(T.pending+2>T.pending_buf_size&&Z(k),T.pending+2<=T.pending_buf_size&&(J(T,255&k.adler),J(T,k.adler>>8&255),k.adler=0,T.status=Y)):T.status=Y),T.pending!==0){if(Z(k),k.avail_out===0)return T.last_flush=-1,b}else if(k.avail_in===0&&te(de)<=te(z)&&de!==y)return ve(k,-5);if(T.status===666&&k.avail_in!==0)return ve(k,-5);if(k.avail_in!==0||T.lookahead!==0||de!==x&&T.status!==666){var _e=T.strategy===2?(function(le,Ae){for(var Me;;){if(le.lookahead===0&&(se(le),le.lookahead===0)){if(Ae===x)return I;break}if(le.match_length=0,Me=u._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++,Me&&(M(le,!1),le.strm.avail_out===0))return I}return le.insert=0,Ae===y?(M(le,!0),le.strm.avail_out===0?Q:re):le.last_lit&&(M(le,!1),le.strm.avail_out===0)?I:ae})(T,de):T.strategy===3?(function(le,Ae){for(var Me,Ee,Ce,Je,$e=le.window;;){if(le.lookahead<=H){if(se(le),le.lookahead<=H&&Ae===x)return I;if(le.lookahead===0)break}if(le.match_length=0,le.lookahead>=L&&0<le.strstart&&(Ee=$e[Ce=le.strstart-1])===$e[++Ce]&&Ee===$e[++Ce]&&Ee===$e[++Ce]){Je=le.strstart+H;do;while(Ee===$e[++Ce]&&Ee===$e[++Ce]&&Ee===$e[++Ce]&&Ee===$e[++Ce]&&Ee===$e[++Ce]&&Ee===$e[++Ce]&&Ee===$e[++Ce]&&Ee===$e[++Ce]&&Ce<Je);le.match_length=H-(Je-Ce),le.match_length>le.lookahead&&(le.match_length=le.lookahead)}if(le.match_length>=L?(Me=u._tr_tally(le,1,le.match_length-L),le.lookahead-=le.match_length,le.strstart+=le.match_length,le.match_length=0):(Me=u._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++),Me&&(M(le,!1),le.strm.avail_out===0))return I}return le.insert=0,Ae===y?(M(le,!0),le.strm.avail_out===0?Q:re):le.last_lit&&(M(le,!1),le.strm.avail_out===0)?I:ae})(T,de):o[T.level].func(T,de);if(_e!==Q&&_e!==re||(T.status=666),_e===I||_e===Q)return k.avail_out===0&&(T.last_flush=-1),b;if(_e===ae&&(de===1?u._tr_align(T):de!==5&&(u._tr_stored_block(T,0,0,!1),de===3&&(ke(T.head),T.lookahead===0&&(T.strstart=0,T.block_start=0,T.insert=0))),Z(k),k.avail_out===0))return T.last_flush=-1,b}return de!==y?b:T.wrap<=0?1:(T.wrap===2?(J(T,255&k.adler),J(T,k.adler>>8&255),J(T,k.adler>>16&255),J(T,k.adler>>24&255),J(T,255&k.total_in),J(T,k.total_in>>8&255),J(T,k.total_in>>16&255),J(T,k.total_in>>24&255)):(V(T,k.adler>>>16),V(T,65535&k.adler)),Z(k),0<T.wrap&&(T.wrap=-T.wrap),T.pending!==0?b:1)},n.deflateEnd=function(k){var de;return k&&k.state?(de=k.state.status)!==A&&de!==69&&de!==73&&de!==91&&de!==103&&de!==Y&&de!==666?ve(k,v):(k.state=null,de===Y?ve(k,-3):b):v},n.deflateSetDictionary=function(k,de){var z,T,R,q,me,_e,le,Ae,Me=de.length;if(!k||!k.state||(q=(z=k.state).wrap)===2||q===1&&z.status!==A||z.lookahead)return v;for(q===1&&(k.adler=d(k.adler,de,Me,0)),z.wrap=0,Me>=z.w_size&&(q===0&&(ke(z.head),z.strstart=0,z.block_start=0,z.insert=0),Ae=new l.Buf8(z.w_size),l.arraySet(Ae,de,Me-z.w_size,z.w_size,0),de=Ae,Me=z.w_size),me=k.avail_in,_e=k.next_in,le=k.input,k.avail_in=Me,k.next_in=0,k.input=de,se(z);z.lookahead>=L;){for(T=z.strstart,R=z.lookahead-(L-1);z.ins_h=(z.ins_h<<z.hash_shift^z.window[T+L-1])&z.hash_mask,z.prev[T&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=T,T++,--R;);z.strstart=T,z.lookahead=L-1,se(z)}return z.strstart+=z.lookahead,z.block_start=z.strstart,z.insert=z.lookahead,z.lookahead=0,z.match_length=z.prev_length=L-1,z.match_available=0,k.next_in=_e,k.input=le,k.avail_in=me,z.wrap=q,b},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,s,n){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,s,n){s.exports=function(o,l){var u,d,h,m,x,y,b,v,g,_,w,S,N,E,C,F,O,B,L,H,ue,A,Y,I,ae;u=o.state,d=o.next_in,I=o.input,h=d+(o.avail_in-5),m=o.next_out,ae=o.output,x=m-(l-o.avail_out),y=m+(o.avail_out-257),b=u.dmax,v=u.wsize,g=u.whave,_=u.wnext,w=u.window,S=u.hold,N=u.bits,E=u.lencode,C=u.distcode,F=(1<<u.lenbits)-1,O=(1<<u.distbits)-1;e:do{N<15&&(S+=I[d++]<<N,N+=8,S+=I[d++]<<N,N+=8),B=E[S&F];t:for(;;){if(S>>>=L=B>>>24,N-=L,(L=B>>>16&255)===0)ae[m++]=65535&B;else{if(!(16&L)){if((64&L)==0){B=E[(65535&B)+(S&(1<<L)-1)];continue t}if(32&L){u.mode=12;break e}o.msg="invalid literal/length code",u.mode=30;break e}H=65535&B,(L&=15)&&(N<L&&(S+=I[d++]<<N,N+=8),H+=S&(1<<L)-1,S>>>=L,N-=L),N<15&&(S+=I[d++]<<N,N+=8,S+=I[d++]<<N,N+=8),B=C[S&O];r:for(;;){if(S>>>=L=B>>>24,N-=L,!(16&(L=B>>>16&255))){if((64&L)==0){B=C[(65535&B)+(S&(1<<L)-1)];continue r}o.msg="invalid distance code",u.mode=30;break e}if(ue=65535&B,N<(L&=15)&&(S+=I[d++]<<N,(N+=8)<L&&(S+=I[d++]<<N,N+=8)),b<(ue+=S&(1<<L)-1)){o.msg="invalid distance too far back",u.mode=30;break e}if(S>>>=L,N-=L,(L=m-x)<ue){if(g<(L=ue-L)&&u.sane){o.msg="invalid distance too far back",u.mode=30;break e}if(Y=w,(A=0)===_){if(A+=v-L,L<H){for(H-=L;ae[m++]=w[A++],--L;);A=m-ue,Y=ae}}else if(_<L){if(A+=v+_-L,(L-=_)<H){for(H-=L;ae[m++]=w[A++],--L;);if(A=0,_<H){for(H-=L=_;ae[m++]=w[A++],--L;);A=m-ue,Y=ae}}}else if(A+=_-L,L<H){for(H-=L;ae[m++]=w[A++],--L;);A=m-ue,Y=ae}for(;2<H;)ae[m++]=Y[A++],ae[m++]=Y[A++],ae[m++]=Y[A++],H-=3;H&&(ae[m++]=Y[A++],1<H&&(ae[m++]=Y[A++]))}else{for(A=m-ue;ae[m++]=ae[A++],ae[m++]=ae[A++],ae[m++]=ae[A++],2<(H-=3););H&&(ae[m++]=ae[A++],1<H&&(ae[m++]=ae[A++]))}break}}break}}while(d<h&&m<y);d-=H=N>>3,S&=(1<<(N-=H<<3))-1,o.next_in=d,o.next_out=m,o.avail_in=d<h?h-d+5:5-(d-h),o.avail_out=m<y?y-m+257:257-(m-y),u.hold=S,u.bits=N}},{}],49:[function(r,s,n){var o=r("../utils/common"),l=r("./adler32"),u=r("./crc32"),d=r("./inffast"),h=r("./inftrees"),m=1,x=2,y=0,b=-2,v=1,g=852,_=592;function w(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)}function S(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function N(A){var Y;return A&&A.state?(Y=A.state,A.total_in=A.total_out=Y.total=0,A.msg="",Y.wrap&&(A.adler=1&Y.wrap),Y.mode=v,Y.last=0,Y.havedict=0,Y.dmax=32768,Y.head=null,Y.hold=0,Y.bits=0,Y.lencode=Y.lendyn=new o.Buf32(g),Y.distcode=Y.distdyn=new o.Buf32(_),Y.sane=1,Y.back=-1,y):b}function E(A){var Y;return A&&A.state?((Y=A.state).wsize=0,Y.whave=0,Y.wnext=0,N(A)):b}function C(A,Y){var I,ae;return A&&A.state?(ae=A.state,Y<0?(I=0,Y=-Y):(I=1+(Y>>4),Y<48&&(Y&=15)),Y&&(Y<8||15<Y)?b:(ae.window!==null&&ae.wbits!==Y&&(ae.window=null),ae.wrap=I,ae.wbits=Y,E(A))):b}function F(A,Y){var I,ae;return A?(ae=new S,(A.state=ae).window=null,(I=C(A,Y))!==y&&(A.state=null),I):b}var O,B,L=!0;function H(A){if(L){var Y;for(O=new o.Buf32(512),B=new o.Buf32(32),Y=0;Y<144;)A.lens[Y++]=8;for(;Y<256;)A.lens[Y++]=9;for(;Y<280;)A.lens[Y++]=7;for(;Y<288;)A.lens[Y++]=8;for(h(m,A.lens,0,288,O,0,A.work,{bits:9}),Y=0;Y<32;)A.lens[Y++]=5;h(x,A.lens,0,32,B,0,A.work,{bits:5}),L=!1}A.lencode=O,A.lenbits=9,A.distcode=B,A.distbits=5}function ue(A,Y,I,ae){var Q,re=A.state;return re.window===null&&(re.wsize=1<<re.wbits,re.wnext=0,re.whave=0,re.window=new o.Buf8(re.wsize)),ae>=re.wsize?(o.arraySet(re.window,Y,I-re.wsize,re.wsize,0),re.wnext=0,re.whave=re.wsize):(ae<(Q=re.wsize-re.wnext)&&(Q=ae),o.arraySet(re.window,Y,I-ae,Q,re.wnext),(ae-=Q)?(o.arraySet(re.window,Y,I-ae,ae,0),re.wnext=ae,re.whave=re.wsize):(re.wnext+=Q,re.wnext===re.wsize&&(re.wnext=0),re.whave<re.wsize&&(re.whave+=Q))),0}n.inflateReset=E,n.inflateReset2=C,n.inflateResetKeep=N,n.inflateInit=function(A){return F(A,15)},n.inflateInit2=F,n.inflate=function(A,Y){var I,ae,Q,re,ve,te,ke,Z,M,J,V,X,se,P,U,ce,ne,ie,W,G,k,de,z,T,R=0,q=new o.Buf8(4),me=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!A||!A.state||!A.output||!A.input&&A.avail_in!==0)return b;(I=A.state).mode===12&&(I.mode=13),ve=A.next_out,Q=A.output,ke=A.avail_out,re=A.next_in,ae=A.input,te=A.avail_in,Z=I.hold,M=I.bits,J=te,V=ke,de=y;e:for(;;)switch(I.mode){case v:if(I.wrap===0){I.mode=13;break}for(;M<16;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}if(2&I.wrap&&Z===35615){q[I.check=0]=255&Z,q[1]=Z>>>8&255,I.check=u(I.check,q,2,0),M=Z=0,I.mode=2;break}if(I.flags=0,I.head&&(I.head.done=!1),!(1&I.wrap)||(((255&Z)<<8)+(Z>>8))%31){A.msg="incorrect header check",I.mode=30;break}if((15&Z)!=8){A.msg="unknown compression method",I.mode=30;break}if(M-=4,k=8+(15&(Z>>>=4)),I.wbits===0)I.wbits=k;else if(k>I.wbits){A.msg="invalid window size",I.mode=30;break}I.dmax=1<<k,A.adler=I.check=1,I.mode=512&Z?10:12,M=Z=0;break;case 2:for(;M<16;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}if(I.flags=Z,(255&I.flags)!=8){A.msg="unknown compression method",I.mode=30;break}if(57344&I.flags){A.msg="unknown header flags set",I.mode=30;break}I.head&&(I.head.text=Z>>8&1),512&I.flags&&(q[0]=255&Z,q[1]=Z>>>8&255,I.check=u(I.check,q,2,0)),M=Z=0,I.mode=3;case 3:for(;M<32;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}I.head&&(I.head.time=Z),512&I.flags&&(q[0]=255&Z,q[1]=Z>>>8&255,q[2]=Z>>>16&255,q[3]=Z>>>24&255,I.check=u(I.check,q,4,0)),M=Z=0,I.mode=4;case 4:for(;M<16;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}I.head&&(I.head.xflags=255&Z,I.head.os=Z>>8),512&I.flags&&(q[0]=255&Z,q[1]=Z>>>8&255,I.check=u(I.check,q,2,0)),M=Z=0,I.mode=5;case 5:if(1024&I.flags){for(;M<16;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}I.length=Z,I.head&&(I.head.extra_len=Z),512&I.flags&&(q[0]=255&Z,q[1]=Z>>>8&255,I.check=u(I.check,q,2,0)),M=Z=0}else I.head&&(I.head.extra=null);I.mode=6;case 6:if(1024&I.flags&&(te<(X=I.length)&&(X=te),X&&(I.head&&(k=I.head.extra_len-I.length,I.head.extra||(I.head.extra=new Array(I.head.extra_len)),o.arraySet(I.head.extra,ae,re,X,k)),512&I.flags&&(I.check=u(I.check,ae,X,re)),te-=X,re+=X,I.length-=X),I.length))break e;I.length=0,I.mode=7;case 7:if(2048&I.flags){if(te===0)break e;for(X=0;k=ae[re+X++],I.head&&k&&I.length<65536&&(I.head.name+=String.fromCharCode(k)),k&&X<te;);if(512&I.flags&&(I.check=u(I.check,ae,X,re)),te-=X,re+=X,k)break e}else I.head&&(I.head.name=null);I.length=0,I.mode=8;case 8:if(4096&I.flags){if(te===0)break e;for(X=0;k=ae[re+X++],I.head&&k&&I.length<65536&&(I.head.comment+=String.fromCharCode(k)),k&&X<te;);if(512&I.flags&&(I.check=u(I.check,ae,X,re)),te-=X,re+=X,k)break e}else I.head&&(I.head.comment=null);I.mode=9;case 9:if(512&I.flags){for(;M<16;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}if(Z!==(65535&I.check)){A.msg="header crc mismatch",I.mode=30;break}M=Z=0}I.head&&(I.head.hcrc=I.flags>>9&1,I.head.done=!0),A.adler=I.check=0,I.mode=12;break;case 10:for(;M<32;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}A.adler=I.check=w(Z),M=Z=0,I.mode=11;case 11:if(I.havedict===0)return A.next_out=ve,A.avail_out=ke,A.next_in=re,A.avail_in=te,I.hold=Z,I.bits=M,2;A.adler=I.check=1,I.mode=12;case 12:if(Y===5||Y===6)break e;case 13:if(I.last){Z>>>=7&M,M-=7&M,I.mode=27;break}for(;M<3;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}switch(I.last=1&Z,M-=1,3&(Z>>>=1)){case 0:I.mode=14;break;case 1:if(H(I),I.mode=20,Y!==6)break;Z>>>=2,M-=2;break e;case 2:I.mode=17;break;case 3:A.msg="invalid block type",I.mode=30}Z>>>=2,M-=2;break;case 14:for(Z>>>=7&M,M-=7&M;M<32;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}if((65535&Z)!=(Z>>>16^65535)){A.msg="invalid stored block lengths",I.mode=30;break}if(I.length=65535&Z,M=Z=0,I.mode=15,Y===6)break e;case 15:I.mode=16;case 16:if(X=I.length){if(te<X&&(X=te),ke<X&&(X=ke),X===0)break e;o.arraySet(Q,ae,re,X,ve),te-=X,re+=X,ke-=X,ve+=X,I.length-=X;break}I.mode=12;break;case 17:for(;M<14;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}if(I.nlen=257+(31&Z),Z>>>=5,M-=5,I.ndist=1+(31&Z),Z>>>=5,M-=5,I.ncode=4+(15&Z),Z>>>=4,M-=4,286<I.nlen||30<I.ndist){A.msg="too many length or distance symbols",I.mode=30;break}I.have=0,I.mode=18;case 18:for(;I.have<I.ncode;){for(;M<3;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}I.lens[me[I.have++]]=7&Z,Z>>>=3,M-=3}for(;I.have<19;)I.lens[me[I.have++]]=0;if(I.lencode=I.lendyn,I.lenbits=7,z={bits:I.lenbits},de=h(0,I.lens,0,19,I.lencode,0,I.work,z),I.lenbits=z.bits,de){A.msg="invalid code lengths set",I.mode=30;break}I.have=0,I.mode=19;case 19:for(;I.have<I.nlen+I.ndist;){for(;ce=(R=I.lencode[Z&(1<<I.lenbits)-1])>>>16&255,ne=65535&R,!((U=R>>>24)<=M);){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}if(ne<16)Z>>>=U,M-=U,I.lens[I.have++]=ne;else{if(ne===16){for(T=U+2;M<T;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}if(Z>>>=U,M-=U,I.have===0){A.msg="invalid bit length repeat",I.mode=30;break}k=I.lens[I.have-1],X=3+(3&Z),Z>>>=2,M-=2}else if(ne===17){for(T=U+3;M<T;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}M-=U,k=0,X=3+(7&(Z>>>=U)),Z>>>=3,M-=3}else{for(T=U+7;M<T;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}M-=U,k=0,X=11+(127&(Z>>>=U)),Z>>>=7,M-=7}if(I.have+X>I.nlen+I.ndist){A.msg="invalid bit length repeat",I.mode=30;break}for(;X--;)I.lens[I.have++]=k}}if(I.mode===30)break;if(I.lens[256]===0){A.msg="invalid code -- missing end-of-block",I.mode=30;break}if(I.lenbits=9,z={bits:I.lenbits},de=h(m,I.lens,0,I.nlen,I.lencode,0,I.work,z),I.lenbits=z.bits,de){A.msg="invalid literal/lengths set",I.mode=30;break}if(I.distbits=6,I.distcode=I.distdyn,z={bits:I.distbits},de=h(x,I.lens,I.nlen,I.ndist,I.distcode,0,I.work,z),I.distbits=z.bits,de){A.msg="invalid distances set",I.mode=30;break}if(I.mode=20,Y===6)break e;case 20:I.mode=21;case 21:if(6<=te&&258<=ke){A.next_out=ve,A.avail_out=ke,A.next_in=re,A.avail_in=te,I.hold=Z,I.bits=M,d(A,V),ve=A.next_out,Q=A.output,ke=A.avail_out,re=A.next_in,ae=A.input,te=A.avail_in,Z=I.hold,M=I.bits,I.mode===12&&(I.back=-1);break}for(I.back=0;ce=(R=I.lencode[Z&(1<<I.lenbits)-1])>>>16&255,ne=65535&R,!((U=R>>>24)<=M);){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}if(ce&&(240&ce)==0){for(ie=U,W=ce,G=ne;ce=(R=I.lencode[G+((Z&(1<<ie+W)-1)>>ie)])>>>16&255,ne=65535&R,!(ie+(U=R>>>24)<=M);){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}Z>>>=ie,M-=ie,I.back+=ie}if(Z>>>=U,M-=U,I.back+=U,I.length=ne,ce===0){I.mode=26;break}if(32&ce){I.back=-1,I.mode=12;break}if(64&ce){A.msg="invalid literal/length code",I.mode=30;break}I.extra=15&ce,I.mode=22;case 22:if(I.extra){for(T=I.extra;M<T;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}I.length+=Z&(1<<I.extra)-1,Z>>>=I.extra,M-=I.extra,I.back+=I.extra}I.was=I.length,I.mode=23;case 23:for(;ce=(R=I.distcode[Z&(1<<I.distbits)-1])>>>16&255,ne=65535&R,!((U=R>>>24)<=M);){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}if((240&ce)==0){for(ie=U,W=ce,G=ne;ce=(R=I.distcode[G+((Z&(1<<ie+W)-1)>>ie)])>>>16&255,ne=65535&R,!(ie+(U=R>>>24)<=M);){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}Z>>>=ie,M-=ie,I.back+=ie}if(Z>>>=U,M-=U,I.back+=U,64&ce){A.msg="invalid distance code",I.mode=30;break}I.offset=ne,I.extra=15&ce,I.mode=24;case 24:if(I.extra){for(T=I.extra;M<T;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}I.offset+=Z&(1<<I.extra)-1,Z>>>=I.extra,M-=I.extra,I.back+=I.extra}if(I.offset>I.dmax){A.msg="invalid distance too far back",I.mode=30;break}I.mode=25;case 25:if(ke===0)break e;if(X=V-ke,I.offset>X){if((X=I.offset-X)>I.whave&&I.sane){A.msg="invalid distance too far back",I.mode=30;break}se=X>I.wnext?(X-=I.wnext,I.wsize-X):I.wnext-X,X>I.length&&(X=I.length),P=I.window}else P=Q,se=ve-I.offset,X=I.length;for(ke<X&&(X=ke),ke-=X,I.length-=X;Q[ve++]=P[se++],--X;);I.length===0&&(I.mode=21);break;case 26:if(ke===0)break e;Q[ve++]=I.length,ke--,I.mode=21;break;case 27:if(I.wrap){for(;M<32;){if(te===0)break e;te--,Z|=ae[re++]<<M,M+=8}if(V-=ke,A.total_out+=V,I.total+=V,V&&(A.adler=I.check=I.flags?u(I.check,Q,V,ve-V):l(I.check,Q,V,ve-V)),V=ke,(I.flags?Z:w(Z))!==I.check){A.msg="incorrect data check",I.mode=30;break}M=Z=0}I.mode=28;case 28:if(I.wrap&&I.flags){for(;M<32;){if(te===0)break e;te--,Z+=ae[re++]<<M,M+=8}if(Z!==(4294967295&I.total)){A.msg="incorrect length check",I.mode=30;break}M=Z=0}I.mode=29;case 29:de=1;break e;case 30:de=-3;break e;case 31:return-4;default:return b}return A.next_out=ve,A.avail_out=ke,A.next_in=re,A.avail_in=te,I.hold=Z,I.bits=M,(I.wsize||V!==A.avail_out&&I.mode<30&&(I.mode<27||Y!==4))&&ue(A,A.output,A.next_out,V-A.avail_out)?(I.mode=31,-4):(J-=A.avail_in,V-=A.avail_out,A.total_in+=J,A.total_out+=V,I.total+=V,I.wrap&&V&&(A.adler=I.check=I.flags?u(I.check,Q,V,A.next_out-V):l(I.check,Q,V,A.next_out-V)),A.data_type=I.bits+(I.last?64:0)+(I.mode===12?128:0)+(I.mode===20||I.mode===15?256:0),(J==0&&V===0||Y===4)&&de===y&&(de=-5),de)},n.inflateEnd=function(A){if(!A||!A.state)return b;var Y=A.state;return Y.window&&(Y.window=null),A.state=null,y},n.inflateGetHeader=function(A,Y){var I;return A&&A.state?(2&(I=A.state).wrap)==0?b:((I.head=Y).done=!1,y):b},n.inflateSetDictionary=function(A,Y){var I,ae=Y.length;return A&&A.state?(I=A.state).wrap!==0&&I.mode!==11?b:I.mode===11&&l(1,Y,ae,0)!==I.check?-3:ue(A,Y,ae,ae)?(I.mode=31,-4):(I.havedict=1,y):b},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,s,n){var o=r("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(m,x,y,b,v,g,_,w){var S,N,E,C,F,O,B,L,H,ue=w.bits,A=0,Y=0,I=0,ae=0,Q=0,re=0,ve=0,te=0,ke=0,Z=0,M=null,J=0,V=new o.Buf16(16),X=new o.Buf16(16),se=null,P=0;for(A=0;A<=15;A++)V[A]=0;for(Y=0;Y<b;Y++)V[x[y+Y]]++;for(Q=ue,ae=15;1<=ae&&V[ae]===0;ae--);if(ae<Q&&(Q=ae),ae===0)return v[g++]=20971520,v[g++]=20971520,w.bits=1,0;for(I=1;I<ae&&V[I]===0;I++);for(Q<I&&(Q=I),A=te=1;A<=15;A++)if(te<<=1,(te-=V[A])<0)return-1;if(0<te&&(m===0||ae!==1))return-1;for(X[1]=0,A=1;A<15;A++)X[A+1]=X[A]+V[A];for(Y=0;Y<b;Y++)x[y+Y]!==0&&(_[X[x[y+Y]]++]=Y);if(O=m===0?(M=se=_,19):m===1?(M=l,J-=257,se=u,P-=257,256):(M=d,se=h,-1),A=I,F=g,ve=Y=Z=0,E=-1,C=(ke=1<<(re=Q))-1,m===1&&852<ke||m===2&&592<ke)return 1;for(;;){for(B=A-ve,H=_[Y]<O?(L=0,_[Y]):_[Y]>O?(L=se[P+_[Y]],M[J+_[Y]]):(L=96,0),S=1<<A-ve,I=N=1<<re;v[F+(Z>>ve)+(N-=S)]=B<<24|L<<16|H|0,N!==0;);for(S=1<<A-1;Z&S;)S>>=1;if(S!==0?(Z&=S-1,Z+=S):Z=0,Y++,--V[A]==0){if(A===ae)break;A=x[y+_[Y]]}if(Q<A&&(Z&C)!==E){for(ve===0&&(ve=Q),F+=I,te=1<<(re=A-ve);re+ve<ae&&!((te-=V[re+ve])<=0);)re++,te<<=1;if(ke+=1<<re,m===1&&852<ke||m===2&&592<ke)return 1;v[E=Z&C]=Q<<24|re<<16|F-g|0}}return Z!==0&&(v[F+Z]=A-ve<<24|64<<16|0),w.bits=Q,0}},{"../utils/common":41}],51:[function(r,s,n){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,s,n){var o=r("../utils/common"),l=0,u=1;function d(R){for(var q=R.length;0<=--q;)R[q]=0}var h=0,m=29,x=256,y=x+1+m,b=30,v=19,g=2*y+1,_=15,w=16,S=7,N=256,E=16,C=17,F=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],B=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=new Array(2*(y+2));d(ue);var A=new Array(2*b);d(A);var Y=new Array(512);d(Y);var I=new Array(256);d(I);var ae=new Array(m);d(ae);var Q,re,ve,te=new Array(b);function ke(R,q,me,_e,le){this.static_tree=R,this.extra_bits=q,this.extra_base=me,this.elems=_e,this.max_length=le,this.has_stree=R&&R.length}function Z(R,q){this.dyn_tree=R,this.max_code=0,this.stat_desc=q}function M(R){return R<256?Y[R]:Y[256+(R>>>7)]}function J(R,q){R.pending_buf[R.pending++]=255&q,R.pending_buf[R.pending++]=q>>>8&255}function V(R,q,me){R.bi_valid>w-me?(R.bi_buf|=q<<R.bi_valid&65535,J(R,R.bi_buf),R.bi_buf=q>>w-R.bi_valid,R.bi_valid+=me-w):(R.bi_buf|=q<<R.bi_valid&65535,R.bi_valid+=me)}function X(R,q,me){V(R,me[2*q],me[2*q+1])}function se(R,q){for(var me=0;me|=1&R,R>>>=1,me<<=1,0<--q;);return me>>>1}function P(R,q,me){var _e,le,Ae=new Array(_+1),Me=0;for(_e=1;_e<=_;_e++)Ae[_e]=Me=Me+me[_e-1]<<1;for(le=0;le<=q;le++){var Ee=R[2*le+1];Ee!==0&&(R[2*le]=se(Ae[Ee]++,Ee))}}function U(R){var q;for(q=0;q<y;q++)R.dyn_ltree[2*q]=0;for(q=0;q<b;q++)R.dyn_dtree[2*q]=0;for(q=0;q<v;q++)R.bl_tree[2*q]=0;R.dyn_ltree[2*N]=1,R.opt_len=R.static_len=0,R.last_lit=R.matches=0}function ce(R){8<R.bi_valid?J(R,R.bi_buf):0<R.bi_valid&&(R.pending_buf[R.pending++]=R.bi_buf),R.bi_buf=0,R.bi_valid=0}function ne(R,q,me,_e){var le=2*q,Ae=2*me;return R[le]<R[Ae]||R[le]===R[Ae]&&_e[q]<=_e[me]}function ie(R,q,me){for(var _e=R.heap[me],le=me<<1;le<=R.heap_len&&(le<R.heap_len&&ne(q,R.heap[le+1],R.heap[le],R.depth)&&le++,!ne(q,_e,R.heap[le],R.depth));)R.heap[me]=R.heap[le],me=le,le<<=1;R.heap[me]=_e}function W(R,q,me){var _e,le,Ae,Me,Ee=0;if(R.last_lit!==0)for(;_e=R.pending_buf[R.d_buf+2*Ee]<<8|R.pending_buf[R.d_buf+2*Ee+1],le=R.pending_buf[R.l_buf+Ee],Ee++,_e===0?X(R,le,q):(X(R,(Ae=I[le])+x+1,q),(Me=O[Ae])!==0&&V(R,le-=ae[Ae],Me),X(R,Ae=M(--_e),me),(Me=B[Ae])!==0&&V(R,_e-=te[Ae],Me)),Ee<R.last_lit;);X(R,N,q)}function G(R,q){var me,_e,le,Ae=q.dyn_tree,Me=q.stat_desc.static_tree,Ee=q.stat_desc.has_stree,Ce=q.stat_desc.elems,Je=-1;for(R.heap_len=0,R.heap_max=g,me=0;me<Ce;me++)Ae[2*me]!==0?(R.heap[++R.heap_len]=Je=me,R.depth[me]=0):Ae[2*me+1]=0;for(;R.heap_len<2;)Ae[2*(le=R.heap[++R.heap_len]=Je<2?++Je:0)]=1,R.depth[le]=0,R.opt_len--,Ee&&(R.static_len-=Me[2*le+1]);for(q.max_code=Je,me=R.heap_len>>1;1<=me;me--)ie(R,Ae,me);for(le=Ce;me=R.heap[1],R.heap[1]=R.heap[R.heap_len--],ie(R,Ae,1),_e=R.heap[1],R.heap[--R.heap_max]=me,R.heap[--R.heap_max]=_e,Ae[2*le]=Ae[2*me]+Ae[2*_e],R.depth[le]=(R.depth[me]>=R.depth[_e]?R.depth[me]:R.depth[_e])+1,Ae[2*me+1]=Ae[2*_e+1]=le,R.heap[1]=le++,ie(R,Ae,1),2<=R.heap_len;);R.heap[--R.heap_max]=R.heap[1],(function($e,tt){var De,ft,jt,vt,At,Rt,Le=tt.dyn_tree,rt=tt.max_code,ct=tt.stat_desc.static_tree,oe=tt.stat_desc.has_stree,Ne=tt.stat_desc.extra_bits,xe=tt.stat_desc.extra_base,je=tt.stat_desc.max_length,fe=0;for(vt=0;vt<=_;vt++)$e.bl_count[vt]=0;for(Le[2*$e.heap[$e.heap_max]+1]=0,De=$e.heap_max+1;De<g;De++)je<(vt=Le[2*Le[2*(ft=$e.heap[De])+1]+1]+1)&&(vt=je,fe++),Le[2*ft+1]=vt,rt<ft||($e.bl_count[vt]++,At=0,xe<=ft&&(At=Ne[ft-xe]),Rt=Le[2*ft],$e.opt_len+=Rt*(vt+At),oe&&($e.static_len+=Rt*(ct[2*ft+1]+At)));if(fe!==0){do{for(vt=je-1;$e.bl_count[vt]===0;)vt--;$e.bl_count[vt]--,$e.bl_count[vt+1]+=2,$e.bl_count[je]--,fe-=2}while(0<fe);for(vt=je;vt!==0;vt--)for(ft=$e.bl_count[vt];ft!==0;)rt<(jt=$e.heap[--De])||(Le[2*jt+1]!==vt&&($e.opt_len+=(vt-Le[2*jt+1])*Le[2*jt],Le[2*jt+1]=vt),ft--)}})(R,q),P(Ae,Je,R.bl_count)}function k(R,q,me){var _e,le,Ae=-1,Me=q[1],Ee=0,Ce=7,Je=4;for(Me===0&&(Ce=138,Je=3),q[2*(me+1)+1]=65535,_e=0;_e<=me;_e++)le=Me,Me=q[2*(_e+1)+1],++Ee<Ce&&le===Me||(Ee<Je?R.bl_tree[2*le]+=Ee:le!==0?(le!==Ae&&R.bl_tree[2*le]++,R.bl_tree[2*E]++):Ee<=10?R.bl_tree[2*C]++:R.bl_tree[2*F]++,Ae=le,Je=(Ee=0)===Me?(Ce=138,3):le===Me?(Ce=6,3):(Ce=7,4))}function de(R,q,me){var _e,le,Ae=-1,Me=q[1],Ee=0,Ce=7,Je=4;for(Me===0&&(Ce=138,Je=3),_e=0;_e<=me;_e++)if(le=Me,Me=q[2*(_e+1)+1],!(++Ee<Ce&&le===Me)){if(Ee<Je)for(;X(R,le,R.bl_tree),--Ee!=0;);else le!==0?(le!==Ae&&(X(R,le,R.bl_tree),Ee--),X(R,E,R.bl_tree),V(R,Ee-3,2)):Ee<=10?(X(R,C,R.bl_tree),V(R,Ee-3,3)):(X(R,F,R.bl_tree),V(R,Ee-11,7));Ae=le,Je=(Ee=0)===Me?(Ce=138,3):le===Me?(Ce=6,3):(Ce=7,4)}}d(te);var z=!1;function T(R,q,me,_e){V(R,(h<<1)+(_e?1:0),3),(function(le,Ae,Me,Ee){ce(le),J(le,Me),J(le,~Me),o.arraySet(le.pending_buf,le.window,Ae,Me,le.pending),le.pending+=Me})(R,q,me)}n._tr_init=function(R){z||((function(){var q,me,_e,le,Ae,Me=new Array(_+1);for(le=_e=0;le<m-1;le++)for(ae[le]=_e,q=0;q<1<<O[le];q++)I[_e++]=le;for(I[_e-1]=le,le=Ae=0;le<16;le++)for(te[le]=Ae,q=0;q<1<<B[le];q++)Y[Ae++]=le;for(Ae>>=7;le<b;le++)for(te[le]=Ae<<7,q=0;q<1<<B[le]-7;q++)Y[256+Ae++]=le;for(me=0;me<=_;me++)Me[me]=0;for(q=0;q<=143;)ue[2*q+1]=8,q++,Me[8]++;for(;q<=255;)ue[2*q+1]=9,q++,Me[9]++;for(;q<=279;)ue[2*q+1]=7,q++,Me[7]++;for(;q<=287;)ue[2*q+1]=8,q++,Me[8]++;for(P(ue,y+1,Me),q=0;q<b;q++)A[2*q+1]=5,A[2*q]=se(q,5);Q=new ke(ue,O,x+1,y,_),re=new ke(A,B,0,b,_),ve=new ke(new Array(0),L,0,v,S)})(),z=!0),R.l_desc=new Z(R.dyn_ltree,Q),R.d_desc=new Z(R.dyn_dtree,re),R.bl_desc=new Z(R.bl_tree,ve),R.bi_buf=0,R.bi_valid=0,U(R)},n._tr_stored_block=T,n._tr_flush_block=function(R,q,me,_e){var le,Ae,Me=0;0<R.level?(R.strm.data_type===2&&(R.strm.data_type=(function(Ee){var Ce,Je=4093624447;for(Ce=0;Ce<=31;Ce++,Je>>>=1)if(1&Je&&Ee.dyn_ltree[2*Ce]!==0)return l;if(Ee.dyn_ltree[18]!==0||Ee.dyn_ltree[20]!==0||Ee.dyn_ltree[26]!==0)return u;for(Ce=32;Ce<x;Ce++)if(Ee.dyn_ltree[2*Ce]!==0)return u;return l})(R)),G(R,R.l_desc),G(R,R.d_desc),Me=(function(Ee){var Ce;for(k(Ee,Ee.dyn_ltree,Ee.l_desc.max_code),k(Ee,Ee.dyn_dtree,Ee.d_desc.max_code),G(Ee,Ee.bl_desc),Ce=v-1;3<=Ce&&Ee.bl_tree[2*H[Ce]+1]===0;Ce--);return Ee.opt_len+=3*(Ce+1)+5+5+4,Ce})(R),le=R.opt_len+3+7>>>3,(Ae=R.static_len+3+7>>>3)<=le&&(le=Ae)):le=Ae=me+5,me+4<=le&&q!==-1?T(R,q,me,_e):R.strategy===4||Ae===le?(V(R,2+(_e?1:0),3),W(R,ue,A)):(V(R,4+(_e?1:0),3),(function(Ee,Ce,Je,$e){var tt;for(V(Ee,Ce-257,5),V(Ee,Je-1,5),V(Ee,$e-4,4),tt=0;tt<$e;tt++)V(Ee,Ee.bl_tree[2*H[tt]+1],3);de(Ee,Ee.dyn_ltree,Ce-1),de(Ee,Ee.dyn_dtree,Je-1)})(R,R.l_desc.max_code+1,R.d_desc.max_code+1,Me+1),W(R,R.dyn_ltree,R.dyn_dtree)),U(R),_e&&ce(R)},n._tr_tally=function(R,q,me){return R.pending_buf[R.d_buf+2*R.last_lit]=q>>>8&255,R.pending_buf[R.d_buf+2*R.last_lit+1]=255&q,R.pending_buf[R.l_buf+R.last_lit]=255&me,R.last_lit++,q===0?R.dyn_ltree[2*me]++:(R.matches++,q--,R.dyn_ltree[2*(I[me]+x+1)]++,R.dyn_dtree[2*M(q)]++),R.last_lit===R.lit_bufsize-1},n._tr_align=function(R){V(R,2,3),X(R,N,ue),(function(q){q.bi_valid===16?(J(q,q.bi_buf),q.bi_buf=0,q.bi_valid=0):8<=q.bi_valid&&(q.pending_buf[q.pending++]=255&q.bi_buf,q.bi_buf>>=8,q.bi_valid-=8)})(R)}},{"../utils/common":41}],53:[function(r,s,n){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,s,n){(function(o){(function(l,u){if(!l.setImmediate){var d,h,m,x,y=1,b={},v=!1,g=l.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(l);_=_&&_.setTimeout?_:l,d={}.toString.call(l.process)==="[object process]"?function(E){sr.nextTick(function(){S(E)})}:(function(){if(l.postMessage&&!l.importScripts){var E=!0,C=l.onmessage;return l.onmessage=function(){E=!1},l.postMessage("","*"),l.onmessage=C,E}})()?(x="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",N,!1):l.attachEvent("onmessage",N),function(E){l.postMessage(x+E,"*")}):l.MessageChannel?((m=new MessageChannel).port1.onmessage=function(E){S(E.data)},function(E){m.port2.postMessage(E)}):g&&"onreadystatechange"in g.createElement("script")?(h=g.documentElement,function(E){var C=g.createElement("script");C.onreadystatechange=function(){S(E),C.onreadystatechange=null,h.removeChild(C),C=null},h.appendChild(C)}):function(E){setTimeout(S,0,E)},_.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var C=new Array(arguments.length-1),F=0;F<C.length;F++)C[F]=arguments[F+1];var O={callback:E,args:C};return b[y]=O,d(y),y++},_.clearImmediate=w}function w(E){delete b[E]}function S(E){if(v)setTimeout(S,0,E);else{var C=b[E];if(C){v=!0;try{(function(F){var O=F.callback,B=F.args;switch(B.length){case 0:O();break;case 1:O(B[0]);break;case 2:O(B[0],B[1]);break;case 3:O(B[0],B[1],B[2]);break;default:O.apply(u,B)}})(C)}finally{w(E),v=!1}}}}function N(E){E.source===l&&typeof E.data=="string"&&E.data.indexOf(x)===0&&S(+E.data.slice(x.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof $n<"u"?$n:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(X1)),X1.exports}var gU=xU();const yU=bv(gU);var sd={exports:{}},Y1,NS;function vU(){if(NS)return Y1;NS=1;var e={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function t(r){return r&&r.replace?r.replace(/([&"<>'])/g,function(s,n){return e[n]}):r}return Y1=t,Y1}var kS;function bU(){if(kS)return sd.exports;kS=1;var e=vU(),t=Ev().Stream,r="    ";function s(h,m){typeof m!="object"&&(m={indent:m});var x=m.stream?new t:null,y="",b=!1,v=m.indent?m.indent===!0?r:m.indent:"",g=!0;function _(C){g?sr.nextTick(C):C()}function w(C,F){if(F!==void 0&&(y+=F),C&&!b&&(x=x||new t,b=!0),C&&b){var O=y;_(function(){x.emit("data",O)}),y=""}}function S(C,F){u(w,l(C,v,v?1:0),F)}function N(){if(x){var C=y;_(function(){x.emit("data",C),x.emit("end"),x.readable=!1,x.emit("close")})}}function E(C){var F=C.encoding||"UTF-8",O={version:"1.0",encoding:F};C.standalone&&(O.standalone=C.standalone),S({"?xml":{_attr:O}}),y=y.replace("/>","?>")}return _(function(){g=!1}),m.declaration&&E(m.declaration),h&&h.forEach?h.forEach(function(C,F){var O;F+1===h.length&&(O=N),S(C,O)}):S(h,N),x?(x.readable=!0,x):y}function n(){var h=Array.prototype.slice.call(arguments),m={_elem:l(h)};return m.push=function(x){if(!this.append)throw new Error("not assigned to a parent!");var y=this,b=this._elem.indent;u(this.append,l(x,b,this._elem.icount+(b?1:0)),function(){y.append(!0)})},m.close=function(x){x!==void 0&&this.push(x),this.end&&this.end()},m}function o(h,m){return new Array(m||0).join(h||"")}function l(h,m,x){x=x||0;var y=o(m,x),b,v=h,g=!1;if(typeof h=="object"){var _=Object.keys(h);if(b=_[0],v=h[b],v&&v._elem)return v._elem.name=b,v._elem.icount=x,v._elem.indent=m,v._elem.indents=y,v._elem.interrupt=v,v._elem}var w=[],S=[],N;function E(C){var F=Object.keys(C);F.forEach(function(O){w.push(d(O,C[O]))})}switch(typeof v){case"object":if(v===null)break;v._attr&&E(v._attr),v._cdata&&S.push(("<![CDATA["+v._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),v.forEach&&(N=!1,S.push(""),v.forEach(function(C){if(typeof C=="object"){var F=Object.keys(C)[0];F=="_attr"?E(C._attr):S.push(l(C,m,x+1))}else S.pop(),N=!0,S.push(e(C))}),N||S.push(""));break;default:S.push(e(v))}return{name:b,interrupt:g,attributes:w,content:S,icount:x,indents:y,indent:m}}function u(h,m,x){if(typeof m!="object")return h(!1,m);var y=m.interrupt?1:m.content.length;function b(){for(;m.content.length;){var g=m.content.shift();if(g!==void 0){if(v(g))return;u(h,g)}}h(!1,(y>1?m.indents:"")+(m.name?"</"+m.name+">":"")+(m.indent&&!x?`
`:"")),x&&x()}function v(g){return g.interrupt?(g.interrupt.append=h,g.interrupt.end=b,g.interrupt=!1,h(!0),!0):!1}if(h(!1,m.indents+(m.name?"<"+m.name:"")+(m.attributes.length?" "+m.attributes.join(" "):"")+(y?m.name?">":"":m.name?"/>":"")+(m.indent&&y>1?`
`:"")),!y)return h(!1,m.indent?`
`:"");v(m)||b()}function d(h,m){return h+'="'+e(m)+'"'}return sd.exports=s,sd.exports.element=sd.exports.Element=n,sd.exports}var wU=bU();const as=bv(wU),ad=0,J1=32,_U=32,NU=(e,t)=>{const r=t.replace(/-/g,"");if(r.length!==_U)throw new Error(`Error: Cannot extract GUID from font filename: ${t}`);const n=r.replace(/(..)/g,"$1 ").trim().split(" ").map(d=>parseInt(d,16));n.reverse();const l=e.slice(ad,J1).map((d,h)=>d^n[h%n.length]),u=new Uint8Array(ad+l.length+Math.max(0,e.length-J1));return u.set(e.slice(0,ad)),u.set(l,ad),u.set(e.slice(J1),ad+l.length),u};class kU{format(t,r={stack:[]}){const s=t.prepForXml(r);if(s)return s;throw Error("XMLComponent did not format correctly")}}class SU{replace(t,r,s){let n=t;return r.forEach((o,l)=>{n=n.replace(new RegExp(`{${o.fileName}}`,"g"),(s+l).toString())}),n}getMediaData(t,r){return r.Array.filter(s=>t.search(`{${s.fileName}}`)>0)}}class EU{replace(t,r){let s=t;for(const n of r)s=s.replace(new RegExp(`{${n.reference}-${n.instance}}`,"g"),n.numId.toString());return s}}class jU{constructor(){Ze(this,"formatter"),Ze(this,"imageReplacer"),Ze(this,"numberingReplacer"),this.formatter=new kU,this.imageReplacer=new SU,this.numberingReplacer=new EU}compile(t,r,s=[]){const n=new yU,o=this.xmlifyFile(t,r),l=new Map(Object.entries(o));for(const[,u]of l)if(Array.isArray(u))for(const d of u)n.file(d.path,d.data);else n.file(u.path,u.data);for(const u of s)n.file(u.path,u.data);for(const u of t.Media.Array)u.type!=="svg"?n.file(`word/media/${u.fileName}`,u.data):(n.file(`word/media/${u.fileName}`,u.data),n.file(`word/media/${u.fallback.fileName}`,u.fallback.data));for(const{data:u,name:d,fontKey:h}of t.FontTable.fontOptionsWithKey){const[m]=d.split(".");n.file(`word/fonts/${m}.odttf`,NU(u,h))}return n}xmlifyFile(t,r){const s=t.Document.Relationships.RelationshipCount+1,n=as(this.formatter.format(t.Document.View,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),o=t.Comments.Relationships.RelationshipCount+1,l=as(this.formatter.format(t.Comments,{viewWrapper:{View:t.Comments,Relationships:t.Comments.Relationships},file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),u=this.imageReplacer.getMediaData(n,t.Media),d=this.imageReplacer.getMediaData(l,t.Media);return{Relationships:{data:(u.forEach((h,m)=>{t.Document.Relationships.createRelationship(s+m,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${h.fileName}`)}),t.Document.Relationships.createRelationship(t.Document.Relationships.RelationshipCount+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable","fontTable.xml"),as(this.formatter.format(t.Document.Relationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const h=this.imageReplacer.replace(n,u,s);return this.numberingReplacer.replace(h,t.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const h=as(this.formatter.format(t.Styles,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(h,t.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:as(this.formatter.format(t.CoreProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:as(this.formatter.format(t.Numbering,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:as(this.formatter.format(t.FileRelationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:t.Headers.map((h,m)=>{const x=as(this.formatter.format(h.View,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(x,t.Media).forEach((b,v)=>{h.Relationships.createRelationship(v,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${b.fileName}`)}),{data:as(this.formatter.format(h.Relationships,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${m+1}.xml.rels`}}),FooterRelationships:t.Footers.map((h,m)=>{const x=as(this.formatter.format(h.View,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(x,t.Media).forEach((b,v)=>{h.Relationships.createRelationship(v,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${b.fileName}`)}),{data:as(this.formatter.format(h.Relationships,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${m+1}.xml.rels`}}),Headers:t.Headers.map((h,m)=>{const x=as(this.formatter.format(h.View,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),y=this.imageReplacer.getMediaData(x,t.Media),b=this.imageReplacer.replace(x,y,0);return{data:this.numberingReplacer.replace(b,t.Numbering.ConcreteNumbering),path:`word/header${m+1}.xml`}}),Footers:t.Footers.map((h,m)=>{const x=as(this.formatter.format(h.View,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),y=this.imageReplacer.getMediaData(x,t.Media),b=this.imageReplacer.replace(x,y,0);return{data:this.numberingReplacer.replace(b,t.Numbering.ConcreteNumbering),path:`word/footer${m+1}.xml`}}),ContentTypes:{data:as(this.formatter.format(t.ContentTypes,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:as(this.formatter.format(t.CustomProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:as(this.formatter.format(t.AppProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:as(this.formatter.format(t.FootNotes.View,{viewWrapper:t.FootNotes,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:as(this.formatter.format(t.FootNotes.Relationships,{viewWrapper:t.FootNotes,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:as(this.formatter.format(t.Settings,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:(()=>{const h=this.imageReplacer.replace(l,d,o);return this.numberingReplacer.replace(h,t.Numbering.ConcreteNumbering)})(),path:"word/comments.xml"},CommentsRelationships:{data:(d.forEach((h,m)=>{t.Comments.Relationships.createRelationship(o+m,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${h.fileName}`)}),as(this.formatter.format(t.Comments.Relationships,{viewWrapper:{View:t.Comments,Relationships:t.Comments.Relationships},file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/comments.xml.rels"},FontTable:{data:as(this.formatter.format(t.FontTable.View,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:as(this.formatter.format(t.FontTable.Relationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}}const TU={WITH_2_BLANKS:"  "},SS=e=>e===!0?TU.WITH_2_BLANKS:e===!1?void 0:e,Zj=class Cc{static pack(t,r,s){return $9(this,arguments,function*(n,o,l,u=[]){return this.compiler.compile(n,SS(l),u).generateAsync({type:o,mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toString(t,r,s=[]){return Cc.pack(t,"string",r,s)}static toBuffer(t,r,s=[]){return Cc.pack(t,"nodebuffer",r,s)}static toBase64String(t,r,s=[]){return Cc.pack(t,"base64",r,s)}static toBlob(t,r,s=[]){return Cc.pack(t,"blob",r,s)}static toArrayBuffer(t,r,s=[]){return Cc.pack(t,"arraybuffer",r,s)}static toStream(t,r,s=[]){const n=new pU.Stream;return this.compiler.compile(t,SS(r),s).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(l=>{n.emit("data",l),n.emit("end")}),n}};Ze(Zj,"compiler",new jU);let gm=Zj;var w0={exports:{}},AU=w0.exports,ES;function CU(){return ES||(ES=1,(function(e,t){(function(r,s){s()})(AU,function(){function r(h,m){return typeof m>"u"?m={autoBom:!1}:typeof m!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),m={autoBom:!m}),m.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function s(h,m,x){var y=new XMLHttpRequest;y.open("GET",h),y.responseType="blob",y.onload=function(){d(y.response,m,x)},y.onerror=function(){console.error("could not download file")},y.send()}function n(h){var m=new XMLHttpRequest;m.open("HEAD",h,!1);try{m.send()}catch{}return 200<=m.status&&299>=m.status}function o(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var m=document.createEvent("MouseEvents");m.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(m)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Ch=="object"&&Ch.global===Ch?Ch:void 0,u=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(h,m,x){var y=l.URL||l.webkitURL,b=document.createElement("a");m=m||h.name||"download",b.download=m,b.rel="noopener",typeof h=="string"?(b.href=h,b.origin===location.origin?o(b):n(b.href)?s(h,m,x):o(b,b.target="_blank")):(b.href=y.createObjectURL(h),setTimeout(function(){y.revokeObjectURL(b.href)},4e4),setTimeout(function(){o(b)},0))}:"msSaveOrOpenBlob"in navigator?function(h,m,x){if(m=m||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(r(h,x),m);else if(n(h))s(h,m,x);else{var y=document.createElement("a");y.href=h,y.target="_blank",setTimeout(function(){o(y)})}}:function(h,m,x,y){if(y=y||open("","_blank"),y&&(y.document.title=y.document.body.innerText="downloading..."),typeof h=="string")return s(h,m,x);var b=h.type==="application/octet-stream",v=/constructor/i.test(l.HTMLElement)||l.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||b&&v||u)&&typeof FileReader<"u"){var _=new FileReader;_.onloadend=function(){var N=_.result;N=g?N:N.replace(/^data:[^;]*;/,"data:attachment/file;"),y?y.location.href=N:location=N,y=null},_.readAsDataURL(h)}else{var w=l.URL||l.webkitURL,S=w.createObjectURL(h);y?y.location=S:location.href=S,y=null,setTimeout(function(){w.revokeObjectURL(S)},4e4)}});l.saveAs=d.saveAs=d,e.exports=d})})(w0)),w0.exports}var ym=CU();const Fv=()=>({content:"",progress:"",remark:""}),qn=()=>({title:"",details:[Fv()]}),B0=e=>{const t=e.filter(r=>r.title.trim()||r.details.some(s=>s.content.trim()));return t.length>0?JSON.stringify(t):""},zn=e=>{if(!e)return[qn()];const t=r=>{if(!r.length)return[qn()];if(typeof r[0]=="object"){if("details"in r[0])return r;if("content"in r[0])return r.map(s=>({title:s.title||"",details:[{content:s.content||"",progress:s.progress||"",remark:s.remark||""}]}))}return[qn()]};if(Array.isArray(e))return t(e);if(typeof e=="string"){try{const r=JSON.parse(e);if(Array.isArray(r)&&r.length>0)return t(r)}catch{}return[{title:"",details:[{content:e,progress:"",remark:""}]}]}return[qn()]},P0=e=>{if(!e)return"-";const t=r=>{if(!r.length)return"-";const s=r[0],n=r.length>1?`  ${r.length-1}`:"";return s&&"details"in s?((s.title||s.details?.[0]?.content||"-")+n).substring(0,80):s&&"content"in s?((s.title||s.content)+n).substring(0,80):"-"};if(Array.isArray(e))return t(e);if(typeof e=="string"){try{const s=JSON.parse(e);if(Array.isArray(s))return t(s)}catch{}return(e.split(`
`).filter(s=>s.trim()&&!s.startsWith("---"))[0]||e).substring(0,80)}return"-"},Z1=e=>e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>"):"",Qj=e=>{const t=zn(e);return!t||t.length===0?'<p style="color: #666; padding: 15px;">-</p>':`<table style="width:100%;border-collapse:collapse;font-size:13px">
        <thead><tr>
            <th style="background:#fafafa;font-weight:600;padding:8px;border:1px solid #333;width:40px">No</th>
            <th style="background:#fafafa;font-weight:600;padding:8px;border:1px solid #333"></th>
            <th style="background:#fafafa;font-weight:600;padding:8px;border:1px solid #333;width:60px"></th>
            <th style="background:#fafafa;font-weight:600;padding:8px;border:1px solid #333;width:25%"></th>
        </tr></thead>
        <tbody>${t.map((s,n)=>{const o=(s.title?1:0)+s.details.length,l=[];return s.title&&l.push(`<tr>
                <td style="text-align:center;vertical-align:top;padding:8px;border:1px solid #333;width:40px" rowspan="${o}">${n+1}</td>
                <td style="text-align:left;font-weight:bold;padding:8px 10px;border:1px solid #333">[${Z1(s.title)}]</td>
                <td style="text-align:center;padding:8px;border:1px solid #333;width:60px"></td>
                <td style="padding:8px 10px;border:1px solid #333;width:25%"></td>
            </tr>`),s.details.forEach((u,d)=>{const h=(u.content||"-").split(`
`).map(x=>x.trim()?`- ${Z1(x)}`:"").filter(Boolean).join("<br/>"),m=!s.title&&d===0?`<td style="text-align:center;vertical-align:top;padding:8px;border:1px solid #333;width:40px" rowspan="${o}">${n+1}</td>`:"";l.push(`<tr>
                ${m}
                <td style="text-align:left;padding:8px 10px;border:1px solid #333;white-space:pre-line">${h}</td>
                <td style="text-align:center;padding:8px;border:1px solid #333;width:60px">${u.progress?u.progress+"%":"-"}</td>
                <td style="padding:8px 10px;border:1px solid #333;width:25%">${Z1(u.remark)||"-"}</td>
            </tr>`)}),l.join("")}).join("")}</tbody>
    </table>`},Lv=e=>{const t=new Date(e),r=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${r}${s}${n}`},RU=(e,t,r)=>{const s=l=>l?l.split(`
`).map(u=>`<p style="margin: 0 0 8px 0; line-height: 1.8;">${u.replace(/</g,"&lt;").replace(/>/g,"&gt;")||"&nbsp;"}</p>`).join(""):'<p style="color: #666;">-</p>',n=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>  - ${t(e.work_date)}</title>
    <style>
        @page {
            size: A4;
            margin: 25mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', 'Apple SD Gothic Neo', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #000;
            background: #fff;
        }

        .date-header {
            text-align: right;
            font-size: 13px;
            color: #666;
            margin-bottom: 10px;
        }

        .title-section {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #333;
        }
        .main-title {
            font-size: 26px;
            font-weight: bold;
            letter-spacing: 12px;
            color: #1a1a1a;
        }

        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .info-table td {
            border: 1px solid #333;
            padding: 10px 15px;
            font-size: 14px;
        }
        .info-table .label {
            background-color: #f8f9fa;
            font-weight: 600;
            text-align: center;
            width: 15%;
        }
        .info-table .value {
            width: 35%;
        }

        .content-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .content-table td {
            border: 1px solid #333;
            padding: 0;
            font-size: 14px;
            vertical-align: top;
        }
        .content-table .section-title {
            background-color: #f8f9fa;
            font-weight: 600;
            padding: 12px 15px;
        }
        .content-table .section-body {
            padding: 20px;
            min-height: 50px;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            p {
                page-break-inside: avoid;
                orphans: 2;
                widows: 2;
            }
        }
    </style>
</head>
<body>
    <div class="date-header">
        : ${Lv(e.work_date)}
    </div>

    <div class="title-section">
        <h1 class="main-title">      </h1>
    </div>

    <table class="info-table">
        <tr>
            <td class="label"></td>
            <td class="value">${t(e.work_date)}</td>
            <td class="label"></td>
            <td class="value">${e.user?.team||"-"}</td>
        </tr>
        <tr>
            <td class="label"></td>
            <td class="value">${e.user?.rank||"-"}</td>
            <td class="label"></td>
            <td class="value">${e.user?.name||"-"}</td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.    </td>
        </tr>
        <tr>
            <td class="section-body" style="padding:0;">
                ${Qj(e.morning_work)}
            </td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.  </td>
        </tr>
        <tr>
            <td class="section-body">
                ${s(e.this_week_work)}
            </td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.   </td>
        </tr>
        <tr>
            <td class="section-body">
                ${s(e.special_notes)}
            </td>
        </tr>
    </table>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,o=window.open("","_blank","width=900,height=700");o.document.write(n),o.document.close()},DU=(e,t,r)=>{const s=l=>l?l.split(`
`).map(u=>`<p style="margin: 0 0 8px 0; line-height: 1.8;">${u.replace(/</g,"&lt;").replace(/>/g,"&gt;")||"&nbsp;"}</p>`).join(""):'<p style="color: #666;">-</p>',n=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>  - ${t(e.work_date)}</title>
    <style>
        @page {
            size: A4;
            margin: 25mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', 'Apple SD Gothic Neo', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #000;
            background: #fff;
        }

        .date-header {
            text-align: right;
            font-size: 13px;
            color: #666;
            margin-bottom: 10px;
        }

        .title-section {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #333;
        }
        .main-title {
            font-size: 26px;
            font-weight: bold;
            letter-spacing: 12px;
            color: #1a1a1a;
        }

        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .info-table td {
            border: 1px solid #333;
            padding: 10px 15px;
            font-size: 14px;
        }
        .info-table .label {
            background-color: #f8f9fa;
            font-weight: 600;
            text-align: center;
            width: 15%;
        }
        .info-table .value {
            width: 35%;
        }

        .content-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .content-table td {
            border: 1px solid #333;
            padding: 0;
            font-size: 14px;
            vertical-align: top;
        }
        .content-table .section-title {
            background-color: #f8f9fa;
            font-weight: 600;
            padding: 12px 15px;
        }
        .content-table .section-body {
            padding: 20px;
            min-height: 50px;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            p {
                page-break-inside: avoid;
                orphans: 2;
                widows: 2;
            }
        }
    </style>
</head>
<body>
    <div class="date-header">
        : ${Lv(e.work_date)}
    </div>

    <div class="title-section">
        <h1 class="main-title">      </h1>
    </div>

    <table class="info-table">
        <tr>
            <td class="label"></td>
            <td class="value">${t(e.work_date)}</td>
            <td class="label"></td>
            <td class="value">${e.user?.team||"-"}</td>
        </tr>
        <tr>
            <td class="label"></td>
            <td class="value">${e.user?.rank||"-"}</td>
            <td class="label"></td>
            <td class="value">${e.user?.name||"-"}</td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.    </td>
        </tr>
        <tr>
            <td class="section-body" style="padding:0;">
                ${Qj(e.morning_work)}
            </td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.   </td>
        </tr>
        <tr>
            <td class="section-body">
                ${s(e.special_notes)}
            </td>
        </tr>
    </table>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,o=window.open("","_blank","width=900,height=700");o.document.write(n),o.document.close()},OU=(e,t)=>{const r=`
---TASK---
`,s=u=>{if(!u)return'<tr><td colspan="3" style="text-align: center; color: #666; padding: 15px;">-</td></tr>';const h=u.includes("---TASK---")?u.split(r).filter(m=>m.trim()):u.split(`
`).filter(m=>m.trim());return h.length===0?'<tr><td colspan="3" style="text-align: center; color: #666; padding: 15px;">-</td></tr>':h.map((m,x)=>{const y=m.trim().split(`
`),v=y[y.length-1].match(/^(.+?)\s*\((\d+)%\)$/);let g=m.trim(),_="-";v&&y.length===1?(g=v[1].trim(),_=v[2]+"%"):v&&y.length>1&&(y[y.length-1]=v[1].trim(),g=y.join(`
`),_=v[2]+"%");const w=g.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>");return`
                <tr>
                    <td style="width: 40px; text-align: center; padding: 8px; border: 1px solid #333;">${x+1}</td>
                    <td style="padding: 8px 10px; border: 1px solid #333;">${w}</td>
                    <td style="width: 60px; text-align: center; padding: 8px; border: 1px solid #333;">${_}</td>
                </tr>
            `}).join("")},n=u=>u?u.split(`
`).map(d=>`<p style="margin: 0 0 8px 0; line-height: 1.8;">${d.replace(/</g,"&lt;").replace(/>/g,"&gt;")||"&nbsp;"}</p>`).join(""):'<p style="color: #666;">-</p>',o=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>  - ${t(e.work_date)}</title>
    <style>
        @page {
            size: A4;
            margin: 25mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', 'Apple SD Gothic Neo', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #000;
            background: #fff;
        }

        .date-header {
            text-align: right;
            font-size: 13px;
            color: #666;
            margin-bottom: 10px;
        }

        .title-section {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #333;
        }
        .main-title {
            font-size: 26px;
            font-weight: bold;
            letter-spacing: 12px;
            color: #1a1a1a;
        }

        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .info-table td {
            border: 1px solid #333;
            padding: 10px 15px;
            font-size: 14px;
        }
        .info-table .label {
            background-color: #f8f9fa;
            font-weight: 600;
            text-align: center;
            width: 15%;
        }
        .info-table .value {
            width: 35%;
        }

        .content-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .content-table td, .content-table th {
            border: 1px solid #333;
            padding: 0;
            font-size: 13px;
            vertical-align: top;
        }
        .content-table .section-title {
            background-color: #f8f9fa;
            font-weight: 600;
            padding: 12px 15px;
            text-align: left;
        }
        .content-table .section-body {
            padding: 15px;
            min-height: 30px;
        }
        .content-table .subheader {
            background-color: #fafafa;
            font-weight: 600;
            padding: 8px;
            text-align: center;
        }

        .task-table {
            width: 100%;
            border-collapse: collapse;
        }
        .task-table td, .task-table th {
            border: 1px solid #333;
            font-size: 13px;
        }
        .task-table th {
            background-color: #fafafa;
            font-weight: 600;
            padding: 8px;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            tr {
                page-break-inside: avoid;
            }
            p {
                page-break-inside: avoid;
                orphans: 2;
                widows: 2;
            }
        }
    </style>
</head>
<body>
    <div class="date-header">
        : ${Lv(e.work_date)}
    </div>

    <div class="title-section">
        <h1 class="main-title">      </h1>
    </div>

    <table class="info-table">
        <tr>
            <td class="label"></td>
            <td class="value">${t(e.work_date)}</td>
            <td class="label"></td>
            <td class="value">${e.user?.team||"-"}</td>
        </tr>
        <tr>
            <td class="label"></td>
            <td class="value">${e.user?.rank||"-"}</td>
            <td class="label"></td>
            <td class="value">${e.user?.name||"-"}</td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title" colspan="3">.  </td>
        </tr>
    </table>
    <table class="task-table">
        <thead>
            <tr>
                <th style="width: 40px;">No</th>
                <th> </th>
                <th style="width: 60px;"></th>
            </tr>
        </thead>
        <tbody>
            ${s(e.morning_work)}
        </tbody>
    </table>

    <table class="content-table" style="margin-top: 15px;">
        <tr>
            <td class="section-title" colspan="3">.  </td>
        </tr>
    </table>
    <table class="task-table">
        <thead>
            <tr>
                <th style="width: 40px;">No</th>
                <th> </th>
                <th style="width: 60px;"></th>
            </tr>
        </thead>
        <tbody>
            ${s(e.afternoon_work)}
        </tbody>
    </table>

    <table class="content-table" style="margin-top: 15px;">
        <tr>
            <td class="section-title">.  </td>
        </tr>
        <tr>
            <td class="section-body">
                ${n(e.next_day_work)}
            </td>
        </tr>
    </table>

    <table class="content-table" style="margin-top: 15px;">
        <tr>
            <td class="section-title">.   </td>
        </tr>
        <tr>
            <td class="section-body">
                ${n(e.special_notes)}
            </td>
        </tr>
    </table>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,l=window.open("","_blank","width=900,height=700");l.document.write(o),l.document.close()},FU=e=>e?e.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0","").replace("?dl=1","").replace("&dl=1",""):"",Bc=e=>{let t="";return typeof e=="string"?t=e:e&&e.url&&(t=e.url),FU(t)},Hy=e=>{const t=Bc(e);if(!t)return!1;const r=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],s=t.toLowerCase();return r.some(n=>s.includes(n))},LU=({urls:e})=>{const t=K.useRef(null),[r,s]=K.useState(!1),[n,o]=K.useState(!1),[l,u]=K.useState(null),[d,h]=K.useState(!1),[m,x]=K.useState(0),[y,b]=K.useState(0),v=e.filter(Hy),g=e.filter(A=>!Hy(A)),_=()=>{if(t.current){const{scrollLeft:A,scrollWidth:Y,clientWidth:I}=t.current;s(A>0),o(A<Y-I-10)}};K.useEffect(()=>(_(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)),[e]),K.useEffect(()=>{const A=Y=>{l!==null&&(Y.key==="ArrowLeft"&&E(),Y.key==="ArrowRight"&&C(),Y.key==="Escape"&&N())};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[l,v.length]);const w=A=>{t.current&&(t.current.scrollBy({left:A==="left"?-200:200,behavior:"smooth"}),setTimeout(_,300))},S=A=>{u(A),b(0)},N=()=>{u(null),b(0)},E=()=>{b(0),u(A=>A>0?A-1:v.length-1)},C=()=>{b(0),u(A=>A<v.length-1?A+1:0)},F=A=>{v.length<=1||(h(!0),x(A.clientX))},O=A=>{v.length<=1||(h(!0),x(A.touches[0].clientX))},B=A=>{if(!d)return;const Y=A-m;b(Y)},L=A=>{B(A.clientX)},H=A=>{B(A.touches[0].clientX)},ue=()=>{if(!d)return;h(!1);const A=100;y>A?E():y<-A?C():b(0)};return v.length===0&&g.length===0?null:a.jsxs("div",{className:"space-y-3",children:[v.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:[" (",v.length,")"]}),a.jsxs("div",{className:"relative",children:[r&&a.jsx("button",{onClick:()=>w("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:a.jsx(xa,{size:20})}),a.jsx("div",{ref:t,onScroll:_,className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:v.map((A,Y)=>{const I=Bc(A);return a.jsx("div",{className:"flex-shrink-0 cursor-pointer w-24 h-24 sm:w-32 sm:h-32 rounded-xl overflow-hidden bg-toss-gray-100",onClick:()=>S(Y),children:a.jsx("img",{src:I,alt:`  ${Y+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:ae=>{ae.target.style.display="none"}})},Y)})}),n&&a.jsx("button",{onClick:()=>w("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:a.jsx(Js,{size:20})})]})]}),g.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:["  (",g.length,")"]}),a.jsx("div",{className:"space-y-2",children:g.map((A,Y)=>{const I=Bc(A),ae=typeof A=="string"?I.split("/").pop():A.name||I.split("/").pop();return a.jsxs("a",{href:I,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors",children:[a.jsx(Ea,{size:16,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-sm text-toss-blue hover:underline flex-1 truncate",children:ae}),a.jsx(Jr,{size:16,className:"text-toss-gray-500"})]},Y)})})]}),l!==null&&a.jsxs("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center select-none",style:{zIndex:9999},onClick:N,onMouseUp:ue,onMouseLeave:ue,onTouchEnd:ue,children:[a.jsx("button",{className:"absolute top-4 right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors",onClick:N,children:a.jsx(mr,{size:24})}),a.jsxs("div",{className:"absolute top-4 left-4 z-10 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm font-medium",children:[l+1," / ",v.length]}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[v.length>1&&a.jsx("button",{onClick:A=>{A.stopPropagation(),E()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:a.jsx(xa,{size:36,strokeWidth:3})}),a.jsx("div",{onClick:A=>A.stopPropagation(),onMouseDown:F,onMouseMove:L,onTouchStart:O,onTouchMove:H,className:"max-w-[70vw] sm:max-w-[80vw] max-h-[90vh] relative cursor-grab active:cursor-grabbing",style:{transform:`translateX(${y}px)`,transition:d?"none":"transform 0.3s ease-out"},children:a.jsx("img",{src:Bc(v[l]),alt:`  ${l+1}`,className:"max-w-full max-h-[90vh] object-contain rounded-lg pointer-events-none",draggable:!1})}),v.length>1&&a.jsx("button",{onClick:A=>{A.stopPropagation(),C()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:a.jsx(Js,{size:36,strokeWidth:3})})]}),v.length>1&&a.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2",children:v.map((A,Y)=>a.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${Y===l?"bg-white":"bg-white/30"}`},Y))})]})]})},IU=()=>{const{profile:e,isAdmin:t}=qr(),[r,s]=K.useState([]),[n,o]=K.useState([]),[l,u]=K.useState(!1),[d,h]=K.useState(!1),[m,x]=K.useState(!0),[y,b]=K.useState(!1),[v,g]=K.useState(null),[_,w]=K.useState(new Date().getFullYear()),[S,N]=K.useState(new Date().getMonth()+1),[E,C]=K.useState("all"),[F,O]=K.useState(1),B=15,L=K.useRef(null),[H,ue]=K.useState({isOpen:!1,message:"",type:"info"}),A=(oe,Ne="info")=>{ue({isOpen:!0,message:oe,type:Ne})},[Y,I]=K.useState({isOpen:!1,worklog:null}),ae=()=>{const oe=new Date,Ne=oe.getFullYear(),xe=String(oe.getMonth()+1).padStart(2,"0"),je=String(oe.getDate()).padStart(2,"0");return`${Ne}-${xe}-${je}`},[Q,re]=K.useState({work_date:ae(),morning_tasks:[{content:"",progress:""}],afternoon_tasks:[{content:"",progress:""}],next_day_work:"",special_notes:"",files:[],existingFileUrls:[]}),ve=e?.name==="",[te,ke]=K.useState({work_date:ae(),morning_work:"",afternoon_work:"",next_day_work:"",special_notes:"",files:[],existingFileUrls:[]}),Z=oe=>{re(Ne=>({...Ne,[oe]:[...Ne[oe],{content:"",progress:""}]}))},M=(oe,Ne)=>{re(xe=>({...xe,[oe]:xe[oe].filter((je,fe)=>fe!==Ne)}))},J=(oe,Ne,xe,je)=>{re(fe=>({...fe,[oe]:fe[oe].map((Oe,Ue)=>Ue===Ne?{...Oe,[xe]:je}:Oe)}))},V=`
---TASK---
`,X=oe=>oe.filter(Ne=>Ne.content.trim()).map(Ne=>Ne.progress?`${Ne.content} (${Ne.progress}%)`:Ne.content).join(V),se=oe=>{if(!oe)return[{content:"",progress:""}];const Ne=oe.includes("---TASK---");let xe;return Ne?xe=oe.split(V).filter(je=>je.trim()):/^\d+\.\s*/m.test(oe)?(xe=oe.split(/\n(?=\d+\.\s*)/).filter(fe=>fe.trim()),xe=xe.map(fe=>fe.replace(/^\d+\.\s*/,"").trim())):xe=[oe],xe.length===0||xe.length===1&&!xe[0].trim()?[{content:"",progress:""}]:xe.map(je=>{const fe=je.trim().split(`
`),Ue=fe[fe.length-1].match(/^(.+?)\s*\((\d+)%\)$/);return Ue&&fe.length===1?{content:Ue[1].trim(),progress:Ue[2]}:Ue&&fe.length>1?(fe[fe.length-1]=Ue[1].trim(),{content:fe.join(`
`),progress:Ue[2]}):{content:je.trim(),progress:""}})},P=oe=>oe?oe.replace(/\n---TASK---\n/g,", ").replace(/\n/g," "):"-",U=2026,ce=new Date().getFullYear(),ne=Array.from({length:ce-U+1},(oe,Ne)=>U+Ne),ie=Array.from({length:12},(oe,Ne)=>Ne+1);K.useEffect(()=>{k()},[]),K.useEffect(()=>{W()},[r,_,S,E]);const W=()=>{const oe=r.filter(Ne=>{const xe=new Date(Ne.work_date),je=xe.getFullYear()===_&&xe.getMonth()+1===S,fe=E==="all"||Ne.user_id===E;return je&&fe});o(oe),O(1)},G=Array.from(new Set(r.map(oe=>oe.user_id))).map(oe=>{const Ne=r.find(xe=>xe.user_id===oe);return{user_id:oe,name:Ne?.user?.name||"  "}}).sort((oe,Ne)=>oe.name.localeCompare(Ne.name)),k=async()=>{try{let oe=Pe.from("work_logs").select("*").not("type","in",'("weekly","monthly","rescue")').order("work_date",{ascending:!1});!t&&e&&(oe=oe.eq("user_id",e.user_id));const{data:Ne,error:xe}=await oe;if(xe)throw xe;const{data:je,error:fe}=await Pe.from("users").select("user_id, name, team, rank");if(fe)throw fe;const Oe=Ne.map(Ue=>{const st=je.find(pt=>pt.user_id===Ue.user_id);return{...Ue,user:st||{name:"  ",team:"-",rank:"-"}}});s(Oe||[])}catch(oe){console.error("Error fetching worklogs:",oe)}finally{x(!1)}},de=oe=>{const xe=Array.from(oe.target.files).map(je=>({file:je,name:je.name,size:(je.size/1024).toFixed(0)+"KB"}));ve?ke(je=>({...je,files:[...je.files,...xe]})):re(je=>({...je,files:[...je.files,...xe]}))},z=oe=>{ve?ke(Ne=>({...Ne,files:Ne.files.filter((xe,je)=>je!==oe)})):re(Ne=>({...Ne,files:Ne.files.filter((xe,je)=>je!==oe)}))},T=oe=>{re(Ne=>({...Ne,existingFileUrls:Ne.existingFileUrls.filter((xe,je)=>je!==oe)}))},R=async oe=>{const Ne=`/intranet/worklogs/${e.user_id}`;return(await af(oe.map(je=>je.file),Ne)).map(je=>je.url)},q=async()=>{if(ve){const fe=te.morning_work.trim(),Oe=te.afternoon_work.trim();if(!fe&&!Oe){A("      .","error");return}try{b(!0);let Ue=[];te.files.length>0&&(Ue=await R(te.files));const{error:st}=await Pe.from("work_logs").insert({work_date:te.work_date,morning_work:fe,afternoon_work:Oe,next_day_work:te.next_day_work,special_notes:te.special_notes,file_urls:Ue,user_id:e.user_id,type:"daily",is_read:!1});if(st)throw st;u(!1),_e(),k(),A(" .","success")}catch(Ue){console.error("Error creating worklog:",Ue),A("  : "+Ue.message,"error")}finally{b(!1)}return}const oe=X(Q.morning_tasks),Ne=X(Q.afternoon_tasks);if(!oe&&!Ne){A("      .","error");return}const xe=Q.morning_tasks.filter(fe=>fe.content.trim()),je=Q.afternoon_tasks.filter(fe=>fe.content.trim());if(xe.some(fe=>!fe.progress)||je.some(fe=>!fe.progress)){A("   (%) .","error");return}try{b(!0);let fe=[];Q.files.length>0&&(fe=await R(Q.files));const{error:Oe}=await Pe.from("work_logs").insert({work_date:Q.work_date,morning_work:oe,afternoon_work:Ne,next_day_work:Q.next_day_work,special_notes:Q.special_notes,file_urls:fe,user_id:e.user_id,type:"daily",is_read:!1});if(Oe)throw Oe;u(!1),_e(),k(),A(" .","success")}catch(fe){console.error("Error creating worklog:",fe),A("  : "+fe.message,"error")}finally{b(!1)}},me=async()=>{if(!v?.id){A("    .  .","error");return}const oe=v.id;if(ve){const Oe=te.morning_work.trim(),Ue=te.afternoon_work.trim();if(!Oe&&!Ue){A("      .","error");return}try{b(!0);let st=[];te.files.length>0&&(st=await R(te.files));const pt=[...te.existingFileUrls,...st],{error:Nt}=await Pe.from("work_logs").update({work_date:te.work_date,morning_work:Oe,afternoon_work:Ue,next_day_work:te.next_day_work,special_notes:te.special_notes,file_urls:pt}).eq("id",oe);if(Nt)throw Nt;u(!1),_e(),k(),A(" .","success")}catch(st){console.error("Error updating worklog:",st),A("  : "+st.message,"error")}finally{b(!1)}return}const Ne=X(Q.morning_tasks),xe=X(Q.afternoon_tasks);if(!Ne&&!xe){A("      .","error");return}const je=Q.morning_tasks.filter(Oe=>Oe.content.trim()),fe=Q.afternoon_tasks.filter(Oe=>Oe.content.trim());if(je.some(Oe=>!Oe.progress)||fe.some(Oe=>!Oe.progress)){A("   (%) .","error");return}try{b(!0);let Oe=[];Q.files.length>0&&(Oe=await R(Q.files));const Ue=[...Q.existingFileUrls,...Oe],{error:st}=await Pe.from("work_logs").update({work_date:Q.work_date,morning_work:Ne,afternoon_work:xe,next_day_work:Q.next_day_work,special_notes:Q.special_notes,file_urls:Ue}).eq("id",oe);if(st)throw st;u(!1),_e(),k(),A(" .","success")}catch(Oe){console.error("Error updating worklog:",Oe),A("  : "+Oe.message,"error")}finally{b(!1)}},_e=()=>{re({work_date:ae(),morning_tasks:[{content:"",progress:""}],afternoon_tasks:[{content:"",progress:""}],next_day_work:"",special_notes:"",files:[],existingFileUrls:[]}),ke({work_date:ae(),morning_work:"",afternoon_work:"",next_day_work:"",special_notes:"",files:[],existingFileUrls:[]}),h(!1),g(null)},le=oe=>{ke({work_date:oe.work_date,morning_work:oe.morning_work||"",afternoon_work:oe.afternoon_work||"",next_day_work:oe.next_day_work||"",special_notes:oe.special_notes||"",files:[],existingFileUrls:oe.file_urls||[]}),re({work_date:oe.work_date,morning_tasks:se(oe.morning_work),afternoon_tasks:se(oe.afternoon_work),next_day_work:oe.next_day_work||"",special_notes:oe.special_notes||"",files:[],existingFileUrls:oe.file_urls||[]}),g(oe),h(!0),u(!0)},Ae=()=>{_e(),u(!0)},Me=()=>{const oe=r.filter(xe=>xe.user_id===e?.user_id);if(oe.length===0){A("   .","info");return}const Ne=oe[0];ve?ke(xe=>({...xe,morning_work:Ne.morning_work||"",afternoon_work:Ne.afternoon_work||"",next_day_work:Ne.next_day_work||"",special_notes:""})):re(xe=>({...xe,morning_tasks:se(Ne.morning_work),afternoon_tasks:se(Ne.afternoon_work),next_day_work:Ne.next_day_work||"",special_notes:""})),A("  .","success")},Ee=(oe,Ne,xe)=>{const je=Q[Ne],fe=xe===je.length-1;oe.key==="Tab"&&!oe.shiftKey&&fe&&(oe.preventDefault(),Z(Ne),setTimeout(()=>{const Oe=Ne==="morning_tasks"?`[data-morning-task="${xe+1}"]`:`[data-afternoon-task="${xe+1}"]`;document.querySelector(Oe)?.focus()},0))},Ce=oe=>{I({isOpen:!0,worklog:oe})},Je=async()=>{const oe=Y.worklog;if(oe){I({isOpen:!1,worklog:null});try{oe.file_urls&&oe.file_urls.length>0&&await om(oe.file_urls);const{error:Ne}=await Pe.from("work_logs").delete().eq("id",oe.id);if(Ne)throw Ne;k(),A(".","success")}catch(Ne){console.error("Error deleting worklog:",Ne),A(" .","error")}}},$e=async oe=>{g(oe),t&&!oe.is_read&&(await Pe.from("work_logs").update({is_read:!0}).eq("id",oe.id),k())},tt=oe=>{OU(oe,vt)},De=async oe=>{const Ne=`https://khwzdwewgadvpglptvua.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(oe)}`,xe=await fetch(Ne);if(!xe.ok)throw new Error(`  : ${xe.status}`);return await xe.arrayBuffer()},ft=async oe=>{const Ne={top:{style:nr.SINGLE,size:1,color:"000000"},bottom:{style:nr.SINGLE,size:1,color:"000000"},left:{style:nr.SINGLE,size:1,color:"000000"},right:{style:nr.SINGLE,size:1,color:"000000"}},xe=pt=>{if(!pt)return[new pr({children:[new gt({children:[new ot({text:"-",alignment:Ft.CENTER})],width:{size:600,type:Bt.DXA},borders:Ne}),new gt({children:[new ot({text:""})],borders:Ne}),new gt({children:[new ot({text:"-",alignment:Ft.CENTER})],width:{size:1e3,type:Bt.DXA},borders:Ne})]})];const Vt=pt.includes("---TASK---")?pt.split(V).filter(yr=>yr.trim()):pt.split(`
`).filter(yr=>yr.trim());return Vt.length===0?[new pr({children:[new gt({children:[new ot({text:"-",alignment:Ft.CENTER})],width:{size:600,type:Bt.DXA},borders:Ne}),new gt({children:[new ot({text:""})],borders:Ne}),new gt({children:[new ot({text:"-",alignment:Ft.CENTER})],width:{size:1e3,type:Bt.DXA},borders:Ne})]})]:Vt.map((yr,_r)=>{const zt=yr.trim().split(`
`),Sr=zt[zt.length-1].match(/^(.+?)\s*\((\d+)%\)$/);let Zr=yr.trim(),he="-";Sr&&zt.length===1?(Zr=Sr[1].trim(),he=Sr[2]+"%"):Sr&&zt.length>1&&(zt[zt.length-1]=Sr[1].trim(),Zr=zt.join(`
`),he=Sr[2]+"%");const we=Zr.split(`
`).map(ye=>new ot({text:ye}));return new pr({children:[new gt({children:[new ot({text:String(_r+1),alignment:Ft.CENTER})],width:{size:600,type:Bt.DXA},borders:Ne}),new gt({children:we,borders:Ne}),new gt({children:[new ot({text:he,alignment:Ft.CENTER})],width:{size:1e3,type:Bt.DXA},borders:Ne})]})})},je=[],fe=[];if(oe.file_urls&&oe.file_urls.length>0){const pt=oe.file_urls.filter(Nt=>{const Vt=Bc(Nt);return Hy({url:Vt})});for(const Nt of pt)try{const Vt=Bc(Nt),yr=await De(Vt),_r=new Blob([yr]),zt=URL.createObjectURL(_r),fr=new Image;fr.src=zt,await new Promise((He,Ke)=>{fr.onload=He,fr.onerror=Ke});const Sr=240,Zr=320;let he=fr.width,we=fr.height;const ye=Math.min(Sr/he,Zr/we,1);he=Math.round(he*ye),we=Math.round(we*ye);const be=document.createElement("canvas"),Se=be.getContext("2d");be.width=he,be.height=we,Se.drawImage(fr,0,0,he,we);let Te=.7,We=await new Promise(He=>{be.toBlob(He,"image/jpeg",Te)});const at=300*1024;for(;We.size>at&&Te>.3;)Te-=.1,We=await new Promise(He=>{be.toBlob(He,"image/jpeg",Te)});const qe=await We.arrayBuffer();URL.revokeObjectURL(zt),je.push({data:qe,width:he,height:we})}catch(Vt){console.error("  :",Vt);const yr=typeof Nt=="string"?Nt.split("/").pop():Nt.name||"";fe.push(yr)}}const Oe=[];for(let pt=0;pt<je.length;pt+=2){const Nt=[];Nt.push(new gt({children:[new ot({children:[new dS({data:je[pt].data,transformation:{width:je[pt].width,height:je[pt].height},type:"jpg"})],alignment:Ft.CENTER})],width:{size:50,type:Bt.PERCENTAGE},borders:{top:{style:nr.NONE},bottom:{style:nr.NONE},left:{style:nr.NONE},right:{style:nr.NONE}}})),pt+1<je.length?Nt.push(new gt({children:[new ot({children:[new dS({data:je[pt+1].data,transformation:{width:je[pt+1].width,height:je[pt+1].height},type:"jpg"})],alignment:Ft.CENTER})],width:{size:50,type:Bt.PERCENTAGE},borders:{top:{style:nr.NONE},bottom:{style:nr.NONE},left:{style:nr.NONE},right:{style:nr.NONE}}})):Nt.push(new gt({children:[new ot({text:""})],width:{size:50,type:Bt.PERCENTAGE},borders:{top:{style:nr.NONE},bottom:{style:nr.NONE},left:{style:nr.NONE},right:{style:nr.NONE}}})),Oe.push(new pr({children:Nt}))}const Ue=new xm({sections:[{properties:{},children:[new ot({children:[new Dt({text:"      ",bold:!0,size:48})],alignment:Ft.CENTER,spacing:{after:400},border:{bottom:{style:nr.SINGLE,size:12,color:"333333"}}}),new ot({text:"",spacing:{after:200}}),new Sa({rows:[new pr({children:[new gt({children:[new ot({text:"",alignment:Ft.CENTER})],width:{size:1500,type:Bt.DXA},shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:vt(oe.work_date)})],width:{size:3e3,type:Bt.DXA},borders:Ne}),new gt({children:[new ot({text:"",alignment:Ft.CENTER})],width:{size:1500,type:Bt.DXA},shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:oe.user?.team||"-"})],width:{size:3e3,type:Bt.DXA},borders:Ne})]}),new pr({children:[new gt({children:[new ot({text:"",alignment:Ft.CENTER})],shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:oe.user?.rank||"-"})],borders:Ne}),new gt({children:[new ot({text:"",alignment:Ft.CENTER})],shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:oe.user?.name||"-"})],borders:Ne})]})],width:{size:100,type:Bt.PERCENTAGE}}),new ot({text:"",spacing:{after:300}}),new Sa({rows:[new pr({children:[new gt({children:[new ot({children:[new Dt({text:".  ",bold:!0})]})],columnSpan:3,shading:{fill:"F8F9FA"},borders:Ne})]}),new pr({children:[new gt({children:[new ot({text:"No",alignment:Ft.CENTER})],width:{size:600,type:Bt.DXA},shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:" ",alignment:Ft.CENTER})],shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:"",alignment:Ft.CENTER})],width:{size:1e3,type:Bt.DXA},shading:{fill:"F8F9FA"},borders:Ne})]}),...xe(oe.morning_work)],width:{size:100,type:Bt.PERCENTAGE}}),new ot({text:"",spacing:{after:200}}),new Sa({rows:[new pr({children:[new gt({children:[new ot({children:[new Dt({text:".  ",bold:!0})]})],columnSpan:3,shading:{fill:"F8F9FA"},borders:Ne})]}),new pr({children:[new gt({children:[new ot({text:"No",alignment:Ft.CENTER})],width:{size:600,type:Bt.DXA},shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:" ",alignment:Ft.CENTER})],shading:{fill:"F8F9FA"},borders:Ne}),new gt({children:[new ot({text:"",alignment:Ft.CENTER})],width:{size:1e3,type:Bt.DXA},shading:{fill:"F8F9FA"},borders:Ne})]}),...xe(oe.afternoon_work)],width:{size:100,type:Bt.PERCENTAGE}}),new ot({text:"",spacing:{after:200}}),new Sa({rows:[new pr({children:[new gt({children:[new ot({children:[new Dt({text:".  ",bold:!0})]})],shading:{fill:"F8F9FA"},borders:Ne})]}),new pr({children:[new gt({children:[new ot({text:oe.next_day_work||"-"})],borders:Ne})]})],width:{size:100,type:Bt.PERCENTAGE}}),new ot({text:"",spacing:{after:200}}),new Sa({rows:[new pr({children:[new gt({children:[new ot({children:[new Dt({text:".   ",bold:!0})]})],shading:{fill:"F8F9FA"},borders:Ne})]}),new pr({children:[new gt({children:[new ot({text:oe.special_notes||"-"})],borders:Ne})]})],width:{size:100,type:Bt.PERCENTAGE}}),new ot({text:"",spacing:{after:400}}),new ot({children:[new Dt({text:"",bold:!0,size:28})],alignment:Ft.CENTER}),...je.length>0?[new ot({text:"",spacing:{after:300}}),new ot({children:[new Dt({text:" ",bold:!0,size:24})]}),new Sa({rows:Oe,width:{size:100,type:Bt.PERCENTAGE}})]:[],...fe.length>0?[new ot({text:""}),new ot({children:[new Dt({text:"(   )",italics:!0,color:"666666"})]}),...fe.map((pt,Nt)=>new ot({children:[new Dt({text:`${Nt+1}. ${pt}`,color:"0066CC"})]}))]:[]]}]}),st=await gm.toBlob(Ue);ym.saveAs(st,`_${oe.work_date}_${oe.user?.name||""}.docx`)},jt=oe=>{const Ne=["","","","","","",""],xe=new Date(oe);return Ne[xe.getDay()]},vt=oe=>new Date(oe).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})+` (${jt(oe)})`,At=F*B,Rt=At-B,Le=n.slice(Rt,At),rt=Math.ceil(n.length/B),ct=oe=>{O(oe)};return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(Gs,{size:24})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-1",children:t?"  ":`${e?.name||""}  `}),a.jsx("p",{className:"text-white/90",children:t?"        ":`${e?.team?`${e.team}  `:""}${e?.rank||" "}`})]})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsx("select",{value:_,onChange:oe=>w(Number(oe.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:ne.map(oe=>a.jsxs("option",{value:oe,children:[oe,""]},oe))}),a.jsx("select",{value:S,onChange:oe=>N(Number(oe.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:ie.map(oe=>a.jsxs("option",{value:oe,children:[oe,""]},oe))}),t&&G.length>0&&a.jsxs("select",{value:E,onChange:oe=>C(oe.target.value),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:[a.jsx("option",{value:"all",children:" "}),G.map(oe=>a.jsx("option",{value:oe.user_id,children:oe.name},oe.user_id))]}),a.jsxs(Ye,{onClick:Ae,children:[a.jsx(os,{size:18}),"  "]})]})]}),a.jsx(_t,{padding:"p-0 sm:p-6",children:m?a.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:" ..."}):Le.length>0?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[800px]",children:[a.jsx("thead",{className:"bg-toss-gray-100 border-b-2 border-toss-gray-300",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:"No"}),a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),t&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]}),a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700",children:" "}),a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700",children:" "}),a.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),a.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:Le.map((oe,Ne)=>a.jsxs("tr",{className:`hover:bg-toss-gray-50 transition-colors ${t&&!oe.is_read?"bg-blue-50":""}`,children:[a.jsx("td",{className:"px-3 py-3 text-sm text-center text-toss-gray-600 whitespace-nowrap",children:Rt+Ne+1}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 cursor-pointer hover:text-toss-blue whitespace-nowrap",onClick:()=>$e(oe),children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ma,{size:14,className:"text-toss-gray-400 flex-shrink-0"}),a.jsx("span",{children:new Date(oe.work_date).toLocaleDateString("ko-KR")}),t&&!oe.is_read&&a.jsx("span",{className:"inline-block bg-red-500 text-white px-1.5 py-0.5 rounded-full text-xs font-medium flex-shrink-0",children:"N"})]})}),t&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 cursor-pointer hover:text-toss-blue hover:underline whitespace-nowrap",onClick:xe=>{xe.stopPropagation(),C(oe.user_id)},children:oe.user?.name||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-600 whitespace-nowrap",children:oe.user?.team||"-"})]}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 cursor-pointer max-w-[200px] truncate",onClick:()=>$e(oe),children:P(oe.morning_work)}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 cursor-pointer max-w-[200px] truncate",onClick:()=>$e(oe),children:P(oe.afternoon_work)}),a.jsx("td",{className:"px-3 py-3 text-center whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("button",{onClick:xe=>{xe.stopPropagation(),tt(oe)},className:"p-2 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"PDF ",children:a.jsx(ia,{size:16})}),a.jsx("button",{onClick:xe=>{xe.stopPropagation(),ft(oe)},className:"p-2 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"Word ",children:a.jsx(Jr,{size:16})}),(e?.user_id===oe.user_id||t)&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>le(oe),className:"p-2 text-blue-500 hover:bg-blue-100 rounded-lg transition-colors",title:"",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>Ce(oe),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:a.jsx(Xt,{size:16})})]})]})})]},oe.id))})]})}),a.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:Le.map((oe,Ne)=>a.jsxs("div",{className:`p-4 ${t&&!oe.is_read?"bg-blue-50":""}`,onClick:()=>$e(oe),children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"text-xs text-toss-gray-500",children:["#",Rt+Ne+1]}),a.jsx(ma,{size:14,className:"text-toss-gray-400"}),a.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:new Date(oe.work_date).toLocaleDateString("ko-KR")}),t&&!oe.is_read&&a.jsx("span",{className:"bg-red-500 text-white px-2 py-0.5 rounded-full text-xs font-medium",children:"NEW"})]}),a.jsxs("div",{className:"flex items-center gap-1",onClick:xe=>xe.stopPropagation(),children:[a.jsx("button",{onClick:()=>tt(oe),className:"p-1.5 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg",title:"PDF ",children:a.jsx(ia,{size:14})}),a.jsx("button",{onClick:()=>ft(oe),className:"p-1.5 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg",title:"Word ",children:a.jsx(Jr,{size:14})}),(e?.user_id===oe.user_id||t)&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>le(oe),className:"p-1.5 text-blue-500 hover:bg-blue-100 rounded-lg",children:a.jsx(js,{size:14})}),a.jsx("button",{onClick:()=>Ce(oe),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:a.jsx(Xt,{size:14})})]})]})]}),t&&a.jsxs("div",{className:"text-xs text-toss-gray-600 mb-2",children:[a.jsx("span",{className:"font-medium",children:oe.user?.name||"-"}),a.jsx("span",{className:"mx-1",children:""}),a.jsx("span",{children:oe.user?.team||"-"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("p",{className:"text-sm text-toss-gray-700 line-clamp-1",children:[a.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),P(oe.morning_work)]}),a.jsxs("p",{className:"text-sm text-toss-gray-700 line-clamp-1",children:[a.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),P(oe.afternoon_work)]})]})]},oe.id))}),rt>1&&a.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-toss-gray-200",children:[a.jsx("button",{onClick:()=>ct(F-1),disabled:F===1,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),[...Array(rt)].map((oe,Ne)=>a.jsx("button",{onClick:()=>ct(Ne+1),className:`px-3 py-1 rounded-lg text-sm font-medium ${F===Ne+1?"bg-toss-blue text-white":"text-toss-gray-700 hover:bg-toss-gray-100"}`,children:Ne+1},Ne+1)),a.jsx("button",{onClick:()=>ct(F+1),disabled:F===rt,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]}):a.jsxs("div",{className:"text-center text-toss-gray-500 py-8",children:[_," ",S,"   "]})}),a.jsx(cr,{isOpen:l,onClose:()=>{u(!1),_e()},title:d?"  ":"   ",children:a.jsxs("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto pr-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),a.jsx("input",{type:"date",value:ve?te.work_date:Q.work_date,onChange:oe=>ve?ke({...te,work_date:oe.target.value}):re({...Q,work_date:oe.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all"}),a.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:vt(ve?te.work_date:Q.work_date)})]}),!d&&a.jsxs("button",{type:"button",onClick:Me,className:"flex items-center gap-2 px-4 py-2.5 bg-toss-gray-100 text-toss-gray-700 rounded-xl hover:bg-toss-gray-200 transition-colors text-sm font-medium w-full justify-center",children:[a.jsx(am,{size:16}),"  "]}),ve?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("textarea",{value:te.morning_work,onChange:oe=>ke({...te,morning_work:oe.target.value}),rows:4,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"    "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("textarea",{value:te.afternoon_work,onChange:oe=>ke({...te,afternoon_work:oe.target.value}),rows:4,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"    "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("textarea",{value:te.next_day_work,onChange:oe=>ke({...te,next_day_work:oe.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"   "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"()"}),a.jsx("textarea",{value:te.special_notes,onChange:oe=>ke({...te,special_notes:oe.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),d&&te.existingFileUrls.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("div",{className:"space-y-2",children:te.existingFileUrls.map((oe,Ne)=>{const xe=oe.split("/").pop();return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ea,{size:16,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-sm text-toss-gray-700",children:xe})]}),a.jsx("button",{onClick:()=>{ke(je=>({...je,existingFileUrls:je.existingFileUrls.filter((fe,Oe)=>Oe!==Ne)}))},className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:a.jsx(mr,{size:16})})]},Ne)})})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsxs("div",{className:"space-y-2",children:[Q.morning_tasks.map((oe,Ne)=>a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-6 text-center text-sm font-medium text-toss-gray-500 pt-3",children:Ne+1}),a.jsx("textarea",{value:oe.content,onChange:xe=>J("morning_tasks",Ne,"content",xe.target.value),onKeyDown:xe=>Ee(xe,"morning_tasks",Ne),"data-morning-task":Ne,rows:2,className:"flex-1 px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all resize-none leading-relaxed",placeholder:"   (Enter , Tab  )"}),a.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:oe.progress,onChange:xe=>{const je=xe.target.value.replace(/[^0-9]/g,"");(je===""||parseInt(je)>=0&&parseInt(je)<=100)&&J("morning_tasks",Ne,"progress",je)},className:"w-16 px-2 self-stretch bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all text-center",placeholder:"%"}),Q.morning_tasks.length>1&&a.jsx("button",{type:"button",onClick:()=>M("morning_tasks",Ne),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:a.jsx(Xt,{size:18})})]},Ne)),a.jsxs("button",{type:"button",onClick:()=>Z("morning_tasks"),className:"flex items-center gap-2 px-4 py-2 text-toss-blue hover:bg-toss-blue/10 rounded-xl transition-colors text-sm font-medium",children:[a.jsx(D0,{size:16})," "]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsxs("div",{className:"space-y-2",children:[Q.afternoon_tasks.map((oe,Ne)=>a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"w-6 text-center text-sm font-medium text-toss-gray-500 pt-3",children:Ne+1}),a.jsx("textarea",{value:oe.content,onChange:xe=>J("afternoon_tasks",Ne,"content",xe.target.value),onKeyDown:xe=>Ee(xe,"afternoon_tasks",Ne),"data-afternoon-task":Ne,rows:2,className:"flex-1 px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all resize-none leading-relaxed",placeholder:"   (Enter , Tab  )"}),a.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:oe.progress,onChange:xe=>{const je=xe.target.value.replace(/[^0-9]/g,"");(je===""||parseInt(je)>=0&&parseInt(je)<=100)&&J("afternoon_tasks",Ne,"progress",je)},className:"w-16 px-2 self-stretch bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all text-center",placeholder:"%"}),Q.afternoon_tasks.length>1&&a.jsx("button",{type:"button",onClick:()=>M("afternoon_tasks",Ne),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:a.jsx(Xt,{size:18})})]},Ne)),a.jsxs("button",{type:"button",onClick:()=>Z("afternoon_tasks"),className:"flex items-center gap-2 px-4 py-2 text-toss-blue hover:bg-toss-blue/10 rounded-xl transition-colors text-sm font-medium",children:[a.jsx(D0,{size:16})," "]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("textarea",{value:Q.next_day_work,onChange:oe=>re({...Q,next_day_work:oe.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"   "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"()"}),a.jsx("textarea",{value:Q.special_notes,onChange:oe=>re({...Q,special_notes:oe.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),d&&Q.existingFileUrls.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("div",{className:"space-y-2",children:Q.existingFileUrls.map((oe,Ne)=>{const xe=oe.split("/").pop();return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ea,{size:16,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-sm text-toss-gray-700",children:xe})]}),a.jsx("button",{onClick:()=>T(Ne),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:a.jsx(mr,{size:16})})]},Ne)})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  (  )"}),a.jsx("input",{type:"file",ref:L,multiple:!0,onChange:de,className:"hidden"}),a.jsx("button",{type:"button",onClick:()=>L.current?.click(),className:"w-full p-6 border-2 border-dashed border-toss-gray-300 rounded-2xl hover:border-toss-blue hover:bg-toss-blue/5 transition-all",children:a.jsxs("div",{className:"flex flex-col items-center gap-2 text-toss-gray-600",children:[a.jsx(Gn,{size:28}),a.jsx("span",{className:"font-medium",children:" "}),a.jsx("span",{className:"text-xs text-toss-gray-500",children:"   "})]})}),(ve?te.files:Q.files).length>0&&a.jsx("div",{className:"mt-4 space-y-2",children:(ve?te.files:Q.files).map((oe,Ne)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ea,{size:16,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-sm text-toss-gray-700",children:oe.name}),a.jsxs("span",{className:"text-xs text-toss-gray-500",children:["(",oe.size,")"]})]}),a.jsx("button",{onClick:()=>z(Ne),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:a.jsx(mr,{size:16})})]},Ne))})]}),a.jsxs("div",{className:"flex gap-3 pt-4 sticky bottom-0 bg-white",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{u(!1),_e()},className:"flex-1",children:""}),a.jsx(Ye,{onClick:d?me:q,className:"flex-1",loading:y,disabled:y,children:y?" ...":d?"":""})]})]})}),a.jsx(cr,{isOpen:!!v&&!l,onClose:()=>g(null),title:"  ",children:v&&a.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto -mx-2 px-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-toss-gray-900",children:vt(v.work_date)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-toss-gray-900 font-medium",children:v.user?`${v.user.name}  ${v.user.team||" "}`:"-"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),a.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[80px]",children:v.morning_work?a.jsx("div",{className:"space-y-2",children:se(v.morning_work).map((oe,Ne)=>a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"w-6 text-center text-sm font-medium text-toss-gray-500 flex-shrink-0",children:Ne+1}),a.jsx("span",{className:"flex-1 text-toss-gray-900 whitespace-pre-wrap",children:oe.content}),oe.progress&&a.jsxs("span",{className:"text-sm font-medium text-toss-blue flex-shrink-0",children:[oe.progress,"%"]})]},Ne))}):a.jsx("span",{className:"text-toss-gray-500",children:"-"})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),a.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[80px]",children:v.afternoon_work?a.jsx("div",{className:"space-y-2",children:se(v.afternoon_work).map((oe,Ne)=>a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"w-6 text-center text-sm font-medium text-toss-gray-500 flex-shrink-0",children:Ne+1}),a.jsx("span",{className:"flex-1 text-toss-gray-900 whitespace-pre-wrap",children:oe.content}),oe.progress&&a.jsxs("span",{className:"text-sm font-medium text-toss-blue flex-shrink-0",children:[oe.progress,"%"]})]},Ne))}):a.jsx("span",{className:"text-toss-gray-500",children:"-"})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),a.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[80px] whitespace-pre-wrap text-toss-gray-900",children:v.next_day_work||"-"})]}),v.special_notes&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:"()"}),a.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 whitespace-pre-wrap text-toss-gray-900",children:v.special_notes})]}),v.file_urls&&v.file_urls.length>0&&a.jsx(LU,{urls:v.file_urls}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsxs("button",{onClick:()=>tt(v),className:"flex items-center gap-2 px-4 py-2 bg-toss-gray-100 text-toss-gray-700 rounded-xl hover:bg-toss-gray-200 transition-colors text-sm font-medium",children:[a.jsx(ia,{size:16}),"PDF "]}),a.jsxs("button",{onClick:()=>ft(v),className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 rounded-xl hover:bg-blue-100 transition-colors text-sm font-medium",children:[a.jsx(K7,{size:16}),"Word "]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>g(null),className:"flex-1",children:""}),a.jsx(Ye,{onClick:()=>le(v),className:"flex-1",children:""})]})]})}),H.isOpen&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:1e4},onClick:()=>ue({...H,isOpen:!1}),children:a.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl animate-in fade-in zoom-in duration-200",onClick:oe=>oe.stopPropagation(),children:a.jsxs("div",{className:"flex flex-col items-center text-center",children:[a.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center mb-4 ${H.type==="success"?"bg-green-100":H.type==="error"?"bg-red-100":"bg-blue-100"}`,children:H.type==="success"?a.jsx(Ws,{className:"w-7 h-7 text-green-600"}):H.type==="error"?a.jsx(Sn,{className:"w-7 h-7 text-red-600"}):a.jsx(Sn,{className:"w-7 h-7 text-blue-600"})}),a.jsx("p",{className:"text-toss-gray-900 font-medium mb-6 leading-relaxed",children:H.message}),a.jsx("button",{onClick:()=>ue({...H,isOpen:!1}),className:`w-full py-3 rounded-xl font-medium transition-colors ${H.type==="success"?"bg-green-500 hover:bg-green-600 text-white":H.type==="error"?"bg-red-500 hover:bg-red-600 text-white":"bg-toss-blue hover:bg-blue-600 text-white"}`,children:""})]})})}),Y.isOpen&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:1e4},onClick:()=>I({isOpen:!1,worklog:null}),children:a.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl animate-in fade-in zoom-in duration-200",onClick:oe=>oe.stopPropagation(),children:a.jsxs("div",{className:"flex flex-col items-center text-center",children:[a.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center mb-4 bg-red-100",children:a.jsx(Xt,{className:"w-7 h-7 text-red-600"})}),a.jsx("p",{className:"text-toss-gray-900 font-medium mb-6 leading-relaxed",children:" ?"}),a.jsxs("div",{className:"flex gap-3 w-full",children:[a.jsx("button",{onClick:()=>I({isOpen:!1,worklog:null}),className:"flex-1 py-3 rounded-xl font-medium transition-colors bg-gray-100 hover:bg-gray-200 text-toss-gray-700",children:""}),a.jsx("button",{onClick:Je,className:"flex-1 py-3 rounded-xl font-medium transition-colors bg-red-500 hover:bg-red-600 text-white",children:""})]})]})})})]})};function ml({title:e,date:t,content:r}){const s=t||new Date().toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}),n=`
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>${e}</title>
  <style>
    @page {
      size: A4;
      margin: 15mm 15mm 20mm 15mm;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      color: #1a1a1a;
      line-height: 1.5;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }
    .report-header {
      text-align: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 3px solid #2c6eb6;
    }
    .report-header h1 {
      font-size: 24px;
      font-weight: 800;
      color: #1a1a1a;
      margin-bottom: 8px;
    }
    .report-header .org-name {
      font-size: 14px;
      color: #2c6eb6;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .report-header .date {
      font-size: 13px;
      color: #666;
    }
    .stats-grid {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
    }
    .stat-box {
      flex: 1;
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 10px;
      text-align: center;
    }
    .stat-box .label {
      font-size: 11px;
      color: #888;
      margin-bottom: 2px;
    }
    .stat-box .value {
      font-size: 22px;
      font-weight: 700;
      color: #1a1a1a;
    }
    .stat-box .unit {
      font-size: 12px;
      font-weight: 400;
      color: #888;
    }
    .stat-box.highlight {
      border-color: #2c6eb6;
      background: #f0f6ff;
    }
    .stat-box.highlight .value {
      color: #2c6eb6;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 16px;
      font-size: 12px;
    }
    table th {
      background: #2c6eb6;
      color: white;
      font-weight: 600;
      padding: 8px 10px;
      text-align: center;
      font-size: 12px;
    }
    table td {
      padding: 7px 10px;
      border-bottom: 1px solid #e5e5e5;
      font-size: 12px;
    }
    table tr:nth-child(even) {
      background: #f8f9fa;
    }
    .section-title {
      font-size: 15px;
      font-weight: 700;
      color: #333;
      margin: 16px 0 8px;
      padding-left: 8px;
      border-left: 3px solid #2c6eb6;
    }
  </style>
</head>
<body>
  <div class="report-header">
    <div class="org-name"></div>
    <h1>${e}</h1>
    <div class="date">: ${s}</div>
  </div>
  ${r}
</body>
</html>`,o=document.getElementById("print-report-frame");o&&o.remove();const l=document.createElement("iframe");l.id="print-report-frame",l.style.position="fixed",l.style.top="-10000px",l.style.left="-10000px",l.style.width="0",l.style.height="0",l.style.border="none",document.body.appendChild(l);const u=l.contentDocument||l.contentWindow?.document;u&&(u.open(),u.write(n),u.close(),l.onload=()=>{l.contentWindow?.focus(),l.contentWindow?.print()})}const MU=e=>e?e.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0","").replace("?dl=1","").replace("&dl=1",""):"",_0=e=>{let t="";return typeof e=="string"?t=e:e&&e.url&&(t=e.url),MU(t)},jS=e=>{const t=_0(e);if(!t)return!1;const r=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],s=t.toLowerCase();return r.some(n=>s.includes(n))},BU=({urls:e})=>{const t=K.useRef(null),[r,s]=K.useState(!1),[n,o]=K.useState(!1),[l,u]=K.useState(null),[d,h]=K.useState(!1),[m,x]=K.useState(0),[y,b]=K.useState(0),v=e.filter(jS),g=e.filter(A=>!jS(A)),_=()=>{if(t.current){const{scrollLeft:A,scrollWidth:Y,clientWidth:I}=t.current;s(A>0),o(A<Y-I-10)}};K.useEffect(()=>(_(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)),[e]),K.useEffect(()=>{const A=Y=>{l!==null&&(Y.key==="ArrowLeft"&&E(),Y.key==="ArrowRight"&&C(),Y.key==="Escape"&&N())};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[l,v.length]);const w=A=>{t.current&&(t.current.scrollBy({left:A==="left"?-200:200,behavior:"smooth"}),setTimeout(_,300))},S=A=>{u(A),b(0)},N=()=>{u(null),b(0)},E=()=>{b(0),u(A=>A!==null&&A>0?A-1:v.length-1)},C=()=>{b(0),u(A=>A!==null&&A<v.length-1?A+1:0)},F=A=>{v.length<=1||(h(!0),x(A.clientX))},O=A=>{v.length<=1||(h(!0),x(A.touches[0].clientX))},B=A=>{if(!d)return;const Y=A-m;b(Y)},L=A=>{B(A.clientX)},H=A=>{B(A.touches[0].clientX)},ue=()=>{if(!d)return;h(!1);const A=100;y>A?E():y<-A?C():b(0)};return v.length===0&&g.length===0?null:a.jsxs("div",{className:"space-y-3",children:[v.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:[" (",v.length,")"]}),a.jsxs("div",{className:"relative",children:[r&&a.jsx("button",{onClick:()=>w("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:a.jsx(xa,{size:20})}),a.jsx("div",{ref:t,onScroll:_,className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:v.map((A,Y)=>{const I=_0(A);return a.jsx("div",{className:"flex-shrink-0 cursor-pointer w-24 h-24 sm:w-32 sm:h-32 rounded-xl overflow-hidden bg-toss-gray-100",onClick:()=>S(Y),children:a.jsx("img",{src:I,alt:`  ${Y+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:ae=>{ae.target.style.display="none"}})},Y)})}),n&&a.jsx("button",{onClick:()=>w("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:a.jsx(Js,{size:20})})]})]}),g.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:["  (",g.length,")"]}),a.jsx("div",{className:"space-y-2",children:g.map((A,Y)=>{const I=_0(A),ae=typeof A=="string"?I.split("/").pop():A.name||I.split("/").pop();return a.jsxs("a",{href:I,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors",children:[a.jsx(Ea,{size:16,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-sm text-toss-blue hover:underline flex-1 truncate",children:ae}),a.jsx(Jr,{size:16,className:"text-toss-gray-500"})]},Y)})})]}),l!==null&&a.jsxs("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center select-none",style:{zIndex:9999},onClick:N,onMouseUp:ue,onMouseLeave:ue,onTouchEnd:ue,children:[a.jsx("button",{className:"absolute top-4 right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors",onClick:N,children:a.jsx(mr,{size:24})}),a.jsxs("div",{className:"absolute top-4 left-4 z-10 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm font-medium",children:[l+1," / ",v.length]}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[v.length>1&&a.jsx("button",{onClick:A=>{A.stopPropagation(),E()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:a.jsx(xa,{size:36,strokeWidth:3})}),a.jsx("div",{onClick:A=>A.stopPropagation(),onMouseDown:F,onMouseMove:L,onTouchStart:O,onTouchMove:H,className:"max-w-[70vw] sm:max-w-[80vw] max-h-[90vh] relative cursor-grab active:cursor-grabbing",style:{transform:`translateX(${y}px)`,transition:d?"none":"transform 0.3s ease-out"},children:a.jsx("img",{src:_0(v[l]),alt:`  ${l+1}`,className:"max-w-full max-h-[90vh] object-contain rounded-lg pointer-events-none",draggable:!1})}),v.length>1&&a.jsx("button",{onClick:A=>{A.stopPropagation(),C()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:a.jsx(Js,{size:36,strokeWidth:3})})]}),v.length>1&&a.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2",children:v.map((A,Y)=>a.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${Y===l?"bg-white":"bg-white/30"}`},Y))})]})]})},PU=()=>{const{profile:e,isAdmin:t}=qr(),[r,s]=K.useState([]),[n,o]=K.useState([]),[l,u]=K.useState(!1),[d,h]=K.useState(!1),[m,x]=K.useState(!0),[y,b]=K.useState(!1),[v,g]=K.useState(null),[_,w]=K.useState(new Date().getFullYear()),[S,N]=K.useState(new Date().getMonth()+1),[E,C]=K.useState("all"),[F,O]=K.useState(1),B=15,L=K.useRef(null),[H,ue]=K.useState(new Set),[A,Y]=K.useState(!1),[I,ae]=K.useState(!1),[Q,re]=K.useState([]),ve=()=>{const xe=new Date;return xe.getDay()===1&&xe.setDate(xe.getDate()-3),xe.toISOString().split("T")[0]},[te,ke]=K.useState({work_date:ve(),weekly_tasks:[qn()],this_week_work:"",special_notes:"",files:[],existingFileUrls:[]}),Z=2026,M=new Date().getFullYear(),J=Array.from({length:M-Z+1},(xe,je)=>Z+je),V=Array.from({length:12},(xe,je)=>je+1);K.useEffect(()=>{P()},[]),K.useEffect(()=>{X()},[r,_,S,E]);const X=()=>{const xe=r.filter(je=>{const fe=new Date(je.work_date),Oe=fe.getFullYear()===_&&fe.getMonth()+1===S,Ue=E==="all"||je.user_id===E;return Oe&&Ue});o(xe),O(1)},se=Array.from(new Set(r.map(xe=>xe.user_id))).map(xe=>{const je=r.find(fe=>fe.user_id===xe);return{user_id:xe,name:je?.user?.name||"  "}}).sort((xe,je)=>xe.name.localeCompare(je.name)),P=async()=>{try{let xe=Pe.from("work_logs").select("*").eq("type","weekly").order("work_date",{ascending:!1});!t&&e&&(xe=xe.eq("user_id",e.user_id));const{data:je,error:fe}=await xe;if(fe)throw fe;const{data:Oe,error:Ue}=await Pe.from("users").select("user_id, name, team, rank");if(Ue)throw Ue;const st=(je||[]).map(pt=>{const Nt=(Oe||[]).find(Vt=>Vt.user_id===pt.user_id);return{...pt,user:Nt||{name:"  ",team:"-",rank:"-"}}});s(st)}catch(xe){console.error("Error fetching worklogs:",xe)}finally{x(!1)}},U=()=>{ke(xe=>({...xe,weekly_tasks:[...xe.weekly_tasks,qn()]}))},ce=xe=>{ke(je=>({...je,weekly_tasks:je.weekly_tasks.filter((fe,Oe)=>Oe!==xe)}))},ne=(xe,je)=>{ke(fe=>({...fe,weekly_tasks:fe.weekly_tasks.map((Oe,Ue)=>Ue===xe?{...Oe,title:je}:Oe)}))},ie=xe=>{ke(je=>({...je,weekly_tasks:je.weekly_tasks.map((fe,Oe)=>Oe===xe?{...fe,details:[...fe.details,Fv()]}:fe)}))},W=(xe,je)=>{ke(fe=>({...fe,weekly_tasks:fe.weekly_tasks.map((Oe,Ue)=>Ue===xe?{...Oe,details:Oe.details.filter((st,pt)=>pt!==je)}:Oe)}))},G=(xe,je,fe,Oe)=>{ke(Ue=>({...Ue,weekly_tasks:Ue.weekly_tasks.map((st,pt)=>pt===xe?{...st,details:st.details.map((Nt,Vt)=>Vt===je?{...Nt,[fe]:Oe}:Nt)}:st)}))},k=xe=>{const fe=Array.from(xe.target.files||[]).map(Oe=>({file:Oe,name:Oe.name,size:(Oe.size/1024).toFixed(0)+"KB"}));ke(Oe=>({...Oe,files:[...Oe.files,...fe]}))},de=xe=>{ke(je=>({...je,files:je.files.filter((fe,Oe)=>Oe!==xe)}))},z=xe=>{ke(je=>({...je,existingFileUrls:je.existingFileUrls.filter((fe,Oe)=>Oe!==xe)}))},T=async xe=>{const je=`/intranet/worklogs/weekly/${e.user_id}`;return(await af(xe.map(Oe=>Oe.file),je)).map(Oe=>Oe.url)},R=async()=>{const xe=B0(te.weekly_tasks);if(!xe){alert("    .");return}try{b(!0);let je=[];te.files.length>0&&(je=await T(te.files));const{error:fe}=await Pe.from("work_logs").insert({work_date:te.work_date,morning_work:xe,this_week_work:te.this_week_work,special_notes:te.special_notes,file_urls:je,user_id:e.user_id,type:"weekly",is_read:!1});if(fe)throw fe;u(!1),Ae(),P(),alert("  .")}catch(je){console.error("Error creating worklog:",je),alert("   : "+je.message)}finally{b(!1)}},q=async()=>{const xe=B0(te.weekly_tasks);if(!xe){alert("    .");return}if(!v?.id){alert("    .");return}const je=v.id;try{b(!0);let fe=[];te.files.length>0&&(fe=await T(te.files));const Oe=[...te.existingFileUrls,...fe],{error:Ue}=await Pe.from("work_logs").update({work_date:te.work_date,morning_work:xe,this_week_work:te.this_week_work,special_notes:te.special_notes,file_urls:Oe}).eq("id",je);if(Ue)throw Ue;u(!1),Ae(),P(),alert("  .")}catch(fe){console.error("Error updating worklog:",fe),alert("   : "+fe.message)}finally{b(!1)}},me=xe=>{const je=new Date(xe),fe=je.getDay(),Oe=new Date(je),Ue=fe===0?-6:1-fe;Oe.setDate(je.getDate()+Ue);const st=new Date(Oe);return st.setDate(Oe.getDate()+4),{start:Oe.toISOString().split("T")[0],end:st.toISOString().split("T")[0]}},_e=xe=>{if(!xe)return"";let je=xe.replace(/\n---TASK---\n/g,`
`);return je=je.replace(/\s*\(\d+%\)/g,""),je.trim()},le=async()=>{if(e?.user_id){Y(!0);try{const{start:xe,end:je}=me(te.work_date),{data:fe,error:Oe}=await Pe.from("work_logs").select("work_date, morning_work, afternoon_work").eq("user_id",e.user_id).eq("type","daily").gte("work_date",xe).lte("work_date",je).order("work_date",{ascending:!0});if(Oe)throw Oe;if(!fe||fe.length===0){alert("     .");return}const Ue=["","","","","","",""],st=[];if(fe.forEach(pt=>{const Nt=new Date(pt.work_date),Vt=Ue[Nt.getDay()],yr=`${Nt.getMonth()+1}/${Nt.getDate()}`,_r=_e(pt.morning_work),zt=_e(pt.afternoon_work);if(_r||zt){const fr=[];_r&&_r.split(`
`).forEach(Sr=>{Sr.trim()&&fr.push(Sr.trim())}),zt&&zt.split(`
`).forEach(Sr=>{Sr.trim()&&fr.push(Sr.trim())}),fr.length>0&&st.push({title:`${Vt}(${yr})`,details:fr.map(Sr=>({content:Sr,progress:"",remark:""}))})}}),st.length===0){alert("      .");return}re(st),ae(!0)}catch(xe){console.error("Error fetching daily worklogs:",xe),alert("   .")}finally{Y(!1)}}},Ae=()=>{ke({work_date:ve(),weekly_tasks:[qn()],this_week_work:"",special_notes:"",files:[],existingFileUrls:[]}),h(!1),g(null)},Me=xe=>{ke({work_date:xe.work_date,weekly_tasks:zn(xe.morning_work||""),this_week_work:xe.this_week_work||"",special_notes:xe.special_notes||"",files:[],existingFileUrls:xe.file_urls||[]}),g(xe),h(!0),u(!0)},Ee=()=>{Ae(),u(!0)},Ce=async xe=>{if(confirm(" ?"))try{xe.file_urls&&xe.file_urls.length>0&&await om(xe.file_urls);const{error:je}=await Pe.from("work_logs").delete().eq("id",xe.id);if(je)throw je;P(),alert(".")}catch(je){console.error("Error deleting worklog:",je),alert(" .")}},Je=async xe=>{g(xe),t&&!xe.is_read&&(await Pe.from("work_logs").update({is_read:!0}).eq("id",xe.id),P())},$e=xe=>{const je=new Date(xe),fe=new Date(je.getFullYear(),je.getMonth(),1),Oe=Math.ceil((je.getDate()+fe.getDay())/7);return`${je.getMonth()+1} ${Oe}`},tt=xe=>new Date(xe).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}),De=async xe=>{const je={top:{style:nr.SINGLE,size:1,color:"333333"},bottom:{style:nr.SINGLE,size:1,color:"333333"},left:{style:nr.SINGLE,size:1,color:"333333"},right:{style:nr.SINGLE,size:1,color:"333333"}},fe={shading:{fill:"F8F9FA"},borders:je,verticalAlign:"center"},Oe=zt=>zt?zt.split(`
`).map(fr=>new ot({children:[new Dt({text:fr||" ",size:24})],spacing:{line:360}})):[new ot({text:""})],Ue=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:24})],alignment:Ft.CENTER})],width:{size:15,type:Bt.PERCENTAGE},...fe}),new gt({children:[new ot({children:[new Dt({text:$e(xe.work_date),size:24})]})],width:{size:35,type:Bt.PERCENTAGE},borders:je}),new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:24})],alignment:Ft.CENTER})],width:{size:15,type:Bt.PERCENTAGE},...fe}),new gt({children:[new ot({children:[new Dt({text:xe.user?.team||"-",size:24})]})],width:{size:35,type:Bt.PERCENTAGE},borders:je})]}),new pr({children:[new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:24})],alignment:Ft.CENTER})],...fe}),new gt({children:[new ot({children:[new Dt({text:xe.user?.rank||"-",size:24})]})],borders:je}),new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:24})],alignment:Ft.CENTER})],...fe}),new gt({children:[new ot({children:[new Dt({text:xe.user?.name||"-",size:24})]})],borders:je})]})]}),st=zn(xe.morning_work),pt=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Dt({text:".    ",bold:!0,size:24})]})],columnSpan:4,...fe})]}),new pr({children:[new gt({children:[new ot({children:[new Dt({text:"No",bold:!0,size:22})],alignment:Ft.CENTER})],width:{size:7,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:je}),new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:22})],alignment:Ft.CENTER})],width:{size:58,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:je}),new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:22})],alignment:Ft.CENTER})],width:{size:12,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:je}),new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:22})],alignment:Ft.CENTER})],width:{size:23,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:je})]}),...st.flatMap((zt,fr)=>{const Sr=(zt.title?1:0)+zt.details.length,Zr={top:{style:nr.SINGLE,size:1,color:"CCCCCC"},bottom:{style:nr.SINGLE,size:1,color:"CCCCCC"},left:{style:nr.SINGLE,size:1,color:"333333"},right:{style:nr.SINGLE,size:1,color:"333333"}},he=[];return zt.title&&he.push(new pr({children:[new gt({children:[new ot({children:[new Dt({text:String(fr+1),size:22})],alignment:Ft.CENTER})],borders:je,verticalAlign:"top",rowSpan:Sr}),new gt({children:[new ot({children:[new Dt({text:`[${zt.title}]`,bold:!0,size:22})]})],borders:Zr,margins:{top:100,bottom:100,left:100,right:100}}),new gt({children:[new ot({text:""})],borders:Zr}),new gt({children:[new ot({text:""})],borders:Zr})]})),zt.details.forEach((we,ye)=>{const be=[];we.content.split(`
`).forEach(We=>{We.trim()&&be.push(new ot({children:[new Dt({text:`- ${We}`,size:22})]}))});const Te=ye===zt.details.length-1?je:Zr;he.push(new pr({children:[...!zt.title&&ye===0?[new gt({children:[new ot({children:[new Dt({text:String(fr+1),size:22})],alignment:Ft.CENTER})],borders:je,verticalAlign:"top",rowSpan:Sr})]:[],new gt({children:be,borders:Te,margins:{top:100,bottom:100,left:100,right:100}}),new gt({children:[new ot({children:[new Dt({text:we.progress?we.progress+"%":"-",size:22})],alignment:Ft.CENTER})],borders:Te,verticalAlign:"top"}),new gt({children:[new ot({children:[new Dt({text:we.remark||"-",size:22})]})],borders:Te,margins:{left:100,right:100},verticalAlign:"top"})]}))}),he})]}),Nt=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Dt({text:".  ",bold:!0,size:24})]})],...fe})]}),new pr({children:[new gt({children:Oe(xe.this_week_work||" "),borders:je,margins:{top:kr(.15),bottom:kr(.15),left:kr(.15),right:kr(.15)}})]})]}),Vt=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Dt({text:".   ",bold:!0,size:24})]})],...fe})]}),new pr({children:[new gt({children:Oe(xe.special_notes||" "),borders:je,margins:{top:kr(.15),bottom:kr(.15),left:kr(.15),right:kr(.15)}})]})]}),yr=new xm({sections:[{properties:{page:{margin:{top:kr(.6),bottom:kr(.8),left:kr(.8),right:kr(.8)}}},children:[new ot({children:[new Dt({text:`: ${tt(xe.work_date)}`,size:22,color:"666666"})],alignment:Ft.RIGHT,spacing:{after:200}}),new ot({children:[new Dt({text:"      ",bold:!0,size:44})],alignment:Ft.CENTER,spacing:{after:200},border:{bottom:{style:nr.SINGLE,size:12,color:"333333"}}}),new ot({text:"",spacing:{after:300}}),Ue,new ot({text:"",spacing:{after:300}}),pt,new ot({text:"",spacing:{after:300}}),Nt,new ot({text:"",spacing:{after:300}}),Vt,new ot({text:"",spacing:{after:400}}),new ot({children:[new Dt({text:"",bold:!0,size:26})],alignment:Ft.CENTER})]}]}),_r=await gm.toBlob(yr);ym.saveAs(_r,`_${$e(xe.work_date)}_${xe.user?.name||""}.docx`)},ft=xe=>{RU(xe,$e)},jt=F*B,vt=jt-B,At=n.slice(vt,jt),Rt=Math.ceil(n.length/B),Le=xe=>{O(xe)},rt=xe=>{ue(je=>{const fe=new Set(je);return fe.has(xe)?fe.delete(xe):fe.add(xe),fe})},ct=()=>{At.length>0&&At.every(xe=>H.has(xe.id))?ue(xe=>{const je=new Set(xe);return At.forEach(fe=>je.delete(fe.id)),je}):ue(xe=>{const je=new Set(xe);return At.forEach(fe=>je.add(fe.id)),je})},oe=()=>{const xe=H.size>0?n.filter(Ue=>H.has(Ue.id)):n,je=H.size>0?`  (${xe.length})`:` (${xe.length})`,fe=Ue=>Ue.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>"),Oe=`
            <div class="section-title">  - ${je}</div>
            ${xe.map((Ue,st)=>{const pt=zn(Ue.morning_work);return`
                    <div style="margin-bottom: 24px; page-break-inside: avoid;">
                        <div style="font-weight: bold; font-size: 13px; margin-bottom: 6px; color: #333;">
                            ${st+1}. ${$e(Ue.work_date)} - ${Ue.user?.name||"-"} (${Ue.user?.team||"-"})
                        </div>
                        <table>
                            <colgroup><col style="width:5%"/><col style="width:58%"/><col style="width:10%"/><col style="width:27%"/></colgroup>
                            <thead><tr><th>No</th><th></th><th></th><th></th></tr></thead>
                            <tbody>
                                ${pt.map((Nt,Vt)=>{const yr=(Nt.title?1:0)+Nt.details.length,_r=[];return Nt.title&&_r.push(`<tr>
                                            <td style="text-align:center;vertical-align:top" rowspan="${yr}">${Vt+1}</td>
                                            <td style="text-align:left;font-weight:bold;border-bottom:1px solid #ccc">[${fe(Nt.title)}]</td>
                                            <td style="border-bottom:1px solid #ccc"></td>
                                            <td style="border-bottom:1px solid #ccc"></td>
                                        </tr>`),Nt.details.forEach((zt,fr)=>{const Sr=(zt.content||"-").split(`
`).map(ye=>ye.trim()?`- ${fe(ye)}`:"").filter(Boolean).join("<br/>"),he=fr===Nt.details.length-1?"":"border-bottom:1px solid #ccc",we=!Nt.title&&fr===0?`<td style="text-align:center;vertical-align:top" rowspan="${yr}">${Vt+1}</td>`:"";_r.push(`<tr>
                                            ${we}
                                            <td style="text-align:left;white-space:pre-line;${he}">${Sr}</td>
                                            <td style="text-align:center;vertical-align:top;${he}">${zt.progress?zt.progress+"%":"-"}</td>
                                            <td style="text-align:left;vertical-align:top;${he}">${fe(zt.remark||"")||"-"}</td>
                                        </tr>`)}),_r.join("")}).join("")}
                            </tbody>
                        </table>
                    </div>
                `}).join("")}
        `;ml({title:" ",content:Oe})},Ne=xe=>{const je=zn(xe);return a.jsx("div",{className:"bg-toss-gray-50 rounded-xl overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-toss-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-center font-semibold text-toss-gray-700 whitespace-nowrap w-10",children:"No"}),a.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),a.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700",children:""}),a.jsx("th",{className:"px-3 py-2 text-center font-semibold text-toss-gray-700 whitespace-nowrap w-16",children:""}),a.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),a.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:je.map((fe,Oe)=>fe.details.map((Ue,st)=>a.jsxs("tr",{children:[st===0&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-2 text-center text-toss-gray-500",rowSpan:fe.details.length,children:Oe+1}),a.jsx("td",{className:"px-3 py-2 text-toss-gray-900 font-medium whitespace-nowrap",rowSpan:fe.details.length,children:fe.title||"-"})]}),a.jsx("td",{className:"px-3 py-2 text-toss-gray-900 whitespace-pre-wrap",children:Ue.content}),a.jsx("td",{className:"px-3 py-2 text-center",children:Ue.progress?a.jsxs("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium ${Number(Ue.progress)>=100?"bg-green-100 text-green-700":Number(Ue.progress)>=50?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:[Ue.progress,"%"]}):"-"}),a.jsx("td",{className:"px-3 py-2 text-toss-gray-600",children:Ue.remark||"-"})]},`${Oe}-${st}`)))})]})})};return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-green-500 to-green-600 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(Gs,{size:24})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-1",children:t?"  ":`${e?.name||""}  `}),a.jsx("p",{className:"text-white/90",children:t?"        ":`${e?.team?`${e.team}  `:""}${e?.rank||" "}`})]})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsx("select",{value:_,onChange:xe=>w(Number(xe.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:J.map(xe=>a.jsxs("option",{value:xe,children:[xe,""]},xe))}),a.jsx("select",{value:S,onChange:xe=>N(Number(xe.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:V.map(xe=>a.jsxs("option",{value:xe,children:[xe,""]},xe))}),t&&se.length>0&&a.jsxs("select",{value:E,onChange:xe=>C(xe.target.value),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:[a.jsx("option",{value:"all",children:" "}),se.map(xe=>a.jsx("option",{value:xe.user_id,children:xe.name},xe.user_id))]}),a.jsxs(Ye,{variant:"secondary",onClick:oe,children:[a.jsx(ia,{size:18})," ",H.size>0&&`(${H.size})`]}),a.jsxs(Ye,{onClick:Ee,className:"bg-green-500 hover:bg-green-600",children:[a.jsx(os,{size:18}),"  "]})]})]}),a.jsx(_t,{padding:"p-0 sm:p-6",children:m?a.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:" ..."}):At.length>0?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[700px]",children:[a.jsx("thead",{className:"bg-toss-gray-100 border-b-2 border-toss-gray-300",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 w-10",children:a.jsx("input",{type:"checkbox",checked:At.length>0&&At.every(xe=>H.has(xe.id)),onChange:ct,className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),a.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:"No"}),a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),t&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]}),a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700",children:" "}),a.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),a.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:At.map((xe,je)=>a.jsxs("tr",{className:`hover:bg-toss-gray-50 transition-colors ${t&&!xe.is_read?"bg-green-50":""}`,children:[a.jsx("td",{className:"px-3 py-3 text-center w-10",onClick:fe=>fe.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:H.has(xe.id),onChange:()=>rt(xe.id),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-toss-gray-600 whitespace-nowrap",children:vt+je+1}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 cursor-pointer hover:text-green-600 whitespace-nowrap",onClick:()=>Je(xe),children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ma,{size:14,className:"text-toss-gray-400 flex-shrink-0"}),a.jsx("span",{children:$e(xe.work_date)}),t&&!xe.is_read&&a.jsx("span",{className:"inline-block bg-green-500 text-white px-1.5 py-0.5 rounded-full text-xs font-medium flex-shrink-0",children:"N"})]})}),t&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 whitespace-nowrap",children:xe.user?.name||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-600 whitespace-nowrap",children:xe.user?.team||"-"})]}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 cursor-pointer max-w-xs truncate",onClick:()=>Je(xe),children:P0(xe.morning_work)}),a.jsx("td",{className:"px-3 py-3 text-center whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("button",{onClick:fe=>{fe.stopPropagation(),ft(xe)},className:"p-2 text-green-600 hover:bg-green-100 rounded-lg transition-colors",title:"",children:a.jsx(ia,{size:16})}),a.jsx("button",{onClick:fe=>{fe.stopPropagation(),De(xe)},className:"p-2 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"Word ",children:a.jsx(Jr,{size:16})}),(e?.user_id===xe.user_id||t)&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>Me(xe),className:"p-2 text-green-500 hover:bg-green-100 rounded-lg transition-colors",title:"",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>Ce(xe),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:a.jsx(Xt,{size:16})})]})]})})]},xe.id))})]})}),a.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:At.map((xe,je)=>a.jsxs("div",{className:`p-4 ${t&&!xe.is_read?"bg-green-50":""}`,onClick:()=>Je(xe),children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:H.has(xe.id),onChange:()=>rt(xe.id),onClick:fe=>fe.stopPropagation(),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),a.jsxs("span",{className:"text-xs text-toss-gray-500",children:["#",vt+je+1]}),a.jsx(ma,{size:14,className:"text-toss-gray-400"}),a.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:$e(xe.work_date)}),t&&!xe.is_read&&a.jsx("span",{className:"bg-green-500 text-white px-2 py-0.5 rounded-full text-xs font-medium",children:"NEW"})]}),a.jsxs("div",{className:"flex items-center gap-1",onClick:fe=>fe.stopPropagation(),children:[a.jsx("button",{onClick:()=>De(xe),className:"p-1.5 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg",children:a.jsx(Jr,{size:14})}),(e?.user_id===xe.user_id||t)&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>Me(xe),className:"p-1.5 text-green-500 hover:bg-green-100 rounded-lg",children:a.jsx(js,{size:14})}),a.jsx("button",{onClick:()=>Ce(xe),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:a.jsx(Xt,{size:14})})]})]})]}),t&&a.jsxs("div",{className:"text-xs text-toss-gray-600 mb-2",children:[a.jsx("span",{className:"font-medium",children:xe.user?.name||"-"}),a.jsx("span",{className:"mx-1",children:""}),a.jsx("span",{children:xe.user?.team||"-"})]}),a.jsx("p",{className:"text-sm text-toss-gray-700 line-clamp-2",children:P0(xe.morning_work)})]},xe.id))}),Rt>1&&a.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-toss-gray-200",children:[a.jsx("button",{onClick:()=>Le(F-1),disabled:F===1,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),[...Array(Rt)].map((xe,je)=>a.jsx("button",{onClick:()=>Le(je+1),className:`px-3 py-1 rounded-lg text-sm font-medium ${F===je+1?"bg-green-500 text-white":"text-toss-gray-700 hover:bg-toss-gray-100"}`,children:je+1},je+1)),a.jsx("button",{onClick:()=>Le(F+1),disabled:F===Rt,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]}):a.jsxs("div",{className:"text-center text-toss-gray-500 py-8",children:[_," ",S,"    "]})}),a.jsx(cr,{isOpen:l,onClose:()=>{u(!1),Ae(),ae(!1),re([])},title:d?"  ":"   ",size:I?"xl":"default",children:a.jsxs("div",{className:"flex gap-6 ",children:[a.jsxs("div",{className:`space-y-6 max-h-[70vh] overflow-y-auto pr-2 ${I?"flex-1 min-w-0":"w-full"}`,children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),a.jsx("input",{type:"date",value:te.work_date,onChange:xe=>ke({...te,work_date:xe.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"}),a.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:$e(te.work_date)})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700",children:"  *"}),a.jsxs("button",{type:"button",onClick:le,disabled:A,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors disabled:opacity-50",children:[a.jsx(il,{size:14,className:A?"animate-spin":""}),A?" ...":"  "]})]}),a.jsxs("div",{className:"space-y-3",children:[te.weekly_tasks.map((xe,je)=>a.jsxs("div",{className:"bg-toss-gray-50 rounded-xl p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:xe.title,onChange:fe=>ne(je,fe.target.value),className:"flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm font-medium focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:""}),te.weekly_tasks.length>1&&a.jsx("button",{type:"button",onClick:()=>ce(je),className:"p-1.5 text-red-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors flex-shrink-0 w-[28px] flex items-center justify-center",title:" ",children:a.jsx(Xt,{size:14})}),te.weekly_tasks.length<=1&&a.jsx("div",{className:"w-[28px] flex-shrink-0"})]}),a.jsxs("div",{className:"hidden sm:grid sm:grid-cols-[1fr_50px_100px_28px] gap-2 px-1",children:[a.jsx("span",{className:"text-xs font-medium text-toss-gray-500",children:""}),a.jsx("span",{className:"text-xs font-medium text-toss-gray-500 text-center",children:""}),a.jsx("span",{className:"text-xs font-medium text-toss-gray-500",children:""}),a.jsx("span",{})]}),xe.details.map((fe,Oe)=>a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_50px_100px_28px] gap-2 items-stretch",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:""}),a.jsx("textarea",{value:fe.content,onChange:Ue=>G(je,Oe,"content",Ue.target.value),rows:2,className:"w-full flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all resize-none leading-relaxed",placeholder:"  "})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:"(%)"}),a.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:fe.progress,onChange:Ue=>{const st=Ue.target.value.replace(/[^0-9]/g,"");(st===""||parseInt(st)>=0&&parseInt(st)<=100)&&G(je,Oe,"progress",st)},className:"w-full flex-1 px-2 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm text-center focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"%"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:""}),a.jsx("input",{type:"text",value:fe.remark,onChange:Ue=>G(je,Oe,"remark",Ue.target.value),className:"w-full flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:""})]}),a.jsx("div",{className:"flex items-center justify-center",children:xe.details.length>1&&a.jsx("button",{type:"button",onClick:()=>W(je,Oe),className:"p-1 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:" ",children:a.jsx(mr,{size:14})})})]},Oe)),a.jsxs("button",{type:"button",onClick:()=>ie(je),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[a.jsx(os,{size:14})," "]})]},je)),a.jsxs("button",{type:"button",onClick:U,className:"flex items-center gap-2 px-4 py-2 text-green-600 hover:bg-green-50 rounded-xl transition-colors text-sm font-medium",children:[a.jsx(D0,{size:16})," "]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("textarea",{value:te.this_week_work,onChange:xe=>ke({...te,this_week_work:xe.target.value}),rows:5,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"   "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"()"}),a.jsx("textarea",{value:te.special_notes,onChange:xe=>ke({...te,special_notes:xe.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),d&&te.existingFileUrls.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("div",{className:"space-y-2",children:te.existingFileUrls.map((xe,je)=>{const fe=xe.split("/").pop();return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ea,{size:16,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-sm text-toss-gray-700",children:fe})]}),a.jsx("button",{onClick:()=>z(je),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:a.jsx(mr,{size:16})})]},je)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("input",{type:"file",ref:L,multiple:!0,onChange:k,className:"hidden"}),a.jsx("button",{type:"button",onClick:()=>L.current?.click(),className:"w-full p-6 border-2 border-dashed border-toss-gray-300 rounded-2xl hover:border-green-500 hover:bg-green-50/50 transition-all",children:a.jsxs("div",{className:"flex flex-col items-center gap-2 text-toss-gray-600",children:[a.jsx(Gn,{size:28}),a.jsx("span",{className:"font-medium",children:" "}),a.jsx("span",{className:"text-xs text-toss-gray-500",children:"   "})]})}),te.files.length>0&&a.jsx("div",{className:"mt-4 space-y-2",children:te.files.map((xe,je)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ea,{size:16,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-sm text-toss-gray-700",children:xe.name}),a.jsxs("span",{className:"text-xs text-toss-gray-500",children:["(",xe.size,")"]})]}),a.jsx("button",{onClick:()=>de(je),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:a.jsx(mr,{size:16})})]},je))})]}),a.jsxs("div",{className:"flex gap-3 pt-4 sticky bottom-0 bg-white",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{u(!1),Ae()},className:"flex-1",children:""}),a.jsx(Ye,{onClick:d?q:R,className:"flex-1 bg-green-500 hover:bg-green-600",loading:y,disabled:y,children:y?" ...":d?"":""})]})]}),I&&a.jsxs("div",{className:"flex-1 min-w-0 flex flex-col max-h-[70vh]",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-green-50 border border-green-200 rounded-t-xl",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ma,{size:16,className:"text-green-600"}),a.jsx("span",{className:"text-sm font-semibold text-green-800",children:"  "})]}),a.jsx("button",{type:"button",onClick:()=>{ae(!1),re([])},className:"p-1.5 text-green-600 hover:bg-green-100 rounded-lg transition-colors",children:a.jsx(mr,{size:16})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto border-x border-green-200 bg-white px-4 py-3",children:Q.length>0?a.jsx("div",{className:"space-y-3",children:Q.map((xe,je)=>a.jsxs("div",{className:"bg-green-50/50 rounded-lg p-3",children:[a.jsxs("div",{className:"text-sm font-semibold text-green-800 mb-1",children:["[",xe.title,"]"]}),xe.details.map((fe,Oe)=>a.jsxs("div",{className:"text-sm text-toss-gray-700 ml-2 mb-0.5",children:["- ",fe.content||"-"]},Oe))]},je))}):a.jsx("div",{className:"flex items-center justify-center h-full text-toss-gray-400 text-sm",children:" ..."})}),Q.length>0&&a.jsx("div",{className:"border-x border-b border-green-200 rounded-b-xl bg-green-50/30 px-4 py-2",children:a.jsxs("button",{type:"button",onClick:()=>{const xe=Q.map(je=>{const fe=[`[${je.title}]`];return je.details.forEach(Oe=>{fe.push(`- ${Oe.content||"-"}`)}),fe.join(`
`)}).join(`

`);navigator.clipboard.writeText(xe).then(()=>{alert(" .")})},className:"w-full flex items-center justify-center gap-2 py-2 text-sm font-medium text-green-700 hover:bg-green-100 rounded-lg transition-colors",children:[a.jsx(am,{size:15}),""]})})]})]})}),a.jsx(cr,{isOpen:!!v&&!l,onClose:()=>g(null),title:"  ",children:v&&a.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto -mx-2 px-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-toss-gray-900",children:$e(v.work_date)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-toss-gray-900 font-medium",children:v.user?`${v.user.name}  ${v.user.team||" "}`:"-"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),Ne(v.morning_work)]}),v.this_week_work&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),a.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 whitespace-pre-wrap text-toss-gray-900",children:v.this_week_work})]}),v.special_notes&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:"()"}),a.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 whitespace-pre-wrap text-toss-gray-900",children:v.special_notes})]}),v.file_urls&&v.file_urls.length>0&&a.jsx(BU,{urls:v.file_urls}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsxs("button",{onClick:()=>ft(v),className:"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-600 rounded-xl hover:bg-green-100 transition-colors text-sm font-medium",children:[a.jsx(ia,{size:16}),""]}),a.jsxs("button",{onClick:()=>De(v),className:"flex items-center gap-2 px-4 py-2 bg-toss-gray-100 text-toss-gray-700 rounded-xl hover:bg-toss-gray-200 transition-colors text-sm font-medium",children:[a.jsx(Jr,{size:16}),"Word "]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>g(null),className:"flex-1",children:""}),a.jsx(Ye,{onClick:()=>Me(v),className:"flex-1 bg-green-500 hover:bg-green-600",children:""})]})]})})]})},UU=e=>e?e.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0","").replace("?dl=1","").replace("&dl=1",""):"",N0=e=>{let t="";return typeof e=="string"?t=e:e&&e.url&&(t=e.url),UU(t)},TS=e=>{const t=N0(e);if(!t)return!1;const r=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],s=t.toLowerCase();return r.some(n=>s.includes(n))},zU=({urls:e})=>{const t=K.useRef(null),[r,s]=K.useState(!1),[n,o]=K.useState(!1),[l,u]=K.useState(null),[d,h]=K.useState(!1),[m,x]=K.useState(0),[y,b]=K.useState(0),v=e.filter(TS),g=e.filter(A=>!TS(A)),_=()=>{if(t.current){const{scrollLeft:A,scrollWidth:Y,clientWidth:I}=t.current;s(A>0),o(A<Y-I-10)}};K.useEffect(()=>(_(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)),[e]),K.useEffect(()=>{const A=Y=>{l!==null&&(Y.key==="ArrowLeft"&&E(),Y.key==="ArrowRight"&&C(),Y.key==="Escape"&&N())};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[l,v.length]);const w=A=>{t.current&&(t.current.scrollBy({left:A==="left"?-200:200,behavior:"smooth"}),setTimeout(_,300))},S=A=>{u(A),b(0)},N=()=>{u(null),b(0)},E=()=>{b(0),u(A=>A!==null&&A>0?A-1:v.length-1)},C=()=>{b(0),u(A=>A!==null&&A<v.length-1?A+1:0)},F=A=>{v.length<=1||(h(!0),x(A.clientX))},O=A=>{v.length<=1||(h(!0),x(A.touches[0].clientX))},B=A=>{if(!d)return;const Y=A-m;b(Y)},L=A=>{B(A.clientX)},H=A=>{B(A.touches[0].clientX)},ue=()=>{if(!d)return;h(!1);const A=100;y>A?E():y<-A?C():b(0)};return v.length===0&&g.length===0?null:a.jsxs("div",{className:"space-y-3",children:[v.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:[" (",v.length,")"]}),a.jsxs("div",{className:"relative",children:[r&&a.jsx("button",{onClick:()=>w("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:a.jsx(xa,{size:20})}),a.jsx("div",{ref:t,onScroll:_,className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:v.map((A,Y)=>{const I=N0(A);return a.jsx("div",{className:"flex-shrink-0 cursor-pointer w-24 h-24 sm:w-32 sm:h-32 rounded-xl overflow-hidden bg-toss-gray-100",onClick:()=>S(Y),children:a.jsx("img",{src:I,alt:`  ${Y+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:ae=>{ae.target.style.display="none"}})},Y)})}),n&&a.jsx("button",{onClick:()=>w("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:a.jsx(Js,{size:20})})]})]}),g.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:["  (",g.length,")"]}),a.jsx("div",{className:"space-y-2",children:g.map((A,Y)=>{const I=N0(A),ae=typeof A=="string"?I.split("/").pop():A.name||I.split("/").pop();return a.jsxs("a",{href:I,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors",children:[a.jsx(Ea,{size:16,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-sm text-toss-blue hover:underline flex-1 truncate",children:ae}),a.jsx(Jr,{size:16,className:"text-toss-gray-500"})]},Y)})})]}),l!==null&&a.jsxs("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center select-none",style:{zIndex:9999},onClick:N,onMouseUp:ue,onMouseLeave:ue,onTouchEnd:ue,children:[a.jsx("button",{className:"absolute top-4 right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors",onClick:N,children:a.jsx(mr,{size:24})}),a.jsxs("div",{className:"absolute top-4 left-4 z-10 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm font-medium",children:[l+1," / ",v.length]}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[v.length>1&&a.jsx("button",{onClick:A=>{A.stopPropagation(),E()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:a.jsx(xa,{size:36,strokeWidth:3})}),a.jsx("div",{onClick:A=>A.stopPropagation(),onMouseDown:F,onMouseMove:L,onTouchStart:O,onTouchMove:H,className:"max-w-[70vw] sm:max-w-[80vw] max-h-[90vh] relative cursor-grab active:cursor-grabbing",style:{transform:`translateX(${y}px)`,transition:d?"none":"transform 0.3s ease-out"},children:a.jsx("img",{src:N0(v[l]),alt:`  ${l+1}`,className:"max-w-full max-h-[90vh] object-contain rounded-lg pointer-events-none",draggable:!1})}),v.length>1&&a.jsx("button",{onClick:A=>{A.stopPropagation(),C()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:a.jsx(Js,{size:36,strokeWidth:3})})]}),v.length>1&&a.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2",children:v.map((A,Y)=>a.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${Y===l?"bg-white":"bg-white/30"}`},Y))})]})]})},$U=()=>{const{profile:e,isAdmin:t}=qr(),[r,s]=K.useState([]),[n,o]=K.useState([]),[l,u]=K.useState(!1),[d,h]=K.useState(!1),[m,x]=K.useState(!0),[y,b]=K.useState(!1),[v,g]=K.useState(null),[_,w]=K.useState(new Date().getFullYear()),[S,N]=K.useState("all"),[E,C]=K.useState(1),F=15,O=K.useRef(null),[B,L]=K.useState(new Set),[H,ue]=K.useState(!1),[A,Y]=K.useState(!1),[I,ae]=K.useState([]),[Q,re]=K.useState({work_date:new Date().toISOString().split("T")[0],monthly_tasks:[qn()],special_notes:"",files:[],existingFileUrls:[]}),ve=2026,te=new Date().getFullYear(),ke=Array.from({length:te-ve+1},(Le,rt)=>ve+rt);K.useEffect(()=>{J()},[]),K.useEffect(()=>{Z()},[r,_,S]);const Z=()=>{const Le=r.filter(rt=>{const oe=new Date(rt.work_date).getFullYear()===_,Ne=S==="all"||rt.user_id===S;return oe&&Ne});o(Le),C(1)},M=Array.from(new Set(r.map(Le=>Le.user_id))).map(Le=>{const rt=r.find(ct=>ct.user_id===Le);return{user_id:Le,name:rt?.user?.name||"  "}}).sort((Le,rt)=>Le.name.localeCompare(rt.name)),J=async()=>{try{let Le=Pe.from("work_logs").select("*").eq("type","monthly").order("work_date",{ascending:!1});!t&&e&&(Le=Le.eq("user_id",e.user_id));const{data:rt,error:ct}=await Le;if(ct)throw ct;const{data:oe,error:Ne}=await Pe.from("users").select("user_id, name, team, rank");if(Ne)throw Ne;const xe=(rt||[]).map(je=>{const fe=(oe||[]).find(Oe=>Oe.user_id===je.user_id);return{...je,user:fe||{name:"  ",team:"-",rank:"-"}}});s(xe)}catch(Le){console.error("Error fetching worklogs:",Le)}finally{x(!1)}},V=()=>{re(Le=>({...Le,monthly_tasks:[...Le.monthly_tasks,qn()]}))},X=Le=>{re(rt=>({...rt,monthly_tasks:rt.monthly_tasks.filter((ct,oe)=>oe!==Le)}))},se=(Le,rt)=>{re(ct=>({...ct,monthly_tasks:ct.monthly_tasks.map((oe,Ne)=>Ne===Le?{...oe,title:rt}:oe)}))},P=Le=>{re(rt=>({...rt,monthly_tasks:rt.monthly_tasks.map((ct,oe)=>oe===Le?{...ct,details:[...ct.details,Fv()]}:ct)}))},U=(Le,rt)=>{re(ct=>({...ct,monthly_tasks:ct.monthly_tasks.map((oe,Ne)=>Ne===Le?{...oe,details:oe.details.filter((xe,je)=>je!==rt)}:oe)}))},ce=(Le,rt,ct,oe)=>{re(Ne=>({...Ne,monthly_tasks:Ne.monthly_tasks.map((xe,je)=>je===Le?{...xe,details:xe.details.map((fe,Oe)=>Oe===rt?{...fe,[ct]:oe}:fe)}:xe)}))},ne=Le=>{const ct=Array.from(Le.target.files||[]).map(oe=>({file:oe,name:oe.name,size:(oe.size/1024).toFixed(0)+"KB"}));re(oe=>({...oe,files:[...oe.files,...ct]}))},ie=Le=>{re(rt=>({...rt,files:rt.files.filter((ct,oe)=>oe!==Le)}))},W=Le=>{re(rt=>({...rt,existingFileUrls:rt.existingFileUrls.filter((ct,oe)=>oe!==Le)}))},G=async Le=>{const rt=`/intranet/worklogs/monthly/${e.user_id}`;return(await af(Le.map(oe=>oe.file),rt)).map(oe=>oe.url)},k=async()=>{const Le=B0(Q.monthly_tasks);if(!Le){alert("    .");return}try{b(!0);let rt=[];Q.files.length>0&&(rt=await G(Q.files));const{error:ct}=await Pe.from("work_logs").insert({work_date:Q.work_date,morning_work:Le,special_notes:Q.special_notes,file_urls:rt,user_id:e.user_id,type:"monthly",is_read:!1});if(ct)throw ct;u(!1),R(),J(),alert("  .")}catch(rt){console.error("Error creating worklog:",rt),alert("   : "+rt.message)}finally{b(!1)}},de=async()=>{const Le=B0(Q.monthly_tasks);if(!Le){alert("    .");return}if(!v?.id){alert("    .");return}const rt=v.id;try{b(!0);let ct=[];Q.files.length>0&&(ct=await G(Q.files));const oe=[...Q.existingFileUrls,...ct],{error:Ne}=await Pe.from("work_logs").update({work_date:Q.work_date,morning_work:Le,special_notes:Q.special_notes,file_urls:oe}).eq("id",rt);if(Ne)throw Ne;u(!1),R(),J(),alert("  .")}catch(ct){console.error("Error updating worklog:",ct),alert("   : "+ct.message)}finally{b(!1)}},z=Le=>{const rt=new Date(Le),ct=rt.getFullYear(),oe=rt.getMonth(),Ne=new Date(ct,oe,1).toISOString().split("T")[0],xe=new Date(ct,oe+1,0).toISOString().split("T")[0];return{start:Ne,end:xe}},T=async()=>{if(e?.user_id){ue(!0);try{const{start:Le,end:rt}=z(Q.work_date),{data:ct,error:oe}=await Pe.from("work_logs").select("work_date, morning_work").eq("user_id",e.user_id).eq("type","weekly").gte("work_date",Le).lte("work_date",rt).order("work_date",{ascending:!0});if(oe)throw oe;if(!ct||ct.length===0){alert("     .");return}const Ne=[];if(ct.forEach(xe=>{const je=new Date(xe.work_date),fe=new Date(je.getFullYear(),je.getMonth(),1),Ue=`${Math.ceil((je.getDate()+fe.getDay())/7)}`;zn(xe.morning_work).forEach(pt=>{Ne.push({title:pt.title?`[${Ue}] ${pt.title}`:`[${Ue}]`,details:pt.details})})}),Ne.length===0){alert("      .");return}ae(Ne),Y(!0)}catch(Le){console.error("Error fetching weekly worklogs:",Le),alert("   .")}finally{ue(!1)}}},R=()=>{re({work_date:new Date().toISOString().split("T")[0],monthly_tasks:[qn()],special_notes:"",files:[],existingFileUrls:[]}),h(!1),g(null),Y(!1),ae([])},q=Le=>{re({work_date:Le.work_date,monthly_tasks:zn(Le.morning_work||""),special_notes:Le.special_notes||"",files:[],existingFileUrls:Le.file_urls||[]}),g(Le),h(!0),u(!0)},me=()=>{R(),u(!0)},_e=async Le=>{if(confirm(" ?"))try{Le.file_urls&&Le.file_urls.length>0&&await om(Le.file_urls);const{error:rt}=await Pe.from("work_logs").delete().eq("id",Le.id);if(rt)throw rt;J(),alert(".")}catch(rt){console.error("Error deleting worklog:",rt),alert(" .")}},le=async Le=>{g(Le),t&&!Le.is_read&&(await Pe.from("work_logs").update({is_read:!0}).eq("id",Le.id),J())},Ae=Le=>{const rt=new Date(Le);return`${rt.getFullYear()} ${rt.getMonth()+1}`},Me=Le=>new Date(Le).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}),Ee=async Le=>{const rt={top:{style:nr.SINGLE,size:1,color:"333333"},bottom:{style:nr.SINGLE,size:1,color:"333333"},left:{style:nr.SINGLE,size:1,color:"333333"},right:{style:nr.SINGLE,size:1,color:"333333"}},ct={shading:{fill:"F8F9FA"},borders:rt,verticalAlign:"center"},oe=st=>st.split(`
`).map(pt=>new ot({children:[new Dt({text:pt||" ",size:24})],spacing:{line:360}})),Ne=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:24})],alignment:Ft.CENTER})],width:{size:15,type:Bt.PERCENTAGE},...ct}),new gt({children:[new ot({children:[new Dt({text:Ae(Le.work_date),size:24})]})],width:{size:35,type:Bt.PERCENTAGE},borders:rt}),new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:24})],alignment:Ft.CENTER})],width:{size:15,type:Bt.PERCENTAGE},...ct}),new gt({children:[new ot({children:[new Dt({text:Le.user?.team||"-",size:24})]})],width:{size:35,type:Bt.PERCENTAGE},borders:rt})]}),new pr({children:[new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:24})],alignment:Ft.CENTER})],...ct}),new gt({children:[new ot({children:[new Dt({text:Le.user?.rank||"-",size:24})]})],borders:rt}),new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:24})],alignment:Ft.CENTER})],...ct}),new gt({children:[new ot({children:[new Dt({text:Le.user?.name||"-",size:24})]})],borders:rt})]})]}),xe=zn(Le.morning_work),je=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Dt({text:".    ",bold:!0,size:24})]})],columnSpan:4,...ct})]}),new pr({children:[new gt({children:[new ot({children:[new Dt({text:"No",bold:!0,size:22})],alignment:Ft.CENTER})],width:{size:7,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:rt}),new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:22})],alignment:Ft.CENTER})],width:{size:58,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:rt}),new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:22})],alignment:Ft.CENTER})],width:{size:12,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:rt}),new gt({children:[new ot({children:[new Dt({text:"",bold:!0,size:22})],alignment:Ft.CENTER})],width:{size:23,type:Bt.PERCENTAGE},shading:{fill:"F0F0F0"},borders:rt})]}),...xe.flatMap((st,pt)=>{const Nt=(st.title?1:0)+st.details.length,Vt={top:{style:nr.SINGLE,size:1,color:"CCCCCC"},bottom:{style:nr.SINGLE,size:1,color:"CCCCCC"},left:{style:nr.SINGLE,size:1,color:"333333"},right:{style:nr.SINGLE,size:1,color:"333333"}},yr=[];return st.title&&yr.push(new pr({children:[new gt({children:[new ot({children:[new Dt({text:String(pt+1),size:22})],alignment:Ft.CENTER})],borders:rt,verticalAlign:"top",rowSpan:Nt}),new gt({children:[new ot({children:[new Dt({text:`[${st.title}]`,bold:!0,size:22})]})],borders:Vt,margins:{top:100,bottom:100,left:100,right:100}}),new gt({children:[new ot({text:""})],borders:Vt}),new gt({children:[new ot({text:""})],borders:Vt})]})),st.details.forEach((_r,zt)=>{const fr=[];_r.content.split(`
`).forEach(he=>{he.trim()&&fr.push(new ot({children:[new Dt({text:`- ${he}`,size:22})]}))});const Zr=zt===st.details.length-1?rt:Vt;yr.push(new pr({children:[...!st.title&&zt===0?[new gt({children:[new ot({children:[new Dt({text:String(pt+1),size:22})],alignment:Ft.CENTER})],borders:rt,verticalAlign:"top",rowSpan:Nt})]:[],new gt({children:fr,borders:Zr,margins:{top:100,bottom:100,left:100,right:100}}),new gt({children:[new ot({children:[new Dt({text:_r.progress?_r.progress+"%":"-",size:22})],alignment:Ft.CENTER})],borders:Zr,verticalAlign:"top"}),new gt({children:[new ot({children:[new Dt({text:_r.remark||"-",size:22})]})],borders:Zr,margins:{left:100,right:100},verticalAlign:"top"})]}))}),yr})]}),fe=new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:[new pr({children:[new gt({children:[new ot({children:[new Dt({text:".   ",bold:!0,size:24})]})],...ct})]}),new pr({children:[new gt({children:oe(Le.special_notes||" "),borders:rt,margins:{top:kr(.15),bottom:kr(.15),left:kr(.15),right:kr(.15)}})]})]}),Oe=new xm({sections:[{properties:{page:{margin:{top:kr(.6),bottom:kr(.8),left:kr(.8),right:kr(.8)}}},children:[new ot({children:[new Dt({text:`: ${Me(Le.work_date)}`,size:22,color:"666666"})],alignment:Ft.RIGHT,spacing:{after:200}}),new ot({children:[new Dt({text:"      ",bold:!0,size:44})],alignment:Ft.CENTER,spacing:{after:200},border:{bottom:{style:nr.SINGLE,size:12,color:"333333"}}}),new ot({text:"",spacing:{after:300}}),Ne,new ot({text:"",spacing:{after:300}}),je,new ot({text:"",spacing:{after:300}}),fe,new ot({text:"",spacing:{after:400}}),new ot({children:[new Dt({text:"",bold:!0,size:26})],alignment:Ft.CENTER})]}]}),Ue=await gm.toBlob(Oe);ym.saveAs(Ue,`_${Ae(Le.work_date)}_${Le.user?.name||""}.docx`)},Ce=Le=>{DU(Le,Ae)},Je=E*F,$e=Je-F,tt=n.slice($e,Je),De=Math.ceil(n.length/F),ft=Le=>{C(Le)},jt=Le=>{L(rt=>{const ct=new Set(rt);return ct.has(Le)?ct.delete(Le):ct.add(Le),ct})},vt=()=>{tt.length>0&&tt.every(Le=>B.has(Le.id))?L(Le=>{const rt=new Set(Le);return tt.forEach(ct=>rt.delete(ct.id)),rt}):L(Le=>{const rt=new Set(Le);return tt.forEach(ct=>rt.add(ct.id)),rt})},At=()=>{const Le=B.size>0?n.filter(Ne=>B.has(Ne.id)):n,rt=B.size>0?`  (${Le.length})`:` (${Le.length})`,ct=Ne=>Ne.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>"),oe=`
            <div class="section-title">  - ${rt}</div>
            ${Le.map((Ne,xe)=>{const je=zn(Ne.morning_work);return`
                    <div style="margin-bottom: 24px; page-break-inside: avoid;">
                        <div style="font-weight: bold; font-size: 13px; margin-bottom: 6px; color: #333;">
                            ${xe+1}. ${Ae(Ne.work_date)} - ${Ne.user?.name||"-"} (${Ne.user?.team||"-"})
                        </div>
                        <table>
                            <colgroup><col style="width:5%"/><col style="width:58%"/><col style="width:10%"/><col style="width:27%"/></colgroup>
                            <thead><tr><th>No</th><th></th><th></th><th></th></tr></thead>
                            <tbody>
                                ${je.map((fe,Oe)=>{const Ue=(fe.title?1:0)+fe.details.length,st=[];return fe.title&&st.push(`<tr>
                                            <td style="text-align:center;vertical-align:top" rowspan="${Ue}">${Oe+1}</td>
                                            <td style="text-align:left;font-weight:bold;border-bottom:1px solid #ccc">[${ct(fe.title)}]</td>
                                            <td style="border-bottom:1px solid #ccc"></td>
                                            <td style="border-bottom:1px solid #ccc"></td>
                                        </tr>`),fe.details.forEach((pt,Nt)=>{const Vt=(pt.content||"-").split(`
`).map(fr=>fr.trim()?`- ${ct(fr)}`:"").filter(Boolean).join("<br/>"),_r=Nt===fe.details.length-1?"":"border-bottom:1px solid #ccc",zt=!fe.title&&Nt===0?`<td style="text-align:center;vertical-align:top" rowspan="${Ue}">${Oe+1}</td>`:"";st.push(`<tr>
                                            ${zt}
                                            <td style="text-align:left;white-space:pre-line;${_r}">${Vt}</td>
                                            <td style="text-align:center;vertical-align:top;${_r}">${pt.progress?pt.progress+"%":"-"}</td>
                                            <td style="text-align:left;vertical-align:top;${_r}">${ct(pt.remark||"")||"-"}</td>
                                        </tr>`)}),st.join("")}).join("")}
                            </tbody>
                        </table>
                    </div>
                `}).join("")}
        `;ml({title:" ",content:oe})},Rt=Le=>{const rt=zn(Le);return a.jsx("div",{className:"bg-toss-gray-50 rounded-xl overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-toss-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-center font-semibold text-toss-gray-700 whitespace-nowrap w-10",children:"No"}),a.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),a.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700",children:""}),a.jsx("th",{className:"px-3 py-2 text-center font-semibold text-toss-gray-700 whitespace-nowrap w-16",children:""}),a.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),a.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:rt.map((ct,oe)=>ct.details.map((Ne,xe)=>a.jsxs("tr",{children:[xe===0&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-2 text-center text-toss-gray-500",rowSpan:ct.details.length,children:oe+1}),a.jsx("td",{className:"px-3 py-2 text-toss-gray-900 font-medium whitespace-nowrap",rowSpan:ct.details.length,children:ct.title||"-"})]}),a.jsx("td",{className:"px-3 py-2 text-toss-gray-900 whitespace-pre-wrap",children:Ne.content}),a.jsx("td",{className:"px-3 py-2 text-center",children:Ne.progress?a.jsxs("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium ${Number(Ne.progress)>=100?"bg-green-100 text-green-700":Number(Ne.progress)>=50?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:[Ne.progress,"%"]}):"-"}),a.jsx("td",{className:"px-3 py-2 text-toss-gray-600",children:Ne.remark||"-"})]},`${oe}-${xe}`)))})]})})};return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(Gs,{size:24})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-1",children:t?"  ":`${e?.name||""}  `}),a.jsx("p",{className:"text-white/90",children:t?"        ":`${e?.team?`${e.team}  `:""}${e?.rank||" "}`})]})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsx("select",{value:_,onChange:Le=>w(Number(Le.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:ke.map(Le=>a.jsxs("option",{value:Le,children:[Le,""]},Le))}),t&&M.length>0&&a.jsxs("select",{value:S,onChange:Le=>N(Le.target.value),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:[a.jsx("option",{value:"all",children:" "}),M.map(Le=>a.jsx("option",{value:Le.user_id,children:Le.name},Le.user_id))]}),a.jsxs(Ye,{variant:"secondary",onClick:At,children:[a.jsx(ia,{size:18})," ",B.size>0&&`(${B.size})`]}),a.jsxs(Ye,{onClick:me,className:"bg-purple-500 hover:bg-purple-600",children:[a.jsx(os,{size:18}),"  "]})]})]}),a.jsx(_t,{padding:"p-0 sm:p-6",children:m?a.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:" ..."}):tt.length>0?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[700px]",children:[a.jsx("thead",{className:"bg-toss-gray-100 border-b-2 border-toss-gray-300",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 w-10",children:a.jsx("input",{type:"checkbox",checked:tt.length>0&&tt.every(Le=>B.has(Le.id)),onChange:vt,className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),a.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:"No"}),a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:" "}),t&&a.jsxs(a.Fragment,{children:[a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]}),a.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700",children:" "}),a.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),a.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:tt.map((Le,rt)=>a.jsxs("tr",{className:`hover:bg-toss-gray-50 transition-colors ${t&&!Le.is_read?"bg-purple-50":""}`,children:[a.jsx("td",{className:"px-3 py-3 text-center w-10",onClick:ct=>ct.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:B.has(Le.id),onChange:()=>jt(Le.id),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-toss-gray-600 whitespace-nowrap",children:$e+rt+1}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 cursor-pointer hover:text-purple-600 whitespace-nowrap",onClick:()=>le(Le),children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ma,{size:14,className:"text-toss-gray-400 flex-shrink-0"}),a.jsx("span",{children:Ae(Le.work_date)}),t&&!Le.is_read&&a.jsx("span",{className:"inline-block bg-purple-500 text-white px-1.5 py-0.5 rounded-full text-xs font-medium flex-shrink-0",children:"N"})]})}),t&&a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 whitespace-nowrap",children:Le.user?.name||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-600 whitespace-nowrap",children:Le.user?.team||"-"})]}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 cursor-pointer max-w-xs truncate",onClick:()=>le(Le),children:P0(Le.morning_work)}),a.jsx("td",{className:"px-3 py-3 text-center whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("button",{onClick:ct=>{ct.stopPropagation(),Ce(Le)},className:"p-2 text-purple-500 hover:bg-purple-100 rounded-lg transition-colors",title:"",children:a.jsx(ia,{size:16})}),a.jsx("button",{onClick:ct=>{ct.stopPropagation(),Ee(Le)},className:"p-2 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"Word ",children:a.jsx(Jr,{size:16})}),(e?.user_id===Le.user_id||t)&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>q(Le),className:"p-2 text-purple-500 hover:bg-purple-100 rounded-lg transition-colors",title:"",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>_e(Le),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:a.jsx(Xt,{size:16})})]})]})})]},Le.id))})]})}),a.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:tt.map((Le,rt)=>a.jsxs("div",{className:`p-4 ${t&&!Le.is_read?"bg-purple-50":""}`,onClick:()=>le(Le),children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:B.has(Le.id),onChange:()=>jt(Le.id),onClick:ct=>ct.stopPropagation(),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),a.jsxs("span",{className:"text-xs text-toss-gray-500",children:["#",$e+rt+1]}),a.jsx(ma,{size:14,className:"text-toss-gray-400"}),a.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:Ae(Le.work_date)}),t&&!Le.is_read&&a.jsx("span",{className:"bg-purple-500 text-white px-2 py-0.5 rounded-full text-xs font-medium",children:"NEW"})]}),a.jsxs("div",{className:"flex items-center gap-1",onClick:ct=>ct.stopPropagation(),children:[a.jsx("button",{onClick:()=>Ce(Le),className:"p-1.5 text-purple-500 hover:bg-purple-100 rounded-lg",children:a.jsx(ia,{size:14})}),a.jsx("button",{onClick:()=>Ee(Le),className:"p-1.5 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg",children:a.jsx(Jr,{size:14})}),(e?.user_id===Le.user_id||t)&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>q(Le),className:"p-1.5 text-purple-500 hover:bg-purple-100 rounded-lg",children:a.jsx(js,{size:14})}),a.jsx("button",{onClick:()=>_e(Le),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:a.jsx(Xt,{size:14})})]})]})]}),t&&a.jsxs("div",{className:"text-xs text-toss-gray-600 mb-2",children:[a.jsx("span",{className:"font-medium",children:Le.user?.name||"-"}),a.jsx("span",{className:"mx-1",children:""}),a.jsx("span",{children:Le.user?.team||"-"})]}),a.jsx("p",{className:"text-sm text-toss-gray-700 line-clamp-2",children:P0(Le.morning_work)})]},Le.id))}),De>1&&a.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-toss-gray-200",children:[a.jsx("button",{onClick:()=>ft(E-1),disabled:E===1,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),[...Array(De)].map((Le,rt)=>a.jsx("button",{onClick:()=>ft(rt+1),className:`px-3 py-1 rounded-lg text-sm font-medium ${E===rt+1?"bg-purple-500 text-white":"text-toss-gray-700 hover:bg-toss-gray-100"}`,children:rt+1},rt+1)),a.jsx("button",{onClick:()=>ft(E+1),disabled:E===De,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]}):a.jsxs("div",{className:"text-center text-toss-gray-500 py-8",children:[_,"    "]})}),a.jsx(cr,{isOpen:l,onClose:()=>{u(!1),R()},title:d?"  ":"   ",size:A?"xl":"default",children:a.jsxs("div",{className:"flex gap-6",children:[a.jsxs("div",{className:`space-y-6 max-h-[70vh] overflow-y-auto pr-2 ${A?"flex-1 min-w-0":"w-full"}`,children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),a.jsx("input",{type:"date",value:Q.work_date,onChange:Le=>re({...Q,work_date:Le.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"}),a.jsxs("p",{className:"text-sm text-toss-gray-500 mt-1",children:[Ae(Q.work_date)," "]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700",children:"  *"}),a.jsxs("button",{type:"button",onClick:T,disabled:H,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-purple-600 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors disabled:opacity-50",children:[a.jsx(il,{size:14,className:H?"animate-spin":""}),H?" ...":"  "]})]}),a.jsxs("div",{className:"space-y-3",children:[Q.monthly_tasks.map((Le,rt)=>a.jsxs("div",{className:"bg-toss-gray-50 rounded-xl p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:Le.title,onChange:ct=>se(rt,ct.target.value),className:"flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm font-medium focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:""}),Q.monthly_tasks.length>1&&a.jsx("button",{type:"button",onClick:()=>X(rt),className:"p-1.5 text-red-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors flex-shrink-0 w-[28px] flex items-center justify-center",title:" ",children:a.jsx(Xt,{size:14})}),Q.monthly_tasks.length<=1&&a.jsx("div",{className:"w-[28px] flex-shrink-0"})]}),a.jsxs("div",{className:"hidden sm:grid sm:grid-cols-[1fr_50px_100px_28px] gap-2 px-1",children:[a.jsx("span",{className:"text-xs font-medium text-toss-gray-500",children:""}),a.jsx("span",{className:"text-xs font-medium text-toss-gray-500 text-center",children:""}),a.jsx("span",{className:"text-xs font-medium text-toss-gray-500",children:""}),a.jsx("span",{})]}),Le.details.map((ct,oe)=>a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_50px_100px_28px] gap-2 items-stretch",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:""}),a.jsx("textarea",{value:ct.content,onChange:Ne=>ce(rt,oe,"content",Ne.target.value),rows:2,className:"w-full flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all resize-none leading-relaxed",placeholder:"  "})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:"(%)"}),a.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:ct.progress,onChange:Ne=>{const xe=Ne.target.value.replace(/[^0-9]/g,"");(xe===""||parseInt(xe)>=0&&parseInt(xe)<=100)&&ce(rt,oe,"progress",xe)},className:"w-full flex-1 px-2 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm text-center focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"%"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:""}),a.jsx("input",{type:"text",value:ct.remark,onChange:Ne=>ce(rt,oe,"remark",Ne.target.value),className:"w-full flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:""})]}),a.jsx("div",{className:"flex items-center justify-center",children:Le.details.length>1&&a.jsx("button",{type:"button",onClick:()=>U(rt,oe),className:"p-1 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:" ",children:a.jsx(mr,{size:14})})})]},oe)),a.jsxs("button",{type:"button",onClick:()=>P(rt),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-purple-600 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[a.jsx(os,{size:14}),"  "]})]},rt)),a.jsxs("button",{type:"button",onClick:V,className:"flex items-center gap-2 px-4 py-2 text-purple-600 hover:bg-purple-50 rounded-xl transition-colors text-sm font-medium",children:[a.jsx(D0,{size:16}),"  "]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"()"}),a.jsx("textarea",{value:Q.special_notes,onChange:Le=>re({...Q,special_notes:Le.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),d&&Q.existingFileUrls.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("div",{className:"space-y-2",children:Q.existingFileUrls.map((Le,rt)=>{const ct=Le.split("/").pop();return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ea,{size:16,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-sm text-toss-gray-700",children:ct})]}),a.jsx("button",{onClick:()=>W(rt),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:a.jsx(mr,{size:16})})]},rt)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("input",{type:"file",ref:O,multiple:!0,onChange:ne,className:"hidden"}),a.jsx("button",{type:"button",onClick:()=>O.current?.click(),className:"w-full p-6 border-2 border-dashed border-toss-gray-300 rounded-2xl hover:border-purple-500 hover:bg-purple-50/50 transition-all",children:a.jsxs("div",{className:"flex flex-col items-center gap-2 text-toss-gray-600",children:[a.jsx(Gn,{size:28}),a.jsx("span",{className:"font-medium",children:" "}),a.jsx("span",{className:"text-xs text-toss-gray-500",children:"   "})]})}),Q.files.length>0&&a.jsx("div",{className:"mt-4 space-y-2",children:Q.files.map((Le,rt)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ea,{size:16,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-sm text-toss-gray-700",children:Le.name}),a.jsxs("span",{className:"text-xs text-toss-gray-500",children:["(",Le.size,")"]})]}),a.jsx("button",{onClick:()=>ie(rt),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:a.jsx(mr,{size:16})})]},rt))})]}),a.jsxs("div",{className:"flex gap-3 pt-4 sticky bottom-0 bg-white",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{u(!1),R()},className:"flex-1",children:""}),a.jsx(Ye,{onClick:d?de:k,className:"flex-1 bg-purple-500 hover:bg-purple-600",loading:y,disabled:y,children:y?" ...":d?"":""})]})]}),A&&a.jsxs("div",{className:"flex-1 min-w-0 flex flex-col max-h-[70vh]",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-50 border border-purple-200 rounded-t-xl",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ma,{size:16,className:"text-purple-600"}),a.jsx("span",{className:"text-sm font-semibold text-purple-800",children:"  "})]}),a.jsx("button",{type:"button",onClick:()=>{Y(!1),ae([])},className:"p-1.5 text-purple-600 hover:bg-purple-100 rounded-lg transition-colors",children:a.jsx(mr,{size:16})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto border-x border-purple-200 bg-white px-4 py-3",children:I.length>0?a.jsx("div",{className:"space-y-3",children:I.map((Le,rt)=>{const ct=(Le.title||"").match(/^\[(\d+)\]\s*(.*)$/),oe=ct?ct[1]:"",Ne=ct?ct[2]:Le.title||"",xe=rt>0?(I[rt-1].title||"").match(/^\[(\d+)\]/):null,je=xe?xe[1]:"",fe=oe&&oe!==je;return a.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-3",children:[fe&&a.jsxs("div",{className:"text-sm font-semibold text-purple-600 mb-0.5",children:["[",oe,"]"]}),Ne&&a.jsxs("div",{className:"text-sm font-semibold text-purple-800 mb-1",children:["[",Ne,"]"]}),!fe&&!Ne&&a.jsx("div",{className:"text-sm font-semibold text-purple-800 mb-1",children:"[-]"}),Le.details.map((Oe,Ue)=>a.jsx("div",{className:"text-sm text-toss-gray-700 ml-2 mb-1",children:(Oe.content||"-").split(`
`).map((st,pt)=>a.jsx("div",{children:st.trim()?`- ${st.trim()}`:""},pt))},Ue))]},rt)})}):a.jsx("div",{className:"flex items-center justify-center h-full text-toss-gray-400 text-sm",children:" ..."})}),I.length>0&&a.jsx("div",{className:"border-x border-b border-purple-200 rounded-b-xl bg-purple-50/30 px-4 py-2",children:a.jsxs("button",{type:"button",onClick:()=>{let Le="";const rt=I.map(ct=>{const oe=(ct.title||"").match(/^\[(\d+)\]\s*(.*)$/),Ne=oe?oe[1]:"",xe=oe?oe[2]:ct.title||"",je=[];return Ne&&Ne!==Le&&je.push(`[${Ne}]`),Le=Ne,xe&&je.push(`[${xe}]`),ct.details.forEach(fe=>{(fe.content||"-").split(`
`).forEach(Oe=>{Oe.trim()&&je.push(`- ${Oe.trim()}`)})}),je.join(`
`)}).join(`

`);navigator.clipboard.writeText(rt).then(()=>{alert(" .")})},className:"w-full flex items-center justify-center gap-2 py-2 text-sm font-medium text-purple-700 hover:bg-purple-100 rounded-lg transition-colors",children:[a.jsx(am,{size:15}),""]})})]})]})}),a.jsx(cr,{isOpen:!!v&&!l,onClose:()=>g(null),title:"  ",children:v&&a.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto -mx-2 px-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),a.jsx("p",{className:"text-toss-gray-900",children:Ae(v.work_date)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-toss-gray-900 font-medium",children:v.user?`${v.user.name}  ${v.user.team||" "}`:"-"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),Rt(v.morning_work)]}),v.special_notes&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:"()"}),a.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 whitespace-pre-wrap text-toss-gray-900",children:v.special_notes})]}),v.file_urls&&v.file_urls.length>0&&a.jsx(zU,{urls:v.file_urls}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsxs("button",{onClick:()=>Ce(v),className:"flex items-center gap-2 px-4 py-2 bg-purple-50 text-purple-600 rounded-xl hover:bg-purple-100 transition-colors text-sm font-medium",children:[a.jsx(ia,{size:16}),""]}),a.jsxs("button",{onClick:()=>Ee(v),className:"flex items-center gap-2 px-4 py-2 bg-toss-gray-100 text-toss-gray-700 rounded-xl hover:bg-toss-gray-200 transition-colors text-sm font-medium",children:[a.jsx(Jr,{size:16}),"Word "]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>g(null),className:"flex-1",children:""}),a.jsx(Ye,{onClick:()=>q(v),className:"flex-1 bg-purple-500 hover:bg-purple-600",children:""})]})]})})]})},AS={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""},CS={PH:"",KH:"",VN:"",GT:"",US:"",BR:"",CL:"",NL:"",CN:"",TH:"",AU:"",SG:"",JP:"",MY:"",ID:"",IN:"",MX:"",PE:"",CO:"",EC:"",MM:"",LA:"",BD:"",NP:"",PK:"",AE:"",SA:"",QA:"",KW:"",RU:"",UA:"",PL:"",DE:"",FR:"",GB:"",IT:"",ES:"",CA:"",NZ:"",ZA:"",KE:"",NG:"",EG:"",MA:"",TR:""},tr={statsTop:245,statsHeight:114,statsBoxes:[{left:330,width:310},{left:647,width:310},{left:964,width:315},{left:1282,width:310}],tableDataTop:457,rowHeight:57,leftTable:{left:330},rightTable:{left:965},columnWidth:313};function qU({isOpen:e,onClose:t,summaryStats:r,countryStats:s}){const n=K.useRef(null),o=K.useRef(null),[l,u]=K.useState(!1),[d,h]=K.useState(!0),[m,x]=K.useState(null);K.useEffect(()=>{const g=()=>{u(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",g),()=>document.removeEventListener("fullscreenchange",g)},[]),K.useEffect(()=>{const g=_=>{_.key==="Escape"&&!l&&t()};return e&&document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[e,l,t]);const y=K.useCallback(async()=>{const g=n.current;if(!g)return;h(!0);const _=2;g.width=1920*_,g.height=1080*_;const w=g.getContext("2d");w.imageSmoothingEnabled=!0,w.imageSmoothingQuality="high",w.scale(_,_);const S="/company-intranet/",N=new Image;N.crossOrigin="anonymous",N.src=`${S}back.jpg`,await new Promise(B=>{N.onload=B,N.onerror=B}),w.drawImage(N,0,0,1920,1080);const E=new Image;E.crossOrigin="anonymous",E.src=`${S}template.png`,await new Promise(B=>{E.onload=B,E.onerror=B}),w.drawImage(E,0,0,1920,1080),w.textBaseline="middle";const C=tr.statsTop+tr.statsHeight/2;w.font="bold 48px Pretendard, -apple-system, sans-serif",w.fillStyle="#1f2937",w.textAlign="center",w.fillText(`${r?.this_week||0}`,tr.statsBoxes[0].left+tr.statsBoxes[0].width/2-15,C),w.font="24px Pretendard, -apple-system, sans-serif",w.fillText("",tr.statsBoxes[0].left+tr.statsBoxes[0].width/2+35,C),w.font="bold 48px Pretendard, -apple-system, sans-serif",w.fillText(`${r?.this_month||0}`,tr.statsBoxes[1].left+tr.statsBoxes[1].width/2-15,C),w.font="24px Pretendard, -apple-system, sans-serif",w.fillText("",tr.statsBoxes[1].left+tr.statsBoxes[1].width/2+35,C),w.font="bold 48px Pretendard, -apple-system, sans-serif",w.fillText(`${r?.this_year||0}`,tr.statsBoxes[2].left+tr.statsBoxes[2].width/2-15,C),w.font="24px Pretendard, -apple-system, sans-serif",w.fillText("",tr.statsBoxes[2].left+tr.statsBoxes[2].width/2+35,C),w.font="bold 48px Pretendard, -apple-system, sans-serif",w.fillStyle="#2c6eb6",w.fillText(`${r?.total||0}`,tr.statsBoxes[3].left+tr.statsBoxes[3].width/2-20,C),w.font="24px Pretendard, -apple-system, sans-serif",w.fillText("",tr.statsBoxes[3].left+tr.statsBoxes[3].width/2+45,C),(s?.in_progress||[]).forEach((B,L)=>{const H=tr.tableDataTop+L*tr.rowHeight+tr.rowHeight/2,ue=B.country_name||CS[B.country_code]||B.country_code,A=AS[ue]||"";w.font="32px Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji, sans-serif",w.textAlign="left",w.fillText(A,tr.leftTable.left+25,H),w.font="600 24px Pretendard, -apple-system, sans-serif",w.fillStyle="#374151",w.fillText(ue,tr.leftTable.left+70,H),w.font="bold 28px Pretendard, -apple-system, sans-serif",w.fillStyle="#1f2937",w.textAlign="center",w.fillText(`${B.rescue_count||0}`,tr.leftTable.left+tr.columnWidth+tr.columnWidth/2-20,H),w.font="24px Pretendard, -apple-system, sans-serif",w.fillStyle="#374151",w.fillText("",tr.leftTable.left+tr.columnWidth+tr.columnWidth/2+25,H)}),(s?.completed||[]).forEach((B,L)=>{const H=tr.tableDataTop+L*tr.rowHeight+tr.rowHeight/2,ue=B.country_name||CS[B.country_code]||B.country_code,A=AS[ue]||"";w.font="32px Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji, sans-serif",w.textAlign="left",w.fillText(A,tr.rightTable.left+25,H),w.font="600 24px Pretendard, -apple-system, sans-serif",w.fillStyle="#374151",w.fillText(ue,tr.rightTable.left+70,H),w.font="bold 28px Pretendard, -apple-system, sans-serif",w.fillStyle="#1f2937",w.textAlign="center",w.fillText(`${B.rescue_count||0}`,tr.rightTable.left+tr.columnWidth+tr.columnWidth/2-20,H),w.font="24px Pretendard, -apple-system, sans-serif",w.fillStyle="#374151",w.fillText("",tr.rightTable.left+tr.columnWidth+tr.columnWidth/2+25,H)}),x(g.toDataURL("image/png")),h(!1)},[r,s]);K.useEffect(()=>{if(e){const g=setTimeout(()=>{y()},100);return()=>clearTimeout(g)}},[e,y]);const b=K.useCallback(()=>{document.fullscreenElement?document.exitFullscreen():o.current?.requestFullscreen()},[]),v=K.useCallback(()=>{const g=n.current;g&&g.toBlob(_=>{if(_){const w=URL.createObjectURL(_),S=document.createElement("a");S.download=`_${new Date().toISOString().split("T")[0]}.png`,S.href=w,S.click(),URL.revokeObjectURL(w)}},"image/png")},[]);return e?a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90",children:[a.jsx("canvas",{ref:n,width:1920,height:1080,style:{display:"none"}}),!l&&a.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-[60] p-3 bg-white rounded-full shadow-lg hover:bg-gray-100 transition-colors",title:" (ESC)",children:a.jsx(mr,{size:28})}),a.jsx("div",{ref:o,className:"relative flex items-center justify-center w-full h-full",children:d?a.jsx("div",{className:"text-white text-xl",children:" ..."}):m?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:m,alt:"",className:`max-w-full max-h-full object-contain ${l?"w-full h-full":""}`,style:{maxWidth:l?"100%":"90vw",maxHeight:l?"100%":"90vh"}}),!l&&a.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-3 z-50",children:[a.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-white/90 hover:bg-white rounded-lg shadow-lg transition-all text-gray-800",title:" ",children:[a.jsx(Jr,{size:20}),a.jsx("span",{className:"font-medium",children:""})]}),a.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-4 py-2 bg-white/90 hover:bg-white rounded-lg shadow-lg transition-all text-gray-800",title:"",children:[a.jsx(YE,{size:20}),a.jsx("span",{className:"font-medium",children:""})]})]})]}):a.jsx("div",{className:"text-white text-xl",children:"   ."})})]}):null}const io={KR:"",KP:"",JP:"",CN:"",TW:"",HK:"",MO:"",MN:"",VN:"",TH:"",PH:"",KH:"",LA:"",MM:"",MY:"",SG:"",ID:"",BN:"",TL:"",IN:"",PK:"",BD:"",LK:"",NP:"",BT:"",MV:"",AF:"",KZ:"",UZ:"",KG:"",TJ:"",TM:"",IR:"",IQ:"",SY:"",LB:"",JO:"",IL:"",PS:"",SA:"",AE:"",QA:"",KW:"",BH:"",OM:"",YE:"",TR:"",GB:"",FR:"",DE:"",IT:"",ES:"",PT:"",NL:"",BE:"",LU:"",CH:"",AT:"",PL:"",CZ:"",SK:"",HU:"",RO:"",BG:"",GR:"",HR:"",RS:"",SI:"",BA:"",ME:"",MK:"",AL:"",XK:"",UA:"",BY:"",MD:"",RU:"",EE:"",LV:"",LT:"",FI:"",SE:"",NO:"",DK:"",IS:"",IE:"",MT:"",CY:"",GE:"",AM:"",AZ:"",MC:"",AD:"",SM:"",VA:"",US:"",CA:"",MX:"",GT:"",BZ:"",SV:"",HN:"",NI:"",CR:"",PA:"",CU:"",JM:"",HT:"",DO:"",PR:"",BS:"",TT:"",BB:"",BR:"",AR:"",CL:"",PE:"",CO:"",VE:"",EC:"",BO:"",PY:"",UY:"",GY:"",SR:"",AU:"",NZ:"",PG:"",FJ:"",WS:"",TO:"",VU:"",SB:"",GU:"",EG:"",LY:"",TN:"",DZ:"",MA:"",ZA:"",NG:"",KE:"",ET:"",GH:"",TZ:"",UG:"",ZW:"",MZ:"",AO:"",CM:"",CI:"",SN:"",CD:"",CG:"",SD:"",SS:"",SO:"",RW:"",MG:"",MU:"",NA:"",BW:"",ZM:"",MW:"",MR:"",ML:"",NE:"",TD:"",BF:"",TG:"",BJ:"",LR:"",SL:"",GN:"",GM:"",CV:"",DJ:"",ER:""},RS=[{code:"KR",name:""},{code:"KP",name:""},{code:"JP",name:""},{code:"CN",name:""},{code:"TW",name:""},{code:"HK",name:""},{code:"MO",name:""},{code:"MN",name:""},{code:"VN",name:""},{code:"TH",name:""},{code:"PH",name:""},{code:"KH",name:""},{code:"LA",name:""},{code:"MM",name:""},{code:"MY",name:""},{code:"SG",name:""},{code:"ID",name:""},{code:"BN",name:""},{code:"TL",name:""},{code:"IN",name:""},{code:"PK",name:""},{code:"BD",name:""},{code:"LK",name:""},{code:"NP",name:""},{code:"BT",name:""},{code:"MV",name:""},{code:"AF",name:""},{code:"KZ",name:""},{code:"UZ",name:""},{code:"KG",name:""},{code:"TJ",name:""},{code:"TM",name:""},{code:"IR",name:""},{code:"IQ",name:""},{code:"SY",name:""},{code:"LB",name:""},{code:"JO",name:""},{code:"IL",name:""},{code:"PS",name:""},{code:"SA",name:""},{code:"AE",name:""},{code:"QA",name:""},{code:"KW",name:""},{code:"BH",name:""},{code:"OM",name:""},{code:"YE",name:""},{code:"TR",name:""},{code:"GB",name:""},{code:"FR",name:""},{code:"DE",name:""},{code:"IT",name:""},{code:"ES",name:""},{code:"PT",name:""},{code:"NL",name:""},{code:"BE",name:""},{code:"LU",name:""},{code:"CH",name:""},{code:"AT",name:""},{code:"PL",name:""},{code:"CZ",name:""},{code:"SK",name:""},{code:"HU",name:""},{code:"RO",name:""},{code:"BG",name:""},{code:"GR",name:""},{code:"HR",name:""},{code:"RS",name:""},{code:"SI",name:""},{code:"BA",name:""},{code:"ME",name:""},{code:"MK",name:""},{code:"AL",name:""},{code:"XK",name:""},{code:"UA",name:""},{code:"BY",name:""},{code:"MD",name:""},{code:"RU",name:""},{code:"EE",name:""},{code:"LV",name:""},{code:"LT",name:""},{code:"FI",name:""},{code:"SE",name:""},{code:"NO",name:""},{code:"DK",name:""},{code:"IS",name:""},{code:"IE",name:""},{code:"MT",name:""},{code:"CY",name:""},{code:"GE",name:""},{code:"AM",name:""},{code:"AZ",name:""},{code:"MC",name:""},{code:"AD",name:""},{code:"SM",name:""},{code:"VA",name:""},{code:"US",name:""},{code:"CA",name:""},{code:"MX",name:""},{code:"GT",name:""},{code:"BZ",name:""},{code:"SV",name:""},{code:"HN",name:""},{code:"NI",name:""},{code:"CR",name:""},{code:"PA",name:""},{code:"CU",name:""},{code:"JM",name:""},{code:"HT",name:""},{code:"DO",name:""},{code:"PR",name:""},{code:"BS",name:""},{code:"TT",name:""},{code:"BB",name:""},{code:"BR",name:""},{code:"AR",name:""},{code:"CL",name:""},{code:"PE",name:""},{code:"CO",name:""},{code:"VE",name:""},{code:"EC",name:""},{code:"BO",name:""},{code:"PY",name:""},{code:"UY",name:""},{code:"GY",name:""},{code:"SR",name:""},{code:"AU",name:""},{code:"NZ",name:""},{code:"PG",name:""},{code:"FJ",name:""},{code:"WS",name:""},{code:"TO",name:""},{code:"VU",name:""},{code:"SB",name:""},{code:"GU",name:""},{code:"EG",name:""},{code:"LY",name:""},{code:"TN",name:""},{code:"DZ",name:""},{code:"MA",name:""},{code:"ZA",name:""},{code:"NG",name:""},{code:"KE",name:""},{code:"ET",name:""},{code:"GH",name:""},{code:"TZ",name:""},{code:"UG",name:""},{code:"ZW",name:""},{code:"MZ",name:""},{code:"AO",name:""},{code:"CM",name:""},{code:"CI",name:""},{code:"SN",name:""},{code:"CD",name:""},{code:"CG",name:""},{code:"SD",name:""},{code:"SS",name:""},{code:"SO",name:""},{code:"RW",name:""},{code:"MG",name:""},{code:"MU",name:""},{code:"NA",name:""},{code:"BW",name:""},{code:"ZM",name:""},{code:"MW",name:""},{code:"MR",name:""},{code:"ML",name:""},{code:"NE",name:""},{code:"TD",name:""},{code:"BF",name:""},{code:"TG",name:""},{code:"BJ",name:""},{code:"LR",name:""},{code:"SL",name:""},{code:"GN",name:""},{code:"GM",name:""},{code:"CV",name:""},{code:"DJ",name:""},{code:"ER",name:""}].sort((e,t)=>e.name.localeCompare(t.name,"ko")),HU=()=>{const{profile:e,isAdmin:t}=qr(),[r,s]=K.useState([]),[n,o]=K.useState(!1),[l,u]=K.useState(!1),[d,h]=K.useState(!1),[m,x]=K.useState(null),[y,b]=K.useState(!0),[v,g]=K.useState(1),_=15,[w,S]=K.useState(new Set),[N,E]=K.useState(!1),C=K.useRef(null),[F,O]=K.useState({in_progress:[],completed:[]}),[B,L]=K.useState({this_week:0,this_month:0,this_year:0,total:0}),[H,ue]=K.useState(null),[A,Y]=K.useState(!1),[I,ae]=K.useState(!1),[Q,re]=K.useState(!0),ve=K.useRef(null),[te,ke]=K.useState(!1),[Z,M]=K.useState({this_week:0,this_month:0,this_year:0,total:0,in_progress:[],completed:[]}),[J,V]=K.useState({location:"",name:"",request_date:"",status:"",details:"",is_completed:!1,photo_url:"",photo_file:null});K.useEffect(()=>{X(),se(),P()},[]);const X=async()=>{try{const{data:fe,error:Oe}=await Pe.from("rescue_situations").select("*").order("created_at",{ascending:!1});if(Oe)throw Oe;s(fe||[])}catch(fe){console.error("Error fetching rescue situations:",fe),alert("  : "+fe.message)}finally{b(!1)}},se=async()=>{try{const{data:fe,error:Oe}=await Pe.from("rescue_summary_stats").select("*");if(!Oe&&fe&&fe.length>0){const pt={};fe.forEach(Nt=>{pt[Nt.stat_key]=Nt.stat_value}),L(pt)}const{data:Ue,error:st}=await Pe.from("rescue_country_stats").select("*").order("display_order",{ascending:!0});if(!st&&Ue){const pt=Ue.filter(Vt=>Vt.stat_type==="in_progress"),Nt=Ue.filter(Vt=>Vt.stat_type==="completed");O({in_progress:pt,completed:Nt})}}catch(fe){console.error("Error fetching rescue stats:",fe)}},P=async()=>{try{const{data:fe}=await Pe.from("rescue_reference_images").select("*").order("created_at",{ascending:!1}).limit(1).single();fe&&ue(fe)}catch{}},U=()=>{V({location:"",name:"",request_date:"",status:"",details:"",is_completed:!1,photo_url:"",photo_file:null}),h(!1),x(null)},ce=fe=>{const Oe=fe.target.files[0];if(Oe){if(!Oe.type.startsWith("image/")){alert("   .");return}V({...J,photo_file:Oe})}},ne=()=>{V({...J,photo_file:null,photo_url:""}),C.current&&(C.current.value="")},ie=async()=>{if(!J.name||!J.location){alert("    .");return}try{E(!0);let fe="";J.photo_file&&(fe=(await y0(J.photo_file,"/rescue")).url);const{error:Oe}=await Pe.from("rescue_situations").insert({location:J.location,name:J.name,request_date:J.request_date,status:J.status,details:J.details,is_completed:J.is_completed,photo_url:fe,user_id:e.user_id});if(Oe)throw Oe;o(!1),U(),X(),alert(" .")}catch(fe){console.error("Error creating rescue situation:",fe),alert("  : "+fe.message)}finally{E(!1)}},W=async()=>{if(!J.name||!J.location){alert("    .");return}try{E(!0);let fe=J.photo_url;J.photo_file&&(fe=(await y0(J.photo_file,"/rescue")).url);const{error:Oe}=await Pe.from("rescue_situations").update({location:J.location,name:J.name,request_date:J.request_date,status:J.status,details:J.details,is_completed:J.is_completed,photo_url:fe}).eq("id",m.id);if(Oe)throw Oe;o(!1),U(),X(),alert(" .")}catch(fe){console.error("Error updating rescue situation:",fe),alert("  : "+fe.message)}finally{E(!1)}},G=async fe=>{if(confirm(" ?"))try{fe.photo_url&&await v0(fe.photo_url);const{error:Oe}=await Pe.from("rescue_situations").delete().eq("id",fe.id);if(Oe)throw Oe;X(),alert(".")}catch(Oe){console.error("Error deleting rescue situation:",Oe),alert(" .")}},k=async fe=>{try{const{error:Oe}=await Pe.from("rescue_situations").update({is_completed:!fe.is_completed}).eq("id",fe.id);if(Oe)throw Oe;X()}catch(Oe){console.error("Error toggling complete:",Oe),alert("  .")}},de=fe=>{V({location:fe.location||"",name:fe.name||"",request_date:fe.request_date||"",status:fe.status||"",details:fe.details||"",is_completed:fe.is_completed||!1,photo_url:fe.photo_url||"",photo_file:null}),x(fe),h(!0),o(!0)},z=()=>{U(),o(!0)},T=fe=>{x(fe),u(!0)},R=[...r].sort((fe,Oe)=>fe.is_completed!==Oe.is_completed?fe.is_completed?1:-1:new Date(Oe.created_at)-new Date(fe.created_at)),q=v*_,me=q-_,_e=R.slice(me,q),le=Math.ceil(R.length/_),Ae=fe=>{g(fe)},Me=fe=>{S(Oe=>{const Ue=new Set(Oe);return Ue.has(fe)?Ue.delete(fe):Ue.add(fe),Ue})},Ee=()=>{const fe=_e.map(Ue=>Ue.id),Oe=fe.every(Ue=>w.has(Ue));S(Ue=>{const st=new Set(Ue);return Oe?fe.forEach(pt=>st.delete(pt)):fe.forEach(pt=>st.add(pt)),st})},Ce=async()=>{if(w.size===0){alert("  .");return}const fe=r.filter(Nt=>w.has(Nt.id)),Oe=[new pr({tableHeader:!0,children:[new gt({width:{size:800,type:Bt.DXA},shading:{fill:"E8F0FE"},children:[new ot({children:[new Dt({text:"No",bold:!0})],alignment:Ft.CENTER})]}),new gt({width:{size:2e3,type:Bt.DXA},shading:{fill:"E8F0FE"},children:[new ot({children:[new Dt({text:"",bold:!0})],alignment:Ft.CENTER})]}),new gt({width:{size:1500,type:Bt.DXA},shading:{fill:"E8F0FE"},children:[new ot({children:[new Dt({text:"",bold:!0})],alignment:Ft.CENTER})]}),new gt({width:{size:1500,type:Bt.DXA},shading:{fill:"E8F0FE"},children:[new ot({children:[new Dt({text:"",bold:!0})],alignment:Ft.CENTER})]}),new gt({width:{size:4200,type:Bt.DXA},shading:{fill:"E8F0FE"},children:[new ot({children:[new Dt({text:" ",bold:!0})],alignment:Ft.CENTER})]})]}),...fe.map((Nt,Vt)=>new pr({children:[new gt({children:[new ot({text:String(Vt+1),alignment:Ft.CENTER})]}),new gt({children:[new ot({text:Nt.location||"-"})]}),new gt({children:[new ot({text:Nt.name||"-"})]}),new gt({children:[new ot({text:Nt.request_date||"-"})]}),new gt({children:[new ot({text:Nt.details||"-"})]})]}))],Ue=new xm({sections:[{properties:{},children:[new ot({children:[new Dt({text:"",bold:!0,size:32})],alignment:Ft.CENTER}),new ot({text:""}),new Sa({width:{size:100,type:Bt.PERCENTAGE},rows:Oe})]}]}),st=await gm.toBlob(Ue),pt=new Date().toISOString().split("T")[0];ym.saveAs(st,`_${pt}.docx`),S(new Set)},Je=()=>{M({this_week:B.this_week||0,this_month:B.this_month||0,this_year:B.this_year||0,total:B.total||0,in_progress:F.in_progress.map(fe=>({...fe})),completed:F.completed.map(fe=>({...fe}))}),Y(!0)},[$e,tt]=K.useState({in_progress:"",completed:""}),[De,ft]=K.useState({in_progress:null,completed:null}),jt=fe=>{if(!fe)return RS;const Oe=fe.toLowerCase();return RS.filter(Ue=>Ue.name.toLowerCase().includes(Oe)||Ue.code.toLowerCase().includes(Oe))},vt=(fe,Oe)=>{M(Ue=>({...Ue,[fe]:[...Ue[fe],{country_code:Oe.code,country_name:Oe.name,rescue_count:0,stat_type:fe}]})),tt(Ue=>({...Ue,[fe]:""}))},At=(fe,Oe)=>{M(Ue=>({...Ue,[fe]:Ue[fe].filter((st,pt)=>pt!==Oe)}))},Rt=(fe,Oe,Ue,st)=>{M(pt=>{const Nt=[...pt[fe]];return Nt[Oe]={...Nt[Oe],[Ue]:parseInt(st)||0},{...pt,[fe]:Nt}})},Le=(fe,Oe,Ue)=>{M(st=>{const pt=[...st[fe]],Nt=Ue==="up"?Oe-1:Oe+1;if(Nt<0||Nt>=pt.length)return st;const Vt=pt[Oe];return pt[Oe]=pt[Nt],pt[Nt]=Vt,{...st,[fe]:pt}})},rt=(fe,Oe)=>{if(fe.key==="Enter"){if(fe.preventDefault(),fe.stopPropagation(),fe.nativeEvent?.isComposing||fe.isComposing)return;const Ue=$e[Oe];if(!Ue)return;const st=jt(Ue);st.length>0&&vt(Oe,st[0])}},ct=async()=>{try{E(!0);for(const Ue of["this_week","this_month","this_year","total"]){const{error:st}=await Pe.from("rescue_summary_stats").upsert({stat_key:Ue,stat_value:Z[Ue]||0,updated_at:new Date().toISOString()},{onConflict:"stat_key"});if(st)throw st}const{error:fe}=await Pe.from("rescue_country_stats").delete().in("stat_type",["in_progress","completed"]);if(fe)throw fe;const Oe=[...Z.in_progress.map((Ue,st)=>({...Ue,stat_type:"in_progress",display_order:st})),...Z.completed.map((Ue,st)=>({...Ue,stat_type:"completed",display_order:st}))];if(Oe.length>0){const{error:Ue}=await Pe.from("rescue_country_stats").insert(Oe.map(st=>({country_code:st.country_code,country_name:st.country_name,rescue_count:st.rescue_count,stat_type:st.stat_type,display_order:st.display_order})));if(Ue)throw Ue}Y(!1),await se(),alert(" .")}catch(fe){console.error("Error saving stats:",fe),alert("  : "+fe.message)}finally{E(!1)}},oe=async fe=>{const Oe=fe.target.files[0];if(Oe)try{E(!0);const Ue=await y0(Oe,"/rescue/reference");H?.image_url&&(await v0(H.image_url),await Pe.from("rescue_reference_images").delete().eq("id",H.id));const{data:st,error:pt}=await Pe.from("rescue_reference_images").insert({image_url:Ue.url,title:"  "}).select().single();if(pt)throw pt;ue(st),ae(!1),alert(" .")}catch(Ue){console.error("Error uploading reference image:",Ue),alert("  : "+Ue.message)}finally{E(!1)}},Ne=async()=>{if(H&&confirm("  ?"))try{await v0(H.image_url),await Pe.from("rescue_reference_images").delete().eq("id",H.id),ue(null),alert(" .")}catch(fe){console.error("Error deleting reference image:",fe),alert("  .")}},xe=()=>{const fe=[...F.in_progress.map(Ue=>({name:Ue.country_name,flag:io[Ue.country_code]||"",count:Ue.rescue_count,type:" "})),...F.completed.map(Ue=>({name:Ue.country_name,flag:io[Ue.country_code]||"",count:Ue.rescue_count,type:" "}))],Oe=`
            <div class="stats-grid">
                <div class="stat-box"><div class="label"> </div><div class="value">${B.this_week||0}<span class="unit"> </span></div></div>
                <div class="stat-box"><div class="label"> </div><div class="value">${B.this_month||0}<span class="unit"> </span></div></div>
                <div class="stat-box"><div class="label">2026</div><div class="value">${B.this_year||0}<span class="unit"> </span></div></div>
                <div class="stat-box highlight"><div class="label"> </div><div class="value">${B.total||0}<span class="unit"> </span></div></div>
            </div>
            ${fe.length>0?`
            <div class="section-title">  </div>
            <table>
                <thead><tr><th></th><th></th><th></th></tr></thead>
                <tbody>
                    ${fe.map(Ue=>`<tr><td style="text-align:center">${Ue.type}</td><td style="text-align:center">${Ue.flag} ${Ue.name}</td><td style="text-align:center">${Ue.count}</td></tr>`).join("")}
                </tbody>
            </table>`:""}
        `;ml({title:"  ",content:Oe})},je=()=>{const fe=w.size>0?r.filter(st=>w.has(st.id)):r,Ue=`
            <div class="section-title">  - ${w.size>0?`  (${fe.length})`:` (${fe.length})`}</div>
            <table>
                <colgroup>
                    <col style="width:5%"/>
                    <col style="width:12%"/>
                    <col style="width:8%"/>
                    <col style="width:10%"/>
                    <col style="width:55%"/>
                    <col style="width:10%"/>
                </colgroup>
                <thead><tr><th>No</th><th></th><th></th><th></th><th> </th><th></th></tr></thead>
                <tbody>
                    ${fe.map((st,pt)=>`
                        <tr>
                            <td>${pt+1}</td>
                            <td>${st.location||"-"}</td>
                            <td>${st.name||"-"}</td>
                            <td>${st.request_date||"-"}</td>
                            <td class="left" style="word-break:keep-all">${st.status||"-"}</td>
                            <td>${st.is_completed?"":""}</td>
                        </tr>
                    `).join("")}
                </tbody>
            </table>
        `;ml({title:" ",content:Ue})};return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(Nl,{size:24})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-1",children:" "}),a.jsx("p",{className:"text-white/90",children:t?"    ":"  "})]})]})}),a.jsxs(_t,{padding:"p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-amber-50 border-b border-amber-100 cursor-pointer",onClick:()=>re(!Q),children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("div",{children:a.jsx("h3",{className:"font-bold text-toss-gray-900",children:"26   "})})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:fe=>{fe.stopPropagation(),ke(!0)},className:"p-2 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:a.jsx(nm,{size:18})}),a.jsx("button",{onClick:fe=>{fe.stopPropagation(),xe()},className:"p-2 text-toss-gray-600 hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:a.jsx(ia,{size:18})}),a.jsx("button",{onClick:fe=>{fe.stopPropagation(),Je()},className:"p-2 text-toss-gray-600 hover:bg-amber-100 rounded-lg transition-colors",title:" ",children:a.jsx(_l,{size:18})}),a.jsx("button",{onClick:fe=>{fe.stopPropagation(),ae(!0)},className:"p-2 text-toss-gray-600 hover:bg-amber-100 rounded-lg transition-colors",title:" ",children:a.jsx(XE,{size:18})}),Q?a.jsx(Wn,{size:20,className:"text-toss-gray-500"}):a.jsx(Cn,{size:20,className:"text-toss-gray-500"})]})]}),Q&&a.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[a.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),a.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[B.this_week||0,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),a.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),a.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[B.this_month||0,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),a.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:"2026"}),a.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[B.this_year||0,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),a.jsxs("div",{className:"bg-amber-50 border-2 border-amber-300 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-amber-600 mb-1",children:" "}),a.jsxs("p",{className:"text-2xl font-bold text-amber-600",children:[B.total||0,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]})]}),(F.in_progress.length>0||F.completed.length>0)&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[F.in_progress.length>0&&a.jsxs("div",{className:"border rounded-xl overflow-hidden",children:[a.jsxs("div",{className:"bg-blue-50 px-4 py-2 border-b",children:[a.jsx("span",{className:"font-semibold text-blue-700",children:" "}),a.jsx("span",{className:"text-sm text-blue-500 ml-2",children:" "})]}),a.jsx("div",{className:"divide-y",children:F.in_progress.map((fe,Oe)=>a.jsxs("div",{className:"flex items-center justify-between px-4 py-2 hover:bg-toss-gray-50",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-lg",children:io[fe.country_code]||""}),a.jsx("span",{className:"text-sm text-toss-gray-700",children:fe.country_name})]}),a.jsxs("span",{className:"font-semibold text-toss-gray-900",children:[fe.rescue_count," "]})]},Oe))})]}),F.completed.length>0&&a.jsxs("div",{className:"border rounded-xl overflow-hidden",children:[a.jsxs("div",{className:"bg-orange-50 px-4 py-2 border-b",children:[a.jsx("span",{className:"font-semibold text-orange-700",children:" "}),a.jsx("span",{className:"text-sm text-orange-500 ml-2",children:" "})]}),a.jsx("div",{className:"divide-y",children:F.completed.map((fe,Oe)=>a.jsxs("div",{className:"flex items-center justify-between px-4 py-2 hover:bg-toss-gray-50",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-lg",children:io[fe.country_code]||""}),a.jsx("span",{className:"text-sm text-toss-gray-700",children:fe.country_name})]}),a.jsxs("span",{className:"font-semibold text-toss-gray-900",children:[fe.rescue_count," "]})]},Oe))})]})]}),H&&a.jsxs("div",{className:"mt-4",children:[a.jsx("p",{className:"text-sm font-medium text-toss-gray-500 mb-2",children:" ()"}),a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:H.image_url,alt:"  ",className:"w-full max-h-96 object-contain rounded-xl border bg-toss-gray-50 cursor-pointer",onClick:()=>window.open(H.image_url,"_blank")}),t&&a.jsx("button",{onClick:Ne,className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",title:" ",children:a.jsx(mr,{size:14})})]})]}),F.in_progress.length===0&&F.completed.length===0&&!H&&a.jsx("div",{className:"text-center text-toss-gray-500 py-4",children:t?"      .":"   ."})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:""}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Ye,{variant:"secondary",onClick:je,children:[a.jsx(ia,{size:18}),""]}),a.jsxs(Ye,{variant:"secondary",onClick:Ce,disabled:w.size===0,children:[a.jsx(Jr,{size:18}),"Word  ",w.size>0&&`(${w.size})`]}),a.jsxs(Ye,{onClick:z,children:[a.jsx(os,{size:18}),"  "]})]})]}),a.jsx(_t,{padding:"p-0 sm:p-6",children:y?a.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:" ..."}):_e.length>0?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full table-fixed",children:[a.jsx("thead",{className:"bg-toss-blue/10 border-b-2 border-toss-blue/20",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-toss-gray-900 w-10",children:a.jsx("input",{type:"checkbox",checked:_e.length>0&&_e.every(fe=>w.has(fe.id)),onChange:Ee,className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-toss-gray-900 w-14",children:"No"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-toss-gray-900 w-28",children:""}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-toss-gray-900 w-20",children:""}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-toss-gray-900 w-24",children:""}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-toss-gray-900",children:" "}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-toss-gray-900 w-20",children:""}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-toss-gray-900 w-24",children:""})]})}),a.jsx("tbody",{className:"divide-y divide-toss-gray-100",children:_e.map((fe,Oe)=>a.jsxs("tr",{className:`transition-colors cursor-pointer ${fe.is_completed?"bg-toss-gray-50 hover:bg-toss-gray-100":"bg-orange-50/50 hover:bg-orange-100/50"} ${w.has(fe.id)?"!bg-blue-50":""}`,onClick:()=>T(fe),children:[a.jsx("td",{className:"px-4 py-3 text-center w-10",onClick:Ue=>Ue.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:w.has(fe.id),onChange:()=>Me(fe.id),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),a.jsx("td",{className:"px-4 py-3 text-sm text-center text-toss-gray-600 w-14",children:me+Oe+1}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-900 w-28 truncate",children:fe.location||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-900 font-medium w-20 truncate",children:fe.name||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-700 w-24 truncate",children:fe.request_date||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-700 truncate",children:fe.status||"-"}),a.jsx("td",{className:"px-4 py-3 text-center w-20",onClick:Ue=>Ue.stopPropagation(),children:a.jsx("button",{onClick:()=>k(fe),className:`px-3 py-1 text-xs font-medium rounded-full transition-colors whitespace-nowrap ${fe.is_completed?"bg-green-100 text-green-600 hover:bg-green-200":"bg-orange-100 text-orange-600 hover:bg-orange-200"}`,children:fe.is_completed?"":""})}),a.jsx("td",{className:"px-4 py-3 text-center w-24",onClick:Ue=>Ue.stopPropagation(),children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("button",{onClick:()=>de(fe),className:"p-2 text-blue-500 hover:bg-blue-100 rounded-lg transition-colors",title:"",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>G(fe),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:a.jsx(Xt,{size:16})})]})})]},fe.id))})]})}),a.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:_e.map((fe,Oe)=>a.jsxs("div",{className:`p-4 ${fe.is_completed?"bg-toss-gray-50":"bg-orange-50/50"} ${w.has(fe.id)?"!bg-blue-50":""}`,onClick:()=>T(fe),children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:w.has(fe.id),onChange:()=>Me(fe.id),onClick:Ue=>Ue.stopPropagation(),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),a.jsxs("span",{className:"text-xs text-toss-gray-500",children:["#",me+Oe+1]}),a.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:fe.name||"-"})]}),a.jsxs("div",{className:"flex items-center gap-1",onClick:Ue=>Ue.stopPropagation(),children:[a.jsx("button",{onClick:()=>k(fe),className:`px-2 py-0.5 text-xs font-medium rounded-full transition-colors whitespace-nowrap ${fe.is_completed?"bg-green-100 text-green-600 hover:bg-green-200":"bg-orange-100 text-orange-600 hover:bg-orange-200"}`,children:fe.is_completed?"":""}),a.jsx("button",{onClick:()=>de(fe),className:"p-1.5 text-blue-500 hover:bg-blue-100 rounded-lg",children:a.jsx(js,{size:14})}),a.jsx("button",{onClick:()=>G(fe),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:a.jsx(Xt,{size:14})})]})]}),a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("p",{className:"text-toss-gray-700",children:[a.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),fe.location||"-"]}),a.jsxs("p",{className:"text-toss-gray-700",children:[a.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),fe.request_date||"-"]}),a.jsxs("p",{className:"text-toss-gray-700 line-clamp-1",children:[a.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),fe.status||"-"]})]})]},fe.id))}),le>1&&a.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-toss-gray-200",children:[a.jsx("button",{onClick:()=>Ae(v-1),disabled:v===1,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),[...Array(le)].map((fe,Oe)=>a.jsx("button",{onClick:()=>Ae(Oe+1),className:`px-3 py-1 rounded-lg text-sm font-medium ${v===Oe+1?"bg-toss-blue text-white":"text-toss-gray-700 hover:bg-toss-gray-100"}`,children:Oe+1},Oe+1)),a.jsx("button",{onClick:()=>Ae(v+1),disabled:v===le,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]}):a.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:"  "})}),a.jsx(cr,{isOpen:n,onClose:()=>{o(!1),U()},title:d?" ":"  ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),a.jsx("input",{type:"text",value:J.location,onChange:fe=>V({...J,location:fe.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:" "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),a.jsx("input",{type:"text",value:J.name,onChange:fe=>V({...J,name:fe.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:" "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("input",{type:"text",value:J.request_date,onChange:fe=>V({...J,request_date:fe.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:": 25.01.13"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  ()"}),a.jsx("input",{type:"text",value:J.status,onChange:fe=>V({...J,status:fe.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"   "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("textarea",{value:J.details,onChange:fe=>V({...J,details:fe.target.value}),rows:8,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"is_completed",checked:J.is_completed||!1,onChange:fe=>V({...J,is_completed:fe.target.checked}),className:"w-5 h-5 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),a.jsx("label",{htmlFor:"is_completed",className:"text-sm font-medium text-toss-gray-700 cursor-pointer",children:" "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  (1)"}),a.jsx("input",{type:"file",ref:C,accept:"image/*",onChange:ce,className:"hidden"}),J.photo_file||J.photo_url?a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:J.photo_file?URL.createObjectURL(J.photo_file):J.photo_url,alt:" ",className:"w-full max-h-48 object-contain rounded-xl bg-toss-gray-50"}),a.jsx("button",{type:"button",onClick:ne,className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",children:a.jsx(mr,{size:16})})]}):a.jsxs("button",{type:"button",onClick:()=>C.current?.click(),className:"w-full py-8 border-2 border-dashed border-toss-gray-300 rounded-xl text-toss-gray-500 hover:border-toss-blue hover:text-toss-blue transition-colors flex flex-col items-center justify-center gap-2",children:[a.jsx(R7,{size:24}),a.jsx("span",{className:"text-sm",children:"  "})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{o(!1),U()},className:"flex-1",disabled:N,children:""}),a.jsx(Ye,{onClick:d?W:ie,className:"flex-1",disabled:N,children:N?" ...":d?"":""})]})]})}),a.jsx(cr,{isOpen:l,onClose:()=>{u(!1),x(null)},title:" ",children:m&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1 space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-toss-gray-900",children:m.location||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-toss-gray-900 font-medium",children:m.name||"-"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),a.jsx("p",{className:"text-toss-gray-900",children:m.request_date||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),a.jsx("p",{className:`font-medium ${m.is_completed?"text-green-600":"text-orange-500"}`,children:m.is_completed?"":""})]})]})]}),m.photo_url&&a.jsx("div",{className:"w-32 h-32 flex-shrink-0",children:a.jsx("img",{src:m.photo_url,alt:" ",className:"w-full h-full object-cover rounded-xl cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(m.photo_url,"_blank")})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:"  ()"}),a.jsx("p",{className:"text-toss-gray-900",children:m.status||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),a.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[150px] whitespace-pre-wrap text-toss-gray-900",children:m.details||"  ."})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{u(!1),x(null)},className:"flex-1",children:""}),a.jsx(Ye,{onClick:()=>{u(!1),de(m)},className:"flex-1",children:""})]})]})}),a.jsx(cr,{isOpen:A,onClose:()=>Y(!1),title:"  ",children:a.jsxs("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-toss-gray-700 mb-3",children:" "}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:" "}),a.jsx("input",{type:"number",value:Z.this_week,onChange:fe=>M({...Z,this_week:parseInt(fe.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:" "}),a.jsx("input",{type:"number",value:Z.this_month,onChange:fe=>M({...Z,this_month:parseInt(fe.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:"2026"}),a.jsx("input",{type:"number",value:Z.this_year,onChange:fe=>M({...Z,this_year:parseInt(fe.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:" "}),a.jsx("input",{type:"number",value:Z.total,onChange:fe=>M({...Z,total:parseInt(fe.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-blue-700 mb-3",children:" "}),a.jsxs("div",{className:"relative mb-3",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("div",{className:"relative flex-1",children:[a.jsx(qa,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),a.jsx("input",{type:"text",value:$e.in_progress,onChange:fe=>tt(Oe=>({...Oe,in_progress:fe.target.value})),onKeyDown:fe=>rt(fe,"in_progress"),onFocus:()=>ft(fe=>({...fe,in_progress:!0})),onBlur:()=>setTimeout(()=>ft(fe=>({...fe,in_progress:!1})),200),className:"w-full pl-9 pr-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-blue-300",placeholder:" "})]})}),De.in_progress&&$e.in_progress&&a.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-40 overflow-y-auto",children:[jt($e.in_progress).slice(0,8).map(fe=>a.jsxs("button",{onClick:()=>vt("in_progress",fe),className:"w-full px-3 py-2 text-left hover:bg-blue-50 flex items-center gap-2 text-sm",children:[a.jsx("span",{children:io[fe.code]}),a.jsx("span",{children:fe.name})]},fe.code)),jt($e.in_progress).length===0&&a.jsx("div",{className:"px-3 py-2 text-sm text-toss-gray-400",children:"  "})]})]}),a.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[Z.in_progress.map((fe,Oe)=>a.jsxs("div",{className:"flex items-center gap-1 bg-blue-50 rounded-lg px-2 py-1.5",children:[a.jsxs("div",{className:"flex flex-col gap-0.5",children:[a.jsx("button",{onClick:()=>Le("in_progress",Oe,"up"),disabled:Oe===0,className:"p-0.5 text-toss-gray-400 hover:text-toss-gray-700 disabled:opacity-30",children:a.jsx(i4,{size:10})}),a.jsx("button",{onClick:()=>Le("in_progress",Oe,"down"),disabled:Oe===Z.in_progress.length-1,className:"p-0.5 text-toss-gray-400 hover:text-toss-gray-700 disabled:opacity-30",children:a.jsx(n4,{size:10})})]}),a.jsx("span",{className:"text-base",children:io[fe.country_code]}),a.jsx("span",{className:"flex-1 text-xs font-medium truncate",children:fe.country_name}),a.jsx("input",{type:"number",value:fe.rescue_count,onChange:Ue=>Rt("in_progress",Oe,"rescue_count",Ue.target.value),className:"w-12 px-1 py-0.5 border rounded text-xs text-center",placeholder:"0"}),a.jsx("button",{onClick:()=>At("in_progress",Oe),className:"p-0.5 text-red-500 hover:bg-red-100 rounded",children:a.jsx(Xt,{size:12})})]},Oe)),Z.in_progress.length===0&&a.jsx("p",{className:"text-xs text-toss-gray-400 text-center py-3 bg-toss-gray-50 rounded-lg",children:"  "})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-orange-700 mb-3",children:" "}),a.jsxs("div",{className:"relative mb-3",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("div",{className:"relative flex-1",children:[a.jsx(qa,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),a.jsx("input",{type:"text",value:$e.completed,onChange:fe=>tt(Oe=>({...Oe,completed:fe.target.value})),onKeyDown:fe=>rt(fe,"completed"),onFocus:()=>ft(fe=>({...fe,completed:!0})),onBlur:()=>setTimeout(()=>ft(fe=>({...fe,completed:!1})),200),className:"w-full pl-9 pr-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-orange-300",placeholder:" "})]})}),De.completed&&$e.completed&&a.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-40 overflow-y-auto",children:[jt($e.completed).slice(0,8).map(fe=>a.jsxs("button",{onClick:()=>vt("completed",fe),className:"w-full px-3 py-2 text-left hover:bg-orange-50 flex items-center gap-2 text-sm",children:[a.jsx("span",{children:io[fe.code]}),a.jsx("span",{children:fe.name})]},fe.code)),jt($e.completed).length===0&&a.jsx("div",{className:"px-3 py-2 text-sm text-toss-gray-400",children:"  "})]})]}),a.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[Z.completed.map((fe,Oe)=>a.jsxs("div",{className:"flex items-center gap-1 bg-orange-50 rounded-lg px-2 py-1.5",children:[a.jsxs("div",{className:"flex flex-col gap-0.5",children:[a.jsx("button",{onClick:()=>Le("completed",Oe,"up"),disabled:Oe===0,className:"p-0.5 text-toss-gray-400 hover:text-toss-gray-700 disabled:opacity-30",children:a.jsx(i4,{size:10})}),a.jsx("button",{onClick:()=>Le("completed",Oe,"down"),disabled:Oe===Z.completed.length-1,className:"p-0.5 text-toss-gray-400 hover:text-toss-gray-700 disabled:opacity-30",children:a.jsx(n4,{size:10})})]}),a.jsx("span",{className:"text-base",children:io[fe.country_code]}),a.jsx("span",{className:"flex-1 text-xs font-medium truncate",children:fe.country_name}),a.jsx("input",{type:"number",value:fe.rescue_count,onChange:Ue=>Rt("completed",Oe,"rescue_count",Ue.target.value),className:"w-12 px-1 py-0.5 border rounded text-xs text-center",placeholder:"0"}),a.jsx("button",{onClick:()=>At("completed",Oe),className:"p-0.5 text-red-500 hover:bg-red-100 rounded",children:a.jsx(Xt,{size:12})})]},Oe)),Z.completed.length===0&&a.jsx("p",{className:"text-xs text-toss-gray-400 text-center py-3 bg-toss-gray-50 rounded-lg",children:"  "})]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4 sticky bottom-0 bg-white",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>Y(!1),className:"flex-1",children:""}),a.jsx(Ye,{onClick:ct,className:"flex-1",disabled:N,children:N?" ...":""})]})]})}),a.jsx(cr,{isOpen:I,onClose:()=>ae(!1),title:"  ",children:a.jsxs("div",{className:"space-y-4",children:[H?a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-2",children:" "}),a.jsx("img",{src:H.image_url,alt:" ",className:"w-full max-h-64 object-contain rounded-xl border bg-toss-gray-50"})]}):a.jsx("div",{className:"text-center text-toss-gray-500 py-8 bg-toss-gray-50 rounded-xl",children:"  ."}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  "}),a.jsx("input",{type:"file",accept:"image/*",onChange:oe,ref:ve,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),a.jsx("div",{className:"flex gap-3",children:a.jsx(Ye,{variant:"secondary",onClick:()=>ae(!1),className:"flex-1",children:""})})]})}),a.jsx(qU,{isOpen:te,onClose:()=>ke(!1),summaryStats:B,countryStats:F})]})},DS=e=>e?e.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0","").replace("?dl=1","").replace("&dl=1",""):"",OS=e=>{const t=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],r=e.toLowerCase();return t.some(s=>r.includes(s))},WU=({files:e})=>{const t=K.useRef(null),[r,s]=K.useState(!1),[n,o]=K.useState(!1),[l,u]=K.useState(null),d=e.filter(y=>OS(y.url)).map(y=>({...y,url:DS(y.url)})),h=e.filter(y=>!OS(y.url)).map(y=>({...y,url:DS(y.url)})),m=()=>{if(t.current){const{scrollLeft:y,scrollWidth:b,clientWidth:v}=t.current;s(y>0),o(y<b-v-10)}};K.useEffect(()=>(m(),window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)),[e]);const x=y=>{t.current&&(t.current.scrollBy({left:y==="left"?-200:200,behavior:"smooth"}),setTimeout(m,300))};return d.length===0&&h.length===0?null:a.jsxs("div",{className:"space-y-3",children:[d.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:[" (",d.length,")"]}),a.jsxs("div",{className:"relative",children:[r&&a.jsx("button",{onClick:()=>x("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:a.jsx(xa,{size:20})}),a.jsx("div",{ref:t,onScroll:m,className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:d.map((y,b)=>a.jsx("div",{className:"flex-shrink-0 cursor-pointer w-24 h-24 sm:w-32 sm:h-32 rounded-xl overflow-hidden bg-toss-gray-100",onClick:()=>u(y.url),children:a.jsx("img",{src:y.url,alt:y.name||`  ${b+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:v=>{v.target.style.display="none"}})},b))}),n&&a.jsx("button",{onClick:()=>x("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:a.jsx(Js,{size:20})})]})]}),h.length>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:["  (",h.length,")"]}),a.jsx("div",{className:"space-y-2",children:h.map((y,b)=>a.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors",children:[a.jsx(Ea,{size:16,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-sm text-toss-blue hover:underline flex-1 truncate",children:y.name||""}),a.jsx(Jr,{size:16,className:"text-toss-gray-500"})]},b))})]}),l&&a.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4",style:{zIndex:9999},onClick:()=>u(null),children:[a.jsx("button",{className:"absolute top-4 right-4 text-white hover:text-gray-300",style:{zIndex:1e4},onClick:()=>u(null),children:a.jsx(mr,{size:32})}),a.jsx("img",{src:l,alt:" ",className:"max-h-[85vh] max-w-[95vw] object-contain rounded-lg",onClick:y=>y.stopPropagation()})]})]})},GU=()=>{const{profile:e}=qr(),[t,r]=K.useState(new Date),[s,n]=K.useState(null),[o,l]=K.useState(null),[u,d]=K.useState(!1),[h,m]=K.useState(!1),[x,y]=K.useState([]),[b,v]=K.useState([]),[g,_]=K.useState(!1),[w,S]=K.useState({title:"",content:"",participants:"",files:[],existingFileUrls:[]}),[N,E]=K.useState(!1),C=K.useRef(null);K.useEffect(()=>{F(),O()},[t]);const F=async()=>{try{const V=t.getFullYear(),X=t.getMonth(),se=new Date(V,X,1).toISOString().split("T")[0],P=new Date(V,X+1,0).toISOString().split("T")[0],{data:U}=await Pe.from("meetings").select("*").gte("meeting_date",se).lte("meeting_date",P).order("meeting_date",{ascending:!0});y(U||[])}catch(V){console.error("Error fetching meetings:",V)}},O=async()=>{try{const{data:V}=await Pe.from("meetings").select("*").order("meeting_date",{ascending:!1}).limit(10);v(V||[])}catch(V){console.error("Error fetching recent meetings:",V)}},B=V=>{n(V);const X=x.find(se=>se.meeting_date===V);X?(l(X),m(!0)):(S({title:"",content:"",participants:"",files:[],existingFileUrls:[]}),d(!0))},L=V=>{const se=Array.from(V.target.files).map(P=>({file:P,name:P.name,size:(P.size/1024).toFixed(0)+"KB"}));S(P=>({...P,files:[...P.files,...se]}))},H=V=>{S(X=>({...X,files:X.files.filter((se,P)=>P!==V)}))},ue=V=>{S(X=>({...X,existingFileUrls:X.existingFileUrls.filter((se,P)=>P!==V)}))},A=V=>{l(V),m(!0)},Y=async()=>{if(!w.content.trim()){alert("  .");return}_(!0),E(!0);try{let V=[];if(w.files.length>0){const P=`/intranet/meetings/${s}`;V=(await af(w.files.map(ce=>ce.file),P)).map(ce=>({url:ce.url,name:ce.name,size:ce.size}))}const X=[...w.existingFileUrls,...V],se=x.find(P=>P.meeting_date===s);if(se){const{error:P}=await Pe.from("meetings").update({title:w.title,content:w.content,participants:w.participants,file_urls:X,updated_at:new Date().toISOString()}).eq("id",se.id);if(P)throw P}else{const{error:P}=await Pe.from("meetings").insert([{meeting_date:s,title:w.title,content:w.content,participants:w.participants,file_urls:X}]).select();if(P)throw P}await F(),await O(),d(!1)}catch(V){console.error("Error saving meeting:",V),alert("   : "+(V.message||JSON.stringify(V)))}finally{_(!1),E(!1)}},I=async()=>{if(confirm("  ?")){_(!0);try{const V=x.find(X=>X.meeting_date===s);V&&(V.file_urls&&V.file_urls.length>0&&await om(V.file_urls),await Pe.from("meetings").delete().eq("id",V.id),await F(),await O()),d(!1)}catch(V){console.error("Error deleting meeting:",V),alert("   .")}finally{_(!1)}}},ae=V=>{const X=V.getFullYear(),se=V.getMonth(),P=new Date(X,se,1),ce=new Date(X,se+1,0).getDate(),ne=P.getDay(),ie=[];for(let G=0;G<ne;G++){const k=new Date(X,se,-ne+G+1);ie.push({date:k,isCurrentMonth:!1})}for(let G=1;G<=ce;G++)ie.push({date:new Date(X,se,G),isCurrentMonth:!0});const W=42-ie.length;for(let G=1;G<=W;G++)ie.push({date:new Date(X,se+1,G),isCurrentMonth:!1});return ie},Q=V=>V.toISOString().split("T")[0],re=V=>{const X=new Date(V);return`${X.getFullYear()}. ${X.getMonth()+1}. ${X.getDate()}.`},ve=V=>{const X=Q(V);return x.some(se=>se.meeting_date===X)},te=V=>{const X=new Date;return V.toDateString()===X.toDateString()},ke=()=>{r(new Date(t.getFullYear(),t.getMonth()-1,1))},Z=()=>{r(new Date(t.getFullYear(),t.getMonth()+1,1))},M=ae(t),J=["","","","","","",""];return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(Gs,{size:24})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-1",children:""}),a.jsx("p",{className:"text-white/90",children:"    "})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs(_t,{className:"lg:col-span-2",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("button",{onClick:ke,className:"p-1.5 hover:bg-toss-gray-100 rounded-lg transition-colors",children:a.jsx(xa,{size:20,className:"text-toss-gray-600"})}),a.jsxs("h3",{className:"text-lg font-bold text-toss-gray-900",children:[t.getFullYear()," ",t.getMonth()+1,""]}),a.jsx("button",{onClick:Z,className:"p-1.5 hover:bg-toss-gray-100 rounded-lg transition-colors",children:a.jsx(Js,{size:20,className:"text-toss-gray-600"})})]}),a.jsx("div",{className:"grid grid-cols-7 mb-1",children:J.map((V,X)=>a.jsx("div",{className:`text-center py-1 text-xs font-semibold ${X===0?"text-red-500":X===6?"text-blue-500":"text-toss-gray-600"}`,children:V},V))}),a.jsx("div",{className:"grid grid-cols-7",children:M.map((V,X)=>{const se=Q(V.date),P=ve(V.date),U=te(V.date),ce=V.date.getDay();return a.jsxs("button",{onClick:()=>V.isCurrentMonth&&B(se),disabled:!V.isCurrentMonth,className:`
                                        py-2 rounded transition-all relative
                                        ${V.isCurrentMonth?"hover:bg-toss-gray-100 cursor-pointer":"opacity-30 cursor-default"}
                                        ${U?"bg-toss-blue/10 ring-1 ring-toss-blue":""}
                                    `,children:[a.jsx("span",{className:`
                                        text-sm font-medium
                                        ${V.isCurrentMonth?"":"text-toss-gray-300"}
                                        ${ce===0?"text-red-500":ce===6?"text-blue-500":"text-toss-gray-900"}
                                        ${P&&V.isCurrentMonth?"text-red-600 font-bold":""}
                                    `,children:V.date.getDate()}),P&&V.isCurrentMonth&&a.jsx("div",{className:"absolute bottom-0.5 left-1/2 transform -translate-x-1/2",children:a.jsx("div",{className:"w-1 h-1 bg-red-500 rounded-full"})})]},X)})}),a.jsxs("div",{className:"mt-3 pt-3 border-t border-toss-gray-100 flex items-center gap-4 text-xs text-toss-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),a.jsx("span",{children:" "})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-2 h-2 bg-toss-blue/30 rounded-full ring-1 ring-toss-blue"}),a.jsx("span",{children:""})]})]})]}),a.jsxs(_t,{className:"lg:col-span-1",children:[a.jsx("h3",{className:"text-base font-bold text-toss-gray-900 mb-4",children:" "}),b.length>0?a.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:b.map(V=>a.jsxs("button",{onClick:()=>A(V),className:"block w-full text-left p-3 rounded-lg hover:bg-toss-gray-50 transition-colors border border-toss-gray-100",children:[a.jsx("p",{className:"font-medium text-toss-gray-900 text-sm truncate",children:V.title||" "}),a.jsx("p",{className:"text-xs text-toss-gray-400 mt-1",children:re(V.meeting_date)})]},V.id))}):a.jsx("p",{className:"text-center text-toss-gray-500 py-8 text-sm",children:"  "})]})]}),a.jsx(cr,{isOpen:u,onClose:()=>d(!1),title:` - ${s}`,children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("input",{type:"text",value:w.title,onChange:V=>S({...w,title:V.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"  "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("input",{type:"text",value:w.participants,onChange:V=>S({...w,participants:V.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"  (: , )"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  *"}),a.jsx("textarea",{value:w.content,onChange:V=>S({...w,content:V.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all min-h-[200px] resize-none leading-relaxed",placeholder:"  "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("input",{type:"file",ref:C,onChange:L,multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx",className:"hidden"}),a.jsxs("button",{type:"button",onClick:()=>C.current?.click(),className:"w-full px-4 py-3 bg-toss-gray-50 border border-dashed border-toss-gray-300 rounded-xl hover:bg-toss-gray-100 transition-colors flex items-center justify-center gap-2 text-toss-gray-600",children:[a.jsx(Gn,{size:18}),a.jsx("span",{children:"  (, )"})]}),w.existingFileUrls.length>0&&a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsx("p",{className:"text-xs text-toss-gray-500",children:" "}),w.existingFileUrls.map((V,X)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-toss-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ea,{size:16,className:"text-toss-gray-400"}),a.jsx("span",{className:"text-sm text-toss-gray-700 truncate max-w-[200px]",children:V.name||""})]}),a.jsx("button",{type:"button",onClick:()=>ue(X),className:"p-1 hover:bg-toss-gray-200 rounded",children:a.jsx(mr,{size:14,className:"text-toss-gray-500"})})]},X))]}),w.files.length>0&&a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsx("p",{className:"text-xs text-toss-gray-500",children:" "}),w.files.map((V,X)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-blue-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ea,{size:16,className:"text-blue-400"}),a.jsx("span",{className:"text-sm text-toss-gray-700 truncate max-w-[180px]",children:V.name}),a.jsx("span",{className:"text-xs text-toss-gray-400",children:V.size})]}),a.jsx("button",{type:"button",onClick:()=>H(X),className:"p-1 hover:bg-blue-100 rounded",children:a.jsx(mr,{size:14,className:"text-toss-gray-500"})})]},X))]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[x.find(V=>V.meeting_date===s)&&a.jsx(Ye,{variant:"secondary",onClick:I,disabled:g,className:"text-red-500 hover:bg-red-50",children:""}),a.jsx(Ye,{variant:"secondary",onClick:()=>d(!1),className:"flex-1",children:""}),a.jsx(Ye,{onClick:Y,disabled:g||N,className:"flex-1",children:N?" ...":g?" ...":""})]})]})}),a.jsx(cr,{isOpen:h,onClose:()=>{m(!1),l(null)},title:" ",children:o&&a.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto -mx-2 px-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),a.jsx("p",{className:"text-toss-gray-900",children:re(o.meeting_date)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-toss-gray-900",children:o.participants||"-"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),a.jsx("p",{className:"text-toss-gray-900 font-medium",children:o.title||" "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),a.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[150px] whitespace-pre-wrap text-toss-gray-900",children:o.content||"-"})]}),o.file_urls&&o.file_urls.length>0&&a.jsx(WU,{files:o.file_urls}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{m(!1),l(null)},className:"flex-1",children:""}),a.jsx(Ye,{onClick:()=>{m(!1),n(o.meeting_date),S({title:o.title||"",content:o.content||"",participants:o.participants||"",files:[],existingFileUrls:o.file_urls||[]}),d(!0),l(null)},className:"flex-1",children:""})]})]})})]})},Jh=[{key:"blue",bg:"bg-blue-100",text:"text-blue-700",dot:"bg-blue-500"},{key:"purple",bg:"bg-purple-100",text:"text-purple-700",dot:"bg-purple-500"},{key:"green",bg:"bg-green-100",text:"text-green-700",dot:"bg-green-500"},{key:"amber",bg:"bg-amber-100",text:"text-amber-700",dot:"bg-amber-500"},{key:"red",bg:"bg-red-100",text:"text-red-700",dot:"bg-red-500"},{key:"orange",bg:"bg-orange-100",text:"text-orange-700",dot:"bg-orange-500"},{key:"gray",bg:"bg-gray-100",text:"text-gray-700",dot:"bg-gray-500"},{key:"pink",bg:"bg-pink-100",text:"text-pink-700",dot:"bg-pink-500"},{key:"teal",bg:"bg-teal-100",text:"text-teal-700",dot:"bg-teal-500"},{key:"indigo",bg:"bg-indigo-100",text:"text-indigo-700",dot:"bg-indigo-500"}],VU={general:{bg:"bg-blue-100",text:"text-blue-700",dot:"bg-blue-500",label:""},meeting:{bg:"bg-purple-100",text:"text-purple-700",dot:"bg-purple-500",label:""},training:{bg:"bg-green-100",text:"text-green-700",dot:"bg-green-500",label:""},rescue:{bg:"bg-amber-100",text:"text-amber-700",dot:"bg-amber-500",label:""},holiday:{bg:"bg-red-100",text:"text-red-700",dot:"bg-red-500",label:""},event:{bg:"bg-orange-100",text:"text-orange-700",dot:"bg-orange-500",label:""},leave:{bg:"bg-pink-100",text:"text-pink-700",dot:"bg-pink-500",label:""},other:{bg:"bg-gray-100",text:"text-gray-700",dot:"bg-gray-500",label:""}},KU=()=>{const{user:e,isAdmin:t}=qr(),[r,s]=K.useState(new Date),[n,o]=K.useState(null),[l,u]=K.useState(null),[d,h]=K.useState(!1),[m,x]=K.useState(!1),[y,b]=K.useState(!1),[v,g]=K.useState([]),[_,w]=K.useState([]),[S,N]=K.useState({}),[E,C]=K.useState(!1),[F,O]=K.useState({title:"",location:"",description:"",event_type:"general",start_time:"",end_time:""}),[B,L]=K.useState(VU),[H,ue]=K.useState(!1),[A,Y]=K.useState({key:"",label:"",color:"blue"}),[I,ae]=K.useState(null),[Q,re]=K.useState({isOpen:!1,message:"",type:"info"}),ve=(le,Ae="info")=>{re({isOpen:!0,message:le,type:Ae})},te=async()=>{try{const{data:le}=await Pe.from("event_types").select("*").order("created_at");if(le&&le.length>0){const Ae={};le.forEach(Me=>{const Ee=Jh.find(Ce=>Ce.key===Me.color)||Jh[0];Ae[Me.key]={bg:Ee.bg,text:Ee.text,dot:Ee.dot,label:Me.label}}),L(Ae)}}catch(le){console.error("Error fetching event types:",le)}},ke=async()=>{if(!A.key.trim()||!A.label.trim()){ve("   .","error");return}try{I?await Pe.from("event_types").update({label:A.label,color:A.color,updated_at:new Date().toISOString()}).eq("key",I):await Pe.from("event_types").insert({key:A.key.toLowerCase().replace(/\s/g,"_"),label:A.label,color:A.color}),await te(),ue(!1),Y({key:"",label:"",color:"blue"}),ae(null),ve(I?"  .":"  .","success")}catch(le){console.error("Error saving event type:",le),ve(" .","error")}},Z=async le=>{if(confirm("   ?"))try{await Pe.from("event_types").delete().eq("key",le),await te(),ve("  .","success")}catch(Ae){console.error("Error deleting event type:",Ae),ve(" .","error")}},M=le=>{const Ae=B[le],Me=Jh.find(Ee=>Ee.bg===Ae.bg)?.key||"blue";Y({key:le,label:Ae.label,color:Me}),ae(le),ue(!0)};K.useEffect(()=>{(async()=>{try{const Me=await(await fetch("https://holidays.hyunbin.page/basic.json")).json();N(Me)}catch(Ae){console.error("Error fetching holidays:",Ae)}})()},[]),K.useEffect(()=>{te(),J(),V()},[r]);const J=async()=>{try{const le=r.getFullYear(),Ae=r.getMonth(),Me=new Date(le,Ae,1).toISOString().split("T")[0],Ee=new Date(le,Ae+1,0).toISOString().split("T")[0],{data:Ce}=await Pe.from("events").select("*").gte("event_date",Me).lte("event_date",Ee).neq("event_type","leave").order("event_date",{ascending:!0});g(Ce||[])}catch(le){console.error("Error fetching events:",le)}},V=async()=>{try{const le=new Date().toISOString().split("T")[0],{data:Ae}=await Pe.from("events").select("*").gte("event_date",le).neq("event_type","leave").order("event_date",{ascending:!0}).limit(10);w(Ae||[])}catch(le){console.error("Error fetching recent events:",le)}},X=le=>{o(le);const Ae=v.filter(Me=>Me.event_date===le);Ae.length>0?(u(Ae[0]),x(!0)):(U(),b(!1),h(!0))},se=()=>{n||o(new Date().toISOString().split("T")[0]),U(),b(!1),h(!0)},P=()=>{l&&(O({title:l.title||"",location:l.location||"",description:l.description||"",event_type:l.event_type||"general",start_time:l.start_time||"",end_time:l.end_time||""}),o(l.event_date),b(!0),x(!1),h(!0))},U=()=>{O({title:"",location:"",description:"",event_type:"general",start_time:"",end_time:""})},ce=async()=>{if(!F.title.trim()){alert(" .");return}C(!0);try{if(y&&l){const{error:le}=await Pe.from("events").update({title:F.title,location:F.location||null,description:F.description||null,event_type:F.event_type,start_time:F.start_time||null,end_time:F.end_time||null,updated_at:new Date().toISOString()}).eq("id",l.id);if(le)throw le}else{const{error:le}=await Pe.from("events").insert([{event_date:n,title:F.title,location:F.location||null,description:F.description||null,event_type:F.event_type,start_time:F.start_time||null,end_time:F.end_time||null,created_by:e?.user_id}]);if(le)throw le}await J(),await V(),h(!1),u(null)}catch(le){console.error("Error saving event:",le),alert("   : "+(le.message||JSON.stringify(le)))}finally{C(!1)}},ne=async()=>{if(confirm("  ?")){C(!0);try{l&&(await Pe.from("events").delete().eq("id",l.id),await J(),await V()),x(!1),u(null)}catch(le){console.error("Error deleting event:",le),alert("   .")}finally{C(!1)}}},ie=le=>{const Ae=le.getFullYear(),Me=le.getMonth(),Ee=new Date(Ae,Me,1),Je=new Date(Ae,Me+1,0).getDate(),$e=Ee.getDay(),tt=[];for(let ft=0;ft<$e;ft++){const jt=new Date(Ae,Me,-$e+ft+1);tt.push({date:jt,isCurrentMonth:!1})}for(let ft=1;ft<=Je;ft++)tt.push({date:new Date(Ae,Me,ft),isCurrentMonth:!0});const De=42-tt.length;for(let ft=1;ft<=De;ft++)tt.push({date:new Date(Ae,Me+1,ft),isCurrentMonth:!1});return tt},W=le=>{const Ae=le.getFullYear(),Me=String(le.getMonth()+1).padStart(2,"0"),Ee=String(le.getDate()).padStart(2,"0");return`${Ae}-${Me}-${Ee}`},G=le=>{const Ae=new Date(le);return`${Ae.getFullYear()}. ${Ae.getMonth()+1}. ${Ae.getDate()}.`},k=le=>{const Ae=W(le);return v.filter(Me=>Me.event_date===Ae)},de=le=>{const Ae=le.getFullYear().toString(),Me=W(le);return S[Ae]&&S[Ae][Me]?S[Ae][Me]:null},z=le=>{const Ae=new Date;return le.toDateString()===Ae.toDateString()},T=()=>{s(new Date(r.getFullYear(),r.getMonth()-1,1))},R=()=>{s(new Date(r.getFullYear(),r.getMonth()+1,1))},q=ie(r),me=["","","","","","",""],_e=(le,Ae)=>{Ae.stopPropagation(),u(le),o(le.event_date),x(!0)};return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-orange-500 to-amber-500 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(VE,{size:24})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-1",children:""}),a.jsx("p",{className:"text-white/90",children:"   "})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs(_t,{className:"lg:col-span-2",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("button",{onClick:T,className:"p-2 hover:bg-toss-gray-100 rounded-full transition-colors",children:a.jsx(xa,{size:20})}),a.jsxs("h3",{className:"text-lg font-bold",children:[r.getFullYear()," ",r.getMonth()+1,""]}),a.jsx("button",{onClick:R,className:"p-2 hover:bg-toss-gray-100 rounded-full transition-colors",children:a.jsx(Js,{size:20})})]}),a.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[me.map((le,Ae)=>a.jsx("div",{className:`text-center text-sm font-medium py-2 ${Ae===0?"text-red-500":Ae===6?"text-blue-500":"text-toss-gray-500"}`,children:le},le)),q.map((le,Ae)=>{const Me=W(le.date),Ee=k(le.date);Ee.length>0;const Ce=le.date.getDay(),Je=de(le.date),$e=Je!==null;return a.jsxs("div",{onClick:()=>le.isCurrentMonth&&X(Me),className:`
                                        min-h-[80px] p-1 border border-toss-gray-100 rounded-lg cursor-pointer
                                        transition-all hover:bg-toss-gray-50
                                        ${!le.isCurrentMonth&&"opacity-40"}
                                        ${z(le.date)&&"ring-2 ring-toss-blue ring-inset"}
                                        ${$e&&le.isCurrentMonth&&"bg-red-50"}
                                    `,children:[a.jsx("div",{className:`text-sm font-medium mb-1 ${$e||Ce===0?"text-red-500":Ce===6?"text-blue-500":""}`,children:le.date.getDate()}),$e&&a.jsx("div",{className:"text-xs px-1 py-0.5 rounded truncate bg-red-100 text-red-600 mb-0.5",children:Je.join(", ")}),a.jsxs("div",{className:"space-y-0.5",children:[Ee.slice(0,$e?1:2).map((tt,De)=>{const ft=B[tt.event_type]||B.general;return a.jsx("div",{onClick:jt=>_e(tt,jt),className:`text-xs px-1 py-0.5 rounded truncate ${ft.bg} ${ft.text}`,children:tt.title},De)}),Ee.length>($e?1:2)&&a.jsxs("div",{className:"text-xs text-toss-gray-500 pl-1",children:["+",Ee.length-($e?1:2)," "]})]})]},Ae)})]}),a.jsx("div",{className:"mt-4 pt-4 border-t border-toss-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex flex-wrap gap-3 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),a.jsx("span",{className:"text-toss-gray-600",children:""})]}),Object.entries(B).map(([le,Ae])=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${Ae.dot}`}),a.jsx("span",{className:"text-toss-gray-600",children:Ae.label})]},le))]}),t&&a.jsxs("button",{onClick:()=>{Y({key:"",label:"",color:"blue"}),ae(null),ue(!0)},className:"flex items-center gap-1 text-xs text-toss-gray-500 hover:text-toss-blue transition-colors",children:[a.jsx(_l,{size:14})," "]})]})})]}),a.jsxs(_t,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-bold",children:" "}),a.jsxs(Ye,{variant:"secondary",size:"sm",onClick:se,className:"flex items-center gap-1",children:[a.jsx(os,{size:16})," "]})]}),a.jsx("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:_.length===0?a.jsx("p",{className:"text-toss-gray-500 text-center py-8",children:"  ."}):_.map(le=>{const Ae=B[le.event_type]||B.general;return a.jsx("div",{onClick:()=>{u(le),o(le.event_date),x(!0)},className:"p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors cursor-pointer",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:`w-1 h-full min-h-[40px] rounded-full ${Ae.dot}`}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${Ae.bg} ${Ae.text}`,children:Ae.label}),a.jsx("span",{className:"text-xs text-toss-gray-500",children:G(le.event_date)})]}),a.jsx("h4",{className:"font-medium text-toss-gray-900 truncate",children:le.title}),le.location&&a.jsxs("p",{className:"text-sm text-toss-gray-500 flex items-center gap-1 mt-1",children:[a.jsx(Id,{size:12}),le.location]}),le.start_time&&a.jsxs("p",{className:"text-sm text-toss-gray-500 flex items-center gap-1 mt-1",children:[a.jsx(ra,{size:12}),le.start_time,le.end_time&&` ~ ${le.end_time}`]})]})]})},le.id)})})]})]}),a.jsx(cr,{isOpen:d,onClose:()=>h(!1),title:y?" ":"  ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("input",{type:"date",value:n||"",onChange:le=>o(le.target.value),className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),a.jsx("input",{type:"text",value:F.title,onChange:le=>O({...F,title:le.target.value}),placeholder:" ",className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("select",{value:F.event_type,onChange:le=>O({...F,event_type:le.target.value}),className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue",children:Object.entries(B).map(([le,Ae])=>a.jsx("option",{value:le,children:Ae.label},le))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("input",{type:"text",value:F.location,onChange:le=>O({...F,location:le.target.value}),placeholder:" ",className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("input",{type:"time",value:F.start_time,onChange:le=>O({...F,start_time:le.target.value}),className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("input",{type:"time",value:F.end_time,onChange:le=>O({...F,end_time:le.target.value}),className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("textarea",{value:F.description,onChange:le=>O({...F,description:le.target.value}),placeholder:"  ",rows:4,className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue resize-none"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>h(!1),children:""}),a.jsx(Ye,{className:"flex-1",onClick:ce,disabled:E,children:E?" ...":y?"":""})]})]})}),a.jsx(cr,{isOpen:m,onClose:()=>{x(!1),u(null)},title:" ",children:l&&a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{children:a.jsx("span",{className:`inline-block text-xs px-2 py-1 rounded ${B[l.event_type]?.bg||"bg-gray-100"} ${B[l.event_type]?.text||"text-gray-700"}`,children:B[l.event_type]?.label||""})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-toss-gray-900",children:G(l.event_date)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-lg font-bold text-toss-gray-900",children:l.title})]}),l.location&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),a.jsxs("p",{className:"text-toss-gray-900 flex items-center gap-2",children:[a.jsx(Id,{size:16,className:"text-toss-gray-400"}),l.location]})]}),(l.start_time||l.end_time)&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),a.jsxs("p",{className:"text-toss-gray-900 flex items-center gap-2",children:[a.jsx(ra,{size:16,className:"text-toss-gray-400"}),l.start_time,l.end_time&&` ~ ${l.end_time}`]})]}),l.description&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),a.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap bg-toss-gray-50 p-3 rounded-xl",children:l.description})]}),n&&v.filter(le=>le.event_date===n&&le.id!==l.id).length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:"   "}),a.jsx("div",{className:"space-y-2",children:v.filter(le=>le.event_date===n&&le.id!==l.id).map(le=>{const Ae=B[le.event_type]||B.general;return a.jsx("div",{onClick:()=>u(le),className:"p-2 bg-toss-gray-50 rounded-lg cursor-pointer hover:bg-toss-gray-100 transition-colors",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${Ae.dot}`}),a.jsx("span",{className:"text-sm font-medium",children:le.title})]})},le.id)})})]}),a.jsxs("div",{className:"flex gap-3 pt-4 border-t border-toss-gray-100",children:[a.jsxs(Ye,{variant:"secondary",className:"flex-1 flex items-center justify-center gap-2",onClick:P,children:[a.jsx(Wc,{size:16}),""]}),a.jsxs(Ye,{variant:"secondary",className:"flex-1 flex items-center justify-center gap-2 text-red-500 hover:bg-red-50",onClick:ne,disabled:E,children:[a.jsx(Xt,{size:16}),""]})]})]})}),a.jsx(cr,{isOpen:H,onClose:()=>{ue(!1),ae(null),Y({key:"",label:"",color:"blue"})},title:"  ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:Object.entries(B).map(([le,Ae])=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-toss-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-3 h-3 rounded-full ${Ae.dot}`}),a.jsx("span",{className:"text-sm font-medium",children:Ae.label}),a.jsxs("span",{className:"text-xs text-toss-gray-500",children:["(",le,")"]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>M(le),className:"p-1 text-toss-gray-500 hover:text-toss-blue transition-colors",children:a.jsx(Wc,{size:14})}),a.jsx("button",{onClick:()=>Z(le),className:"p-1 text-toss-gray-500 hover:text-red-500 transition-colors",children:a.jsx(Xt,{size:14})})]})]},le))})]}),a.jsxs("div",{className:"border-t border-toss-gray-100 pt-4",children:[a.jsx("h4",{className:"text-sm font-medium text-toss-gray-700 mb-3",children:I?" ":"  "}),!I&&a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:"  ()"}),a.jsx("input",{type:"text",value:A.key,onChange:le=>Y({...A,key:le.target.value}),placeholder:": workshop",className:"w-full px-3 py-2 border border-toss-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue text-sm"})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:" "}),a.jsx("input",{type:"text",value:A.label,onChange:le=>Y({...A,label:le.target.value}),placeholder:": ",className:"w-full px-3 py-2 border border-toss-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue text-sm"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:""}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Jh.map(le=>a.jsx("button",{onClick:()=>Y({...A,color:le.key}),className:`w-8 h-8 rounded-full ${le.dot} ${A.color===le.key?"ring-2 ring-offset-2 ring-toss-blue":""}`},le.key))})]}),a.jsxs("div",{className:"flex gap-2",children:[I&&a.jsx(Ye,{variant:"secondary",size:"sm",onClick:()=>{ae(null),Y({key:"",label:"",color:"blue"})},className:"flex-1",children:""}),a.jsx(Ye,{size:"sm",onClick:ke,className:"flex-1",children:I?"":""})]})]})]})}),Q.isOpen&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:1e4},onClick:()=>re({...Q,isOpen:!1}),children:a.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl animate-in fade-in zoom-in duration-200",onClick:le=>le.stopPropagation(),children:a.jsxs("div",{className:"flex flex-col items-center text-center",children:[a.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center mb-4 ${Q.type==="success"?"bg-green-100":Q.type==="error"?"bg-red-100":"bg-blue-100"}`,children:Q.type==="success"?a.jsx(Ws,{className:"w-7 h-7 text-green-600"}):Q.type==="error"?a.jsx(Sn,{className:"w-7 h-7 text-red-600"}):a.jsx(Sn,{className:"w-7 h-7 text-blue-600"})}),a.jsx("p",{className:"text-toss-gray-900 font-medium mb-6 leading-relaxed",children:Q.message}),a.jsx("button",{onClick:()=>re({...Q,isOpen:!1}),className:`w-full py-3 rounded-xl font-medium transition-colors ${Q.type==="success"?"bg-green-500 hover:bg-green-600 text-white":Q.type==="error"?"bg-red-500 hover:bg-red-600 text-white":"bg-toss-blue hover:bg-blue-600 text-white"}`,children:""})]})})})]})},Wy={full:1,half_am:.5,half_pm:.5,out_1h:.125,out_2h:.25,out_3h:.375,comp:1},k0=15,yd=4,Iv=()=>{const{user:e,isAdmin:t,isSubAdmin:r}=qr(),s=t||r,[n,o]=K.useState(null),[l,u]=K.useState(null),[d,h]=K.useState([]),[m,x]=K.useState([]),[y,b]=K.useState(!0),v=new Date().getFullYear(),g=K.useCallback(async()=>{if(!e?.user_id)return;let{data:H,error:ue}=await Pe.from("annual_leaves").select("*").eq("user_id",e.user_id).eq("year",v).single();if(ue&&ue.code!=="PGRST116"&&console.error("Error fetching annual leave:",ue),!H){const{data:Q,error:re}=await Pe.from("annual_leaves").insert([{user_id:e.user_id,year:v,total_days:k0,used_days:0}]).select().single();re||(H=Q)}const A=`${v}-01-01`,Y=`${v}-12-31`,{data:I}=await Pe.from("document_labels").select("id").eq("code",yd).single();let ae=0;if(I){const{data:Q}=await Pe.from("documents").select("leave_days, leave_type").eq("drafter_id",e.user_id).eq("label_id",I.id).eq("attendance_type","leave").eq("status","approved").gte("leave_start_date",A).lte("leave_start_date",Y).not("leave_type","is",null).neq("leave_type","comp");ae=(Q||[]).reduce((re,ve)=>re+(ve.leave_days||0),0)}H&&o({...H,used_days:ae})},[e?.user_id,v]),_=K.useCallback(async()=>{if(!e?.user_id)return;const{data:H,error:ue}=await Pe.from("comp_leaves").select("*").eq("user_id",e.user_id).eq("year",v).single();ue&&ue.code!=="PGRST116"&&console.error("Error fetching comp leave:",ue),u(H||null)},[e?.user_id,v]),w=K.useCallback(async()=>{if(!e?.user_id)return;const{data:H,error:ue}=await Pe.from("leave_requests").select("*").eq("user_id",e.user_id).order("created_at",{ascending:!1});ue?console.error("Error fetching leave requests:",ue):h(H||[])},[e?.user_id]),S=K.useCallback(async()=>{if(!s)return;const{data:H,error:ue}=await Pe.from("leave_requests").select("*").eq("status","pending").order("created_at",{ascending:!0});ue?console.error("Error fetching pending requests:",ue):x(H||[])},[s]),N=async({startDate:H,endDate:ue,leaveType:A,reason:Y})=>{if(!e?.user_id)return{error:{message:" ."}};let I=0;if(A==="full"||A==="comp"){const re=new Date(H),ve=new Date(ue);I=Math.ceil((ve-re)/(1e3*60*60*24))+1}else I=Wy[A]||.5;if(A!=="comp"&&n){const re=n.total_days-n.used_days;if(I>re)return{error:{message:`  . (: ${re})`}}}const{data:ae,error:Q}=await Pe.from("leave_requests").insert([{user_id:e.user_id,start_date:H,end_date:ue,leave_type:A,days:I,reason:Y,status:"pending"}]).select().single();return Q?console.error("Submit leave request error:",Q):await w(),{data:ae,error:Q}},E=async H=>{const{error:ue}=await Pe.from("leave_requests").delete().eq("id",H).eq("user_id",e.user_id).eq("status","pending");return ue||await w(),{error:ue}},C=async(H,{startDate:ue,endDate:A,leaveType:Y,reason:I})=>{if(!e?.user_id)return{error:{message:" ."}};let ae=0;if(Y==="full"||Y==="comp"){const ve=new Date(ue),te=new Date(A);ae=Math.ceil((te-ve)/(1e3*60*60*24))+1}else ae=Wy[Y]||.5;if(Y!=="comp"&&n){const ve=n.total_days-n.used_days;if(ae>ve)return{error:{message:`  . (: ${ve})`}}}const{data:Q,error:re}=await Pe.from("leave_requests").update({start_date:ue,end_date:A,leave_type:Y,days:ae,reason:I,updated_at:new Date().toISOString()}).eq("id",H).eq("user_id",e.user_id).eq("status","pending").select().single();return re?console.error("Update leave request error:",re):await w(),{data:Q,error:re}},F=async H=>{if(!s)return{error:{message:" ."}};const{data:ue}=await Pe.from("leave_requests").select("*").eq("id",H).single();if(!ue)return{error:{message:"    ."}};const{error:A}=await Pe.from("leave_requests").update({status:"approved",approved_by:e.user_id,updated_at:new Date().toISOString()}).eq("id",H);if(A)return{error:A};if(ue.leave_type==="comp"){const Y=ue.days*8,{data:I}=await Pe.from("comp_leaves").select("*").eq("user_id",ue.user_id).eq("year",v).single();I&&await Pe.from("comp_leaves").update({used_hours:I.used_hours+Y,updated_at:new Date().toISOString()}).eq("id",I.id)}else{const{data:Y}=await Pe.from("annual_leaves").select("*").eq("user_id",ue.user_id).eq("year",v).single();Y&&await Pe.from("annual_leaves").update({used_days:Y.used_days+ue.days,updated_at:new Date().toISOString()}).eq("id",Y.id)}return await S(),{error:null}},O=async(H,ue)=>{if(!s)return{error:{message:" ."}};const{error:A}=await Pe.from("leave_requests").update({status:"rejected",rejected_reason:ue,approved_by:e.user_id,updated_at:new Date().toISOString()}).eq("id",H);return A||await S(),{error:A}},B=async()=>{if(!s)return{data:null,error:{message:" ."}};const{data:H,error:ue}=await Pe.from("annual_leaves").select("*").eq("year",v).order("user_id");return{data:H,error:ue}},L=async(H,ue)=>{if(!s)return{error:{message:" ."}};const{data:A,error:Y}=await Pe.from("annual_leaves").upsert({user_id:H,year:v,total_days:ue,updated_at:new Date().toISOString()},{onConflict:"user_id,year"}).select().single();return{data:A,error:Y}};return K.useEffect(()=>{const H=async()=>{b(!0),await Promise.all([g(),_(),w(),S()]),b(!1)};e?.user_id?H():b(!1)},[e?.user_id,g,_,w,S]),{annualLeave:n,compLeave:l,leaveRequests:d,pendingRequests:m,loading:y,canManage:s,submitLeaveRequest:N,cancelLeaveRequest:E,updateLeaveRequest:C,approveLeaveRequest:F,rejectLeaveRequest:O,fetchAllAnnualLeaves:B,updateUserAnnualLeave:L,refresh:()=>{g(),_(),w(),S()}}},XU=()=>{const{profile:e,updateProfile:t}=qr(),{annualLeave:r,compLeave:s,loading:n}=Iv(),[o,l]=K.useState(!1),[u,d]=K.useState(!1),[h,m]=K.useState({name:"",rank:"",team:""});K.useEffect(()=>{e&&m({name:e.name||"",rank:e.rank||"",team:e.team||""})},[e]);const x=async y=>{if(y.preventDefault(),!h.name.trim()){alert(" .");return}l(!0),d(!1);try{const{error:b}=await t(h);b?alert("  ."):(d(!0),setTimeout(()=>d(!1),3e3))}catch(b){console.error("Profile update error:",b),alert("    .")}finally{l(!1)}};return a.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[a.jsxs(Vs,{to:"/",className:"inline-flex items-center gap-2 text-toss-gray-500 hover:text-toss-gray-700 transition-colors",children:[a.jsx(sf,{size:20})," "]}),a.jsx(_t,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:a.jsxs("div",{className:"flex items-center gap-6",children:[a.jsx("div",{className:"w-20 h-20 bg-white/20 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-3xl font-bold",children:h.name?.charAt(0)||e?.name?.charAt(0)||"U"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-2xl font-bold mb-1",children:""}),a.jsxs("p",{className:"text-white/90 flex items-center gap-2",children:[a.jsx(Oy,{size:16}),e?.team?`${e.team}  ${e.rank||""}`:e?.user_id||" ..."]})]})]})}),a.jsxs(_t,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:a.jsx(ma,{className:"text-emerald-600",size:20})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-toss-gray-900",children:" "}),a.jsxs("p",{className:"text-sm text-toss-gray-500",children:[new Date().getFullYear(),""]})]})]}),a.jsxs(Vs,{to:"/document",className:"flex items-center gap-1 text-sm text-toss-blue hover:text-blue-700 transition-colors",children:[" ",a.jsx(Js,{size:16})]})]}),n?a.jsx("div",{className:"h-20 flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-toss-blue border-t-transparent"})}):r?a.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[a.jsxs("div",{className:"text-center p-4 bg-toss-gray-50 rounded-xl",children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:" "}),a.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[r.total_days,a.jsx("span",{className:"text-sm font-normal text-toss-gray-500",children:""})]})]}),a.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-xl",children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsxs("p",{className:"text-2xl font-bold text-toss-blue",children:[r.used_days,a.jsx("span",{className:"text-sm font-normal text-toss-gray-500",children:""})]})]}),a.jsxs("div",{className:"text-center p-4 bg-emerald-50 rounded-xl",children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:[r.total_days-r.used_days,a.jsx("span",{className:"text-sm font-normal text-toss-gray-500",children:""})]})]}),a.jsxs("div",{className:"text-center p-4 bg-amber-50 rounded-xl",children:[a.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:""}),a.jsxs("p",{className:"text-2xl font-bold text-amber-600",children:[s?Math.floor((s.total_hours-s.used_hours)/8):0,a.jsx("span",{className:"text-sm font-normal text-toss-gray-500",children:""})]})]})]}):a.jsx("div",{className:"text-center py-6 text-toss-gray-500",children:"    "}),r&&a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"flex justify-between text-xs text-toss-gray-500 mb-2",children:[a.jsx("span",{children:""}),a.jsxs("span",{children:[Math.round(r.used_days/r.total_days*100),"%"]})]}),a.jsx("div",{className:"h-2 bg-toss-gray-100 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-gradient-to-r from-toss-blue to-emerald-500 rounded-full transition-all duration-500",style:{width:`${r.used_days/r.total_days*100}%`}})})]})]}),a.jsxs(_t,{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:" "}),a.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:"       "})]}),a.jsxs("form",{onSubmit:x,className:"space-y-5",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-toss-gray-700 mb-2",children:[a.jsx(Si,{size:16})," *"]}),a.jsx("input",{type:"text",value:h.name,onChange:y=>m({...h,name:y.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl text-toss-gray-900 focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:" ",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-toss-gray-700 mb-2",children:[a.jsx(Gc,{size:16}),""]}),a.jsx("input",{type:"text",value:h.team,onChange:y=>m({...h,team:y.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl text-toss-gray-900 focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"  (: , )"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-toss-gray-700 mb-2",children:[a.jsx(GE,{size:16}),""]}),a.jsx("input",{type:"text",value:h.rank,onChange:y=>m({...h,rank:y.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl text-toss-gray-900 focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"  (: , , )"})]}),u&&a.jsxs("div",{className:"flex items-center gap-2 text-emerald-700 bg-emerald-50 p-4 rounded-xl border border-emerald-100",children:[a.jsx(R0,{size:20}),a.jsx("span",{className:"font-medium",children:"  "})]}),a.jsx(Ye,{type:"submit",className:"w-full",loading:o,disabled:o||!h.name.trim(),children:o?" ...":""})]})]}),a.jsx(_t,{className:"bg-toss-gray-50",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"font-bold text-toss-gray-900 mb-3",children:""}),a.jsx("p",{className:"text-sm text-toss-gray-600 leading-relaxed",children:"   "}),a.jsx("p",{className:"text-sm text-toss-gray-600 leading-relaxed",children:"    ,    "})]})})]})},e5=()=>{const{user:e,isAdmin:t,isSubAdmin:r}=qr(),[s,n]=K.useState([]),[o,l]=K.useState([]),[u,d]=K.useState([]),[h,m]=K.useState([]),[x,y]=K.useState([]),[b,v]=K.useState(!0),[g,_]=K.useState(null),w=t||r,S=K.useCallback(async()=>{try{const{data:Y,error:I}=await Pe.from("document_labels").select("*").order("code");if(I)throw I;m(Y||[])}catch{_("   .")}},[]),N=K.useCallback(async()=>{try{const{data:Y,error:I}=await Pe.from("users").select("user_id, name, rank, team").order("name");if(I)throw I;y(Y||[])}catch{_("   .")}},[]),E=K.useCallback(async()=>{if(e){v(!0),_(null);try{const{data:Y,error:I}=await Pe.from("documents").select("*, document_labels(*)").eq("drafter_id",e.user_id).order("created_at",{ascending:!1});if(I)throw I;n(Y||[]);const{data:ae,error:Q}=await Pe.from("documents").select("*, document_labels(*)").order("created_at",{ascending:!1});if(Q)throw Q;if(l(ae||[]),w){const{data:re,error:ve}=await Pe.from("documents").select("*, document_labels(*)").in("status",["pending","chairman_approved"]).order("created_at",{ascending:!1});if(ve)throw ve;d(re||[])}}catch{_("   .")}finally{v(!1)}}},[e,w]);return K.useEffect(()=>{S(),E(),N()},[S,E,N]),{documents:s,allDocuments:o,pendingDocuments:u,labels:h,users:x,loading:b,error:g,canManage:w,createDocument:async Y=>{if(!e)return{error:" ."};const I=new Date,ae=`${I.getFullYear()}/${String(I.getMonth()+1).padStart(2,"0")}/${String(I.getDate()).padStart(2,"0")}`,Q=new Date(I.setHours(0,0,0,0)).toISOString(),{count:re}=await Pe.from("documents").select("*",{count:"exact",head:!0}).gte("created_at",Q),ve=`${ae}-${(re||0)+1}`,{data:te,error:ke}=await Pe.from("documents").insert({label_id:Y.label_id,title:Y.title,content:Y.content,extra_work_hours:Y.extra_work_hours||0,doc_number:ve,drafter_id:e.user_id,status:"pending",execution_date:Y.execution_date||null,payment_method:Y.payment_method||null,expense_items:Y.expense_items||null,attachments:Y.attachments||null,attendance_type:Y.attendance_type||null,leave_type:Y.leave_type||null,leave_start_date:Y.leave_start_date||null,leave_end_date:Y.leave_end_date||null,leave_days:Y.leave_days||null,is_private:Y.is_private||!1}).select().single();return ke?console.error("Create document error:",ke):E(),{data:te,error:ke}},updateDocument:async(Y,I)=>{if(!e)return{error:" ."};const{data:ae,error:Q}=await Pe.from("documents").update({label_id:I.label_id,title:I.title,content:I.content,extra_work_hours:I.extra_work_hours||0,execution_date:I.execution_date||null,payment_method:I.payment_method||null,expense_items:I.expense_items||null,attachments:I.attachments||null,attendance_type:I.attendance_type||null,leave_type:I.leave_type||null,leave_start_date:I.leave_start_date||null,leave_end_date:I.leave_end_date||null,leave_days:I.leave_days||null,is_private:I.is_private||!1,updated_at:new Date().toISOString()}).eq("id",Y).eq("drafter_id",e.user_id).eq("status","pending").select().single();return Q?console.error("Update document error:",Q):E(),{data:ae,error:Q}},approveDocument:async(Y,I="chairman")=>{if(!w)return{error:" ."};const{data:ae}=await Pe.from("documents").select("*").eq("id",Y).single();if(!ae)return{error:"   ."};if((ae.expense_items||[]).reduce((ke,Z)=>ke+(Number(Z.amount)||0),0)>=1e6&&I==="chairman"){const{error:ke}=await Pe.from("documents").update({status:"chairman_approved",approver_id:e.user_id,updated_at:new Date().toISOString()}).eq("id",Y);return ke?{error:ke}:(E(),{error:null})}const ve={status:"approved",approver_id:e.user_id,approved_at:new Date().toISOString(),updated_at:new Date().toISOString()},{error:te}=await Pe.from("documents").update(ve).eq("id",Y);if(te)return{error:te};if(ae.label_id){const{data:ke}=await Pe.from("document_labels").select("code").eq("id",ae.label_id).single();if(ke?.code===4){const Z=new Date().getFullYear();if(ae.attendance_type==="overtime"&&ae.extra_work_hours>0){const{data:M}=await Pe.from("comp_leaves").select("*").eq("user_id",ae.drafter_id).eq("year",Z).single();M?await Pe.from("comp_leaves").update({total_hours:M.total_hours+ae.extra_work_hours,updated_at:new Date().toISOString()}).eq("id",M.id):await Pe.from("comp_leaves").insert({user_id:ae.drafter_id,document_id:Y,total_hours:ae.extra_work_hours,used_hours:0,year:Z,description:ae.title})}if(ae.attendance_type==="leave"&&ae.leave_type){if(ae.leave_days>0)if(ae.leave_type==="comp"){const J=ae.leave_days*8,{data:V}=await Pe.from("comp_leaves").select("*").eq("user_id",ae.drafter_id).eq("year",Z).single();V&&await Pe.from("comp_leaves").update({used_hours:V.used_hours+J,updated_at:new Date().toISOString()}).eq("id",V.id)}else{const{data:J}=await Pe.from("annual_leaves").select("*").eq("user_id",ae.drafter_id).eq("year",Z).single();J&&await Pe.from("annual_leaves").update({used_days:J.used_days+ae.leave_days,updated_at:new Date().toISOString()}).eq("id",J.id)}const{data:M}=await Pe.from("users").select("name, rank").eq("user_id",ae.drafter_id).single();if(M){const J={full:"",half_am:"",half_pm:"",out_1h:"",out_2h:"",out_3h:"",comp:""};let V="";ae.title?ae.title.includes("")?V="":ae.title.includes("")?V="":ae.title.includes("")?V="":ae.title.includes("")?V="":ae.title.includes("")?V="":ae.title.includes("")?V="":ae.title.includes("")?V="":ae.title.includes("")?V="":ae.leave_type&&(V=J[ae.leave_type]||""):ae.leave_type&&(V=J[ae.leave_type]||"");const X=`[${V}] ${M.name}${M.rank?" "+M.rank:""}`;let se=[];if(ae.leave_start_date){const P=ae.leave_start_date,U=ae.leave_end_date||ae.leave_start_date,ce=new Date(P+"T00:00:00"),ne=new Date(U+"T00:00:00");for(let ie=new Date(ce);ie<=ne;ie.setDate(ie.getDate()+1)){const W=ie.getFullYear(),G=String(ie.getMonth()+1).padStart(2,"0"),k=String(ie.getDate()).padStart(2,"0");se.push(`${W}-${G}-${k}`)}}else{const P=new Date(ae.created_at).getFullYear(),U=/(\d{4})/g,ce=ae.title.match(U);if(ce)for(const ne of ce){const ie=ne.substring(0,2),W=ne.substring(2,4);parseInt(ie)>=1&&parseInt(ie)<=12&&parseInt(W)>=1&&parseInt(W)<=31&&se.push(`${P}-${ie}-${W}`)}}for(const P of se)await Pe.from("events").insert({event_date:P,title:X,event_type:"leave",description:ae.title,created_by:ae.drafter_id})}}}}return E(),{error:null}},rejectDocument:async(Y,I)=>{if(!w)return{error:" ."};const{error:ae}=await Pe.from("documents").update({status:"rejected",approver_id:e.user_id,rejected_reason:I,updated_at:new Date().toISOString()}).eq("id",Y);return ae||E(),{error:ae}},deleteDocument:async(Y,I=!1)=>{if(I){const{error:Q}=await Pe.from("documents").delete().eq("id",Y).eq("drafter_id",e.user_id).eq("status","pending");return Q?console.error("Delete document error:",Q):E(),{error:Q}}if(!w)return{error:" ."};await Pe.from("comp_leaves").delete().eq("document_id",Y);const{error:ae}=await Pe.from("documents").delete().eq("id",Y);return ae?console.error("Delete document error:",ae):E(),{error:ae}},addLabel:async(Y,I)=>{if(!w)return{error:" ."};const{data:ae}=await Pe.from("document_labels").select("code").order("code",{ascending:!1}).limit(1).single(),Q=(ae?.code||0)+1,{error:re}=await Pe.from("document_labels").insert({code:Q,name:Y,color:I});return re||S(),{error:re}},updateLabel:async(Y,I,ae)=>{if(!w)return{error:" ."};const{error:Q}=await Pe.from("document_labels").update({name:I,color:ae}).eq("id",Y);return Q||S(),{error:Q}},deleteLabel:async Y=>{if(!w)return{error:" ."};const{error:I}=await Pe.from("document_labels").delete().eq("id",Y);return I||S(),{error:I}},refresh:E}},YU=({formData:e,setFormData:t,editingDoc:r,onSubmit:s,onClose:n,submitting:o,attachments:l,setAttachments:u,expenseItems:d,setExpenseItems:h,isAttendanceLabel:m=!0,isExpenseLabel:x=!1,leaveTypes:y,remainingAnnualDays:b,compLeaveDays:v})=>{const[g,_]=K.useState(!1),w=()=>{h([...d,{item:"",category:"",vendor:"",amount:"",note:""}])},S=O=>{d.length!==1&&h(d.filter((B,L)=>L!==O))},N=(O,B,L)=>{const H=[...d];H[O][B]=L,h(H)},E=d.reduce((O,B)=>O+(Number(B.amount)||0),0),C=async O=>{const B=Array.from(O.target.files);if(B.length!==0){_(!0);try{const L=await af(B,"/intranet/documents");u(H=>[...H,...L])}catch(L){alert("  : "+L.message)}finally{_(!1),O.target.value=""}}},F=O=>{u(B=>B.filter((L,H)=>H!==O))};return a.jsxs(_t,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold text-toss-gray-900",children:r?" ":"  "}),a.jsx("button",{onClick:n,className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",children:a.jsx(mr,{size:20,className:"text-toss-gray-500"})})]}),a.jsxs("form",{onSubmit:s,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:[" ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:e.title,onChange:O=>t({...e,title:O.target.value}),placeholder:" ",className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("button",{type:"button",onClick:()=>t({...e,is_private:!e.is_private}),className:`flex items-center gap-2 px-4 py-2 rounded-xl border-2 transition-all ${e.is_private?"border-red-400 bg-red-50 text-red-700":"border-toss-gray-200 bg-white text-toss-gray-600 hover:border-toss-gray-300"}`,children:[e.is_private?a.jsx(hl,{size:16}):a.jsx(dF,{size:16}),a.jsx("span",{className:"text-sm font-medium",children:e.is_private?"":""})]}),a.jsx("span",{className:"text-xs text-toss-gray-500",children:e.is_private?"   ":"   "})]}),m&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("button",{type:"button",onClick:()=>t({...e,attendance_type:"overtime",leave_type:"",leave_start_date:"",leave_end_date:""}),className:`p-4 rounded-xl border-2 transition-all text-left ${e.attendance_type==="overtime"?"border-toss-blue bg-blue-50":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(ra,{size:18,className:e.attendance_type==="overtime"?"text-toss-blue":"text-toss-gray-500"}),a.jsx("span",{className:`font-medium ${e.attendance_type==="overtime"?"text-toss-blue":"text-toss-gray-700"}`,children:" "})]}),a.jsx("p",{className:"text-xs text-toss-gray-500",children:",  "})]}),a.jsxs("button",{type:"button",onClick:()=>t({...e,attendance_type:"leave",extra_work_hours:0}),className:`p-4 rounded-xl border-2 transition-all text-left ${e.attendance_type==="leave"?"border-toss-blue bg-blue-50":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(ma,{size:18,className:e.attendance_type==="leave"?"text-toss-blue":"text-toss-gray-500"}),a.jsx("span",{className:`font-medium ${e.attendance_type==="leave"?"text-toss-blue":"text-toss-gray-700"}`,children:" "})]}),a.jsx("p",{className:"text-xs text-toss-gray-500",children:", , "})]})]})]}),e.attendance_type==="overtime"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" ()"}),a.jsx("input",{type:"number",value:e.extra_work_hours,onChange:O=>t({...e,extra_work_hours:O.target.value}),placeholder:"0",step:"0.5",min:"0",className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"}),a.jsx("p",{className:"mt-1 text-xs text-toss-gray-500",children:"* 8 =  1"})]}),e.attendance_type==="leave"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"p-3 bg-toss-gray-50 rounded-xl",children:a.jsxs("div",{className:"flex gap-4 text-sm",children:[a.jsxs("span",{className:"text-toss-gray-600",children:[" : ",a.jsxs("strong",{className:"text-toss-blue",children:[b,""]})]}),a.jsxs("span",{className:"text-toss-gray-600",children:[" : ",a.jsxs("strong",{className:"text-amber-600",children:[v,""]})]})]})}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:y.map(O=>a.jsxs("button",{type:"button",disabled:O.disabled,onClick:()=>t({...e,leave_type:O.value}),className:`p-3 rounded-xl border transition-all text-left ${O.disabled?"border-toss-gray-100 bg-toss-gray-50 text-toss-gray-400 cursor-not-allowed":e.leave_type===O.value?"border-toss-blue bg-blue-50":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[a.jsx("p",{className:`font-medium text-sm ${O.disabled?"text-toss-gray-400":e.leave_type===O.value?"text-toss-blue":"text-toss-gray-700"}`,children:O.label}),a.jsx("p",{className:"text-xs text-toss-gray-500",children:O.description})]},O.value))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:[" ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",value:e.leave_start_date,onChange:O=>t({...e,leave_start_date:O.target.value,leave_end_date:e.leave_end_date||O.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("input",{type:"date",value:e.leave_end_date,min:e.leave_start_date,onChange:O=>t({...e,leave_end_date:O.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]})]})]})]}),x&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("input",{type:"text",value:e.execution_date,onChange:O=>t({...e,execution_date:O.target.value}),placeholder:": 2025 1",className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("input",{type:"text",value:e.payment_method,onChange:O=>t({...e,payment_method:O.target.value}),placeholder:": ",className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700",children:""}),a.jsxs("button",{type:"button",onClick:w,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-toss-blue text-white rounded-lg hover:bg-toss-blue-dark transition-colors",children:[a.jsx(os,{size:14})," "]})]}),a.jsx("div",{className:"overflow-x-auto border border-toss-gray-200 rounded-xl",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-toss-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/4",children:""}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/6",children:""}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/6",children:""}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/6",children:""}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/6",children:""}),a.jsx("th",{className:"px-3 py-2 w-10"})]})}),a.jsxs("tbody",{children:[d.map((O,B)=>a.jsxs("tr",{className:"border-t border-toss-gray-100",children:[a.jsx("td",{className:"p-2",children:a.jsx("input",{type:"text",value:O.item,onChange:L=>N(B,"item",L.target.value),placeholder:"",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm"})}),a.jsx("td",{className:"p-2",children:a.jsx("input",{type:"text",value:O.category,onChange:L=>N(B,"category",L.target.value),placeholder:"",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm"})}),a.jsx("td",{className:"p-2",children:a.jsx("input",{type:"text",value:O.vendor,onChange:L=>N(B,"vendor",L.target.value),placeholder:"",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm"})}),a.jsx("td",{className:"p-2",children:a.jsx("input",{type:"number",value:O.amount,onChange:L=>N(B,"amount",L.target.value),placeholder:"0",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm text-right"})}),a.jsx("td",{className:"p-2",children:a.jsx("input",{type:"text",value:O.note,onChange:L=>N(B,"note",L.target.value),placeholder:"",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm"})}),a.jsx("td",{className:"p-2",children:a.jsx("button",{type:"button",onClick:()=>S(B),disabled:d.length===1,className:`p-1.5 rounded-lg transition-colors ${d.length===1?"text-toss-gray-300 cursor-not-allowed":"text-red-500 hover:bg-red-50"}`,children:a.jsx(Xt,{size:16})})})]},B)),a.jsxs("tr",{className:"border-t-2 border-toss-gray-300 bg-toss-gray-50",children:[a.jsx("td",{colSpan:3,className:"px-3 py-2 text-right font-medium text-toss-gray-700",children:" "}),a.jsxs("td",{className:"px-3 py-2 text-right font-bold text-toss-blue",children:[E.toLocaleString(),""]}),a.jsx("td",{colSpan:2})]})]})]})})]})]}),!x&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("textarea",{value:e.content,onChange:O=>t({...e,content:O.target.value}),placeholder:"  ",rows:4,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:`flex items-center justify-center gap-2 px-4 py-3 bg-toss-gray-50 border border-dashed border-toss-gray-300 rounded-xl cursor-pointer hover:bg-toss-gray-100 transition-colors ${g?"opacity-50 cursor-not-allowed":""}`,children:[g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-5 h-5 border-2 border-toss-blue border-t-transparent rounded-full animate-spin"}),a.jsx("span",{className:"text-toss-gray-500",children:" ..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Gn,{size:20,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-toss-gray-500",children:" "})]}),a.jsx("input",{type:"file",multiple:!0,onChange:C,disabled:g,className:"hidden"})]}),l.length>0&&a.jsx("div",{className:"space-y-2",children:l.map((O,B)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a.jsx(Hc,{size:16,className:"text-toss-blue flex-shrink-0"}),a.jsx("span",{className:"text-sm text-toss-gray-700 truncate",children:O.name}),a.jsxs("span",{className:"text-xs text-toss-gray-500 flex-shrink-0",children:["(",(O.size/1024).toFixed(1)," KB)"]})]}),a.jsx("button",{type:"button",onClick:()=>F(B),className:"p-1 hover:bg-blue-100 rounded transition-colors flex-shrink-0",children:a.jsx(mr,{size:16,className:"text-toss-gray-500"})})]},B))})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(Ye,{type:"submit",loading:o,disabled:o,className:"flex-1",children:o?r?" ...":" ...":r?"":" "}),a.jsx(Ye,{type:"button",variant:"secondary",onClick:n,className:"flex-1",children:""})]})]})]})},JU=({documents:e,users:t,labels:r,loading:s,searchTerm:n,setSearchTerm:o,searchFilters:l,setSearchFilters:u,showAdvancedSearch:d,setShowAdvancedSearch:h,onDocClick:m,canManage:x,currentUserId:y})=>{const b=K.useMemo(()=>{const C=new Date().getFullYear();return Array.from({length:5},(F,O)=>C-O)},[]),v=Array.from({length:12},(C,F)=>F+1),g=K.useMemo(()=>e.filter(C=>!(n&&!C.title.toLowerCase().includes(n.toLowerCase())||l.year&&new Date(C.created_at).getFullYear()!==parseInt(l.year)||l.month&&new Date(C.created_at).getMonth()+1!==parseInt(l.month)||l.label_id&&C.label_id!==parseInt(l.label_id)||l.drafter_id&&C.drafter_id!==l.drafter_id||l.status&&C.status!==l.status)),[e,n,l]),_=C=>t.find(O=>O.user_id===C)||{name:"  "},w=C=>{switch(C){case"approved":return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[a.jsx(Ws,{size:12}),""]});case"rejected":return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[a.jsx(fo,{size:12}),""]});case"chairman_approved":return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium",children:[a.jsx(ra,{size:12})," "]});default:return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[a.jsx(Sn,{size:12}),""]})}},S=C=>new Date(C).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"/").replace(".",""),N=()=>{o(""),u({year:new Date().getFullYear().toString(),month:"",label_id:"",drafter_id:"",status:""})},E=C=>{C.is_private&&!x&&C.drafter_id!==y||m(C)};return a.jsxs(_t,{children:[a.jsxs("div",{className:"flex gap-3 mb-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(qa,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),a.jsx("input",{type:"text",value:n,onChange:C=>o(C.target.value),placeholder:" ...",className:"w-full pl-10 pr-4 py-2.5 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),a.jsxs("button",{onClick:()=>h(!d),className:`flex items-center gap-2 px-4 py-2.5 rounded-xl border transition-colors ${d?"bg-toss-blue text-white border-toss-blue":"bg-white border-toss-gray-200 text-toss-gray-700 hover:bg-toss-gray-50"}`,children:[a.jsx(sF,{size:16}),"",d?a.jsx(Wn,{size:16}):a.jsx(Cn,{size:16})]})]}),d&&a.jsxs("div",{className:"p-4 bg-toss-gray-50 rounded-xl mb-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),a.jsxs("select",{value:l.year,onChange:C=>u({...l,year:C.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:""}),b.map(C=>a.jsxs("option",{value:C,children:[C,""]},C))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),a.jsxs("select",{value:l.month,onChange:C=>u({...l,month:C.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:""}),v.map(C=>a.jsxs("option",{value:C,children:[C,""]},C))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),a.jsxs("select",{value:l.label_id,onChange:C=>u({...l,label_id:C.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:""}),r.map(C=>a.jsx("option",{value:C.id,children:C.name},C.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),a.jsxs("select",{value:l.drafter_id,onChange:C=>u({...l,drafter_id:C.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:""}),t.map(C=>a.jsx("option",{value:C.user_id,children:C.name},C.user_id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),a.jsxs("select",{value:l.status,onChange:C=>u({...l,status:C.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:""}),a.jsx("option",{value:"pending",children:""}),a.jsx("option",{value:"chairman_approved",children:" "}),a.jsx("option",{value:"approved",children:""}),a.jsx("option",{value:"rejected",children:""})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:N,className:"text-sm text-toss-gray-500 hover:text-toss-gray-700",children:" "})})]}),a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold text-toss-gray-900",children:" "}),a.jsxs("span",{className:"text-sm text-toss-gray-500",children:[" ",g.length,""]})]}),s?a.jsx("div",{className:"py-12 flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-toss-blue border-t-transparent"})}):g.length===0?a.jsxs("div",{className:"py-12 text-center text-toss-gray-500",children:[a.jsx(Gs,{className:"mx-auto mb-3 text-toss-gray-300",size:48}),a.jsx("p",{children:"  "})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-toss-gray-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),a.jsx("tbody",{children:g.map(C=>{const F=C.is_private&&!x&&C.drafter_id!==y,O=_(C.drafter_id);return a.jsxs("tr",{onClick:()=>E(C),className:`border-b border-toss-gray-100 ${F?"bg-toss-gray-50 cursor-not-allowed":"hover:bg-toss-gray-50 cursor-pointer"}`,children:[a.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:S(C.created_at)}),a.jsx("td",{className:"py-3 px-4",children:C.document_labels&&a.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:C.document_labels.color+"20",color:C.document_labels.color},children:C.document_labels.name})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[C.is_private&&a.jsx(hl,{size:14,className:F?"text-red-400":"text-toss-gray-400"}),a.jsx("p",{className:`font-medium truncate max-w-xs ${F?"text-toss-gray-400":"text-toss-gray-900"}`,children:F?" ":C.title})]}),!F&&C.attachments&&C.attachments.length>0&&a.jsxs("p",{className:"text-xs text-toss-gray-500 flex items-center gap-1",children:[a.jsx(Hc,{size:12})," ",C.attachments.length,""]})]}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx("span",{className:"text-sm text-toss-gray-700",children:O.name}),O.rank&&a.jsx("span",{className:"text-xs text-toss-gray-500 ml-1",children:O.rank})]}),a.jsx("td",{className:"py-3 px-4 text-center",children:w(C.status)})]},C.id)})})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:g.map(C=>{const F=C.is_private&&!x&&C.drafter_id!==y,O=_(C.drafter_id);return a.jsxs("div",{onClick:()=>E(C),className:`p-4 rounded-xl ${F?"bg-toss-gray-100 cursor-not-allowed":"bg-toss-gray-50 cursor-pointer active:bg-toss-gray-100"}`,children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[C.document_labels&&a.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium",style:{backgroundColor:C.document_labels.color+"20",color:C.document_labels.color},children:C.document_labels.name}),w(C.status)]}),a.jsx("span",{className:"text-xs text-toss-gray-400",children:S(C.created_at)})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[C.is_private&&a.jsx(hl,{size:14,className:F?"text-red-400":"text-toss-gray-400"}),a.jsx("p",{className:`font-medium ${F?"text-toss-gray-400":"text-toss-gray-900"}`,children:F?" ":C.title})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"text-sm text-toss-gray-600",children:[O.name,O.rank&&a.jsx("span",{className:"text-toss-gray-400 ml-1",children:O.rank})]}),!F&&C.attachments&&C.attachments.length>0&&a.jsxs("span",{className:"text-xs text-toss-gray-500 flex items-center gap-1",children:[a.jsx(Hc,{size:12}),C.attachments.length]})]})]},C.id)})})]})]})},ZU=({doc:e,onClose:t,onApprove:r,onReject:s,onEdit:n,onDelete:o,canManage:l,currentUserId:u,processing:d,showRejectModal:h,setShowRejectModal:m,rejectReason:x,setRejectReason:y,showDeleteModal:b,setShowDeleteModal:v,users:g,leaveTypes:_})=>{if(!e)return null;const w=E=>g.find(F=>F.user_id===E)||{name:"  "},S=E=>{const C=_.find(F=>F.value===E);return C?C.label:E},N=E=>{switch(E){case"approved":return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[a.jsx(Ws,{size:12}),""]});case"rejected":return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[a.jsx(fo,{size:12}),""]});case"chairman_approved":return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium",children:[a.jsx(ra,{size:12})," "]});default:return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[a.jsx(Sn,{size:12}),""]})}};return a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:t,children:a.jsx("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:E=>E.stopPropagation(),children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:" "}),a.jsx("button",{onClick:t,className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",children:a.jsx(mr,{size:20,className:"text-toss-gray-500"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[N(e.status),e.document_labels&&a.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:e.document_labels.color+"20",color:e.document_labels.color},children:e.document_labels.name}),e.is_private&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[a.jsx(hl,{size:12}),""]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.doc_number&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"font-medium text-toss-gray-900",children:e.doc_number})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsxs("p",{className:"font-medium text-toss-gray-900",children:[w(e.drafter_id).name,w(e.drafter_id).rank&&a.jsx("span",{className:"text-toss-gray-500 font-normal ml-1",children:w(e.drafter_id).rank})]})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"font-bold text-toss-gray-900 text-lg",children:e.title})]}),e.content&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:e.content})]}),e.extra_work_hours>0&&a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsxs("p",{className:"text-sm text-toss-blue font-medium",children:[": ",e.extra_work_hours," ( ",(e.extra_work_hours/8).toFixed(1),")"]})}),e.attendance_type==="leave"&&e.leave_type&&a.jsxs("div",{className:"p-3 bg-emerald-50 rounded-lg",children:[a.jsxs("p",{className:"text-sm text-emerald-700 font-medium mb-1",children:[S(e.leave_type)," "]}),a.jsxs("p",{className:"text-sm text-emerald-600",children:[e.leave_start_date===e.leave_end_date?new Date(e.leave_start_date).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}):`${new Date(e.leave_start_date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})} ~ ${new Date(e.leave_end_date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})}`,e.leave_days&&` (${e.leave_days})`]})]}),e.attachments&&e.attachments.length>0&&a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm text-toss-gray-500 mb-2",children:[" (",e.attachments.length,")"]}),a.jsx("div",{className:"space-y-2",children:e.attachments.map((E,C)=>a.jsxs("a",{href:E.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-lg hover:bg-toss-gray-100 transition-colors",children:[a.jsx(Hc,{size:16,className:"text-toss-blue"}),a.jsx("span",{className:"text-sm text-toss-gray-700 flex-1",children:E.name}),a.jsx(rl,{size:14,className:"text-toss-gray-400"})]},C))})]}),e.status==="rejected"&&e.rejected_reason&&a.jsxs("div",{className:"p-3 bg-red-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-red-600 font-medium mb-1",children:" "}),a.jsx("p",{className:"text-red-700",children:e.rejected_reason})]}),a.jsxs("div",{className:"pt-4 border-t border-toss-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500",children:[a.jsx(ra,{size:14}),new Date(e.created_at).toLocaleString("ko-KR")," "]}),e.approved_at&&a.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500 mt-1",children:[a.jsx(ra,{size:14}),new Date(e.approved_at).toLocaleString("ko-KR")," "]})]})]}),a.jsxs("div",{className:"mt-6 space-y-3",children:[e.status==="pending"&&l&&!h&&a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(Ye,{onClick:r,className:"flex-1 bg-emerald-500 hover:bg-emerald-600",disabled:d,children:[d?a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-1"}):a.jsx(Ws,{size:16,className:"mr-1"}),""]}),a.jsxs(Ye,{onClick:()=>m(!0),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",disabled:d,children:[a.jsx(fo,{size:16,className:"mr-1"}),""]})]}),h&&a.jsxs("div",{className:"p-4 bg-red-50 rounded-lg space-y-3",children:[a.jsx("p",{className:"text-sm font-medium text-red-700",children:"  "}),a.jsx("textarea",{value:x,onChange:E=>y(E.target.value),placeholder:"  ",rows:2,className:"w-full px-3 py-2 bg-white border border-red-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{onClick:s,className:"flex-1 bg-red-500 hover:bg-red-600",disabled:d||!x.trim(),children:d?" ...":" "}),a.jsx(Ye,{onClick:()=>{m(!1),y("")},variant:"secondary",className:"flex-1",disabled:d,children:""})]})]}),e.status==="pending"&&e.drafter_id===u&&!h&&!b&&a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(Ye,{onClick:()=>n(e),variant:"secondary",className:"flex-1",children:[a.jsx(Wc,{size:16,className:"mr-1"}),""]}),a.jsxs(Ye,{onClick:()=>v(!0),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",children:[a.jsx(Xt,{size:16,className:"mr-1"}),""]})]}),e.status!=="pending"&&l&&!h&&!b&&a.jsxs(Ye,{onClick:()=>v(!0),variant:"secondary",className:"w-full text-red-500 border-red-200 hover:bg-red-50",children:[a.jsx(Xt,{size:16,className:"mr-1"}),""]}),b&&a.jsxs("div",{className:"p-4 bg-red-50 rounded-lg space-y-3",children:[a.jsx("p",{className:"text-sm font-medium text-red-700",children:e.status==="pending"?"  ?":`  ?
    .`}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{onClick:o,className:"flex-1 bg-red-500 hover:bg-red-600",disabled:d,children:d?" ...":""}),a.jsx(Ye,{onClick:()=>v(!1),variant:"secondary",className:"flex-1",disabled:d,children:""})]})]}),!h&&!b&&a.jsx(Ye,{onClick:t,variant:"secondary",className:"w-full",children:""})]})]})})})},QU=({users:e,allLeaves:t,onSaveTotalDays:r})=>{const[s,n]=K.useState(""),[o,l]=K.useState(null),[u,d]=K.useState(""),[h,m]=K.useState(null),x=g=>t.find(_=>_.user_id===g),y=K.useMemo(()=>s?e.filter(g=>g.name?.toLowerCase().includes(s.toLowerCase())||g.team?.toLowerCase().includes(s.toLowerCase())):e,[e,s]),b=(g,_)=>{l(g),d(_.toString())},v=async g=>{const _=parseFloat(u);if(isNaN(_)||_<0){alert("   ");return}m(g);try{await r(g,_),l(null)}catch{alert("   ")}finally{m(null)}};return a.jsxs(_t,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 flex items-center gap-2",children:[a.jsx(Gc,{className:"text-toss-blue",size:20}),"  "]}),a.jsxs("div",{className:"relative",children:[a.jsx(qa,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400",size:16}),a.jsx("input",{type:"text",value:s,onChange:g=>n(g.target.value),placeholder:"   ",className:"pl-9 pr-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-toss-gray-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:" "}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),a.jsx("tbody",{children:y.map(g=>{const _=x(g.user_id),w=_?.total_days||15,S=_?.used_days||0,N=w-S,E=o===g.user_id,C=h===g.user_id;return a.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50",children:[a.jsxs("td",{className:"py-3 px-4",children:[a.jsx("p",{className:"font-medium text-toss-gray-900",children:g.name}),g.rank&&a.jsx("p",{className:"text-xs text-toss-gray-500",children:g.rank})]}),a.jsx("td",{className:"py-3 px-4 text-toss-gray-600",children:g.team||"-"}),a.jsx("td",{className:"py-3 px-4 text-center",children:E?a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("input",{type:"number",value:u,onChange:F=>d(F.target.value),step:"0.5",min:"0",className:"w-16 px-2 py-1 text-center bg-white border border-toss-gray-300 rounded-lg text-sm",autoFocus:!0}),a.jsx("button",{onClick:()=>v(g.user_id),disabled:C,className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded",children:C?a.jsx("div",{className:"w-4 h-4 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin"}):a.jsx(Fy,{size:16})}),a.jsx("button",{onClick:()=>l(null),disabled:C,className:"p-1 text-toss-gray-500 hover:bg-toss-gray-100 rounded",children:a.jsx(mr,{size:16})})]}):a.jsxs("button",{onClick:()=>b(g.user_id,w),className:"inline-flex items-center gap-1 text-toss-gray-900 hover:text-toss-blue transition-colors group",children:[w,"",a.jsx(Wc,{size:14,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})}),a.jsxs("td",{className:"py-3 px-4 text-center text-toss-blue font-medium",children:[S,""]}),a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsxs("span",{className:`font-bold ${N<=3?"text-red-500":"text-emerald-600"}`,children:[N,""]})})]},g.user_id)})})]})}),y.length===0&&a.jsx("div",{className:"py-12 text-center text-toss-gray-500",children:"  "})]})},ez=()=>{const{user:e,isAdmin:t,isSubAdmin:r}=qr(),s=t||r,{allDocuments:n,labels:o,users:l,loading:u,createDocument:d,updateDocument:h,deleteDocument:m,approveDocument:x,rejectDocument:y,refresh:b}=e5(),{annualLeave:v,compLeave:g}=Iv(),[_,w]=K.useState(!1),[S,N]=K.useState(!1),[E,C]=K.useState([]),[F,O]=K.useState(null),[B,L]=K.useState(null),[H,ue]=K.useState({label_id:"",title:"",content:"",extra_work_hours:0,execution_date:"",payment_method:"",attendance_type:"",leave_type:"",leave_start_date:"",leave_end_date:"",is_private:!1}),[A,Y]=K.useState([{item:"",category:"",vendor:"",amount:"",note:""}]),[I,ae]=K.useState(""),[Q,re]=K.useState(!1),[ve,te]=K.useState({year:new Date().getFullYear().toString(),month:"",label_id:"",drafter_id:"",status:""}),[ke,Z]=K.useState("list"),[M,J]=K.useState([]),[V,X]=K.useState(!1),[se,P]=K.useState(!1),[U,ce]=K.useState(""),[ne,ie]=K.useState(!1),W=o.find(Ee=>Ee.code===4),G=g&&g.total_hours-g.used_hours>=8,k=g?Math.floor((g.total_hours-g.used_hours)/8):0,de=v?v.total_days-v.used_days:0,z=[{value:"full",label:"",description:"1 ",days:1},{value:"half_am",label:" ",description:"0.5 ",days:.5},{value:"half_pm",label:" ",description:"0.5 ",days:.5},{value:"out_1h",label:"/ 1",description:"0.125 ",days:.125},{value:"out_2h",label:"/ 2",description:"0.25 ",days:.25},{value:"out_3h",label:"/ 3",description:"0.375 ",days:.375},{value:"comp",label:"",description:G?`${k} `:" ",days:1,disabled:!G}],T=K.useCallback(async()=>{if(s)try{const Ee=new Date().getFullYear(),Ce=`${Ee}-01-01`,Je=`${Ee}-12-31`,{data:$e,error:tt}=await Pe.from("annual_leaves").select("*").eq("year",Ee);if(tt)throw tt;const{data:De}=await Pe.from("document_labels").select("id").eq("code",yd).single();let ft=[];if(De){const{data:At}=await Pe.from("documents").select("drafter_id, leave_days, leave_type").eq("label_id",De.id).eq("attendance_type","leave").eq("status","approved").gte("leave_start_date",Ce).lte("leave_start_date",Je).not("leave_type","is",null).neq("leave_type","comp");ft=At||[]}const jt={};ft.forEach(At=>{jt[At.drafter_id]=(jt[At.drafter_id]||0)+(At.leave_days||0)});const vt=($e||[]).map(At=>({...At,used_days:jt[At.user_id]||0}));J(vt)}catch(Ee){console.error("   :",Ee)}},[s]);K.useEffect(()=>{ke==="leaveSettings"&&s&&T()},[ke,s,T]);const R=async(Ee,Ce)=>{const Je=new Date().getFullYear(),$e=M.find(tt=>tt.user_id===Ee);$e?await Pe.from("annual_leaves").update({total_days:Ce,updated_at:new Date().toISOString()}).eq("id",$e.id):await Pe.from("annual_leaves").insert({user_id:Ee,year:Je,total_days:Ce,used_days:0}),await T()},q=async()=>{if(!(!F||!s)){X(!0);try{const{error:Ee}=await x(F.id);Ee?alert(" : "+Ee):(alert("."),O(null),b())}catch(Ee){console.error(" :",Ee),alert("   ")}finally{X(!1)}}},me=async()=>{if(!F||!s||!U.trim()){alert("  ");return}X(!0);try{const{error:Ee}=await y(F.id,U);Ee?alert(" : "+Ee):(alert("."),O(null),P(!1),ce(""),b())}catch(Ee){console.error(" :",Ee),alert("   ")}finally{X(!1)}},_e=async()=>{if(F){X(!0);try{const{error:Ee}=await m(F.id,!0);Ee?alert(" ."):(O(null),ie(!1))}catch(Ee){console.error(" :",Ee),alert("   ")}finally{X(!1)}}},le=async Ee=>{if(Ee.preventDefault(),!W){alert("    .");return}if(!H.title.trim()){alert(" .");return}if(!H.attendance_type){alert("  .");return}if(H.attendance_type==="leave"){if(!H.leave_type){alert("  .");return}if(!H.leave_start_date){alert(" .");return}}N(!0);let Ce=0;if(H.attendance_type==="leave"){const tt=z.find(De=>De.value===H.leave_type);if(H.leave_type==="full"||H.leave_type==="comp"){const De=new Date(H.leave_start_date),ft=new Date(H.leave_end_date||H.leave_start_date);Ce=Math.ceil((ft-De)/(1e3*60*60*24))+1}else Ce=tt?.days||.5}const Je={label_id:W.id,title:H.title.trim(),content:H.content.trim(),extra_work_hours:H.attendance_type==="overtime"&&parseFloat(H.extra_work_hours)||0,attachments:E.length>0?E:null,execution_date:null,payment_method:null,expense_items:null,attendance_type:H.attendance_type,leave_type:H.attendance_type==="leave"?H.leave_type:null,leave_start_date:H.attendance_type==="leave"?H.leave_start_date:null,leave_end_date:H.attendance_type==="leave"?H.leave_end_date||H.leave_start_date:null,leave_days:H.attendance_type==="leave"?Ce:null,is_private:H.is_private};let $e;if(B?$e=(await h(B.id,Je)).error:$e=(await d(Je)).error,N(!1),$e){console.error("Document error:",$e);const tt=typeof $e=="string"?$e:$e.message||JSON.stringify($e);alert((B?" : ":"  : ")+tt)}else Me()},Ae=Ee=>{L(Ee),ue({label_id:Ee.label_id||"",title:Ee.title||"",content:Ee.content||"",extra_work_hours:Ee.extra_work_hours||0,execution_date:Ee.execution_date||"",payment_method:Ee.payment_method||"",attendance_type:Ee.attendance_type||"",leave_type:Ee.leave_type||"",leave_start_date:Ee.leave_start_date||"",leave_end_date:Ee.leave_end_date||"",is_private:Ee.is_private||!1}),C(Ee.attachments||[]),Y(Ee.expense_items?.length>0?Ee.expense_items:[{item:"",category:"",vendor:"",amount:"",note:""}]),w(!0),O(null)},Me=()=>{w(!1),L(null),ue({label_id:"",title:"",content:"",extra_work_hours:0,execution_date:"",payment_method:"",attendance_type:"",leave_type:"",leave_start_date:"",leave_end_date:"",is_private:!1}),C([]),Y([{item:"",category:"",vendor:"",amount:"",note:""}])};return a.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsxs(Vs,{to:"/",className:"inline-flex items-center gap-2 text-toss-gray-500 hover:text-toss-gray-700 transition-colors",children:[a.jsx(sf,{size:20})," "]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-700 rounded-2xl flex items-center justify-center",children:a.jsx(Gs,{className:"text-white",size:28})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),a.jsx("p",{className:"text-toss-gray-500",children:" "})]})]}),ke==="list"&&a.jsxs(Ye,{onClick:()=>w(!_),children:[a.jsx(os,{size:18,className:"mr-1"}),""]})]}),s&&a.jsxs("div",{className:"flex gap-2 border-b border-toss-gray-200",children:[a.jsx("button",{onClick:()=>Z("list"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${ke==="list"?"border-toss-blue text-toss-blue":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "}),a.jsxs("button",{onClick:()=>Z("leaveSettings"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${ke==="leaveSettings"?"border-toss-blue text-toss-blue":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:[a.jsx(_l,{size:16,className:"inline mr-1"})," "]})]}),ke==="list"&&a.jsxs(a.Fragment,{children:[_&&a.jsx(YU,{formData:H,setFormData:ue,editingDoc:B,onSubmit:le,onClose:Me,submitting:S,attachments:E,setAttachments:C,expenseItems:A,setExpenseItems:Y,isAttendanceLabel:!0,isExpenseLabel:!1,leaveTypes:z,remainingAnnualDays:de,compLeaveDays:k}),a.jsx(JU,{documents:n,users:l,labels:o,loading:u,searchTerm:I,setSearchTerm:ae,searchFilters:ve,setSearchFilters:te,showAdvancedSearch:Q,setShowAdvancedSearch:re,onDocClick:O,canManage:s,currentUserId:e?.user_id})]}),ke==="leaveSettings"&&s&&a.jsx(QU,{users:l,allLeaves:M,onSaveTotalDays:R}),a.jsx(ZU,{doc:F,onClose:()=>O(null),onApprove:q,onReject:me,onEdit:Ae,onDelete:_e,canManage:s,currentUserId:e?.user_id,processing:V,showRejectModal:se,setShowRejectModal:P,rejectReason:U,setRejectReason:ce,showDeleteModal:ne,setShowDeleteModal:ie,users:l,leaveTypes:z})]})},tz={full:"",half_am:" ",half_pm:" ",out_1h:"/ 1",out_2h:"/ 2",out_3h:"/ 3"},FS=(e,t,r="",s=1)=>{const n=new Date(e.start_date),o=new Date(e.end_date),l=new Date(e.created_at),u=g=>`${g.getFullYear()} ${g.getMonth()+1} ${g.getDate()}`,d=g=>{const _=g.getFullYear(),w=String(g.getMonth()+1).padStart(2,"0"),S=String(g.getDate()).padStart(2,"0");return`${_}/${w}/${S}`},h=g=>{const _=String(g.getMonth()+1).padStart(2,"0"),w=String(g.getDate()).padStart(2,"0");return`${_}${w}`},x=`${d(l)} -${s} `,y=tz[e.leave_type]||"",b=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title> - ${t.name}</title>
    <style>
        @page {
            size: A4;
            margin: 20mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', sans-serif;
            font-size: 14px;
            line-height: 1.5;
            color: #000;
            background: #fff;
        }
        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 15mm 20mm;
            margin: 0 auto;
            background: #fff;
        }

        /*   */
        .header {
            position: relative;
            margin-bottom: 15px;
            padding-top: 10px;
        }
        .title {
            text-align: center;
            font-size: 22px;
            font-weight: bold;
            text-decoration: underline;
            padding-bottom: 15px;
        }

        /*  -   */
        .approval-box {
            position: absolute;
            top: 0;
            right: 0;
        }
        .approval-table {
            border-collapse: collapse;
            font-size: 11px;
        }
        .approval-table td {
            border: 1px solid #000;
            text-align: center;
            padding: 4px 12px;
            height: 22px;
        }
        .approval-table .label-cell {
            width: 30px;
            padding: 4px 6px;
        }
        .approval-table .name-cell {
            width: 55px;
        }

        /*  */
        .doc-number {
            font-size: 12px;
            margin-bottom: 10px;
        }

        /*   */
        .main-box {
            border: 1px solid #000;
            padding: 20px 25px;
            min-height: 200mm;
            position: relative;
        }

        /* // */
        .info-line {
            font-size: 14px;
            margin-bottom: 12px;
        }

        /*  */
        .statement {
            font-size: 14px;
            margin: 25px 0;
        }

        /*   */
        .inner-box {
            border: 1px solid #000;
            width: 65%;
            margin: 30px auto;
            padding: 15px 20px;
        }
        .inner-line {
            font-size: 13px;
            margin-bottom: 10px;
        }
        .date-line {
            font-size: 13px;
            margin-bottom: 5px;
        }
        .date-line span {
            margin-left: 20px;
        }
        .date-sub {
            font-size: 13px;
            margin-left: 65px;
            margin-bottom: 5px;
        }
        .total-days {
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            margin-top: 20px;
        }

        /*  / */
        .footer-area {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            text-align: center;
        }
        .footer-date {
            font-size: 14px;
            margin-bottom: 15px;
        }
        .org-name {
            font-size: 20px;
            font-weight: bold;
            color: #1a4ed8;
        }

        /*   */
        .page-num {
            position: absolute;
            bottom: 10px;
            left: 20px;
            font-size: 12px;
        }

        @media print {
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .page { margin: 0; padding: 15mm 20mm; }
        }
    </style>
</head>
<body>
    <div class="page">
        <div class="header">
            <div class="title">(${h(l)})</div>

            <div class="approval-box">
                <table class="approval-table">
                    <tr>
                        <td rowspan="3" class="label-cell"><br></td>
                        <td class="name-cell"></td>
                        <td class="name-cell"></td>
                    </tr>
                    <tr>
                        <td class="name-cell">${t.name||""}</td>
                        <td class="name-cell">${r}</td>
                    </tr>
                    <tr>
                        <td class="name-cell">${d(l)}</td>
                        <td class="name-cell">${d(l)}</td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="doc-number"> : ${x}</div>

        <div class="main-box">
            <div class="info-line"> : ${t.team||"-"}</div>
            <div class="info-line"> : ${t.rank||"-"}</div>
            <div class="info-line"> : ${t.name||"-"}</div>

            <div class="statement">
                     (${y}) .
            </div>

            <div class="inner-box">
                <div class="inner-line"> : ${e.reason||""}</div>
                <div class="inner-line"> :</div>
                <div class="date-line"> :<span>1. ${u(n)}</span></div>
                <div class="date-sub">${u(o)}</div>
                <div class="total-days">( ${e.days})</div>
            </div>

            <div class="footer-area">
                <div class="footer-date">${u(l)}</div>
                <div class="org-name"> </div>
            </div>
        </div>

        <div class="page-num">7</div>
    </div>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,v=window.open("","_blank","width=900,height=700");v.document.write(b),v.document.close()},Q1=(e,t,r="",s="")=>{const n=new Date(e.created_at),o=e.approved_at?new Date(e.approved_at):n,l=v=>`${v.getFullYear()} ${String(v.getMonth()+1).padStart(2,"0")} ${String(v.getDate()).padStart(2,"0")}`,u=v=>{const g=v.getFullYear(),_=String(v.getMonth()+1).padStart(2,"0"),w=String(v.getDate()).padStart(2,"0");return`${g}/${_}/${w}`},d=()=>{const v=e.expense_items||[];return v.length===0?`
                <tr>
                    <td colspan="5" style="padding: 20px; text-align: center; color: #666;"> </td>
                </tr>
            `:v.map(g=>`
            <tr>
                <td style="padding: 10px 8px; text-align: center; border: 1px solid #000; vertical-align: middle;">${g.item||""}</td>
                <td style="padding: 10px 8px; text-align: center; border: 1px solid #000; vertical-align: middle;">${g.category||""}</td>
                <td style="padding: 10px 8px; text-align: center; border: 1px solid #000; vertical-align: middle;">${g.vendor||""}</td>
                <td style="padding: 10px 8px; text-align: right; border: 1px solid #000; vertical-align: middle;">${g.amount?Number(g.amount).toLocaleString():""}</td>
                <td style="padding: 10px 8px; text-align: center; border: 1px solid #000; vertical-align: middle;">${g.note||""}</td>
            </tr>
        `).join("")},h=(e.expense_items||[]).reduce((v,g)=>v+(Number(g.amount)||0),0),m=v=>{const g=["","","",""],_=["","","",""],w=["","","","","","","","","",""];if(v===0)return"";let S="",N=0;for(;v>0;){const E=v%1e4;if(E>0){let C="",F=E,O=0;for(;F>0;){const B=F%10;B>0&&(O===0?C=w[B]+C:C=(B===1?"":w[B])+_[O]+C),F=Math.floor(F/10),O++}S=C+g[N]+S}v=Math.floor(v/1e4),N++}return" "+S+""},x=h>=1e6,y=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title> - ${e.title}</title>
    <style>
        @page {
            size: A4;
            margin: 15mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', sans-serif;
            font-size: 13px;
            line-height: 1.4;
            color: #000;
            background: #fff;
        }
        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 10mm 15mm;
            margin: 0 auto;
            background: #fff;
        }

        /*   */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        /*  */
        .main-title {
            font-size: 22px;
            font-weight: bold;
            text-decoration: underline;
            padding-top: 10px;
        }

        /*  */
        .approval-box {
            border-collapse: collapse;
        }
        .approval-box td {
            border: 1px solid #000;
            text-align: center;
            font-size: 11px;
        }
        .approval-box .header-row td {
            padding: 4px 8px;
            background: #fff;
        }
        .approval-box .label-cell {
            width: 30px;
            writing-mode: vertical-lr;
            text-orientation: upright;
            letter-spacing: 2px;
            padding: 8px 4px;
            font-weight: normal;
        }
        .approval-box .position-cell {
            width: 55px;
            padding: 3px 5px;
        }
        .approval-box .name-cell {
            width: 55px;
            padding: 3px 5px;
        }
        .approval-box .date-cell {
            width: 55px;
            padding: 3px 5px;
            font-size: 10px;
        }

        /*  */
        .doc-number {
            font-size: 11px;
            margin-bottom: 8px;
        }

        /*   */
        .main-box {
            border: 1px solid #000;
        }

        /*    */
        .info-table {
            width: 100%;
            border-collapse: collapse;
        }
        .info-table td {
            border: 1px solid #000;
            padding: 6px 12px;
            font-size: 13px;
        }
        .info-table .label {
            width: 80px;
            text-align: center;
            font-weight: normal;
        }

        /*   */
        .content-area {
            padding: 20px;
            min-height: 50mm;
            border-top: 1px solid #000;
        }
        .content-statement {
            text-align: center;
            font-size: 14px;
            margin-bottom: 25px;
            line-height: 1.8;
        }
        .content-list {
            font-size: 13px;
        }
        .content-list p {
            margin-bottom: 6px;
        }

        /*  */
        .expense-section {
            margin-top: 15px;
        }
        .expense-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }
        .expense-table th {
            background: #f0f0f0;
            border: 1px solid #000;
            padding: 10px 8px;
            font-weight: bold;
            text-align: center;
        }
        .expense-table td {
            border: 1px solid #000;
            padding: 10px 8px;
        }
        .expense-table .total-row td {
            font-weight: bold;
            background: #fff;
        }

        /*  */
        .attachment {
            margin-top: 20px;
            font-size: 12px;
        }

        @media print {
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .page { margin: 0; padding: 10mm 15mm; }
        }
    </style>
</head>
<body>
    <div class="page">
        <div class="header">
            <div class="main-title">(${e.title})</div>
            <table class="approval-box">
                <tr class="header-row">
                    <td rowspan="3" class="label-cell"><br></td>
                    <td class="position-cell"></td>
                    <td class="position-cell"></td>
                    ${x?'<td class="position-cell"></td>':""}
                </tr>
                <tr>
                    <td class="name-cell">${t.name||""}</td>
                    <td class="name-cell">${r}</td>
                    ${x?`<td class="name-cell">${s}</td>`:""}
                </tr>
                <tr>
                    <td class="date-cell">${u(n)}</td>
                    <td class="date-cell">${u(o)}</td>
                    ${x?`<td class="date-cell">${e.approved_at?u(o):""}</td>`:""}
                </tr>
            </table>
        </div>

        <div class="doc-number"> : ${e.doc_number||""}</div>

        <div class="main-box">
            <table class="info-table">
                <tr>
                    <td class="label">  </td>
                    <td>${l(n).replace(" ","-").replace(" ","-").replace("","")}</td>
                </tr>
                <tr>
                    <td class="label">  </td>
                    <td>${t.name||""}</td>
                </tr>
                <tr>
                    <td class="label"></td>
                    <td>${t.team||""}</td>
                </tr>
                <tr>
                    <td class="label"> </td>
                    <td>${t.rank||""}</td>
                </tr>
                <tr>
                    <td class="label"> </td>
                    <td>${e.document_labels?.name||""} (${e.title})</td>
                </tr>
            </table>

            <div class="content-area">
                <p class="content-statement">      .</p>

                <p style="text-align: center; margin: 20px 0;">-</p>

                <div class="content-list">
                    ${e.execution_date?`<p>1. : ${e.execution_date}</p>`:""}
                    ${h>0?`<p>${e.execution_date?"2":"1"}. : ${h.toLocaleString()}  (${m(h)})</p>`:""}
                    ${e.payment_method?`<p>${e.execution_date?"3":"2"}. : ${e.payment_method}</p>`:""}
                    ${(e.expense_items||[]).length>0?`<p>${e.execution_date?"4":"3"}. </p>`:""}
                </div>

                ${(e.expense_items||[]).length>0?`
                <div class="expense-section">
                    <table class="expense-table">
                        <thead>
                            <tr>
                                <th style="width: 25%;"> </th>
                                <th style="width: 15%;"></th>
                                <th style="width: 15%;"></th>
                                <th style="width: 18%;"></th>
                                <th style="width: 12%;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            ${d()}
                            <tr class="total-row">
                                <td colspan="3" style="text-align: center; border: 1px solid #000;"> </td>
                                <td style="text-align: right; border: 1px solid #000;">${h.toLocaleString()}</td>
                                <td style="border: 1px solid #000;"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                `:`
                <div style="margin-top: 20px;">
                    <p style="white-space: pre-wrap;">${e.content||""}</p>
                </div>
                `}

                ${(e.expense_items||[]).length>0?`
                <div class="attachment">
                    <p>. 1.  ${(e.expense_items||[]).length} .</p>
                </div>
                `:""}
            </div>
        </div>
    </div>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,b=window.open("","_blank","width=900,height=700");b.document.write(y),b.document.close()},Ko={full:{label:"",days:1},half_am:{label:" ",days:.5},half_pm:{label:" ",days:.5},out_1h:{label:"/ 1",days:.125},out_2h:{label:"/ 2",days:.25},out_3h:{label:"/ 3",days:.375},comp:{label:"",days:1}},rz=()=>{const{isAdmin:e,isSubAdmin:t,user:r}=qr(),s=r?.user_id==="admin"||(e||t)&&r?.user_id!=="admin2",n=r?.user_id==="admin2",{pendingRequests:o,loading:l,approveLeaveRequest:u,rejectLeaveRequest:d,refresh:h}=Iv(),{pendingDocuments:m,labels:x,loading:y,approveDocument:b,rejectDocument:v,deleteDocument:g,addLabel:_,updateLabel:w,deleteLabel:S}=e5(),[N,E]=K.useState([]),[C,F]=K.useState("document"),[O,B]=K.useState("pending"),[L,H]=K.useState([]),[ue,A]=K.useState(""),[Y,I]=K.useState(null),[ae,Q]=K.useState(""),[re,ve]=K.useState(null),[te,ke]=K.useState(null),[Z,M]=K.useState(""),[J,V]=K.useState("#3B82F6"),[X,se]=K.useState(null),[P,U]=K.useState(""),[ce,ne]=K.useState(""),[ie,W]=K.useState("pending"),[G,k]=K.useState([]),[de,z]=K.useState([]),[T,R]=K.useState([]),[q,me]=K.useState(""),[_e,le]=K.useState(""),[Ae,Me]=K.useState(null),[Ee,Ce]=K.useState(""),[Je,$e]=K.useState(null),[tt,De]=K.useState(null),[ft,jt]=K.useState(null),[vt,At]=K.useState(""),[Rt,Le]=K.useState(null),[rt,ct]=K.useState(!1),[oe,Ne]=K.useState([]),[xe,je]=K.useState(0);if(!e&&!t)return a.jsx(el,{to:"/",replace:!0});K.useEffect(()=>{(async()=>{const{data:Ie}=await Pe.from("users").select("user_id, name, team, rank").order("name");Ie&&E(Ie);const{data:wt}=await Pe.from("documents").select("*, document_labels(*)").order("created_at",{ascending:!1});wt&&H(wt);const{data:yt}=await Pe.from("annual_leaves").select("*").eq("year",new Date().getFullYear());yt&&k(yt);const{data:Ut}=await Pe.from("leave_requests").select("*").in("status",["approved","rejected"]).order("updated_at",{ascending:!1});Ut&&z(Ut);const{data:Ur}=await Pe.from("documents").select("*, document_labels(*)").eq("document_labels.code",4).in("status",["approved","rejected"]).order("updated_at",{ascending:!1});Ur&&R(Ur.filter(ds=>ds.document_labels?.code===4))})()},[m,o]);const fe=pe=>N.find(Ie=>Ie.user_id===pe)||{name:pe,team:"",rank:""},Oe=pe=>G.find(Ie=>Ie.user_id===pe),Ue=async(pe,Ie="chairman")=>{ve(pe);const{error:wt}=await b(pe,Ie);ve(null),wt&&alert(" .")},st=pe=>(pe.expense_items||[]).reduce((Ie,wt)=>Ie+(Number(wt.amount)||0),0),pt=async pe=>{if(!ae.trim()){alert("  .");return}ve(pe);const{error:Ie}=await v(pe,ae);ve(null),I(null),Q(""),Ie&&alert(" .")},Nt=async pe=>{if(!confirm(" ?"))return;ve(pe);const{error:Ie}=await g(pe);if(ve(null),Ie){console.error("Delete document error:",Ie);const wt=typeof Ie=="string"?Ie:Ie.message||JSON.stringify(Ie);alert(" : "+wt)}else H(wt=>wt.filter(yt=>yt.id!==pe))},Vt=async()=>{if(!Z.trim()){alert("  .");return}const{error:pe}=await _(Z.trim(),J);pe?alert("  ."):(M(""),V("#3B82F6"))},yr=async pe=>{if(!P.trim()){alert("  .");return}const{error:Ie}=await w(pe,P.trim(),ce);Ie?alert("  ."):se(null)},_r=async pe=>{if(!confirm(" ?"))return;const{error:Ie}=await S(pe);Ie&&alert("  .")},zt=async pe=>{$e(pe);const{error:Ie}=await u(pe);$e(null),Ie&&alert(" .")},fr=async pe=>{if(!Ee.trim()){alert("  .");return}$e(pe);const{error:Ie}=await d(pe,Ee);$e(null),Me(null),Ce(""),Ie&&alert(" .")},Sr=async pe=>{if(!confirm(`${fe(pe.user_id).name}   ?${pe.status==="approved"?`
(  )`:""}`))return;if($e(pe.id),pe.status==="approved"){const{data:wt}=await Pe.from("annual_leaves").select("*").eq("user_id",pe.user_id).eq("year",new Date().getFullYear()).single();wt&&await Pe.from("annual_leaves").update({used_days:Math.max(0,wt.used_days-pe.days),updated_at:new Date().toISOString()}).eq("id",wt.id)}const{error:Ie}=await Pe.from("leave_requests").delete().eq("id",pe.id);if($e(null),Ie){console.error("Delete leave request error:",Ie);const wt=typeof Ie=="string"?Ie:Ie.message||JSON.stringify(Ie);alert(" : "+wt)}else z(wt=>wt.filter(yt=>yt.id!==pe.id)),h()},Zr=(pe,Ie)=>{jt(pe),At(Ie.toString())},he=async pe=>{const Ie=parseFloat(vt);if(isNaN(Ie)||Ie<0){alert("   .");return}Le(pe);const wt=G.find(yt=>yt.user_id===pe);if(wt){const{error:yt}=await Pe.from("annual_leaves").update({total_days:Ie,updated_at:new Date().toISOString()}).eq("id",wt.id);if(yt){alert(" ."),Le(null);return}}else{const{error:yt}=await Pe.from("annual_leaves").insert({user_id:pe,year:new Date().getFullYear(),total_days:Ie,used_days:0});if(yt){alert(" ."),Le(null);return}}k(wt?yt=>yt.map(Ut=>Ut.user_id===pe?{...Ut,total_days:Ie}:Ut):yt=>[...yt,{user_id:pe,year:new Date().getFullYear(),total_days:Ie,used_days:0}]),Le(null),jt(null)},we=pe=>new Date(pe).toLocaleDateString("ko-KR",{month:"short",day:"numeric",weekday:"short"}),ye=pe=>new Date(pe).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"/").replace(".",""),be=pe=>{switch(pe){case"approved":return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[a.jsx(Ws,{size:12}),""]});case"chairman_approved":return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium",children:[a.jsx(Ws,{size:12}),""]});case"rejected":return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[a.jsx(fo,{size:12}),""]});default:return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[a.jsx(Sn,{size:12}),""]})}},Se=pe=>pe==="approved"?a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[a.jsx(Ws,{size:12}),""]}):pe==="rejected"?a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[a.jsx(fo,{size:12}),""]}):a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[a.jsx(Sn,{size:12}),""]}),Te=L.filter(pe=>pe.document_labels?.code===4?!1:fe(pe.drafter_id).name?.toLowerCase().includes(ue.toLowerCase())||pe.title?.toLowerCase().includes(ue.toLowerCase())),We=N.filter(pe=>pe.name?.toLowerCase().includes(q.toLowerCase())||pe.team?.toLowerCase().includes(q.toLowerCase())),at=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899","#06B6D4","#6B7280"],qe=m.filter(pe=>pe.document_labels?.code===4),He=m.filter(pe=>pe.document_labels?.code!==4),Ke=He.length+o.length+qe.length,ht=pe=>{const Ie=pe.split(".").pop().toLowerCase();return["jpg","jpeg","png","gif","webp","bmp"].includes(Ie)},bt=(pe,Ie=0)=>{const wt=pe.filter(yt=>ht(yt.name));wt.length>0&&(Ne(wt),je(Ie),ct(!0))},Et=async pe=>{try{const wt=await(await fetch(pe.url)).blob(),yt=window.URL.createObjectURL(wt),Ut=document.createElement("a");Ut.href=yt,Ut.download=pe.name,document.body.appendChild(Ut),Ut.click(),window.URL.revokeObjectURL(yt),document.body.removeChild(Ut)}catch(Ie){console.error("Download failed:",Ie),window.open(pe.url,"_blank")}},xt=async pe=>{for(const Ie of pe)await Et(Ie),await new Promise(wt=>setTimeout(wt,500))};return a.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[a.jsxs(Vs,{to:"/",className:"inline-flex items-center gap-2 text-toss-gray-500 hover:text-toss-gray-700 transition-colors",children:[a.jsx(sf,{size:20})," "]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl flex items-center justify-center",children:a.jsx(_l,{className:"text-white",size:28})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:""}),a.jsxs("p",{className:"text-toss-gray-500",children:["  ",Ke>0&&a.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:[Ke," "]})]})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>F("document"),className:`flex-1 py-4 rounded-xl font-medium transition-all ${C==="document"?"bg-indigo-500 text-white":"bg-toss-gray-100 text-toss-gray-600 hover:bg-toss-gray-200"}`,children:[a.jsx(Gs,{size:20,className:"inline mr-2"})," ",He.length>0&&a.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${C==="document"?"bg-white/20":"bg-red-500 text-white"}`,children:He.length})]}),a.jsxs("button",{onClick:()=>F("leave"),className:`flex-1 py-4 rounded-xl font-medium transition-all ${C==="leave"?"bg-purple-500 text-white":"bg-toss-gray-100 text-toss-gray-600 hover:bg-toss-gray-200"}`,children:[a.jsx(ma,{size:20,className:"inline mr-2"})," ",o.length+qe.length>0&&a.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${C==="leave"?"bg-white/20":"bg-red-500 text-white"}`,children:o.length+qe.length})]})]}),C==="document"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex gap-2 border-b border-toss-gray-200",children:[a.jsxs("button",{onClick:()=>B("pending"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${O==="pending"?"border-indigo-500 text-indigo-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:[" ",He.length>0&&a.jsx("span",{className:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:He.length})]}),a.jsx("button",{onClick:()=>B("all"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${O==="all"?"border-indigo-500 text-indigo-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "}),a.jsx("button",{onClick:()=>B("labels"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${O==="labels"?"border-indigo-500 text-indigo-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "})]}),O==="pending"&&a.jsxs(_t,{children:[a.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(Sn,{className:"text-amber-500",size:20}),"  "]}),y?a.jsx("div",{className:"py-12 flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-indigo-500 border-t-transparent"})}):He.length===0?a.jsxs("div",{className:"py-12 text-center text-toss-gray-500",children:[a.jsx(Ws,{className:"mx-auto mb-3 text-emerald-400",size:48}),a.jsx("p",{children:"  "})]}):a.jsx("div",{className:"space-y-4",children:He.map(pe=>{const Ie=fe(pe.drafter_id),wt=Y===pe.id,yt=re===pe.id,Ut=st(pe),Ur=Ut>=1e6,ds=pe.status==="chairman_approved";return a.jsxs("div",{className:"p-5 bg-toss-gray-50 rounded-xl",children:[a.jsxs("div",{onClick:()=>ke({...pe,userInfo:Ie}),className:"cursor-pointer hover:bg-toss-gray-100 -mx-5 -mt-5 px-5 pt-5 pb-3 rounded-t-xl transition-colors",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[pe.document_labels&&a.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:pe.document_labels.color+"20",color:pe.document_labels.color},children:pe.document_labels.name}),ds&&a.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:""}),a.jsx("span",{className:"text-sm text-toss-gray-500",children:pe.doc_number})]}),a.jsx("p",{className:"font-bold text-toss-gray-900",children:pe.title})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-base font-semibold text-toss-gray-900",children:[Ie.name," ",a.jsx("span",{className:"font-normal text-toss-gray-600",children:Ie.rank})]}),a.jsx("p",{className:"text-sm text-toss-gray-500",children:Ie.team})]})]}),pe.content&&a.jsx("p",{className:"text-sm text-toss-gray-600 mb-3 line-clamp-2",children:pe.content}),Ut>0&&a.jsxs("p",{className:`text-sm font-medium mb-2 ${Ur?"text-orange-600":"text-indigo-600"}`,children:[": ",Ut.toLocaleString(),"",Ur&&" (  )"]}),pe.extra_work_hours>0&&a.jsxs("p",{className:"text-sm text-toss-blue mb-3",children:[": ",pe.extra_work_hours," ( ",(pe.extra_work_hours/8).toFixed(1),")"]}),pe.attendance_type==="leave"&&pe.leave_type&&a.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg mb-3",children:a.jsxs("p",{className:"text-sm text-emerald-700 font-medium",children:[Ko[pe.leave_type]?.label||pe.leave_type," ",a.jsxs("span",{className:"ml-2",children:[pe.leave_start_date===pe.leave_end_date?we(pe.leave_start_date):`${we(pe.leave_start_date)} ~ ${we(pe.leave_end_date)}`,pe.leave_days&&` (${pe.leave_days})`]})]})}),pe.attachments&&pe.attachments.length>0&&a.jsxs("div",{className:"mb-3",children:[a.jsxs("p",{className:"text-xs text-toss-gray-500 mb-2 flex items-center gap-1",children:[a.jsx(Hc,{size:12})," (",pe.attachments.length,")"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:pe.attachments.map((fs,Ga)=>{const So=ht(fs.name),Zs=pe.attachments.filter(Va=>ht(Va.name)).findIndex(Va=>Va.name===fs.name);return a.jsx("div",{className:"relative group",children:So?a.jsx("button",{onClick:Va=>{Va.stopPropagation(),bt(pe.attachments,Zs)},className:"w-16 h-16 rounded-lg overflow-hidden border border-toss-gray-200 hover:border-toss-blue transition-colors",children:a.jsx("img",{src:fs.url,alt:fs.name,className:"w-full h-full object-cover"})}):a.jsxs("a",{href:fs.url,target:"_blank",rel:"noopener noreferrer",onClick:Va=>Va.stopPropagation(),className:"flex items-center gap-1 px-2 py-1 bg-toss-gray-100 rounded-lg text-xs text-toss-gray-700 hover:bg-toss-gray-200 transition-colors",children:[a.jsx(Gs,{size:12}),a.jsx("span",{className:"max-w-[100px] truncate",children:fs.name})]})},Ga)})})]}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-toss-gray-400",children:[a.jsx(ra,{size:12}),new Date(pe.created_at).toLocaleString("ko-KR")," "]})]}),a.jsx("div",{className:"mt-4 pt-4 border-t border-toss-gray-200",children:wt?a.jsxs("div",{className:"space-y-3",children:[a.jsx("textarea",{value:ae,onChange:fs=>Q(fs.target.value),placeholder:"  ",rows:2,className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{onClick:()=>pt(pe.id),className:"flex-1 bg-red-500 hover:bg-red-600",loading:yt,disabled:yt,children:" "}),a.jsx(Ye,{onClick:()=>{I(null),Q("")},variant:"secondary",className:"flex-1",disabled:yt,children:""})]})]}):a.jsxs("div",{className:"flex gap-2",children:[Ur?a.jsxs(a.Fragment,{children:[!ds&&a.jsxs(Ye,{onClick:()=>Ue(pe.id,"chairman"),className:"flex-1 bg-blue-500 hover:bg-blue-600",loading:yt,disabled:yt,children:[a.jsx(Ws,{size:16,className:"mr-1"})," "]}),ds&&a.jsxs(Ye,{onClick:()=>Ue(pe.id,"director"),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:yt,disabled:yt,children:[a.jsx(Ws,{size:16,className:"mr-1"})," "]})]}):a.jsxs(Ye,{onClick:()=>Ue(pe.id,"chairman"),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:yt,disabled:yt,children:[a.jsx(Ws,{size:16,className:"mr-1"}),""]}),a.jsxs(Ye,{onClick:()=>I(pe.id),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",disabled:yt,children:[a.jsx(fo,{size:16,className:"mr-1"}),""]})]})})]},pe.id)})})]}),O==="all"&&a.jsxs(_t,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold text-toss-gray-900",children:" "}),a.jsxs("div",{className:"relative",children:[a.jsx(qa,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400",size:16}),a.jsx("input",{type:"text",value:ue,onChange:pe=>A(pe.target.value),placeholder:"   ",className:"pl-9 pr-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-toss-gray-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),a.jsx("tbody",{children:Te.map(pe=>{const Ie=fe(pe.drafter_id),wt=re===pe.id;return a.jsxs("tr",{onClick:()=>ke({...pe,userInfo:Ie}),className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:ye(pe.created_at)}),a.jsx("td",{className:"py-3 px-4",children:pe.document_labels&&a.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:pe.document_labels.color+"20",color:pe.document_labels.color},children:pe.document_labels.name})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("p",{className:"font-medium text-toss-gray-900 truncate max-w-xs",children:pe.title})}),a.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:Ie.name}),a.jsx("td",{className:"py-3 px-4 text-center",children:be(pe.status)}),a.jsx("td",{className:"py-3 px-4 text-center",onClick:yt=>yt.stopPropagation(),children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[pe.status==="approved"&&a.jsx("button",{onClick:()=>{const Ut=st(pe)>=1e6?"":"";Q1(pe,Ie,"",Ut)},className:"p-1.5 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:" PDF ",children:a.jsx(Gs,{size:18})}),a.jsx("button",{onClick:()=>Nt(pe.id),disabled:wt,className:"p-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"",children:wt?a.jsx("div",{className:"w-4 h-4 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}):a.jsx(Xt,{size:18})})]})})]},pe.id)})})]})})]}),O==="labels"&&a.jsxs(_t,{children:[a.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(Md,{className:"text-purple-500",size:20})," "]}),a.jsxs("div",{className:"p-4 bg-toss-gray-50 rounded-xl mb-6",children:[a.jsx("h3",{className:"font-medium text-toss-gray-900 mb-3",children:"  "}),a.jsxs("div",{className:"flex gap-3 items-end flex-wrap",children:[a.jsxs("div",{className:"flex-1 min-w-[200px]",children:[a.jsx("label",{className:"block text-sm text-toss-gray-500 mb-1",children:" "}),a.jsx("input",{type:"text",value:Z,onChange:pe=>M(pe.target.value),placeholder:" ",className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-toss-gray-500 mb-1",children:""}),a.jsx("div",{className:"flex gap-1",children:at.map(pe=>a.jsx("button",{onClick:()=>V(pe),className:`w-8 h-8 rounded-lg transition-all ${J===pe?"ring-2 ring-offset-2 ring-gray-400":""}`,style:{backgroundColor:pe}},pe))})]}),a.jsxs(Ye,{onClick:Vt,children:[a.jsx(os,{size:16,className:"mr-1"}),""]})]})]}),a.jsx("div",{className:"space-y-3",children:x.map(pe=>{const Ie=X===pe.id;return a.jsx("div",{className:"flex items-center justify-between p-4 bg-toss-gray-50 rounded-xl",children:Ie?a.jsxs("div",{className:"flex gap-3 items-center flex-1 flex-wrap",children:[a.jsx("input",{type:"text",value:P,onChange:wt=>U(wt.target.value),className:"flex-1 min-w-[150px] px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}),a.jsx("div",{className:"flex gap-1",children:at.map(wt=>a.jsx("button",{onClick:()=>ne(wt),className:`w-6 h-6 rounded transition-all ${ce===wt?"ring-2 ring-offset-1 ring-gray-400":""}`,style:{backgroundColor:wt}},wt))}),a.jsx("button",{onClick:()=>yr(pe.id),className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-lg",children:a.jsx(Fy,{size:18})}),a.jsx("button",{onClick:()=>se(null),className:"p-2 text-toss-gray-500 hover:bg-toss-gray-100 rounded-lg",children:a.jsx(mr,{size:18})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-sm text-toss-gray-500",children:pe.code}),a.jsx("span",{className:"px-3 py-1.5 rounded-full text-sm font-medium",style:{backgroundColor:pe.color+"20",color:pe.color},children:pe.name})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>{se(pe.id),U(pe.name),ne(pe.color)},className:"p-2 text-toss-gray-500 hover:bg-toss-gray-100 rounded-lg",children:a.jsx(Wc,{size:18})}),a.jsx("button",{onClick:()=>_r(pe.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg",children:a.jsx(Xt,{size:18})})]})]})},pe.id)})})]})]}),C==="leave"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex gap-2 border-b border-toss-gray-200",children:[a.jsxs("button",{onClick:()=>W("pending"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${ie==="pending"?"border-purple-500 text-purple-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:[" ",o.length+qe.length>0&&a.jsx("span",{className:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:o.length+qe.length})]}),a.jsx("button",{onClick:()=>W("history"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${ie==="history"?"border-purple-500 text-purple-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "}),a.jsx("button",{onClick:()=>W("overview"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${ie==="overview"?"border-purple-500 text-purple-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "})]}),ie==="pending"&&a.jsxs("div",{className:"space-y-6",children:[qe.length>0&&a.jsxs(_t,{children:[a.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(Gs,{className:"text-purple-500",size:20}),"   ",a.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 text-xs rounded-full",children:qe.length})]}),a.jsx("div",{className:"space-y-4",children:qe.map(pe=>{const Ie=fe(pe.drafter_id),wt=Y===pe.id,yt=re===pe.id,Ur=st(pe)>=1e6,ds=pe.status==="chairman_approved";return a.jsxs("div",{className:"p-5 bg-toss-gray-50 rounded-xl",children:[a.jsxs("div",{onClick:()=>ke({...pe,userInfo:Ie}),className:"cursor-pointer hover:bg-toss-gray-100 -mx-5 -mt-5 px-5 pt-5 pb-3 rounded-t-xl transition-colors",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[pe.document_labels&&a.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:pe.document_labels.color+"20",color:pe.document_labels.color},children:pe.document_labels.name}),pe.attendance_type&&a.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium ${pe.attendance_type==="overtime"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:pe.attendance_type==="overtime"?"":""}),ds&&a.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:""}),a.jsx("span",{className:"text-sm text-toss-gray-500",children:pe.doc_number})]}),a.jsx("p",{className:"font-bold text-toss-gray-900",children:pe.title})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-base font-semibold text-toss-gray-900",children:[Ie.name," ",a.jsx("span",{className:"font-normal text-toss-gray-600",children:Ie.rank})]}),a.jsx("p",{className:"text-sm text-toss-gray-500",children:Ie.team})]})]}),pe.leave_type&&a.jsxs("div",{className:"mb-3 p-3 bg-green-50 rounded-lg",children:[a.jsxs("p",{className:"text-sm text-green-800",children:[a.jsx("span",{className:"font-medium",children:" :"})," ",Ko[pe.leave_type]?.label||pe.leave_type]}),pe.leave_start_date&&a.jsxs("p",{className:"text-sm text-green-800",children:[a.jsx("span",{className:"font-medium",children:":"})," ",we(pe.leave_start_date),pe.leave_end_date&&pe.leave_start_date!==pe.leave_end_date&&a.jsxs(a.Fragment,{children:[" ~ ",we(pe.leave_end_date)]})]}),pe.leave_days&&a.jsxs("p",{className:"text-sm text-green-800",children:[a.jsx("span",{className:"font-medium",children:":"})," ",pe.leave_days,""]})]}),pe.content&&a.jsx("p",{className:"text-sm text-toss-gray-600 mb-3 line-clamp-2",children:pe.content}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-toss-gray-400",children:[a.jsx(ra,{size:12}),new Date(pe.created_at).toLocaleString("ko-KR")," "]})]}),wt?a.jsxs("div",{className:"space-y-3 mt-4",children:[a.jsx("textarea",{value:ae,onChange:fs=>Q(fs.target.value),placeholder:"  ",rows:2,className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{onClick:()=>pt(pe.id),className:"flex-1 bg-red-500 hover:bg-red-600",loading:yt,disabled:yt,children:" "}),a.jsx(Ye,{onClick:()=>{I(null),Q("")},variant:"secondary",className:"flex-1",disabled:yt,children:""})]})]}):a.jsxs("div",{className:"flex gap-2 mt-4",children:[Ur&&!ds&&s&&a.jsxs(Ye,{onClick:()=>Ue(pe.id,"chairman"),className:"flex-1 bg-blue-500 hover:bg-blue-600",loading:yt,disabled:yt,children:[a.jsx(Ws,{size:16,className:"mr-1"})," "]}),Ur&&ds&&n&&a.jsxs(Ye,{onClick:()=>Ue(pe.id,"director"),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:yt,disabled:yt,children:[a.jsx(Ws,{size:16,className:"mr-1"})," "]}),!Ur&&a.jsxs(Ye,{onClick:()=>Ue(pe.id,"chairman"),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:yt,disabled:yt,children:[a.jsx(Ws,{size:16,className:"mr-1"}),""]}),a.jsxs(Ye,{onClick:()=>I(pe.id),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",disabled:yt,children:[a.jsx(fo,{size:16,className:"mr-1"}),""]})]})]},pe.id)})})]}),a.jsxs(_t,{children:[a.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(Sn,{className:"text-amber-500",size:20}),"   ",o.length>0&&a.jsx("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 text-xs rounded-full",children:o.length})]}),l?a.jsx("div",{className:"py-12 flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-purple-500 border-t-transparent"})}):o.length===0?a.jsxs("div",{className:"py-12 text-center text-toss-gray-500",children:[a.jsx(Ws,{className:"mx-auto mb-3 text-emerald-400",size:48}),a.jsx("p",{children:"   "})]}):a.jsx("div",{className:"space-y-4",children:o.map(pe=>{const Ie=fe(pe.user_id),wt=Ae===pe.id,yt=Je===pe.id;return a.jsxs("div",{className:"p-5 bg-toss-gray-50 rounded-xl",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"text-lg font-bold text-toss-gray-900",children:[Ie.name,Ie.rank&&a.jsx("span",{className:"text-base font-normal text-toss-gray-600 ml-1",children:Ie.rank})]}),Ie.team&&a.jsx("p",{className:"text-sm text-toss-gray-500",children:Ie.team})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("span",{className:"px-3 py-1 bg-amber-100 text-amber-700 rounded-full text-sm font-medium",children:[pe.days,""]}),a.jsx("p",{className:"text-xs text-toss-gray-500 mt-1",children:Ko[pe.leave_type]?.label||pe.leave_type})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsxs("p",{className:"text-toss-gray-900",children:[we(pe.start_date),pe.start_date!==pe.end_date&&a.jsxs(a.Fragment,{children:[" ~ ",we(pe.end_date)]})]}),pe.reason&&a.jsxs("p",{className:"text-sm text-toss-gray-500 mt-1",children:[": ",pe.reason]})]}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-toss-gray-400 mb-4",children:[a.jsx(ra,{size:12}),new Date(pe.created_at).toLocaleString("ko-KR")," "]}),wt?a.jsxs("div",{className:"space-y-3",children:[a.jsx("textarea",{value:Ee,onChange:Ut=>Ce(Ut.target.value),placeholder:"  ",rows:2,className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ye,{onClick:()=>fr(pe.id),className:"flex-1 bg-red-500 hover:bg-red-600",loading:yt,disabled:yt,children:" "}),a.jsx(Ye,{onClick:()=>{Me(null),Ce("")},variant:"secondary",className:"flex-1",disabled:yt,children:""})]})]}):a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(Ye,{onClick:()=>zt(pe.id),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:yt,disabled:yt,children:[a.jsx(Ws,{size:16,className:"mr-1"}),""]}),a.jsxs(Ye,{onClick:()=>Me(pe.id),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",disabled:yt,children:[a.jsx(fo,{size:16,className:"mr-1"}),""]})]})]},pe.id)})})]})]}),ie==="history"&&a.jsxs(_t,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 flex items-center gap-2",children:[a.jsx(l4,{className:"text-purple-500",size:20})," "]}),a.jsxs("div",{className:"relative",children:[a.jsx(qa,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400",size:16}),a.jsx("input",{type:"text",value:_e,onChange:pe=>le(pe.target.value),placeholder:" ",className:"pl-9 pr-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),de.length===0&&T.length===0?a.jsxs("div",{className:"py-12 text-center text-toss-gray-500",children:[a.jsx(l4,{className:"mx-auto mb-3 text-toss-gray-300",size:48}),a.jsx("p",{children:"  "})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-toss-gray-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:"/"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),a.jsx("tbody",{children:[...de.map(pe=>({...pe,_type:"leave",_sortDate:new Date(pe.updated_at)})),...T.map(pe=>({...pe,_type:"document",_sortDate:new Date(pe.updated_at||pe.approved_at||pe.created_at)}))].sort((pe,Ie)=>Ie._sortDate-pe._sortDate).filter(pe=>{const Ie=pe._type==="leave"?pe.user_id:pe.drafter_id;return fe(Ie).name?.toLowerCase().includes(_e.toLowerCase())}).map(pe=>{if(pe._type==="leave"){const Ie=pe,wt=fe(Ie.user_id),yt=Je===Ie.id;return a.jsxs("tr",{onClick:()=>De({...Ie,userInfo:wt}),className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:ye(Ie.updated_at)}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx("p",{className:"text-sm font-medium text-toss-gray-900",children:wt.name}),wt.rank&&a.jsx("p",{className:"text-xs text-toss-gray-500",children:wt.rank})]}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full text-xs font-medium",children:""})}),a.jsxs("td",{className:"py-3 px-4 text-sm text-toss-gray-900",children:[Ko[Ie.leave_type]?.label,Ie.days&&a.jsxs("span",{className:"text-purple-600 ml-1",children:["(",Ie.days,")"]})]}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("p",{className:"text-sm text-toss-gray-900",children:[ye(Ie.start_date),Ie.start_date!==Ie.end_date&&a.jsxs(a.Fragment,{children:[" ~ ",ye(Ie.end_date)]})]})}),a.jsx("td",{className:"py-3 px-4 text-center",children:Se(Ie.status)}),a.jsx("td",{className:"py-3 px-4 text-center",onClick:Ut=>Ut.stopPropagation(),children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[Ie.status==="approved"&&a.jsx("button",{onClick:()=>FS(Ie,wt),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",title:" PDF ",children:a.jsx(Gs,{size:18})}),a.jsx("button",{onClick:()=>Sr(Ie),disabled:yt,className:"p-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"",children:yt?a.jsx("div",{className:"w-4 h-4 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}):a.jsx(Xt,{size:18})})]})})]},`leave-${Ie.id}`)}else{const Ie=pe,wt=fe(Ie.drafter_id),yt=re===Ie.id;return a.jsxs("tr",{onClick:()=>ke({...Ie,userInfo:wt}),className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 cursor-pointer",children:[a.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:ye(Ie.updated_at||Ie.approved_at||Ie.created_at)}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx("p",{className:"text-sm font-medium text-toss-gray-900",children:wt.name}),wt.rank&&a.jsx("p",{className:"text-xs text-toss-gray-500",children:wt.rank})]}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Ie.attendance_type==="overtime"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:Ie.attendance_type==="overtime"?"":""})}),a.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-900",children:Ie.attendance_type==="leave"?a.jsxs(a.Fragment,{children:[Ko[Ie.leave_type]?.label||Ie.leave_type,Ie.leave_days&&a.jsxs("span",{className:"text-purple-600 ml-1",children:["(",Ie.leave_days,")"]})]}):a.jsxs(a.Fragment,{children:[Ie.title,Ie.extra_work_hours>0&&a.jsxs("span",{className:"text-blue-600 ml-1",children:["(",Ie.extra_work_hours,")"]})]})}),a.jsx("td",{className:"py-3 px-4",children:Ie.leave_start_date?a.jsxs("p",{className:"text-sm text-toss-gray-900",children:[ye(Ie.leave_start_date),Ie.leave_start_date!==Ie.leave_end_date&&Ie.leave_end_date&&a.jsxs(a.Fragment,{children:[" ~ ",ye(Ie.leave_end_date)]})]}):a.jsx("span",{className:"text-sm text-toss-gray-400",children:"-"})}),a.jsx("td",{className:"py-3 px-4 text-center",children:be(Ie.status)}),a.jsx("td",{className:"py-3 px-4 text-center",onClick:Ut=>Ut.stopPropagation(),children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[Ie.status==="approved"&&a.jsx("button",{onClick:()=>{const Ur=st(Ie)>=1e6?"":"";Q1(Ie,wt,"",Ur)},className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",title:" PDF ",children:a.jsx(Gs,{size:18})}),a.jsx("button",{onClick:()=>Nt(Ie.id),disabled:yt,className:"p-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"",children:yt?a.jsx("div",{className:"w-4 h-4 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}):a.jsx(Xt,{size:18})})]})})]},`doc-${Ie.id}`)}})})]})})]}),ie==="overview"&&a.jsxs(_t,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 flex items-center gap-2",children:[a.jsx(Gc,{className:"text-purple-600",size:20}),"  "]}),a.jsxs("div",{className:"relative",children:[a.jsx(qa,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400",size:16}),a.jsx("input",{type:"text",value:q,onChange:pe=>me(pe.target.value),placeholder:"   ",className:"pl-9 pr-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-toss-gray-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:" "}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),a.jsx("tbody",{children:We.map(pe=>{const Ie=Oe(pe.user_id),wt=Ie?.total_days||15,yt=Ie?.used_days||0,Ut=wt-yt,Ur=ft===pe.user_id,ds=Rt===pe.user_id;return a.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50",children:[a.jsxs("td",{className:"py-3 px-4",children:[a.jsx("p",{className:"font-medium text-toss-gray-900",children:pe.name}),pe.rank&&a.jsx("p",{className:"text-xs text-toss-gray-500",children:pe.rank})]}),a.jsx("td",{className:"py-3 px-4 text-toss-gray-600",children:pe.team||"-"}),a.jsx("td",{className:"py-3 px-4 text-center",children:Ur?a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("input",{type:"number",value:vt,onChange:fs=>At(fs.target.value),step:"0.5",min:"0",className:"w-16 px-2 py-1 text-center bg-white border border-toss-gray-300 rounded-lg text-sm",autoFocus:!0}),a.jsx("button",{onClick:()=>he(pe.user_id),disabled:ds,className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded",children:ds?a.jsx("div",{className:"w-4 h-4 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin"}):a.jsx(Fy,{size:16})}),a.jsx("button",{onClick:()=>jt(null),disabled:ds,className:"p-1 text-toss-gray-500 hover:bg-toss-gray-100 rounded",children:a.jsx(mr,{size:16})})]}):a.jsxs("button",{onClick:()=>Zr(pe.user_id,wt),className:"inline-flex items-center gap-1 text-toss-gray-900 hover:text-purple-600 transition-colors group",children:[wt,"",a.jsx(Wc,{size:14,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})}),a.jsxs("td",{className:"py-3 px-4 text-center text-purple-600 font-medium",children:[yt,""]}),a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsxs("span",{className:`font-bold ${Ut<=3?"text-red-500":"text-emerald-600"}`,children:[Ut,""]})})]},pe.user_id)})})]})}),We.length===0&&a.jsx("div",{className:"py-12 text-center text-toss-gray-500",children:"  "})]})]}),te&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>ke(null),children:a.jsx("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:pe=>pe.stopPropagation(),children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:" "}),a.jsx("button",{onClick:()=>ke(null),className:"p-2 hover:bg-toss-gray-100 rounded-lg",children:a.jsx(mr,{size:20,className:"text-toss-gray-500"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[be(te.status),te.document_labels&&a.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:te.document_labels.color+"20",color:te.document_labels.color},children:te.document_labels.name})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsxs("p",{className:"font-bold text-toss-gray-900",children:[te.userInfo?.name,te.userInfo?.rank&&a.jsx("span",{className:"font-normal text-toss-gray-500 ml-1",children:te.userInfo.rank})]}),te.userInfo?.team&&a.jsx("p",{className:"text-sm text-toss-gray-500",children:te.userInfo.team})]}),te.doc_number&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"font-medium text-toss-gray-900",children:te.doc_number})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"font-bold text-toss-gray-900 text-lg",children:te.title})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:te.content||"( )"})]}),te.expense_items&&te.expense_items.length>0&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-2",children:""}),a.jsx("div",{className:"overflow-x-auto border border-toss-gray-200 rounded-lg",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-toss-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700",children:""}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700",children:""}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700",children:""}),a.jsx("th",{className:"px-3 py-2 text-right font-medium text-toss-gray-700",children:""}),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700",children:""})]})}),a.jsxs("tbody",{children:[te.expense_items.map((pe,Ie)=>a.jsxs("tr",{className:"border-t border-toss-gray-100",children:[a.jsx("td",{className:"px-3 py-2",children:pe.item}),a.jsx("td",{className:"px-3 py-2",children:pe.category}),a.jsx("td",{className:"px-3 py-2",children:pe.vendor}),a.jsxs("td",{className:"px-3 py-2 text-right",children:[Number(pe.amount).toLocaleString(),""]}),a.jsx("td",{className:"px-3 py-2",children:pe.note})]},Ie)),a.jsxs("tr",{className:"border-t-2 border-toss-gray-300 bg-toss-gray-50 font-medium",children:[a.jsx("td",{colSpan:3,className:"px-3 py-2 text-right",children:" "}),a.jsxs("td",{className:"px-3 py-2 text-right text-indigo-600",children:[te.expense_items.reduce((pe,Ie)=>pe+(Number(Ie.amount)||0),0).toLocaleString(),""]}),a.jsx("td",{})]})]})]})})]}),te.extra_work_hours>0&&a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsxs("p",{className:"text-sm text-toss-blue font-medium",children:[": ",te.extra_work_hours," ( ",(te.extra_work_hours/8).toFixed(1),")"]})}),te.attendance_type==="leave"&&te.leave_type&&a.jsxs("div",{className:"p-3 bg-emerald-50 rounded-lg",children:[a.jsxs("p",{className:"text-sm text-emerald-700 font-medium mb-1",children:[Ko[te.leave_type]?.label||te.leave_type," "]}),a.jsxs("p",{className:"text-sm text-emerald-600",children:[te.leave_start_date===te.leave_end_date?new Date(te.leave_start_date).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}):`${new Date(te.leave_start_date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})} ~ ${new Date(te.leave_end_date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})}`,te.leave_days&&` (${te.leave_days})`]})]}),te.attachments&&te.attachments.length>0&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("p",{className:"text-sm text-toss-gray-500 flex items-center gap-1",children:[a.jsx(Hc,{size:14})," (",te.attachments.length,")"]}),a.jsxs("button",{onClick:()=>xt(te.attachments),className:"flex items-center gap-1 text-xs text-toss-blue hover:underline",children:[a.jsx(Jr,{size:12})," "]})]}),a.jsxs("div",{className:"space-y-2",children:[te.attachments.filter(pe=>ht(pe.name)).length>0&&a.jsx("div",{className:"grid grid-cols-4 gap-2 mb-2",children:te.attachments.filter(pe=>ht(pe.name)).map((pe,Ie)=>a.jsxs("button",{onClick:()=>bt(te.attachments,Ie),className:"aspect-square rounded-lg overflow-hidden border border-toss-gray-200 hover:border-toss-blue transition-colors relative group",children:[a.jsx("img",{src:pe.url,alt:pe.name,className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center",children:a.jsx(XE,{size:20,className:"text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]},Ie))}),te.attachments.filter(pe=>!ht(pe.name)).map((pe,Ie)=>a.jsxs("div",{className:"flex items-center justify-between p-2 bg-toss-gray-50 rounded-lg",children:[a.jsxs("a",{href:pe.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-toss-gray-700 hover:text-toss-blue transition-colors flex-1 min-w-0",children:[a.jsx(Gs,{size:16,className:"flex-shrink-0"}),a.jsx("span",{className:"truncate",children:pe.name}),a.jsx(rl,{size:12,className:"flex-shrink-0"})]}),a.jsx("button",{onClick:()=>Et(pe),className:"p-1.5 text-toss-gray-500 hover:text-toss-blue hover:bg-toss-gray-100 rounded-lg transition-colors",children:a.jsx(Jr,{size:14})})]},Ie))]})]}),te.status==="rejected"&&te.rejected_reason&&a.jsxs("div",{className:"p-3 bg-red-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-red-600 font-medium mb-1",children:" "}),a.jsx("p",{className:"text-red-700",children:te.rejected_reason})]}),a.jsxs("div",{className:"pt-4 border-t border-toss-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500",children:[a.jsx(ra,{size:14}),new Date(te.created_at).toLocaleString("ko-KR")," "]}),te.approved_at&&a.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500 mt-1",children:[a.jsx(ra,{size:14}),new Date(te.approved_at).toLocaleString("ko-KR")," "]})]})]}),a.jsxs("div",{className:"mt-6 flex gap-2",children:[te.status==="approved"&&a.jsxs(Ye,{onClick:()=>{const Ie=st(te)>=1e6?"":"";Q1(te,te.userInfo,"",Ie)},className:"flex-1",children:[a.jsx(Gs,{size:16,className:"mr-1"}),"PDF "]}),a.jsx(Ye,{onClick:()=>ke(null),variant:"secondary",className:te.status==="approved"?"flex-1":"w-full",children:""})]})]})})}),tt&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>De(null),children:a.jsx("div",{className:"bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",onClick:pe=>pe.stopPropagation(),children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:" "}),a.jsx("button",{onClick:()=>De(null),className:"p-2 hover:bg-toss-gray-100 rounded-lg",children:a.jsx(mr,{size:20,className:"text-toss-gray-500"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex items-center gap-2",children:Se(tt.status)}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsxs("p",{className:"font-bold text-toss-gray-900",children:[tt.userInfo?.name,tt.userInfo?.rank&&a.jsx("span",{className:"font-normal text-toss-gray-500 ml-1",children:tt.userInfo.rank})]}),tt.userInfo?.team&&a.jsx("p",{className:"text-sm text-toss-gray-500",children:tt.userInfo.team})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:" "}),a.jsxs("p",{className:"font-medium text-toss-gray-900",children:[Ko[tt.leave_type]?.label||tt.leave_type,a.jsxs("span",{className:"text-purple-600 ml-2",children:["(",tt.days,")"]})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsxs("p",{className:"font-medium text-toss-gray-900",children:[we(tt.start_date),tt.start_date!==tt.end_date&&a.jsxs(a.Fragment,{children:[" ~ ",we(tt.end_date)]})]})]}),tt.reason&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:tt.reason})]}),tt.status==="rejected"&&tt.rejected_reason&&a.jsxs("div",{className:"p-3 bg-red-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-red-600 font-medium mb-1",children:" "}),a.jsx("p",{className:"text-red-700",children:tt.rejected_reason})]}),a.jsxs("div",{className:"pt-4 border-t border-toss-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500",children:[a.jsx(ra,{size:14}),new Date(tt.created_at).toLocaleString("ko-KR")," "]}),tt.updated_at&&tt.status!=="pending"&&a.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500 mt-1",children:[a.jsx(ra,{size:14}),new Date(tt.updated_at).toLocaleString("ko-KR")," "]})]})]}),a.jsxs("div",{className:"mt-6 flex gap-2",children:[tt.status==="approved"&&a.jsxs(Ye,{onClick:()=>FS(tt,tt.userInfo),className:"flex-1",children:[a.jsx(Gs,{size:16,className:"mr-1"}),"PDF "]}),a.jsx(Ye,{onClick:()=>De(null),variant:"secondary",className:"flex-1",children:""})]})]})})}),rt&&oe.length>0&&a.jsxs("div",{className:"fixed inset-0 bg-black/90 z-[60] flex items-center justify-center",onClick:()=>ct(!1),children:[a.jsx("button",{onClick:()=>ct(!1),className:"absolute top-4 right-4 p-2 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors z-10",children:a.jsx(mr,{size:28})}),a.jsx("button",{onClick:pe=>{pe.stopPropagation(),Et(oe[xe])},className:"absolute top-4 right-16 p-2 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors z-10",children:a.jsx(Jr,{size:24})}),oe.length>1&&a.jsx("button",{onClick:pe=>{pe.stopPropagation(),je(Ie=>Ie===0?oe.length-1:Ie-1)},className:"absolute left-4 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors",children:a.jsx(xa,{size:32})}),a.jsx("div",{className:"max-w-[90vw] max-h-[85vh]",onClick:pe=>pe.stopPropagation(),children:a.jsx("img",{src:oe[xe].url,alt:oe[xe].name,className:"max-w-full max-h-[85vh] object-contain"})}),oe.length>1&&a.jsx("button",{onClick:pe=>{pe.stopPropagation(),je(Ie=>Ie===oe.length-1?0:Ie+1)},className:"absolute right-4 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors",children:a.jsx(Js,{size:32})}),oe.length>1&&a.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 px-4 py-2 bg-black/50 rounded-full text-white text-sm",children:[xe+1," / ",oe.length]}),a.jsx("div",{className:"absolute bottom-4 left-4 px-3 py-1.5 bg-black/50 rounded-lg text-white/80 text-sm",children:oe[xe].name})]})]})},sz=/([A-Z]{2,4}[-_]?\d{3,5})/gi,ey="archive_labels",LS={forms:["","","",""],rescue:["","","",""]},az=()=>{const{type:e}=uE(),[t,r]=K.useState([]),[s,n]=K.useState([]),[o,l]=K.useState(!0),[u,d]=K.useState(!1),[h,m]=K.useState(""),[x,y]=K.useState(""),[b,v]=K.useState([]),[g,_]=K.useState([]),w=K.useRef(null),[S,N]=K.useState([]),[E,C]=K.useState(!1),[F,O]=K.useState(!1),[B,L]=K.useState(""),[H,ue]=K.useState(""),[A,Y]=K.useState([]);K.useEffect(()=>{const G=localStorage.getItem(ey);if(G){const k=JSON.parse(G);N(k[e]||LS[e]||[])}else N(LS[e]||[])},[e]);const I=G=>{const k=localStorage.getItem(ey),de=k?JSON.parse(k):{};de[e]=G,localStorage.setItem(ey,JSON.stringify(de)),N(G)},ae=async()=>{if(!B.trim())return;if(S.includes(B.trim())){alert("  .");return}const G=B.trim(),k=[...S,G];I(k);try{const de=re();await x4(`${de}/${G}`)}catch(de){console.error("  :",de)}L(""),te(x)},Q=G=>{if(!confirm(`"${G}"  ?
(Dropbox   )`))return;const k=S.filter(de=>de!==G);I(k)},re=()=>e==="forms"?"//":e==="rescue"?"//":"/",ve=()=>e==="forms"?"":e==="rescue"?"":"";K.useEffect(()=>{const G=re();y(G),v([G]),te(G)},[e]),K.useEffect(()=>{Z()},[h,t]);const te=async G=>{l(!0);try{const de=(await F9(G)).sort((z,T)=>z.isFolder&&!T.isFolder?-1:!z.isFolder&&T.isFolder?1:z.name.localeCompare(T.name,"ko"));r(de),ke(de)}catch(k){console.error("   :",k),r([])}finally{l(!1)}},ke=G=>{const k=[];G.forEach(de=>{if(!de.isFolder){const z=de.name.match(sz);z&&z.forEach(T=>{k.push({documentNumber:T.toUpperCase(),fileName:de.name,path:de.path})})}}),_(k)},Z=()=>{if(!h.trim()){n(t);return}const G=h.toLowerCase().trim(),k=g.filter(de=>de.documentNumber.toLowerCase().includes(G));if(k.length>0){const de=new Set(k.map(T=>T.path)),z=t.filter(T=>de.has(T.path));n(z)}else{const de=t.filter(z=>z.name.toLowerCase().includes(G));n(de)}},M=G=>{const k=G.path;v(de=>[...de,k]),y(k),te(k),m("")},J=()=>{if(b.length>1){const G=[...b];G.pop();const k=G[G.length-1];v(G),y(k),te(k),m("")}},V=async G=>{try{const k=await L9(G.path);window.open(k,"_blank")}catch(k){console.error(" :",k),alert("  .")}},X=G=>{const k=Array.from(G.target.files);k.length!==0&&(Y(k),ue(""),O(!0),w.current&&(w.current.value=""))},se=async()=>{if(A.length===0)return;const G=H?`${re()}/${H}`:x;d(!0),O(!1);try{H&&await x4(G);for(const k of A)await I9(k,G);alert(`${A.length}  .`),H&&x!==G&&(y(G),v(k=>[...k,G])),te(G)}catch(k){console.error(" :",k),alert("  : "+k.message)}finally{d(!1),Y([])}},P=async G=>{if(confirm(`"${G.name}"() ?`))try{await O9(G.path),alert("."),te(x)}catch(k){console.error(" :",k),alert("  .")}},U=()=>{te(x)},ce=G=>{if(G.isFolder)return a.jsx(tF,{size:20,className:"text-yellow-500"});const k=G.name.split(".").pop().toLowerCase();return["xlsx","xls","csv"].includes(k)?a.jsx(im,{size:20,className:"text-green-600"}):a.jsx(Ea,{size:20,className:"text-toss-gray-500"})},ne=G=>G?G<1024?G+" B":G<1024*1024?(G/1024).toFixed(1)+" KB":(G/(1024*1024)).toFixed(1)+" MB":"-",ie=()=>x===re()?ve():x.split("/").pop()||ve(),W=()=>{const G=re();if(x===G)return[];const de=x.replace(G,"").split("/").filter(Boolean);return de.map((z,T)=>{const R=G+"/"+de.slice(0,T+1).join("/");return{name:z,path:R}})};return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-amber-500 to-orange-500 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(Q7,{size:24})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-1",children:ve()}),a.jsx("p",{className:"text-white/90",children:"    "})]})]})}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[b.length>1&&a.jsx("button",{onClick:J,className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",title:" ",children:a.jsx(sf,{size:20})}),a.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:ie()})]}),a.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[a.jsxs("div",{className:"relative flex-1 sm:w-64",children:[a.jsx(qa,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),a.jsx("input",{type:"text",value:h,onChange:G=>m(G.target.value),placeholder:"...",className:"w-full pl-10 pr-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all"})]}),a.jsx("input",{type:"file",ref:w,multiple:!0,onChange:X,className:"hidden"}),a.jsxs(Ye,{onClick:()=>w.current?.click(),disabled:u,className:"whitespace-nowrap",children:[u?a.jsx(il,{size:18,className:"animate-spin"}):a.jsx(os,{size:18}),u?" ...":" "]}),a.jsx("button",{onClick:()=>C(!0),className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",title:" ",children:a.jsx(_l,{size:20})}),a.jsx("button",{onClick:U,className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"",children:a.jsx(il,{size:20,className:o?"animate-spin":""})})]})]}),W().length>0&&a.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-600 overflow-x-auto",children:[a.jsx("button",{onClick:()=>{const G=re();y(G),v([G]),te(G)},className:"hover:text-toss-blue transition-colors whitespace-nowrap",children:ve()}),W().map(G=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Js,{size:14,className:"text-toss-gray-400"}),a.jsx("button",{onClick:()=>{y(G.path),v(k=>k.slice(0,k.indexOf(G.path)+1)||[G.path]),te(G.path)},className:"hover:text-toss-blue transition-colors whitespace-nowrap",children:G.name})]},G.path))]}),a.jsx(_t,{padding:"p-0",children:o?a.jsxs("div",{className:"text-center text-toss-gray-500 py-12",children:[a.jsx(il,{size:24,className:"animate-spin mx-auto mb-2"})," ..."]}):s.length>0?a.jsx("div",{className:"divide-y divide-toss-gray-100",children:s.map(G=>a.jsxs("div",{className:`flex items-center justify-between p-4 hover:bg-toss-gray-50 transition-colors ${G.isFolder?"cursor-pointer":""}`,onClick:()=>G.isFolder&&M(G),children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[ce(G),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"font-medium text-toss-gray-900 truncate",children:G.name}),!G.isFolder&&a.jsx("p",{className:"text-xs text-toss-gray-500",children:ne(G.size)})]})]}),G.isFolder?a.jsx(Js,{size:20,className:"text-toss-gray-400"}):a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:k=>{k.stopPropagation(),V(G)},className:"p-2 text-toss-blue hover:bg-toss-blue/10 rounded-lg transition-colors",title:"",children:a.jsx(Jr,{size:18})}),a.jsx("button",{onClick:k=>{k.stopPropagation(),P(G)},className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"",children:a.jsx(Xt,{size:18})})]})]},G.id||G.path))}):a.jsx("div",{className:"text-center text-toss-gray-500 py-12",children:h?"  ":"   "})}),g.length>0&&!h&&a.jsxs("p",{className:"text-sm text-toss-gray-500 text-center",children:[g.length,"  "]}),a.jsx(cr,{isOpen:E,onClose:()=>C(!1),title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm text-toss-gray-600",children:"  Dropbox     ."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:B,onChange:G=>L(G.target.value),placeholder:"  ",className:"flex-1 px-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent",onKeyDown:G=>G.key==="Enter"&&ae()}),a.jsxs(Ye,{onClick:ae,children:[a.jsx(os,{size:18}),""]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"text-sm font-medium text-toss-gray-700",children:" "}),S.length>0?a.jsx("div",{className:"flex flex-wrap gap-2",children:S.map(G=>a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-toss-gray-100 rounded-full",children:[a.jsx(Md,{size:14,className:"text-toss-gray-500"}),a.jsx("span",{className:"text-sm text-toss-gray-700",children:G}),a.jsx("button",{onClick:()=>Q(G),className:"p-0.5 hover:bg-toss-gray-200 rounded-full transition-colors",children:a.jsx(mr,{size:14,className:"text-toss-gray-500"})})]},G))}):a.jsx("p",{className:"text-sm text-toss-gray-500",children:"  ."})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx(Ye,{variant:"secondary",onClick:()=>C(!1),children:""})})]})}),a.jsx(cr,{isOpen:F,onClose:()=>{O(!1),Y([])},title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm text-toss-gray-600 mb-2",children:[" : ",a.jsxs("span",{className:"font-medium",children:[A.length,""]})]}),a.jsx("div",{className:"max-h-32 overflow-y-auto bg-toss-gray-50 rounded-xl p-3",children:A.map((G,k)=>a.jsx("p",{className:"text-sm text-toss-gray-700 truncate",children:G.name},k))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  ()"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>ue(""),className:`px-4 py-2 rounded-xl text-sm font-medium transition-colors ${H===""?"bg-toss-blue text-white":"bg-toss-gray-100 text-toss-gray-700 hover:bg-toss-gray-200"}`,children:"  "}),S.map(G=>a.jsxs("button",{onClick:()=>ue(G),className:`flex items-center gap-1.5 px-4 py-2 rounded-xl text-sm font-medium transition-colors ${H===G?"bg-toss-blue text-white":"bg-toss-gray-100 text-toss-gray-700 hover:bg-toss-gray-200"}`,children:[a.jsx(Md,{size:14}),G]},G))]}),H&&a.jsxs("p",{className:"mt-2 text-xs text-toss-gray-500",children:[' "',re(),"/",H,'"  .']})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{O(!1),Y([])},children:""}),a.jsx(Ye,{onClick:se,children:""})]})]})})]})};function nz(){const{profile:e,isAdmin:t,isSubAdmin:r}=qr(),[s,n]=K.useState([]),[o,l]=K.useState([]),[u,d]=K.useState(null),[h,m]=K.useState(!1),[x,y]=K.useState(null),b=K.useCallback(async()=>{try{m(!0);const{data:F,error:O}=await Pe.from("document_ledger_labels").select("*").order("created_at",{ascending:!0});if(O)throw O;if(n(F||[]),F&&F.length>0&&!u){const B=F.find(L=>L.name===e?.team);d(B||F[0])}}catch(F){y(F.message),console.error("  :",F)}finally{m(!1)}},[u,e?.team]),v=async F=>{try{m(!0);const{data:O,error:B}=await Pe.from("document_ledger_labels").insert([{name:F}]).select().single();if(B)throw B;return n(L=>[...L,O]),{success:!0,data:O}}catch(O){return y(O.message),console.error("  :",O),{success:!1,error:O.message}}finally{m(!1)}},g=async(F,O)=>{try{m(!0);const{data:B,error:L}=await Pe.from("document_ledger_labels").update({name:O}).eq("id",F).select().single();if(L)throw L;return n(H=>H.map(ue=>ue.id===F?B:ue)),u?.id===F&&d(B),{success:!0,data:B}}catch(B){return y(B.message),console.error("  :",B),{success:!1,error:B.message}}finally{m(!1)}},_=async F=>{try{m(!0);const{error:O}=await Pe.from("document_ledger_labels").delete().eq("id",F);if(O)throw O;if(n(B=>B.filter(L=>L.id!==F)),u?.id===F){const B=s.filter(L=>L.id!==F);d(B.length>0?B[0]:null)}return{success:!0}}catch(O){return y(O.message),console.error("  :",O),{success:!1,error:O.message}}finally{m(!1)}},w=K.useCallback(async F=>{if(F)try{m(!0);const{data:O,error:B}=await Pe.from("document_ledger").select("*").eq("label_id",F).order("row_number",{ascending:!0});if(B)throw B;l(O||[])}catch(O){y(O.message),console.error("   :",O)}finally{m(!1)}},[]),S=async F=>{try{m(!0);const{data:O,error:B}=await Pe.from("document_ledger").insert([F]).select().single();if(B)throw B;return l(L=>[...L,O].sort((H,ue)=>H.row_number-ue.row_number)),{success:!0,data:O}}catch(O){return y(O.message),console.error("  :",O),{success:!1,error:O.message}}finally{m(!1)}},N=async(F,O)=>{try{m(!0);const{data:B,error:L}=await Pe.from("document_ledger").update(O).eq("id",F).select().single();if(L)throw L;return l(H=>H.map(ue=>ue.id===F?B:ue)),{success:!0,data:B}}catch(B){return y(B.message),console.error("  :",B),{success:!1,error:B.message}}finally{m(!1)}},E=async F=>{try{m(!0);const{error:O}=await Pe.from("document_ledger").delete().eq("id",F);if(O)throw O;const B=o.filter(H=>H.id!==F).sort((H,ue)=>H.row_number-ue.row_number),L=B.map((H,ue)=>({id:H.id,row_number:ue+1}));for(const H of L)H.row_number!==B.find(ue=>ue.id===H.id)?.row_number&&await Pe.from("document_ledger").update({row_number:H.row_number}).eq("id",H.id);return l(B.map((H,ue)=>({...H,row_number:ue+1}))),{success:!0}}catch(O){return y(O.message),console.error("  :",O),{success:!1,error:O.message}}finally{m(!1)}},C=()=>o.length===0?1:Math.max(...o.map(F=>F.row_number))+1;return K.useEffect(()=>{e&&b()},[e?.team,t,r]),K.useEffect(()=>{u?.id&&w(u.id)},[u?.id,w]),{labels:s,ledgerData:o,selectedLabel:u,loading:h,error:x,setSelectedLabel:d,addLabel:v,updateLabel:g,deleteLabel:_,fetchLabels:b,fetchLedgerData:w,addLedgerItem:S,updateLedgerItem:N,deleteLedgerItem:E,getNextRowNumber:C}}var U0={};U0.version="0.18.5";var t5=1252,iz=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Mv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Bv=function(e){iz.indexOf(e)!=-1&&(t5=Mv[0]=e)};function oz(){Bv(1252)}var En=function(e){Bv(e)};function Pv(){En(1200),oz()}function IS(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function lz(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function r5(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var fd=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?lz(e.slice(2)):t==254&&r==255?r5(e.slice(2)):t==65279?e.slice(1):e},Zh=function(t){return String.fromCharCode(t)},MS=function(t){return String.fromCharCode(t)},Ud,ho="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function zd(e){for(var t="",r=0,s=0,n=0,o=0,l=0,u=0,d=0,h=0;h<e.length;)r=e.charCodeAt(h++),o=r>>2,s=e.charCodeAt(h++),l=(r&3)<<4|s>>4,n=e.charCodeAt(h++),u=(s&15)<<2|n>>6,d=n&63,isNaN(s)?u=d=64:isNaN(n)&&(d=64),t+=ho.charAt(o)+ho.charAt(l)+ho.charAt(u)+ho.charAt(d);return t}function Ha(e){var t="",r=0,s=0,n=0,o=0,l=0,u=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=ho.indexOf(e.charAt(h++)),l=ho.indexOf(e.charAt(h++)),r=o<<2|l>>4,t+=String.fromCharCode(r),u=ho.indexOf(e.charAt(h++)),s=(l&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(s)),d=ho.indexOf(e.charAt(h++)),n=(u&3)<<6|d,d!==64&&(t+=String.fromCharCode(n));return t}var ar=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Oi=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function po(e){return ar?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function BS(e){return ar?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var za=function(t){return ar?Oi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function vm(e){if(typeof ArrayBuffer>"u")return za(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function _o(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function cz(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Uv(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Uv(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Is=ar?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Oi(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function uz(e){for(var t=[],r=0,s=e.length+250,n=po(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=e.charCodeAt(++o)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|u>>6&15|(l&3)<<4,n[r++]=128|u&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>s&&(t.push(n.slice(0,r)),r=0,n=po(65535),s=65530)}return t.push(n.slice(0,r)),Is(t)}var pa=/\u0000/g,hd=/[\u0001-\u0006]/g;function Pc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function jn(e,t){var r=""+e;return r.length>=t?r:is("0",t-r.length)+r}function zv(e,t){var r=""+e;return r.length>=t?r:is(" ",t-r.length)+r}function z0(e,t){var r=""+e;return r.length>=t?r:r+is(" ",t-r.length)}function dz(e,t){var r=""+Math.round(e);return r.length>=t?r:is("0",t-r.length)+r}function fz(e,t){var r=""+e;return r.length>=t?r:is("0",t-r.length)+r}var PS=Math.pow(2,32);function wc(e,t){if(e>PS||e<-PS)return dz(e,t);var r=Math.round(e);return fz(r,t)}function $0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var US=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ty=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function hz(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Wt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},zS={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},mz={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function q0(e,t,r){for(var s=e<0?-1:1,n=e*s,o=0,l=1,u=0,d=1,h=0,m=0,x=Math.floor(n);h<t&&(x=Math.floor(n),u=x*l+o,m=x*h+d,!(n-x<5e-8));)n=1/(n-x),o=l,l=u,d=h,h=m;if(m>t&&(h>t?(m=d,u=o):(m=h,u=l)),!r)return[0,s*u,m];var y=Math.floor(s*u/m);return[y,s*u-y*m,m]}function nl(e,t,r){if(e>2958465||e<0)return null;var s=e|0,n=Math.floor(86400*(e-s)),o=0,l=[],u={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(s+=1462),u.u>.9999&&(u.u=0,++n==86400&&(u.T=n=0,++s,++u.D)),s===60)l=r?[1317,10,29]:[1900,2,29],o=3;else if(s===0)l=r?[1317,8,29]:[1900,1,0],o=6;else{s>60&&--s;var d=new Date(1900,0,1);d.setDate(d.getDate()+s-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],o=d.getDay(),s<60&&(o=(o+6)%7),r&&(o=bz(d,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=n%60,n=Math.floor(n/60),u.M=n%60,n=Math.floor(n/60),u.H=n,u.q=o,u}var s5=new Date(1899,11,31,0,0,0),pz=s5.getTime(),xz=new Date(1900,2,1,0,0,0);function a5(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=xz&&(r+=1440*60*1e3),(r-(pz+(e.getTimezoneOffset()-s5.getTimezoneOffset())*6e4))/(1440*60*1e3)}function $v(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function gz(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yz(e){var t=e<0?12:11,r=$v(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function vz(e){var t=$v(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function $d(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=yz(e):t===10?r=e.toFixed(10).substr(0,12):r=vz(e),$v(gz(r.toUpperCase()))}function pl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):$d(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return mn(14,a5(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function bz(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function wz(e,t,r,s){var n="",o=0,l=0,u=r.y,d,h=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:d=u%100,h=2;break;default:d=u%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,h=t.length;break;case 3:return ty[r.m-1][1];case 5:return ty[r.m-1][0];default:return ty[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,h=t.length;break;case 3:return US[r.q][0];default:return US[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?jn(r.S,t.length):(s>=2?l=s===3?1e3:100:l=s===1?10:1,o=Math.round(l*(r.S+r.u)),o>=60*l&&(o=0),t==="s"?o===0?"0":""+o/l:(n=jn(o,2+s),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:d=u,h=1;break}var m=h>0?jn(d,h):"";return m}function mo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var n5=/%/g;function _z(e,t,r){var s=t.replace(n5,""),n=t.length-s.length;return wi(e,s,r*Math.pow(10,2*n))+is("%",n)}function Nz(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return wi(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function i5(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+i5(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%n;if(o<0&&(o+=n),r=(t/Math.pow(10,o)).toPrecision(s+1+(n+o)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,h,m){return d+h+m.substr(0,(n+o)%n)+"."+m.substr(o)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var o5=/# (\?+)( ?)\/( ?)(\d+)/;function kz(e,t,r){var s=parseInt(e[4],10),n=Math.round(t*s),o=Math.floor(n/s),l=n-o*s,u=s;return r+(o===0?"":""+o)+" "+(l===0?is(" ",e[1].length+1+e[4].length):zv(l,e[1].length)+e[2]+"/"+e[3]+jn(u,e[4].length))}function Sz(e,t,r){return r+(t===0?"":""+t)+is(" ",e[1].length+2+e[4].length)}var l5=/^#*0*\.([0#]+)/,c5=/\).*[0#]/,u5=/\(###\) ###\\?-####/;function fa(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function $S(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function qS(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function Ez(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function jz(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function on(e,t,r){if(e.charCodeAt(0)===40&&!t.match(c5)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?on("n",s,r):"("+on("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Nz(e,t,r);if(t.indexOf("%")!==-1)return _z(e,t,r);if(t.indexOf("E")!==-1)return i5(t,r);if(t.charCodeAt(0)===36)return"$"+on(e,t.substr(t.charAt(1)==" "?2:1),r);var n,o,l,u,d=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+wc(d,t.length);if(t.match(/^[#?]+$/))return n=wc(r,0),n==="0"&&(n=""),n.length>t.length?n:fa(t.substr(0,t.length-n.length))+n;if(o=t.match(o5))return kz(o,d,h);if(t.match(/^#+0+$/))return h+wc(d,t.length-t.indexOf("0"));if(o=t.match(l5))return n=$S(r,o[1].length).replace(/^([^\.]+)$/,"$1."+fa(o[1])).replace(/\.$/,"."+fa(o[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+is("0",fa(o[1]).length-g.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return h+$S(d,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return h+mo(wc(d,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+on(e,t,-r):mo(""+(Math.floor(r)+Ez(r,o[1].length)))+"."+jn(qS(r,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return on(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Pc(on(e,t.replace(/[\\-]/g,""),r)),l=0,Pc(Pc(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return l<n.length?n.charAt(l++):v==="0"?"0":""}));if(t.match(u5))return n=on(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=q0(d,Math.pow(10,l)-1,!1),n=""+h,m=wi("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+o[2]+"/"+o[3],m=z0(u[2],l),m.length<o[4].length&&(m=fa(o[4].substr(o[4].length-m.length))+m),n+=m,n;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=q0(d,Math.pow(10,l)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?zv(u[1],l)+o[2]+"/"+o[3]+z0(u[2],l):is(" ",2*l+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return n=wc(r,0),t.length<=n.length?n:fa(t.substr(0,t.length-n.length))+n;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var x=t.indexOf(".")-l,y=t.length-n.length-x;return fa(t.substr(0,x)+n+t.substr(t.length-y))}if(o=t.match(/^00,000\.([#0]*0)$/))return l=qS(r,o[1].length),r<0?"-"+on(e,t,-r):mo(jz(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?jn(0,3-v.length):"")+v})+"."+jn(l,o[1].length);switch(t){case"###,##0.00":return on(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var b=mo(wc(d,0));return b!=="0"?h+b:"";case"###,###.00":return on(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return on(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Tz(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return wi(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function Az(e,t,r){var s=t.replace(n5,""),n=t.length-s.length;return wi(e,s,r*Math.pow(10,2*n))+is("%",n)}function d5(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+d5(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%n;if(o<0&&(o+=n),r=(t/Math.pow(10,o)).toPrecision(s+1+(n+o)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,h,m){return d+h+m.substr(0,(n+o)%n)+"."+m.substr(o)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Mn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(c5)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Mn("n",s,r):"("+Mn("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Tz(e,t,r);if(t.indexOf("%")!==-1)return Az(e,t,r);if(t.indexOf("E")!==-1)return d5(t,r);if(t.charCodeAt(0)===36)return"$"+Mn(e,t.substr(t.charAt(1)==" "?2:1),r);var n,o,l,u,d=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+jn(d,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:fa(t.substr(0,t.length-n.length))+n;if(o=t.match(o5))return Sz(o,d,h);if(t.match(/^#+0+$/))return h+jn(d,t.length-t.indexOf("0"));if(o=t.match(l5))return n=(""+r).replace(/^([^\.]+)$/,"$1."+fa(o[1])).replace(/\.$/,"."+fa(o[1])),n=n.replace(/\.(\d*)$/,function(v,g){return"."+g+is("0",fa(o[1]).length-g.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return h+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return h+mo(""+d);if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Mn(e,t,-r):mo(""+r)+"."+is("0",o[1].length);if(o=t.match(/^#,#*,#0/))return Mn(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Pc(Mn(e,t.replace(/[\\-]/g,""),r)),l=0,Pc(Pc(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return l<n.length?n.charAt(l++):v==="0"?"0":""}));if(t.match(u5))return n=Mn(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=q0(d,Math.pow(10,l)-1,!1),n=""+h,m=wi("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+o[2]+"/"+o[3],m=z0(u[2],l),m.length<o[4].length&&(m=fa(o[4].substr(o[4].length-m.length))+m),n+=m,n;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=q0(d,Math.pow(10,l)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?zv(u[1],l)+o[2]+"/"+o[3]+z0(u[2],l):is(" ",2*l+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:fa(t.substr(0,t.length-n.length))+n;if(o=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var x=t.indexOf(".")-l,y=t.length-n.length-x;return fa(t.substr(0,x)+n+t.substr(t.length-y))}if(o=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Mn(e,t,-r):mo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?jn(0,3-v.length):"")+v})+"."+jn(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var b=mo(""+d);return b!=="0"?h+b:"";default:if(t.match(/\.[0#?]*$/))return Mn(e,t.slice(0,t.lastIndexOf(".")),r)+fa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function wi(e,t,r){return(r|0)===r?Mn(e,t,r):on(e,t,r)}function Cz(e){for(var t=[],r=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(n,s-n),n=s+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var f5=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function iu(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":$0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(f5))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Rz(e,t,r,s){for(var n=[],o="",l=0,u="",d="t",h,m,x,y="H";l<e.length;)switch(u=e.charAt(l)){case"G":if(!$0(e,l))throw new Error("unrecognized character "+u+" in "+e);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(x=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(x);n[n.length]={t:"t",v:o},++l;break;case"\\":var b=e.charAt(++l),v=b==="("||b===")"?b:"t";n[n.length]={t:v,v:b},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(h==null&&(h=nl(t,r,e.charAt(l+1)==="2"),h==null))return"";n[n.length]={t:"X",v:e.substr(l,2)},d=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=nl(t,r),h==null))return"";for(o=u;++l<e.length&&e.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&d.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),n[n.length]={t:u,v:o},d=u;break;case"A":case"a":case"":var g={t:u,v:u};if(h==null&&(h=nl(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(h!=null&&(g.v=h.H>=12?"P":"A"),g.t="T",y="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(h!=null&&(g.v=h.H>=12?"PM":"AM"),g.t="T",l+=5,y="h"):e.substr(l,5).toUpperCase()==="/"?(h!=null&&(g.v=h.H>=12?"":""),g.t="T",l+=5,y="h"):(g.t="t",++l),h==null&&g.t==="T")return"";n[n.length]=g,d=u;break;case"[":for(o=u;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(f5)){if(h==null&&(h=nl(t,r),h==null))return"";n[n.length]={t:"Z",v:o.toLowerCase()},d=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",iu(e)||(n[n.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=u;++l<e.length&&(u=e.charAt(l))==="0";)o+=u;n[n.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(l))>-1;)o+=u;n[n.length]={t:"n",v:o};break;case"?":for(o=u;e.charAt(++l)===u;)o+=u;n[n.length]={t:u,v:o},d=u;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:s===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);n[n.length]={t:"D",v:o};break;case" ":n[n.length]={t:u,v:u},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);n[n.length]={t:"t",v:u},++l;break}var _=0,w=0,S;for(l=n.length-1,d="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=y,d="h",_<1&&(_=1);break;case"s":(S=n[l].v.match(/\.0+$/))&&(w=Math.max(w,S[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":d=n[l].t;break;case"m":d==="s"&&(n[l].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&n[l].v.match(/[Hh]/)&&(_=1),_<2&&n[l].v.match(/[Mm]/)&&(_=2),_<3&&n[l].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var N="",E;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=wz(n[l].t.charCodeAt(0),n[l].v,h,w),n[l].t="t";break;case"n":case"?":for(E=l+1;n[E]!=null&&((u=n[E].t)==="?"||u==="D"||(u===" "||u==="t")&&n[E+1]!=null&&(n[E+1].t==="?"||n[E+1].t==="t"&&n[E+1].v==="/")||n[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(n[E].v==="/"||n[E].v===" "&&n[E+1]!=null&&n[E+1].t=="?"));)n[l].v+=n[E].v,n[E]={v:"",t:";"},++E;N+=n[l].v,l=E-1;break;case"G":n[l].t="t",n[l].v=pl(t,r);break}var C="",F,O;if(N.length>0){N.charCodeAt(0)==40?(F=t<0&&N.charCodeAt(0)===45?-t:t,O=wi("n",N,F)):(F=t<0&&s>1?-t:t,O=wi("n",N,F),F<0&&n[0]&&n[0].t=="t"&&(O=O.substr(1),n[0].v="-"+n[0].v)),E=O.length-1;var B=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){B=l;break}var L=n.length;if(B===n.length&&O.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(E>=n[l].v.length-1?(E-=n[l].v.length,n[l].v=O.substr(E+1,n[l].v.length)):E<0?n[l].v="":(n[l].v=O.substr(0,E+1),E=-1),n[l].t="t",L=l);E>=0&&L<n.length&&(n[L].v=O.substr(0,E+1)+n[L].v)}else if(B!==n.length&&O.indexOf("E")===-1){for(E=O.indexOf(".")-1,l=B;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(m=n[l].v.indexOf(".")>-1&&l===B?n[l].v.indexOf(".")-1:n[l].v.length-1,C=n[l].v.substr(m+1);m>=0;--m)E>=0&&(n[l].v.charAt(m)==="0"||n[l].v.charAt(m)==="#")&&(C=O.charAt(E--)+C);n[l].v=C,n[l].t="t",L=l}for(E>=0&&L<n.length&&(n[L].v=O.substr(0,E+1)+n[L].v),E=O.indexOf(".")+1,l=B;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==B)){for(m=n[l].v.indexOf(".")>-1&&l===B?n[l].v.indexOf(".")+1:0,C=n[l].v.substr(0,m);m<n[l].v.length;++m)E<O.length&&(C+=O.charAt(E++));n[l].v=C,n[l].t="t",L=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(F=s>1&&t<0&&l>0&&n[l-1].v==="-"?-t:t,n[l].v=wi(n[l].t,n[l].v,F),n[l].t="t");var H="";for(l=0;l!==n.length;++l)n[l]!=null&&(H+=n[l].v);return H}var HS=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function WS(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Dz(e,t){var r=Cz(e),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(HS),u=r[1].match(HS);return WS(t,l)?[s,r[0]]:WS(t,u)?[s,r[1]]:[s,r[l!=null&&u!=null?2:1]]}return[s,o]}function mn(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:Wt)[e],s==null&&(s=r.table&&r.table[zS[e]]||Wt[zS[e]]),s==null&&(s=mz[e]||"General");break}if($0(s,0))return pl(t,r);t instanceof Date&&(t=a5(t,r.date1904));var n=Dz(s,t);if($0(n[1]))return pl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Rz(n[1],t,r,n[0])}function _i(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Wt[r]==null){t<0&&(t=r);continue}if(Wt[r]==e){t=r;break}}t<0&&(t=391)}return Wt[t]=e,t}function bm(e){for(var t=0;t!=392;++t)e[t]!==void 0&&_i(e[t],t)}function ou(){Wt=hz()}var Oz={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},h5=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Fz(e){var t=typeof e=="number"?Wt[e]:e;return t=t.replace(h5,"(\\d+)"),new RegExp("^"+t+"$")}function Lz(e,t,r){var s=-1,n=-1,o=-1,l=-1,u=-1,d=-1;(t.match(h5)||[]).forEach(function(x,y){var b=parseInt(r[y+1],10);switch(x.toLowerCase().charAt(0)){case"y":s=b;break;case"d":o=b;break;case"h":l=b;break;case"s":d=b;break;case"m":l>=0?u=b:n=b;break}}),d>=0&&u==-1&&n>=0&&(u=n,n=-1);var h=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&u==-1&&d==-1?h:s==-1&&n==-1&&o==-1?m:h+"T"+m}var Iz=(function(){var e={};e.version="1.2.0";function t(){for(var O=0,B=new Array(256),L=0;L!=256;++L)O=L,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,B[L]=O;return typeof Int32Array<"u"?new Int32Array(B):B}var r=t();function s(O){var B=0,L=0,H=0,ue=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)ue[H]=O[H];for(H=0;H!=256;++H)for(L=O[H],B=256+H;B<4096;B+=256)L=ue[B]=L>>>8^O[L&255];var A=[];for(H=1;H!=16;++H)A[H-1]=typeof Int32Array<"u"?ue.subarray(H*256,H*256+256):ue.slice(H*256,H*256+256);return A}var n=s(r),o=n[0],l=n[1],u=n[2],d=n[3],h=n[4],m=n[5],x=n[6],y=n[7],b=n[8],v=n[9],g=n[10],_=n[11],w=n[12],S=n[13],N=n[14];function E(O,B){for(var L=B^-1,H=0,ue=O.length;H<ue;)L=L>>>8^r[(L^O.charCodeAt(H++))&255];return~L}function C(O,B){for(var L=B^-1,H=O.length-15,ue=0;ue<H;)L=N[O[ue++]^L&255]^S[O[ue++]^L>>8&255]^w[O[ue++]^L>>16&255]^_[O[ue++]^L>>>24]^g[O[ue++]]^v[O[ue++]]^b[O[ue++]]^y[O[ue++]]^x[O[ue++]]^m[O[ue++]]^h[O[ue++]]^d[O[ue++]]^u[O[ue++]]^l[O[ue++]]^o[O[ue++]]^r[O[ue++]];for(H+=15;ue<H;)L=L>>>8^r[(L^O[ue++])&255];return~L}function F(O,B){for(var L=B^-1,H=0,ue=O.length,A=0,Y=0;H<ue;)A=O.charCodeAt(H++),A<128?L=L>>>8^r[(L^A)&255]:A<2048?(L=L>>>8^r[(L^(192|A>>6&31))&255],L=L>>>8^r[(L^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,Y=O.charCodeAt(H++)&1023,L=L>>>8^r[(L^(240|A>>8&7))&255],L=L>>>8^r[(L^(128|A>>2&63))&255],L=L>>>8^r[(L^(128|Y>>6&15|(A&3)<<4))&255],L=L>>>8^r[(L^(128|Y&63))&255]):(L=L>>>8^r[(L^(224|A>>12&15))&255],L=L>>>8^r[(L^(128|A>>6&63))&255],L=L>>>8^r[(L^(128|A&63))&255]);return~L}return e.table=r,e.bstr=E,e.buf=C,e.str=F,e})(),Pt=(function(){var t={};t.version="1.2.1";function r(he,we){for(var ye=he.split("/"),be=we.split("/"),Se=0,Te=0,We=Math.min(ye.length,be.length);Se<We;++Se){if(Te=ye[Se].length-be[Se].length)return Te;if(ye[Se]!=be[Se])return ye[Se]<be[Se]?-1:1}return ye.length-be.length}function s(he){if(he.charAt(he.length-1)=="/")return he.slice(0,-1).indexOf("/")===-1?he:s(he.slice(0,-1));var we=he.lastIndexOf("/");return we===-1?he:he.slice(0,we+1)}function n(he){if(he.charAt(he.length-1)=="/")return n(he.slice(0,-1));var we=he.lastIndexOf("/");return we===-1?he:he.slice(we+1)}function o(he,we){typeof we=="string"&&(we=new Date(we));var ye=we.getHours();ye=ye<<6|we.getMinutes(),ye=ye<<5|we.getSeconds()>>>1,he.write_shift(2,ye);var be=we.getFullYear()-1980;be=be<<4|we.getMonth()+1,be=be<<5|we.getDate(),he.write_shift(2,be)}function l(he){var we=he.read_shift(2)&65535,ye=he.read_shift(2)&65535,be=new Date,Se=ye&31;ye>>>=5;var Te=ye&15;ye>>>=4,be.setMilliseconds(0),be.setFullYear(ye+1980),be.setMonth(Te-1),be.setDate(Se);var We=we&31;we>>>=5;var at=we&63;return we>>>=6,be.setHours(we),be.setMinutes(at),be.setSeconds(We<<1),be}function u(he){Ks(he,0);for(var we={},ye=0;he.l<=he.length-4;){var be=he.read_shift(2),Se=he.read_shift(2),Te=he.l+Se,We={};be===21589&&(ye=he.read_shift(1),ye&1&&(We.mtime=he.read_shift(4)),Se>5&&(ye&2&&(We.atime=he.read_shift(4)),ye&4&&(We.ctime=he.read_shift(4))),We.mtime&&(We.mt=new Date(We.mtime*1e3))),he.l=Te,we[be]=We}return we}var d;function h(){return d||(d={})}function m(he,we){if(he[0]==80&&he[1]==75)return Ne(he,we);if((he[0]|32)==109&&(he[1]|32)==105)return Vt(he,we);if(he.length<512)throw new Error("CFB file size "+he.length+" < 512");var ye=3,be=512,Se=0,Te=0,We=0,at=0,qe=0,He=[],Ke=he.slice(0,512);Ks(Ke,0);var ht=x(Ke);switch(ye=ht[0],ye){case 3:be=512;break;case 4:be=4096;break;case 0:if(ht[1]==0)return Ne(he,we);default:throw new Error("Major Version: Expected 3 or 4 saw "+ye)}be!==512&&(Ke=he.slice(0,be),Ks(Ke,28));var bt=he.slice(0,be);y(Ke,ye);var Et=Ke.read_shift(4,"i");if(ye===3&&Et!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Et);Ke.l+=4,We=Ke.read_shift(4,"i"),Ke.l+=4,Ke.chk("00100000","Mini Stream Cutoff Size: "),at=Ke.read_shift(4,"i"),Se=Ke.read_shift(4,"i"),qe=Ke.read_shift(4,"i"),Te=Ke.read_shift(4,"i");for(var xt=-1,pe=0;pe<109&&(xt=Ke.read_shift(4,"i"),!(xt<0));++pe)He[pe]=xt;var Ie=b(he,be);_(qe,Te,Ie,be,He);var wt=S(Ie,We,He,be);wt[We].name="!Directory",Se>0&&at!==Y&&(wt[at].name="!MiniFAT"),wt[He[0]].name="!FAT",wt.fat_addrs=He,wt.ssz=be;var yt={},Ut=[],Ur=[],ds=[];N(We,wt,Ie,Ut,Se,yt,Ur,at),v(Ur,ds,Ut),Ut.shift();var fs={FileIndex:Ur,FullPaths:ds};return we&&we.raw&&(fs.raw={header:bt,sectors:Ie}),fs}function x(he){if(he[he.l]==80&&he[he.l+1]==75)return[0,0];he.chk(I,"Header Signature: "),he.l+=16;var we=he.read_shift(2,"u");return[he.read_shift(2,"u"),we]}function y(he,we){var ye=9;switch(he.l+=2,ye=he.read_shift(2)){case 9:if(we!=3)throw new Error("Sector Shift: Expected 9 saw "+ye);break;case 12:if(we!=4)throw new Error("Sector Shift: Expected 12 saw "+ye);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ye)}he.chk("0600","Mini Sector Shift: "),he.chk("000000000000","Reserved: ")}function b(he,we){for(var ye=Math.ceil(he.length/we)-1,be=[],Se=1;Se<ye;++Se)be[Se-1]=he.slice(Se*we,(Se+1)*we);return be[ye-1]=he.slice(ye*we),be}function v(he,we,ye){for(var be=0,Se=0,Te=0,We=0,at=0,qe=ye.length,He=[],Ke=[];be<qe;++be)He[be]=Ke[be]=be,we[be]=ye[be];for(;at<Ke.length;++at)be=Ke[at],Se=he[be].L,Te=he[be].R,We=he[be].C,He[be]===be&&(Se!==-1&&He[Se]!==Se&&(He[be]=He[Se]),Te!==-1&&He[Te]!==Te&&(He[be]=He[Te])),We!==-1&&(He[We]=be),Se!==-1&&be!=He[be]&&(He[Se]=He[be],Ke.lastIndexOf(Se)<at&&Ke.push(Se)),Te!==-1&&be!=He[be]&&(He[Te]=He[be],Ke.lastIndexOf(Te)<at&&Ke.push(Te));for(be=1;be<qe;++be)He[be]===be&&(Te!==-1&&He[Te]!==Te?He[be]=He[Te]:Se!==-1&&He[Se]!==Se&&(He[be]=He[Se]));for(be=1;be<qe;++be)if(he[be].type!==0){if(at=be,at!=He[at])do at=He[at],we[be]=we[at]+"/"+we[be];while(at!==0&&He[at]!==-1&&at!=He[at]);He[be]=-1}for(we[0]+="/",be=1;be<qe;++be)he[be].type!==2&&(we[be]+="/")}function g(he,we,ye){for(var be=he.start,Se=he.size,Te=[],We=be;ye&&Se>0&&We>=0;)Te.push(we.slice(We*A,We*A+A)),Se-=A,We=Qo(ye,We*4);return Te.length===0?nt(0):Is(Te).slice(0,he.size)}function _(he,we,ye,be,Se){var Te=Y;if(he===Y){if(we!==0)throw new Error("DIFAT chain shorter than expected")}else if(he!==-1){var We=ye[he],at=(be>>>2)-1;if(!We)return;for(var qe=0;qe<at&&(Te=Qo(We,qe*4))!==Y;++qe)Se.push(Te);_(Qo(We,be-4),we-1,ye,be,Se)}}function w(he,we,ye,be,Se){var Te=[],We=[];Se||(Se=[]);var at=be-1,qe=0,He=0;for(qe=we;qe>=0;){Se[qe]=!0,Te[Te.length]=qe,We.push(he[qe]);var Ke=ye[Math.floor(qe*4/be)];if(He=qe*4&at,be<4+He)throw new Error("FAT boundary crossed: "+qe+" 4 "+be);if(!he[Ke])break;qe=Qo(he[Ke],He)}return{nodes:Te,data:s3([We])}}function S(he,we,ye,be){var Se=he.length,Te=[],We=[],at=[],qe=[],He=be-1,Ke=0,ht=0,bt=0,Et=0;for(Ke=0;Ke<Se;++Ke)if(at=[],bt=Ke+we,bt>=Se&&(bt-=Se),!We[bt]){qe=[];var xt=[];for(ht=bt;ht>=0;){xt[ht]=!0,We[ht]=!0,at[at.length]=ht,qe.push(he[ht]);var pe=ye[Math.floor(ht*4/be)];if(Et=ht*4&He,be<4+Et)throw new Error("FAT boundary crossed: "+ht+" 4 "+be);if(!he[pe]||(ht=Qo(he[pe],Et),xt[ht]))break}Te[bt]={nodes:at,data:s3([qe])}}return Te}function N(he,we,ye,be,Se,Te,We,at){for(var qe=0,He=be.length?2:0,Ke=we[he].data,ht=0,bt=0,Et;ht<Ke.length;ht+=128){var xt=Ke.slice(ht,ht+128);Ks(xt,64),bt=xt.read_shift(2),Et=Xv(xt,0,bt-He),be.push(Et);var pe={name:Et,type:xt.read_shift(1),color:xt.read_shift(1),L:xt.read_shift(4,"i"),R:xt.read_shift(4,"i"),C:xt.read_shift(4,"i"),clsid:xt.read_shift(16),state:xt.read_shift(4,"i"),start:0,size:0},Ie=xt.read_shift(2)+xt.read_shift(2)+xt.read_shift(2)+xt.read_shift(2);Ie!==0&&(pe.ct=E(xt,xt.l-8));var wt=xt.read_shift(2)+xt.read_shift(2)+xt.read_shift(2)+xt.read_shift(2);wt!==0&&(pe.mt=E(xt,xt.l-8)),pe.start=xt.read_shift(4,"i"),pe.size=xt.read_shift(4,"i"),pe.size<0&&pe.start<0&&(pe.size=pe.type=0,pe.start=Y,pe.name=""),pe.type===5?(qe=pe.start,Se>0&&qe!==Y&&(we[qe].name="!StreamData")):pe.size>=4096?(pe.storage="fat",we[pe.start]===void 0&&(we[pe.start]=w(ye,pe.start,we.fat_addrs,we.ssz)),we[pe.start].name=pe.name,pe.content=we[pe.start].data.slice(0,pe.size)):(pe.storage="minifat",pe.size<0?pe.size=0:qe!==Y&&pe.start!==Y&&we[qe]&&(pe.content=g(pe,we[qe].data,(we[at]||{}).data))),pe.content&&Ks(pe.content,0),Te[Et]=pe,We.push(pe)}}function E(he,we){return new Date((Ba(he,we+4)/1e7*Math.pow(2,32)+Ba(he,we)/1e7-11644473600)*1e3)}function C(he,we){return h(),m(d.readFileSync(he),we)}function F(he,we){var ye=we&&we.type;switch(ye||ar&&Buffer.isBuffer(he)&&(ye="buffer"),ye||"base64"){case"file":return C(he,we);case"base64":return m(za(Ha(he)),we);case"binary":return m(za(he),we)}return m(he,we)}function O(he,we){var ye=we||{},be=ye.root||"Root Entry";if(he.FullPaths||(he.FullPaths=[]),he.FileIndex||(he.FileIndex=[]),he.FullPaths.length!==he.FileIndex.length)throw new Error("inconsistent CFB structure");he.FullPaths.length===0&&(he.FullPaths[0]=be+"/",he.FileIndex[0]={name:be,type:5}),ye.CLSID&&(he.FileIndex[0].clsid=ye.CLSID),B(he)}function B(he){var we="Sh33tJ5";if(!Pt.find(he,"/"+we)){var ye=nt(4);ye[0]=55,ye[1]=ye[3]=50,ye[2]=54,he.FileIndex.push({name:we,type:2,content:ye,size:4,L:69,R:69,C:69}),he.FullPaths.push(he.FullPaths[0]+we),L(he)}}function L(he,we){O(he);for(var ye=!1,be=!1,Se=he.FullPaths.length-1;Se>=0;--Se){var Te=he.FileIndex[Se];switch(Te.type){case 0:be?ye=!0:(he.FileIndex.pop(),he.FullPaths.pop());break;case 1:case 2:case 5:be=!0,isNaN(Te.R*Te.L*Te.C)&&(ye=!0),Te.R>-1&&Te.L>-1&&Te.R==Te.L&&(ye=!0);break;default:ye=!0;break}}if(!(!ye&&!we)){var We=new Date(1987,1,19),at=0,qe=Object.create?Object.create(null):{},He=[];for(Se=0;Se<he.FullPaths.length;++Se)qe[he.FullPaths[Se]]=!0,he.FileIndex[Se].type!==0&&He.push([he.FullPaths[Se],he.FileIndex[Se]]);for(Se=0;Se<He.length;++Se){var Ke=s(He[Se][0]);be=qe[Ke],be||(He.push([Ke,{name:n(Ke).replace("/",""),type:1,clsid:Q,ct:We,mt:We,content:null}]),qe[Ke]=!0)}for(He.sort(function(Et,xt){return r(Et[0],xt[0])}),he.FullPaths=[],he.FileIndex=[],Se=0;Se<He.length;++Se)he.FullPaths[Se]=He[Se][0],he.FileIndex[Se]=He[Se][1];for(Se=0;Se<He.length;++Se){var ht=he.FileIndex[Se],bt=he.FullPaths[Se];if(ht.name=n(bt).replace("/",""),ht.L=ht.R=ht.C=-(ht.color=1),ht.size=ht.content?ht.content.length:0,ht.start=0,ht.clsid=ht.clsid||Q,Se===0)ht.C=He.length>1?1:-1,ht.size=0,ht.type=5;else if(bt.slice(-1)=="/"){for(at=Se+1;at<He.length&&s(he.FullPaths[at])!=bt;++at);for(ht.C=at>=He.length?-1:at,at=Se+1;at<He.length&&s(he.FullPaths[at])!=s(bt);++at);ht.R=at>=He.length?-1:at,ht.type=1}else s(he.FullPaths[Se+1]||"")==s(bt)&&(ht.R=Se+1),ht.type=2}}}function H(he,we){var ye=we||{};if(ye.fileType=="mad")return yr(he,ye);if(L(he),ye.fileType==="zip")return je(he,ye);var be=(function(Et){for(var xt=0,pe=0,Ie=0;Ie<Et.FileIndex.length;++Ie){var wt=Et.FileIndex[Ie];if(wt.content){var yt=wt.content.length;yt>0&&(yt<4096?xt+=yt+63>>6:pe+=yt+511>>9)}}for(var Ut=Et.FullPaths.length+3>>2,Ur=xt+7>>3,ds=xt+127>>7,fs=Ur+pe+Ut+ds,Ga=fs+127>>7,So=Ga<=109?0:Math.ceil((Ga-109)/127);fs+Ga+So+127>>7>Ga;)So=++Ga<=109?0:Math.ceil((Ga-109)/127);var Zs=[1,So,Ga,ds,Ut,pe,xt,0];return Et.FileIndex[0].size=xt<<6,Zs[7]=(Et.FileIndex[0].start=Zs[0]+Zs[1]+Zs[2]+Zs[3]+Zs[4]+Zs[5])+(Zs[6]+7>>3),Zs})(he),Se=nt(be[7]<<9),Te=0,We=0;{for(Te=0;Te<8;++Te)Se.write_shift(1,ae[Te]);for(Te=0;Te<8;++Te)Se.write_shift(2,0);for(Se.write_shift(2,62),Se.write_shift(2,3),Se.write_shift(2,65534),Se.write_shift(2,9),Se.write_shift(2,6),Te=0;Te<3;++Te)Se.write_shift(2,0);for(Se.write_shift(4,0),Se.write_shift(4,be[2]),Se.write_shift(4,be[0]+be[1]+be[2]+be[3]-1),Se.write_shift(4,0),Se.write_shift(4,4096),Se.write_shift(4,be[3]?be[0]+be[1]+be[2]-1:Y),Se.write_shift(4,be[3]),Se.write_shift(-4,be[1]?be[0]-1:Y),Se.write_shift(4,be[1]),Te=0;Te<109;++Te)Se.write_shift(-4,Te<be[2]?be[1]+Te:-1)}if(be[1])for(We=0;We<be[1];++We){for(;Te<236+We*127;++Te)Se.write_shift(-4,Te<be[2]?be[1]+Te:-1);Se.write_shift(-4,We===be[1]-1?Y:We+1)}var at=function(Et){for(We+=Et;Te<We-1;++Te)Se.write_shift(-4,Te+1);Et&&(++Te,Se.write_shift(-4,Y))};for(We=Te=0,We+=be[1];Te<We;++Te)Se.write_shift(-4,re.DIFSECT);for(We+=be[2];Te<We;++Te)Se.write_shift(-4,re.FATSECT);at(be[3]),at(be[4]);for(var qe=0,He=0,Ke=he.FileIndex[0];qe<he.FileIndex.length;++qe)Ke=he.FileIndex[qe],Ke.content&&(He=Ke.content.length,!(He<4096)&&(Ke.start=We,at(He+511>>9)));for(at(be[6]+7>>3);Se.l&511;)Se.write_shift(-4,re.ENDOFCHAIN);for(We=Te=0,qe=0;qe<he.FileIndex.length;++qe)Ke=he.FileIndex[qe],Ke.content&&(He=Ke.content.length,!(!He||He>=4096)&&(Ke.start=We,at(He+63>>6)));for(;Se.l&511;)Se.write_shift(-4,re.ENDOFCHAIN);for(Te=0;Te<be[4]<<2;++Te){var ht=he.FullPaths[Te];if(!ht||ht.length===0){for(qe=0;qe<17;++qe)Se.write_shift(4,0);for(qe=0;qe<3;++qe)Se.write_shift(4,-1);for(qe=0;qe<12;++qe)Se.write_shift(4,0);continue}Ke=he.FileIndex[Te],Te===0&&(Ke.start=Ke.size?Ke.start-1:Y);var bt=Te===0&&ye.root||Ke.name;if(He=2*(bt.length+1),Se.write_shift(64,bt,"utf16le"),Se.write_shift(2,He),Se.write_shift(1,Ke.type),Se.write_shift(1,Ke.color),Se.write_shift(-4,Ke.L),Se.write_shift(-4,Ke.R),Se.write_shift(-4,Ke.C),Ke.clsid)Se.write_shift(16,Ke.clsid,"hex");else for(qe=0;qe<4;++qe)Se.write_shift(4,0);Se.write_shift(4,Ke.state||0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,Ke.start),Se.write_shift(4,Ke.size),Se.write_shift(4,0)}for(Te=1;Te<he.FileIndex.length;++Te)if(Ke=he.FileIndex[Te],Ke.size>=4096)if(Se.l=Ke.start+1<<9,ar&&Buffer.isBuffer(Ke.content))Ke.content.copy(Se,Se.l,0,Ke.size),Se.l+=Ke.size+511&-512;else{for(qe=0;qe<Ke.size;++qe)Se.write_shift(1,Ke.content[qe]);for(;qe&511;++qe)Se.write_shift(1,0)}for(Te=1;Te<he.FileIndex.length;++Te)if(Ke=he.FileIndex[Te],Ke.size>0&&Ke.size<4096)if(ar&&Buffer.isBuffer(Ke.content))Ke.content.copy(Se,Se.l,0,Ke.size),Se.l+=Ke.size+63&-64;else{for(qe=0;qe<Ke.size;++qe)Se.write_shift(1,Ke.content[qe]);for(;qe&63;++qe)Se.write_shift(1,0)}if(ar)Se.l=Se.length;else for(;Se.l<Se.length;)Se.write_shift(1,0);return Se}function ue(he,we){var ye=he.FullPaths.map(function(qe){return qe.toUpperCase()}),be=ye.map(function(qe){var He=qe.split("/");return He[He.length-(qe.slice(-1)=="/"?2:1)]}),Se=!1;we.charCodeAt(0)===47?(Se=!0,we=ye[0].slice(0,-1)+we):Se=we.indexOf("/")!==-1;var Te=we.toUpperCase(),We=Se===!0?ye.indexOf(Te):be.indexOf(Te);if(We!==-1)return he.FileIndex[We];var at=!Te.match(hd);for(Te=Te.replace(pa,""),at&&(Te=Te.replace(hd,"!")),We=0;We<ye.length;++We)if((at?ye[We].replace(hd,"!"):ye[We]).replace(pa,"")==Te||(at?be[We].replace(hd,"!"):be[We]).replace(pa,"")==Te)return he.FileIndex[We];return null}var A=64,Y=-2,I="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:I,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ve(he,we,ye){h();var be=H(he,ye);d.writeFileSync(we,be)}function te(he){for(var we=new Array(he.length),ye=0;ye<he.length;++ye)we[ye]=String.fromCharCode(he[ye]);return we.join("")}function ke(he,we){var ye=H(he,we);switch(we&&we.type||"buffer"){case"file":return h(),d.writeFileSync(we.filename,ye),ye;case"binary":return typeof ye=="string"?ye:te(ye);case"base64":return zd(typeof ye=="string"?ye:te(ye));case"buffer":if(ar)return Buffer.isBuffer(ye)?ye:Oi(ye);case"array":return typeof ye=="string"?za(ye):ye}return ye}var Z;function M(he){try{var we=he.InflateRaw,ye=new we;if(ye._processChunk(new Uint8Array([3,0]),ye._finishFlushFlag),ye.bytesRead)Z=he;else throw new Error("zlib does not expose bytesRead")}catch(be){console.error("cannot use native zlib: "+(be.message||be))}}function J(he,we){if(!Z)return ct(he,we);var ye=Z.InflateRaw,be=new ye,Se=be._processChunk(he.slice(he.l),be._finishFlushFlag);return he.l+=be.bytesRead,Se}function V(he){return Z?Z.deflateRawSync(he):De(he)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],P=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function U(he){var we=(he<<1|he<<11)&139536|(he<<5|he<<15)&558144;return(we>>16|we>>8|we)&255}for(var ce=typeof Uint8Array<"u",ne=ce?new Uint8Array(256):[],ie=0;ie<256;++ie)ne[ie]=U(ie);function W(he,we){var ye=ne[he&255];return we<=8?ye>>>8-we:(ye=ye<<8|ne[he>>8&255],we<=16?ye>>>16-we:(ye=ye<<8|ne[he>>16&255],ye>>>24-we))}function G(he,we){var ye=we&7,be=we>>>3;return(he[be]|(ye<=6?0:he[be+1]<<8))>>>ye&3}function k(he,we){var ye=we&7,be=we>>>3;return(he[be]|(ye<=5?0:he[be+1]<<8))>>>ye&7}function de(he,we){var ye=we&7,be=we>>>3;return(he[be]|(ye<=4?0:he[be+1]<<8))>>>ye&15}function z(he,we){var ye=we&7,be=we>>>3;return(he[be]|(ye<=3?0:he[be+1]<<8))>>>ye&31}function T(he,we){var ye=we&7,be=we>>>3;return(he[be]|(ye<=1?0:he[be+1]<<8))>>>ye&127}function R(he,we,ye){var be=we&7,Se=we>>>3,Te=(1<<ye)-1,We=he[Se]>>>be;return ye<8-be||(We|=he[Se+1]<<8-be,ye<16-be)||(We|=he[Se+2]<<16-be,ye<24-be)||(We|=he[Se+3]<<24-be),We&Te}function q(he,we,ye){var be=we&7,Se=we>>>3;return be<=5?he[Se]|=(ye&7)<<be:(he[Se]|=ye<<be&255,he[Se+1]=(ye&7)>>8-be),we+3}function me(he,we,ye){var be=we&7,Se=we>>>3;return ye=(ye&1)<<be,he[Se]|=ye,we+1}function _e(he,we,ye){var be=we&7,Se=we>>>3;return ye<<=be,he[Se]|=ye&255,ye>>>=8,he[Se+1]=ye,we+8}function le(he,we,ye){var be=we&7,Se=we>>>3;return ye<<=be,he[Se]|=ye&255,ye>>>=8,he[Se+1]=ye&255,he[Se+2]=ye>>>8,we+16}function Ae(he,we){var ye=he.length,be=2*ye>we?2*ye:we+5,Se=0;if(ye>=we)return he;if(ar){var Te=BS(be);if(he.copy)he.copy(Te);else for(;Se<he.length;++Se)Te[Se]=he[Se];return Te}else if(ce){var We=new Uint8Array(be);if(We.set)We.set(he);else for(;Se<ye;++Se)We[Se]=he[Se];return We}return he.length=be,he}function Me(he){for(var we=new Array(he),ye=0;ye<he;++ye)we[ye]=0;return we}function Ee(he,we,ye){var be=1,Se=0,Te=0,We=0,at=0,qe=he.length,He=ce?new Uint16Array(32):Me(32);for(Te=0;Te<32;++Te)He[Te]=0;for(Te=qe;Te<ye;++Te)he[Te]=0;qe=he.length;var Ke=ce?new Uint16Array(qe):Me(qe);for(Te=0;Te<qe;++Te)He[Se=he[Te]]++,be<Se&&(be=Se),Ke[Te]=0;for(He[0]=0,Te=1;Te<=be;++Te)He[Te+16]=at=at+He[Te-1]<<1;for(Te=0;Te<qe;++Te)at=he[Te],at!=0&&(Ke[Te]=He[at+16]++);var ht=0;for(Te=0;Te<qe;++Te)if(ht=he[Te],ht!=0)for(at=W(Ke[Te],be)>>be-ht,We=(1<<be+4-ht)-1;We>=0;--We)we[at|We<<ht]=ht&15|Te<<4;return be}var Ce=ce?new Uint16Array(512):Me(512),Je=ce?new Uint16Array(32):Me(32);if(!ce){for(var $e=0;$e<512;++$e)Ce[$e]=0;for($e=0;$e<32;++$e)Je[$e]=0}(function(){for(var he=[],we=0;we<32;we++)he.push(5);Ee(he,Je,32);var ye=[];for(we=0;we<=143;we++)ye.push(8);for(;we<=255;we++)ye.push(9);for(;we<=279;we++)ye.push(7);for(;we<=287;we++)ye.push(8);Ee(ye,Ce,288)})();var tt=(function(){for(var we=ce?new Uint8Array(32768):[],ye=0,be=0;ye<P.length-1;++ye)for(;be<P[ye+1];++be)we[be]=ye;for(;be<32768;++be)we[be]=29;var Se=ce?new Uint8Array(259):[];for(ye=0,be=0;ye<se.length-1;++ye)for(;be<se[ye+1];++be)Se[be]=ye;function Te(at,qe){for(var He=0;He<at.length;){var Ke=Math.min(65535,at.length-He),ht=He+Ke==at.length;for(qe.write_shift(1,+ht),qe.write_shift(2,Ke),qe.write_shift(2,~Ke&65535);Ke-- >0;)qe[qe.l++]=at[He++]}return qe.l}function We(at,qe){for(var He=0,Ke=0,ht=ce?new Uint16Array(32768):[];Ke<at.length;){var bt=Math.min(65535,at.length-Ke);if(bt<10){for(He=q(qe,He,+(Ke+bt==at.length)),He&7&&(He+=8-(He&7)),qe.l=He/8|0,qe.write_shift(2,bt),qe.write_shift(2,~bt&65535);bt-- >0;)qe[qe.l++]=at[Ke++];He=qe.l*8;continue}He=q(qe,He,+(Ke+bt==at.length)+2);for(var Et=0;bt-- >0;){var xt=at[Ke];Et=(Et<<5^xt)&32767;var pe=-1,Ie=0;if((pe=ht[Et])&&(pe|=Ke&-32768,pe>Ke&&(pe-=32768),pe<Ke))for(;at[pe+Ie]==at[Ke+Ie]&&Ie<250;)++Ie;if(Ie>2){xt=Se[Ie],xt<=22?He=_e(qe,He,ne[xt+1]>>1)-1:(_e(qe,He,3),He+=5,_e(qe,He,ne[xt-23]>>5),He+=3);var wt=xt<8?0:xt-4>>2;wt>0&&(le(qe,He,Ie-se[xt]),He+=wt),xt=we[Ke-pe],He=_e(qe,He,ne[xt]>>3),He-=3;var yt=xt<4?0:xt-2>>1;yt>0&&(le(qe,He,Ke-pe-P[xt]),He+=yt);for(var Ut=0;Ut<Ie;++Ut)ht[Et]=Ke&32767,Et=(Et<<5^at[Ke])&32767,++Ke;bt-=Ie-1}else xt<=143?xt=xt+48:He=me(qe,He,1),He=_e(qe,He,ne[xt]),ht[Et]=Ke&32767,++Ke}He=_e(qe,He,0)-1}return qe.l=(He+7)/8|0,qe.l}return function(qe,He){return qe.length<8?Te(qe,He):We(qe,He)}})();function De(he){var we=nt(50+Math.floor(he.length*1.1)),ye=tt(he,we);return we.slice(0,ye)}var ft=ce?new Uint16Array(32768):Me(32768),jt=ce?new Uint16Array(32768):Me(32768),vt=ce?new Uint16Array(128):Me(128),At=1,Rt=1;function Le(he,we){var ye=z(he,we)+257;we+=5;var be=z(he,we)+1;we+=5;var Se=de(he,we)+4;we+=4;for(var Te=0,We=ce?new Uint8Array(19):Me(19),at=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],qe=1,He=ce?new Uint8Array(8):Me(8),Ke=ce?new Uint8Array(8):Me(8),ht=We.length,bt=0;bt<Se;++bt)We[X[bt]]=Te=k(he,we),qe<Te&&(qe=Te),He[Te]++,we+=3;var Et=0;for(He[0]=0,bt=1;bt<=qe;++bt)Ke[bt]=Et=Et+He[bt-1]<<1;for(bt=0;bt<ht;++bt)(Et=We[bt])!=0&&(at[bt]=Ke[Et]++);var xt=0;for(bt=0;bt<ht;++bt)if(xt=We[bt],xt!=0){Et=ne[at[bt]]>>8-xt;for(var pe=(1<<7-xt)-1;pe>=0;--pe)vt[Et|pe<<xt]=xt&7|bt<<3}var Ie=[];for(qe=1;Ie.length<ye+be;)switch(Et=vt[T(he,we)],we+=Et&7,Et>>>=3){case 16:for(Te=3+G(he,we),we+=2,Et=Ie[Ie.length-1];Te-- >0;)Ie.push(Et);break;case 17:for(Te=3+k(he,we),we+=3;Te-- >0;)Ie.push(0);break;case 18:for(Te=11+T(he,we),we+=7;Te-- >0;)Ie.push(0);break;default:Ie.push(Et),qe<Et&&(qe=Et);break}var wt=Ie.slice(0,ye),yt=Ie.slice(ye);for(bt=ye;bt<286;++bt)wt[bt]=0;for(bt=be;bt<30;++bt)yt[bt]=0;return At=Ee(wt,ft,286),Rt=Ee(yt,jt,30),we}function rt(he,we){if(he[0]==3&&!(he[1]&3))return[po(we),2];for(var ye=0,be=0,Se=BS(we||1<<18),Te=0,We=Se.length>>>0,at=0,qe=0;(be&1)==0;){if(be=k(he,ye),ye+=3,be>>>1)be>>1==1?(at=9,qe=5):(ye=Le(he,ye),at=At,qe=Rt);else{ye&7&&(ye+=8-(ye&7));var He=he[ye>>>3]|he[(ye>>>3)+1]<<8;if(ye+=32,He>0)for(!we&&We<Te+He&&(Se=Ae(Se,Te+He),We=Se.length);He-- >0;)Se[Te++]=he[ye>>>3],ye+=8;continue}for(;;){!we&&We<Te+32767&&(Se=Ae(Se,Te+32767),We=Se.length);var Ke=R(he,ye,at),ht=be>>>1==1?Ce[Ke]:ft[Ke];if(ye+=ht&15,ht>>>=4,(ht>>>8&255)===0)Se[Te++]=ht;else{if(ht==256)break;ht-=257;var bt=ht<8?0:ht-4>>2;bt>5&&(bt=0);var Et=Te+se[ht];bt>0&&(Et+=R(he,ye,bt),ye+=bt),Ke=R(he,ye,qe),ht=be>>>1==1?Je[Ke]:jt[Ke],ye+=ht&15,ht>>>=4;var xt=ht<4?0:ht-2>>1,pe=P[ht];for(xt>0&&(pe+=R(he,ye,xt),ye+=xt),!we&&We<Et&&(Se=Ae(Se,Et+100),We=Se.length);Te<Et;)Se[Te]=Se[Te-pe],++Te}}}return we?[Se,ye+7>>>3]:[Se.slice(0,Te),ye+7>>>3]}function ct(he,we){var ye=he.slice(he.l||0),be=rt(ye,we);return he.l+=be[1],be[0]}function oe(he,we){if(he)typeof console<"u"&&console.error(we);else throw new Error(we)}function Ne(he,we){var ye=he;Ks(ye,0);var be=[],Se=[],Te={FileIndex:be,FullPaths:Se};O(Te,{root:we.root});for(var We=ye.length-4;(ye[We]!=80||ye[We+1]!=75||ye[We+2]!=5||ye[We+3]!=6)&&We>=0;)--We;ye.l=We+4,ye.l+=4;var at=ye.read_shift(2);ye.l+=6;var qe=ye.read_shift(4);for(ye.l=qe,We=0;We<at;++We){ye.l+=20;var He=ye.read_shift(4),Ke=ye.read_shift(4),ht=ye.read_shift(2),bt=ye.read_shift(2),Et=ye.read_shift(2);ye.l+=8;var xt=ye.read_shift(4),pe=u(ye.slice(ye.l+ht,ye.l+ht+bt));ye.l+=ht+bt+Et;var Ie=ye.l;ye.l=xt+4,xe(ye,He,Ke,Te,pe),ye.l=Ie}return Te}function xe(he,we,ye,be,Se){he.l+=2;var Te=he.read_shift(2),We=he.read_shift(2),at=l(he);if(Te&8257)throw new Error("Unsupported ZIP encryption");for(var qe=he.read_shift(4),He=he.read_shift(4),Ke=he.read_shift(4),ht=he.read_shift(2),bt=he.read_shift(2),Et="",xt=0;xt<ht;++xt)Et+=String.fromCharCode(he[he.l++]);if(bt){var pe=u(he.slice(he.l,he.l+bt));(pe[21589]||{}).mt&&(at=pe[21589].mt),((Se||{})[21589]||{}).mt&&(at=Se[21589].mt)}he.l+=bt;var Ie=he.slice(he.l,he.l+He);switch(We){case 8:Ie=J(he,Ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+We)}var wt=!1;Te&8&&(qe=he.read_shift(4),qe==134695760&&(qe=he.read_shift(4),wt=!0),He=he.read_shift(4),Ke=he.read_shift(4)),He!=we&&oe(wt,"Bad compressed size: "+we+" != "+He),Ke!=ye&&oe(wt,"Bad uncompressed size: "+ye+" != "+Ke),zt(be,Et,Ie,{unsafe:!0,mt:at})}function je(he,we){var ye=we||{},be=[],Se=[],Te=nt(1),We=ye.compression?8:0,at=0,qe=0,He=0,Ke=0,ht=0,bt=he.FullPaths[0],Et=bt,xt=he.FileIndex[0],pe=[],Ie=0;for(qe=1;qe<he.FullPaths.length;++qe)if(Et=he.FullPaths[qe].slice(bt.length),xt=he.FileIndex[qe],!(!xt.size||!xt.content||Et=="Sh33tJ5")){var wt=Ke,yt=nt(Et.length);for(He=0;He<Et.length;++He)yt.write_shift(1,Et.charCodeAt(He)&127);yt=yt.slice(0,yt.l),pe[ht]=Iz.buf(xt.content,0);var Ut=xt.content;We==8&&(Ut=V(Ut)),Te=nt(30),Te.write_shift(4,67324752),Te.write_shift(2,20),Te.write_shift(2,at),Te.write_shift(2,We),xt.mt?o(Te,xt.mt):Te.write_shift(4,0),Te.write_shift(-4,pe[ht]),Te.write_shift(4,Ut.length),Te.write_shift(4,xt.content.length),Te.write_shift(2,yt.length),Te.write_shift(2,0),Ke+=Te.length,be.push(Te),Ke+=yt.length,be.push(yt),Ke+=Ut.length,be.push(Ut),Te=nt(46),Te.write_shift(4,33639248),Te.write_shift(2,0),Te.write_shift(2,20),Te.write_shift(2,at),Te.write_shift(2,We),Te.write_shift(4,0),Te.write_shift(-4,pe[ht]),Te.write_shift(4,Ut.length),Te.write_shift(4,xt.content.length),Te.write_shift(2,yt.length),Te.write_shift(2,0),Te.write_shift(2,0),Te.write_shift(2,0),Te.write_shift(2,0),Te.write_shift(4,0),Te.write_shift(4,wt),Ie+=Te.l,Se.push(Te),Ie+=yt.length,Se.push(yt),++ht}return Te=nt(22),Te.write_shift(4,101010256),Te.write_shift(2,0),Te.write_shift(2,0),Te.write_shift(2,ht),Te.write_shift(2,ht),Te.write_shift(4,Ie),Te.write_shift(4,Ke),Te.write_shift(2,0),Is([Is(be),Is(Se),Te])}var fe={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Oe(he,we){if(he.ctype)return he.ctype;var ye=he.name||"",be=ye.match(/\.([^\.]+)$/);return be&&fe[be[1]]||we&&(be=(ye=we).match(/[\.\\]([^\.\\])+$/),be&&fe[be[1]])?fe[be[1]]:"application/octet-stream"}function Ue(he){for(var we=zd(he),ye=[],be=0;be<we.length;be+=76)ye.push(we.slice(be,be+76));return ye.join(`\r
`)+`\r
`}function st(he){var we=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(He){var Ke=He.charCodeAt(0).toString(16).toUpperCase();return"="+(Ke.length==1?"0"+Ke:Ke)});we=we.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),we.charAt(0)==`
`&&(we="=0D"+we.slice(1)),we=we.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ye=[],be=we.split(`\r
`),Se=0;Se<be.length;++Se){var Te=be[Se];if(Te.length==0){ye.push("");continue}for(var We=0;We<Te.length;){var at=76,qe=Te.slice(We,We+at);qe.charAt(at-1)=="="?at--:qe.charAt(at-2)=="="?at-=2:qe.charAt(at-3)=="="&&(at-=3),qe=Te.slice(We,We+at),We+=at,We<Te.length&&(qe+="="),ye.push(qe)}}return ye.join(`\r
`)}function pt(he){for(var we=[],ye=0;ye<he.length;++ye){for(var be=he[ye];ye<=he.length&&be.charAt(be.length-1)=="=";)be=be.slice(0,be.length-1)+he[++ye];we.push(be)}for(var Se=0;Se<we.length;++Se)we[Se]=we[Se].replace(/[=][0-9A-Fa-f]{2}/g,function(Te){return String.fromCharCode(parseInt(Te.slice(1),16))});return za(we.join(`\r
`))}function Nt(he,we,ye){for(var be="",Se="",Te="",We,at=0;at<10;++at){var qe=we[at];if(!qe||qe.match(/^\s*$/))break;var He=qe.match(/^(.*?):\s*([^\s].*)$/);if(He)switch(He[1].toLowerCase()){case"content-location":be=He[2].trim();break;case"content-type":Te=He[2].trim();break;case"content-transfer-encoding":Se=He[2].trim();break}}switch(++at,Se.toLowerCase()){case"base64":We=za(Ha(we.slice(at).join("")));break;case"quoted-printable":We=pt(we.slice(at));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Se)}var Ke=zt(he,be.slice(ye.length),We,{unsafe:!0});Te&&(Ke.ctype=Te)}function Vt(he,we){if(te(he.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ye=we&&we.root||"",be=(ar&&Buffer.isBuffer(he)?he.toString("binary"):te(he)).split(`\r
`),Se=0,Te="";for(Se=0;Se<be.length;++Se)if(Te=be[Se],!!/^Content-Location:/i.test(Te)&&(Te=Te.slice(Te.indexOf("file")),ye||(ye=Te.slice(0,Te.lastIndexOf("/")+1)),Te.slice(0,ye.length)!=ye))for(;ye.length>0&&(ye=ye.slice(0,ye.length-1),ye=ye.slice(0,ye.lastIndexOf("/")+1),Te.slice(0,ye.length)!=ye););var We=(be[1]||"").match(/boundary="(.*?)"/);if(!We)throw new Error("MAD cannot find boundary");var at="--"+(We[1]||""),qe=[],He=[],Ke={FileIndex:qe,FullPaths:He};O(Ke);var ht,bt=0;for(Se=0;Se<be.length;++Se){var Et=be[Se];Et!==at&&Et!==at+"--"||(bt++&&Nt(Ke,be.slice(ht,Se),ye),ht=Se)}return Ke}function yr(he,we){var ye=we||{},be=ye.boundary||"SheetJS";be="------="+be;for(var Se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+be.slice(2)+'"',"","",""],Te=he.FullPaths[0],We=Te,at=he.FileIndex[0],qe=1;qe<he.FullPaths.length;++qe)if(We=he.FullPaths[qe].slice(Te.length),at=he.FileIndex[qe],!(!at.size||!at.content||We=="Sh33tJ5")){We=We.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var He=at.content,Ke=ar&&Buffer.isBuffer(He)?He.toString("binary"):te(He),ht=0,bt=Math.min(1024,Ke.length),Et=0,xt=0;xt<=bt;++xt)(Et=Ke.charCodeAt(xt))>=32&&Et<128&&++ht;var pe=ht>=bt*4/5;Se.push(be),Se.push("Content-Location: "+(ye.root||"file:///C:/SheetJS/")+We),Se.push("Content-Transfer-Encoding: "+(pe?"quoted-printable":"base64")),Se.push("Content-Type: "+Oe(at,We)),Se.push(""),Se.push(pe?st(Ke):Ue(Ke))}return Se.push(be+`--\r
`),Se.join(`\r
`)}function _r(he){var we={};return O(we,he),we}function zt(he,we,ye,be){var Se=be&&be.unsafe;Se||O(he);var Te=!Se&&Pt.find(he,we);if(!Te){var We=he.FullPaths[0];we.slice(0,We.length)==We?We=we:(We.slice(-1)!="/"&&(We+="/"),We=(We+we).replace("//","/")),Te={name:n(we),type:2},he.FileIndex.push(Te),he.FullPaths.push(We),Se||Pt.utils.cfb_gc(he)}return Te.content=ye,Te.size=ye?ye.length:0,be&&(be.CLSID&&(Te.clsid=be.CLSID),be.mt&&(Te.mt=be.mt),be.ct&&(Te.ct=be.ct)),Te}function fr(he,we){O(he);var ye=Pt.find(he,we);if(ye){for(var be=0;be<he.FileIndex.length;++be)if(he.FileIndex[be]==ye)return he.FileIndex.splice(be,1),he.FullPaths.splice(be,1),!0}return!1}function Sr(he,we,ye){O(he);var be=Pt.find(he,we);if(be){for(var Se=0;Se<he.FileIndex.length;++Se)if(he.FileIndex[Se]==be)return he.FileIndex[Se].name=n(ye),he.FullPaths[Se]=ye,!0}return!1}function Zr(he){L(he,!0)}return t.find=ue,t.read=F,t.parse=m,t.write=ke,t.writeFile=ve,t.utils={cfb_new:_r,cfb_add:zt,cfb_del:fr,cfb_mov:Sr,cfb_gc:Zr,ReadShift:vd,CheckField:L5,prep_blob:Ks,bconcat:Is,use_zlib:M,_deflateRaw:De,_inflateRaw:ct,consts:re},t})();function Mz(e){return typeof e=="string"?vm(e):Array.isArray(e)?cz(e):e}function ff(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=vm(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?Hn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var n=new Blob([Mz(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=_o(t)),u.write(t),u.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function Bz(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function cs(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function GS(e,t){for(var r=[],s=cs(e),n=0;n!==s.length;++n)r[e[s[n]][t]]==null&&(r[e[s[n]][t]]=s[n]);return r}function wm(e){for(var t=[],r=cs(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function _m(e){for(var t=[],r=cs(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function Pz(e){for(var t=[],r=cs(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var H0=new Date(1899,11,30,0,0,0);function Rs(e,t){var r=e.getTime(),s=H0.getTime()+(e.getTimezoneOffset()-H0.getTimezoneOffset())*6e4;return(r-s)/(1440*60*1e3)}var m5=new Date,Uz=H0.getTime()+(m5.getTimezoneOffset()-H0.getTimezoneOffset())*6e4,VS=m5.getTimezoneOffset();function Nm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Uz),t.getTimezoneOffset()!==VS&&t.setTime(t.getTime()+(t.getTimezoneOffset()-VS)*6e4),t}function zz(e){var t=0,r=0,s=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=n.length;++o)if(n[o]){switch(r=1,o>3&&(s=!0),n[o].slice(n[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[o].slice(n[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[o],10)}return t}var KS=new Date("2017-02-19T19:06:09.000Z"),p5=isNaN(KS.getFullYear())?new Date("2/19/17"):KS,$z=p5.getFullYear()==2017;function Vr(e,t){var r=new Date(e);if($z)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(p5.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function xl(e,t){if(ar&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Hn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Hn(r5(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Hn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Hn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function Kr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Kr(e[r]));return t}function is(e,t){for(var r="";r.length<t;)r+=e;return r}function Tn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,o){return r=-r,o}),!isNaN(t=Number(s)))?t/r:t}var qz=["january","february","march","april","may","june","july","august","september","october","november","december"];function Zc(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),n=t.getMonth(),o=t.getDate();if(isNaN(o))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&qz.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||o>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Hz=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,n){if(e||typeof s=="string")return r.split(s);for(var o=r.split(s),l=[o[0]],u=1;u<o.length;++u)l.push(n),l.push(o[u]);return l}})();function x5(e){return e?e.content&&e.type?xl(e.content,!0):e.data?fd(e.data):e.asNodeBuffer&&ar?fd(e.asNodeBuffer().toString("binary")):e.asBinary?fd(e.asBinary()):e._data&&e._data.getContent?fd(xl(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function g5(e){if(!e)return null;if(e.data)return IS(e.data);if(e.asNodeBuffer&&ar)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?IS(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Wz(e){return e&&e.name.slice(-4)===".bin"?g5(e):x5(e)}function un(e,t){for(var r=e.FullPaths||cs(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),n=s.replace(/\\/g,"/"),o=0;o<r.length;++o){var l=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==l||n==l)return e.files?e.files[r[o]]:e.FileIndex[o]}return null}function qv(e,t){var r=un(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function ks(e,t,r){if(!r)return Wz(qv(e,t));if(!t)return null;try{return ks(e,t)}catch{return null}}function $a(e,t,r){if(!r)return x5(qv(e,t));if(!t)return null;try{return $a(e,t)}catch{return null}}function Gz(e,t,r){return g5(qv(e,t))}function XS(e){for(var t=e.FullPaths||cs(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function er(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return ar?s=Oi(r):s=uz(r),Pt.utils.cfb_add(e,t,s)}Pt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Hv(){return Pt.utils.cfb_new()}function y5(e,t){switch(t.type){case"base64":return Pt.read(e,{type:"base64"});case"binary":return Pt.read(e,{type:"binary"});case"buffer":case"array":return Pt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function md(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var n=s.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var ys=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Vz=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,YS=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Kz=/<[^>]*>/g,ua=ys.match(YS)?YS:Kz,Xz=/<\w*:/,Yz=/<(\/?)\w+:/;function Kt(e,t,r){for(var s={},n=0,o=0;n!==e.length&&!((o=e.charCodeAt(n))===32||o===10||o===13);++n);if(t||(s[0]=e.slice(0,n)),n===e.length)return s;var l=e.match(Vz),u=0,d="",h=0,m="",x="",y=1;if(l)for(h=0;h!=l.length;++h){for(x=l[h],o=0;o!=x.length&&x.charCodeAt(o)!==61;++o);for(m=x.slice(0,o).trim();x.charCodeAt(o+1)==32;)++o;for(y=(n=x.charCodeAt(o+1))==34||n==39?1:0,d=x.slice(o+1+y,x.length-y),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),s[m]=d,s[m.toLowerCase()]=d;else{var b=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(s[b]&&m.slice(u-3,u)=="ext")continue;s[b]=d,s[b.toLowerCase()]=d}}return s}function Kn(e){return e.replace(Yz,"<$1")}var v5={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Wv=wm(v5),xr=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var n=s+"",o=n.indexOf("<![CDATA[");if(o==-1)return n.replace(e,function(u,d){return v5[u]||String.fromCharCode(parseInt(d,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,d){return String.fromCharCode(parseInt(d,16))});var l=n.indexOf("]]>");return r(n.slice(0,o))+n.slice(o+9,l)+r(n.slice(l+3))}})(),Gv=/[&<>'"]/g,Jz=/[\u0000-\u0008\u000b-\u001f]/g;function Dr(e){var t=e+"";return t.replace(Gv,function(r){return Wv[r]}).replace(Jz,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function JS(e){return Dr(e).replace(/ /g,"_x0020_")}var b5=/[\u0000-\u001f]/g;function Vv(e){var t=e+"";return t.replace(Gv,function(r){return Wv[r]}).replace(/\n/g,"<br/>").replace(b5,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Zz(e){var t=e+"";return t.replace(Gv,function(r){return Wv[r]}).replace(b5,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var ZS=(function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}})();function Qz(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Gr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ry(e){for(var t="",r=0,s=0,n=0,o=0,l=0,u=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(n=e.charCodeAt(r++),s>191&&s<224){l=(s&31)<<6,l|=n&63,t+=String.fromCharCode(l);continue}if(o=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(n&63)<<6|o&63);continue}l=e.charCodeAt(r++),u=((s&7)<<18|(n&63)<<12|(o&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function QS(e){var t=po(2*e.length),r,s,n=1,o=0,l=0,u;for(s=0;s<e.length;s+=n)n=1,(u=e.charCodeAt(s))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(s+1)&63),n=2):u<240?(r=(u&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),n=3):(n=4,r=(u&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[o++]=l&255,t[o++]=l>>>8,l=0),t[o++]=r%256,t[o++]=r>>>8;return t.slice(0,o).toString("ucs2")}function e3(e){return Oi(e,"binary").toString("utf8")}var Qh="foo bar baz",Pr=ar&&(e3(Qh)==ry(Qh)&&e3||QS(Qh)==ry(Qh)&&QS)||ry,Hn=ar?function(e){return Oi(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,n=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},qd=(function(){var e={};return function(r,s){var n=r+"|"+(s||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}})(),w5=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)s=s.replace(e[n][0],e[n][1]);return s}})(),e$=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),t$=/<\/?(?:vt:)?variant>/g,r$=/<(?:vt:)([^>]*)>([\s\S]*)</;function t3(e,t){var r=Kt(e),s=e.match(e$(r.baseType))||[],n=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return n}return s.forEach(function(o){var l=o.replace(t$,"").match(r$);l&&n.push({v:Pr(l[2]),t:l[1]})}),n}var _5=/(^\s|\s$|\n)/;function Ys(e,t){return"<"+e+(t.match(_5)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Hd(e){return cs(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function kt(e,t,r){return"<"+e+(r!=null?Hd(r):"")+(t!=null?(t.match(_5)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Gy(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function s$(e,t){switch(typeof e){case"string":var r=kt("vt:lpwstr",Dr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return kt((e|0)==e?"vt:i4":"vt:r8",Dr(String(e)));case"boolean":return kt("vt:bool",e?"true":"false")}if(e instanceof Date)return kt("vt:filetime",Gy(e));throw new Error("Unable to serialize "+e)}function Kv(e){if(ar&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Pr(_o(Uv(e)));throw new Error("Bad input format: expected Buffer or string")}var Wd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Cs={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},jl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ma={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function a$(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,o=5;o>=0;--o)n=n*256+e[t+o];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function n$(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,n=0,o=0,l=s?-t:t;isFinite(l)?l==0?n=o=0:(n=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?n=-1022:(o-=Math.pow(2,52),n+=1023)):(n=2047,o=isNaN(t)?26985:0);for(var u=0;u<=5;++u,o/=256)e[r+u]=o&255;e[r+6]=(n&15)<<4|o&15,e[r+7]=n>>4|s}var r3=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var n=0,o=e[0][s].length;n<o;n+=r)t.push.apply(t,e[0][s].slice(n,n+r));return t},s3=ar?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Oi(t)})):r3(e)}:r3,a3=function(e,t,r){for(var s=[],n=t;n<r;n+=2)s.push(String.fromCharCode(vi(e,n)));return s.join("").replace(pa,"")},Xv=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(pa,""):a3(e,t,r)}:a3,n3=function(e,t,r){for(var s=[],n=t;n<t+r;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},N5=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):n3(e,t,r)}:n3,i3=function(e,t,r){for(var s=[],n=t;n<r;n++)s.push(String.fromCharCode(Rc(e,n)));return s.join("")},hf=ar?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):i3(t,r,s)}:i3,k5=function(e,t){var r=Ba(e,t);return r>0?hf(e,t+4,t+4+r-1):""},S5=k5,E5=function(e,t){var r=Ba(e,t);return r>0?hf(e,t+4,t+4+r-1):""},j5=E5,T5=function(e,t){var r=2*Ba(e,t);return r>0?hf(e,t+4,t+4+r-1):""},A5=T5,C5=function(t,r){var s=Ba(t,r);return s>0?Xv(t,r+4,r+4+s):""},R5=C5,D5=function(e,t){var r=Ba(e,t);return r>0?hf(e,t+4,t+4+r):""},O5=D5,F5=function(e,t){return a$(e,t)},W0=F5,Yv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ar&&(S5=function(t,r){if(!Buffer.isBuffer(t))return k5(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},j5=function(t,r){if(!Buffer.isBuffer(t))return E5(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},A5=function(t,r){if(!Buffer.isBuffer(t))return T5(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},R5=function(t,r){if(!Buffer.isBuffer(t))return C5(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},O5=function(t,r){if(!Buffer.isBuffer(t))return D5(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},W0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):F5(t,r)},Yv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Rc=function(e,t){return e[t]},vi=function(e,t){return e[t+1]*256+e[t]},i$=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ba=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Qo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},o$=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function vd(e,t){var r="",s,n,o=[],l,u,d,h;switch(t){case"dbcs":if(h=this.l,ar&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(vi(this,h)),h+=2;e*=2;break;case"utf8":r=hf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Xv(this,this.l,this.l+e);break;case"wstr":return vd.call(this,e,"dbcs");case"lpstr-ansi":r=S5(this,this.l),e=4+Ba(this,this.l);break;case"lpstr-cp":r=j5(this,this.l),e=4+Ba(this,this.l);break;case"lpwstr":r=A5(this,this.l),e=4+2*Ba(this,this.l);break;case"lpp4":e=4+Ba(this,this.l),r=R5(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ba(this,this.l),r=O5(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Rc(this,this.l+e++))!==0;)o.push(Zh(l));r=o.join("");break;case"_wstr":for(e=0,r="";(l=vi(this,this.l+e))!==0;)o.push(Zh(l)),e+=2;e+=2,r=o.join("");break;case"dbcs-cont":for(r="",h=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Rc(this,h),this.l=h+1,u=vd.call(this,e-d,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Zh(vi(this,h))),h+=2}r=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return l=Rc(this,h),this.l=h+1,u=vd.call(this,e-d,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Zh(Rc(this,h))),h+=1}r=o.join("");break;default:switch(e){case 1:return s=Rc(this,this.l),this.l++,s;case 2:return s=(t==="i"?i$:vi)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(s=(e>0?Qo:o$)(this,this.l),this.l+=4,s):(n=Ba(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=W0(this,this.l):n=W0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=N5(this,this.l,e);break}}return this.l+=e,r}var l$=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},c$=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},u$=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function d$(e,t,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)u$(this,t.charCodeAt(n),this.l+2*n);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;s=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var l=t.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,l$(this,t,this.l);break;case 8:if(s=8,r==="f"){n$(this,t,this.l);break}case 16:break;case-4:s=4,c$(this,t,this.l);break}return this.l+=s,this}function L5(e,t){var r=N5(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ks(e,t){e.l=t,e.read_shift=vd,e.chk=L5,e.write_shift=d$}function ca(e,t){e.l+=t}function nt(e){var t=po(e);return Ks(t,0),t}function Fi(e,t,r){if(e){var s,n,o;Ks(e,e.l||0);for(var l=e.length,u=0,d=0;e.l<l;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var h=Jd[u]||Jd[65535];for(s=e.read_shift(1),o=s&127,n=1;n<4&&s&128;++n)o+=((s=e.read_shift(1))&127)<<7*n;d=e.l+o;var m=h.f&&h.f(e,o,r);if(e.l=d,t(m,h,u))return}}}function ja(){var e=[],t=ar?256:2048,r=function(h){var m=nt(h);return Ks(m,0),m},s=r(t),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},o=function(h){return s&&h<s.length-s.l?s:(n(),s=r(Math.max(h+1,t)))},l=function(){return n(),Is(e)},u=function(h){n(),s=h,s.l==null&&(s.l=s.length),o(t)};return{next:o,push:u,end:l,_bufs:e}}function dt(e,t,r,s){var n=+t,o;if(!isNaN(n)){s||(s=Jd[n].p||(r||[]).length||0),o=1+(n>=128?1:0)+1,s>=128&&++o,s>=16384&&++o,s>=2097152&&++o;var l=e.next(o);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var u=0;u!=4;++u)if(s>=128)l.write_shift(1,(s&127)+128),s>>=7;else{l.write_shift(1,s);break}s>0&&Yv(r)&&e.push(r)}}function bd(e,t,r){var s=Kr(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function o3(e,t,r){var s=Kr(e);return s.s=bd(s.s,t.s,r),s.e=bd(s.e,t.s,r),s}function wd(e,t){if(e.cRel&&e.c<0)for(e=Kr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Kr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Gt(e);return!e.cRel&&e.cRel!=null&&(r=m$(r)),!e.rRel&&e.rRel!=null&&(r=f$(r)),r}function sy(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+es(e.s.c)+":"+(e.e.cRel?"":"$")+es(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+xs(e.s.r)+":"+(e.e.rRel?"":"$")+xs(e.e.r):wd(e.s,t.biff)+":"+wd(e.e,t.biff)}function Jv(e){return parseInt(h$(e),10)-1}function xs(e){return""+(e+1)}function f$(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function h$(e){return e.replace(/\$(\d+)$/,"$1")}function Zv(e){for(var t=p$(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function es(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function m$(e){return e.replace(/^([A-Z])/,"$$$1")}function p$(e){return e.replace(/^\$([A-Z])/,"$1")}function x$(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ts(e){for(var t=0,r=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Gt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ta(e){var t=e.indexOf(":");return t==-1?{s:ts(e),e:ts(e)}:{s:ts(e.slice(0,t)),e:ts(e.slice(t+1))}}function Zt(e,t){return typeof t>"u"||typeof t=="number"?Zt(e.s,e.e):(typeof e!="string"&&(e=Gt(e)),typeof t!="string"&&(t=Gt(t)),e==t?e:e+":"+t)}function gr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,o=e.length;for(r=0;s<o&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.s.c=--r,r=0;s<o&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(t.s.r=--r,s===o||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=o&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.e.c=--r,r=0;s!=o&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return t.e.r=--r,t}function l3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=mn(e.z,r?Rs(t):t)}catch{}try{return e.w=mn((e.XF||{}).numFmtId||(r?14:0),r?Rs(t):t)}catch{return""+t}}function ji(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Li[e.v]||e.v:t==null?l3(e,e.v):l3(e,t))}function No(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function I5(e,t,r){var s=r||{},n=e?Array.isArray(e):s.dense,o=e||(n?[]:{}),l=0,u=0;if(o&&s.origin!=null){if(typeof s.origin=="number")l=s.origin;else{var d=typeof s.origin=="string"?ts(s.origin):s.origin;l=d.r,u=d.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var m=gr(o["!ref"]);h.s.c=m.s.c,h.s.r=m.s.r,h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),l==-1&&(h.e.r=l=m.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=t[x].length;++y)if(!(typeof t[x][y]>"u")){var b={v:t[x][y]},v=l+x,g=u+y;if(h.s.r>v&&(h.s.r=v),h.s.c>g&&(h.s.c=g),h.e.r<v&&(h.e.r=v),h.e.c<g&&(h.e.c=g),t[x][y]&&typeof t[x][y]=="object"&&!Array.isArray(t[x][y])&&!(t[x][y]instanceof Date))b=t[x][y];else if(Array.isArray(b.v)&&(b.f=t[x][y][1],b.v=b.v[0]),b.v===null)if(b.f)b.t="n";else if(s.nullError)b.t="e",b.v=0;else if(s.sheetStubs)b.t="z";else continue;else typeof b.v=="number"?b.t="n":typeof b.v=="boolean"?b.t="b":b.v instanceof Date?(b.z=s.dateNF||Wt[14],s.cellDates?(b.t="d",b.w=mn(b.z,Rs(b.v))):(b.t="n",b.v=Rs(b.v),b.w=mn(b.z,b.v))):b.t="s";if(n)o[v]||(o[v]=[]),o[v][g]&&o[v][g].z&&(b.z=o[v][g].z),o[v][g]=b;else{var _=Gt({c:g,r:v});o[_]&&o[_].z&&(b.z=o[_].z),o[_]=b}}}return h.s.c<1e7&&(o["!ref"]=Zt(h)),o}function lu(e,t){return I5(null,e,t)}function g$(e){return e.read_shift(4,"i")}function An(e,t){return t||(t=nt(4)),t.write_shift(4,e),t}function oa(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ms(e,t){var r=!1;return t==null&&(r=!0,t=nt(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function y$(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function v$(e,t){return t||(t=nt(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Qv(e,t){var r=e.l,s=e.read_shift(1),n=oa(e),o=[],l={t:n,h:n};if((s&1)!==0){for(var u=e.read_shift(4),d=0;d!=u;++d)o.push(y$(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function b$(e,t){var r=!1;return t==null&&(r=!0,t=nt(15+4*e.t.length)),t.write_shift(1,0),Ms(e.t,t),r?t.slice(0,t.l):t}var w$=Qv;function _$(e,t){var r=!1;return t==null&&(r=!0,t=nt(23+4*e.t.length)),t.write_shift(1,1),Ms(e.t,t),t.write_shift(4,1),v$({},t),r?t.slice(0,t.l):t}function xn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Tl(e,t){return t==null&&(t=nt(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Al(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Cl(e,t){return t==null&&(t=nt(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var N$=oa,M5=Ms;function eb(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function G0(e,t){var r=!1;return t==null&&(r=!0,t=nt(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var k$=oa,Vy=eb,tb=G0;function rb(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var n=s===0?W0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Qo(t,0)>>2;return r?n/100:n}function B5(e,t){t==null&&(t=nt(4));var r=0,s=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function P5(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function S$(e,t){return t||(t=nt(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Rl=P5,cu=S$;function na(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function gl(e,t){return(t||nt(8)).write_shift(8,e,"f")}function E$(e){var t={},r=e.read_shift(1),s=r>>>1,n=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),u=e.read_shift(1),d=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=n;var h=ll[n];h&&(t.rgb=Vd(h));break;case 2:t.rgb=Vd([l,u,d]);break;case 3:t.theme=n;break}return o!=0&&(t.tint=o>0?o/32767:o/32768),t}function V0(e,t){if(t||(t=nt(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function j$(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function T$(e,t){t||(t=nt(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function U5(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function A$(e){return U5(e,1)}function C$(e){return U5(e,2)}var sb=2,ka=3,e0=11,c3=12,K0=19,t0=64,R$=65,D$=71,O$=4108,F$=4126,Ls=80,z5=81,L$=[Ls,z5],Ky={1:{n:"CodePage",t:sb},2:{n:"Category",t:Ls},3:{n:"PresentationFormat",t:Ls},4:{n:"ByteCount",t:ka},5:{n:"LineCount",t:ka},6:{n:"ParagraphCount",t:ka},7:{n:"SlideCount",t:ka},8:{n:"NoteCount",t:ka},9:{n:"HiddenCount",t:ka},10:{n:"MultimediaClipCount",t:ka},11:{n:"ScaleCrop",t:e0},12:{n:"HeadingPairs",t:O$},13:{n:"TitlesOfParts",t:F$},14:{n:"Manager",t:Ls},15:{n:"Company",t:Ls},16:{n:"LinksUpToDate",t:e0},17:{n:"CharacterCount",t:ka},19:{n:"SharedDoc",t:e0},22:{n:"HyperlinksChanged",t:e0},23:{n:"AppVersion",t:ka,p:"version"},24:{n:"DigSig",t:R$},26:{n:"ContentType",t:Ls},27:{n:"ContentStatus",t:Ls},28:{n:"Language",t:Ls},29:{n:"Version",t:Ls},255:{},2147483648:{n:"Locale",t:K0},2147483651:{n:"Behavior",t:K0},1919054434:{}},Xy={1:{n:"CodePage",t:sb},2:{n:"Title",t:Ls},3:{n:"Subject",t:Ls},4:{n:"Author",t:Ls},5:{n:"Keywords",t:Ls},6:{n:"Comments",t:Ls},7:{n:"Template",t:Ls},8:{n:"LastAuthor",t:Ls},9:{n:"RevNumber",t:Ls},10:{n:"EditTime",t:t0},11:{n:"LastPrinted",t:t0},12:{n:"CreatedDate",t:t0},13:{n:"ModifiedDate",t:t0},14:{n:"PageCount",t:ka},15:{n:"WordCount",t:ka},16:{n:"CharCount",t:ka},17:{n:"Thumbnail",t:D$},18:{n:"Application",t:Ls},19:{n:"DocSecurity",t:ka},255:{},2147483648:{n:"Locale",t:K0},2147483651:{n:"Behavior",t:K0},1919054434:{}},u3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},I$=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function M$(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var B$=M$([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ll=Kr(B$),Li={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$5={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Yy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},r0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ab(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function P$(e){var t=ab();if(!e||!e.match)return t;var r={};if((e.match(ua)||[]).forEach(function(s){var n=Kt(s);switch(n[0].replace(Xz,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Yy[n.ContentType]]!==void 0&&t[Yy[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Cs.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function q5(e,t){var r=Pz(Yy),s=[],n;s[s.length]=ys,s[s.length]=kt("Types",null,{xmlns:Cs.CT,"xmlns:xsd":Cs.xsd,"xmlns:xsi":Cs.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return kt("Default",null,{Extension:d[0],ContentType:d[1]})}));var o=function(d){e[d]&&e[d].length>0&&(n=e[d][0],s[s.length]=kt("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:r0[d][t.bookType]||r0[d].xlsx}))},l=function(d){(e[d]||[]).forEach(function(h){s[s.length]=kt("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r0[d][t.bookType]||r0[d].xlsx})})},u=function(d){(e[d]||[]).forEach(function(h){s[s.length]=kt("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[d][0]})})};return o("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var ir={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Gd(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function _d(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(ua)||[]).forEach(function(n){var o=Kt(n);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:md(o.Target,t);r[u]=l,s[o.Id]=l}}),r["!id"]=s,r}function Uc(e){var t=[ys,kt("Relationships",null,{xmlns:Cs.RELS})];return cs(e["!id"]).forEach(function(r){t[t.length]=kt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Cr(e,t,r,s,n,o){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=s,n.Target=r,[ir.HLINK,ir.XPATH,ir.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var U$="application/vnd.oasis.opendocument.spreadsheet";function z$(e,t){for(var r=Kv(e),s,n;s=Wd.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(n=Kt(s[0],!1),n.path=="/"&&n.type!==U$)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}function $$(e){var t=[ys];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function d3(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function q$(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function H$(e){var t=[ys];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(d3(e[r][0],e[r][1])),t.push(q$("",e[r][0]));return t.push(d3("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function H5(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+U0.version+"</meta:generator></office:meta></office:document-meta>"}var fn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],W$=(function(){for(var e=new Array(fn.length),t=0;t<fn.length;++t){var r=fn[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e})();function W5(e){var t={};e=Pr(e);for(var r=0;r<fn.length;++r){var s=fn[r],n=e.match(W$[r]);n!=null&&n.length>0&&(t[s[1]]=xr(n[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=Vr(t[s[1]]))}return t}function ay(e,t,r,s,n){n[e]!=null||t==null||t===""||(n[e]=t,t=Dr(t),s[s.length]=r?kt(e,t,r):Ys(e,t))}function G5(e,t){var r=t||{},s=[ys,kt("cp:coreProperties",null,{"xmlns:cp":Cs.CORE_PROPS,"xmlns:dc":Cs.dc,"xmlns:dcterms":Cs.dcterms,"xmlns:dcmitype":Cs.dcmitype,"xmlns:xsi":Cs.xsi})],n={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&ay("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Gy(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),e.ModifiedDate!=null&&ay("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Gy(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var o=0;o!=fn.length;++o){var l=fn[o],u=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&ay(l[0],u,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var cl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],V5=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function K5(e,t,r,s){var n=[];if(typeof e=="string")n=t3(e,s);else for(var o=0;o<e.length;++o)n=n.concat(e[o].map(function(m){return{v:m}}));var l=typeof t=="string"?t3(t,s).map(function(m){return m.v}):t,u=0,d=0;if(l.length>0)for(var h=0;h!==n.length;h+=2){switch(d=+n[h+1].v,n[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=d,r.SheetNames=l.slice(u,u+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=d,r.DefinedNames=l.slice(u,u+d);break;case"Charts":case"Diagramme":r.Chartsheets=d,r.ChartNames=l.slice(u,u+d);break}u+=d}}function G$(e,t,r){var s={};return t||(t={}),e=Pr(e),cl.forEach(function(n){var o=(e.match(qd(n[0]))||[])[1];switch(n[2]){case"string":o&&(t[n[1]]=xr(o));break;case"bool":t[n[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(s[n[1]]=l[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&K5(s.HeadingPairs,s.TitlesOfParts,t,r),t}function X5(e){var t=[],r=kt;return e||(e={}),e.Application="SheetJS",t[t.length]=ys,t[t.length]=kt("Properties",null,{xmlns:Cs.EXT_PROPS,"xmlns:vt":Cs.vt}),cl.forEach(function(s){if(e[s[1]]!==void 0){var n;switch(s[2]){case"string":n=Dr(String(e[s[1]]));break;case"bool":n=e[s[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(s[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+Dr(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var V$=/<[^>]+>[^<]*/g;function K$(e,t){var r={},s="",n=e.match(V$);if(n)for(var o=0;o!=n.length;++o){var l=n[o],u=Kt(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":s=xr(u.name);break;case"</property>":s=null;break;default:if(l.indexOf("<vt:")===0){var d=l.split(">"),h=d[0].slice(4),m=d[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[s]=xr(m);break;case"bool":r[s]=Gr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(m);break;case"filetime":case"date":r[s]=Vr(m);break;case"cy":case"error":r[s]=xr(m);break;default:if(h.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,h,d)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function Y5(e){var t=[ys,kt("Properties",null,{xmlns:Cs.CUST_PROPS,"xmlns:vt":Cs.vt})];if(!e)return t.join("");var r=1;return cs(e).forEach(function(n){++r,t[t.length]=kt("property",s$(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Dr(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Jy={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ny;function X$(e,t,r){ny||(ny=wm(Jy)),t=ny[t]||t,e[t]=r}function Y$(e,t){var r=[];return cs(Jy).map(function(s){for(var n=0;n<fn.length;++n)if(fn[n][1]==s)return fn[n];for(n=0;n<cl.length;++n)if(cl[n][1]==s)return cl[n];throw s}).forEach(function(s){if(e[s[1]]!=null){var n=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];s[2]==="date"&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"Z")),typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(Ys(Jy[s[1]]||s[1],n))}}),kt("DocumentProperties",r.join(""),{xmlns:Ma.o})}function J$(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return e&&cs(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var l=0;l<fn.length;++l)if(o==fn[l][1])return;for(l=0;l<cl.length;++l)if(o==cl[l][1])return;for(l=0;l<r.length;++l)if(o==r[l])return;var u=e[o],d="string";typeof u=="number"?(d="float",u=String(u)):u===!0||u===!1?(d="boolean",u=u?"1":"0"):u=String(u),n.push(kt(JS(o),u,{"dt:dt":d}))}}),t&&cs(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var l=t[o],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),n.push(kt(JS(o),l,{"dt:dt":u}))}}),"<"+s+' xmlns="'+Ma.o+'">'+n.join("")+"</"+s+">"}function nb(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Z$(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),n=(r-s)/Math.pow(2,32);s*=1e7,n*=1e7;var o=s/Math.pow(2,32)|0;o>0&&(s=s%Math.pow(2,32),n+=o);var l=nt(8);return l.write_shift(4,s),l.write_shift(4,n),l}function J5(e,t,r){var s=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return n}function Z5(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function Q5(e,t,r){return t===31?Z5(e):J5(e,t,r)}function Zy(e,t,r){return Q5(e,t,r===!1?0:4)}function Q$(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Q5(e,t,0)}function eq(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var n=e.l;r[s]=e.read_shift(0,"lpwstr").replace(pa,""),e.l-n&2&&(e.l+=2)}return r}function tq(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(pa,"");return r}function rq(e){var t=e.l,r=X0(e,z5);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=X0(e,ka);return[r,s]}function sq(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push(rq(e));return r}function f3(e,t){for(var r=e.read_shift(4),s={},n=0;n!=r;++n){var o=e.read_shift(4),l=e.read_shift(4);s[o]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(pa,"").replace(hd,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function eT(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function aq(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function X0(e,t,r){var s=e.read_shift(2),n,o=r||{};if(e.l+=2,t!==c3&&s!==t&&L$.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===c3?s:t){case 2:return n=e.read_shift(2,"i"),o.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return J5(e,s,4).replace(pa,"");case 31:return Z5(e);case 64:return nb(e);case 65:return eT(e);case 71:return aq(e);case 80:return Zy(e,s,!o.raw).replace(pa,"");case 81:return Q$(e,s).replace(pa,"");case 4108:return sq(e);case 4126:case 4127:return s==4127?eq(e):tq(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function h3(e,t){var r=nt(4),s=nt(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=nt(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=Z$(t);break;case 31:case 80:for(s=nt(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Is([r,s])}function m3(e,t){var r=e.l,s=e.read_shift(4),n=e.read_shift(4),o=[],l=0,u=0,d=-1,h={};for(l=0;l!=n;++l){var m=e.read_shift(4),x=e.read_shift(4);o[l]=[m,x+r]}o.sort(function(S,N){return S[1]-N[1]});var y={};for(l=0;l!=n;++l){if(e.l!==o[l][1]){var b=!0;if(l>0&&t)switch(t[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,b=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],b=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],b=!1);break}if((!t||l==0)&&e.l<=o[l][1]&&(b=!1,e.l=o[l][1]),b)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(t){var v=t[o[l][0]];if(y[v.n]=X0(e,v.t,{raw:!0}),v.p==="version"&&(y[v.n]=String(y[v.n]>>16)+"."+("0000"+String(y[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(y[v.n]){case 0:y[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:En(u=y[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[v.n])}}else if(o[l][0]===1){if(u=y.CodePage=X0(e,sb),En(u),d!==-1){var g=e.l;e.l=o[d][1],h=f3(e,u),e.l=g}}else if(o[l][0]===0){if(u===0){d=l,e.l=o[l+1][1];continue}h=f3(e,u)}else{var _=h[o[l][0]],w;switch(e[e.l]){case 65:e.l+=4,w=eT(e);break;case 30:e.l+=4,w=Zy(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=Zy(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=ps(e,4);break;case 64:e.l+=4,w=Vr(nb(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[_]=w}}return e.l=r+s,y}var tT=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function nq(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function p3(e,t,r){var s=nt(8),n=[],o=[],l=8,u=0,d=nt(8),h=nt(8);if(d.write_shift(4,2),d.write_shift(4,1200),h.write_shift(4,1),o.push(d),n.push(h),l+=8+d.length,!t){h=nt(8),h.write_shift(4,0),n.unshift(h);var m=[nt(4)];for(m[0].write_shift(4,e.length),u=0;u<e.length;++u){var x=e[u][0];for(d=nt(8+2*(x.length+1)+(x.length%2?0:2)),d.write_shift(4,u+2),d.write_shift(4,x.length+1),d.write_shift(0,x,"dbcs");d.l!=d.length;)d.write_shift(1,0);m.push(d)}d=Is(m),o.unshift(d),l+=8+d.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(tT.indexOf(e[u][0])>-1||V5.indexOf(e[u][0])>-1)&&e[u][1]!=null){var y=e[u][1],b=0;if(t){b=+t[e[u][0]];var v=r[b];if(v.p=="version"&&typeof y=="string"){var g=y.split(".");y=(+g[0]<<16)+(+g[1]||0)}d=h3(v.t,y)}else{var _=nq(y);_==-1&&(_=31,y=String(y)),d=h3(_,y)}o.push(d),h=nt(8),h.write_shift(4,t?b:2+u),n.push(h),l+=8+d.length}var w=8*(o.length+1);for(u=0;u<o.length;++u)n[u].write_shift(4,w),w+=o[u].length;return s.write_shift(4,l),s.write_shift(4,o.length),Is([s].concat(n).concat(o))}function x3(e,t,r){var s=e.content;if(!s)return{};Ks(s,0);var n,o,l,u,d=0;s.chk("feff","Byte Order: "),s.read_shift(2);var h=s.read_shift(4),m=s.read_shift(16);if(m!==Pt.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(n=s.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(o=s.read_shift(16),u=s.read_shift(4),n===1&&u!==s.l)throw new Error("Length mismatch: "+u+" !== "+s.l);n===2&&(l=s.read_shift(16),d=s.read_shift(4));var x=m3(s,t),y={SystemIdentifier:h};for(var b in x)y[b]=x[b];if(y.FMTID=o,n===1)return y;if(d-s.l==2&&(s.l+=2),s.l!==d)throw new Error("Length mismatch 2: "+s.l+" !== "+d);var v;try{v=m3(s,null)}catch{}for(b in v)y[b]=v[b];return y.FMTID=[o,l],y}function g3(e,t,r,s,n,o){var l=nt(n?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Pt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,n?68:48);var d=p3(e,r,s);if(u.push(d),n){var h=p3(n,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+d.length),u.push(h)}return Is(u)}function oo(e,t){return e.read_shift(t),null}function iq(e,t){t||(t=nt(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function oq(e,t,r){for(var s=[],n=e.l+t;e.l<n;)s.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return s}function ps(e,t){return e.read_shift(t)===1}function ha(e,t){return t||(t=nt(2)),t.write_shift(2,+!!e),t}function Ss(e){return e.read_shift(2,"u")}function dn(e,t){return t||(t=nt(2)),t.write_shift(2,e),t}function rT(e,t){return oq(e,t,Ss)}function lq(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function sT(e,t,r){return r||(r=nt(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function mf(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=e.read_shift(1);o&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=s?e.read_shift(s,n):"";return l}function cq(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,n=r&8,o=1+(r&1),l=0,u,d={};n&&(l=e.read_shift(2)),s&&(u=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",m=t===0?"":e.read_shift(t,h);return n&&(e.l+=4*l),s&&(e.l+=u),d.t=m,n||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function uq(e){var t=e.t||"",r=nt(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=nt(2*t.length);s.write_shift(2*t.length,t,"utf16le");var n=[r,s];return Is(n)}function yl(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function pf(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):yl(e,s,r)}function Dl(e,t,r){if(r.biff>5)return pf(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function aT(e,t,r){return r||(r=nt(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function dq(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function fq(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var n=e.read_shift((s?t-24:t)>>1,"utf16le").replace(pa,"");return s&&(e.l+=24),n}function hq(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+s.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(pa,"");return r+l}function mq(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return fq(e);case"0303000000000000c000000000000046":return hq(e);default:throw new Error("Unsupported Moniker "+r)}}function s0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(pa,""):"";return r}function y3(e,t){t||(t=nt(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function pq(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var n=e.read_shift(2);e.l+=2;var o,l,u,d,h="",m,x;n&16&&(o=s0(e,r-e.l)),n&128&&(l=s0(e,r-e.l)),(n&257)===257&&(u=s0(e,r-e.l)),(n&257)===1&&(d=mq(e,r-e.l)),n&8&&(h=s0(e,r-e.l)),n&32&&(m=e.read_shift(16)),n&64&&(x=nb(e)),e.l=r;var y=l||u||d||"";y&&h&&(y+="#"+h),y||(y="#"+h),n&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var b={Target:y};return m&&(b.guid=m),x&&(b.time=x),o&&(b.Tooltip=o),b}function xq(e){var t=nt(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var n=s.indexOf("#"),o=n>-1?31:23;switch(s.charAt(0)){case"#":o=28;break;case".":o&=-3;break}t.write_shift(4,2),t.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(o==28)s=s.slice(1),y3(s,t);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var u=n>-1?s.slice(0,n):s;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),o&8&&y3(n>-1?s.slice(n+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var d=0;s.slice(d*3,d*3+3)=="../"||s.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,s.length-3*d+1),r=0;r<s.length-3*d;++r)t.write_shift(1,s.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function nT(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),n=e.read_shift(1);return[t,r,s,n]}function iT(e,t){var r=nT(e);return r[3]=0,r}function Xn(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function vl(e,t,r,s){return s||(s=nt(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function gq(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function yq(e,t,r){return t===0?"":Dl(e,t,r)}function vq(e,t,r){var s=r.biff>8?4:2,n=e.read_shift(s),o=e.read_shift(s,"i"),l=e.read_shift(s,"i");return[n,o,l]}function oT(e){var t=e.read_shift(2),r=rb(e);return[t,r]}function bq(e,t,r){e.l+=4,t-=4;var s=e.l+t,n=mf(e,t,r),o=e.read_shift(2);if(s-=e.l,o!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+o);return e.l+=o,n}function km(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return{s:{c:s,r:t},e:{c:n,r}}}function lT(e,t){return t||(t=nt(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function cT(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),n=e.read_shift(1);return{s:{c:s,r:t},e:{c:n,r}}}var wq=cT;function uT(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function _q(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Nq(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ea(e){e.l+=2,e.l+=e.read_shift(2)}var kq={0:ea,4:ea,5:ea,6:ea,7:Nq,8:ea,9:ea,10:ea,11:ea,12:ea,13:_q,14:ea,15:ea,16:ea,17:ea,18:ea,19:ea,20:ea,21:uT};function Sq(e,t){for(var r=e.l+t,s=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{s.push(kq[n](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function a0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function ib(e,t,r){var s=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=nt(n);return o.write_shift(2,s),o.write_shift(2,t),n>4&&o.write_shift(2,29282),n>6&&o.write_shift(2,1997),n>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function Eq(e,t){return t===0||e.read_shift(2),1200}function jq(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,n=Dl(e,0,r);return e.read_shift(t+s-e.l),n}function Tq(e,t){var r=!t||t.biff==8,s=nt(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function Aq(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function Cq(e,t,r){var s=e.read_shift(4),n=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=mf(e,0,r);return l.length===0&&(l="Sheet1"),{pos:s,hs:n,dt:o,name:l}}function Rq(e,t){var r=!t||t.biff>=8?2:1,s=nt(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function Dq(e,t){for(var r=e.l+t,s=e.read_shift(4),n=e.read_shift(4),o=[],l=0;l!=n&&e.l<r;++l)o.push(cq(e));return o.Count=s,o.Unique=n,o}function Oq(e,t){var r=nt(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],n=0;n<e.length;++n)s[n]=uq(e[n]);var o=Is([r].concat(s));return o.parts=[r.length].concat(s.map(function(l){return l.length})),o}function Fq(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Lq(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function Iq(e){var t=gq(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Mq(e){return e.read_shift(2),e.read_shift(4)}function v3(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(s=1-(n>>15),n&=32767);var o={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[o,n]}function Bq(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),h=e.read_shift(2);return{Pos:[t,r],Dim:[s,n],Flags:o,CurTab:l,FirstTab:u,Selected:d,TabRatio:h}}function Pq(){var e=nt(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Uq(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function zq(e){var t=nt(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function $q(){}function qq(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=mf(e,0,r),s}function Hq(e,t){var r=e.name||"Arial",s=t&&t.biff==5,n=s?15+r.length:16+2*r.length,o=nt(n);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,r.length),s||o.write_shift(1,1),o.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),o}function Wq(e){var t=Xn(e);return t.isst=e.read_shift(4),t}function Gq(e,t,r,s){var n=nt(10);return vl(e,t,s,n),n.write_shift(4,r),n}function Vq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,n=Xn(e);r.biff==2&&e.l++;var o=pf(e,s-e.l,r);return n.val=o,n}function Kq(e,t,r,s,n){var o=!n||n.biff==8,l=nt(8+ +o+(1+o)*r.length);return vl(e,t,s,l),l.write_shift(2,r.length),o&&l.write_shift(1,1),l.write_shift((1+o)*r.length,r,o?"utf16le":"sbcs"),l}function Xq(e,t,r){var s=e.read_shift(2),n=Dl(e,0,r);return[s,n]}function Yq(e,t,r,s){var n=r&&r.biff==5;s||(s=nt(n?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(n?1:2,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var o=s.length>s.l?s.slice(0,s.l):s;return o.l==null&&(o.l=o.length),o}var Jq=Dl;function b3(e,t,r){var s=e.l+t,n=r.biff==8||!r.biff?4:2,o=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(2),d=e.read_shift(2);return e.l=s,{s:{r:o,c:u},e:{r:l,c:d}}}function Zq(e,t){var r=t.biff==8||!t.biff?4:2,s=nt(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function Qq(e){var t=e.read_shift(2),r=e.read_shift(2),s=oT(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function eH(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),o=[];e.l<r;)o.push(oT(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:s,c:n,C:l,rkrec:o}}function tH(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),o=[];e.l<r;)o.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:s,c:n,C:l,ixfe:o}}function rH(e,t,r,s){var n={},o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2);return n.patternType=I$[u>>26],s.cellStyles&&(n.alc=o&7,n.fWrap=o>>3&1,n.alcV=o>>4&7,n.fJustLast=o>>7&1,n.trot=o>>8&255,n.cIndent=o>>16&15,n.fShrinkToFit=o>>20&1,n.iReadOrder=o>>22&2,n.fAtrNum=o>>26&1,n.fAtrFnt=o>>27&1,n.fAtrAlc=o>>28&1,n.fAtrBdr=o>>29&1,n.fAtrPat=o>>30&1,n.fAtrProt=o>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=u&127,n.icvBottom=u>>7&127,n.icvDiag=u>>14&127,n.dgDiag=u>>21&15,n.icvFore=d&127,n.icvBack=d>>7&127,n.fsxButton=d>>14&1),n}function sH(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=rH(e,t,s.fStyle,r),s}function w3(e,t,r,s){var n=r&&r.biff==5;s||(s=nt(n?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var o=0;return e.numFmtId>0&&n&&(o|=1024),s.write_shift(4,o),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function aH(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function nH(e){var t=nt(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function _3(e,t,r){var s=Xn(e);(r.biff==2||t==9)&&++e.l;var n=lq(e);return s.val=n,s.t=n===!0||n===!1?"b":"e",s}function iH(e,t,r,s,n,o){var l=nt(8);return vl(e,t,s,l),sT(r,o,l),l}function oH(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=Xn(e),n=na(e);return s.val=n,s}function lH(e,t,r,s){var n=nt(14);return vl(e,t,s,n),gl(r,n),n}var N3=yq;function cH(e,t,r){var s=e.l+t,n=e.read_shift(2),o=e.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,n];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=yl(e,o),u=[];s>e.l;)u.push(pf(e));return[o,n,l,u]}function k3(e,t,r){var s=e.read_shift(2),n,o={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(n=bq(e,t-2,r)),o.body=n||e.read_shift(t-2),typeof n=="string"&&(o.Name=n),o}var uH=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function S3(e,t,r){var s=e.l+t,n=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),d=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),d=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var h=yl(e,l,r);n&32&&(h=uH[h.charCodeAt(0)]);var m=s-e.l;r&&r.biff==2&&--m;var x=s==e.l||u===0||!(m>0)?[]:SK(e,m,r,u);return{chKey:o,Name:h,itab:d,rgce:x}}function dT(e,t,r){if(r.biff<8)return dH(e,t,r);for(var s=[],n=e.l+t,o=e.read_shift(r.biff>8?4:2);o--!==0;)s.push(vq(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function dH(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=mf(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function fH(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),n=e.read_shift(2),o=yl(e,s,r),l=yl(e,n,r);return[o,l]}function hH(e,t,r){var s=cT(e);e.l++;var n=e.read_shift(1);return t-=8,[EK(e,t,r),n,s]}function E3(e,t,r){var s=wq(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,NK(e,t,r)]}function mH(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function pH(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=Dl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:n},u,l,o]}}function xH(e,t,r){return pH(e,t,r)}function gH(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(km(e));return r}function yH(e){var t=nt(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)lT(e[r],t);return t}function vH(e,t,r){if(r&&r.biff<8)return wH(e,t,r);var s=uT(e),n=Sq(e,t-22,s[1]);return{cmo:s,ft:n}}var bH={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:s}}};function wH(e,t,r){e.l+=4;var s=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((bH[s]||ca)(e,t,r)),{cmo:[n,s,o],ft:l}}function _H(e,t,r){var s=e.l,n="";try{e.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=dq(e,6,r);var u=e.read_shift(2);e.read_shift(2),Ss(e,2);var d=e.read_shift(2);e.l+=d;for(var h=1;h<e.lens.length-1;++h){if(e.l-s!=e.lens[h])throw new Error("TxO: bad continue record");var m=e[e.l],x=yl(e,e.lens[h+1]-e.lens[h]-1);if(n+=x,n.length>=(m?u:2*u))break}if(n.length!==u&&n.length!==u*2)throw new Error("cchText: "+u+" != "+n.length);return e.l=s+t,{t:n}}catch{return e.l=s+t,{t:n}}}function NH(e,t){var r=km(e);e.l+=16;var s=pq(e,t-24);return[r,s]}function kH(e){var t=nt(24),r=ts(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(s[n],16));return Is([t,xq(e[1])])}function SH(e,t){e.read_shift(2);var r=km(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(pa,""),[r,s]}function EH(e){var t=e[1].Tooltip,r=nt(10+2*(t.length+1));r.write_shift(2,2048);var s=ts(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function jH(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=u3[r]||r,r=e.read_shift(2),t[1]=u3[r]||r,t}function TH(e){return e||(e=nt(4)),e.write_shift(2,1),e.write_shift(2,1),e}function AH(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(iT(e));return r}function CH(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(iT(e));return r}function RH(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function fT(e,t,r){if(!r.cellStyles)return ca(e,t);var s=r&&r.biff>=12?4:2,n=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(s),u=e.read_shift(s),d=e.read_shift(2);s==2&&(e.l+=2);var h={s:n,e:o,w:l,ixfe:u,flags:d};return(r.biff>=5||!r.biff)&&(h.level=d>>8&7),h}function DH(e,t){var r=nt(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function OH(e,t){var r={};return t<32||(e.l+=16,r.header=na(e),r.footer=na(e),e.l+=2),r}function FH(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var n=e.read_shift(1);return e.l+=3,n&16&&(s.area=!0),s}function LH(e){for(var t=nt(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var IH=Xn,MH=rT,BH=pf;function PH(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,n}function UH(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=Xn(e);++e.l;var n=Dl(e,t-7,r);return s.t="str",s.val=n,s}function zH(e){var t=Xn(e);++e.l;var r=na(e);return t.t="n",t.val=r,t}function $H(e,t,r){var s=nt(15);return vf(s,e,t),s.write_shift(8,r,"f"),s}function qH(e){var t=Xn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function HH(e,t,r){var s=nt(9);return vf(s,e,t),s.write_shift(2,r),s}function WH(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function GH(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function VH(e,t,r){var s=e.l+t,n=Xn(e),o=e.read_shift(2),l=yl(e,o,r);return e.l=s,n.t="str",n.val=l,n}var KH=[2,3,48,49,131,139,140,245],Qy=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=wm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,d){var h=[],m=po(1);switch(d.type){case"base64":m=za(Ha(u));break;case"binary":m=za(u);break;case"buffer":case"array":m=u;break}Ks(m,0);var x=m.read_shift(1),y=!!(x&136),b=!1,v=!1;switch(x){case 2:break;case 3:break;case 48:b=!0,y=!0;break;case 49:b=!0,y=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var g=0,_=521;x==2&&(g=m.read_shift(2)),m.l+=3,x!=2&&(g=m.read_shift(4)),g>1048576&&(g=1e6),x!=2&&(_=m.read_shift(2));var w=m.read_shift(2),S=d.codepage||1252;x!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(S=e[m[m.l]]),m.l+=1,m.l+=2),v&&(m.l+=36);for(var N=[],E={},C=Math.min(m.length,x==2?521:_-10-(b?264:0)),F=v?32:11;m.l<C&&m[m.l]!=13;)switch(E={},E.name=Ud.utils.decode(S,m.slice(m.l,m.l+F)).replace(/[\u0000\r\n].*$/g,""),m.l+=F,E.type=String.fromCharCode(m.read_shift(1)),x!=2&&!v&&(E.offset=m.read_shift(4)),E.len=m.read_shift(1),x==2&&(E.offset=m.read_shift(2)),E.dec=m.read_shift(1),E.name.length&&N.push(E),x!=2&&(m.l+=v?13:14),E.type){case"B":(!b||E.len!=8)&&d.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(m[m.l]!==13&&(m.l=_-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=_;var O=0,B=0;for(h[0]=[],B=0;B!=N.length;++B)h[0][B]=N[B].name;for(;g-- >0;){if(m[m.l]===42){m.l+=w;continue}for(++m.l,h[++O]=[],B=0,B=0;B!=N.length;++B){var L=m.slice(m.l,m.l+N[B].len);m.l+=N[B].len,Ks(L,0);var H=Ud.utils.decode(S,L);switch(N[B].type){case"C":H.trim().length&&(h[O][B]=H.replace(/\s+$/,""));break;case"D":H.length===8?h[O][B]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):h[O][B]=H;break;case"F":h[O][B]=parseFloat(H.trim());break;case"+":case"I":h[O][B]=v?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":h[O][B]=!0;break;case"N":case"F":h[O][B]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));h[O][B]="##MEMO##"+(v?parseInt(H.trim(),10):L.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(h[O][B]=+H||0);break;case"@":h[O][B]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":h[O][B]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":h[O][B]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[O][B]=-L.read_shift(-8,"f");break;case"B":if(b&&N[B].len==8){h[O][B]=L.read_shift(8,"f");break}case"G":case"P":L.l+=N[B].len;break;case"0":if(N[B].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[B].type)}}}if(x!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return d&&d.sheetRows&&(h=h.slice(0,d.sheetRows)),d.DBF=N,h}function s(u,d){var h=d||{};h.dateNF||(h.dateNF="yyyymmdd");var m=lu(r(u,h),h);return m["!cols"]=h.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete h.DBF,m}function n(u,d){try{return No(s(u,d),d)}catch(h){if(d&&d.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,d){var h=d||{};if(+h.codepage>=0&&En(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var m=ja(),x=Z0(u,{header:1,raw:!0,cellDates:!0}),y=x[0],b=x.slice(1),v=u["!cols"]||[],g=0,_=0,w=0,S=1;for(g=0;g<y.length;++g){if(((v[g]||{}).DBF||{}).name){y[g]=v[g].DBF.name,++w;continue}if(y[g]!=null){if(++w,typeof y[g]=="number"&&(y[g]=y[g].toString(10)),typeof y[g]!="string")throw new Error("DBF Invalid column name "+y[g]+" |"+typeof y[g]+"|");if(y.indexOf(y[g])!==g){for(_=0;_<1024;++_)if(y.indexOf(y[g]+"_"+_)==-1){y[g]+="_"+_;break}}}}var N=gr(u["!ref"]),E=[],C=[],F=[];for(g=0;g<=N.e.c-N.s.c;++g){var O="",B="",L=0,H=[];for(_=0;_<b.length;++_)b[_][g]!=null&&H.push(b[_][g]);if(H.length==0||y[g]==null){E[g]="?";continue}for(_=0;_<H.length;++_){switch(typeof H[_]){case"number":B="B";break;case"string":B="C";break;case"boolean":B="L";break;case"object":B=H[_]instanceof Date?"D":"C";break;default:B="C"}L=Math.max(L,String(H[_]).length),O=O&&O!=B?"C":B}L>250&&(L=250),B=((v[g]||{}).DBF||{}).type,B=="C"&&v[g].DBF.len>L&&(L=v[g].DBF.len),O=="B"&&B=="N"&&(O="N",F[g]=v[g].DBF.dec,L=v[g].DBF.len),C[g]=O=="C"||B=="N"?L:o[O]||0,S+=C[g],E[g]=O}var ue=m.next(32);for(ue.write_shift(4,318902576),ue.write_shift(4,b.length),ue.write_shift(2,296+32*w),ue.write_shift(2,S),g=0;g<4;++g)ue.write_shift(4,0);for(ue.write_shift(4,0|(+t[t5]||3)<<8),g=0,_=0;g<y.length;++g)if(y[g]!=null){var A=m.next(32),Y=(y[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,Y,"sbcs"),A.write_shift(1,E[g]=="?"?"C":E[g],"sbcs"),A.write_shift(4,_),A.write_shift(1,C[g]||o[E[g]]||0),A.write_shift(1,F[g]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),_+=C[g]||o[E[g]]||0}var I=m.next(264);for(I.write_shift(4,13),g=0;g<65;++g)I.write_shift(4,0);for(g=0;g<b.length;++g){var ae=m.next(S);for(ae.write_shift(1,0),_=0;_<y.length;++_)if(y[_]!=null)switch(E[_]){case"L":ae.write_shift(1,b[g][_]==null?63:b[g][_]?84:70);break;case"B":ae.write_shift(8,b[g][_]||0,"f");break;case"N":var Q="0";for(typeof b[g][_]=="number"&&(Q=b[g][_].toFixed(F[_]||0)),w=0;w<C[_]-Q.length;++w)ae.write_shift(1,32);ae.write_shift(1,Q,"sbcs");break;case"D":b[g][_]?(ae.write_shift(4,("0000"+b[g][_].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(b[g][_].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+b[g][_].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var re=String(b[g][_]!=null?b[g][_]:"").slice(0,C[_]);for(ae.write_shift(1,re,"sbcs"),w=0;w<C[_]-re.length;++w)ae.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:n,to_sheet:s,from_sheet:l}})(),hT=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+cs(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,b){var v=e[b];return typeof v=="number"?MS(v):v},s=function(y,b,v){var g=b.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?y:MS(g)};e["|"]=254;function n(y,b){switch(b.type){case"base64":return o(Ha(y),b);case"binary":return o(y,b);case"buffer":return o(ar&&Buffer.isBuffer(y)?y.toString("binary"):_o(y),b);case"array":return o(xl(y),b)}throw new Error("Unrecognized type "+b.type)}function o(y,b){var v=y.split(/[\n\r]+/),g=-1,_=-1,w=0,S=0,N=[],E=[],C=null,F={},O=[],B=[],L=[],H=0,ue;for(+b.codepage>=0&&En(+b.codepage);w!==v.length;++w){H=0;var A=v[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),Y=A.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),I=Y[0],ae;if(A.length>0)switch(I){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&E.push(A.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,re=!1,ve=!1,te=!1,ke=-1,Z=-1;for(S=1;S<Y.length;++S)switch(Y[S].charAt(0)){case"A":break;case"X":_=parseInt(Y[S].slice(1))-1,re=!0;break;case"Y":for(g=parseInt(Y[S].slice(1))-1,re||(_=0),ue=N.length;ue<=g;++ue)N[ue]=[];break;case"K":ae=Y[S].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(Tn(ae))?isNaN(Zc(ae).getDate())||(ae=Vr(ae)):(ae=Tn(ae),C!==null&&iu(C)&&(ae=Nm(ae))),Q=!0;break;case"E":te=!0;var M=zc(Y[S].slice(1),{r:g,c:_});N[g][_]=[N[g][_],M];break;case"S":ve=!0,N[g][_]=[N[g][_],"S5S"];break;case"G":break;case"R":ke=parseInt(Y[S].slice(1))-1;break;case"C":Z=parseInt(Y[S].slice(1))-1;break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+A)}if(Q&&(N[g][_]&&N[g][_].length==2?N[g][_][0]=ae:N[g][_]=ae,C=null),ve){if(te)throw new Error("SYLK shared formula cannot have own formula");var J=ke>-1&&N[ke][Z];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");N[g][_][1]=RT(J[1],{r:g-ke,c:_-Z})}break;case"F":var V=0;for(S=1;S<Y.length;++S)switch(Y[S].charAt(0)){case"X":_=parseInt(Y[S].slice(1))-1,++V;break;case"Y":for(g=parseInt(Y[S].slice(1))-1,ue=N.length;ue<=g;++ue)N[ue]=[];break;case"M":H=parseInt(Y[S].slice(1))/20;break;case"F":break;case"G":break;case"P":C=E[parseInt(Y[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=Y[S].slice(1).split(" "),ue=parseInt(L[0],10);ue<=parseInt(L[1],10);++ue)H=parseInt(L[2],10),B[ue-1]=H===0?{hidden:!0}:{wch:H},xo(B[ue-1]);break;case"C":_=parseInt(Y[S].slice(1))-1,B[_]||(B[_]={});break;case"R":g=parseInt(Y[S].slice(1))-1,O[g]||(O[g]={}),H>0?(O[g].hpt=H,O[g].hpx=eu(H)):H===0&&(O[g].hidden=!0);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+A)}V<1&&(C=null);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+A)}}return O.length>0&&(F["!rows"]=O),B.length>0&&(F["!cols"]=B),b&&b.sheetRows&&(N=N.slice(0,b.sheetRows)),[N,F]}function l(y,b){var v=n(y,b),g=v[0],_=v[1],w=lu(g,b);return cs(_).forEach(function(S){w[S]=_[S]}),w}function u(y,b){return No(l(y,b),b)}function d(y,b,v,g){var _="C;Y"+(v+1)+";X"+(g+1)+";K";switch(y.t){case"n":_+=y.v||0,y.f&&!y.F&&(_+=";E"+fb(y.f,{r:v,c:g}));break;case"b":_+=y.v?"TRUE":"FALSE";break;case"e":_+=y.w||y.v;break;case"d":_+='"'+(y.w||y.v)+'"';break;case"s":_+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function h(y,b){b.forEach(function(v,g){var _="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?_+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Kd(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Xd(v.wpx)),typeof v.wch=="number"&&(_+=Math.round(v.wch))),_.charAt(_.length-1)!=" "&&y.push(_)})}function m(y,b){b.forEach(function(v,g){var _="F;";v.hidden?_+="M0;":v.hpt?_+="M"+20*v.hpt+";":v.hpx&&(_+="M"+20*Yd(v.hpx)+";"),_.length>2&&y.push(_+"R"+(g+1))})}function x(y,b){var v=["ID;PWXL;N;E"],g=[],_=gr(y["!ref"]),w,S=Array.isArray(y),N=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),y["!cols"]&&h(v,y["!cols"]),y["!rows"]&&m(v,y["!rows"]),v.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var E=_.s.r;E<=_.e.r;++E)for(var C=_.s.c;C<=_.e.c;++C){var F=Gt({r:E,c:C});w=S?(y[E]||[])[C]:y[F],!(!w||w.v==null&&(!w.f||w.F))&&g.push(d(w,y,E,C))}return v.join(N)+N+g.join(N)+N+"E"+N}return{to_workbook:u,to_sheet:l,from_sheet:x}})(),mT=(function(){function e(o,l){switch(l.type){case"base64":return t(Ha(o),l);case"binary":return t(o,l);case"buffer":return t(ar&&Buffer.isBuffer(o)?o.toString("binary"):_o(o),l);case"array":return t(xl(o),l)}throw new Error("Unrecognized type "+l.type)}function t(o,l){for(var u=o.split(`
`),d=-1,h=-1,m=0,x=[];m!==u.length;++m){if(u[m].trim()==="BOT"){x[++d]=[],h=0;continue}if(!(d<0)){var y=u[m].trim().split(","),b=y[0],v=y[1];++m;for(var g=u[m]||"";(g.match(/["]/g)||[]).length&1&&m<u.length-1;)g+=`
`+u[++m];switch(g=g.trim(),+b){case-1:if(g==="BOT"){x[++d]=[],h=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?x[d][h]=!0:g==="FALSE"?x[d][h]=!1:isNaN(Tn(v))?isNaN(Zc(v).getDate())?x[d][h]=v:x[d][h]=Vr(v):x[d][h]=Tn(v),++h;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),x[d][h++]=g!==""?g:null;break}if(g==="EOD")break}}return l&&l.sheetRows&&(x=x.slice(0,l.sheetRows)),x}function r(o,l){return lu(e(o,l),l)}function s(o,l){return No(r(o,l),l)}var n=(function(){var o=function(d,h,m,x,y){d.push(h),d.push(m+","+x),d.push('"'+y.replace(/"/g,'""')+'"')},l=function(d,h,m,x){d.push(h+","+m),d.push(h==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(d){var h=[],m=gr(d["!ref"]),x,y=Array.isArray(d);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,m.e.r-m.s.r+1,""),o(h,"TUPLES",0,m.e.c-m.s.c+1,""),o(h,"DATA",0,0,"");for(var b=m.s.r;b<=m.e.r;++b){l(h,-1,0,"BOT");for(var v=m.s.c;v<=m.e.c;++v){var g=Gt({r:b,c:v});if(x=y?(d[b]||[])[v]:d[g],!x){l(h,1,0,"");continue}switch(x.t){case"n":var _=x.w;!_&&x.v!=null&&(_=x.v),_==null?x.f&&!x.F?l(h,1,0,"="+x.f):l(h,1,0,""):l(h,0,_,"V");break;case"b":l(h,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":l(h,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=mn(x.z||Wt[14],Rs(Vr(x.v)))),l(h,0,x.w,"V");break;default:l(h,1,0,"")}}}l(h,-1,0,"EOD");var w=`\r
`,S=h.join(w);return S}})();return{to_workbook:s,to_sheet:r,from_sheet:n}})(),pT=(function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,y){for(var b=x.split(`
`),v=-1,g=-1,_=0,w=[];_!==b.length;++_){var S=b[_].trim().split(":");if(S[0]==="cell"){var N=ts(S[1]);if(w.length<=N.r)for(v=w.length;v<=N.r;++v)w[v]||(w[v]=[]);switch(v=N.r,g=N.c,S[2]){case"t":w[v][g]=e(S[3]);break;case"v":w[v][g]=+S[3];break;case"vtf":var E=S[S.length-1];case"vtc":S[3]==="nl"?w[v][g]=!!+S[4]:w[v][g]=+S[4],S[2]=="vtf"&&(w[v][g]=[w[v][g],E])}}}return y&&y.sheetRows&&(w=w.slice(0,y.sheetRows)),w}function s(x,y){return lu(r(x,y),y)}function n(x,y){return No(s(x,y),y)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function h(x){if(!x||!x["!ref"])return"";for(var y=[],b=[],v,g="",_=Ta(x["!ref"]),w=Array.isArray(x),S=_.s.r;S<=_.e.r;++S)for(var N=_.s.c;N<=_.e.c;++N)if(g=Gt({r:S,c:N}),v=w?(x[S]||[])[N]:x[g],!(!v||v.v==null||v.t==="z")){switch(b=["cell",g,"t"],v.t){case"s":case"str":b.push(t(v.v));break;case"n":v.f?(b[2]="vtf",b[3]="n",b[4]=v.v,b[5]=t(v.f)):(b[2]="v",b[3]=v.v);break;case"b":b[2]="vt"+(v.f?"f":"c"),b[3]="nl",b[4]=v.v?"1":"0",b[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var E=Rs(Vr(v.v));b[2]="vtc",b[3]="nd",b[4]=""+E,b[5]=v.w||mn(v.z||Wt[14],E);break;case"e":continue}y.push(b.join(":"))}return y.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function m(x){return[o,l,u,l,h(x),d].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:m}})(),Qc=(function(){function e(m,x,y,b,v){v.raw?x[y][b]=m:m===""||(m==="TRUE"?x[y][b]=!0:m==="FALSE"?x[y][b]=!1:isNaN(Tn(m))?isNaN(Zc(m).getDate())?x[y][b]=m:x[y][b]=Vr(m):x[y][b]=Tn(m))}function t(m,x){var y=x||{},b=[];if(!m||m.length===0)return b;for(var v=m.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var _=10,w=0,S=0;S<=g;++S)w=v[S].indexOf(" "),w==-1?w=v[S].length:w++,_=Math.max(_,w);for(S=0;S<=g;++S){b[S]=[];var N=0;for(e(v[S].slice(0,_).trim(),b,S,N,y),N=1;N<=(v[S].length-_)/10+1;++N)e(v[S].slice(_+(N-1)*10,_+N*10).trim(),b,S,N,y)}return y.sheetRows&&(b=b.slice(0,y.sheetRows)),b}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(m){for(var x={},y=!1,b=0,v=0;b<m.length;++b)(v=m.charCodeAt(b))==34?y=!y:!y&&v in r&&(x[v]=(x[v]||0)+1);v=[];for(b in x)Object.prototype.hasOwnProperty.call(x,b)&&v.push([x[b],b]);if(!v.length){x=s;for(b in x)Object.prototype.hasOwnProperty.call(x,b)&&v.push([x[b],b])}return v.sort(function(g,_){return g[0]-_[0]||s[g[1]]-s[_[1]]}),r[v.pop()[1]]||44}function o(m,x){var y=x||{},b="",v=y.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(b=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(b=m.charAt(4),m=m.slice(6)):b=n(m.slice(0,1024)):y&&y.FS?b=y.FS:b=n(m.slice(0,1024));var _=0,w=0,S=0,N=0,E=0,C=b.charCodeAt(0),F=!1,O=0,B=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var L=y.dateNF!=null?Fz(y.dateNF):null;function H(){var ue=m.slice(N,E),A={};if(ue.charAt(0)=='"'&&ue.charAt(ue.length-1)=='"'&&(ue=ue.slice(1,-1).replace(/""/g,'"')),ue.length===0)A.t="z";else if(y.raw)A.t="s",A.v=ue;else if(ue.trim().length===0)A.t="s",A.v=ue;else if(ue.charCodeAt(0)==61)ue.charCodeAt(1)==34&&ue.charCodeAt(ue.length-1)==34?(A.t="s",A.v=ue.slice(2,-1).replace(/""/g,'"')):cV(ue)?(A.t="n",A.f=ue.slice(1)):(A.t="s",A.v=ue);else if(ue=="TRUE")A.t="b",A.v=!0;else if(ue=="FALSE")A.t="b",A.v=!1;else if(!isNaN(S=Tn(ue)))A.t="n",y.cellText!==!1&&(A.w=ue),A.v=S;else if(!isNaN(Zc(ue).getDate())||L&&ue.match(L)){A.z=y.dateNF||Wt[14];var Y=0;L&&ue.match(L)&&(ue=Lz(ue,y.dateNF,ue.match(L)||[]),Y=1),y.cellDates?(A.t="d",A.v=Vr(ue,Y)):(A.t="n",A.v=Rs(Vr(ue,Y))),y.cellText!==!1&&(A.w=mn(A.z,A.v instanceof Date?Rs(A.v):A.v)),y.cellNF||delete A.z}else A.t="s",A.v=ue;if(A.t=="z"||(y.dense?(v[_]||(v[_]=[]),v[_][w]=A):v[Gt({c:w,r:_})]=A),N=E+1,B=m.charCodeAt(N),g.e.c<w&&(g.e.c=w),g.e.r<_&&(g.e.r=_),O==C)++w;else if(w=0,++_,y.sheetRows&&y.sheetRows<=_)return!0}e:for(;E<m.length;++E)switch(O=m.charCodeAt(E)){case 34:B===34&&(F=!F);break;case C:case 10:case 13:if(!F&&H())break e;break}return E-N>0&&H(),v["!ref"]=Zt(g),v}function l(m,x){return!(x&&x.PRN)||x.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?o(m,x):lu(t(m,x),x)}function u(m,x){var y="",b=x.type=="string"?[0,0,0,0]:bb(m,x);switch(x.type){case"base64":y=Ha(m);break;case"binary":y=m;break;case"buffer":x.codepage==65001?y=m.toString("utf8"):x.codepage&&typeof Ud<"u"||(y=ar&&Buffer.isBuffer(m)?m.toString("binary"):_o(m));break;case"array":y=xl(m);break;case"string":y=m;break;default:throw new Error("Unrecognized type "+x.type)}return b[0]==239&&b[1]==187&&b[2]==191?y=Pr(y.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?y=Pr(y):x.type=="binary"&&typeof Ud<"u",y.slice(0,19)=="socialcalc:version:"?pT.to_sheet(x.type=="string"?y:Pr(y),x):l(y,x)}function d(m,x){return No(u(m,x),x)}function h(m){for(var x=[],y=gr(m["!ref"]),b,v=Array.isArray(m),g=y.s.r;g<=y.e.r;++g){for(var _=[],w=y.s.c;w<=y.e.c;++w){var S=Gt({r:g,c:w});if(b=v?(m[g]||[])[w]:m[S],!b||b.v==null){_.push("          ");continue}for(var N=(b.w||(ji(b),b.w)||"").slice(0,10);N.length<10;)N+=" ";_.push(N+(w===0?" ":""))}x.push(_.join(""))}return x.join(`
`)}return{to_workbook:d,to_sheet:u,from_sheet:h}})();function XH(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var n=hT.to_workbook(e,r);return r.WTF=s,n}catch(o){if(r.WTF=s,!o.message.match(/SYLK bad record ID/)&&s)throw o;return Qc.to_workbook(e,t)}}var ul=(function(){function e(M,J,V){if(M){Ks(M,M.l||0);for(var X=V.Enum||ke;M.l<M.length;){var se=M.read_shift(2),P=X[se]||X[65535],U=M.read_shift(2),ce=M.l+U,ne=P.f&&P.f(M,U,V);if(M.l=ce,J(ne,P,se))return}}}function t(M,J){switch(J.type){case"base64":return r(za(Ha(M)),J);case"binary":return r(za(M),J);case"buffer":case"array":return r(M,J)}throw"Unsupported type "+J.type}function r(M,J){if(!M)return M;var V=J||{},X=V.dense?[]:{},se="Sheet1",P="",U=0,ce={},ne=[],ie=[],W={s:{r:0,c:0},e:{r:0,c:0}},G=V.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)V.Enum=ke,e(M,function(T,R,q){switch(q){case 0:V.vers=T,T>=4096&&(V.qpro=!0);break;case 6:W=T;break;case 204:T&&(P=T);break;case 222:P=T;break;case 15:case 51:V.qpro||(T[1].v=T[1].v.slice(1));case 13:case 14:case 16:q==14&&(T[2]&112)==112&&(T[2]&15)>1&&(T[2]&15)<15&&(T[1].z=V.dateNF||Wt[14],V.cellDates&&(T[1].t="d",T[1].v=Nm(T[1].v))),V.qpro&&T[3]>U&&(X["!ref"]=Zt(W),ce[se]=X,ne.push(se),X=V.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},U=T[3],se=P||"Sheet"+(U+1),P="");var me=V.dense?(X[T[0].r]||[])[T[0].c]:X[Gt(T[0])];if(me){me.t=T[1].t,me.v=T[1].v,T[1].z!=null&&(me.z=T[1].z),T[1].f!=null&&(me.f=T[1].f);break}V.dense?(X[T[0].r]||(X[T[0].r]=[]),X[T[0].r][T[0].c]=T[1]):X[Gt(T[0])]=T[1];break}},V);else if(M[2]==26||M[2]==14)V.Enum=Z,M[2]==14&&(V.qpro=!0,M.l=0),e(M,function(T,R,q){switch(q){case 204:se=T;break;case 22:T[1].v=T[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(T[3]>U&&(X["!ref"]=Zt(W),ce[se]=X,ne.push(se),X=V.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},U=T[3],se="Sheet"+(U+1)),G>0&&T[0].r>=G)break;V.dense?(X[T[0].r]||(X[T[0].r]=[]),X[T[0].r][T[0].c]=T[1]):X[Gt(T[0])]=T[1],W.e.c<T[0].c&&(W.e.c=T[0].c),W.e.r<T[0].r&&(W.e.r=T[0].r);break;case 27:T[14e3]&&(ie[T[14e3][0]]=T[14e3][1]);break;case 1537:ie[T[0]]=T[1],T[0]==U&&(se=T[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(X["!ref"]=Zt(W),ce[P||se]=X,ne.push(P||se),!ie.length)return{SheetNames:ne,Sheets:ce};for(var k={},de=[],z=0;z<ie.length;++z)ce[ne[z]]?(de.push(ie[z]||ne[z]),k[ie[z]]=ce[ie[z]]||ce[ne[z]]):(de.push(ie[z]),k[ie[z]]={"!ref":"A1"});return{SheetNames:de,Sheets:k}}function s(M,J){var V=J||{};if(+V.codepage>=0&&En(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var X=ja(),se=gr(M["!ref"]),P=Array.isArray(M),U=[];St(X,0,o(1030)),St(X,6,d(se));for(var ce=Math.min(se.e.r,8191),ne=se.s.r;ne<=ce;++ne)for(var ie=xs(ne),W=se.s.c;W<=se.e.c;++W){ne===se.s.r&&(U[W]=es(W));var G=U[W]+ie,k=P?(M[ne]||[])[W]:M[G];if(!(!k||k.t=="z"))if(k.t=="n")(k.v|0)==k.v&&k.v>=-32768&&k.v<=32767?St(X,13,b(ne,W,k.v)):St(X,14,g(ne,W,k.v));else{var de=ji(k);St(X,15,x(ne,W,de.slice(0,239)))}}return St(X,1),X.end()}function n(M,J){var V=J||{};if(+V.codepage>=0&&En(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var X=ja();St(X,0,l(M));for(var se=0,P=0;se<M.SheetNames.length;++se)(M.Sheets[M.SheetNames[se]]||{})["!ref"]&&St(X,27,te(M.SheetNames[se],P++));var U=0;for(se=0;se<M.SheetNames.length;++se){var ce=M.Sheets[M.SheetNames[se]];if(!(!ce||!ce["!ref"])){for(var ne=gr(ce["!ref"]),ie=Array.isArray(ce),W=[],G=Math.min(ne.e.r,8191),k=ne.s.r;k<=G;++k)for(var de=xs(k),z=ne.s.c;z<=ne.e.c;++z){k===ne.s.r&&(W[z]=es(z));var T=W[z]+de,R=ie?(ce[k]||[])[z]:ce[T];if(!(!R||R.t=="z"))if(R.t=="n")St(X,23,H(k,z,U,R.v));else{var q=ji(R);St(X,22,O(k,z,U,q.slice(0,239)))}}++U}}return St(X,1),X.end()}function o(M){var J=nt(2);return J.write_shift(2,M),J}function l(M){var J=nt(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var V=0,X=0,se=0,P=0;P<M.SheetNames.length;++P){var U=M.SheetNames[P],ce=M.Sheets[U];if(!(!ce||!ce["!ref"])){++se;var ne=Ta(ce["!ref"]);V<ne.e.r&&(V=ne.e.r),X<ne.e.c&&(X=ne.e.c)}}return V>8191&&(V=8191),J.write_shift(2,V),J.write_shift(1,se),J.write_shift(1,X),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function u(M,J,V){var X={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&V.qpro?(X.s.c=M.read_shift(1),M.l++,X.s.r=M.read_shift(2),X.e.c=M.read_shift(1),M.l++,X.e.r=M.read_shift(2),X):(X.s.c=M.read_shift(2),X.s.r=M.read_shift(2),J==12&&V.qpro&&(M.l+=2),X.e.c=M.read_shift(2),X.e.r=M.read_shift(2),J==12&&V.qpro&&(M.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function d(M){var J=nt(8);return J.write_shift(2,M.s.c),J.write_shift(2,M.s.r),J.write_shift(2,M.e.c),J.write_shift(2,M.e.r),J}function h(M,J,V){var X=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(X[0].c=M.read_shift(1),X[3]=M.read_shift(1),X[0].r=M.read_shift(2),M.l+=2):(X[2]=M.read_shift(1),X[0].c=M.read_shift(2),X[0].r=M.read_shift(2)),X}function m(M,J,V){var X=M.l+J,se=h(M,J,V);if(se[1].t="s",V.vers==20768){M.l++;var P=M.read_shift(1);return se[1].v=M.read_shift(P,"utf8"),se}return V.qpro&&M.l++,se[1].v=M.read_shift(X-M.l,"cstr"),se}function x(M,J,V){var X=nt(7+V.length);X.write_shift(1,255),X.write_shift(2,J),X.write_shift(2,M),X.write_shift(1,39);for(var se=0;se<X.length;++se){var P=V.charCodeAt(se);X.write_shift(1,P>=128?95:P)}return X.write_shift(1,0),X}function y(M,J,V){var X=h(M,J,V);return X[1].v=M.read_shift(2,"i"),X}function b(M,J,V){var X=nt(7);return X.write_shift(1,255),X.write_shift(2,J),X.write_shift(2,M),X.write_shift(2,V,"i"),X}function v(M,J,V){var X=h(M,J,V);return X[1].v=M.read_shift(8,"f"),X}function g(M,J,V){var X=nt(13);return X.write_shift(1,255),X.write_shift(2,J),X.write_shift(2,M),X.write_shift(8,V,"f"),X}function _(M,J,V){var X=M.l+J,se=h(M,J,V);if(se[1].v=M.read_shift(8,"f"),V.qpro)M.l=X;else{var P=M.read_shift(2);E(M.slice(M.l,M.l+P),se),M.l+=P}return se}function w(M,J,V){var X=J&32768;return J&=-32769,J=(X?M:0)+(J>=8192?J-16384:J),(X?"":"$")+(V?es(J):xs(J))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(M,J){Ks(M,0);for(var V=[],X=0,se="",P="",U="",ce="";M.l<M.length;){var ne=M[M.l++];switch(ne){case 0:V.push(M.read_shift(8,"f"));break;case 1:P=w(J[0].c,M.read_shift(2),!0),se=w(J[0].r,M.read_shift(2),!1),V.push(P+se);break;case 2:{var ie=w(J[0].c,M.read_shift(2),!0),W=w(J[0].r,M.read_shift(2),!1);P=w(J[0].c,M.read_shift(2),!0),se=w(J[0].r,M.read_shift(2),!1),V.push(ie+W+":"+P+se)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(M.read_shift(2));break;case 6:{for(var G="";ne=M[M.l++];)G+=String.fromCharCode(ne);V.push('"'+G.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:ce=V.pop(),U=V.pop(),V.push(["AND","OR"][ne-20]+"("+U+","+ce+")");break;default:if(ne<32&&N[ne])ce=V.pop(),U=V.pop(),V.push(U+N[ne]+ce);else if(S[ne]){if(X=S[ne][1],X==69&&(X=M[M.l++]),X>V.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+V.join("|")+"|");return}var k=V.slice(-X);V.length-=X,V.push(S[ne][0]+"("+k.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}V.length==1?J[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function C(M){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=M.read_shift(2),J[3]=M[M.l++],J[0].c=M[M.l++],J}function F(M,J){var V=C(M);return V[1].t="s",V[1].v=M.read_shift(J-4,"cstr"),V}function O(M,J,V,X){var se=nt(6+X.length);se.write_shift(2,M),se.write_shift(1,V),se.write_shift(1,J),se.write_shift(1,39);for(var P=0;P<X.length;++P){var U=X.charCodeAt(P);se.write_shift(1,U>=128?95:U)}return se.write_shift(1,0),se}function B(M,J){var V=C(M);V[1].v=M.read_shift(2);var X=V[1].v>>1;if(V[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return V[1].v=X,V}function L(M,J){var V=C(M),X=M.read_shift(4),se=M.read_shift(4),P=M.read_shift(2);if(P==65535)return X===0&&se===3221225472?(V[1].t="e",V[1].v=15):X===0&&se===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var U=P&32768;return P=(P&32767)-16446,V[1].v=(1-U*2)*(se*Math.pow(2,P+32)+X*Math.pow(2,P)),V}function H(M,J,V,X){var se=nt(14);if(se.write_shift(2,M),se.write_shift(1,V),se.write_shift(1,J),X==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var P=0,U=0,ce=0,ne=0;return X<0&&(P=1,X=-X),U=Math.log2(X)|0,X/=Math.pow(2,U-31),ne=X>>>0,(ne&2147483648)==0&&(X/=2,++U,ne=X>>>0),X-=ne,ne|=2147483648,ne>>>=0,X*=Math.pow(2,32),ce=X>>>0,se.write_shift(4,ce),se.write_shift(4,ne),U+=16383+(P?32768:0),se.write_shift(2,U),se}function ue(M,J){var V=L(M);return M.l+=J-14,V}function A(M,J){var V=C(M),X=M.read_shift(4);return V[1].v=X>>6,V}function Y(M,J){var V=C(M),X=M.read_shift(8,"f");return V[1].v=X,V}function I(M,J){var V=Y(M);return M.l+=J-10,V}function ae(M,J){return M[M.l+J-1]==0?M.read_shift(J,"cstr"):""}function Q(M,J){var V=M[M.l++];V>J-1&&(V=J-1);for(var X="";X.length<V;)X+=String.fromCharCode(M[M.l++]);return X}function re(M,J,V){if(!(!V.qpro||J<21)){var X=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var se=M.read_shift(J-21,"cstr");return[X,se]}}function ve(M,J){for(var V={},X=M.l+J;M.l<X;){var se=M.read_shift(2);if(se==14e3){for(V[se]=[0,""],V[se][0]=M.read_shift(2);M[M.l];)V[se][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return V}function te(M,J){var V=nt(5+M.length);V.write_shift(2,14e3),V.write_shift(2,J);for(var X=0;X<M.length;++X){var se=M.charCodeAt(X);V[V.l++]=se>127?95:se}return V[V.l++]=0,V}var ke={0:{n:"BOF",f:Ss},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},Z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:ue},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ve},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:I},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:re},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:t}})();function YH(e){var t={},r=e.match(ua),s=0,n=!1;if(r)for(;s!=r.length;++s){var o=Kt(r[s]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;t.cp=Mv[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(o[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+o[0])}}return t}var JH=(function(){var e=qd("t"),t=qd("rPr");function r(o){var l=o.match(e);if(!l)return{t:"s",v:""};var u={t:"s",v:xr(l[1])},d=o.match(t);return d&&(u.s=YH(d[1])),u}var s=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(s,"").split(n).map(r).filter(function(u){return u.v})}})(),ZH=(function(){var t=/(\r\n|\n)/g;function r(n,o,l){var u=[];n.u&&u.push("text-decoration: underline;"),n.uval&&u.push("text-underline-style:"+n.uval+";"),n.sz&&u.push("font-size:"+n.sz+"pt;"),n.outline&&u.push("text-effect: outline;"),n.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),n.b&&(o.push("<b>"),l.push("</b>")),n.i&&(o.push("<i>"),l.push("</i>")),n.strike&&(o.push("<s>"),l.push("</s>"));var d=n.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(o.push("<"+d+">"),l.push("</"+d+">")),l.push("</span>"),n}function s(n){var o=[[],n.v,[]];return n.v?(n.s&&r(n.s,o[0],o[2]),o[0].join("")+o[1].replace(t,"<br/>")+o[2].join("")):""}return function(o){return o.map(s).join("")}})(),QH=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,eW=/<(?:\w+:)?r>/,tW=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ob(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=xr(Pr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=Pr(e),r&&(s.h=Vv(s.t))):e.match(eW)&&(s.r=Pr(e),s.t=xr(Pr((e.replace(tW,"").match(QH)||[]).join("").replace(ua,""))),r&&(s.h=ZH(JH(s.r)))),s):{t:""}}var rW=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sW=/<(?:\w+:)?(?:si|sstItem)>/g,aW=/<\/(?:\w+:)?(?:si|sstItem)>/;function nW(e,t){var r=[],s="";if(!e)return r;var n=e.match(rW);if(n){s=n[2].replace(sW,"").split(aW);for(var o=0;o!=s.length;++o){var l=ob(s[o].trim(),t);l!=null&&(r[r.length]=l)}n=Kt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var iW=/^\s|\s$|[\t\n\r]/;function xT(e,t){if(!t.bookSST)return"";var r=[ys];r[r.length]=kt("sst",null,{xmlns:jl[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var n=e[s],o="<si>";n.r?o+=n.r:(o+="<t",n.t||(n.t=""),n.t.match(iW)&&(o+=' xml:space="preserve"'),o+=">"+Dr(n.t)+"</t>"),o+="</si>",r[r.length]=o}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function oW(e){return[e.read_shift(4),e.read_shift(4)]}function lW(e,t){var r=[],s=!1;return Fi(e,function(o,l,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(l.T,!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function cW(e,t){return t||(t=nt(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var uW=b$;function dW(e){var t=ja();dt(t,159,cW(e));for(var r=0;r<e.length;++r)dt(t,19,uW(e[r]));return dt(t,160),t.end()}function gT(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function Ni(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function fW(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ni(e,4),t.U=Ni(e,4),t.W=Ni(e,4),t}function hW(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},n=e.read_shift(4),o=[];n-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=o,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function mW(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(hW(e));return t}function pW(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function xW(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ni(e,4),t.U=Ni(e,4),t.W=Ni(e,4),t}function gW(e){var t=xW(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function yT(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var n=!1;switch(s.AlgID){case 26126:case 26127:case 26128:n=s.Flags==36;break;case 26625:n=s.Flags==4;break;case 0:n=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function vT(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function yW(e){var t=Ni(e);switch(t.Minor){case 2:return[t.Minor,vW(e)];case 3:return[t.Minor,bW()];case 4:return[t.Minor,wW(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function vW(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=yT(e,r),n=vT(e,e.length-e.l);return{t:"Std",h:s,v:n}}function bW(){throw new Error("File is password-protected: ECMA-376 Extensible")}function wW(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(ua,function(o){var l=Kt(o);switch(Kn(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){s[u]=l[u]});break;case"<dataIntegrity":s.encryptedHmacKey=l.encryptedHmacKey,s.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(l);break;default:throw l[0]}}),s}function _W(e,t){var r={},s=r.EncryptionVersionInfo=Ni(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=yT(e,n),t-=n,r.EncryptionVerifier=vT(e,t),r}function NW(e){var t={},r=t.EncryptionVersionInfo=Ni(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function lb(e){var t=0,r,s=gT(e),n=s.length+1,o,l,u,d,h;for(r=po(n),r[0]=s.length,o=1;o!=n;++o)r[o]=s[o-1];for(o=n-1;o>=0;--o)l=r[o],u=(t&16384)===0?0:1,d=t<<1&32767,h=u|d,t=h^l;return t^52811}var bT=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(l){return(l/2|l*128)&255},n=function(l,u){return s(l^u)},o=function(l){for(var u=t[l.length-1],d=104,h=l.length-1;h>=0;--h)for(var m=l[h],x=0;x!=7;++x)m&64&&(u^=r[d]),m*=2,--d;return u};return function(l){for(var u=gT(l),d=o(u),h=u.length,m=po(16),x=0;x!=16;++x)m[x]=0;var y,b,v;for((h&1)===1&&(y=d>>8,m[h]=n(e[0],y),--h,y=d&255,b=u[u.length-1],m[h]=n(b,y));h>0;)--h,y=d>>8,m[h]=n(u[h],y),--h,y=d&255,m[h]=n(u[h],y);for(h=15,v=15-u.length;v>0;)y=d>>8,m[h]=n(e[v],y),--h,--v,y=d&255,m[h]=n(u[h],y),--h,--v;return m}})(),kW=function(e,t,r,s,n){n||(n=t),s||(s=bT(e));var o,l;for(o=0;o!=t.length;++o)l=t[o],l^=s[r],l=(l>>5|l<<3)&255,n[o]=l,++r;return[n,r,s]},SW=function(e){var t=0,r=bT(e);return function(s){var n=kW("",s,t,r);return t=n[1],n[0]}};function EW(e,t,r,s){var n={key:Ss(e),verificationBytes:Ss(e)};return r.password&&(n.verifier=lb(r.password)),s.valid=n.verificationBytes===n.verifier,s.valid&&(s.insitu=SW(r.password)),n}function jW(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=NW(e):s.Data=_W(e,t),s}function TW(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?jW(e,t-2,s):EW(e,r.biff>=8?t:t-2,r,s),s}var wT=(function(){function e(n,o){switch(o.type){case"base64":return t(Ha(n),o);case"binary":return t(n,o);case"buffer":return t(ar&&Buffer.isBuffer(n)?n.toString("binary"):_o(n),o);case"array":return t(xl(n),o)}throw new Error("Unrecognized type "+o.type)}function t(n,o){var l=o||{},u=l.dense?[]:{},d=n.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(m,x){Array.isArray(u)&&(u[x]=[]);for(var y=/\\\w+\b/g,b=0,v,g=-1;v=y.exec(m);){switch(v[0]){case"\\cell":var _=m.slice(b,y.lastIndex-v[0].length);if(_[0]==" "&&(_=_.slice(1)),++g,_.length){var w={v:_,t:"s"};Array.isArray(u)?u[x][g]=w:u[Gt({r:x,c:g})]=w}break}b=y.lastIndex}g>h.e.c&&(h.e.c=g)}),u["!ref"]=Zt(h),u}function r(n,o){return No(e(n,o),o)}function s(n){for(var o=["{\\rtf1\\ansi"],l=gr(n["!ref"]),u,d=Array.isArray(n),h=l.s.r;h<=l.e.r;++h){o.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)o.push("\\cellx"+(m+1));for(o.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var x=Gt({r:h,c:m});u=d?(n[h]||[])[m]:n[x],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(ji(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}})();function AW(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Vd(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function CW(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,n=Math.max(t,r,s),o=Math.min(t,r,s),l=n-o;if(l===0)return[0,0,t];var u=0,d=0,h=n+o;switch(d=l/(h>1?2-h:h),n){case t:u=((r-s)/l+6)%6;break;case r:u=(s-t)/l+2;break;case s:u=(t-r)/l+4;break}return[u/6,d,h/2]}function RW(e){var t=e[0],r=e[1],s=e[2],n=r*2*(s<.5?s:1-s),o=s-n/2,l=[o,o,o],u=6*t,d;if(r!==0)switch(u|0){case 0:case 6:d=n*u,l[0]+=n,l[1]+=d;break;case 1:d=n*(2-u),l[0]+=d,l[1]+=n;break;case 2:d=n*(u-2),l[1]+=n,l[2]+=d;break;case 3:d=n*(4-u),l[1]+=d,l[2]+=n;break;case 4:d=n*(u-4),l[2]+=n,l[0]+=d;break;case 5:d=n*(6-u),l[2]+=d,l[0]+=n;break}for(var h=0;h!=3;++h)l[h]=Math.round(l[h]*255);return l}function Y0(e,t){if(t===0)return e;var r=CW(AW(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Vd(RW(r))}var _T=6,DW=15,OW=1,aa=_T;function Kd(e){return Math.floor((e+Math.round(128/aa)/256)*aa)}function Xd(e){return Math.floor((e-5)/aa*100+.5)/100}function J0(e){return Math.round((e*aa+5)/aa*256)/256}function iy(e){return J0(Xd(Kd(e)))}function cb(e){var t=Math.abs(e-iy(e)),r=aa;if(t>.005)for(aa=OW;aa<DW;++aa)Math.abs(e-iy(e))<=t&&(t=Math.abs(e-iy(e)),r=aa);aa=r}function xo(e){e.width?(e.wpx=Kd(e.width),e.wch=Xd(e.wpx),e.MDW=aa):e.wpx?(e.wch=Xd(e.wpx),e.width=J0(e.wch),e.MDW=aa):typeof e.wch=="number"&&(e.width=J0(e.wch),e.wpx=Kd(e.width),e.MDW=aa),e.customWidth&&delete e.customWidth}var FW=96,NT=FW;function Yd(e){return e*96/NT}function eu(e){return e*NT/96}var LW={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function IW(e,t,r,s){t.Borders=[];var n={},o=!1;(e[0].match(ua)||[]).forEach(function(l){var u=Kt(l);switch(Kn(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},u.diagonalUp&&(n.diagonalUp=Gr(u.diagonalUp)),u.diagonalDown&&(n.diagonalDown=Gr(u.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function MW(e,t,r,s){t.Fills=[];var n={},o=!1;(e[0].match(ua)||[]).forEach(function(l){var u=Kt(l);switch(Kn(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":u.patternType&&(n.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),u.indexed&&(n.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(n.bgColor.theme=parseInt(u.theme,10)),u.tint&&(n.bgColor.tint=parseFloat(u.tint)),u.rgb&&(n.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),u.theme&&(n.fgColor.theme=parseInt(u.theme,10)),u.tint&&(n.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(n.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function BW(e,t,r,s){t.Fonts=[];var n={},o=!1;(e[0].match(ua)||[]).forEach(function(l){var u=Kt(l);switch(Kn(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":u.val&&(n.name=Pr(u.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=u.val?Gr(u.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=u.val?Gr(u.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(u.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=u.val?Gr(u.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=u.val?Gr(u.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=u.val?Gr(u.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=u.val?Gr(u.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=u.val?Gr(u.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":u.val&&(n.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(n.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(n.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(n.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Mv[parseInt(u.val,10)];break;case"<color":if(n.color||(n.color={}),u.auto&&(n.color.auto=Gr(u.auto)),u.rgb)n.color.rgb=u.rgb.slice(-6);else if(u.indexed){n.color.index=parseInt(u.indexed,10);var d=ll[n.color.index];n.color.index==81&&(d=ll[1]),d||(d=ll[1]),n.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else u.theme&&(n.color.theme=parseInt(u.theme,10),u.tint&&(n.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=Y0(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function PW(e,t,r){t.NumberFmt=[];for(var s=cs(Wt),n=0;n<s.length;++n)t.NumberFmt[s[n]]=Wt[s[n]];var o=e[0].match(ua);if(o)for(n=0;n<o.length;++n){var l=Kt(o[n]);switch(Kn(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=xr(Pr(l.formatCode)),d=parseInt(l.numFmtId,10);if(t.NumberFmt[d]=u,d>0){if(d>392){for(d=392;d>60&&t.NumberFmt[d]!=null;--d);t.NumberFmt[d]=u}_i(u,d)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function UW(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=kt("numFmt",null,{numFmtId:s,formatCode:Dr(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=kt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var n0=["numFmtId","fillId","fontId","borderId","xfId"],i0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function zW(e,t,r){t.CellXf=[];var s,n=!1;(e[0].match(ua)||[]).forEach(function(o){var l=Kt(o),u=0;switch(Kn(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=l,delete s[0],u=0;u<n0.length;++u)s[n0[u]]&&(s[n0[u]]=parseInt(s[n0[u]],10));for(u=0;u<i0.length;++u)s[i0[u]]&&(s[i0[u]]=Gr(s[i0[u]]));if(t.NumberFmt&&s.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[u]){s.numFmtId=u;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};l.vertical&&(d.vertical=l.vertical),l.horizontal&&(d.horizontal=l.horizontal),l.textRotation!=null&&(d.textRotation=l.textRotation),l.indent&&(d.indent=l.indent),l.wrapText&&(d.wrapText=Gr(l.wrapText)),s.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function $W(e){var t=[];return t[t.length]=kt("cellXfs",null),e.forEach(function(r){t[t.length]=kt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=kt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var qW=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,d,h){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(t))&&PW(x,m,h),(x=u.match(n))&&BW(x,m,d,h),(x=u.match(s))&&MW(x,m,d,h),(x=u.match(o))&&IW(x,m,d,h),(x=u.match(r))&&zW(x,m,h),m}})();function kT(e,t){var r=[ys,kt("styleSheet",null,{xmlns:jl[0],"xmlns:vt":Cs.vt})],s;return e.SSF&&(s=UW(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=$W(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function HW(e,t){var r=e.read_shift(2),s=oa(e);return[r,s]}function WW(e,t,r){r||(r=nt(6+4*t.length)),r.write_shift(2,e),Ms(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function GW(e,t,r){var s={};s.sz=e.read_shift(2)/20;var n=j$(e);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var o=e.read_shift(2);switch(o===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(s.underline=l);var u=e.read_shift(1);u>0&&(s.family=u);var d=e.read_shift(1);switch(d>0&&(s.charset=d),e.l++,s.color=E$(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=oa(e),s}function VW(e,t){t||(t=nt(153)),t.write_shift(2,e.sz*20),T$(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),V0(e.color,t);var s=0;return s=2,t.write_shift(1,s),Ms(e.name,t),t.length>t.l?t.slice(0,t.l):t}var KW=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],oy,XW=ca;function j3(e,t){t||(t=nt(84)),oy||(oy=wm(KW));var r=oy[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(V0({auto:1},t),V0({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function YW(e,t){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:n}}function ST(e,t,r){r||(r=nt(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function nd(e,t){return t||(t=nt(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var JW=ca;function ZW(e,t){return t||(t=nt(51)),t.write_shift(1,0),nd(null,t),nd(null,t),nd(null,t),nd(null,t),nd(null,t),t.length>t.l?t.slice(0,t.l):t}function QW(e,t){return t||(t=nt(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),G0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function eG(e,t,r){var s=nt(2052);return s.write_shift(4,e),G0(t,s),G0(r,s),s.length>s.l?s.slice(0,s.l):s}function tG(e,t,r){var s={};s.NumberFmt=[];for(var n in Wt)s.NumberFmt[n]=Wt[n];s.CellXf=[],s.Fonts=[];var o=[],l=!1;return Fi(e,function(d,h,m){switch(m){case 44:s.NumberFmt[d[0]]=d[1],_i(d[1],d[0]);break;case 43:s.Fonts.push(d),d.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(d.color.rgb=Y0(t.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&s.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(m),l=!0;break;case 38:o.pop(),l=!1;break;default:if(h.T>0)o.push(m);else if(h.T<0)o.pop();else if(!l||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),s}function rG(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&++r}),r!=0&&(dt(e,615,An(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&dt(e,44,WW(n,t[n]))}),dt(e,616))}}function sG(e){var t=1;dt(e,611,An(t)),dt(e,43,VW({sz:12,color:{theme:1},name:"Calibri",family:2})),dt(e,612)}function aG(e){var t=2;dt(e,603,An(t)),dt(e,45,j3({patternType:"none"})),dt(e,45,j3({patternType:"gray125"})),dt(e,604)}function nG(e){var t=1;dt(e,613,An(t)),dt(e,46,ZW()),dt(e,614)}function iG(e){var t=1;dt(e,626,An(t)),dt(e,47,ST({numFmtId:0},65535)),dt(e,627)}function oG(e,t){dt(e,617,An(t.length)),t.forEach(function(r){dt(e,47,ST(r,0))}),dt(e,618)}function lG(e){var t=1;dt(e,619,An(t)),dt(e,48,QW({xfId:0,name:"Normal"})),dt(e,620)}function cG(e){var t=0;dt(e,505,An(t)),dt(e,506)}function uG(e){var t=0;dt(e,508,eG(t,"TableStyleMedium9","PivotStyleMedium4")),dt(e,509)}function dG(e,t){var r=ja();return dt(r,278),rG(r,e.SSF),sG(r),aG(r),nG(r),iG(r),oG(r,t.cellXfs),lG(r),cG(r),uG(r),dt(r,279),r.end()}var fG=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function hG(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(ua)||[]).forEach(function(n){var o=Kt(n);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=o.val;break;case"<a:sysClr":s.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(t.themeElements.clrScheme[fG.indexOf(o[0])]=s,s={}):s.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function mG(){}function pG(){}var xG=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,gG=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,yG=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function vG(e,t,r){t.themeElements={};var s;[["clrScheme",xG,hG],["fontScheme",gG,mG],["fmtScheme",yG,pG]].forEach(function(n){if(!(s=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](s,t,r)})}var bG=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ET(e,t){(!e||e.length===0)&&(e=ub());var r,s={};if(!(r=e.match(bG)))throw new Error("themeElements not found in theme");return vG(r[0],s,t),s.raw=e,s}function ub(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ys];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function wG(e,t,r){var s=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=s;return}var o=e.slice(e.l);e.l=s;var l;try{l=y5(o,{type:"array"})}catch{return}var u=$a(l,"theme/theme/theme1.xml",!0);if(u)return ET(u,r)}}function _G(e){return e.read_shift(4)}function NG(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=kG(e,4);break;case 2:t.xclrValue=nT(e);break;case 3:t.xclrValue=_G(e);break;case 4:e.l+=4;break}return e.l+=8,t}function kG(e,t){return ca(e,t)}function SG(e,t){return ca(e,t)}function EG(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=NG(e);break;case 6:s[1]=SG(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function jG(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),o=[];n-- >0;)o.push(EG(e,r-e.l));return{ixfe:s,ext:o}}function TG(e,t){t.forEach(function(r){r[0]})}function AG(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:oa(e)}}function CG(e){var t=nt(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ms(e.name,t),t.slice(0,t.l)}function RG(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function DG(e){var t=nt(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function OG(e,t){var r=nt(8+2*t.length);return r.write_shift(4,e),Ms(t,r),r.slice(0,r.l)}function FG(e){return e.l+=4,e.read_shift(4)!=0}function LG(e,t){var r=nt(8);return r.write_shift(4,e),r.write_shift(4,1),r}function IG(e,t,r){var s={Types:[],Cell:[],Value:[]},n=r||{},o=[],l=!1,u=2;return Fi(e,function(d,h,m){switch(m){case 335:s.Types.push({name:d.name});break;case 51:d.forEach(function(x){u==1?s.Cell.push({type:s.Types[x[0]-1].name,index:x[1]}):u==0&&s.Value.push({type:s.Types[x[0]-1].name,index:x[1]})});break;case 337:u=d?1:0;break;case 338:u=2;break;case 35:o.push(m),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!h.T){if(!l||n.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),s}function MG(){var e=ja();return dt(e,332),dt(e,334,An(1)),dt(e,335,CG({name:"XLDAPR",version:12e4,flags:3496657072})),dt(e,336),dt(e,339,OG(1,"XLDAPR")),dt(e,52),dt(e,35,An(514)),dt(e,4096,An(0)),dt(e,4097,dn(1)),dt(e,36),dt(e,53),dt(e,340),dt(e,337,LG(1)),dt(e,51,DG([[1,0]])),dt(e,338),dt(e,333),e.end()}function BG(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var n=!1,o=2,l;return e.replace(ua,function(u){var d=Kt(u);switch(Kn(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<s.Types.length;++h)s.Types[h].name==d.name&&(l=s.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?s.Cell.push({type:s.Types[d.t-1].name,index:+d.v}):o==0&&s.Value.push({type:s.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+d.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return u}),s}function jT(){var e=[ys];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function PG(e){var t=[];if(!e)return t;var r=1;return(e.match(ua)||[]).forEach(function(s){var n=Kt(s);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function UG(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Gt(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function zG(e,t,r){var s=[];return Fi(e,function(o,l,u){switch(u){case 63:s.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),s}function $G(e,t,r,s){if(!e)return e;var n=s||{},o=!1;Fi(e,function(u,d,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!d.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},n)}function qG(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Oc=1024;function TT(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[kt("xml",null,{"xmlns:v":Ma.v,"xmlns:o":Ma.o,"xmlns:x":Ma.x,"xmlns:mv":Ma.mv}).replace(/\/>/,">"),kt("o:shapelayout",kt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),kt("v:shapetype",[kt("v:stroke",null,{joinstyle:"miter"}),kt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];Oc<e*1e3;)Oc+=1e3;return t.forEach(function(o){var l=ts(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var d=u.type=="gradient"?kt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=kt("v:fill",d,u),m={on:"t",obscured:"t"};++Oc,n=n.concat(["<v:shape"+Hd({id:"_x0000_s"+Oc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,kt("v:shadow",null,m),kt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ys("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Ys("x:AutoFill","False"),Ys("x:Row",String(l.r)),Ys("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function T3(e,t,r,s){var n=Array.isArray(e),o;t.forEach(function(l){var u=ts(l.ref);if(n?(e[u.r]||(e[u.r]=[]),o=e[u.r][u.c]):o=e[l.ref],!o){o={t:"z"},n?e[u.r][u.c]=o:e[l.ref]=o;var d=gr(e["!ref"]||"BDWGO1000001:A1");d.s.r>u.r&&(d.s.r=u.r),d.e.r<u.r&&(d.e.r=u.r),d.s.c>u.c&&(d.s.c=u.c),d.e.c<u.c&&(d.e.c=u.c);var h=Zt(d);h!==e["!ref"]&&(e["!ref"]=h)}o.c||(o.c=[]);var m={a:l.author,t:l.t,r:l.r,T:r};l.h&&(m.h=l.h);for(var x=o.c.length-1;x>=0;--x){if(!r&&o.c[x].T)return;r&&!o.c[x].T&&o.c.splice(x,1)}if(r&&s){for(x=0;x<s.length;++x)if(m.a==s[x].id){m.a=s[x].name||m.a;break}}o.c.push(m)})}function HG(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var d=Kt(u[0]),h={author:d.authorId&&r[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},m=ts(d.ref);if(!(t.sheetRows&&t.sheetRows<=m.r)){var x=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!x&&!!x[1]&&ob(x[1])||{r:"",t:"",h:""};h.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),h.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(h.h=y.h),s.push(h)}}}}),s}function AT(e){var t=[ys,kt("comments",null,{xmlns:jl[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(n){var o=Dr(n.a);r.indexOf(o)==-1&&(r.push(o),t.push("<author>"+o+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var n=0,o=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?n=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(d){d.a&&(n=r.indexOf(Dr(d.a))),o.push(d.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+n+'"><text>'),o.length<=1)t.push(Ys("t",Dr(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)l+=`Reply:
    `+o[u]+`
`;t.push(Ys("t",Dr(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function WG(e,t){var r=[],s=!1,n={},o=0;return e.replace(ua,function(u,d){var h=Kt(u);switch(Kn(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":o=d+u.length;break;case"</text>":n.t=e.slice(o,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return u}),r}function GG(e,t,r){var s=[ys,kt("ThreadedComments",null,{xmlns:Cs.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var o="";(n[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var d={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?o=d.id:d.parentId=o,l.ID=d.id,l.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),s.push(kt("threadedComment",Ys("text",l.t||""),d))})}),s.push("</ThreadedComments>"),s.join("")}function VG(e,t){var r=[],s=!1;return e.replace(ua,function(o){var l=Kt(o);switch(Kn(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function KG(e){var t=[ys,kt("personList",null,{xmlns:Cs.TCMNT,"xmlns:x":jl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(kt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function XG(e){var t={};t.iauthor=e.read_shift(4);var r=Rl(e);return t.rfx=r.s,t.ref=Gt(r.s),e.l+=16,t}function YG(e,t){return t==null&&(t=nt(36)),t.write_shift(4,e[1].iauthor),cu(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var JG=oa;function ZG(e){return Ms(e.slice(0,54))}function QG(e,t){var r=[],s=[],n={},o=!1;return Fi(e,function(u,d,h){switch(h){case 632:s.push(u);break;case 635:n=u;break;case 637:n.t=u.t,n.h=u.h,n.r=u.r;break;case 636:if(n.author=s[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function eV(e){var t=ja(),r=[];return dt(t,628),dt(t,630),e.forEach(function(s){s[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),dt(t,632,ZG(n.a)))})}),dt(t,631),dt(t,633),e.forEach(function(s){s[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var o={s:ts(s[0]),e:ts(s[0])};dt(t,635,YG([o,n])),n.t&&n.t.length>0&&dt(t,637,_$(n)),dt(t,636),delete n.iauthor})}),dt(t,634),dt(t,629),t.end()}var tV="application/vnd.ms-office.vbaProject";function rV(e){var t=Pt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Pt.utils.cfb_add(t,n,e.FileIndex[s].content)}}),Pt.write(t)}function sV(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Pt.utils.cfb_add(e,n,t.FileIndex[s].content)}})}var CT=["xlsb","xlsm","xlam","biff8","xla"];function aV(){return{"!type":"dialog"}}function nV(){return{"!type":"dialog"}}function iV(){return{"!type":"macro"}}function oV(){return{"!type":"macro"}}var zc=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,n,o,l){var u=!1,d=!1;o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return u?m+=t.c:--m,d?h+=t.r:--h,n+(u?"":"$")+es(m)+(d?"":"$")+xs(h)}return function(n,o){return t=o,n.replace(e,r)}})(),db=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,fb=(function(){return function(t,r){return t.replace(db,function(s,n,o,l,u,d){var h=Zv(l)-(o?0:r.c),m=Jv(d)-(u?0:r.r),x=m==0?"":u?m+1:"["+m+"]",y=h==0?"":o?h+1:"["+h+"]";return n+"R"+x+"C"+y})}})();function RT(e,t){return e.replace(db,function(r,s,n,o,l,u){return s+(n=="$"?n+o:es(Zv(o)+t.c))+(l=="$"?l+u:xs(Jv(u)+t.r))})}function lV(e,t,r){var s=Ta(t),n=s.s,o=ts(r),l={r:o.r-n.r,c:o.c-n.c};return RT(e,l)}function cV(e){return e.length!=1}function A3(e){return e.replace(/_xlfn\./g,"")}function Ns(e){e.l+=1}function go(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function DT(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return OT(e);r.biff==12&&(s=4)}var n=e.read_shift(s),o=e.read_shift(s),l=go(e),u=go(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function OT(e){var t=go(e),r=go(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function uV(e,t,r){if(r.biff<8)return OT(e);var s=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),o=go(e),l=go(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function FT(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return dV(e);var s=e.read_shift(r&&r.biff==12?4:2),n=go(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function dV(e){var t=go(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function fV(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function hV(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return mV(e);var n=e.read_shift(s>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;n>524287;)n-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:n,c:o,cRel:l,rRel:u}}function mV(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:s}}function pV(e,t,r){var s=(e[e.l++]&96)>>5,n=DT(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function xV(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=DT(e,o,r);return[s,n,l]}function gV(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function yV(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[s,n]}function vV(e,t,r){var s=(e[e.l++]&96)>>5,n=uV(e,t-1,r);return[s,n]}function bV(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function C3(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function wV(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),n=[],o=0;o<=s;++o)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function _V(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function NV(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function kV(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function SV(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function LT(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function EV(e){return e.read_shift(2),LT(e)}function jV(e){return e.read_shift(2),LT(e)}function TV(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=FT(e,0,r);return[s,n]}function AV(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=hV(e,0,r);return[s,n]}function CV(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var o=FT(e,0,r);return[s,n,o]}function RV(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[FK[n],BT[n],s]}function DV(e,t,r){var s=e[e.l++],n=e.read_shift(1),o=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:OV(e);return[n,(o[0]===0?BT:OK)[o[1]]]}function OV(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function FV(e,t,r){e.l+=r&&r.biff==2?3:4}function LV(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function IV(e){return e.l++,Li[e.read_shift(1)]}function MV(e){return e.l++,e.read_shift(2)}function BV(e){return e.l++,e.read_shift(1)!==0}function PV(e){return e.l++,na(e)}function UV(e,t,r){return e.l++,mf(e,t-1,r)}function zV(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=ps(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Li[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=na(e);break;case 2:r[1]=Dl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function $V(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),n=[],o=0;o!=s;++o)n.push((r.biff==12?Rl:km)(e));return n}function qV(e,t,r){var s=0,n=0;r.biff==12?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var o=0,l=[];o!=s&&(l[o]=[]);++o)for(var u=0;u!=n;++u)l[o][u]=zV(e,r.biff);return l}function HV(e,t,r){var s=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,o=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,o]}function WV(e,t,r){if(r.biff==5)return GV(e);var s=e.read_shift(1)>>>5&3,n=e.read_shift(2),o=e.read_shift(4);return[s,n,o]}function GV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function VV(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function KV(e,t,r){var s=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function XV(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function YV(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[s,n]}var JV=ca,ZV=ca,QV=ca;function xf(e,t,r){return e.l+=2,[fV(e)]}function hb(e){return e.l+=6,[]}var eK=xf,tK=hb,rK=hb,sK=xf;function IT(e){return e.l+=2,[Ss(e),e.read_shift(2)&1]}var aK=xf,nK=IT,iK=hb,oK=xf,lK=xf,cK=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uK(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),o=e.read_shift(2),l=cK[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:s,c:n,C:o}}function dK(e){return e.l+=2,[e.read_shift(4)]}function fK(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function hK(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function mK(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function pK(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function xK(e){return e.l+=4,[0,0]}var R3={1:{n:"PtgExp",f:LV},2:{n:"PtgTbl",f:QV},3:{n:"PtgAdd",f:Ns},4:{n:"PtgSub",f:Ns},5:{n:"PtgMul",f:Ns},6:{n:"PtgDiv",f:Ns},7:{n:"PtgPower",f:Ns},8:{n:"PtgConcat",f:Ns},9:{n:"PtgLt",f:Ns},10:{n:"PtgLe",f:Ns},11:{n:"PtgEq",f:Ns},12:{n:"PtgGe",f:Ns},13:{n:"PtgGt",f:Ns},14:{n:"PtgNe",f:Ns},15:{n:"PtgIsect",f:Ns},16:{n:"PtgUnion",f:Ns},17:{n:"PtgRange",f:Ns},18:{n:"PtgUplus",f:Ns},19:{n:"PtgUminus",f:Ns},20:{n:"PtgPercent",f:Ns},21:{n:"PtgParen",f:Ns},22:{n:"PtgMissArg",f:Ns},23:{n:"PtgStr",f:UV},26:{n:"PtgSheet",f:fK},27:{n:"PtgEndSheet",f:hK},28:{n:"PtgErr",f:IV},29:{n:"PtgBool",f:BV},30:{n:"PtgInt",f:MV},31:{n:"PtgNum",f:PV},32:{n:"PtgArray",f:bV},33:{n:"PtgFunc",f:RV},34:{n:"PtgFuncVar",f:DV},35:{n:"PtgName",f:HV},36:{n:"PtgRef",f:TV},37:{n:"PtgArea",f:pV},38:{n:"PtgMemArea",f:VV},39:{n:"PtgMemErr",f:JV},40:{n:"PtgMemNoMem",f:ZV},41:{n:"PtgMemFunc",f:KV},42:{n:"PtgRefErr",f:XV},43:{n:"PtgAreaErr",f:gV},44:{n:"PtgRefN",f:AV},45:{n:"PtgAreaN",f:vV},46:{n:"PtgMemAreaN",f:mK},47:{n:"PtgMemNoMemN",f:pK},57:{n:"PtgNameX",f:WV},58:{n:"PtgRef3d",f:CV},59:{n:"PtgArea3d",f:xV},60:{n:"PtgRefErr3d",f:YV},61:{n:"PtgAreaErr3d",f:yV},255:{}},gK={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yK={1:{n:"PtgElfLel",f:IT},2:{n:"PtgElfRw",f:oK},3:{n:"PtgElfCol",f:eK},6:{n:"PtgElfRwV",f:lK},7:{n:"PtgElfColV",f:sK},10:{n:"PtgElfRadical",f:aK},11:{n:"PtgElfRadicalS",f:iK},13:{n:"PtgElfColS",f:tK},15:{n:"PtgElfColSV",f:rK},16:{n:"PtgElfRadicalLel",f:nK},25:{n:"PtgList",f:uK},29:{n:"PtgSxName",f:dK},255:{}},vK={0:{n:"PtgAttrNoop",f:xK},1:{n:"PtgAttrSemi",f:SV},2:{n:"PtgAttrIf",f:NV},4:{n:"PtgAttrChoose",f:wV},8:{n:"PtgAttrGoto",f:_V},16:{n:"PtgAttrSum",f:FV},32:{n:"PtgAttrBaxcel",f:C3},33:{n:"PtgAttrBaxcel",f:C3},64:{n:"PtgAttrSpace",f:EV},65:{n:"PtgAttrSpaceSemi",f:jV},128:{n:"PtgAttrIfError",f:kV},255:{}};function gf(e,t,r,s){if(s.biff<8)return ca(e,t);for(var n=e.l+t,o=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=qV(e,0,s),o.push(r[l][1]);break;case"PtgMemArea":r[l][2]=$V(e,r[l][1],s),o.push(r[l][2]);break;case"PtgExp":s&&s.biff==12&&(r[l][1][1]=e.read_shift(4),o.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=n-e.l,t!==0&&o.push(ca(e,t)),o}function yf(e,t,r){for(var s=e.l+t,n,o,l=[];s!=e.l;)t=s-e.l,o=e[e.l],n=R3[o]||R3[gK[o]],(o===24||o===25)&&(n=(o===24?yK:vK)[e[e.l+1]]),!n||!n.f?ca(e,t):l.push([n.n,n.f(e,t,r)]);return l}function bK(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],n=[],o=0;o<s.length;++o){var l=s[o];l?l[0]===2?n.push('"'+l[1].replace(/"/g,'""')+'"'):n.push(l[1]):n.push("")}t.push(n.join(","))}return t.join(";")}var wK={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function _K(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function MT(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[s[0]][0]){case 357:return n=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[s[0]][0][3]?(n=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function D3(e,t,r){var s=MT(e,t,r);return s=="#REF"?s:_K(s,r)}function sa(e,t,r,s,n){var o=n&&n.biff||8,l={s:{c:0,r:0}},u=[],d,h,m,x=0,y=0,b,v="";if(!e[0]||!e[0][0])return"";for(var g=-1,_="",w=0,S=e[0].length;w<S;++w){var N=e[0][w];switch(N[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=u.pop(),h=u.pop(),g>=0){switch(e[0][g][1][0]){case 0:_=is(" ",e[0][g][1][1]);break;case 1:_=is("\r",e[0][g][1][1]);break;default:if(_="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}h=h+_,g=-1}u.push(h+wK[N[0]]+d);break;case"PtgIsect":d=u.pop(),h=u.pop(),u.push(h+" "+d);break;case"PtgUnion":d=u.pop(),h=u.pop(),u.push(h+","+d);break;case"PtgRange":d=u.pop(),h=u.pop(),u.push(h+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=bd(N[1][1],l,n),u.push(wd(m,o));break;case"PtgRefN":m=r?bd(N[1][1],r,n):N[1][1],u.push(wd(m,o));break;case"PtgRef3d":x=N[1][1],m=bd(N[1][2],l,n),v=D3(s,x,n),u.push(v+"!"+wd(m,o));break;case"PtgFunc":case"PtgFuncVar":var E=N[1][0],C=N[1][1];E||(E=0),E&=127;var F=E==0?[]:u.slice(-E);u.length-=E,C==="User"&&(C=F.shift()),u.push(C+"("+F.join(",")+")");break;case"PtgBool":u.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(N[1]);break;case"PtgNum":u.push(String(N[1]));break;case"PtgStr":u.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(N[1]);break;case"PtgAreaN":b=o3(N[1][1],r?{s:r}:l,n),u.push(sy(b,n));break;case"PtgArea":b=o3(N[1][1],l,n),u.push(sy(b,n));break;case"PtgArea3d":x=N[1][1],b=N[1][2],v=D3(s,x,n),u.push(v+"!"+sy(b,n));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=N[1][2];var O=(s.names||[])[y-1]||(s[0]||[])[y],B=O?O.Name:"SH33TJSNAME"+String(y);B&&B.slice(0,6)=="_xlfn."&&!n.xlfn&&(B=B.slice(6)),u.push(B);break;case"PtgNameX":var L=N[1][1];y=N[1][2];var H;if(n.biff<=5)L<0&&(L=-L),s[L]&&(H=s[L][y]);else{var ue="";if(((s[L]||[])[0]||[])[0]==14849||(((s[L]||[])[0]||[])[0]==1025?s[L][y]&&s[L][y].itab>0&&(ue=s.SheetNames[s[L][y].itab-1]+"!"):ue=s.SheetNames[y-1]+"!"),s[L]&&s[L][y])ue+=s[L][y].Name;else if(s[0]&&s[0][y])ue+=s[0][y].Name;else{var A=(MT(s,L,n)||"").split(";;");A[y-1]?ue=A[y-1]:ue+="SH33TJSERRX"}u.push(ue);break}H||(H={Name:"SH33TJSERRY"}),u.push(H.Name);break;case"PtgParen":var Y="(",I=")";if(g>=0){switch(_="",e[0][g][1][0]){case 2:Y=is(" ",e[0][g][1][1])+Y;break;case 3:Y=is("\r",e[0][g][1][1])+Y;break;case 4:I=is(" ",e[0][g][1][1])+I;break;case 5:I=is("\r",e[0][g][1][1])+I;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}u.push(Y+u.pop()+I);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:N[1][1],r:N[1][0]};var ae={c:r.c,r:r.r};if(s.sharedf[Gt(m)]){var Q=s.sharedf[Gt(m)];u.push(sa(Q,l,ae,s,n))}else{var re=!1;for(d=0;d!=s.arrayf.length;++d)if(h=s.arrayf[d],!(m.c<h[0].s.c||m.c>h[0].e.c)&&!(m.r<h[0].s.r||m.r>h[0].e.r)){u.push(sa(h[1],l,ae,s,n)),re=!0;break}re||u.push(N[1])}break;case"PtgArray":u.push("{"+bK(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var ve=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&g>=0&&ve.indexOf(e[0][w][0])==-1){N=e[0][g];var te=!0;switch(N[1][0]){case 4:te=!1;case 0:_=is(" ",N[1][1]);break;case 5:te=!1;case 1:_=is("\r",N[1][1]);break;default:if(_="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}u.push((te?_:"")+u.pop()+(te?"":_)),g=-1}}if(u.length>1&&n.WTF)throw new Error("bad formula stack");return u[0]}function NK(e,t,r){var s=e.l+t,n=r.biff==2?1:2,o,l=e.read_shift(n);if(l==65535)return[[],ca(e,t-2)];var u=yf(e,l,r);return t!==l+n&&(o=gf(e,t-l-n,u,r)),e.l=s,[u,o]}function kK(e,t,r){var s=e.l+t,n=r.biff==2?1:2,o,l=e.read_shift(n);if(l==65535)return[[],ca(e,t-2)];var u=yf(e,l,r);return t!==l+n&&(o=gf(e,t-l-n,u,r)),e.l=s,[u,o]}function SK(e,t,r,s){var n=e.l+t,o=yf(e,s,r),l;return n!==e.l&&(l=gf(e,n-e.l,o,r)),[o,l]}function EK(e,t,r){var s=e.l+t,n,o=e.read_shift(2),l=yf(e,o,r);return o==65535?[[],ca(e,t-2)]:(t!==o+2&&(n=gf(e,s-o-2,l,r)),[l,n])}function jK(e){var t;if(vi(e,e.l+6)!==65535)return[na(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function TK(e){if(e==null){var t=nt(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return gl(e);return gl(0)}function ly(e,t,r){var s=e.l+t,n=Xn(e);r.biff==2&&++e.l;var o=jK(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=kK(e,s-e.l,r);return{cell:n,val:o[0],formula:u,shared:l>>3&1,tt:o[1]}}function AK(e,t,r,s,n){var o=vl(t,r,n),l=TK(e.v),u=nt(6),d=33;u.write_shift(2,d),u.write_shift(4,0);for(var h=nt(e.bf.length),m=0;m<e.bf.length;++m)h[m]=e.bf[m];var x=Is([o,l,u,h]);return x}function Sm(e,t,r){var s=e.read_shift(4),n=yf(e,s,r),o=e.read_shift(4),l=o>0?gf(e,o,n,r):null;return[n,l]}var CK=Sm,Em=Sm,RK=Sm,DK=Sm,OK={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},BT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FK={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function O3(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function LK(e){var t="of:="+e.replace(db,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function cy(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function IK(e){return e.replace(/\./,"!")}var Nd={},$c={},kd=typeof Map<"u";function mb(e,t,r){var s=0,n=e.length;if(r){if(kd?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var o=kd?r.get(t):r[t];s<o.length;++s)if(e[o[s]].t===t)return e.Count++,o[s]}}else for(;s<n;++s)if(e[s].t===t)return e.Count++,s;return e[n]={t},e.Count++,e.Unique++,r&&(kd?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function jm(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(aa=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=Xd(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=J0(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function dl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ko(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],n=60,o=e.length;if(s==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){_i(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=s=n;break}}for(n=0;n!=o;++n)if(e[n].numFmtId===s)return n;return e[o]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function PT(e,t,r,s,n,o){try{s.cellNF&&(e.z=Wt[t])}catch(u){if(s.WTF)throw u}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Vr(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(Wt[t]==null&&_i(Oz[t]||"General",t),e.t==="e")e.w=e.w||Li[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$d(e.v);else if(e.t==="d"){var l=Rs(e.v);(l|0)===l?e.w=l.toString(10):e.w=$d(l)}else{if(e.v===void 0)return"";e.w=pl(e.v,$c)}else e.t==="d"?e.w=mn(t,Rs(e.v),$c):e.w=mn(t,e.v,$c)}catch(u){if(s.WTF)throw u}if(s.cellStyles&&r!=null)try{e.s=o.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Y0(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Y0(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(s.WTF&&o.Fills)throw u}}}function MK(e,t,r){if(e&&e["!ref"]){var s=gr(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function BK(e,t){var r=gr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Zt(r))}var PK=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,UK=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,zK=/<(?:\w:)?hyperlink [^>]*>/mg,$K=/"(\w*:\w*)"/,qK=/<(?:\w:)?col\b[^>]*[\/]?>/g,HK=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,WK=/<(?:\w:)?pageMargins[^>]*\/>/g,UT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,GK=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,VK=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function KK(e,t,r,s,n,o,l){if(!e)return e;s||(s={"!id":{}});var u=t.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",m="",x=e.match(UK);x?(h=e.slice(0,x.index),m=e.slice(x.index+x[0].length)):h=m=e;var y=h.match(UT);y?pb(y[0],u,n,r):(y=h.match(GK))&&YK(y[0],y[1]||"",u,n,r);var b=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(b>0){var v=h.slice(b,b+50).match($K);v&&BK(u,v[1])}var g=h.match(VK);g&&g[1]&&cX(g[1],n);var _=[];if(t.cellStyles){var w=h.match(qK);w&&aX(_,w)}x&&fX(x[1],u,t,d,o,l);var S=m.match(HK);S&&(u["!autofilter"]=iX(S[0]));var N=[],E=m.match(PK);if(E)for(b=0;b!=E.length;++b)N[b]=gr(E[b].slice(E[b].indexOf('"')+1));var C=m.match(zK);C&&tX(u,C,s);var F=m.match(WK);if(F&&(u["!margins"]=rX(Kt(F[0]))),!u["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(u["!ref"]=Zt(d)),t.sheetRows>0&&u["!ref"]){var O=gr(u["!ref"]);t.sheetRows<=+O.e.r&&(O.e.r=t.sheetRows-1,O.e.r>d.e.r&&(O.e.r=d.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>d.e.c&&(O.e.c=d.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Zt(O))}return _.length>0&&(u["!cols"]=_),N.length>0&&(u["!merges"]=N),u}function XK(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Zt(e[r])+'"/>';return t+"</mergeCells>"}function pb(e,t,r,s){var n=Kt(e);r.Sheets[s]||(r.Sheets[s]={}),n.codeName&&(r.Sheets[s].CodeName=xr(Pr(n.codeName)))}function YK(e,t,r,s,n){pb(e.slice(0,e.indexOf(">")),r,s,n)}function JK(e,t,r,s,n){var o=!1,l={},u=null;if(s.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}o=!0,l.codeName=Hn(Dr(d))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),u=(u||"")+kt("outlinePr",null,h)}!o&&!u||(n[n.length]=kt("sheetPr",u,l))}var ZK=["objects","scenarios","selectLockedCells","selectUnlockedCells"],QK=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function eX(e){var t={sheet:1};return ZK.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),QK.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=lb(e.password).toString(16).toUpperCase()),kt("sheetProtection",null,t)}function tX(e,t,r){for(var s=Array.isArray(e),n=0;n!=t.length;++n){var o=Kt(Pr(t[n]),!0);if(!o.ref)return;var l=((r||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+xr(o.location))):(o.Target="#"+xr(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=gr(o.ref),d=u.s.r;d<=u.e.r;++d)for(var h=u.s.c;h<=u.e.c;++h){var m=Gt({c:h,r:d});s?(e[d]||(e[d]=[]),e[d][h]||(e[d][h]={t:"z",v:void 0}),e[d][h].l=o):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=o)}}}function rX(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function sX(e){return dl(e),kt("pageMargins",null,e)}function aX(e,t){for(var r=!1,s=0;s!=t.length;++s){var n=Kt(t[s],!0);n.hidden&&(n.hidden=Gr(n.hidden));var o=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,cb(n.width)),xo(n);o<=l;)e[o++]=Kr(n)}}function nX(e,t){for(var r=["<cols>"],s,n=0;n!=t.length;++n)(s=t[n])&&(r[r.length]=kt("col",null,jm(n,s)));return r[r.length]="</cols>",r.join("")}function iX(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function oX(e,t,r,s){var n=typeof e.ref=="string"?e.ref:Zt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Ta(n);l.s.r==l.e.r&&(l.e.r=Ta(t["!ref"]).e.r,n=Zt(l));for(var u=0;u<o.length;++u){var d=o[u];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+r.SheetNames[s]+"'!"+n;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),kt("autoFilter",null,{ref:n})}var lX=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function cX(e,t){t.Views||(t.Views=[{}]),(e.match(lX)||[]).forEach(function(r,s){var n=Kt(r);t.Views[s]||(t.Views[s]={}),+n.zoomScale&&(t.Views[s].zoom=+n.zoomScale),Gr(n.rightToLeft)&&(t.Views[s].RTL=!0)})}function uX(e,t,r,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),kt("sheetViews",kt("sheetView",null,n),{})}function dX(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",o=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Li[e.v];break;case"d":s&&s.cellDates?n=Vr(e.v,-1).toISOString():(e=Kr(e),e.t="n",n=""+(e.v=Rs(Vr(e.v)))),typeof e.z>"u"&&(e.z=Wt[14]);break;default:n=e.v;break}var u=Ys("v",Dr(n)),d={r:t},h=ko(s.cellXfs,e,s);switch(h!==0&&(d.s=h),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){u=Ys("v",""+mb(s.Strings,e.v,s.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=o&&(e.t=o,e.v=l),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=kt("f",Dr(e.f),m)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),kt("c",u,d)}var fX=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,o=qd("v"),l=qd("f");return function(d,h,m,x,y,b){for(var v=0,g="",_=[],w=[],S=0,N=0,E=0,C="",F,O,B=0,L=0,H,ue,A=0,Y=0,I=Array.isArray(b.CellXf),ae,Q=[],re=[],ve=Array.isArray(h),te=[],ke={},Z=!1,M=!!m.sheetStubs,J=d.split(t),V=0,X=J.length;V!=X;++V){g=J[V].trim();var se=g.length;if(se!==0){var P=0;e:for(v=0;v<se;++v)switch(g[v]){case">":if(g[v-1]!="/"){++v;break e}if(m&&m.cellStyles){if(O=Kt(g.slice(P,v),!0),B=O.r!=null?parseInt(O.r,10):B+1,L=-1,m.sheetRows&&m.sheetRows<B)continue;ke={},Z=!1,O.ht&&(Z=!0,ke.hpt=parseFloat(O.ht),ke.hpx=eu(ke.hpt)),O.hidden=="1"&&(Z=!0,ke.hidden=!0),O.outlineLevel!=null&&(Z=!0,ke.level=+O.outlineLevel),Z&&(te[B-1]=ke)}break;case"<":P=v;break}if(P>=v)break;if(O=Kt(g.slice(P,v),!0),B=O.r!=null?parseInt(O.r,10):B+1,L=-1,!(m.sheetRows&&m.sheetRows<B)){x.s.r>B-1&&(x.s.r=B-1),x.e.r<B-1&&(x.e.r=B-1),m&&m.cellStyles&&(ke={},Z=!1,O.ht&&(Z=!0,ke.hpt=parseFloat(O.ht),ke.hpx=eu(ke.hpt)),O.hidden=="1"&&(Z=!0,ke.hidden=!0),O.outlineLevel!=null&&(Z=!0,ke.level=+O.outlineLevel),Z&&(te[B-1]=ke)),_=g.slice(v).split(e);for(var U=0;U!=_.length&&_[U].trim().charAt(0)=="<";++U);for(_=_.slice(U),v=0;v!=_.length;++v)if(g=_[v].trim(),g.length!==0){if(w=g.match(r),S=v,N=0,E=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,w!=null&&w.length===2){for(S=0,C=w[1],N=0;N!=C.length&&!((E=C.charCodeAt(N)-64)<1||E>26);++N)S=26*S+E;--S,L=S}else++L;for(N=0;N!=g.length&&g.charCodeAt(N)!==62;++N);if(++N,O=Kt(g.slice(0,N),!0),O.r||(O.r=Gt({r:B-1,c:L})),C=g.slice(N),F={t:""},(w=C.match(o))!=null&&w[1]!==""&&(F.v=xr(w[1])),m.cellFormula){if((w=C.match(l))!=null&&w[1]!==""){if(F.f=xr(Pr(w[1])).replace(/\r\n/g,`
`),m.xlfn||(F.f=A3(F.f)),w[0].indexOf('t="array"')>-1)F.F=(C.match(n)||[])[1],F.F.indexOf(":")>-1&&Q.push([gr(F.F),F.F]);else if(w[0].indexOf('t="shared"')>-1){ue=Kt(w[0]);var ce=xr(Pr(w[1]));m.xlfn||(ce=A3(ce)),re[parseInt(ue.si,10)]=[ue,ce,O.r]}}else(w=C.match(/<f[^>]*\/>/))&&(ue=Kt(w[0]),re[ue.si]&&(F.f=lV(re[ue.si][1],re[ue.si][2],O.r)));var ne=ts(O.r);for(N=0;N<Q.length;++N)ne.r>=Q[N][0].s.r&&ne.r<=Q[N][0].e.r&&ne.c>=Q[N][0].s.c&&ne.c<=Q[N][0].e.c&&(F.F=Q[N][1])}if(O.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(M)F.t="z";else continue;else F.t=O.t||"n";switch(x.s.c>L&&(x.s.c=L),x.e.c<L&&(x.e.c=L),F.t){case"n":if(F.v==""||F.v==null){if(!M)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!M)continue;F.t="z"}else H=Nd[parseInt(F.v,10)],F.v=H.t,F.r=H.r,m.cellHTML&&(F.h=H.h);break;case"str":F.t="s",F.v=F.v!=null?Pr(F.v):"",m.cellHTML&&(F.h=Vv(F.v));break;case"inlineStr":w=C.match(s),F.t="s",w!=null&&(H=ob(w[1]))?(F.v=H.t,m.cellHTML&&(F.h=H.h)):F.v="";break;case"b":F.v=Gr(F.v);break;case"d":m.cellDates?F.v=Vr(F.v,1):(F.v=Rs(Vr(F.v,1)),F.t="n");break;case"e":(!m||m.cellText!==!1)&&(F.w=F.v),F.v=$5[F.v];break}if(A=Y=0,ae=null,I&&O.s!==void 0&&(ae=b.CellXf[O.s],ae!=null&&(ae.numFmtId!=null&&(A=ae.numFmtId),m.cellStyles&&ae.fillId!=null&&(Y=ae.fillId))),PT(F,A,Y,m,y,b),m.cellDates&&I&&F.t=="n"&&iu(Wt[A])&&(F.t="d",F.v=Nm(F.v)),O.cm&&m.xlmeta){var ie=(m.xlmeta.Cell||[])[+O.cm-1];ie&&ie.type=="XLDAPR"&&(F.D=!0)}if(ve){var W=ts(O.r);h[W.r]||(h[W.r]=[]),h[W.r][W.c]=F}else h[O.r]=F}}}}te.length>0&&(h["!rows"]=te)}})();function hX(e,t,r,s){var n=[],o=[],l=gr(e["!ref"]),u="",d,h="",m=[],x=0,y=0,b=e["!rows"],v=Array.isArray(e),g={r:h},_,w=-1;for(y=l.s.c;y<=l.e.c;++y)m[y]=es(y);for(x=l.s.r;x<=l.e.r;++x){for(o=[],h=xs(x),y=l.s.c;y<=l.e.c;++y){d=m[y]+h;var S=v?(e[x]||[])[y]:e[d];S!==void 0&&(u=dX(S,d,e,t))!=null&&o.push(u)}(o.length>0||b&&b[x])&&(g={r:h},b&&b[x]&&(_=b[x],_.hidden&&(g.hidden=1),w=-1,_.hpx?w=Yd(_.hpx):_.hpt&&(w=_.hpt),w>-1&&(g.ht=w,g.customHeight=1),_.level&&(g.outlineLevel=_.level)),n[n.length]=kt("row",o.join(""),g))}if(b)for(;x<b.length;++x)b&&b[x]&&(g={r:x+1},_=b[x],_.hidden&&(g.hidden=1),w=-1,_.hpx?w=Yd(_.hpx):_.hpt&&(w=_.hpt),w>-1&&(g.ht=w,g.customHeight=1),_.level&&(g.outlineLevel=_.level),n[n.length]=kt("row","",g));return n.join("")}function zT(e,t,r,s){var n=[ys,kt("worksheet",null,{xmlns:jl[0],"xmlns:r":Cs.r})],o=r.SheetNames[e],l=0,u="",d=r.Sheets[o];d==null&&(d={});var h=d["!ref"]||"A1",m=gr(h);if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),h=Zt(m)}s||(s={}),d["!comments"]=[];var x=[];JK(d,r,e,t,n),n[n.length]=kt("dimension",null,{ref:h}),n[n.length]=uX(d,t,e,r),t.sheetFormat&&(n[n.length]=kt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(n[n.length]=nX(d,d["!cols"])),n[l=n.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(u=hX(d,t),u.length>0&&(n[n.length]=u)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),d["!protect"]&&(n[n.length]=eX(d["!protect"])),d["!autofilter"]!=null&&(n[n.length]=oX(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(n[n.length]=XK(d["!merges"]));var y=-1,b,v=-1;return d["!links"].length>0&&(n[n.length]="<hyperlinks>",d["!links"].forEach(function(g){g[1].Target&&(b={ref:g[0]},g[1].Target.charAt(0)!="#"&&(v=Cr(s,-1,Dr(g[1].Target).replace(/#.*$/,""),ir.HLINK),b["r:id"]="rId"+v),(y=g[1].Target.indexOf("#"))>-1&&(b.location=Dr(g[1].Target.slice(y+1))),g[1].Tooltip&&(b.tooltip=Dr(g[1].Tooltip)),n[n.length]=kt("hyperlink",null,b))}),n[n.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(n[n.length]=sX(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=Ys("ignoredErrors",kt("ignoredError",null,{numberStoredAsText:1,sqref:h}))),x.length>0&&(v=Cr(s,-1,"../drawings/drawing"+(e+1)+".xml",ir.DRAW),n[n.length]=kt("drawing",null,{"r:id":"rId"+v}),d["!drawing"]=x),d["!comments"].length>0&&(v=Cr(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ir.VML),n[n.length]=kt("legacyDrawing",null,{"r:id":"rId"+v}),d["!legacy"]=v),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function mX(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=s,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=n/20),r}function pX(e,t,r){var s=nt(145),n=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var o=320;n.hpx?o=Yd(n.hpx)*20:n.hpt&&(o=n.hpt*20),s.write_shift(2,o),s.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),s.write_shift(1,l),s.write_shift(1,0);var u=0,d=s.l;s.l+=4;for(var h={r:e,c:0},m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var x=-1,y=-1,b=m<<10;b<m+1<<10;++b){h.c=b;var v=Array.isArray(r)?(r[h.r]||[])[h.c]:r[Gt(h)];v&&(x<0&&(x=b),y=b)}x<0||(++u,s.write_shift(4,x),s.write_shift(4,y))}var g=s.l;return s.l=d,s.write_shift(4,u),s.l=g,s.length>s.l?s.slice(0,s.l):s}function xX(e,t,r,s){var n=pX(s,r,t);(n.length>17||(t["!rows"]||[])[s])&&dt(e,0,n)}var gX=Rl,yX=cu;function vX(){}function bX(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=N$(e),r}function wX(e,t,r){r==null&&(r=nt(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var n=1;n<3;++n)r.write_shift(1,0);return V0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),M5(e,r),r.slice(0,r.l)}function _X(e){var t=xn(e);return[t]}function NX(e,t,r){return r==null&&(r=nt(8)),Tl(t,r)}function kX(e){var t=Al(e);return[t]}function SX(e,t,r){return r==null&&(r=nt(4)),Cl(t,r)}function EX(e){var t=xn(e),r=e.read_shift(1);return[t,r,"b"]}function jX(e,t,r){return r==null&&(r=nt(9)),Tl(t,r),r.write_shift(1,e.v?1:0),r}function TX(e){var t=Al(e),r=e.read_shift(1);return[t,r,"b"]}function AX(e,t,r){return r==null&&(r=nt(5)),Cl(t,r),r.write_shift(1,e.v?1:0),r}function CX(e){var t=xn(e),r=e.read_shift(1);return[t,r,"e"]}function RX(e,t,r){return r==null&&(r=nt(9)),Tl(t,r),r.write_shift(1,e.v),r}function DX(e){var t=Al(e),r=e.read_shift(1);return[t,r,"e"]}function OX(e,t,r){return r==null&&(r=nt(8)),Cl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function FX(e){var t=xn(e),r=e.read_shift(4);return[t,r,"s"]}function LX(e,t,r){return r==null&&(r=nt(12)),Tl(t,r),r.write_shift(4,t.v),r}function IX(e){var t=Al(e),r=e.read_shift(4);return[t,r,"s"]}function MX(e,t,r){return r==null&&(r=nt(8)),Cl(t,r),r.write_shift(4,t.v),r}function BX(e){var t=xn(e),r=na(e);return[t,r,"n"]}function PX(e,t,r){return r==null&&(r=nt(16)),Tl(t,r),gl(e.v,r),r}function $T(e){var t=Al(e),r=na(e);return[t,r,"n"]}function UX(e,t,r){return r==null&&(r=nt(12)),Cl(t,r),gl(e.v,r),r}function zX(e){var t=xn(e),r=rb(e);return[t,r,"n"]}function $X(e,t,r){return r==null&&(r=nt(12)),Tl(t,r),B5(e.v,r),r}function qX(e){var t=Al(e),r=rb(e);return[t,r,"n"]}function HX(e,t,r){return r==null&&(r=nt(8)),Cl(t,r),B5(e.v,r),r}function WX(e){var t=xn(e),r=Qv(e);return[t,r,"is"]}function GX(e){var t=xn(e),r=oa(e);return[t,r,"str"]}function VX(e,t,r){return r==null&&(r=nt(12+4*e.v.length)),Tl(t,r),Ms(e.v,r),r.length>r.l?r.slice(0,r.l):r}function KX(e){var t=Al(e),r=oa(e);return[t,r,"str"]}function XX(e,t,r){return r==null&&(r=nt(8+4*e.v.length)),Cl(t,r),Ms(e.v,r),r.length>r.l?r.slice(0,r.l):r}function YX(e,t,r){var s=e.l+t,n=xn(e);n.r=r["!row"];var o=e.read_shift(1),l=[n,o,"b"];if(r.cellFormula){e.l+=2;var u=Em(e,s-e.l,r);l[3]=sa(u,null,n,r.supbooks,r)}else e.l=s;return l}function JX(e,t,r){var s=e.l+t,n=xn(e);n.r=r["!row"];var o=e.read_shift(1),l=[n,o,"e"];if(r.cellFormula){e.l+=2;var u=Em(e,s-e.l,r);l[3]=sa(u,null,n,r.supbooks,r)}else e.l=s;return l}function ZX(e,t,r){var s=e.l+t,n=xn(e);n.r=r["!row"];var o=na(e),l=[n,o,"n"];if(r.cellFormula){e.l+=2;var u=Em(e,s-e.l,r);l[3]=sa(u,null,n,r.supbooks,r)}else e.l=s;return l}function QX(e,t,r){var s=e.l+t,n=xn(e);n.r=r["!row"];var o=oa(e),l=[n,o,"str"];if(r.cellFormula){e.l+=2;var u=Em(e,s-e.l,r);l[3]=sa(u,null,n,r.supbooks,r)}else e.l=s;return l}var eY=Rl,tY=cu;function rY(e,t){return t==null&&(t=nt(4)),t.write_shift(4,e),t}function sY(e,t){var r=e.l+t,s=Rl(e),n=eb(e),o=oa(e),l=oa(e),u=oa(e);e.l=r;var d={rfx:s,relId:n,loc:o,display:u};return l&&(d.Tooltip=l),d}function aY(e,t){var r=nt(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));cu({s:ts(e[0]),e:ts(e[0])},r),tb("rId"+t,r);var s=e[1].Target.indexOf("#"),n=s==-1?"":e[1].Target.slice(s+1);return Ms(n||"",r),Ms(e[1].Tooltip||"",r),Ms("",r),r.slice(0,r.l)}function nY(){}function iY(e,t,r){var s=e.l+t,n=P5(e),o=e.read_shift(1),l=[n];if(l[2]=o,r.cellFormula){var u=CK(e,s-e.l,r);l[1]=u}else e.l=s;return l}function oY(e,t,r){var s=e.l+t,n=Rl(e),o=[n];if(r.cellFormula){var l=DK(e,s-e.l,r);o[1]=l,e.l=s}else e.l=s;return o}function lY(e,t,r){r==null&&(r=nt(18));var s=jm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof s.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var qT=["left","right","top","bottom","header","footer"];function cY(e){var t={};return qT.forEach(function(r){t[r]=na(e)}),t}function uY(e,t){return t==null&&(t=nt(48)),dl(e),qT.forEach(function(r){gl(e[r],t)}),t}function dY(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function fY(e,t,r){r==null&&(r=nt(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function hY(e){var t=nt(24);return t.write_shift(4,4),t.write_shift(4,1),cu(e,t),t}function mY(e,t){return t==null&&(t=nt(66)),t.write_shift(2,e.password?lb(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function pY(){}function xY(){}function gY(e,t,r,s,n,o,l){if(!e)return e;var u=t||{};s||(s={"!id":{}});var d=u.dense?[]:{},h,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,y=!1,b,v,g,_,w,S,N,E,C,F=[];u.biff=12,u["!row"]=0;var O=0,B=!1,L=[],H={},ue=u.supbooks||n.supbooks||[[]];if(ue.sharedf=H,ue.arrayf=L,ue.SheetNames=n.SheetNames||n.Sheets.map(function(ve){return ve.name}),!u.supbooks&&(u.supbooks=ue,n.Names))for(var A=0;A<n.Names.length;++A)ue[0][A+1]=n.Names[A];var Y=[],I=[],ae=!1;Jd[16]={n:"BrtShortReal",f:$T};var Q;if(Fi(e,function(te,ke,Z){if(!y)switch(Z){case 148:h=te;break;case 0:b=te,u.sheetRows&&u.sheetRows<=b.r&&(y=!0),E=xs(_=b.r),u["!row"]=b.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=eu(te.hpt)),I[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:te[2]},te[2]){case"n":v.v=te[1];break;case"s":N=Nd[te[1]],v.v=N.t,v.r=N.r;break;case"b":v.v=!!te[1];break;case"e":v.v=te[1],u.cellText!==!1&&(v.w=Li[v.v]);break;case"str":v.t="s",v.v=te[1];break;case"is":v.t="s",v.v=te[1].t;break}if((g=l.CellXf[te[0].iStyleRef])&&PT(v,g.numFmtId,null,u,o,l),w=te[0].c==-1?w+1:te[0].c,u.dense?(d[_]||(d[_]=[]),d[_][w]=v):d[es(w)+E]=v,u.cellFormula){for(B=!1,O=0;O<L.length;++O){var M=L[O];b.r>=M[0].s.r&&b.r<=M[0].e.r&&w>=M[0].s.c&&w<=M[0].e.c&&(v.F=Zt(M[0]),B=!0)}!B&&te.length>3&&(v.f=te[3])}if(m.s.r>b.r&&(m.s.r=b.r),m.s.c>w&&(m.s.c=w),m.e.r<b.r&&(m.e.r=b.r),m.e.c<w&&(m.e.c=w),u.cellDates&&g&&v.t=="n"&&iu(Wt[g.numFmtId])){var J=nl(v.v);J&&(v.t="d",v.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}Q&&(Q.type=="XLDAPR"&&(v.D=!0),Q=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;v={t:"z",v:void 0},w=te[0].c==-1?w+1:te[0].c,u.dense?(d[_]||(d[_]=[]),d[_][w]=v):d[es(w)+E]=v,m.s.r>b.r&&(m.s.r=b.r),m.s.c>w&&(m.s.c=w),m.e.r<b.r&&(m.e.r=b.r),m.e.c<w&&(m.e.c=w),Q&&(Q.type=="XLDAPR"&&(v.D=!0),Q=void 0);break;case 176:F.push(te);break;case 49:Q=((u.xlmeta||{}).Cell||[])[te-1];break;case 494:var V=s["!id"][te.relId];for(V?(te.Target=V.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=V):te.relId==""&&(te.Target="#"+te.loc),_=te.rfx.s.r;_<=te.rfx.e.r;++_)for(w=te.rfx.s.c;w<=te.rfx.e.c;++w)u.dense?(d[_]||(d[_]=[]),d[_][w]||(d[_][w]={t:"z",v:void 0}),d[_][w].l=te):(S=Gt({c:w,r:_}),d[S]||(d[S]={t:"z",v:void 0}),d[S].l=te);break;case 426:if(!u.cellFormula)break;L.push(te),C=u.dense?d[_][w]:d[es(w)+E],C.f=sa(te[1],m,{r:b.r,c:w},ue,u),C.F=Zt(te[0]);break;case 427:if(!u.cellFormula)break;H[Gt(te[0].s)]=te[1],C=u.dense?d[_][w]:d[es(w)+E],C.f=sa(te[1],m,{r:b.r,c:w},ue,u);break;case 60:if(!u.cellStyles)break;for(;te.e>=te.s;)Y[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},ae||(ae=!0,cb(te.w/256)),xo(Y[te.e+1]);break;case 161:d["!autofilter"]={ref:Zt(te)};break;case 476:d["!margins"]=te;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),te.name&&(n.Sheets[r].CodeName=te.name),(te.above||te.left)&&(d["!outline"]={above:te.above,left:te.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),te.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!ke.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+Z.toString(16))}}},u),delete u.supbooks,delete u["!row"],!d["!ref"]&&(m.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(d["!ref"]=Zt(h||m)),u.sheetRows&&d["!ref"]){var re=gr(d["!ref"]);u.sheetRows<=+re.e.r&&(re.e.r=u.sheetRows-1,re.e.r>m.e.r&&(re.e.r=m.e.r),re.e.r<re.s.r&&(re.s.r=re.e.r),re.e.c>m.e.c&&(re.e.c=m.e.c),re.e.c<re.s.c&&(re.s.c=re.e.c),d["!fullref"]=d["!ref"],d["!ref"]=Zt(re))}return F.length>0&&(d["!merges"]=F),Y.length>0&&(d["!cols"]=Y),I.length>0&&(d["!rows"]=I),d}function yY(e,t,r,s,n,o,l){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Kr(t),t.z=t.z||Wt[14],t.v=Rs(Vr(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var d={r,c:s};switch(d.s=ko(n.cellXfs,t,n),t.l&&o["!links"].push([Gt(d),t.l]),t.c&&o["!comments"].push([Gt(d),t.c]),t.t){case"s":case"str":return n.bookSST?(u=mb(n.Strings,t.v,n.revStrings),d.t="s",d.v=u,l?dt(e,18,MX(t,d)):dt(e,7,LX(t,d))):(d.t="str",l?dt(e,17,XX(t,d)):dt(e,6,VX(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?dt(e,13,HX(t,d)):dt(e,2,$X(t,d)):l?dt(e,16,UX(t,d)):dt(e,5,PX(t,d)),!0;case"b":return d.t="b",l?dt(e,15,AX(t,d)):dt(e,4,jX(t,d)),!0;case"e":return d.t="e",l?dt(e,14,OX(t,d)):dt(e,3,RX(t,d)),!0}return l?dt(e,12,SX(t,d)):dt(e,1,NX(t,d)),!0}function vY(e,t,r,s){var n=gr(t["!ref"]||"A1"),o,l="",u=[];dt(e,145);var d=Array.isArray(t),h=n.e.r;t["!rows"]&&(h=Math.max(n.e.r,t["!rows"].length-1));for(var m=n.s.r;m<=h;++m){l=xs(m),xX(e,t,n,m);var x=!1;if(m<=n.e.r)for(var y=n.s.c;y<=n.e.c;++y){m===n.s.r&&(u[y]=es(y)),o=u[y]+l;var b=d?(t[m]||[])[y]:t[o];if(!b){x=!1;continue}x=yY(e,b,m,y,s,t,x)}}dt(e,146)}function bY(e,t){!t||!t["!merges"]||(dt(e,177,rY(t["!merges"].length)),t["!merges"].forEach(function(r){dt(e,176,tY(r))}),dt(e,178))}function wY(e,t){!t||!t["!cols"]||(dt(e,390),t["!cols"].forEach(function(r,s){r&&dt(e,60,lY(s,r))}),dt(e,391))}function _Y(e,t){!t||!t["!ref"]||(dt(e,648),dt(e,649,hY(gr(t["!ref"]))),dt(e,650))}function NY(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var n=Cr(r,-1,s[1].Target.replace(/#.*$/,""),ir.HLINK);dt(e,494,aY(s,n))}}),delete t["!links"]}function kY(e,t,r,s){if(t["!comments"].length>0){var n=Cr(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ir.VML);dt(e,551,tb("rId"+n)),t["!legacy"]=n}}function SY(e,t,r,s){if(t["!autofilter"]){var n=t["!autofilter"],o=typeof n.ref=="string"?n.ref:Zt(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,u=Ta(o);u.s.r==u.e.r&&(u.e.r=Ta(t["!ref"]).e.r,o=Zt(u));for(var d=0;d<l.length;++d){var h=l[d];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==s){h.Ref="'"+r.SheetNames[s]+"'!"+o;break}}d==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+o}),dt(e,161,cu(gr(o))),dt(e,162)}}function EY(e,t,r){dt(e,133),dt(e,137,fY(t,r)),dt(e,138),dt(e,134)}function jY(e,t){t["!protect"]&&dt(e,535,mY(t["!protect"]))}function TY(e,t,r,s){var n=ja(),o=r.SheetNames[e],l=r.Sheets[o]||{},u=o;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var d=gr(l["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],dt(n,129),(r.vbaraw||l["!outline"])&&dt(n,147,wX(u,l["!outline"])),dt(n,148,yX(d)),EY(n,l,r.Workbook),wY(n,l),vY(n,l,e,t),jY(n,l),SY(n,l,r,e),bY(n,l),NY(n,l,s),l["!margins"]&&dt(n,476,uY(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&_Y(n,l),kY(n,l,e,s),dt(n,130),n.end()}function AY(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var n=xr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){s=o.replace(/<.*?>/g,"")}),[t,n,s]}function CY(e,t,r,s,n,o){var l=o||{"!type":"chart"};if(!e)return o;var u=0,d=0,h="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var y=AY(x);m.s.r=m.s.c=0,m.e.c=u,h=es(u),y[0].forEach(function(b,v){l[h+xs(v)]={t:"n",v:b,z:y[1]},d=v}),m.e.r<d&&(m.e.r=d),++u}),u>0&&(l["!ref"]=Zt(m)),l}function RY(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,u=e.match(UT);return u&&pb(u[0],o,n,r),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),s["!id"][o["!rel"]]&&(o["!drawel"]=s["!id"][o["!rel"]]),o}function DY(e,t){e.l+=10;var r=oa(e);return{name:r}}function OY(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Fi(e,function(d,h,m){switch(m){case 550:o["!rel"]=d;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),d.name&&(n.Sheets[r].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},t),s["!id"][o["!rel"]]&&(o["!drawel"]=s["!id"][o["!rel"]]),o}var xb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],FY=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],LY=[],IY=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function F3(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],n=0;n!=t.length;++n){var o=t[n];if(s[o[0]]==null)s[o[0]]=o[1];else switch(o[2]){case"bool":typeof s[o[0]]=="string"&&(s[o[0]]=Gr(s[o[0]]));break;case"int":typeof s[o[0]]=="string"&&(s[o[0]]=parseInt(s[o[0]],10));break}}}function L3(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=Gr(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function HT(e){L3(e.WBProps,xb),L3(e.CalcPr,IY),F3(e.WBView,FY),F3(e.Sheets,LY),$c.date1904=Gr(e.WBProps.date1904)}function MY(e){return!e.Workbook||!e.Workbook.WBProps?"false":Gr(e.Workbook.WBProps.date1904)?"true":"false"}var BY="][*?/\\".split("");function WT(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return BY.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function PY(e,t,r){e.forEach(function(s,n){WT(s);for(var o=0;o<n;++o)if(s==e[o])throw new Error("Duplicate Sheet Name: "+s);if(r){var l=t&&t[n]&&t[n].CodeName||s;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function UY(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];PY(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)MK(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var zY=/<\w+:workbook/;function $Y(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,n="xmlns",o={},l=0;if(e.replace(ua,function(d,h){var m=Kt(d);switch(Kn(m[0])){case"<?xml":break;case"<workbook":d.match(zY)&&(n="xmlns"+d.match(/<(\w+):/)[1]),r.xmlns=m[n];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":xb.forEach(function(x){if(m[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=Gr(m[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(m[x[0]],10);break;default:r.WBProps[x[0]]=m[x[0]]}}),m.codeName&&(r.WBProps.CodeName=Pr(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=xr(Pr(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":o={},o.Name=Pr(m.name),m.comment&&(o.Comment=m.comment),m.localSheetId&&(o.Sheet=+m.localSheetId),Gr(m.hidden||"0")&&(o.Hidden=!0),l=h+d.length;break;case"</definedName>":o.Ref=xr(Pr(e.slice(l,h))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return d}),jl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return HT(r),r}function GT(e){var t=[ys];t[t.length]=kt("workbook",null,{xmlns:jl[0],"xmlns:r":Cs.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(xb.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(s[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=kt("workbookPr",null,s);var n=e.Workbook&&e.Workbook.Sheets||[],o=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!n[o]||!n[o].Hidden);++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var l={name:Dr(e.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),n[o])switch(n[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=kt("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var d={name:u.Name};u.Comment&&(d.comment=u.Comment),u.Sheet!=null&&(d.localSheetId=""+u.Sheet),u.Hidden&&(d.hidden="1"),u.Ref&&(t[t.length]=kt("definedName",Dr(u.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function qY(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Vy(e),r.name=oa(e),r}function HY(e,t){return t||(t=nt(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),tb(e.strRelID,t),Ms(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function WY(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?oa(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function GY(e,t){t||(t=nt(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),M5(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function VY(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function KY(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),o=k$(e),l=RK(e,0,r),u=eb(e);e.l=s;var d={Name:o,Ptg:l};return n<268435455&&(d.Sheet=n),u&&(d.Comment=u),d}function XY(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],n=!1;t||(t={}),t.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Jd[16]={n:"BrtFRTArchID$",f:VY},Fi(e,function(d,h,m){switch(m){case 156:l.SheetNames.push(d.name),r.Sheets.push(d);break;case 153:r.WBProps=d;break;case 39:d.Sheet!=null&&(t.SID=d.Sheet),d.Ref=sa(d.Ptg,null,null,l,t),delete t.SID,delete d.Ptg,o.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,d]):l[0]=[m,d],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(d),l.XTI=l.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(m),n=!0;break;case 36:s.pop(),n=!1;break;case 37:s.push(m),n=!0;break;case 38:s.pop(),n=!1;break;case 16:break;default:if(!h.T){if(!n||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},t),HT(r),r.Names=o,r.supbooks=l,r}function YY(e,t){dt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};dt(e,156,HY(n))}dt(e,144)}function JY(e,t){t||(t=nt(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ms("SheetJS",t),Ms(U0.version,t),Ms(U0.version,t),Ms("7262",t),t.length>t.l?t.slice(0,t.l):t}function ZY(e,t){t||(t=nt(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function QY(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,n=-1,o=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&n==-1?n=s:r[s].Hidden==1&&o==-1&&(o=s);o>n||(dt(e,135),dt(e,158,ZY(n)),dt(e,136))}}function eJ(e,t){var r=ja();return dt(r,131),dt(r,128,JY()),dt(r,153,GY(e.Workbook&&e.Workbook.WBProps||null)),QY(r,e),YY(r,e),dt(r,132),r.end()}function tJ(e,t,r){return t.slice(-4)===".bin"?XY(e,r):$Y(e,r)}function rJ(e,t,r,s,n,o,l,u){return t.slice(-4)===".bin"?gY(e,s,r,n,o,l,u):KK(e,s,r,n,o,l,u)}function sJ(e,t,r,s,n,o,l,u){return t.slice(-4)===".bin"?OY(e,s,r,n,o):RY(e,s,r,n,o)}function aJ(e,t,r,s,n,o,l,u){return t.slice(-4)===".bin"?iV():oV()}function nJ(e,t,r,s,n,o,l,u){return t.slice(-4)===".bin"?aV():nV()}function iJ(e,t,r,s){return t.slice(-4)===".bin"?tG(e,r,s):qW(e,r,s)}function oJ(e,t,r){return ET(e,r)}function lJ(e,t,r){return t.slice(-4)===".bin"?lW(e,r):nW(e,r)}function cJ(e,t,r){return t.slice(-4)===".bin"?QG(e,r):HG(e,r)}function uJ(e,t,r){return t.slice(-4)===".bin"?zG(e):PG(e)}function dJ(e,t,r,s){return r.slice(-4)===".bin"?$G(e,t,r,s):void 0}function fJ(e,t,r){return t.slice(-4)===".bin"?IG(e,t,r):BG(e,t,r)}function hJ(e,t,r){return(t.slice(-4)===".bin"?eJ:GT)(e)}function mJ(e,t,r,s,n){return(t.slice(-4)===".bin"?TY:zT)(e,r,s,n)}function pJ(e,t,r){return(t.slice(-4)===".bin"?dG:kT)(e,r)}function xJ(e,t,r){return(t.slice(-4)===".bin"?dW:xT)(e,r)}function gJ(e,t,r){return(t.slice(-4)===".bin"?eV:AT)(e)}function yJ(e){return(e.slice(-4)===".bin"?MG:jT)()}var VT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,KT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function bn(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var n=e.match(VT),o,l,u,d;if(n)for(d=0;d!=n.length;++d)o=n[d].match(KT),(l=o[1].indexOf(":"))===-1?s[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(l+1),s[u]=o[2].slice(1,o[2].length-1));return s}function vJ(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(VT),n,o,l,u;if(s)for(u=0;u!=s.length;++u)n=s[u].match(KT),(o=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(o+1),r[l]=n[2].slice(1,n[2].length-1));return r}var Sd;function bJ(e,t){var r=Sd[e]||xr(e);return r==="General"?pl(t):mn(r,t)}function wJ(e,t,r,s){var n=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Gr(s);break;case"i2":case"int":n=parseInt(s,10);break;case"r4":case"float":n=parseFloat(s);break;case"date":case"dateTime.tz":n=Vr(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[xr(t)]=n}function _J(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Li[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$d(e.v):e.w=pl(e.v):e.w=bJ(t||"General",e.v)}catch(o){if(r.WTF)throw o}try{var s=Sd[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&iu(s)){var n=nl(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(o){if(r.WTF)throw o}}}function NJ(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=LW[s.Pattern]||s.Pattern)}e[t.ID]=t}function kJ(e,t,r,s,n,o,l,u,d,h){var m="General",x=s.StyleID,y={};h=h||{};var b=[],v=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&l&&(x=l.StyleID);o[x]!==void 0&&(o[x].nf&&(m=o[x].nf),o[x].Interior&&b.push(o[x].Interior),!!o[x].Parent);)x=o[x].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=Gr(e);break;case"String":s.t="s",s.r=ZS(xr(e)),s.v=e.indexOf("<")>-1?xr(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(Vr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),s.v!==s.v?s.v=xr(e):s.v<60&&(s.v=s.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=$5[e],h.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=ZS(t||e));break}if(_J(s,m,h),h.cellFormula!==!1)if(s.Formula){var g=xr(s.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),s.f=zc(g,n),delete s.Formula,s.ArrayRange=="RC"?s.F=zc("RC:RC",n):s.ArrayRange&&(s.F=zc(s.ArrayRange,n),d.push([gr(s.F),s.F]))}else for(v=0;v<d.length;++v)n.r>=d[v][0].s.r&&n.r<=d[v][0].e.r&&n.c>=d[v][0].s.c&&n.c<=d[v][0].e.c&&(s.F=d[v][1]);h.cellStyles&&(b.forEach(function(_){!y.patternType&&_.patternType&&(y.patternType=_.patternType)}),s.s=y),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function SJ(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function uy(e,t){var r=t||{};ou();var s=fd(Kv(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=Pr(s));var n=s.slice(0,1024).toLowerCase(),o=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=Kr(r);return l.type="string",Qc.to_workbook(s,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(R){n.indexOf("<"+R)>=0&&(o=!0)}),o)return uZ(s,r);Sd={"General Number":"General","General Date":Wt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Wt[15],"Short Date":Wt[14],"Long Time":Wt[19],"Medium Time":Wt[18],"Short Time":Wt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Wt[2],Standard:Wt[4],Percent:Wt[10],Scientific:Wt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,d=[],h,m={},x=[],y=r.dense?[]:{},b="",v={},g={},_=bn('<Data ss:Type="String">'),w=0,S=0,N=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},F={},O="",B=0,L=[],H={},ue={},A=0,Y=[],I=[],ae={},Q=[],re,ve=!1,te=[],ke=[],Z={},M=0,J=0,V={Sheets:[],WBProps:{date1904:!1}},X={};Wd.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";u=Wd.exec(s);)switch(u[3]=(se=u[3]).toLowerCase()){case"data":if(se=="data"){if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break}if(d[d.length-1][1])break;u[1]==="/"?kJ(s.slice(w,u.index),O,_,d[d.length-1][0]=="comment"?ae:v,{c:S,r:N},C,Q[S],g,te,r):(O="",_=bn(u[0]),w=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(I.length>0&&(v.c=I),(!r.sheetRows||r.sheetRows>N)&&v.v!==void 0&&(r.dense?(y[N]||(y[N]=[]),y[N][S]=v):y[es(S)+xs(N)]=v),v.HRef&&(v.l={Target:xr(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(M=S+(parseInt(v.MergeAcross,10)|0),J=N+(parseInt(v.MergeDown,10)|0),L.push({s:{c:S,r:N},e:{c:M,r:J}})),!r.sheetStubs)v.MergeAcross?S=M+1:++S;else if(v.MergeAcross||v.MergeDown){for(var P=S;P<=M;++P)for(var U=N;U<=J;++U)(P>S||U>N)&&(r.dense?(y[U]||(y[U]=[]),y[U][P]={t:"z"}):y[es(P)+xs(U)]={t:"z"});S=M+1}else++S;else v=vJ(u[0]),v.Index&&(S=+v.Index-1),S<E.s.c&&(E.s.c=S),S>E.e.c&&(E.e.c=S),u[0].slice(-2)==="/>"&&++S,I=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(N<E.s.r&&(E.s.r=N),N>E.e.r&&(E.e.r=N),u[0].slice(-2)==="/>"&&(g=bn(u[0]),g.Index&&(N=+g.Index-1)),S=0,++N):(g=bn(u[0]),g.Index&&(N=+g.Index-1),Z={},(g.AutoFitHeight=="0"||g.Height)&&(Z.hpx=parseInt(g.Height,10),Z.hpt=Yd(Z.hpx),ke[N]=Z),g.Hidden=="1"&&(Z.hidden=!0,ke[N]=Z));break;case"worksheet":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));x.push(b),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(y["!ref"]=Zt(E),r.sheetRows&&r.sheetRows<=E.e.r&&(y["!fullref"]=y["!ref"],E.e.r=r.sheetRows-1,y["!ref"]=Zt(E))),L.length&&(y["!merges"]=L),Q.length>0&&(y["!cols"]=Q),ke.length>0&&(y["!rows"]=ke),m[b]=y}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=S=0,d.push([u[3],!1]),h=bn(u[0]),b=xr(h.Name),y=r.dense?[]:{},L=[],te=[],ke=[],X={name:b,Hidden:0},V.Sheets.push(X);break;case"table":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else{if(u[0].slice(-2)=="/>")break;d.push([u[3],!1]),Q=[],ve=!1}break;case"style":u[1]==="/"?NJ(C,F,r):F=bn(u[0]);break;case"numberformat":F.nf=xr(bn(u[0]).Format||"General"),Sd[F.nf]&&(F.nf=Sd[F.nf]);for(var ce=0;ce!=392&&Wt[ce]!=F.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(Wt[ce]==null){_i(F.nf,ce);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(re=bn(u[0]),re.Hidden&&(re.hidden=!0,delete re.Hidden),re.Width&&(re.wpx=parseInt(re.Width,10)),!ve&&re.wpx>10){ve=!0,aa=_T;for(var ne=0;ne<Q.length;++ne)Q[ne]&&xo(Q[ne])}ve&&xo(re),Q[re.Index-1||Q.length]=re;for(var ie=0;ie<+re.Span;++ie)Q[Q.length]=Kr(re);break;case"namedrange":if(u[1]==="/")break;V.Names||(V.Names=[]);var W=Kt(u[0]),G={Name:W.Name,Ref:zc(W.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(G.Sheet=V.Sheets.length-1),V.Names.push(G);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?O+=s.slice(B,u.index):B=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;F.Interior=bn(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?X$(H,se,s.slice(A,u.index)):A=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else d.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));SJ(ae),I.push(ae)}else d.push([u[3],!1]),h=bn(u[0]),ae={a:h.Author};break;case"autofilter":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var k=bn(u[0]);y["!autofilter"]={ref:zc(k.Range).replace(/\$/g,"")},d.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"null":break;default:if(d.length==0&&u[3]=="document"||d.length==0&&u[3]=="uof")return U3(s,r);var de=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:de=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:de=!1}break;case"excelworkbook":switch(u[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:de=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:de=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(s.slice(A,u.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else A=u.index+u[0].length;break;case"header":y["!margins"]||dl(y["!margins"]={},"xlml"),isNaN(+Kt(u[0]).Margin)||(y["!margins"].header=+Kt(u[0]).Margin);break;case"footer":y["!margins"]||dl(y["!margins"]={},"xlml"),isNaN(+Kt(u[0]).Margin)||(y["!margins"].footer=+Kt(u[0]).Margin);break;case"pagemargins":var z=Kt(u[0]);y["!margins"]||dl(y["!margins"]={},"xlml"),isNaN(+z.Top)||(y["!margins"].top=+z.Top),isNaN(+z.Left)||(y["!margins"].left=+z.Left),isNaN(+z.Right)||(y["!margins"].right=+z.Right),isNaN(+z.Bottom)||(y["!margins"].bottom=+z.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:de=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:de=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:de=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:de=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:de=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:de=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:de=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:de=!1}break;case"smarttags":break;default:de=!1;break}if(de||u[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?wJ(ue,se,Y,s.slice(A,u.index)):(Y=u,A=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+d.join("|")}var T={};return!r.bookSheets&&!r.bookProps&&(T.Sheets=m),T.SheetNames=x,T.Workbook=V,T.SSF=Kr(Wt),T.Props=H,T.Custprops=ue,T}function ev(e,t){switch(yb(t=t||{}),t.type||"base64"){case"base64":return uy(Ha(e),t);case"binary":case"buffer":case"file":return uy(e,t);case"array":return uy(_o(e),t)}}function EJ(e,t){var r=[];return e.Props&&r.push(Y$(e.Props,t)),e.Custprops&&r.push(J$(e.Props,e.Custprops)),r.join("")}function jJ(){return""}function TJ(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,n){var o=[];o.push(kt("NumberFormat",null,{"ss:Format":Dr(Wt[s.numFmtId])}));var l={"ss:ID":"s"+(21+n)};r.push(kt("Style",o.join(""),l))}),kt("Styles",r.join(""))}function XT(e){return kt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+fb(e.Ref,{r:0,c:0})})}function AJ(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var n=t[s];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(XT(n)))}return kt("Names",r.join(""))}function CJ(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,o=[],l=0;l<n.length;++l){var u=n[l];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||o.push(XT(u)))}return o.join("")}function RJ(e,t,r,s){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(kt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(kt("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(kt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)n.push(kt("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<r&&!(s.Workbook.Sheets[o]&&!s.Workbook.Sheets[o].Hidden);++o);o==r&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Ys("ProtectContents","True")),e["!protect"].objects&&n.push(Ys("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Ys("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(Ys("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(Ys("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":kt("WorksheetOptions",n.join(""),{xmlns:Ma.x})}function DJ(e){return e.map(function(t){var r=Qz(t.t||""),s=kt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return kt("Comment",s,{"ss:Author":t.a})}).join("")}function OJ(e,t,r,s,n,o,l){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+Dr(fb(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var d=ts(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(d.r==l.r?"":"["+(d.r-l.r)+"]")+"C"+(d.c==l.c?"":"["+(d.c-l.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=Dr(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=Dr(e.l.Tooltip))),r["!merges"])for(var h=r["!merges"],m=0;m!=h.length;++m)h[m].s.c!=l.c||h[m].s.r!=l.r||(h[m].e.c>h[m].s.c&&(u["ss:MergeAcross"]=h[m].e.c-h[m].s.c),h[m].e.r>h[m].s.r&&(u["ss:MergeDown"]=h[m].e.r-h[m].s.r));var x="",y="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":x="Number",y=String(e.v);break;case"b":x="Boolean",y=e.v?"1":"0";break;case"e":x="Error",y=Li[e.v];break;case"d":x="DateTime",y=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Wt[14]);break;case"s":x="String",y=Zz(e.v||"");break}var b=ko(s.cellXfs,e,s);u["ss:StyleID"]="s"+(21+b),u["ss:Index"]=l.c+1;var v=e.v!=null?y:"",g=e.t=="z"?"":'<Data ss:Type="'+x+'">'+v+"</Data>";return(e.c||[]).length>0&&(g+=DJ(e.c)),kt("Cell",g,u)}function FJ(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=eu(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function LJ(e,t,r,s){if(!e["!ref"])return"";var n=gr(e["!ref"]),o=e["!merges"]||[],l=0,u=[];e["!cols"]&&e["!cols"].forEach(function(_,w){xo(_);var S=!!_.width,N=jm(w,_),E={"ss:Index":w+1};S&&(E["ss:Width"]=Kd(N.width)),_.hidden&&(E["ss:Hidden"]="1"),u.push(kt("Column",null,E))});for(var d=Array.isArray(e),h=n.s.r;h<=n.e.r;++h){for(var m=[FJ(h,(e["!rows"]||[])[h])],x=n.s.c;x<=n.e.c;++x){var y=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>x)&&!(o[l].s.r>h)&&!(o[l].e.c<x)&&!(o[l].e.r<h)){(o[l].s.c!=x||o[l].s.r!=h)&&(y=!0);break}if(!y){var b={r:h,c:x},v=Gt(b),g=d?(e[h]||[])[x]:e[v];m.push(OJ(g,v,e,t,r,s,b))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function IJ(e,t,r){var s=[],n=r.SheetNames[e],o=r.Sheets[n],l=o?CJ(o,t,e,r):"";return l.length>0&&s.push("<Names>"+l+"</Names>"),l=o?LJ(o,t,e,r):"",l.length>0&&s.push("<Table>"+l+"</Table>"),s.push(RJ(o,t,e,r)),s.join("")}function MJ(e,t){t||(t={}),e.SSF||(e.SSF=Kr(Wt)),e.SSF&&(ou(),bm(e.SSF),t.revssf=_m(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ko(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(EJ(e,t)),r.push(jJ()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(kt("Worksheet",IJ(s,t,e),{"ss:Name":Dr(e.SheetNames[s])}));return r[2]=TJ(e,t),r[3]=AJ(e),ys+kt("Workbook",r.join(""),{xmlns:Ma.ss,"xmlns:o":Ma.o,"xmlns:x":Ma.x,"xmlns:ss":Ma.ss,"xmlns:dt":Ma.dt,"xmlns:html":Ma.html})}function BJ(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=A$(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=C$(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var PJ=[60,1084,2066,2165,2175];function UJ(e,t,r,s,n){var o=s,l=[],u=r.slice(r.l,r.l+o);if(n&&n.enc&&n.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(u)}l.push(u),r.l+=o;for(var d=vi(r,r.l),h=tv[d],m=0;h!=null&&PJ.indexOf(d)>-1;)o=vi(r,r.l+2),m=r.l+4,d==2066?m+=4:(d==2165||d==2175)&&(m+=12),u=r.slice(m,r.l+4+o),l.push(u),r.l+=4+o,h=tv[d=vi(r,r.l)];var x=Is(l);Ks(x,0);var y=0;x.lens=[];for(var b=0;b<l.length;++b)x.lens.push(y),y+=l[b].length;if(x.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+s;return t.f(x,x.length,n)}function In(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Wt[s])}catch(o){if(t.WTF)throw o}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Li[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=$d(e.v):e.w=pl(e.v):e.w=mn(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(o){if(t.WTF)throw o}if(t.cellDates&&s&&e.t=="n"&&iu(Wt[s]||String(s))){var n=nl(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function o0(e,t,r){return{v:e,ixfe:t,t:r}}function zJ(e,t){var r={opts:{}},s={},n=t.dense?[]:{},o={},l={},u=null,d=[],h="",m={},x,y="",b,v,g,_,w={},S=[],N,E,C=[],F=[],O={Sheets:[],WBProps:{date1904:!1},Views:[{}]},B={},L=function(De){return De<8?ll[De]:De<64&&F[De-8]||ll[De]},H=function(De,ft,jt){var vt=ft.XF.data;if(!(!vt||!vt.patternType||!jt||!jt.cellStyles)){ft.s={},ft.s.patternType=vt.patternType;var At;(At=Vd(L(vt.icvFore)))&&(ft.s.fgColor={rgb:At}),(At=Vd(L(vt.icvBack)))&&(ft.s.bgColor={rgb:At})}},ue=function(De,ft,jt){if(!(Z>1)&&!(jt.sheetRows&&De.r>=jt.sheetRows)){if(jt.cellStyles&&ft.XF&&ft.XF.data&&H(De,ft,jt),delete ft.ixfe,delete ft.XF,x=De,y=Gt(De),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),De.r<l.s.r&&(l.s.r=De.r),De.c<l.s.c&&(l.s.c=De.c),De.r+1>l.e.r&&(l.e.r=De.r+1),De.c+1>l.e.c&&(l.e.c=De.c+1),jt.cellFormula&&ft.f){for(var vt=0;vt<S.length;++vt)if(!(S[vt][0].s.c>De.c||S[vt][0].s.r>De.r)&&!(S[vt][0].e.c<De.c||S[vt][0].e.r<De.r)){ft.F=Zt(S[vt][0]),(S[vt][0].s.c!=De.c||S[vt][0].s.r!=De.r)&&delete ft.f,ft.f&&(ft.f=""+sa(S[vt][1],l,De,te,A));break}}jt.dense?(n[De.r]||(n[De.r]=[]),n[De.r][De.c]=ft):n[y]=ft}},A={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var Y,I=[],ae=[],Q=[],re=[],ve=!1,te=[];te.SheetNames=A.snames,te.sharedf=A.sharedf,te.arrayf=A.arrayf,te.names=[],te.XTI=[];var ke=0,Z=0,M=0,J=[],V=[],X;A.codepage=1200,En(1200);for(var se=!1;e.l<e.length-1;){var P=e.l,U=e.read_shift(2);if(U===0&&ke===10)break;var ce=e.l===e.length?0:e.read_shift(2),ne=tv[U];if(ne&&ne.f){if(t.bookSheets&&ke===133&&U!==133)break;if(ke=U,ne.r===2||ne.r==12){var ie=e.read_shift(2);if(ce-=2,!A.enc&&ie!==U&&((ie&255)<<8|ie>>8)!==U)throw new Error("rt mismatch: "+ie+"!="+U);ne.r==12&&(e.l+=10,ce-=10)}var W={};if(U===10?W=ne.f(e,ce,A):W=UJ(U,ne,e,ce,A),Z==0&&[9,521,1033,2057].indexOf(ke)===-1)continue;switch(U){case 34:r.opts.Date1904=O.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=W,!t.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=W;break;case 66:var G=Number(W);switch(G){case 21010:G=1200;break;case 32768:G=1e4;break;case 32769:G=1252;break}En(A.codepage=G),se=!0;break;case 317:A.rrtabid=W;break;case 25:A.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:A.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(n["!type"]="dialog"),W.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),W.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:C.push(W);break;case 430:te.push([W]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(W);break;case 24:case 536:X={Name:W.Name,Ref:sa(W.rgce,l,null,te,A)},W.itab>0&&(X.Sheet=W.itab-1),te.names.push(X),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(V[W.itab-1]={ref:Zt(W.rgce[0][0][1][2])});break;case 22:A.ExternCount=W;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(W),te.XTI=te.XTI.concat(W);break;case 2196:if(A.biff<8)break;X!=null&&(X.Comment=W[1]);break;case 18:n["!protect"]=W;break;case 19:W!==0&&A.WTF&&console.error("Password verifier: "+W);break;case 133:o[W.pos]=W,A.snames.push(W.name);break;case 10:{if(--Z)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=Zt(l),t.sheetRows&&t.sheetRows<=l.e.r){var k=l.e.r;l.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Zt(l),l.e.r=k}l.e.r++,l.e.c++}I.length>0&&(n["!merges"]=I),ae.length>0&&(n["!objects"]=ae),Q.length>0&&(n["!cols"]=Q),re.length>0&&(n["!rows"]=re),O.Sheets.push(B)}h===""?m=n:s[h]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[U]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),A.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(A.biff=5,se=!0,En(A.codepage=28591)),A.biff==8&&W.BIFFVer==0&&W.dt==16&&(A.biff=2),Z++)break;if(n=t.dense?[]:{},A.biff<8&&!se&&(se=!0,En(A.codepage=t.codepage||1252)),A.biff<5||W.BIFFVer==0&&W.dt==4096){h===""&&(h="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var de={pos:e.l-ce,name:h};o[de.pos]=de,A.snames.push(h)}else h=(o[P]||{name:""}).name;W.dt==32&&(n["!type"]="chart"),W.dt==64&&(n["!type"]="macro"),I=[],ae=[],A.arrayf=S=[],Q=[],re=[],ve=!1,B={Hidden:(o[P]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[W.r]||[])[W.c]:n[Gt({c:W.c,r:W.r})])&&++W.c,N={ixfe:W.ixfe,XF:C[W.ixfe]||{},v:W.val,t:"n"},M>0&&(N.z=J[N.ixfe>>8&63]),In(N,t,r.opts.Date1904),ue({c:W.c,r:W.r},N,t);break;case 5:case 517:N={ixfe:W.ixfe,XF:C[W.ixfe],v:W.val,t:W.t},M>0&&(N.z=J[N.ixfe>>8&63]),In(N,t,r.opts.Date1904),ue({c:W.c,r:W.r},N,t);break;case 638:N={ixfe:W.ixfe,XF:C[W.ixfe],v:W.rknum,t:"n"},M>0&&(N.z=J[N.ixfe>>8&63]),In(N,t,r.opts.Date1904),ue({c:W.c,r:W.r},N,t);break;case 189:for(var z=W.c;z<=W.C;++z){var T=W.rkrec[z-W.c][0];N={ixfe:T,XF:C[T],v:W.rkrec[z-W.c][1],t:"n"},M>0&&(N.z=J[N.ixfe>>8&63]),In(N,t,r.opts.Date1904),ue({c:z,r:W.r},N,t)}break;case 6:case 518:case 1030:{if(W.val=="String"){u=W;break}if(N=o0(W.val,W.cell.ixfe,W.tt),N.XF=C[N.ixfe],t.cellFormula){var R=W.formula;if(R&&R[0]&&R[0][0]&&R[0][0][0]=="PtgExp"){var q=R[0][0][1][0],me=R[0][0][1][1],_e=Gt({r:q,c:me});w[_e]?N.f=""+sa(W.formula,l,W.cell,te,A):N.F=((t.dense?(n[q]||[])[me]:n[_e])||{}).F}else N.f=""+sa(W.formula,l,W.cell,te,A)}M>0&&(N.z=J[N.ixfe>>8&63]),In(N,t,r.opts.Date1904),ue(W.cell,N,t),u=W}break;case 7:case 519:if(u)u.val=W,N=o0(W,u.cell.ixfe,"s"),N.XF=C[N.ixfe],t.cellFormula&&(N.f=""+sa(u.formula,l,u.cell,te,A)),M>0&&(N.z=J[N.ixfe>>8&63]),In(N,t,r.opts.Date1904),ue(u.cell,N,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(W);var le=Gt(W[0].s);if(b=t.dense?(n[W[0].s.r]||[])[W[0].s.c]:n[le],t.cellFormula&&b){if(!u||!le||!b)break;b.f=""+sa(W[1],l,W[0],te,A),b.F=Zt(W[0])}}break;case 1212:{if(!t.cellFormula)break;if(y){if(!u)break;w[Gt(u.cell)]=W[0],b=t.dense?(n[u.cell.r]||[])[u.cell.c]:n[Gt(u.cell)],(b||{}).f=""+sa(W[0],l,x,te,A)}}break;case 253:N=o0(d[W.isst].t,W.ixfe,"s"),d[W.isst].h&&(N.h=d[W.isst].h),N.XF=C[N.ixfe],M>0&&(N.z=J[N.ixfe>>8&63]),In(N,t,r.opts.Date1904),ue({c:W.c,r:W.r},N,t);break;case 513:t.sheetStubs&&(N={ixfe:W.ixfe,XF:C[W.ixfe],t:"z"},M>0&&(N.z=J[N.ixfe>>8&63]),In(N,t,r.opts.Date1904),ue({c:W.c,r:W.r},N,t));break;case 190:if(t.sheetStubs)for(var Ae=W.c;Ae<=W.C;++Ae){var Me=W.ixfe[Ae-W.c];N={ixfe:Me,XF:C[Me],t:"z"},M>0&&(N.z=J[N.ixfe>>8&63]),In(N,t,r.opts.Date1904),ue({c:Ae,r:W.r},N,t)}break;case 214:case 516:case 4:N=o0(W.val,W.ixfe,"s"),N.XF=C[N.ixfe],M>0&&(N.z=J[N.ixfe>>8&63]),In(N,t,r.opts.Date1904),ue({c:W.c,r:W.r},N,t);break;case 0:case 512:Z===1&&(l=W);break;case 252:d=W;break;case 1054:if(A.biff==4){J[M++]=W[1];for(var Ee=0;Ee<M+163&&Wt[Ee]!=W[1];++Ee);Ee>=163&&_i(W[1],M+163)}else _i(W[1],W[0]);break;case 30:{J[M++]=W;for(var Ce=0;Ce<M+163&&Wt[Ce]!=W;++Ce);Ce>=163&&_i(W,M+163)}break;case 229:I=I.concat(W);break;case 93:ae[W.cmo[0]]=A.lastobj=W;break;case 438:A.lastobj.TxO=W;break;case 127:A.lastobj.ImData=W;break;case 440:for(_=W[0].s.r;_<=W[0].e.r;++_)for(g=W[0].s.c;g<=W[0].e.c;++g)b=t.dense?(n[_]||[])[g]:n[Gt({c:g,r:_})],b&&(b.l=W[1]);break;case 2048:for(_=W[0].s.r;_<=W[0].e.r;++_)for(g=W[0].s.c;g<=W[0].e.c;++g)b=t.dense?(n[_]||[])[g]:n[Gt({c:g,r:_})],b&&b.l&&(b.l.Tooltip=W[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;b=t.dense?(n[W[0].r]||[])[W[0].c]:n[Gt(W[0])];var Je=ae[W[2]];b||(t.dense?(n[W[0].r]||(n[W[0].r]=[]),b=n[W[0].r][W[0].c]={t:"z"}):b=n[Gt(W[0])]={t:"z"},l.e.r=Math.max(l.e.r,W[0].r),l.s.r=Math.min(l.s.r,W[0].r),l.e.c=Math.max(l.e.c,W[0].c),l.s.c=Math.min(l.s.c,W[0].c)),b.c||(b.c=[]),v={a:W[1],t:Je.TxO.t},b.c.push(v)}break;case 2173:TG(C[W.ixfe],W.ext);break;case 125:{if(!A.cellStyles)break;for(;W.e>=W.s;)Q[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},ve||(ve=!0,cb(W.w/256)),xo(Q[W.e+1])}break;case 520:{var $e={};W.level!=null&&(re[W.r]=$e,$e.level=W.level),W.hidden&&(re[W.r]=$e,$e.hidden=!0),W.hpt&&(re[W.r]=$e,$e.hpt=W.hpt,$e.hpx=eu(W.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||dl(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[U]]=W;break;case 161:n["!margins"]||dl(n["!margins"]={}),n["!margins"].header=W.header,n["!margins"].footer=W.footer;break;case 574:W.RTL&&(O.Views[0].RTL=!0);break;case 146:F=W;break;case 2198:Y=W;break;case 140:E=W;break;case 442:h?B.CodeName=W||B.name:O.WBProps.CodeName=W||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+U.toString(16)),e.l+=ce}return r.SheetNames=cs(o).sort(function(tt,De){return Number(tt)-Number(De)}).map(function(tt){return o[tt].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&V.forEach(function(tt,De){r.Sheets[r.SheetNames[De]]["!autofilter"]=tt}),r.Strings=d,r.SSF=Kr(Wt),A.enc&&(r.Encryption=A.enc),Y&&(r.Themes=Y),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),te.names.length>0&&(O.Names=te.names),r.Workbook=O,r}var Ed={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $J(e,t,r){var s=Pt.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var n=x3(s,Ky,Ed.DSI);for(var o in n)t[o]=n[o]}catch(h){if(r.WTF)throw h}var l=Pt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var u=x3(l,Xy,Ed.SI);for(var d in u)t[d]==null&&(t[d]=u[d])}catch(h){if(r.WTF)throw h}t.HeadingPairs&&t.TitlesOfParts&&(K5(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function qJ(e,t){var r=[],s=[],n=[],o=0,l,u=GS(Ky,"n"),d=GS(Xy,"n");if(e.Props)for(l=cs(e.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(d,l[o])?s:n).push([l[o],e.Props[l[o]]]);if(e.Custprops)for(l=cs(e.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(d,l[o])?s:n).push([l[o],e.Custprops[l[o]]]);var h=[];for(o=0;o<n.length;++o)tT.indexOf(n[o][0])>-1||V5.indexOf(n[o][0])>-1||n[o][1]!=null&&h.push(n[o]);s.length&&Pt.utils.cfb_add(t,"/SummaryInformation",g3(s,Ed.SI,d,Xy)),(r.length||h.length)&&Pt.utils.cfb_add(t,"/DocumentSummaryInformation",g3(r,Ed.DSI,u,Ky,h.length?h:null,Ed.UDI))}function YT(e,t){t||(t={}),yb(t),Pv(),t.codepage&&Bv(t.codepage);var r,s;if(e.FullPaths){if(Pt.find(e,"/encryption"))throw new Error("File is password-protected");r=Pt.find(e,"!CompObj"),s=Pt.find(e,"/Workbook")||Pt.find(e,"/Book")}else{switch(t.type){case"base64":e=za(Ha(e));break;case"binary":e=za(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ks(e,0),s={content:e}}var n,o;if(r&&BJ(r),t.bookProps&&!t.bookSheets)n={};else{var l=ar?"buffer":"array";if(s&&s.content)n=zJ(s.content,t);else if((o=Pt.find(e,"PerfectOffice_MAIN"))&&o.content)n=ul.to_workbook(o.content,(t.type=l,t));else if((o=Pt.find(e,"NativeContent_MAIN"))&&o.content)n=ul.to_workbook(o.content,(t.type=l,t));else throw(o=Pt.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Pt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=rV(e))}var u={};return e.FullPaths&&$J(e,u,t),n.Props=n.Custprops=u,t.bookFiles&&(n.cfb=e),n}function HJ(e,t){var r=t||{},s=Pt.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Pt.utils.cfb_add(s,n,JT(e,r)),r.biff==8&&(e.Props||e.Custprops)&&qJ(e,s),r.biff==8&&e.vbaraw&&sV(s,Pt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var Jd={0:{f:mX},1:{f:_X},2:{f:zX},3:{f:CX},4:{f:EX},5:{f:BX},6:{f:GX},7:{f:FX},8:{f:QX},9:{f:ZX},10:{f:YX},11:{f:JX},12:{f:kX},13:{f:qX},14:{f:DX},15:{f:TX},16:{f:$T},17:{f:KX},18:{f:IX},19:{f:Qv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:KY},40:{},42:{},43:{f:GW},44:{f:HW},45:{f:XW},46:{f:JW},47:{f:YW},48:{},49:{f:g$},50:{},51:{f:RG},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:fT},62:{f:WX},63:{f:UG},64:{f:pY},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ca,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:dY},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:bX},148:{f:gX,p:16},151:{f:nY},152:{},153:{f:WY},154:{},155:{},156:{f:qY},157:{},158:{},159:{T:1,f:oW},160:{T:-1},161:{T:1,f:Rl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:eY},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:AG},336:{T:-1},337:{f:FG,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Vy},357:{},358:{},359:{},360:{T:1},361:{},362:{f:dT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:iY},427:{f:oY},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:cY},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:vX},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:sY},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Vy},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:JG},633:{T:1},634:{T:-1},635:{T:1,f:XG},636:{T:-1},637:{f:w$},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:DY},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xY},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},tv={6:{f:ly},10:{f:oo},12:{f:Ss},13:{f:Ss},14:{f:ps},15:{f:ps},16:{f:na},17:{f:ps},18:{f:ps},19:{f:Ss},20:{f:N3},21:{f:N3},23:{f:dT},24:{f:S3},25:{f:ps},26:{},27:{},28:{f:xH},29:{},34:{f:ps},35:{f:k3},38:{f:na},39:{f:na},40:{f:na},41:{f:na},42:{f:ps},43:{f:ps},47:{f:TW},49:{f:qq},51:{f:Ss},60:{},61:{f:Bq},64:{f:ps},65:{f:$q},66:{f:Ss},77:{},80:{},81:{},82:{},85:{f:Ss},89:{},90:{},91:{},92:{f:jq},93:{f:vH},94:{},95:{f:ps},96:{},97:{},99:{f:ps},125:{f:fT},128:{f:aH},129:{f:Aq},130:{f:Ss},131:{f:ps},132:{f:ps},133:{f:Cq},134:{},140:{f:jH},141:{f:Ss},144:{},146:{f:CH},151:{},152:{},153:{},154:{},155:{},156:{f:Ss},157:{},158:{},160:{f:MH},161:{f:OH},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:eH},190:{f:tH},193:{f:oo},197:{},198:{},199:{},200:{},201:{},202:{f:ps},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ss},220:{},221:{f:ps},222:{},224:{f:sH},225:{f:Eq},226:{f:oo},227:{},229:{f:gH},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Dq},253:{f:Wq},255:{f:Fq},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:rT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ps},353:{f:oo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:cH},431:{f:ps},432:{},433:{},434:{},437:{},438:{f:_H},439:{f:ps},440:{f:NH},441:{},442:{f:pf},443:{},444:{f:Ss},445:{},446:{},448:{f:oo},449:{f:Mq,r:2},450:{f:oo},512:{f:b3},513:{f:IH},515:{f:oH},516:{f:Vq},517:{f:_3},519:{f:BH},520:{f:Lq},523:{},545:{f:E3},549:{f:v3},566:{},574:{f:Uq},638:{f:Qq},659:{},1048:{},1054:{f:Xq},1084:{},1212:{f:hH},2048:{f:SH},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:a0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:oo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:RH,r:12},2173:{f:jG,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ps,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:fH,r:12},2197:{},2198:{f:wG,r:12},2199:{},2200:{},2201:{},2202:{f:mH,r:12},2203:{f:oo},2204:{},2205:{},2206:{},2207:{},2211:{f:Iq},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ss},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:FH},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:AH},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:b3},1:{},2:{f:qH},3:{f:zH},4:{f:UH},5:{f:_3},7:{f:WH},8:{},9:{f:a0},11:{},22:{f:Ss},30:{f:Jq},31:{},32:{},33:{f:E3},36:{},37:{f:v3},50:{f:GH},62:{},52:{},67:{},68:{f:Ss},69:{},86:{},126:{},127:{f:PH},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:VH},223:{},234:{},354:{},421:{},518:{f:ly},521:{f:a0},536:{f:S3},547:{f:k3},561:{},579:{},1030:{f:ly},1033:{f:a0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function St(e,t,r,s){var n=t;if(!isNaN(n)){var o=s||(r||[]).length||0,l=e.next(4);l.write_shift(2,n),l.write_shift(2,o),o>0&&Yv(r)&&e.push(r)}}function WJ(e,t,r,s){var n=(r||[]).length||0;if(n<=8224)return St(e,t,r,n);var o=t;if(!isNaN(o)){for(var l=r.parts||[],u=0,d=0,h=0;h+(l[u]||8224)<=8224;)h+=l[u]||8224,u++;var m=e.next(4);for(m.write_shift(2,o),m.write_shift(2,h),e.push(r.slice(d,d+h)),d+=h;d<n;){for(m=e.next(4),m.write_shift(2,60),h=0;h+(l[u]||8224)<=8224;)h+=l[u]||8224,u++;m.write_shift(2,h),e.push(r.slice(d,d+h)),d+=h}}}function vf(e,t,r){return e||(e=nt(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function GJ(e,t,r,s){var n=nt(9);return vf(n,e,t),sT(r,s||"b",n),n}function VJ(e,t,r){var s=nt(8+2*r.length);return vf(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function KJ(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Rs(Vr(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?St(e,2,HH(r,s,n)):St(e,3,$H(r,s,n));return;case"b":case"e":St(e,5,GJ(r,s,t.v,t.t));return;case"s":case"str":St(e,4,VJ(r,s,(t.v||"").slice(0,255)));return}St(e,1,vf(null,r,s))}function XJ(e,t,r,s){var n=Array.isArray(t),o=gr(t["!ref"]||"A1"),l,u="",d=[];if(o.e.c>255||o.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=Zt(o)}for(var h=o.s.r;h<=o.e.r;++h){u=xs(h);for(var m=o.s.c;m<=o.e.c;++m){h===o.s.r&&(d[m]=es(m)),l=d[m]+u;var x=n?(t[h]||[])[m]:t[l];x&&KJ(e,x,h,m)}}}function YJ(e,t){for(var r=t||{},s=ja(),n=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==r.sheet&&(n=o);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return St(s,r.biff==4?1033:r.biff==3?521:9,ib(e,16,r)),XJ(s,e.Sheets[e.SheetNames[n]],n,r),St(s,10),s.end()}function JJ(e,t,r){St(e,49,Hq({sz:12,name:"Arial"},r))}function ZJ(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&St(e,1054,Yq(n,t[n],r))})}function QJ(e,t){var r=nt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),St(e,2151,r),r=nt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),lT(gr(t["!ref"]||"A1"),r),r.write_shift(4,4),St(e,2152,r)}function eZ(e,t){for(var r=0;r<16;++r)St(e,224,w3({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){St(e,224,w3(s,0,t))})}function tZ(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];St(e,440,kH(s)),s[1].Tooltip&&St(e,2048,EH(s))}delete t["!links"]}function rZ(e,t){if(t){var r=0;t.forEach(function(s,n){++r<=256&&s&&St(e,125,DH(jm(n,s),n))})}}function sZ(e,t,r,s,n){var o=16+ko(n.cellXfs,t,n);if(t.v==null&&!t.bf){St(e,513,vl(r,s,o));return}if(t.bf)St(e,6,AK(t,r,s,n,o));else switch(t.t){case"d":case"n":var l=t.t=="d"?Rs(Vr(t.v)):t.v;St(e,515,lH(r,s,l,o));break;case"b":case"e":St(e,517,iH(r,s,t.v,o,n,t.t));break;case"s":case"str":if(n.bookSST){var u=mb(n.Strings,t.v,n.revStrings);St(e,253,Gq(r,s,u,o))}else St(e,516,Kq(r,s,(t.v||"").slice(0,255),o,n));break;default:St(e,513,vl(r,s,o))}}function aZ(e,t,r){var s=ja(),n=r.SheetNames[e],o=r.Sheets[n]||{},l=(r||{}).Workbook||{},u=(l.Sheets||[])[e]||{},d=Array.isArray(o),h=t.biff==8,m,x="",y=[],b=gr(o["!ref"]||"A1"),v=h?65536:16384;if(b.e.c>255||b.e.r>=v){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");b.e.c=Math.min(b.e.c,255),b.e.r=Math.min(b.e.c,v-1)}St(s,2057,ib(r,16,t)),St(s,13,dn(1)),St(s,12,dn(100)),St(s,15,ha(!0)),St(s,17,ha(!1)),St(s,16,gl(.001)),St(s,95,ha(!0)),St(s,42,ha(!1)),St(s,43,ha(!1)),St(s,130,dn(1)),St(s,128,nH()),St(s,131,ha(!1)),St(s,132,ha(!1)),h&&rZ(s,o["!cols"]),St(s,512,Zq(b,t)),h&&(o["!links"]=[]);for(var g=b.s.r;g<=b.e.r;++g){x=xs(g);for(var _=b.s.c;_<=b.e.c;++_){g===b.s.r&&(y[_]=es(_)),m=y[_]+x;var w=d?(o[g]||[])[_]:o[m];w&&(sZ(s,w,g,_,t),h&&w.l&&o["!links"].push([m,w.l]))}}var S=u.CodeName||u.name||n;return h&&St(s,574,zq((l.Views||[])[0])),h&&(o["!merges"]||[]).length&&St(s,229,yH(o["!merges"])),h&&tZ(s,o),St(s,442,aT(S)),h&&QJ(s,o),St(s,10),s.end()}function nZ(e,t,r){var s=ja(),n=(e||{}).Workbook||{},o=n.Sheets||[],l=n.WBProps||{},u=r.biff==8,d=r.biff==5;if(St(s,2057,ib(e,5,r)),r.bookType=="xla"&&St(s,135),St(s,225,u?dn(1200):null),St(s,193,iq(2)),d&&St(s,191),d&&St(s,192),St(s,226),St(s,92,Tq("SheetJS",r)),St(s,66,dn(u?1200:1252)),u&&St(s,353,dn(0)),u&&St(s,448),St(s,317,LH(e.SheetNames.length)),u&&e.vbaraw&&St(s,211),u&&e.vbaraw){var h=l.CodeName||"ThisWorkbook";St(s,442,aT(h))}St(s,156,dn(17)),St(s,25,ha(!1)),St(s,18,ha(!1)),St(s,19,dn(0)),u&&St(s,431,ha(!1)),u&&St(s,444,dn(0)),St(s,61,Pq()),St(s,64,ha(!1)),St(s,141,dn(0)),St(s,34,ha(MY(e)=="true")),St(s,14,ha(!0)),u&&St(s,439,ha(!1)),St(s,218,dn(0)),JJ(s,e,r),ZJ(s,e.SSF,r),eZ(s,r),u&&St(s,352,ha(!1));var m=s.end(),x=ja();u&&St(x,140,TH()),u&&r.Strings&&WJ(x,252,Oq(r.Strings)),St(x,10);var y=x.end(),b=ja(),v=0,g=0;for(g=0;g<e.SheetNames.length;++g)v+=(u?12:11)+(u?2:1)*e.SheetNames[g].length;var _=m.length+v+y.length;for(g=0;g<e.SheetNames.length;++g){var w=o[g]||{};St(b,133,Rq({pos:_,hs:w.Hidden||0,dt:0,name:e.SheetNames[g]},r)),_+=t[g].length}var S=b.end();if(v!=S.length)throw new Error("BS8 "+v+" != "+S.length);var N=[];return m.length&&N.push(m),S.length&&N.push(S),y.length&&N.push(y),Is(N)}function iZ(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=Kr(Wt)),e&&e.SSF&&(ou(),bm(e.SSF),r.revssf=_m(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,vb(r),r.cellXfs=[],ko(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)s[s.length]=aZ(n,r,e);return s.unshift(nZ(e,s,r)),Is(s)}function JT(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var n=Ta(s["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var o=t||{};switch(o.biff||2){case 8:case 5:return iZ(e,t);case 4:case 3:case 2:return YJ(e,t)}throw new Error("invalid type "+o.bookType+" for BIFF")}function I3(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=n.index,u=o&&o.index||e.length,d=Hz(e.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,m=0,x=0,y=0,b={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(l=0;l<d.length;++l){var g=d[l].trim(),_=g.slice(0,3).toLowerCase();if(_=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}m=0;continue}if(!(_!="<td"&&_!="<th")){var w=g.split(/<\/t[dh]>/i);for(u=0;u<w.length;++u){var S=w[u].trim();if(S.match(/<t[dh]/i)){for(var N=S,E=0;N.charAt(0)=="<"&&(E=N.indexOf(">"))>-1;)N=N.slice(E+1);for(var C=0;C<v.length;++C){var F=v[C];F.s.c==m&&F.s.r<h&&h<=F.e.r&&(m=F.e.c+1,C=-1)}var O=Kt(S.slice(0,S.indexOf(">")));y=O.colspan?+O.colspan:1,((x=+O.rowspan)>1||y>1)&&v.push({s:{r:h,c:m},e:{r:h+(x||1)-1,c:m+y-1}});var B=O.t||O["data-t"]||"";if(!N.length){m+=y;continue}if(N=w5(N),b.s.r>h&&(b.s.r=h),b.e.r<h&&(b.e.r=h),b.s.c>m&&(b.s.c=m),b.e.c<m&&(b.e.c=m),!N.length){m+=y;continue}var L={t:"s",v:N};r.raw||!N.trim().length||B=="s"||(N==="TRUE"?L={t:"b",v:!0}:N==="FALSE"?L={t:"b",v:!1}:isNaN(Tn(N))?isNaN(Zc(N).getDate())||(L={t:"d",v:Vr(N)},r.cellDates||(L={t:"n",v:Rs(L.v)}),L.z=r.dateNF||Wt[14]):L={t:"n",v:Tn(N)}),r.dense?(s[h]||(s[h]=[]),s[h][m]=L):s[Gt({r:h,c:m})]=L,m+=y}}}}return s["!ref"]=Zt(b),v.length&&(s["!merges"]=v),s}function oZ(e,t,r,s){for(var n=e["!merges"]||[],o=[],l=t.s.c;l<=t.e.c;++l){for(var u=0,d=0,h=0;h<n.length;++h)if(!(n[h].s.r>r||n[h].s.c>l)&&!(n[h].e.r<r||n[h].e.c<l)){if(n[h].s.r<r||n[h].s.c<l){u=-1;break}u=n[h].e.r-n[h].s.r+1,d=n[h].e.c-n[h].s.c+1;break}if(!(u<0)){var m=Gt({r,c:l}),x=s.dense?(e[r]||[])[l]:e[m],y=x&&x.v!=null&&(x.h||Vv(x.w||(ji(x),x.w)||""))||"",b={};u>1&&(b.rowspan=u),d>1&&(b.colspan=d),s.editable?y='<span contenteditable="true">'+y+"</span>":x&&(b["data-t"]=x&&x.t||"z",x.v!=null&&(b["data-v"]=x.v),x.z!=null&&(b["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+x.l.Target+'">'+y+"</a>")),b.id=(s.id||"sjs")+"-"+m,o.push(kt("td",y,b))}}var v="<tr>";return v+o.join("")+"</tr>"}var lZ='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',cZ="</body></html>";function uZ(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return No(I3(r[0],t),t);var s=_b();return r.forEach(function(n,o){Nb(s,I3(n,t),"Sheet"+(o+1))}),s}function dZ(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ZT(e,t){var r=t||{},s=r.header!=null?r.header:lZ,n=r.footer!=null?r.footer:cZ,o=[s],l=Ta(e["!ref"]);r.dense=Array.isArray(e),o.push(dZ(e,l,r));for(var u=l.s.r;u<=l.e.r;++u)o.push(oZ(e,l,u,r));return o.push("</table>"+n),o.join("")}function QT(e,t,r){var s=r||{},n=0,o=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var l=typeof s.origin=="string"?ts(s.origin):s.origin;n=l.r,o=l.c}var u=t.getElementsByTagName("tr"),d=Math.min(s.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:n,c:o}};if(e["!ref"]){var m=Ta(e["!ref"]);h.s.r=Math.min(h.s.r,m.s.r),h.s.c=Math.min(h.s.c,m.s.c),h.e.r=Math.max(h.e.r,m.e.r),h.e.c=Math.max(h.e.c,m.e.c),n==-1&&(h.e.r=n=m.e.r+1)}var x=[],y=0,b=e["!rows"]||(e["!rows"]=[]),v=0,g=0,_=0,w=0,S=0,N=0;for(e["!cols"]||(e["!cols"]=[]);v<u.length&&g<d;++v){var E=u[v];if(M3(E)){if(s.display)continue;b[g]={hidden:!0}}var C=E.children;for(_=w=0;_<C.length;++_){var F=C[_];if(!(s.display&&M3(F))){var O=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):w5(F.innerHTML),B=F.getAttribute("data-z")||F.getAttribute("z");for(y=0;y<x.length;++y){var L=x[y];L.s.c==w+o&&L.s.r<g+n&&g+n<=L.e.r&&(w=L.e.c+1-o,y=-1)}N=+F.getAttribute("colspan")||1,((S=+F.getAttribute("rowspan")||1)>1||N>1)&&x.push({s:{r:g+n,c:w+o},e:{r:g+n+(S||1)-1,c:w+o+(N||1)-1}});var H={t:"s",v:O},ue=F.getAttribute("data-t")||F.getAttribute("t")||"";O!=null&&(O.length==0?H.t=ue||"z":s.raw||O.trim().length==0||ue=="s"||(O==="TRUE"?H={t:"b",v:!0}:O==="FALSE"?H={t:"b",v:!1}:isNaN(Tn(O))?isNaN(Zc(O).getDate())||(H={t:"d",v:Vr(O)},s.cellDates||(H={t:"n",v:Rs(H.v)}),H.z=s.dateNF||Wt[14]):H={t:"n",v:Tn(O)})),H.z===void 0&&B!=null&&(H.z=B);var A="",Y=F.getElementsByTagName("A");if(Y&&Y.length)for(var I=0;I<Y.length&&!(Y[I].hasAttribute("href")&&(A=Y[I].getAttribute("href"),A.charAt(0)!="#"));++I);A&&A.charAt(0)!="#"&&(H.l={Target:A}),s.dense?(e[g+n]||(e[g+n]=[]),e[g+n][w+o]=H):e[Gt({c:w+o,r:g+n})]=H,h.e.c<w+o&&(h.e.c=w+o),w+=N}}++g}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),h.e.r=Math.max(h.e.r,g-1+n),e["!ref"]=Zt(h),g>=d&&(e["!fullref"]=Zt((h.e.r=u.length-v+g-1+n,h))),e}function e6(e,t){var r=t||{},s=r.dense?[]:{};return QT(s,e,t)}function fZ(e,t){return No(e6(e,t),t)}function M3(e){var t="",r=hZ(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function hZ(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function mZ(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=xr(t.replace(/<[^>]*>/g,""));return[r]}var B3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function t6(e,t){var r=t||{},s=Kv(e),n=[],o,l,u={name:""},d="",h=0,m,x,y={},b=[],v=r.dense?[]:{},g,_,w={value:""},S="",N=0,E=[],C=-1,F=-1,O={s:{r:1e6,c:1e7},e:{r:0,c:0}},B=0,L={},H=[],ue={},A=0,Y=0,I=[],ae=1,Q=1,re=[],ve={Names:[]},te={},ke=["",""],Z=[],M={},J="",V=0,X=!1,se=!1,P=0;for(Wd.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Wd.exec(s);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(O.e.c>=O.s.c&&O.e.r>=O.s.r?v["!ref"]=Zt(O):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=O.e.r&&(v["!fullref"]=v["!ref"],O.e.r=r.sheetRows-1,v["!ref"]=Zt(O)),H.length&&(v["!merges"]=H),I.length&&(v["!rows"]=I),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),b.push(m.name),y[m.name]=v,se=!1):g[0].charAt(g[0].length-2)!=="/"&&(m=Kt(g[0],!1),C=F=-1,O.s.r=O.s.c=1e7,O.e.r=O.e.c=0,v=r.dense?[]:{},H=[],I=[],se=!0);break;case"table-row-group":g[1]==="/"?--B:++B;break;case"table-row":case"":if(g[1]==="/"){C+=ae,ae=1;break}if(x=Kt(g[0],!1),x.?C=x.-1:C==-1&&(C=0),ae=+x["number-rows-repeated"]||1,ae<10)for(P=0;P<ae;++P)B>0&&(I[C+P]={level:B});F=-1;break;case"covered-table-cell":g[1]!=="/"&&++F,r.sheetStubs&&(r.dense?(v[C]||(v[C]=[]),v[C][F]={t:"z"}):v[Gt({r:C,c:F})]={t:"z"}),S="",E=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++F,w=Kt(g[0],!1),Q=parseInt(w["number-columns-repeated"]||"1",10),_={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(_.f=O3(xr(w.formula))),(w.||w["value-type"])=="string"&&(_.t="s",_.v=xr(w["string-value"]||""),r.dense?(v[C]||(v[C]=[]),v[C][F]=_):v[Gt({r:C,c:F})]=_),F+=Q-1;else if(g[1]!=="/"){++F,S="",N=0,E=[],Q=1;var U=ae?C+ae-1:C;if(F>O.e.c&&(O.e.c=F),F<O.s.c&&(O.s.c=F),C<O.s.r&&(O.s.r=C),U>O.e.r&&(O.e.r=U),w=Kt(g[0],!1),Z=[],M={},_={t:w.||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=xr(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(A=parseInt(w["number-matrix-rows-spanned"],10)||0,Y=parseInt(w["number-matrix-columns-spanned"],10)||0,ue={s:{r:C,c:F},e:{r:C+A-1,c:F+Y-1}},_.F=Zt(ue),re.push([ue,_.F])),w.formula)_.f=O3(w.formula);else for(P=0;P<re.length;++P)C>=re[P][0].s.r&&C<=re[P][0].e.r&&F>=re[P][0].s.c&&F<=re[P][0].e.c&&(_.F=re[P][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(A=parseInt(w["number-rows-spanned"],10)||0,Y=parseInt(w["number-columns-spanned"],10)||0,ue={s:{r:C,c:F},e:{r:C+A-1,c:F+Y-1}},H.push(ue)),w["number-columns-repeated"]&&(Q=parseInt(w["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Gr(w["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(w.value);break;case"percentage":_.t="n",_.v=parseFloat(w.value);break;case"currency":_.t="n",_.v=parseFloat(w.value);break;case"date":_.t="d",_.v=Vr(w["date-value"]),r.cellDates||(_.t="n",_.v=Rs(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=zz(w["time-value"])/86400,r.cellDates&&(_.t="d",_.v=Nm(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(w.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",w["string-value"]!=null&&(S=xr(w["string-value"]),E=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(X=!1,_.t==="s"&&(_.v=S||"",E.length&&(_.R=E),X=N==0),te.Target&&(_.l=te),Z.length>0&&(_.c=Z,Z=[]),S&&r.cellText!==!1&&(_.w=S),X&&(_.t="z",delete _.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=C))for(var ce=0;ce<ae;++ce){if(Q=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(v[C+ce]||(v[C+ce]=[]),v[C+ce][F]=ce==0?_:Kr(_);--Q>0;)v[C+ce][F+Q]=Kr(_);else for(v[Gt({r:C+ce,c:F})]=_;--Q>0;)v[Gt({r:C+ce,c:F+Q})]=Kr(_);O.e.c<=F&&(O.e.c=F)}Q=parseInt(w["number-columns-repeated"]||"1",10),F+=Q-1,Q=0,_={},S="",E=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((o=n.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&n.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((o=n.pop())[0]!==g[3])throw"Bad state: "+o;M.t=S,E.length&&(M.R=E),M.a=J,Z.push(M)}else g[0].charAt(g[0].length-2)!=="/"&&n.push([g[3],!1]);J="",V=0,S="",N=0,E=[];break;case"creator":g[1]==="/"?J=s.slice(V,g.index):V=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((o=n.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&n.push([g[3],!1]);S="",N=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(L[u.name]=d,(o=n.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&(d="",u=Kt(g[0],!1),n.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Kt(g[0],!1),d+=B3[g[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Kt(g[0],!1),d+=B3[g[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":d+=s.slice(h,g.index);break}else h=g.index+g[0].length;break;case"named-range":l=Kt(g[0],!1),ke=cy(l["cell-range-address"]);var ne={Name:l.name,Ref:ke[0]+"!"+ke[1]};se&&(ne.Sheet=b.length),ve.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(g[1]==="/"&&(!w||!w["string-value"])){var ie=mZ(s.slice(N,g.index));S=(S.length>0?S+`
`:"")+ie[0]}else Kt(g[0],!1),N=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ke=cy(Kt(g[0])["target-range-address"]),y[ke[0]]["!autofilter"]={ref:ke[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(te=Kt(g[0],!1),!te.href)break;te.Target=xr(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(ke=cy(te.Target.slice(1)),te.Target="#"+ke[0]+"!"+ke[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var W={Sheets:y,SheetNames:b,Workbook:ve};return r.bookSheets&&delete W.Sheets,W}function P3(e,t){t=t||{},un(e,"META-INF/manifest.xml")&&z$(ks(e,"META-INF/manifest.xml"),t);var r=$a(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=t6(Pr(r),t);return un(e,"meta.xml")&&(s.Props=W5(ks(e,"meta.xml"))),s}function U3(e,t){return t6(e,t)}var pZ=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Hd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ys+t}})(),z3=(function(){var e=function(o){return Dr(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(o,l,u){var d=[];d.push('      <table:table table:name="'+Dr(l.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,m=0,x=Ta(o["!ref"]||"A1"),y=o["!merges"]||[],b=0,v=Array.isArray(o);if(o["!cols"])for(m=0;m<=x.e.c;++m)d.push("        <table:table-column"+(o["!cols"][m]?' table:style-name="co'+o["!cols"][m].ods+'"':"")+`></table:table-column>
`);var g="",_=o["!rows"]||[];for(h=0;h<x.s.r;++h)g=_[h]?' table:style-name="ro'+_[h].ods+'"':"",d.push("        <table:table-row"+g+`></table:table-row>
`);for(;h<=x.e.r;++h){for(g=_[h]?' table:style-name="ro'+_[h].ods+'"':"",d.push("        <table:table-row"+g+`>
`),m=0;m<x.s.c;++m)d.push(t);for(;m<=x.e.c;++m){var w=!1,S={},N="";for(b=0;b!=y.length;++b)if(!(y[b].s.c>m)&&!(y[b].s.r>h)&&!(y[b].e.c<m)&&!(y[b].e.r<h)){(y[b].s.c!=m||y[b].s.r!=h)&&(w=!0),S["table:number-columns-spanned"]=y[b].e.c-y[b].s.c+1,S["table:number-rows-spanned"]=y[b].e.r-y[b].s.r+1;break}if(w){d.push(r);continue}var E=Gt({r:h,c:m}),C=v?(o[h]||[])[m]:o[E];if(C&&C.f&&(S["table:formula"]=Dr(LK(C.f)),C.F&&C.F.slice(0,E.length)==E)){var F=Ta(C.F);S["table:number-matrix-columns-spanned"]=F.e.c-F.s.c+1,S["table:number-matrix-rows-spanned"]=F.e.r-F.s.r+1}if(!C){d.push(t);continue}switch(C.t){case"b":N=C.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=C.v?"true":"false";break;case"n":N=C.w||String(C.v||0),S["office:value-type"]="float",S["office:value"]=C.v||0;break;case"s":case"str":N=C.v==null?"":C.v,S["office:value-type"]="string";break;case"d":N=C.w||Vr(C.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=Vr(C.v).toISOString(),S["table:style-name"]="ce1";break;default:d.push(t);continue}var O=e(N);if(C.l&&C.l.Target){var B=C.l.Target;B=B.charAt(0)=="#"?"#"+IK(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),O=kt("text:a",O,{"xlink:href":B.replace(/&/g,"&amp;")})}d.push("          "+kt("table:table-cell",kt("text:p",O,{}),S)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},n=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(h){return l.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var m=0;m<h["!cols"].length;++m)if(h["!cols"][m]){var x=h["!cols"][m];if(x.width==null&&x.wpx==null&&x.wch==null)continue;xo(x),x.ods=u;var y=h["!cols"][m].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),o.push(`  </style:style>
`),++u}}});var d=0;l.SheetNames.map(function(h){return l.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var m=0;m<h["!rows"].length;++m)if(h["!rows"][m]){h["!rows"][m].ods=d;var x=h["!rows"][m].hpx+"px";o.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),o.push(`  </style:style>
`),++d}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,u){var d=[ys],h=Hd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=Hd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(d.push("<office:document"+h+m+`>
`),d.push(H5().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+h+`>
`),n(d,l),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var x=0;x!=l.SheetNames.length;++x)d.push(s(l.Sheets[l.SheetNames[x]],l,x));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),u.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function r6(e,t){if(t.bookType=="fods")return z3(e,t);var r=Hv(),s="",n=[],o=[];return s="mimetype",er(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",er(r,s,z3(e,t)),n.push([s,"text/xml"]),o.push([s,"ContentFile"]),s="styles.xml",er(r,s,pZ(e,t)),n.push([s,"text/xml"]),o.push([s,"StylesFile"]),s="meta.xml",er(r,s,ys+H5()),n.push([s,"text/xml"]),o.push([s,"MetadataFile"]),s="manifest.rdf",er(r,s,H$(o)),n.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",er(r,s,$$(n)),r}function bl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rv(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Pr(_o(e))}function xZ(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):za(Hn(e))}function gZ(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function yo(e){var t=e.reduce(function(n,o){return n+o.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(n){r.set(n,s),s+=n.length}),r}function $3(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function yZ(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,n=t+13;n>=t;--n)s=s*256+e[n];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function vZ(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var o=0;n>=1;++o,n/=256)e[t+o]=n&255;e[t+15]|=r>=0?0:128}function Zd(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function Ar(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function ls(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function wr(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],n=Zd(e,r),o=n&7;n=Math.floor(n/8);var l=0,u;if(n==0)break;switch(o){case 0:{for(var d=r[0];e[r[0]++]>=128;);u=e.slice(d,r[0])}break;case 5:l=4,u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Zd(e,r),u=e.slice(r[0],r[0]+l),r[0]+=l;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(n," at offset ").concat(s))}var h={data:u,type:o};t[n]==null?t[n]=[h]:t[n].push(h)}return t}function Hs(e){var t=[];return e.forEach(function(r,s){r.forEach(function(n){n.data&&(t.push(Ar(s*8+n.type)),n.type==2&&t.push(Ar(n.data.length)),t.push(n.data))})}),yo(t)}function gb(e,t){return e?.map(function(r){return t(r.data)})||[]}function ln(e){for(var t,r=[],s=[0];s[0]<e.length;){var n=Zd(e,s),o=wr(e.slice(s[0],s[0]+n));s[0]+=n;var l={id:ls(o[1][0].data),messages:[]};o[2].forEach(function(u){var d=wr(u.data),h=ls(d[3][0].data);l.messages.push({meta:d,data:e.slice(s[0],s[0]+h)}),s[0]+=h}),(t=o[3])!=null&&t[0]&&(l.merge=ls(o[3][0].data)>>>0>0),r.push(l)}return r}function _c(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:Ar(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:Ar(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:Ar(l.data.length)}],s[2].push({data:Hs(l.meta),type:2})});var o=Hs(s);t.push(Ar(o.length)),t.push(o),n.forEach(function(l){return t.push(l)})}),yo(t)}function bZ(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=Zd(t,r),n=[];r[0]<t.length;){var o=t[r[0]]&3;if(o==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=t[r[0]],u>1&&(l|=t[r[0]+1]<<8),u>2&&(l|=t[r[0]+2]<<16),u>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}n.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var d=0,h=0;if(o==1?(h=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(h=(t[r[0]++]>>2)+1,o==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[yo(n)],d==0)throw new Error("Invalid offset 0");if(d>n[0].length)throw new Error("Invalid offset beyond length");if(h>=d)for(n.push(n[0].slice(-d)),h-=d;h>=n[n.length-1].length;)n.push(n[n.length-1]),h-=n[n.length-1].length;n.push(n[0].slice(-d,-d+h))}}var m=yo(n);if(m.length!=s)throw new Error("Unexpected length: ".concat(m.length," != ").concat(s));return m}function cn(e){for(var t=[],r=0;r<e.length;){var s=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(bZ(s,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return yo(t)}function Nc(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var o=Ar(s),l=o.length;t.push(o),s<=60?(l++,t.push(new Uint8Array([s-1<<2]))):s<=256?(l+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(l+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(l+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(l+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),l+=s,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,r+=s}return yo(t)}function wZ(e,t,r,s){var n=bl(e),o=n.getUint32(4,!0),l=(s>1?12:8)+$3(o&(s>1?3470:398))*4,u=-1,d=-1,h=NaN,m=new Date(2001,0,1);o&512&&(u=n.getUint32(l,!0),l+=4),l+=$3(o&(s>1?12288:4096))*4,o&16&&(d=n.getUint32(l,!0),l+=4),o&32&&(h=n.getFloat64(l,!0),l+=8),o&64&&(m.setTime(m.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:t[d]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(d>-1)x={t:"s",v:t[d]};else if(!isNaN(h))x={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function _Z(e,t,r){var s=bl(e),n=s.getUint32(8,!0),o=12,l=-1,u=-1,d=NaN,h=NaN,m=new Date(2001,0,1);n&1&&(d=yZ(e,o),o+=16),n&2&&(h=s.getFloat64(o,!0),o+=8),n&4&&(m.setTime(m.getTime()+s.getFloat64(o,!0)*1e3),o+=8),n&8&&(u=s.getUint32(o,!0),o+=4),n&16&&(l=s.getUint32(o,!0),o+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:t[u]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(l>-1)x={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return x}function dy(e,t){var r=new Uint8Array(32),s=bl(r),n=12,o=0;switch(r[0]=5,e.t){case"n":r[1]=2,vZ(r,n,e.v),o|=1,n+=16;break;case"b":r[1]=6,s.setFloat64(n,e.v?1:0,!0),o|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(n,t.indexOf(e.v),!0),o|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,o,!0),r.slice(0,n)}function fy(e,t){var r=new Uint8Array(32),s=bl(r),n=12,o=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(n,e.v,!0),o|=32,n+=8;break;case"b":r[2]=6,s.setFloat64(n,e.v?1:0,!0),o|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(n,t.indexOf(e.v),!0),o|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,o,!0),r.slice(0,n)}function NZ(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return wZ(e,t,r,e[0]);case 5:return _Z(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ta(e){var t=wr(e);return Zd(t[1][0].data)}function q3(e,t){var r=wr(t.data),s=ls(r[1][0].data),n=r[3],o=[];return(n||[]).forEach(function(l){var u=wr(l.data),d=ls(u[1][0].data)>>>0;switch(s){case 1:o[d]=rv(u[3][0].data);break;case 8:{var h=e[ta(u[9][0].data)][0],m=wr(h.data),x=e[ta(m[1][0].data)][0],y=ls(x.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var b=wr(x.data);o[d]=b[3].map(function(v){return rv(v.data)}).join("")}break}}),o}function kZ(e,t){var r,s,n,o,l,u,d,h,m,x,y,b,v,g,_=wr(e),w=ls(_[1][0].data)>>>0,S=ls(_[2][0].data)>>>0,N=((s=(r=_[8])==null?void 0:r[0])==null?void 0:s.data)&&ls(_[8][0].data)>0||!1,E,C;if((o=(n=_[7])==null?void 0:n[0])!=null&&o.data&&t!=0)E=(u=(l=_[7])==null?void 0:l[0])==null?void 0:u.data,C=(h=(d=_[6])==null?void 0:d[0])==null?void 0:h.data;else if((x=(m=_[4])==null?void 0:m[0])!=null&&x.data&&t!=1)E=(b=(y=_[4])==null?void 0:y[0])==null?void 0:b.data,C=(g=(v=_[3])==null?void 0:v[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var F=N?4:1,O=bl(E),B=[],L=0;L<E.length/2;++L){var H=O.getUint16(L*2,!0);H<65535&&B.push([L,H])}if(B.length!=S)throw"Expected ".concat(S," cells, found ").concat(B.length);var ue=[];for(L=0;L<B.length-1;++L)ue[B[L][0]]=C.subarray(B[L][1]*F,B[L+1][1]*F);return B.length>=1&&(ue[B[B.length-1][0]]=C.subarray(B[B.length-1][1]*F)),{R:w,cells:ue}}function SZ(e,t){var r,s=wr(t.data),n=(r=s?.[7])!=null&&r[0]?ls(s[7][0].data)>>>0>0?1:0:-1,o=gb(s[5],function(l){return kZ(l,n)});return{nrows:ls(s[4][0].data)>>>0,data:o.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(d,h){if(l[u.R][h])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(h));l[u.R][h]=d}),l},[])}}function EZ(e,t,r){var s,n=wr(t.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(ls(n[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(o.e.c=(ls(n[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Zt(o);var l=wr(n[4][0].data),u=q3(e,e[ta(l[4][0].data)][0]),d=(s=l[17])!=null&&s[0]?q3(e,e[ta(l[17][0].data)][0]):[],h=wr(l[3][0].data),m=0;h[1].forEach(function(x){var y=wr(x.data),b=e[ta(y[2][0].data)][0],v=ls(b.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var g=SZ(e,b);g.data.forEach(function(_,w){_.forEach(function(S,N){var E=Gt({r:m+w,c:N}),C=NZ(S,u,d);C&&(r[E]=C)})}),m+=g.nrows})}function jZ(e,t){var r=wr(t.data),s={"!ref":"A1"},n=e[ta(r[2][0].data)],o=ls(n[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return EZ(e,n[0],s),s}function TZ(e,t){var r,s=wr(t.data),n={name:(r=s[1])!=null&&r[0]?rv(s[1][0].data):"",sheets:[]},o=gb(s[2],ta);return o.forEach(function(l){e[l].forEach(function(u){var d=ls(u.meta[1][0].data);d==6e3&&n.sheets.push(jZ(e,u))})}),n}function AZ(e,t){var r=_b(),s=wr(t.data),n=gb(s[1],ta);if(n.forEach(function(o){e[o].forEach(function(l){var u=ls(l.meta[1][0].data);if(u==2){var d=TZ(e,l);d.sheets.forEach(function(h,m){Nb(r,h,m==0?d.name:d.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function hy(e){var t,r,s,n,o={},l=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var h;try{h=cn(d.content)}catch(x){return console.log("?? "+d.content.length+" "+(x.message||x))}var m;try{m=ln(h)}catch(x){return console.log("## "+(x.message||x))}m.forEach(function(x){o[x.id]=x.messages,l.push(x.id)})}}),!l.length)throw new Error("File has no messages");var u=((n=(s=(r=(t=o?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:n[0].data)&&ls(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||l.forEach(function(d){o[d].forEach(function(h){var m=ls(h.meta[1][0].data)>>>0;if(m==1)if(!u)u=h;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return AZ(o,u)}function CZ(e,t,r){var s,n,o,l;if(!((s=e[6])!=null&&s[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(o=e[8])==null?void 0:o[0])==null?void 0:l.data)&&ls(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var d=0,h=bl(e[7][0].data),m=0,x=[],y=bl(e[4][0].data),b=0,v=[],g=0;g<t.length;++g){if(t[g]==null){h.setUint16(g*2,65535,!0),y.setUint16(g*2,65535);continue}h.setUint16(g*2,m,!0),y.setUint16(g*2,b,!0);var _,w;switch(typeof t[g]){case"string":_=dy({t:"s",v:t[g]},r),w=fy({t:"s",v:t[g]},r);break;case"number":_=dy({t:"n",v:t[g]},r),w=fy({t:"n",v:t[g]},r);break;case"boolean":_=dy({t:"b",v:t[g]},r),w=fy({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}x.push(_),m+=_.length,v.push(w),b+=w.length,++d}for(e[2][0].data=Ar(d);g<e[7][0].data.length/2;++g)h.setUint16(g*2,65535,!0),y.setUint16(g*2,65535,!0);return e[6][0].data=yo(x),e[3][0].data=yo(v),d}function RZ(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Ta(r["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Zt(s)));var o=Z0(r,{range:s,header:1}),l=["~Sh33tJ5~"];o.forEach(function(J){return J.forEach(function(V){typeof V=="string"&&l.push(V)})});var u={},d=[],h=Pt.read(t.numbers,{type:"base64"});h.FileIndex.map(function(J,V){return[J,h.FullPaths[V]]}).forEach(function(J){var V=J[0],X=J[1];if(V.type==2&&V.name.match(/\.iwa/)){var se=V.content,P=cn(se),U=ln(P);U.forEach(function(ce){d.push(ce.id),u[ce.id]={deps:[],location:X,type:ls(ce.messages[0].meta[1][0].data)}})}}),d.sort(function(J,V){return J-V});var m=d.filter(function(J){return J>1}).map(function(J){return[J,Ar(J)]});h.FileIndex.map(function(J,V){return[J,h.FullPaths[V]]}).forEach(function(J){var V=J[0];if(J[1],!!V.name.match(/\.iwa/)){var X=ln(cn(V.content));X.forEach(function(se){se.messages.forEach(function(P){m.forEach(function(U){se.messages.some(function(ce){return ls(ce.meta[1][0].data)!=11006&&gZ(ce.data,U[1])})&&u[U[0]].deps.push(se.id)})})})}});for(var x=Pt.find(h,u[1].location),y=ln(cn(x.content)),b,v=0;v<y.length;++v){var g=y[v];g.id==1&&(b=g)}var _=ta(wr(b.messages[0].data)[1][0].data);for(x=Pt.find(h,u[_].location),y=ln(cn(x.content)),v=0;v<y.length;++v)g=y[v],g.id==_&&(b=g);for(_=ta(wr(b.messages[0].data)[2][0].data),x=Pt.find(h,u[_].location),y=ln(cn(x.content)),v=0;v<y.length;++v)g=y[v],g.id==_&&(b=g);for(_=ta(wr(b.messages[0].data)[2][0].data),x=Pt.find(h,u[_].location),y=ln(cn(x.content)),v=0;v<y.length;++v)g=y[v],g.id==_&&(b=g);var w=wr(b.messages[0].data);{w[6][0].data=Ar(s.e.r+1),w[7][0].data=Ar(s.e.c+1);var S=ta(w[46][0].data),N=Pt.find(h,u[S].location),E=ln(cn(N.content));{for(var C=0;C<E.length&&E[C].id!=S;++C);if(E[C].id!=S)throw"Bad ColumnRowUIDMapArchive";var F=wr(E[C].messages[0].data);F[1]=[],F[2]=[],F[3]=[];for(var O=0;O<=s.e.c;++O){var B=[];B[1]=B[2]=[{type:0,data:Ar(O+420690)}],F[1].push({type:2,data:Hs(B)}),F[2].push({type:0,data:Ar(O)}),F[3].push({type:0,data:Ar(O)})}F[4]=[],F[5]=[],F[6]=[];for(var L=0;L<=s.e.r;++L)B=[],B[1]=B[2]=[{type:0,data:Ar(L+726270)}],F[4].push({type:2,data:Hs(B)}),F[5].push({type:0,data:Ar(L)}),F[6].push({type:0,data:Ar(L)});E[C].messages[0].data=Hs(F)}N.content=Nc(_c(E)),N.size=N.content.length,delete w[46];var H=wr(w[4][0].data);{H[7][0].data=Ar(s.e.r+1);var ue=wr(H[1][0].data),A=ta(ue[2][0].data);N=Pt.find(h,u[A].location),E=ln(cn(N.content));{if(E[0].id!=A)throw"Bad HeaderStorageBucket";var Y=wr(E[0].messages[0].data);for(L=0;L<o.length;++L){var I=wr(Y[2][0].data);I[1][0].data=Ar(L),I[4][0].data=Ar(o[L].length),Y[2][L]={type:Y[2][0].type,data:Hs(I)}}E[0].messages[0].data=Hs(Y)}N.content=Nc(_c(E)),N.size=N.content.length;var ae=ta(H[2][0].data);N=Pt.find(h,u[ae].location),E=ln(cn(N.content));{if(E[0].id!=ae)throw"Bad HeaderStorageBucket";for(Y=wr(E[0].messages[0].data),O=0;O<=s.e.c;++O)I=wr(Y[2][0].data),I[1][0].data=Ar(O),I[4][0].data=Ar(s.e.r+1),Y[2][O]={type:Y[2][0].type,data:Hs(I)};E[0].messages[0].data=Hs(Y)}N.content=Nc(_c(E)),N.size=N.content.length;var Q=ta(H[4][0].data);(function(){for(var J=Pt.find(h,u[Q].location),V=ln(cn(J.content)),X,se=0;se<V.length;++se){var P=V[se];P.id==Q&&(X=P)}var U=wr(X.messages[0].data);{U[3]=[];var ce=[];l.forEach(function(W,G){ce[1]=[{type:0,data:Ar(G)}],ce[2]=[{type:0,data:Ar(1)}],ce[3]=[{type:2,data:xZ(W)}],U[3].push({type:2,data:Hs(ce)})})}X.messages[0].data=Hs(U);var ne=_c(V),ie=Nc(ne);J.content=ie,J.size=J.content.length})();var re=wr(H[3][0].data);{var ve=re[1][0];delete re[2];var te=wr(ve.data);{var ke=ta(te[2][0].data);(function(){for(var J=Pt.find(h,u[ke].location),V=ln(cn(J.content)),X,se=0;se<V.length;++se){var P=V[se];P.id==ke&&(X=P)}var U=wr(X.messages[0].data);{delete U[6],delete re[7];var ce=new Uint8Array(U[5][0].data);U[5]=[];for(var ne=0,ie=0;ie<=s.e.r;++ie){var W=wr(ce);ne+=CZ(W,o[ie],l),W[1][0].data=Ar(ie),U[5].push({data:Hs(W),type:2})}U[1]=[{type:0,data:Ar(s.e.c+1)}],U[2]=[{type:0,data:Ar(s.e.r+1)}],U[3]=[{type:0,data:Ar(ne)}],U[4]=[{type:0,data:Ar(s.e.r+1)}]}X.messages[0].data=Hs(U);var G=_c(V),k=Nc(G);J.content=k,J.size=J.content.length})()}ve.data=Hs(te)}H[3][0].data=Hs(re)}w[4][0].data=Hs(H)}b.messages[0].data=Hs(w);var Z=_c(y),M=Nc(Z);return x.content=M,x.size=x.content.length,h}function s6(e){return function(r){for(var s=0;s!=e.length;++s){var n=e[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function yb(e){s6([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function vb(e){s6([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function DZ(e){return ir.WS.indexOf(e)>-1?"sheet":e==ir.CS?"chart":e==ir.DS?"dialog":e==ir.MS?"macro":e&&e.length?e:"sheet"}function OZ(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,DZ(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function FZ(e,t,r,s,n,o,l,u,d,h,m,x){try{o[s]=_d($a(e,r,!0),t);var y=ks(e,t),b;switch(u){case"sheet":b=rJ(y,t,n,d,o[s],h,m,x);break;case"chart":if(b=sJ(y,t,n,d,o[s],h,m,x),!b||!b["!drawel"])break;var v=md(b["!drawel"].Target,t),g=Gd(v),_=qG($a(e,v,!0),_d($a(e,g,!0),v)),w=md(_,v),S=Gd(w);b=CY($a(e,w,!0),w,d,_d($a(e,S,!0),w),h,b);break;case"macro":b=aJ(y,t,n,d,o[s],h,m,x);break;case"dialog":b=nJ(y,t,n,d,o[s],h,m,x);break;default:throw new Error("Unrecognized sheet type "+u)}l[s]=b;var N=[];o&&o[s]&&cs(o[s]).forEach(function(E){var C="";if(o[s][E].Type==ir.CMNT){C=md(o[s][E].Target,t);var F=cJ(ks(e,C,!0),C,d);if(!F||!F.length)return;T3(b,F,!1)}o[s][E].Type==ir.TCMNT&&(C=md(o[s][E].Target,t),N=N.concat(WG(ks(e,C,!0),d)))}),N&&N.length&&T3(b,N,!0,d.people||[])}catch(E){if(d.WTF)throw E}}function nn(e){return e.charAt(0)=="/"?e.slice(1):e}function LZ(e,t){if(ou(),t=t||{},yb(t),un(e,"META-INF/manifest.xml")||un(e,"objectdata.xml"))return P3(e,t);if(un(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof hy<"u"){if(e.FileIndex)return hy(e);var r=Pt.utils.cfb_new();return XS(e).forEach(function(I){er(r,I,Gz(e,I))}),hy(r)}throw new Error("Unsupported NUMBERS file")}if(!un(e,"[Content_Types].xml"))throw un(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):un(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=XS(e),n=P$($a(e,"[Content_Types].xml")),o=!1,l,u;if(n.workbooks.length===0&&(u="xl/workbook.xml",ks(e,u,!0)&&n.workbooks.push(u)),n.workbooks.length===0){if(u="xl/workbook.bin",!ks(e,u,!0))throw new Error("Could not find workbook");n.workbooks.push(u),o=!0}n.workbooks[0].slice(-3)=="bin"&&(o=!0);var d={},h={};if(!t.bookSheets&&!t.bookProps){if(Nd=[],n.sst)try{Nd=lJ(ks(e,nn(n.sst)),n.sst,t)}catch(I){if(t.WTF)throw I}t.cellStyles&&n.themes.length&&(d=oJ($a(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(h=iJ(ks(e,nn(n.style)),n.style,d,t))}n.links.map(function(I){try{var ae=_d($a(e,Gd(nn(I))),I);return dJ(ks(e,nn(I)),ae,I,t)}catch{}});var m=tJ(ks(e,nn(n.workbooks[0])),n.workbooks[0],t),x={},y="";n.coreprops.length&&(y=ks(e,nn(n.coreprops[0]),!0),y&&(x=W5(y)),n.extprops.length!==0&&(y=ks(e,nn(n.extprops[0]),!0),y&&G$(y,x,t)));var b={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(y=$a(e,nn(n.custprops[0]),!0),y&&(b=K$(y,t)));var v={};if((t.bookSheets||t.bookProps)&&(m.Sheets?l=m.Sheets.map(function(ae){return ae.name}):x.Worksheets&&x.SheetNames.length>0&&(l=x.SheetNames),t.bookProps&&(v.Props=x,v.Custprops=b),t.bookSheets&&typeof l<"u"&&(v.SheetNames=l),t.bookSheets?v.SheetNames:t.bookProps))return v;l={};var g={};t.bookDeps&&n.calcchain&&(g=uJ(ks(e,nn(n.calcchain)),n.calcchain));var _=0,w={},S,N;{var E=m.Sheets;x.Worksheets=E.length,x.SheetNames=[];for(var C=0;C!=E.length;++C)x.SheetNames[C]=E[C].name}var F=o?"bin":"xml",O=n.workbooks[0].lastIndexOf("/"),B=(n.workbooks[0].slice(0,O+1)+"_rels/"+n.workbooks[0].slice(O+1)+".rels").replace(/^\//,"");un(e,B)||(B="xl/_rels/workbook."+F+".rels");var L=_d($a(e,B,!0),B.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=fJ(ks(e,nn(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=VG(ks(e,nn(n.people[0])),t)),L&&(L=OZ(L,m.Sheets));var H=ks(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=x.Worksheets;++_){var ue="sheet";if(L&&L[_]?(S="xl/"+L[_][1].replace(/[\/]?xl\//,""),un(e,S)||(S=L[_][1]),un(e,S)||(S=B.replace(/_rels\/.*$/,"")+L[_][1]),ue=L[_][2]):(S="xl/worksheets/sheet"+(_+1-H)+"."+F,S=S.replace(/sheet0\./,"sheet.")),N=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(x.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==_&&(A=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==x.SheetNames[_].toLowerCase()&&(A=1);if(!A)continue e}}FZ(e,S,N,x.SheetNames[_],_,w,l,ue,t,m,d,h)}return v={Directory:n,Workbook:m,Props:x,Custprops:b,Deps:g,Sheets:l,SheetNames:x.SheetNames,Strings:Nd,Styles:h,Themes:d,SSF:Kr(Wt)},t&&t.bookFiles&&(e.files?(v.keys=s,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(I,ae){I=I.replace(/^Root Entry[\/]/,""),v.keys.push(I),v.files[I]=e.FileIndex[ae]}))),t&&t.bookVBA&&(n.vba.length>0?v.vbaraw=ks(e,nn(n.vba[0]),!0):n.defaults&&n.defaults.bin===tV&&(v.vbaraw=ks(e,"xl/vbaProject.bin",!0))),v}function IZ(e,t){var r=t||{},s="Workbook",n=Pt.find(e,s);try{if(s="/!DataSpaces/Version",n=Pt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(fW(n.content),s="/!DataSpaces/DataSpaceMap",n=Pt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=mW(n.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Pt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=pW(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Pt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);gW(n.content)}catch{}if(s="/EncryptionInfo",n=Pt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var u=yW(n.content);if(s="/EncryptedPackage",n=Pt.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],n.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function MZ(e,t){return t.bookType=="ods"?r6(e,t):t.bookType=="numbers"?RZ(e,t):t.bookType=="xlsb"?BZ(e,t):PZ(e,t)}function BZ(e,t){Oc=1024,e&&!e.SSF&&(e.SSF=Kr(Wt)),e&&e.SSF&&(ou(),bm(e.SSF),t.revssf=_m(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,kd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=CT.indexOf(t.bookType)>-1,n=ab();vb(t=t||{});var o=Hv(),l="",u=0;if(t.cellXfs=[],ko(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",er(o,l,G5(e.Props,t)),n.coreprops.push(l),Cr(t.rels,2,l,ir.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,er(o,l,X5(e.Props)),n.extprops.push(l),Cr(t.rels,3,l,ir.EXT_PROPS),e.Custprops!==e.Props&&cs(e.Custprops||{}).length>0&&(l="docProps/custom.xml",er(o,l,Y5(e.Custprops)),n.custprops.push(l),Cr(t.rels,4,l,ir.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var m={"!id":{}},x=e.Sheets[e.SheetNames[u-1]],y=(x||{})["!type"]||"sheet";if(l="xl/worksheets/sheet"+u+"."+r,er(o,l,mJ(u-1,l,t,e,m)),n.sheets.push(l),Cr(t.wbrels,-1,"worksheets/sheet"+u+"."+r,ir.WS[0]),x){var b=x["!comments"],v=!1,g="";b&&b.length>0&&(g="xl/comments"+u+"."+r,er(o,g,gJ(b,g)),n.comments.push(g),Cr(m,-1,"../comments"+u+"."+r,ir.CMNT),v=!0),x["!legacy"]&&v&&er(o,"xl/drawings/vmlDrawing"+u+".vml",TT(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&er(o,Gd(l),Uc(m))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,er(o,l,xJ(t.Strings,l,t)),n.strs.push(l),Cr(t.wbrels,-1,"sharedStrings."+r,ir.SST)),l="xl/workbook."+r,er(o,l,hJ(e,l)),n.workbooks.push(l),Cr(t.rels,1,l,ir.WB),l="xl/theme/theme1.xml",er(o,l,ub(e.Themes,t)),n.themes.push(l),Cr(t.wbrels,-1,"theme/theme1.xml",ir.THEME),l="xl/styles."+r,er(o,l,pJ(e,l,t)),n.styles.push(l),Cr(t.wbrels,-1,"styles."+r,ir.STY),e.vbaraw&&s&&(l="xl/vbaProject.bin",er(o,l,e.vbaraw),n.vba.push(l),Cr(t.wbrels,-1,"vbaProject.bin",ir.VBA)),l="xl/metadata."+r,er(o,l,yJ(l)),n.metadata.push(l),Cr(t.wbrels,-1,"metadata."+r,ir.XLMETA),er(o,"[Content_Types].xml",q5(n,t)),er(o,"_rels/.rels",Uc(t.rels)),er(o,"xl/_rels/workbook."+r+".rels",Uc(t.wbrels)),delete t.revssf,delete t.ssf,o}function PZ(e,t){Oc=1024,e&&!e.SSF&&(e.SSF=Kr(Wt)),e&&e.SSF&&(ou(),bm(e.SSF),t.revssf=_m(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,kd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=CT.indexOf(t.bookType)>-1,n=ab();vb(t=t||{});var o=Hv(),l="",u=0;if(t.cellXfs=[],ko(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",er(o,l,G5(e.Props,t)),n.coreprops.push(l),Cr(t.rels,2,l,ir.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,er(o,l,X5(e.Props)),n.extprops.push(l),Cr(t.rels,3,l,ir.EXT_PROPS),e.Custprops!==e.Props&&cs(e.Custprops||{}).length>0&&(l="docProps/custom.xml",er(o,l,Y5(e.Custprops)),n.custprops.push(l),Cr(t.rels,4,l,ir.CUST_PROPS));var m=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var x={"!id":{}},y=e.Sheets[e.SheetNames[u-1]],b=(y||{})["!type"]||"sheet";if(l="xl/worksheets/sheet"+u+"."+r,er(o,l,zT(u-1,t,e,x)),n.sheets.push(l),Cr(t.wbrels,-1,"worksheets/sheet"+u+"."+r,ir.WS[0]),y){var v=y["!comments"],g=!1,_="";if(v&&v.length>0){var w=!1;v.forEach(function(S){S[1].forEach(function(N){N.T==!0&&(w=!0)})}),w&&(_="xl/threadedComments/threadedComment"+u+"."+r,er(o,_,GG(v,m,t)),n.threadedcomments.push(_),Cr(x,-1,"../threadedComments/threadedComment"+u+"."+r,ir.TCMNT)),_="xl/comments"+u+"."+r,er(o,_,AT(v)),n.comments.push(_),Cr(x,-1,"../comments"+u+"."+r,ir.CMNT),g=!0}y["!legacy"]&&g&&er(o,"xl/drawings/vmlDrawing"+u+".vml",TT(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}x["!id"].rId1&&er(o,Gd(l),Uc(x))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,er(o,l,xT(t.Strings,t)),n.strs.push(l),Cr(t.wbrels,-1,"sharedStrings."+r,ir.SST)),l="xl/workbook."+r,er(o,l,GT(e)),n.workbooks.push(l),Cr(t.rels,1,l,ir.WB),l="xl/theme/theme1.xml",er(o,l,ub(e.Themes,t)),n.themes.push(l),Cr(t.wbrels,-1,"theme/theme1.xml",ir.THEME),l="xl/styles."+r,er(o,l,kT(e,t)),n.styles.push(l),Cr(t.wbrels,-1,"styles."+r,ir.STY),e.vbaraw&&s&&(l="xl/vbaProject.bin",er(o,l,e.vbaraw),n.vba.push(l),Cr(t.wbrels,-1,"vbaProject.bin",ir.VBA)),l="xl/metadata."+r,er(o,l,jT()),n.metadata.push(l),Cr(t.wbrels,-1,"metadata."+r,ir.XLMETA),m.length>1&&(l="xl/persons/person.xml",er(o,l,KG(m)),n.people.push(l),Cr(t.wbrels,-1,"persons/person.xml",ir.PEOPLE)),er(o,"[Content_Types].xml",q5(n,t)),er(o,"_rels/.rels",Uc(t.rels)),er(o,"xl/_rels/workbook."+r+".rels",Uc(t.wbrels)),delete t.revssf,delete t.ssf,o}function bb(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ha(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function UZ(e,t){return Pt.find(e,"EncryptedPackage")?IZ(e,t):YT(e,t)}function zZ(e,t){var r,s=e,n=t||{};return n.type||(n.type=ar&&Buffer.isBuffer(e)?"buffer":"base64"),r=y5(s,n),LZ(r,n)}function a6(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ev(e.slice(r),t);default:break e}return Qc.to_workbook(e,t)}function $Z(e,t){var r="",s=bb(e,t);switch(t.type){case"base64":r=Ha(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=xl(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=Pr(r)),t.type="binary",a6(r,t)}function qZ(e,t){var r=e;return t.type=="base64"&&(r=Ha(r)),r=Ud.utils.decode(1200,r.slice(2),"str"),t.type="binary",a6(r,t)}function HZ(e){return e.match(/[^\x00-\x7F]/)?Hn(e):e}function my(e,t,r,s){return s?(r.type="string",Qc.to_workbook(e,r)):Qc.to_workbook(t,r)}function wl(e,t){Pv();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return wl(new Uint8Array(e),(r=Kr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,n=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),$c={},r.dateNF&&($c.dateNF=r.dateNF),r.type||(r.type=ar&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ar?"buffer":"binary",s=Bz(e),typeof Uint8Array<"u"&&!ar&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,s=HZ(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=Kr(r),r.type="array",wl(Uv(s),r)}switch((n=bb(s,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return UZ(Pt.read(s,r),r);break;case 9:if(n[1]<=8)return YT(s,r);break;case 60:return ev(s,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return XH(s,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return mT.to_workbook(s,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?zZ(s,r):my(e,s,r,o);case 239:return n[3]===60?ev(s,r):my(e,s,r,o);case 255:if(n[1]===254)return qZ(s,r);if(n[1]===0&&n[2]===2&&n[3]===0)return ul.to_workbook(s,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return ul.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return Qy.to_workbook(s,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return wT.to_workbook(s,r);break;case 10:case 13:case 32:return $Z(s,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return KH.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Qy.to_workbook(s,r):my(e,s,r,o)}function n6(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ff(t.file,Pt.write(e,{type:ar?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Pt.write(e,t)}function WZ(e,t){var r=Kr(t||{}),s=MZ(e,r);return GZ(s,r)}function GZ(e,t){var r={},s=ar?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Pt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(vm(n))}return t.password&&typeof encrypt_agile<"u"?n6(encrypt_agile(n,t.password),t):t.type==="file"?ff(t.file,n):t.type=="string"?Pr(n):n}function VZ(e,t){var r=t||{},s=HJ(e,r);return n6(s,r)}function Bn(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return zd(Hn(s));case"binary":return Hn(s);case"string":return e;case"file":return ff(t.file,s,"utf8");case"buffer":return ar?Oi(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Bn(s,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function KZ(e,t){switch(t.type){case"base64":return zd(e);case"binary":return e;case"string":return e;case"file":return ff(t.file,e,"binary");case"buffer":return ar?Oi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function l0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?zd(r):t.type=="string"?Pr(r):r;case"file":return ff(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function i6(e,t){Pv(),UY(e);var r=Kr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=i6(e,r);return r.type="array",vm(s)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Bn(MJ(e,r),r);case"slk":case"sylk":return Bn(hT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return Bn(ZT(e.Sheets[e.SheetNames[n]],r),r);case"txt":return KZ(o6(e.Sheets[e.SheetNames[n]],r),r);case"csv":return Bn(wb(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return Bn(mT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return l0(Qy.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return Bn(Qc.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return Bn(wT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return Bn(pT.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return Bn(r6(e,r),r);case"wk1":return l0(ul.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return l0(ul.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),l0(JT(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),VZ(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return WZ(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function XZ(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function vo(e,t,r){var s=r||{};return s.type="file",s.file=t,XZ(s),i6(e,s)}function YZ(e,t,r,s,n,o,l,u){var d=xs(r),h=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,y=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!l||e[r])for(var b=t.s.c;b<=t.e.c;++b){var v=l?e[r][b]:e[s[b]+d];if(v===void 0||v.t===void 0){if(h===void 0)continue;o[b]!=null&&(y[o[b]]=h);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(o[b]!=null){if(g==null)if(v.t=="e"&&g===null)y[o[b]]=null;else if(h!==void 0)y[o[b]]=h;else if(m&&g===null)y[o[b]]=null;else continue;else y[o[b]]=m&&(v.t!=="n"||v.t==="n"&&u.rawNumbers!==!1)?g:ji(v,g,u);g!=null&&(x=!1)}}return{row:y,isempty:x}}function Z0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,o=[],l=0,u="",d={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},m=h.range!=null?h.range:e["!ref"];switch(h.header===1?s=1:h.header==="A"?s=2:Array.isArray(h.header)?s=3:h.header==null&&(s=0),typeof m){case"string":d=gr(m);break;case"number":d=gr(e["!ref"]),d.s.r=m;break;default:d=m}s>0&&(n=0);var x=xs(d.s.r),y=[],b=[],v=0,g=0,_=Array.isArray(e),w=d.s.r,S=0,N={};_&&!e[w]&&(e[w]=[]);var E=h.skipHidden&&e["!cols"]||[],C=h.skipHidden&&e["!rows"]||[];for(S=d.s.c;S<=d.e.c;++S)if(!(E[S]||{}).hidden)switch(y[S]=es(S),r=_?e[w][S]:e[y[S]+x],s){case 1:o[S]=S-d.s.c;break;case 2:o[S]=y[S];break;case 3:o[S]=h.header[S-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=ji(r,null,h),g=N[l]||0,!g)N[l]=1;else{do u=l+"_"+g++;while(N[u]);N[l]=g,N[u]=1}o[S]=u}for(w=d.s.r+n;w<=d.e.r;++w)if(!(C[w]||{}).hidden){var F=YZ(e,d,w,y,s,o,_,h);(F.isempty===!1||(s===1?h.blankrows!==!1:h.blankrows))&&(b[v++]=F.row)}return b.length=v,b}var H3=/"/g;function JZ(e,t,r,s,n,o,l,u){for(var d=!0,h=[],m="",x=xs(r),y=t.s.c;y<=t.e.c;++y)if(s[y]){var b=u.dense?(e[r]||[])[y]:e[s[y]+x];if(b==null)m="";else if(b.v!=null){d=!1,m=""+(u.rawNumbers&&b.t=="n"?b.v:ji(b,null,u));for(var v=0,g=0;v!==m.length;++v)if((g=m.charCodeAt(v))===n||g===o||g===34||u.forceQuotes){m='"'+m.replace(H3,'""')+'"';break}m=="ID"&&(m='"ID"')}else b.f!=null&&!b.F?(d=!1,m="="+b.f,m.indexOf(",")>=0&&(m='"'+m.replace(H3,'""')+'"')):m="";h.push(m)}return u.blankrows===!1&&d?null:h.join(l)}function wb(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var n=gr(e["!ref"]),o=s.FS!==void 0?s.FS:",",l=o.charCodeAt(0),u=s.RS!==void 0?s.RS:`
`,d=u.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),m="",x=[];s.dense=Array.isArray(e);for(var y=s.skipHidden&&e["!cols"]||[],b=s.skipHidden&&e["!rows"]||[],v=n.s.c;v<=n.e.c;++v)(y[v]||{}).hidden||(x[v]=es(v));for(var g=0,_=n.s.r;_<=n.e.r;++_)(b[_]||{}).hidden||(m=JZ(e,n,_,x,l,d,o,s),m!=null&&(s.strip&&(m=m.replace(h,"")),(m||s.blankrows!==!1)&&r.push((g++?u:"")+m)));return delete s.dense,r.join("")}function o6(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=wb(e,t);return r}function ZZ(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var n=gr(e["!ref"]),o="",l=[],u,d=[],h=Array.isArray(e);for(u=n.s.c;u<=n.e.c;++u)l[u]=es(u);for(var m=n.s.r;m<=n.e.r;++m)for(o=xs(m),u=n.s.c;u<=n.e.c;++u)if(t=l[u]+o,r=h?(e[m]||[])[u]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}d[d.length]=t+"="+s}return d}function l6(e,t,r){var s=r||{},n=+!s.skipHeader,o=e||{},l=0,u=0;if(o&&s.origin!=null)if(typeof s.origin=="number")l=s.origin;else{var d=typeof s.origin=="string"?ts(s.origin):s.origin;l=d.r,u=d.c}var h,m={s:{c:0,r:0},e:{c:u,r:l+t.length-1+n}};if(o["!ref"]){var x=gr(o["!ref"]);m.e.c=Math.max(m.e.c,x.e.c),m.e.r=Math.max(m.e.r,x.e.r),l==-1&&(l=x.e.r+1,m.e.r=l+t.length-1+n)}else l==-1&&(l=0,m.e.r=t.length-1+n);var y=s.header||[],b=0;t.forEach(function(g,_){cs(g).forEach(function(w){(b=y.indexOf(w))==-1&&(y[b=y.length]=w);var S=g[w],N="z",E="",C=Gt({c:u+b,r:l+_+n});h=Qd(o,C),S&&typeof S=="object"&&!(S instanceof Date)?o[C]=S:(typeof S=="number"?N="n":typeof S=="boolean"?N="b":typeof S=="string"?N="s":S instanceof Date?(N="d",s.cellDates||(N="n",S=Rs(S)),E=s.dateNF||Wt[14]):S===null&&s.nullError&&(N="e",S=0),h?(h.t=N,h.v=S,delete h.w,delete h.R,E&&(h.z=E)):o[C]=h={t:N,v:S},E&&(h.z=E))})}),m.e.c=Math.max(m.e.c,u+y.length-1);var v=xs(l);if(n)for(b=0;b<y.length;++b)o[es(b+u)+v]={t:"s",v:y[b]};return o["!ref"]=Zt(m),o}function QZ(e,t){return l6(null,e,t)}function Qd(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=ts(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Qd(e,Gt(t)):Qd(e,Gt({r:t,c:r||0}))}function eQ(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function _b(){return{SheetNames:[],Sheets:{}}}function Nb(e,t,r,s){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);n=o&&+o[2]||0;var l=o&&o[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=l+n)!=-1;++n);}if(WT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function tQ(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=eQ(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function rQ(e,t){return e.z=t,e}function c6(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function sQ(e,t,r){return c6(e,"#"+t,r)}function aQ(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function nQ(e,t,r,s){for(var n=typeof t!="string"?t:gr(t),o=typeof t=="string"?t:Zt(t),l=n.s.r;l<=n.e.r;++l)for(var u=n.s.c;u<=n.e.c;++u){var d=Qd(e,l,u);d.t="n",d.F=o,delete d.v,l==n.s.r&&u==n.s.c&&(d.f=r,s&&(d.D=!0))}return e}var Rr={encode_col:es,encode_row:xs,encode_cell:Gt,encode_range:Zt,decode_col:Zv,decode_row:Jv,split_cell:x$,decode_cell:ts,decode_range:Ta,format_cell:ji,sheet_add_aoa:I5,sheet_add_json:l6,sheet_add_dom:QT,aoa_to_sheet:lu,json_to_sheet:QZ,table_to_sheet:e6,table_to_book:fZ,sheet_to_csv:wb,sheet_to_txt:o6,sheet_to_json:Z0,sheet_to_html:ZT,sheet_to_formulae:ZZ,sheet_to_row_object_array:Z0,sheet_get_cell:Qd,book_new:_b,book_append_sheet:Nb,book_set_sheet_visibility:tQ,cell_set_number_format:rQ,cell_set_hyperlink:c6,cell_set_internal_link:sQ,cell_add_comment:aQ,sheet_set_array_formula:nQ,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const iQ=()=>{const{isAdmin:e,isSubAdmin:t,profile:r}=qr(),{labels:s,ledgerData:n,selectedLabel:o,loading:l,setSelectedLabel:u,addLabel:d,updateLabel:h,deleteLabel:m,addLedgerItem:x,updateLedgerItem:y,deleteLedgerItem:b,getNextRowNumber:v}=nz(),g=e||t||s.length===1||o?.name===r?.team,[_,w]=K.useState(!1),[S,N]=K.useState(!1),[E,C]=K.useState(!1),[F,O]=K.useState(null),[B,L]=K.useState(null),[H,ue]=K.useState("list"),[A,Y]=K.useState(null),[I,ae]=K.useState(""),[Q,re]=K.useState(null),[ve,te]=K.useState(""),ke=K.useRef(null),Z=K.useRef(null),[M,J]=K.useState(!1),[V,X]=K.useState(null),[se,P]=K.useState(!1),[U,ce]=K.useState(!1),[ne,ie]=K.useState({row_number:1,doc_number:"",content:"",receiver_org:"",receiver_date:"",sender_org:"",sender_date:"",note:""}),W=(De,ft)=>{g&&(re({id:De.id,field:ft}),te(De[ft]||""))},G=async()=>{if(!Q)return;const{id:De,field:ft}=Q,jt=n.find(vt=>vt.id===De);jt&&jt[ft]!==ve&&await y(De,{[ft]:ve}),re(null),te("")},k=()=>{re(null),te("")},de=De=>{De.key==="Enter"?G():De.key==="Escape"&&k()},z=async(De=!1)=>{if(!o)return;if(!ne.content.trim()&&!ne.doc_number.trim()){De||ce(!1);return}const ft={...ne,row_number:v(),label_id:o.id,created_by:r?.id};(await x(ft)).success&&(ie({row_number:v()+1,doc_number:"",content:"",receiver_org:"",receiver_date:"",sender_org:"",sender_date:"",note:""}),De||ce(!1))},T=(De,ft)=>{ie(jt=>({...jt,[De]:ft}))},R=(De,ft)=>{De.key==="Enter"?(De.preventDefault(),z(!0)):De.key==="Escape"&&(ne.content.trim()||ne.doc_number.trim()?z(!1):(ce(!1),ie({row_number:1,doc_number:"",content:"",receiver_org:"",receiver_date:"",sender_org:"",sender_date:"",note:""})))},q=De=>{O(De),N(!0)},me=async()=>{F&&(await b(F.id),N(!1),O(null))},_e=async()=>{if(!I.trim()){alert("  .");return}(await d(I.trim())).success&&(ae(""),ue("list"))},le=async()=>{if(!I.trim()||!A)return;(await h(A.id,I.trim())).success&&(ae(""),Y(null),ue("list"))},Ae=De=>{L(De),C(!0)},Me=async()=>{B&&(await m(B.id),C(!1),L(null))},Ee=async De=>{const ft=De.target.files?.[0];if(ft)try{J(!0);const jt=await ft.arrayBuffer(),vt=wl(jt),At=vt.SheetNames[0],Rt=vt.Sheets[At],Le=Rr.sheet_to_json(Rt,{header:1});let rt=-1;for(let oe=0;oe<Math.min(10,Le.length);oe++){const Ne=Le[oe];if(Ne&&Ne.some(xe=>xe&&String(xe).includes(""))){rt=oe;break}}if(rt===-1){alert("   . , ,    .");return}const ct=[];for(let oe=rt+2;oe<Le.length;oe++){const Ne=Le[oe];if(!Ne||Ne.length===0)continue;const xe=Ne[0];if(!xe||isNaN(Number(xe)))continue;const je=Ne[2];!je||String(je).trim()===""||ct.push({row_number:Number(xe),doc_number:Ne[1]?String(Ne[1]).trim():"",content:Ne[2]?String(Ne[2]).trim():"",receiver_org:Ne[3]?String(Ne[3]).trim():"",receiver_date:Ne[4]?String(Ne[4]).trim():"",sender_org:Ne[5]?String(Ne[5]).trim():"",sender_date:Ne[6]?String(Ne[6]).trim():"",note:Ne[7]?String(Ne[7]).trim():""})}if(ct.length===0){alert("  .");return}X(ct),P(!0)}catch(jt){console.error("  :",jt),alert("     .")}finally{J(!1),Z.current&&(Z.current.value="")}},Ce=async()=>{if(!(!V||!o)){J(!0);try{for(const De of V)await x({...De,label_id:o.id,created_by:r?.id});P(!1),X(null),alert(`${V.length}  .`)}catch(De){console.error("  :",De),alert("    .")}finally{J(!1)}}},Je=()=>{if(!o)return;const De=Rr.book_new(),ft=[...n].sort((Rt,Le)=>Rt.row_number-Le.row_number),jt=[[`${$e}  , `,null,null,null,null,null,null,null],[o.name,null,null,null,null,null,null,null],["","",""," ",null," ",null,""],[null,null,null,"","","","",null]];if(ft.length>0)ft.forEach(Rt=>{jt.push([String(Rt.row_number),Rt.doc_number||"",Rt.content||"",Rt.receiver_org||"",Rt.receiver_date||"",Rt.sender_org||"",Rt.sender_date||"",Rt.note||""])});else for(let Rt=1;Rt<=23;Rt++)jt.push([String(Rt),"","","","","","",""]);const vt=Rr.aoa_to_sheet(jt);vt["!merges"]=[{s:{r:0,c:0},e:{r:0,c:7}},{s:{r:1,c:0},e:{r:1,c:7}},{s:{r:2,c:0},e:{r:3,c:0}},{s:{r:2,c:1},e:{r:3,c:1}},{s:{r:2,c:2},e:{r:3,c:2}},{s:{r:2,c:3},e:{r:2,c:4}},{s:{r:2,c:5},e:{r:2,c:6}},{s:{r:2,c:7},e:{r:3,c:7}}];const At=jt.length;vt["!rows"]=[],vt["!rows"][0]={hpt:42,hpx:42},vt["!rows"][1]={hpt:42,hpx:42};for(let Rt=2;Rt<At;Rt++)vt["!rows"][Rt]={hpt:25.5,hpx:25.5};vt["!cols"]=[{wch:6},{wch:12},{wch:40},{wch:15},{wch:10},{wch:15},{wch:10},{wch:25}],Rr.book_append_sheet(De,vt,`${$e}`),vo(De,`${$e}__${o.name}.xls`,{bookType:"xls"})};K.useEffect(()=>{Q&&ke.current&&(ke.current.focus(),ke.current.select())},[Q]);const $e=new Date().getFullYear(),tt=({item:De,field:ft,className:jt="",align:vt="left"})=>Q?.id===De.id&&Q?.field===ft?a.jsx("input",{ref:ke,type:"text",value:ve,onChange:Rt=>te(Rt.target.value),onBlur:G,onKeyDown:de,className:`w-full px-2 py-1 bg-toss-blue/5 border border-toss-blue rounded text-sm focus:outline-none focus:ring-1 focus:ring-toss-blue ${vt==="center"?"text-center":""}`}):a.jsx("div",{onClick:()=>g&&W(De,ft),className:`px-2 py-1 min-h-[28px] ${g?"cursor-text hover:bg-toss-gray-50 rounded":""} ${jt} ${vt==="center"?"text-center":""}`,children:De[ft]||a.jsx("span",{className:"text-toss-gray-300",children:"-"})});return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(WE,{size:24})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold mb-1",children:"  "}),a.jsxs("p",{className:"text-white/90",children:[$e,""]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap",children:[g&&o&&a.jsxs(a.Fragment,{children:[a.jsx("input",{ref:Z,type:"file",accept:".xlsx,.xls",onChange:Ee,className:"hidden"}),a.jsxs(Ye,{onClick:()=>Z.current?.click(),disabled:M,className:"flex-1 sm:flex-none text-sm bg-white/20 hover:bg-white/30 text-white border-0",children:[a.jsx(Gn,{size:16}),a.jsx("span",{className:"hidden sm:inline",children:""})]}),a.jsxs(Ye,{onClick:Je,className:"flex-1 sm:flex-none text-sm bg-white/20 hover:bg-white/30 text-white border-0",children:[a.jsx(Jr,{size:16}),a.jsx("span",{className:"hidden sm:inline",children:""})]})]}),(e||t)&&a.jsxs(Ye,{onClick:()=>{ue("list"),ae(""),Y(null),w(!0)},className:"flex-1 sm:flex-none text-sm bg-white/20 hover:bg-white/30 text-white border-0",children:[a.jsx(Md,{size:16}),a.jsx("span",{className:"hidden sm:inline",children:" "})]})]})]})}),a.jsxs("div",{className:"flex items-center gap-2 border-b border-toss-gray-200",children:[s.map(De=>a.jsxs("button",{onClick:()=>u(De),className:`px-4 py-3 font-medium text-sm transition-colors relative ${o?.id===De.id?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[De.name,o?.id===De.id&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]},De.id)),s.length===0&&a.jsx("div",{className:"px-4 py-3 text-sm text-toss-gray-400",children:" "})]}),a.jsxs(_t,{padding:"p-0",className:"hidden lg:block",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[900px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-toss-gray-200 bg-toss-gray-50",children:[a.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-14",children:""}),a.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-24",children:""}),a.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-left min-w-[200px]",children:""}),a.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-28 bg-blue-50/50",children:" "}),a.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-20 bg-blue-50/50",children:""}),a.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-28 bg-green-50/50",children:" "}),a.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-20 bg-green-50/50",children:""}),a.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-left min-w-[120px]",children:""}),g&&a.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-12"})]})}),a.jsx("tbody",{className:"divide-y divide-toss-gray-100",children:l?a.jsx("tr",{children:a.jsx("td",{colSpan:g?9:8,className:"px-4 py-12 text-center text-toss-gray-500",children:" ..."})}):a.jsxs(a.Fragment,{children:[U&&g&&a.jsxs("tr",{className:"bg-toss-blue/5",children:[a.jsx("td",{className:"px-3 py-2 text-sm text-center text-toss-gray-400",children:v()}),a.jsx("td",{className:"px-1 py-1",children:a.jsx("input",{type:"text",value:ne.doc_number,onChange:De=>T("doc_number",De.target.value),onKeyDown:De=>R(De),placeholder:"",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),a.jsx("td",{className:"px-1 py-1",children:a.jsx("input",{type:"text",value:ne.content,onChange:De=>T("content",De.target.value),onKeyDown:De=>R(De),placeholder:"",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue",autoFocus:!0})}),a.jsx("td",{className:"px-1 py-1 bg-blue-50/30",children:a.jsx("input",{type:"text",value:ne.receiver_org,onChange:De=>T("receiver_org",De.target.value),onKeyDown:De=>R(De),placeholder:" ",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),a.jsx("td",{className:"px-1 py-1 bg-blue-50/30",children:a.jsx("input",{type:"text",value:ne.receiver_date,onChange:De=>T("receiver_date",De.target.value),onKeyDown:De=>R(De),placeholder:"0122",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),a.jsx("td",{className:"px-1 py-1 bg-green-50/30",children:a.jsx("input",{type:"text",value:ne.sender_org,onChange:De=>T("sender_org",De.target.value),onKeyDown:De=>R(De),placeholder:" ",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),a.jsx("td",{className:"px-1 py-1 bg-green-50/30",children:a.jsx("input",{type:"text",value:ne.sender_date,onChange:De=>T("sender_date",De.target.value),onKeyDown:De=>R(De),placeholder:"0105",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),a.jsx("td",{className:"px-1 py-1",children:a.jsx("input",{type:"text",value:ne.note,onChange:De=>T("note",De.target.value),onKeyDown:De=>R(De),placeholder:"",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),a.jsx("td",{className:"px-2 py-1",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>z(!0),className:"p-1 text-green-600 hover:bg-green-50 rounded-full transition-colors",title:"   (Enter)",children:a.jsx(R0,{size:14})}),a.jsx("button",{onClick:()=>{ne.content.trim()||ne.doc_number.trim()?z(!1):ce(!1)},className:"p-1 text-toss-gray-400 hover:bg-toss-gray-100 rounded-full transition-colors",title:" (Esc)",children:a.jsx(mr,{size:14})})]})})]}),[...n].sort((De,ft)=>ft.row_number-De.row_number).map(De=>a.jsxs("tr",{className:"hover:bg-toss-gray-50/50 transition-colors",children:[a.jsx("td",{className:"px-3 py-2 text-sm text-center text-toss-gray-500 font-medium",children:De.row_number}),a.jsx("td",{className:"px-1 py-1 text-sm",children:a.jsx(tt,{item:De,field:"doc_number",align:"center"})}),a.jsx("td",{className:"px-1 py-1 text-sm",children:a.jsx(tt,{item:De,field:"content"})}),a.jsx("td",{className:"px-1 py-1 text-sm bg-blue-50/30",children:a.jsx(tt,{item:De,field:"receiver_org",align:"center"})}),a.jsx("td",{className:"px-1 py-1 text-sm bg-blue-50/30",children:a.jsx(tt,{item:De,field:"receiver_date",align:"center"})}),a.jsx("td",{className:"px-1 py-1 text-sm bg-green-50/30",children:a.jsx(tt,{item:De,field:"sender_org",align:"center"})}),a.jsx("td",{className:"px-1 py-1 text-sm bg-green-50/30",children:a.jsx(tt,{item:De,field:"sender_date",align:"center"})}),a.jsx("td",{className:"px-1 py-1 text-sm",children:a.jsx(tt,{item:De,field:"note"})}),g&&a.jsx("td",{className:"px-2 py-1 text-center",children:a.jsx("button",{onClick:()=>q(De),className:"p-1.5 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors",children:a.jsx(Xt,{size:14})})})]},De.id)),n.length===0&&!U&&a.jsx("tr",{children:a.jsx("td",{colSpan:g?9:8,className:"px-4 py-12 text-center text-toss-gray-400",children:o?"  ":" "})})]})})]})}),o&&g&&!U&&a.jsx("div",{className:"border-t border-toss-gray-100",children:a.jsxs("button",{onClick:()=>ce(!0),className:"w-full px-4 py-3 text-sm text-toss-gray-500 hover:text-toss-blue hover:bg-toss-gray-50 transition-colors flex items-center justify-center gap-2",children:[a.jsx(os,{size:16}),"  "]})})]}),a.jsx("div",{className:"lg:hidden space-y-3",children:l?a.jsx(_t,{children:a.jsx("div",{className:"py-8 text-center text-toss-gray-500",children:" ..."})}):a.jsxs(a.Fragment,{children:[o&&g&&!U&&a.jsxs("button",{onClick:()=>ce(!0),className:"w-full p-4 bg-toss-gray-50 border-2 border-dashed border-toss-gray-200 rounded-xl text-toss-gray-500 hover:border-toss-blue hover:text-toss-blue transition-colors flex items-center justify-center gap-2",children:[a.jsx(os,{size:18}),"  "]}),U&&g&&a.jsx(_t,{children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"text-sm font-medium text-toss-gray-500",children:["#",v()]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>z(!0),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",children:a.jsx(R0,{size:18})}),a.jsx("button",{onClick:()=>{ne.content.trim()||ne.doc_number.trim()?z(!1):ce(!1)},className:"p-2 text-toss-gray-400 hover:bg-toss-gray-100 rounded-lg transition-colors",children:a.jsx(mr,{size:18})})]})]}),a.jsx("input",{type:"text",value:ne.content,onChange:De=>T("content",De.target.value),placeholder:"",className:"w-full px-3 py-2 text-sm bg-toss-gray-50 border-0 rounded-lg focus:ring-2 focus:ring-toss-blue",autoFocus:!0}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("input",{type:"text",value:ne.doc_number,onChange:De=>T("doc_number",De.target.value),placeholder:"",className:"px-3 py-2 text-sm bg-toss-gray-50 border-0 rounded-lg focus:ring-2 focus:ring-toss-blue"}),a.jsx("input",{type:"text",value:ne.note,onChange:De=>T("note",De.target.value),placeholder:"",className:"px-3 py-2 text-sm bg-toss-gray-50 border-0 rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs text-blue-600 font-medium",children:""}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:ne.receiver_org,onChange:De=>T("receiver_org",De.target.value),placeholder:"",className:"flex-1 px-2 py-1.5 text-sm bg-blue-50 border-0 rounded-lg focus:ring-2 focus:ring-blue-400"}),a.jsx("input",{type:"text",value:ne.receiver_date,onChange:De=>T("receiver_date",De.target.value),placeholder:"",className:"w-16 px-2 py-1.5 text-sm bg-blue-50 border-0 rounded-lg focus:ring-2 focus:ring-blue-400 text-center"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs text-green-600 font-medium",children:""}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("input",{type:"text",value:ne.sender_org,onChange:De=>T("sender_org",De.target.value),placeholder:"",className:"flex-1 px-2 py-1.5 text-sm bg-green-50 border-0 rounded-lg focus:ring-2 focus:ring-green-400"}),a.jsx("input",{type:"text",value:ne.sender_date,onChange:De=>T("sender_date",De.target.value),placeholder:"",className:"w-16 px-2 py-1.5 text-sm bg-green-50 border-0 rounded-lg focus:ring-2 focus:ring-green-400 text-center"})]})]})]})]})}),[...n].sort((De,ft)=>ft.row_number-De.row_number).map(De=>a.jsx(_t,{className:"relative",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"text-xs font-medium text-toss-gray-400",children:["#",De.row_number]}),De.doc_number&&a.jsx("span",{className:"text-xs px-2 py-0.5 bg-toss-gray-100 text-toss-gray-600 rounded-full",children:De.doc_number})]}),g&&a.jsx("button",{onClick:()=>q(De),className:"p-1.5 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:a.jsx(Xt,{size:16})})]}),a.jsx("p",{className:"text-sm font-medium text-toss-gray-900",children:De.content||a.jsx("span",{className:"text-toss-gray-300",children:" "})}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[(De.receiver_org||De.receiver_date)&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 rounded-lg",children:[a.jsx("span",{className:"font-medium",children:""}),De.receiver_org,De.receiver_date&&a.jsxs("span",{className:"text-blue-500",children:["(",De.receiver_date,")"]})]}),(De.sender_org||De.sender_date)&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-50 text-green-700 rounded-lg",children:[a.jsx("span",{className:"font-medium",children:""}),De.sender_org,De.sender_date&&a.jsxs("span",{className:"text-green-500",children:["(",De.sender_date,")"]})]})]}),De.note&&a.jsx("p",{className:"text-xs text-toss-gray-500 pt-1 border-t border-toss-gray-100",children:De.note})]})},De.id)),n.length===0&&!U&&a.jsx(_t,{children:a.jsx("div",{className:"py-8 text-center text-toss-gray-400",children:o?"  ":" "})})]})}),g&&a.jsx("p",{className:"text-xs text-toss-gray-400 text-center",children:"        Enter    , Esc "}),a.jsx(cr,{isOpen:_,onClose:()=>w(!1),title:" ",children:a.jsxs("div",{className:"space-y-4",children:[H==="list"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"space-y-2",children:s.length>0?s.map(De=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-toss",children:[a.jsx("span",{className:"font-medium text-toss-gray-900",children:De.name}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>{Y(De),ae(De.name),ue("edit")},className:"p-1 text-toss-gray-500 hover:bg-toss-gray-200 rounded",children:a.jsx(F0,{size:16})}),a.jsx("button",{onClick:()=>Ae(De),className:"p-1 text-red-500 hover:bg-red-50 rounded",children:a.jsx(Xt,{size:16})})]})]},De.id)):a.jsx("div",{className:"p-4 text-center text-toss-gray-500",children:"  "})}),a.jsxs(Ye,{onClick:()=>{ae(""),ue("add")},className:"w-full",children:[a.jsx(os,{size:18}),"  "]})]}),H==="add"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("input",{type:"text",value:I,onChange:De=>ae(De.target.value),onKeyDown:De=>De.key==="Enter"&&_e(),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue",placeholder:"  ",autoFocus:!0})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>ue("list"),className:"flex-1",children:""}),a.jsx(Ye,{onClick:_e,className:"flex-1",children:""})]})]}),H==="edit"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("input",{type:"text",value:I,onChange:De=>ae(De.target.value),onKeyDown:De=>De.key==="Enter"&&le(),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue",placeholder:"  ",autoFocus:!0})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{Y(null),ue("list")},className:"flex-1",children:""}),a.jsx(Ye,{onClick:le,className:"flex-1",children:""})]})]})]})}),a.jsx(cr,{isOpen:S,onClose:()=>{N(!1),O(null)},title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-toss-gray-700",children:"  ?"}),F&&a.jsxs("div",{className:"p-3 bg-toss-gray-50 rounded-toss text-sm",children:[a.jsx("p",{className:"font-medium text-toss-gray-900",children:F.content||"( )"}),F.doc_number&&a.jsxs("p",{className:"text-toss-gray-500 mt-1",children:[": ",F.doc_number]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{N(!1),O(null)},className:"flex-1",children:""}),a.jsx(Ye,{variant:"danger",onClick:me,className:"flex-1",children:""})]})]})}),a.jsx(cr,{isOpen:E,onClose:()=>{C(!1),L(null)},title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-toss-gray-700",children:[a.jsxs("span",{className:"font-medium text-toss-gray-900",children:['"',B?.name,'"']}),"  ?"]}),a.jsx("p",{className:"text-sm text-red-500",children:"      ."}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{C(!1),L(null)},className:"flex-1",children:""}),a.jsx(Ye,{variant:"danger",onClick:Me,className:"flex-1",children:""})]})]})}),a.jsx(cr,{isOpen:se,onClose:()=>{P(!1),X(null)},title:"  ",size:"xl",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-toss-gray-700",children:[a.jsxs("span",{className:"font-bold text-toss-blue",children:[V?.length||0,""]}),"  ."]}),a.jsx("div",{className:"max-h-[400px] overflow-auto border border-toss-gray-200 rounded-toss",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-toss-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""}),a.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""})]})}),a.jsx("tbody",{className:"divide-y divide-toss-gray-100",children:V?.map((De,ft)=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-2 py-2 text-toss-gray-500",children:De.row_number}),a.jsx("td",{className:"px-2 py-2",children:De.doc_number||"-"}),a.jsx("td",{className:"px-2 py-2 max-w-[200px] truncate",children:De.content}),a.jsx("td",{className:"px-2 py-2 text-toss-gray-500",children:De.receiver_org&&`${De.receiver_org} (${De.receiver_date||"-"})`}),a.jsx("td",{className:"px-2 py-2 text-toss-gray-500",children:De.sender_org&&`${De.sender_org} (${De.sender_date||"-"})`})]},ft))})]})}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{P(!1),X(null)},className:"flex-1",disabled:M,children:""}),a.jsx(Ye,{onClick:Ce,className:"flex-1",disabled:M,children:M?" ...":""})]})]})})]})};function oQ(){const{user:e,profile:t,isAdmin:r,isSubAdmin:s}=qr(),n=e?.user_id||t?.id,[o,l]=K.useState(null),[u,d]=K.useState(null),[h,m]=K.useState([]),[x,y]=K.useState([]),[b,v]=K.useState([]),[g,_]=K.useState([]),[w,S]=K.useState([]),[N,E]=K.useState([]),[C,F]=K.useState([]),[O,B]=K.useState(!1),[L,H]=K.useState(null),ue=new Date().getFullYear(),A=r||s,Y=K.useCallback(async()=>{if(n)try{let{data:G,error:k}=await Pe.from("annual_leaves").select("*").eq("user_id",n).eq("year",ue).single();if(k&&k.code==="PGRST116"){const{data:me,error:_e}=await Pe.from("annual_leaves").insert({user_id:n,year:ue,total_days:k0,used_days:0}).select().single();if(_e)throw _e;G=me}else if(k)throw k;const de=`${ue}-01-01`,z=`${ue}-12-31`,{data:T}=await Pe.from("leave_requests").select("days").eq("user_id",n).eq("status","approved").gte("start_date",de).lte("start_date",z).neq("leave_type","comp");let R=(T||[]).reduce((me,_e)=>me+(_e.days||0),0);const{data:q}=await Pe.from("document_labels").select("id").eq("code",yd).single();if(q){const{data:me}=await Pe.from("documents").select("leave_days").eq("drafter_id",n).eq("label_id",q.id).eq("attendance_type","leave").eq("status","approved").gte("leave_start_date",de).lte("leave_start_date",z).not("leave_type","is",null).neq("leave_type","comp");R+=(me||[]).reduce((_e,le)=>_e+(le.leave_days||0),0)}l({...G,used_days:R})}catch(G){console.error("   :",G),H(G.message)}},[n,ue]),I=K.useCallback(async()=>{if(n)try{const{data:G,error:k}=await Pe.from("comp_leaves").select("*").eq("user_id",n).eq("year",ue).single();if(k&&k.code!=="PGRST116")throw k;d(G||null)}catch(G){console.error("   :",G)}},[n,ue]),ae=K.useCallback(async()=>{if(n)try{const{data:G,error:k}=await Pe.from("leave_requests").select("*").eq("user_id",n).order("created_at",{ascending:!1});if(k)throw k;m(G||[])}catch(G){console.error("    :",G),H(G.message)}},[n]),Q=K.useCallback(async()=>{if(n)try{const{data:G,error:k}=await Pe.from("overtime_requests").select("*").eq("user_id",n).order("created_at",{ascending:!1});if(k)throw k;y(G||[])}catch(G){console.error("    :",G),H(G.message)}},[n]),re=K.useCallback(async(G=null)=>{if(A)try{let k=Pe.from("leave_requests").select("*").order("created_at",{ascending:!1});G&&(k=k.eq("status",G));const{data:de,error:z}=await k;if(z)throw z;v(de||[])}catch(k){console.error("    :",k),H(k.message)}},[A]),ve=K.useCallback(async(G=null)=>{if(A)try{let k=Pe.from("overtime_requests").select("*").order("created_at",{ascending:!1});G&&(k=k.eq("status",G));const{data:de,error:z}=await k;if(z)throw z;_(de||[])}catch(k){console.error("    :",k),H(k.message)}},[A]),te=K.useCallback(async()=>{if(A)try{const{data:G,error:k}=await Pe.from("users").select("id, name, team").order("name");if(k)throw k;E(G||[]);const{data:de,error:z}=await Pe.from("annual_leaves").select("*").eq("year",ue);if(z)throw z;const T=`${ue}-01-01`,R=`${ue}-12-31`,{data:q,error:me}=await Pe.from("leave_requests").select("user_id, days, leave_type").eq("status","approved").gte("start_date",T).lte("start_date",R).neq("leave_type","comp");if(me)throw me;const{data:_e}=await Pe.from("document_labels").select("id").eq("code",yd).single();let le=[];if(_e){const{data:Ce}=await Pe.from("documents").select("drafter_id, leave_days, leave_type").eq("label_id",_e.id).eq("attendance_type","leave").eq("status","approved").gte("leave_start_date",T).lte("leave_start_date",R).not("leave_type","is",null).neq("leave_type","comp");le=Ce||[]}const Ae={};(q||[]).forEach(Ce=>{Ae[Ce.user_id]=(Ae[Ce.user_id]||0)+(Ce.days||0)}),le.forEach(Ce=>{Ae[Ce.drafter_id]=(Ae[Ce.drafter_id]||0)+(Ce.leave_days||0)});const Me=(de||[]).map(Ce=>({...Ce,used_days:Ae[Ce.user_id]||Ce.used_days||0})),Ee=new Set((de||[]).map(Ce=>Ce.user_id));(G||[]).forEach(Ce=>{!Ee.has(Ce.id)&&Ae[Ce.id]&&Me.push({user_id:Ce.id,year:ue,total_days:k0,used_days:Ae[Ce.id]})}),S(Me)}catch(G){console.error("    :",G,G?.message,G?.code),H(G.message)}},[A,ue]),ke=async G=>{if(!n)return{success:!1,error:" ."};try{B(!0);let k=0;const de=G.leave_type;if(de==="full"||de==="comp"){const R=new Date(G.start_date),q=new Date(G.end_date);k=Math.ceil((q-R)/(1e3*60*60*24))+1}else k=Wy[de]||.5;if(de!=="comp"&&o){const R=o.total_days-o.used_days;if(k>R)return{success:!1,error:`  . (: ${R})`}}const{data:z,error:T}=await Pe.from("leave_requests").insert({user_id:n,leave_type:de,start_date:G.start_date,end_date:G.end_date||G.start_date,days:k,reason:G.reason,status:"pending"}).select().single();if(T)throw T;return await ae(),{success:!0,data:z}}catch(k){return console.error("  :",k),{success:!1,error:k.message}}finally{B(!1)}},Z=async G=>{try{B(!0);const{error:k}=await Pe.from("leave_requests").delete().eq("id",G).eq("user_id",n).eq("status","pending");if(k)throw k;return await ae(),{success:!0}}catch(k){return console.error("  :",k),{success:!1,error:k.message}}finally{B(!1)}},M=async G=>{if(!n)return{success:!1,error:" ."};try{B(!0);const{data:k,error:de}=await Pe.from("overtime_requests").insert({user_id:n,start_datetime:G.start_datetime,end_datetime:G.end_datetime,reason:G.reason,status:"pending"}).select().single();if(de)throw de;return await Q(),{success:!0,data:k}}catch(k){return console.error("  :",k),{success:!1,error:k.message}}finally{B(!1)}},J=async G=>{try{B(!0);const{error:k}=await Pe.from("overtime_requests").delete().eq("id",G).eq("user_id",n).eq("status","pending");if(k)throw k;return await Q(),{success:!0}}catch(k){return console.error("  :",k),{success:!1,error:k.message}}finally{B(!1)}},V=async G=>{if(!A)return{success:!1,error:" ."};try{B(!0);const{data:k,error:de}=await Pe.from("leave_requests").select("*").eq("id",G).single();if(de)throw de;const{error:z}=await Pe.from("leave_requests").update({status:"approved",approved_by:n,updated_at:new Date().toISOString()}).eq("id",G);if(z)throw z;if(k.leave_type==="comp"){const T=k.days*8,{data:R}=await Pe.from("comp_leaves").select("*").eq("user_id",k.user_id).eq("year",ue).single();R&&await Pe.from("comp_leaves").update({used_hours:R.used_hours+T,updated_at:new Date().toISOString()}).eq("id",R.id)}else{const{data:T}=await Pe.from("annual_leaves").select("*").eq("user_id",k.user_id).eq("year",ue).single();T?await Pe.from("annual_leaves").update({used_days:T.used_days+k.days,updated_at:new Date().toISOString()}).eq("id",T.id):await Pe.from("annual_leaves").insert({user_id:k.user_id,year:ue,total_days:k0,used_days:k.days})}return await re(),await te(),{success:!0}}catch(k){return console.error("  :",k),{success:!1,error:k.message}}finally{B(!1)}},X=async(G,k)=>{if(!A)return{success:!1,error:" ."};try{B(!0);const{error:de}=await Pe.from("leave_requests").update({status:"rejected",rejected_reason:k,approved_by:n,updated_at:new Date().toISOString()}).eq("id",G);if(de)throw de;return await re(),{success:!0}}catch(de){return console.error("  :",de),{success:!1,error:de.message}}finally{B(!1)}},se=async G=>{if(!A)return{success:!1,error:" ."};try{B(!0);const{error:k}=await Pe.from("overtime_requests").update({status:"approved",approved_by:n,approved_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",G);if(k)throw k;return await ve(),{success:!0}}catch(k){return console.error("  :",k),{success:!1,error:k.message}}finally{B(!1)}},P=async(G,k)=>{if(!A)return{success:!1,error:" ."};try{B(!0);const{error:de}=await Pe.from("overtime_requests").update({status:"rejected",rejected_reason:k,approved_by:n,updated_at:new Date().toISOString()}).eq("id",G);if(de)throw de;return await ve(),{success:!0}}catch(de){return console.error("  :",de),{success:!1,error:de.message}}finally{B(!1)}},U=async(G,k)=>{if(!A)return{success:!1,error:" ."};try{B(!0);const{data:de,error:z}=await Pe.from("annual_leaves").upsert({user_id:G,year:ue,total_days:k,updated_at:new Date().toISOString()},{onConflict:"user_id,year"}).select().single();if(z)throw z;return await te(),{success:!0,data:de}}catch(de){return console.error("  :",de),{success:!1,error:de.message}}finally{B(!1)}},ce=K.useCallback(async(G,k)=>{try{const de=new Date(G,k,1).toISOString().split("T")[0],z=new Date(G,k+1,0).toISOString().split("T")[0],{data:T,error:R}=await Pe.from("leave_requests").select("*").eq("status","approved").or(`start_date.lte.${z},end_date.gte.${de}`);if(R)throw R;const q=[...new Set((T||[]).map(Ae=>Ae.user_id))],{data:me}=await Pe.from("users").select("id, name, team").in("id",q),_e={};return(me||[]).forEach(Ae=>{_e[Ae.id]=Ae}),(T||[]).map(Ae=>({...Ae,user:_e[Ae.user_id]}))}catch(de){return console.error("   :",de),[]}},[]),ne=K.useCallback(async(G=null)=>{if(A)try{const{data:k}=await Pe.from("document_labels").select("id").eq("code",yd).single();if(!k)return;let de=Pe.from("documents").select("*, drafter:drafter_id(name, team, position)").eq("label_id",k.id).eq("attendance_type","leave").not("leave_type","is",null).order("created_at",{ascending:!1});G==="pending"?de=de.eq("status","pending"):G==="approved"?de=de.eq("status","approved"):G==="rejected"&&(de=de.eq("status","rejected"));const{data:z,error:T}=await de;if(T)throw T;F(z||[])}catch(k){console.error("   :",k),H(k.message)}},[A]),ie=async G=>{if(!A)return{success:!1,error:" ."};try{B(!0);const{error:k}=await Pe.from("documents").update({status:"approved",approved_by:n,approved_at:new Date().toISOString()}).eq("id",G);if(k)throw k;return await ne(),{success:!0}}catch(k){return console.error("   :",k),{success:!1,error:k.message}}finally{B(!1)}},W=async(G,k)=>{if(!A)return{success:!1,error:" ."};try{B(!0);const{error:de}=await Pe.from("documents").update({status:"rejected",approved_by:n,approved_at:new Date().toISOString(),rejected_reason:k}).eq("id",G);if(de)throw de;return await ne(),{success:!0}}catch(de){return console.error("   :",de),{success:!1,error:de.message}}finally{B(!1)}};return K.useEffect(()=>{n&&(Y(),I(),ae(),Q(),A&&(re(),ve(),te(),ne()))},[n,A,Y,I,ae,Q,re,ve,te,ne]),{annualLeave:o,compLeave:u,myRequests:h,myOvertimeRequests:x,allRequests:b,allOvertimeRequests:g,allAnnualLeaves:w,allUsers:N,documentLeaves:C,loading:O,error:L,canManage:A,currentYear:ue,fetchAnnualLeave:Y,fetchMyRequests:ae,createRequest:ke,cancelRequest:Z,fetchMyOvertimeRequests:Q,createOvertimeRequest:M,cancelOvertimeRequest:J,fetchAllRequests:re,fetchAllOvertimeRequests:ve,fetchAllAnnualLeaves:te,approveRequest:V,rejectRequest:X,approveOvertimeRequest:se,rejectOvertimeRequest:P,updateUserLeave:U,fetchDocumentLeaves:ne,approveDocumentLeave:ie,rejectDocumentLeave:W,fetchApprovedLeaves:ce}}const c0={full:{label:"",days:1},half_am:{label:" ",days:.5},half_pm:{label:" ",days:.5},out_1h:{label:"/ 1",days:.125},out_2h:{label:"/ 2",days:.25},out_3h:{label:"/ 3",days:.375},comp:{label:"",days:1}},lQ=()=>{const{annualLeave:e,compLeave:t,myRequests:r,myOvertimeRequests:s,allRequests:n,allOvertimeRequests:o,allAnnualLeaves:l,allUsers:u,documentLeaves:d,loading:h,canManage:m,currentYear:x,createRequest:y,cancelRequest:b,createOvertimeRequest:v,cancelOvertimeRequest:g,approveRequest:_,rejectRequest:w,approveOvertimeRequest:S,rejectOvertimeRequest:N,updateUserLeave:E,fetchApprovedLeaves:C,fetchAllRequests:F,fetchAllOvertimeRequests:O,fetchAllAnnualLeaves:B,fetchDocumentLeaves:L,approveDocumentLeave:H,rejectDocumentLeave:ue}=oQ(),[A,Y]=K.useState("my"),[I,ae]=K.useState(!1),[Q,re]=K.useState("leave"),[ve,te]=K.useState({leave_type:"full",start_date:"",end_date:"",reason:""}),[ke,Z]=K.useState({start_date:"",start_time:"",end_date:"",end_time:"",reason:""}),[M,J]=K.useState(!1),[V,X]=K.useState(null),[se,P]=K.useState(""),[U,ce]=K.useState(!1),[ne,ie]=K.useState(null),[W,G]=K.useState(15),[k,de]=K.useState(new Date),[z,T]=K.useState([]),[R,q]=K.useState("pending"),[me,_e]=K.useState(""),le=(e?.total_days||15)-(e?.used_days||0),Ae=t?Math.floor((t.total_hours-t.used_hours)/8):0,Me=K.useMemo(()=>{const oe={};return u.forEach(Ne=>{oe[Ne.id]=Ne}),oe},[u]),Ee=(oe,Ne,xe)=>{if(!Ne)return 0;if(c0[oe]&&oe!=="full"&&oe!=="comp")return c0[oe].days;if(!xe)return 1;const je=new Date(Ne),fe=new Date(xe),Oe=Math.abs(fe-je);return Math.ceil(Oe/(1e3*60*60*24))+1},Ce=async()=>{if(!ve.start_date){alert(" .");return}const oe=Ee(ve.leave_type,ve.start_date,["full","comp"].includes(ve.leave_type)?ve.end_date:ve.start_date);if(ve.leave_type!=="comp"&&oe>le){alert(`  . (: ${le})`);return}const Ne=await y({...ve,end_date:["full","comp"].includes(ve.leave_type)&&ve.end_date||ve.start_date,days:oe});Ne.success?(ae(!1),te({leave_type:"full",start_date:"",end_date:"",reason:""}),re("leave"),alert(" .")):alert(" : "+Ne.error)},Je=async()=>{if(!ke.start_date||!ke.start_time){alert("   .");return}if(!ke.end_date||!ke.end_time){alert("   .");return}if(!ke.reason.trim()){alert(" .");return}const oe=`${ke.start_date}T${ke.start_time}:00`,Ne=`${ke.end_date}T${ke.end_time}:00`;if(new Date(Ne)<=new Date(oe)){alert("     .");return}const xe=await v({start_datetime:oe,end_datetime:Ne,reason:ke.reason});xe.success?(ae(!1),Z({start_date:"",start_time:"",end_date:"",end_time:"",reason:""}),re("leave"),alert("  .")):alert(" : "+xe.error)},$e=async oe=>{if(!confirm(" ?"))return;const Ne=await g(oe);Ne.success||alert(" : "+Ne.error)},tt=async oe=>{const Ne=await S(oe);Ne.success||alert(" : "+Ne.error)},De=async oe=>{if(!confirm(" ?"))return;const Ne=await b(oe);Ne.success||alert(" : "+Ne.error)},ft=async oe=>{const Ne=await _(oe);Ne.success||alert(" : "+Ne.error)},jt=async()=>{if(!V)return;let oe;V.isDocument?oe=await ue(V.id,se):V.isOvertime?oe=await N(V.id,se):oe=await w(V.id,se),oe.success?(J(!1),X(null),P("")):alert(" : "+oe.error)},vt=async oe=>{const Ne=await H(oe);Ne.success||alert(" : "+Ne.error)},At=async()=>{if(!ne)return;const oe=await E(ne.id,parseFloat(W));oe.success?ie(null):alert(" : "+oe.error)};K.useEffect(()=>{(async()=>{const Ne=await C(k.getFullYear(),k.getMonth());T(Ne)})()},[k,C]),K.useEffect(()=>{m&&A==="manage"&&(F(R==="all"?null:R),O(R==="all"?null:R),L(R==="all"?null:R))},[R,A,m,F,O,L]),K.useEffect(()=>{m&&A==="settings"&&B()},[A,m,B]);const Rt=oe=>{switch(oe){case"pending":return{text:"",color:"bg-yellow-100 text-yellow-700"};case"approved":return{text:"",color:"bg-green-100 text-green-700"};case"rejected":return{text:"",color:"bg-red-100 text-red-700"};default:return{text:oe,color:"bg-gray-100 text-gray-700"}}},Le=oe=>c0[oe]?.label||oe,rt=()=>{const oe=k.getFullYear(),Ne=k.getMonth(),xe=new Date(oe,Ne,1).getDay(),je=new Date(oe,Ne+1,0).getDate(),fe=[],Oe=[];for(let st=0;st<xe;st++)fe.push(null);for(let st=1;st<=je;st++)fe.push(st);for(let st=0;st<fe.length;st+=7)Oe.push(fe.slice(st,st+7));const Ue=st=>{if(!st)return[];const pt=`${oe}-${String(Ne+1).padStart(2,"0")}-${String(st).padStart(2,"0")}`;return z.filter(Nt=>pt>=Nt.start_date&&pt<=Nt.end_date)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("button",{onClick:()=>de(new Date(oe,Ne-1,1)),className:"p-2 hover:bg-toss-gray-100 rounded-full",children:a.jsx(xa,{size:20})}),a.jsxs("h3",{className:"text-lg font-bold text-toss-gray-900",children:[oe," ",Ne+1,""]}),a.jsx("button",{onClick:()=>de(new Date(oe,Ne+1,1)),className:"p-2 hover:bg-toss-gray-100 rounded-full",children:a.jsx(Js,{size:20})})]}),a.jsxs("div",{className:"border border-toss-gray-200 rounded-toss overflow-hidden",children:[a.jsx("div",{className:"grid grid-cols-7 bg-toss-gray-50",children:["","","","","","",""].map((st,pt)=>a.jsx("div",{className:`p-2 text-center text-sm font-medium ${pt===0?"text-red-500":pt===6?"text-blue-500":"text-toss-gray-600"}`,children:st},st))}),a.jsx("div",{className:"divide-y divide-toss-gray-100",children:Oe.map((st,pt)=>a.jsx("div",{className:"grid grid-cols-7 divide-x divide-toss-gray-100",children:st.map((Nt,Vt)=>{const yr=Ue(Nt),_r=Nt&&new Date().toDateString()===new Date(oe,Ne,Nt).toDateString();return a.jsx("div",{className:`min-h-[80px] p-1 ${Nt?"":"bg-toss-gray-50"}`,children:Nt&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`text-sm font-medium mb-1 ${Vt===0?"text-red-500":Vt===6?"text-blue-500":"text-toss-gray-700"} ${_r?"bg-toss-blue text-white w-6 h-6 rounded-full flex items-center justify-center":""}`,children:Nt}),a.jsxs("div",{className:"space-y-0.5",children:[yr.slice(0,3).map((zt,fr)=>a.jsx("div",{className:`text-xs px-1 py-0.5 rounded truncate ${zt.leave_type==="full"?"bg-toss-blue/10 text-toss-blue":zt.leave_type==="half_am"||zt.leave_type==="am"?"bg-orange-100 text-orange-700":"bg-purple-100 text-purple-700"}`,title:`${zt.user?.name} ${Le(zt.leave_type)}`,children:zt.user?.name},fr)),yr.length>3&&a.jsxs("div",{className:"text-xs text-toss-gray-400",children:["+",yr.length-3,""]})]})]})},Vt)})},pt))})]})]})},ct=()=>{const oe=n.map(je=>{const fe=Me[je.user_id];return{...je,_source:"leave_requests",_type:"leave",_sortDate:new Date(je.created_at),_name:fe?.name||"  ",_team:fe?.team,_position:fe?.position}}),Ne=o.map(je=>{const fe=Me[je.user_id],Oe=new Date(je.start_datetime),Ue=new Date(je.end_datetime),st=(Ue-Oe)/(1e3*60*60),pt=Math.floor(st),Nt=Math.round((st-pt)*60);return{...je,_source:"overtime_requests",_type:"overtime",_sortDate:new Date(je.created_at),_name:fe?.name||"  ",_team:fe?.team,_position:fe?.position,_overtimeHours:Nt>0?`${pt} ${Nt}`:`${pt}`,_startDt:Oe,_endDt:Ue}}),xe=d.map(je=>({...je,_source:"document",_type:"leave",_sortDate:new Date(je.created_at),_name:je.drafter?.name,_team:je.drafter?.team,_position:je.drafter?.position,leave_type:je.leave_type,days:je.leave_days,start_date:je.leave_start_date,end_date:je.leave_end_date,reason:je.content||je.title}));return[...oe,...Ne,...xe].sort((je,fe)=>fe._sortDate-je._sortDate)};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),a.jsxs("p",{className:"text-toss-gray-500 mt-1",children:[x,""]})]}),A==="my"&&a.jsxs(Ye,{onClick:()=>ae(!0),children:[a.jsx(os,{size:18}),""]})]}),A==="my"&&e&&a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs(_t,{className:"text-center",children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:" "}),a.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[e.total_days,""]})]}),a.jsxs(_t,{className:"text-center",children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsxs("p",{className:"text-2xl font-bold text-toss-blue",children:[e.used_days,""]})]}),a.jsxs(_t,{className:"text-center",children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),a.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[e.total_days-e.used_days,""]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 border-b border-toss-gray-200",children:[a.jsxs("button",{onClick:()=>Y("my"),className:`px-4 py-3 font-medium text-sm transition-colors relative ${A==="my"?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[a.jsx(ra,{size:16,className:"inline mr-1"})," ",A==="my"&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]}),a.jsxs("button",{onClick:()=>Y("calendar"),className:`px-4 py-3 font-medium text-sm transition-colors relative ${A==="calendar"?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[a.jsx(ma,{size:16,className:"inline mr-1"}),"",A==="calendar"&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]}),m&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>Y("manage"),className:`px-4 py-3 font-medium text-sm transition-colors relative ${A==="manage"?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[a.jsx(Gc,{size:16,className:"inline mr-1"})," ",A==="manage"&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]}),a.jsxs("button",{onClick:()=>Y("settings"),className:`px-4 py-3 font-medium text-sm transition-colors relative ${A==="settings"?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[a.jsx(_l,{size:16,className:"inline mr-1"})," ",A==="settings"&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]})]})]}),A==="my"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs(_t,{padding:"p-0",children:[a.jsx("div",{className:"p-4 border-b border-toss-gray-100",children:a.jsx("h3",{className:"font-medium text-toss-gray-900",children:"  "})}),r.length>0?a.jsx("div",{className:"divide-y divide-toss-gray-100",children:r.map(oe=>{const Ne=Rt(oe.status);return a.jsx("div",{className:"p-4",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Ne.color}`,children:Ne.text}),a.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:Le(oe.leave_type)}),a.jsxs("span",{className:"text-sm text-toss-gray-500",children:[oe.days,""]})]}),a.jsx("p",{className:"text-sm text-toss-gray-700",children:oe.start_date===oe.end_date?oe.start_date:`${oe.start_date} ~ ${oe.end_date}`}),oe.reason&&a.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:oe.reason}),oe.status==="rejected"&&oe.rejected_reason&&a.jsxs("p",{className:"text-sm text-red-500 mt-1",children:[" : ",oe.rejected_reason]})]}),oe.status==="pending"&&a.jsx("button",{onClick:()=>De(oe.id),className:"text-sm text-red-500 hover:underline",children:""})]})},oe.id)})}):a.jsx("div",{className:"p-8 text-center text-toss-gray-400",children:"   "})]}),a.jsxs(_t,{padding:"p-0",children:[a.jsx("div",{className:"p-4 border-b border-toss-gray-100",children:a.jsx("h3",{className:"font-medium text-toss-gray-900",children:"  "})}),s.length>0?a.jsx("div",{className:"divide-y divide-toss-gray-100",children:s.map(oe=>{const Ne=Rt(oe.status),xe=new Date(oe.start_datetime),je=new Date(oe.end_datetime),fe=(je-xe)/(1e3*60*60),Oe=Math.floor(fe),Ue=Math.round((fe-Oe)*60);return a.jsx("div",{className:"p-4",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Ne.color}`,children:Ne.text}),a.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:""}),a.jsx("span",{className:"text-sm text-toss-gray-500",children:Ue>0?`${Oe} ${Ue}`:`${Oe}`})]}),a.jsxs("p",{className:"text-sm text-toss-gray-700",children:[xe.toLocaleDateString("ko-KR")," ",xe.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})," ~"," ",je.toLocaleDateString("ko-KR")," ",je.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})]}),oe.reason&&a.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:oe.reason}),oe.status==="rejected"&&oe.rejected_reason&&a.jsxs("p",{className:"text-sm text-red-500 mt-1",children:[" : ",oe.rejected_reason]})]}),oe.status==="pending"&&a.jsx("button",{onClick:()=>$e(oe.id),className:"text-sm text-red-500 hover:underline",children:""})]})},oe.id)})}):a.jsx("div",{className:"p-8 text-center text-toss-gray-400",children:"   "})]})]}),A==="calendar"&&a.jsx(_t,{children:rt()}),A==="manage"&&m&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex gap-2",children:["pending","approved","rejected","all"].map(oe=>a.jsx("button",{onClick:()=>q(oe),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${R===oe?"bg-toss-blue text-white":"bg-toss-gray-100 text-toss-gray-600 hover:bg-toss-gray-200"}`,children:oe==="pending"?"":oe==="approved"?"":oe==="rejected"?"":""},oe))}),a.jsx(_t,{padding:"p-0",children:ct().length>0?a.jsx("div",{className:"divide-y divide-toss-gray-100",children:ct().map(oe=>{const Ne=Rt(oe.status),xe=oe._source==="document",je=oe._source==="overtime_requests";return a.jsx("div",{className:"p-4",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"font-medium text-toss-gray-900",children:oe._name}),a.jsxs("span",{className:"text-sm text-toss-gray-500",children:[oe._team," ",oe._position]}),a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Ne.color}`,children:Ne.text}),xe&&a.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700",children:""}),je&&a.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-700",children:""})]}),je?a.jsx(a.Fragment,{children:a.jsxs("p",{className:"text-sm text-toss-gray-700",children:[" ",oe._overtimeHours," "," ",oe._startDt.toLocaleDateString("ko-KR")," ",oe._startDt.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})," ~"," ",oe._endDt.toLocaleDateString("ko-KR")," ",oe._endDt.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})]})}):a.jsxs("p",{className:"text-sm text-toss-gray-700",children:[Le(oe.leave_type)," ",oe.days," "," ",oe.start_date===oe.end_date?oe.start_date:`${oe.start_date} ~ ${oe.end_date}`]}),oe.reason&&a.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:oe.reason}),oe.status==="rejected"&&oe.rejected_reason&&a.jsxs("p",{className:"text-sm text-red-500 mt-1",children:[" : ",oe.rejected_reason]})]}),oe.status==="pending"?a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{xe?vt(oe.id):je?tt(oe.id):ft(oe.id)},className:"p-2 text-green-600 hover:bg-green-50 rounded-full",children:a.jsx(R0,{size:18})}),a.jsx("button",{onClick:()=>{X({...oe,isDocument:xe,isOvertime:je}),J(!0)},className:"p-2 text-red-500 hover:bg-red-50 rounded-full",children:a.jsx(mr,{size:18})})]}):a.jsxs("span",{className:"text-xs text-toss-gray-400",children:[oe.approved_at&&new Date(oe.approved_at).toLocaleDateString("ko-KR"),oe.updated_at&&!oe.approved_at&&new Date(oe.updated_at).toLocaleDateString("ko-KR")]})]})},`${oe._source}-${oe.id}`)})}):a.jsx("div",{className:"p-8 text-center text-toss-gray-400",children:"  "})})]}),A==="settings"&&m&&a.jsxs(_t,{padding:"p-0",children:[a.jsxs("div",{className:"p-4 border-b border-toss-gray-100 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Gc,{size:18,className:"text-toss-gray-500"}),a.jsx("h3",{className:"font-medium text-toss-gray-900",children:"  "})]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"   ",value:me,onChange:oe=>_e(oe.target.value),className:"pl-9 pr-4 py-2 bg-toss-gray-100 border-0 rounded-toss text-sm focus:ring-2 focus:ring-toss-blue w-56"}),a.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-toss-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-toss-gray-100",children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:""}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:""}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:" "}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:""}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:""})]})}),a.jsx("tbody",{className:"divide-y divide-toss-gray-100",children:u.filter(oe=>{if(!me)return!0;const Ne=me.toLowerCase();return oe.name?.toLowerCase().includes(Ne)||oe.team?.toLowerCase().includes(Ne)}).map(oe=>{const Ne=l.find(Ue=>Ue.user_id===oe.id),xe=Ne?.total_days??15,je=Ne?.used_days??0,fe=xe-je,Oe=ne?.id===oe.id;return a.jsxs("tr",{className:"hover:bg-toss-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("p",{className:"font-medium text-toss-gray-900",children:oe.name})}),a.jsx("td",{className:"px-6 py-3 text-sm text-toss-gray-700",children:oe.team||"-"}),a.jsx("td",{className:"px-6 py-3 text-center",children:Oe?a.jsx("input",{type:"number",value:W,onChange:Ue=>G(Ue.target.value),onBlur:async()=>{await At()},onKeyDown:async Ue=>{Ue.key==="Enter"?await At():Ue.key==="Escape"&&ie(null)},min:0,step:.5,className:"w-16 px-2 py-1 text-center bg-white border border-toss-blue rounded text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue",autoFocus:!0}):a.jsxs("span",{onClick:()=>{ie(oe),G(xe)},className:"cursor-pointer hover:text-toss-blue font-medium",children:[xe,""]})}),a.jsxs("td",{className:"px-6 py-3 text-center text-sm text-toss-blue font-medium",children:[je,""]}),a.jsxs("td",{className:"px-6 py-3 text-center text-sm text-green-600 font-bold",children:[fe,""]})]},oe.id)})})]})})]}),a.jsx(cr,{isOpen:I,onClose:()=>{ae(!1),re("leave"),te({leave_type:"full",start_date:"",end_date:"",reason:""})},title:" ",size:"lg",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("button",{onClick:()=>re("overtime"),className:`p-4 rounded-toss border-2 text-left transition-all ${Q==="overtime"?"border-toss-blue bg-toss-blue/5":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(ra,{size:20,className:Q==="overtime"?"text-toss-blue":"text-toss-gray-400"}),a.jsx("span",{className:`font-medium ${Q==="overtime"?"text-toss-blue":"text-toss-gray-700"}`,children:" "})]}),a.jsx("p",{className:"text-xs text-toss-gray-500",children:",  "})]}),a.jsxs("button",{onClick:()=>re("leave"),className:`p-4 rounded-toss border-2 text-left transition-all ${Q==="leave"?"border-toss-blue bg-toss-blue/5":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(ma,{size:20,className:Q==="leave"?"text-toss-blue":"text-toss-gray-400"}),a.jsx("span",{className:`font-medium ${Q==="leave"?"text-toss-blue":"text-toss-gray-700"}`,children:" "})]}),a.jsx("p",{className:"text-xs text-toss-gray-500",children:", , "})]})]})]}),Q==="leave"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex gap-4 p-3 bg-toss-gray-50 rounded-toss",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-toss-gray-500",children:" : "}),a.jsxs("span",{className:"font-bold text-toss-blue",children:[le,""]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-toss-gray-500",children:" : "}),a.jsxs("span",{className:"font-bold text-toss-gray-700",children:[Ae,""]})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.entries(c0).map(([oe,Ne])=>{const xe=oe==="comp"&&Ae===0;return a.jsxs("button",{onClick:()=>!xe&&te({...ve,leave_type:oe}),disabled:xe,className:`p-3 rounded-toss border text-left transition-all ${ve.leave_type===oe?"border-toss-blue bg-toss-blue/5":xe?"border-toss-gray-100 bg-toss-gray-50 cursor-not-allowed":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[a.jsx("p",{className:`font-medium text-sm ${ve.leave_type===oe?"text-toss-blue":xe?"text-toss-gray-400":"text-toss-gray-700"}`,children:Ne.label}),a.jsx("p",{className:`text-xs mt-0.5 ${xe?"text-toss-gray-300":"text-toss-gray-500"}`,children:oe==="comp"&&xe?" ":`${Ne.days} `})]},oe)})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:[["full","comp"].includes(ve.leave_type)?"":""," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",value:ve.start_date,onChange:oe=>te({...ve,start_date:oe.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]}),["full","comp"].includes(ve.leave_type)&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),a.jsx("input",{type:"date",value:ve.end_date,onChange:oe=>te({...ve,end_date:oe.target.value}),min:ve.start_date,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" ()"}),a.jsx("textarea",{value:ve.reason,onChange:oe=>te({...ve,reason:oe.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:" "})]}),ve.start_date&&a.jsx("div",{className:"p-3 bg-toss-blue/5 rounded-toss border border-toss-blue/20",children:a.jsxs("p",{className:"text-sm text-toss-gray-700",children:[" :"," ",a.jsxs("span",{className:"font-bold text-toss-blue",children:[Ee(ve.leave_type,ve.start_date,["full","comp"].includes(ve.leave_type)?ve.end_date:ve.start_date),""]})]})})]}),Q==="overtime"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsx("input",{type:"date",value:ke.start_date,onChange:oe=>Z({...ke,start_date:oe.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"}),a.jsx("input",{type:"time",value:ke.start_time,onChange:oe=>Z({...ke,start_time:oe.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsx("input",{type:"date",value:ke.end_date,onChange:oe=>Z({...ke,end_date:oe.target.value}),min:ke.start_date,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"}),a.jsx("input",{type:"time",value:ke.end_time,onChange:oe=>Z({...ke,end_time:oe.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:[" ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{value:ke.reason,onChange:oe=>Z({...ke,reason:oe.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:"  "})]}),ke.start_date&&ke.start_time&&ke.end_date&&ke.end_time&&a.jsx("div",{className:"p-3 bg-toss-blue/5 rounded-toss border border-toss-blue/20",children:a.jsxs("p",{className:"text-sm text-toss-gray-700",children:[" :"," ",a.jsx("span",{className:"font-bold text-toss-blue",children:(()=>{const oe=new Date(`${ke.start_date}T${ke.start_time}`),xe=(new Date(`${ke.end_date}T${ke.end_time}`)-oe)/(1e3*60*60);if(xe>0){const je=Math.floor(xe),fe=Math.round((xe-je)*60);return fe>0?`${je} ${fe}`:`${je}`}return"0"})()})]})})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{ae(!1),re("leave"),te({leave_type:"full",start_date:"",end_date:"",reason:""}),Z({start_date:"",start_time:"",end_date:"",end_time:"",reason:""})},className:"flex-1",children:""}),a.jsx(Ye,{onClick:Q==="overtime"?Je:Ce,className:"flex-1",disabled:h,children:""})]})]})}),a.jsx(cr,{isOpen:M,onClose:()=>{J(!1),X(null),P("")},title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-toss-gray-700",children:[a.jsx("span",{className:"font-medium",children:V?.isDocument?V?.drafter?.name:V?._name}),"  ."]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),a.jsx("textarea",{value:se,onChange:oe=>P(oe.target.value),rows:3,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:"  "})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{J(!1),X(null),P("")},className:"flex-1",children:""}),a.jsx(Ye,{variant:"danger",onClick:jt,className:"flex-1",disabled:h,children:""})]})]})}),a.jsx(cr,{isOpen:U,onClose:()=>{ce(!1),ie(null)},title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-toss-gray-700",children:[a.jsx("span",{className:"font-medium",children:ne?.name})," ",x," "]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  "}),a.jsx("input",{type:"number",value:W,onChange:oe=>G(oe.target.value),min:0,step:.5,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>{ce(!1),ie(null)},className:"flex-1",children:""}),a.jsx(Ye,{onClick:At,className:"flex-1",disabled:h,children:""})]})]})})]})},cQ=e=>{if(!e)return"";const t=new Date(e);return t.setMonth(t.getMonth()+4),t.toISOString().split("T")[0]},uQ=e=>e?/^\d+?$/.test(e.trim()):!0,W3=e=>e?e.replace(/-/g,"."):"-",dQ=e=>{if(!e)return!1;const t=new Date(e),r=new Date,s=new Date(r.getFullYear(),r.getMonth()+1,r.getDate());return t<=s&&t>=r},u0=6;function kb({isOpen:e,onClose:t,records:r,stats:s,backgroundImage:n,centerType:o}){const l=K.useRef(null),u=K.useRef(null),[d,h]=K.useState(!1),[m,x]=K.useState(!0),[y,b]=K.useState(null),[v,g]=K.useState(0),[_,w]=K.useState(1);K.useEffect(()=>{const O=()=>{h(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",O),()=>document.removeEventListener("fullscreenchange",O)},[]),K.useEffect(()=>{const O=B=>{B.key==="Escape"&&!d&&t(),B.key==="ArrowLeft"&&v>0&&g(L=>L-1),B.key==="ArrowRight"&&v<_-1&&g(L=>L+1)};return e&&document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)},[e,d,t,v,_]);const S=K.useCallback(async O=>{const B=l.current;if(!B)return;x(!0);const L=2,H=1920,ue=1080;B.width=H*L,B.height=ue*L;const A=B.getContext("2d");if(!A)return;A.imageSmoothingEnabled=!0,A.imageSmoothingQuality="high",A.scale(L,L);const Y="/company-intranet/",I=n||"back_2.jpg",ae=new Image;ae.crossOrigin="anonymous",ae.src=`${Y}${I}`,await new Promise(q=>{ae.onload=()=>q(),ae.onerror=()=>q()}),A.drawImage(ae,0,0,H,ue);const Q=155,re=Math.max(1,Math.ceil(r.length/u0));w(re);const ve=O===0,te=r.slice(O*u0,(O+1)*u0),ke="#3b6cb5",Z="#ffffff",M="rgba(255, 255, 255, 0.95)",J="rgba(245, 247, 250, 0.95)",V="#1a2332",X="#2d3748",se="#718096";let P=Q;if(ve){const Ae=(H-932)/2;[{label:" ",value:s.total},{label:"  ",value:s.active},{label:" ",value:s.discharged}].forEach((Ee,Ce)=>{const Je=Ae+Ce*316;A.fillStyle=ke,A.fillRect(Je,Q,300,44),A.fillStyle=Z,A.font="bold 26px Pretendard, -apple-system, sans-serif",A.textAlign="center",A.textBaseline="middle",A.fillText(Ee.label,Je+300/2,Q+22),A.fillStyle=M,A.fillRect(Je,Q+44,300,76),A.fillStyle=V,A.font="bold 50px Pretendard, -apple-system, sans-serif";const $e=`${Ee.value}`,tt=A.measureText($e).width;A.fillText($e,Je+300/2-10,Q+44+76/2),A.fillStyle=se,A.font="28px Pretendard, -apple-system, sans-serif",A.fillText("",Je+300/2-10+tt/2+10,Q+44+76/2+4)}),P=Q+120+20}const U=60,ce=H-120,ne=100,ie=50,k=[{label:"No",width:60},{label:"",width:140},{label:"",width:190},{label:"",width:140},{label:"",width:80},{label:o==="bupyeong"?"/":"",width:o==="bupyeong"?180:80},{label:"",width:200},{label:"",width:o==="bupyeong"?350:250},{label:"",width:0}],de=k.reduce((q,me)=>q+me.width,0);k[k.length-1].width=ce-de,A.fillStyle=ke,A.fillRect(U,P,ce,ie),A.fillStyle=Z,A.font="bold 26px Pretendard, -apple-system, sans-serif",A.textBaseline="middle";let z=U;k.forEach(q=>{A.textAlign="center",A.fillText(q.label,z+q.width/2,P+ie/2),z+=q.width});const T=k[7].width-20,R=k[8].width-20;if(te.forEach((q,me)=>{const _e=O*u0+me,le=P+ie+me*ne,Me=o!=="bupyeong"||uQ(q.room)?q.discharge_date||cQ(q.admission_date):q.discharge_date||"";A.fillStyle=me%2===0?M:J,A.fillRect(U,le,ce,ne),A.textBaseline="middle";const Ee=le+ne/2;let Ce=U;A.fillStyle=se,A.font="30px Pretendard, -apple-system, sans-serif",A.textAlign="center",A.fillText(`${_e+1}`,Ce+k[0].width/2,Ee),Ce+=k[0].width,A.fillStyle=X,A.font="bold 30px Pretendard, -apple-system, sans-serif",A.textAlign="center",A.fillText(q.location||"-",Ce+k[1].width/2,Ee),Ce+=k[1].width,A.fillStyle=V,A.font="600 30px Pretendard, -apple-system, sans-serif",A.textAlign="center",A.fillText(W3(q.admission_date),Ce+k[2].width/2,Ee),Ce+=k[2].width,A.fillStyle=X,A.font="bold 30px Pretendard, -apple-system, sans-serif",A.textAlign="center",A.fillText(q.ganghwa||"-",Ce+k[3].width/2,Ee),Ce+=k[3].width,A.fillText(q.bupyeong||"-",Ce+k[4].width/2,Ee),Ce+=k[4].width,A.fillText(q.room||"-",Ce+k[5].width/2,Ee),Ce+=k[5].width,Me?(A.fillStyle=dQ(Me)?"#ef4444":"#2563eb",A.font="600 30px Pretendard, -apple-system, sans-serif",A.textAlign="center",A.fillText(W3(Me),Ce+k[6].width/2,Ee)):(A.fillStyle=se,A.font="30px Pretendard, -apple-system, sans-serif",A.textAlign="center",A.fillText("-",Ce+k[6].width/2,Ee)),Ce+=k[6].width,A.fillStyle=X,A.font="22px Pretendard, -apple-system, sans-serif",A.textAlign="center";const $e=(q.admin_status||"-").split(/[,]\s*/).filter(Boolean),tt=26,De=$e.length*tt,ft=Ee-De/2+tt/2;$e.forEach((vt,At)=>{let Rt=vt.trim();for(;A.measureText(Rt).width>T&&Rt.length>1;)Rt=Rt.slice(0,-1);Rt!==vt.trim()&&Rt.length>0&&(Rt+=".."),A.fillText(Rt,Ce+k[7].width/2,ft+At*tt)}),Ce+=k[7].width,A.font="26px Pretendard, -apple-system, sans-serif";let jt=q.notes||"-";for(;A.measureText(jt).width>R&&jt.length>1;)jt=jt.slice(0,-1);jt!==(q.notes||"-")&&jt.length>0&&(jt+=".."),A.fillText(jt,Ce+k[8].width/2,Ee)}),re>1){const q=ie+te.length*ne,me=P+q+25;A.fillStyle=se,A.font="600 28px Pretendard, -apple-system, sans-serif",A.textAlign="center",A.fillText(`${O+1} / ${re} `,H/2,me)}b(B.toDataURL("image/png")),x(!1)},[r,s,n,o]);K.useEffect(()=>{if(e){g(0);const O=setTimeout(()=>{S(0)},100);return()=>clearTimeout(O)}},[e,S]),K.useEffect(()=>{e&&S(v)},[v,e,S]);const N=K.useCallback(()=>{document.fullscreenElement?document.exitFullscreen():u.current?.requestFullscreen()},[]),E=K.useCallback(()=>{const O=l.current;O&&O.toBlob(B=>{if(B){const L=URL.createObjectURL(B),H=document.createElement("a"),ue=_>1?`_${v+1}`:"";H.download=`${ue}_${new Date().toISOString().split("T")[0]}.png`,H.href=L,H.click(),URL.revokeObjectURL(L)}},"image/png")},[v,_]),C=()=>{v>0&&g(O=>O-1)},F=()=>{v<_-1&&g(O=>O+1)};return e?a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90",children:[a.jsx("canvas",{ref:l,width:1920,height:1080,style:{display:"none"}}),!d&&a.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-[60] p-3 bg-white rounded-full shadow-lg hover:bg-gray-100 transition-colors",title:" (ESC)",children:a.jsx(mr,{size:28})}),a.jsx("div",{ref:u,className:"relative flex items-center justify-center w-full h-full",children:m?a.jsx("div",{className:"text-white text-xl",children:" ..."}):y?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:y,alt:"",className:`max-w-full max-h-full object-contain ${d?"w-full h-full":""}`,style:{maxWidth:d?"100%":"90vw",maxHeight:d?"100%":"90vh"}}),!d&&a.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-3 z-50",children:[_>1&&a.jsxs("div",{className:"flex items-center gap-1 bg-white/90 rounded-lg shadow-lg px-2",children:[a.jsx("button",{onClick:C,disabled:v===0,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-30 disabled:cursor-not-allowed",title:" ",children:a.jsx(xa,{size:20})}),a.jsxs("span",{className:"text-sm font-medium text-gray-700 px-2",children:[v+1," / ",_]}),a.jsx("button",{onClick:F,disabled:v===_-1,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-30 disabled:cursor-not-allowed",title:" ",children:a.jsx(Js,{size:20})})]}),a.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-4 py-2 bg-white/90 hover:bg-white rounded-lg shadow-lg transition-all text-gray-800",title:" ",children:[a.jsx(Jr,{size:20}),a.jsx("span",{className:"font-medium",children:""})]}),a.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-white/90 hover:bg-white rounded-lg shadow-lg transition-all text-gray-800",title:"",children:[a.jsx(YE,{size:20}),a.jsx("span",{className:"font-medium",children:""})]})]})]}):a.jsx("div",{className:"text-white text-xl",children:"   ."})})]}):null}const lo=e=>{if(!e)return"";const t=new Date(e);return t.setMonth(t.getMonth()+4),t.toISOString().split("T")[0]},Na=e=>e?e.replace(/-/g,"."):"-",G3=e=>{if(!e)return!1;const t=new Date(e),r=new Date,s=new Date(r.getFullYear(),r.getMonth()+1,r.getDate());return t<=s&&t>=r},id={admission_date:"",bupyeong:"",ganghwa:"",room:"",discharge_date:"",location:"",notes:""};function fQ(){const{profile:e,isAdmin:t}=qr(),[r,s]=K.useState([]),[n,o]=K.useState(!0),[l,u]=K.useState(!1),[d,h]=K.useState(!1),[m,x]=K.useState(!1),[y,b]=K.useState(null),[v,g]=K.useState(null),[_,w]=K.useState(null),[S,N]=K.useState(id),[E,C]=K.useState(!1),[F,O]=K.useState(!1),[B,L]=K.useState(!0),[H,ue]=K.useState(!0),[A,Y]=K.useState(!1),I=K.useRef(null),ae=K.useCallback(async()=>{try{o(!0);const{data:G,error:k}=await Pe.from("admission_records").select("*").order("admission_date",{ascending:!1});if(k)throw k;s(G||[])}catch(G){console.error("  :",G)}finally{o(!1)}},[]);K.useEffect(()=>{ae()},[ae]);const Q=r.filter(G=>!G.is_discharged),re=r.filter(G=>G.is_discharged),ve=()=>{b(null),N(id),u(!0)},te=G=>{b(G),N({admission_date:G.admission_date||"",bupyeong:G.bupyeong||"",ganghwa:G.ganghwa||"",room:G.room||"",discharge_date:G.discharge_date||(G.bupyeong&&!G.ganghwa?"":""),location:G.location||"",notes:G.notes||""}),u(!0)},ke=G=>{g(G),h(!0)},Z=async()=>{if(v)try{const{error:G}=await Pe.from("admission_records").delete().eq("id",v);if(G)throw G;await ae()}catch(G){console.error(" :",G),alert("   .")}finally{h(!1),g(null)}},M=G=>{w(G),x(!0)},J=async()=>{if(_)try{const G=new Date().toISOString().split("T")[0],{error:k}=await Pe.from("admission_records").update({is_discharged:!0,discharge_date:G}).eq("id",_);if(k)throw k;await ae()}catch(G){console.error("  :",G),alert(`    .
${G?.message||JSON.stringify(G)}`)}finally{x(!1),w(null)}},V=async()=>{if(!S.admission_date){alert(" .");return}C(!0);try{let G=null;S.ganghwa?G=lo(S.admission_date):S.discharge_date&&S.discharge_date!==""&&(G=S.discharge_date);const k={admission_date:S.admission_date,bupyeong:S.bupyeong,ganghwa:S.ganghwa,room:S.room,discharge_date:G,location:S.location,notes:S.notes};if(y){const{error:de}=await Pe.from("admission_records").update(k).eq("id",y.id);if(de)throw de}else{const{error:de}=await Pe.from("admission_records").insert({...k,is_discharged:!1});if(de)throw de}await ae(),u(!1),N(id),b(null)}catch(G){console.error(" :",G),alert(`   .
${G?.message||JSON.stringify(G)}`)}finally{C(!1)}},X=()=>{if(r.length===0){alert("  .");return}const G=r.map((T,R)=>{const q=T.ganghwa?T.discharge_date||lo(T.admission_date):T.discharge_date||"";return{No:R+1,:Na(T.admission_date),:T.bupyeong||"",:T.ganghwa||"",:T.location||"",:T.room||"",:!T.ganghwa&&T.bupyeong&&!q?"":Na(q),:T.notes||"",:T.is_discharged?"":" "}}),k=Rr.json_to_sheet(G),de=Rr.book_new();Rr.book_append_sheet(de,k,""),k["!cols"]=[{wch:5},{wch:14},{wch:15},{wch:15},{wch:20},{wch:10},{wch:14},{wch:25},{wch:10}];const z=new Date().toISOString().split("T")[0];vo(de,`_${z}.xlsx`)},se=()=>{const G=[["","","","","","",""]],k=Rr.aoa_to_sheet(G),de=Rr.book_new();Rr.book_append_sheet(de,k,""),k["!cols"]=[{wch:14},{wch:15},{wch:15},{wch:20},{wch:10},{wch:14},{wch:25}],vo(de,"_.xlsx")},P=async G=>{const k=G.target.files?.[0];if(k){I.current&&(I.current.value=""),Y(!0);try{const de=await k.arrayBuffer(),z=wl(de),T=z.Sheets[z.SheetNames[0]],R=Rr.sheet_to_json(T);if(R.length===0){alert("   .");return}const q=Ee=>{if(!Ee)return"";if(typeof Ee=="number")return new Date((Ee-25569)*86400*1e3).toISOString().split("T")[0];const Ce=String(Ee).trim(),Je=Ce.match(/(\d{4})[.\-/](\d{1,2})[.\-/](\d{1,2})/);return Je?`${Je[1]}-${Je[2].padStart(2,"0")}-${Je[3].padStart(2,"0")}`:Ce},me=R.map(Ee=>({admission_date:q(Ee.),bupyeong:String(Ee.||"").trim(),ganghwa:String(Ee.||"").trim(),room:String(Ee.||"").trim(),discharge_date:q(Ee.),location:String(Ee.||Ee.||"").trim(),notes:String(Ee.||"").trim()})).filter(Ee=>Ee.admission_date);if(me.length===0){alert("  .  .");return}let _e=0,le=0,Ae=0;for(const Ee of me){const Ce=Ee.bupyeong||Ee.ganghwa,Je=r.find($e=>($e.bupyeong||$e.ganghwa)===Ce&&$e.admission_date===Ee.admission_date);if(Je)if(Je.room!==Ee.room||Je.location!==Ee.location||Je.notes!==Ee.notes||Je.bupyeong!==Ee.bupyeong||Je.ganghwa!==Ee.ganghwa){const tt=Ee.ganghwa?lo(Ee.admission_date):Ee.discharge_date||null,{error:De}=await Pe.from("admission_records").update({bupyeong:Ee.bupyeong,ganghwa:Ee.ganghwa,room:Ee.room,location:Ee.location,notes:Ee.notes,discharge_date:tt}).eq("id",Je.id);if(De)throw De;le++}else Ae++;else{const $e=Ee.ganghwa?lo(Ee.admission_date):Ee.discharge_date||null,{error:tt}=await Pe.from("admission_records").insert({admission_date:Ee.admission_date,bupyeong:Ee.bupyeong,ganghwa:Ee.ganghwa,room:Ee.room,discharge_date:$e,location:Ee.location,notes:Ee.notes,is_discharged:!1});if(tt)throw tt;_e++}}await ae();const Me=[];_e>0&&Me.push(` : ${_e}`),le>0&&Me.push(`: ${le}`),Ae>0&&Me.push(` : ${Ae}`),alert(` !
${Me.join(`
`)}`)}catch(de){console.error("  :",de),alert(`   .
${de?.message||JSON.stringify(de)}`)}finally{Y(!1)}}},U=r.length,ce=Q.length,ne=re.length,ie=Q,W=()=>{const k=`
      <div class="stats-grid">
        <div class="stat-box"><div class="label"> </div><div class="value">${U}<span class="unit"> </span></div></div>
        <div class="stat-box highlight"><div class="label">  </div><div class="value">${ce}<span class="unit"> </span></div></div>
        <div class="stat-box"><div class="label"> </div><div class="value">${ne}<span class="unit"> </span></div></div>
      </div>
      <div class="section-title">   (${ce})</div>
      <table>
        <thead><tr><th>No</th><th></th><th></th><th></th><th>()</th><th></th><th></th></tr></thead>
        <tbody>
          ${Q.map((de,z)=>{const T=de.ganghwa?de.discharge_date||lo(de.admission_date):de.discharge_date||"",R=de.location&&de.room?`${de.location}(${de.room})`:de.location||de.room||"-",me=!de.ganghwa&&de.bupyeong&&!T?"":T?Na(T):"-";return`<tr>
              <td style="text-align:center">${z+1}</td>
              <td style="text-align:center">${Na(de.admission_date)}</td>
              <td style="text-align:center">${de.bupyeong||"-"}</td>
              <td style="text-align:center">${de.ganghwa||"-"}</td>
              <td style="text-align:center">${R}</td>
              <td style="text-align:center">${me}</td>
              <td>${de.notes||"-"}</td>
            </tr>`}).join("")}
        </tbody>
      </table>
    `;ml({title:" ",content:k})};return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(fl,{size:24})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-1",children:" "}),a.jsx("p",{className:"text-white/90",children:t?"    ":"  "})]})]})}),a.jsxs(_t,{padding:"p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-blue-50 border-b border-blue-100 cursor-pointer",onClick:()=>L(!B),children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("h3",{className:"font-bold text-toss-gray-900",children:"  "})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:G=>{G.stopPropagation(),O(!0)},className:"p-2 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:a.jsx(nm,{size:18})}),a.jsx("button",{onClick:G=>{G.stopPropagation(),W()},className:"p-2 text-toss-gray-600 hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:a.jsx(ia,{size:18})}),B?a.jsx(Wn,{size:20,className:"text-toss-gray-500"}):a.jsx(Cn,{size:20,className:"text-toss-gray-500"})]})]}),B&&a.jsx("div",{className:"p-4 sm:p-6",children:a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),a.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[U,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),a.jsxs("div",{className:"bg-blue-50 border-2 border-blue-300 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"  "}),a.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[ce,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),a.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),a.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[ne,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]})]})})]}),a.jsxs(_t,{padding:"p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-toss-gray-100",children:[a.jsxs("h3",{className:"font-bold text-toss-gray-900",children:["  ",a.jsxs("span",{className:"text-sm font-normal text-blue-600 ml-1",children:["(",ce,")"]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(Ye,{variant:"secondary",size:"sm",onClick:se,children:[a.jsx(im,{size:16,className:"mr-1"}),""]}),a.jsxs(Ye,{variant:"secondary",size:"sm",onClick:()=>I.current?.click(),disabled:A,children:[a.jsx(Gn,{size:16,className:"mr-1"}),A?" ...":""]}),a.jsx("input",{ref:I,type:"file",accept:".xlsx,.xls",onChange:P,className:"hidden"}),a.jsxs(Ye,{variant:"secondary",size:"sm",onClick:X,children:[a.jsx(Jr,{size:16,className:"mr-1"}),""]}),a.jsxs(Ye,{variant:"primary",size:"sm",onClick:ve,children:[a.jsx(os,{size:16,className:"mr-1"}),""]})]})]}),n?a.jsx("div",{className:"flex justify-center items-center py-20",children:a.jsx("div",{className:"w-10 h-10 border-4 border-toss-blue border-t-transparent rounded-full animate-spin"})}):Q.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-toss-gray-400",children:[a.jsx(fl,{size:48,className:"mb-4"}),a.jsx("p",{className:"text-lg font-medium",children:"    "}),a.jsx("p",{className:"text-sm mt-1",children:"+     "})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:"No"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:"()"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""})]})}),a.jsx("tbody",{children:Q.map((G,k)=>{const de=G.ganghwa?G.discharge_date||lo(G.admission_date):G.discharge_date||"",z=!G.ganghwa&&G.bupyeong&&!de,T=G.location&&G.room?`${G.location}(${G.room})`:G.location||G.room||"-";return a.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors bg-blue-50/30",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500",children:k+1}),a.jsx("td",{className:"px-4 py-3 text-sm font-medium text-toss-gray-900",children:Na(G.admission_date)}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-700",children:G.bupyeong||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-700",children:G.ganghwa||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-700",children:T}),a.jsx("td",{className:"px-4 py-3 text-sm",children:z?a.jsx("span",{className:"font-medium text-blue-600",children:""}):de?a.jsx("span",{className:`font-medium ${G3(de)?"text-red-500":"text-blue-600"}`,children:Na(de)}):a.jsx("span",{className:"text-toss-gray-400",children:"-"})}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500 max-w-[200px] truncate",children:G.notes||"-"}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("button",{onClick:()=>M(G.id),className:"p-1.5 text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",title:"",children:a.jsx(Lc,{size:16})}),a.jsx("button",{onClick:()=>te(G),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:"",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>ke(G.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:a.jsx(Xt,{size:16})})]})})]},G.id)})})]})}),a.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:Q.map((G,k)=>{const de=G.ganghwa?G.discharge_date||lo(G.admission_date):G.discharge_date||"",z=!G.ganghwa&&G.bupyeong&&!de;return a.jsxs("div",{className:"p-4 bg-blue-50/30",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",k+1]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>M(G.id),className:"p-1.5 text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",children:a.jsx(Lc,{size:14})}),a.jsx("button",{onClick:()=>te(G),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",children:a.jsx(js,{size:14})}),a.jsx("button",{onClick:()=>ke(G.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:a.jsx(Xt,{size:14})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"font-medium text-toss-gray-900",children:Na(G.admission_date)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),z?a.jsx("p",{className:"font-medium text-blue-600",children:""}):de?a.jsx("p",{className:`font-medium ${G3(de)?"text-red-500":"text-blue-600"}`,children:Na(de)}):a.jsx("p",{className:"text-toss-gray-400",children:"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-700",children:G.bupyeong||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-700",children:G.ganghwa||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:"()"}),a.jsx("p",{className:"text-toss-gray-700",children:G.location&&G.room?`${G.location}(${G.room})`:G.location||G.room||"-"})]}),G.notes&&a.jsxs("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:G.notes})]})]})]},G.id)})})]})]}),re.length>0&&a.jsxs(_t,{padding:"p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-gray-50 border-b border-toss-gray-200 cursor-pointer",onClick:()=>ue(!H),children:[a.jsxs("h3",{className:"font-bold text-toss-gray-700",children:["  ",a.jsxs("span",{className:"text-sm font-normal text-toss-gray-500 ml-1",children:["(",ne,")"]})]}),H?a.jsx(Wn,{size:20,className:"text-toss-gray-500"}):a.jsx(Cn,{size:20,className:"text-toss-gray-500"})]}),H&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:"No"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:"()"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""})]})}),a.jsx("tbody",{children:re.map((G,k)=>a.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-400",children:k+1}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500",children:Na(G.admission_date)}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500",children:G.bupyeong||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500",children:G.ganghwa||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500",children:G.location&&G.room?`${G.location}(${G.room})`:G.location||G.room||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-500",children:Na(G.discharge_date)}),a.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-400 max-w-[200px] truncate",children:G.notes||"-"}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("button",{onClick:()=>te(G),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:"",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>ke(G.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:a.jsx(Xt,{size:16})})]})})]},G.id))})]})}),a.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:re.map((G,k)=>a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",k+1]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>te(G),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",children:a.jsx(js,{size:14})}),a.jsx("button",{onClick:()=>ke(G.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:a.jsx(Xt,{size:14})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:Na(G.admission_date)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:Na(G.discharge_date)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:G.bupyeong||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:G.ganghwa||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:"()"}),a.jsx("p",{className:"text-toss-gray-500",children:G.location&&G.room?`${G.location}(${G.room})`:G.location||G.room||"-"})]}),G.notes&&a.jsxs("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-400",children:G.notes})]})]})]},G.id))})]})]}),a.jsx(cr,{isOpen:l,onClose:()=>{u(!1),b(null),N(id)},title:y?"  ":"  ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",value:S.admission_date,onChange:G=>N({...S,admission_date:G.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"}),S.admission_date&&S.ganghwa&&a.jsxs("p",{className:"text-xs text-toss-gray-400 mt-1",children:["  : ",Na(lo(S.admission_date))," (4   )"]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsx("input",{type:"text",value:S.bupyeong,onChange:G=>N({...S,bupyeong:G.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsx("input",{type:"text",value:S.ganghwa,onChange:G=>N({...S,ganghwa:G.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsx("input",{type:"text",value:S.location,onChange:G=>N({...S,location:G.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsx("input",{type:"text",value:S.room,onChange:G=>N({...S,room:G.target.value}),placeholder:" ",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]})]}),S.bupyeong&&!S.ganghwa&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{value:S.discharge_date===""?"":S.discharge_date?"date":"",onChange:G=>{if(G.target.value==="")N({...S,discharge_date:""});else{const de=S.discharge_date!==""?S.discharge_date:"";N({...S,discharge_date:de})}},className:"px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue bg-white",children:[a.jsx("option",{value:"",children:""}),a.jsx("option",{value:"date",children:" "})]}),S.discharge_date!==""&&a.jsx("input",{type:"date",value:S.discharge_date,onChange:G=>N({...S,discharge_date:G.target.value}),className:"flex-1 px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsx("textarea",{value:S.notes,onChange:G=>N({...S,notes:G.target.value}),placeholder:" ",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue resize-none"})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{u(!1),b(null),N(id)},children:""}),a.jsx(Ye,{variant:"primary",className:"flex-1",onClick:V,disabled:E,children:E?" ...":y?"":""})]})]})}),a.jsx(cr,{isOpen:d,onClose:()=>{h(!1),g(null)},title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 rounded-lg",children:[a.jsx(Nl,{size:24,className:"text-red-500 flex-shrink-0"}),a.jsx("p",{className:"text-sm text-red-700",children:"   ?     ."})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{h(!1),g(null)},children:""}),a.jsx(Ye,{variant:"danger",className:"flex-1",onClick:Z,children:""})]})]})}),a.jsx(cr,{isOpen:m,onClose:()=>{x(!1),w(null)},title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-orange-50 rounded-lg",children:[a.jsx(Lc,{size:24,className:"text-orange-500 flex-shrink-0"}),a.jsxs("p",{className:"text-sm text-orange-700",children:["   ?  (",Na(new Date().toISOString().split("T")[0]),") ."]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{x(!1),w(null)},children:""}),a.jsx(Ye,{variant:"primary",className:"flex-1 !bg-orange-500 hover:!bg-orange-600",onClick:J,children:" "})]})]})}),a.jsx(kb,{isOpen:F,onClose:()=>O(!1),records:ie,stats:{total:U,active:ce,discharged:ne}})]})}const od=e=>{if(!e)return"";const t=new Date(e);return t.setMonth(t.getMonth()+4),t.toISOString().split("T")[0]},Os=e=>e?e.replace(/-/g,"."):"-",d0=e=>{if(!e)return!1;const t=new Date(e),r=new Date,s=new Date(r.getFullYear(),r.getMonth()+1,r.getDate());return t<=s&&t>=r},ld={admission_date:"",bupyeong:"",ganghwa:"",room:"",discharge_date:"",location:"",admin_status:"",notes:""};function hQ(){const{profile:e,isAdmin:t}=qr(),[r,s]=K.useState([]),[n,o]=K.useState(!0),[l,u]=K.useState(!1),[d,h]=K.useState(!1),[m,x]=K.useState(!1),[y,b]=K.useState(null),[v,g]=K.useState(null),[_,w]=K.useState(null),[S,N]=K.useState(ld),[E,C]=K.useState(!1),[F,O]=K.useState(!1),[B,L]=K.useState(!0),[H,ue]=K.useState(!0),[A,Y]=K.useState(!1),I=K.useRef(null),ae=K.useCallback(async()=>{try{o(!0);const{data:k,error:de}=await Pe.from("admission_records").select("*").order("admission_date",{ascending:!1});if(de)throw de;s(k||[])}catch(k){console.error("  :",k)}finally{o(!1)}},[]);K.useEffect(()=>{ae()},[ae]);const Q=k=>{if(!k)return 1/0;const de=parseInt(k.replace(/[^0-9]/g,""),10);return isNaN(de)?1/0:de},re=r.filter(k=>!k.is_discharged).sort((k,de)=>{const z=Q(k.room),T=Q(de.room);return z!==1/0||T!==1/0?z-T:(k.admission_date||"").localeCompare(de.admission_date||"")}),ve=r.filter(k=>k.is_discharged),te=()=>{b(null),N(ld),u(!0)},ke=k=>{b(k),N({admission_date:k.admission_date||"",bupyeong:k.bupyeong||"",ganghwa:k.ganghwa||"",room:k.room||"",discharge_date:k.discharge_date||"",location:k.location||"",admin_status:k.admin_status||"",notes:k.notes||""}),u(!0)},Z=k=>{g(k),h(!0)},M=async()=>{if(v)try{const{error:k}=await Pe.from("admission_records").delete().eq("id",v);if(k)throw k;await ae()}catch(k){console.error(" :",k),alert("   .")}finally{h(!1),g(null)}},J=k=>{w(k),x(!0)},V=async()=>{if(_)try{const k=new Date().toISOString().split("T")[0],{error:de}=await Pe.from("admission_records").update({is_discharged:!0,discharge_date:k}).eq("id",_);if(de)throw de;await ae()}catch(k){console.error("  :",k),alert(`    .
${k?.message||JSON.stringify(k)}`)}finally{x(!1),w(null)}},X=async()=>{if(!S.admission_date){alert(" .");return}if(!S.ganghwa){alert(" .");return}C(!0);try{const k={admission_date:S.admission_date,bupyeong:S.bupyeong,ganghwa:S.ganghwa,room:S.room,discharge_date:S.discharge_date||null,location:S.location,admin_status:S.admin_status,notes:S.notes};if(y){const{error:de}=await Pe.from("admission_records").update(k).eq("id",y.id);if(de)throw de}else{const{error:de}=await Pe.from("admission_records").insert({...k,is_discharged:!1});if(de)throw de}await ae(),u(!1),N(ld),b(null)}catch(k){console.error(" :",k),alert(`   .
${k?.message||JSON.stringify(k)}`)}finally{C(!1)}},se=()=>{if(r.length===0){alert("  .");return}const k=r.map((R,q)=>{const me=od(R.admission_date);return{No:q+1,:R.location||"",:Os(R.admission_date),:R.ganghwa||"",:R.bupyeong||"",:R.room||""," ":Os(me)," ":Os(R.discharge_date),:R.admin_status||"",:R.notes||"",:R.is_discharged?"":" "}}),de=Rr.json_to_sheet(k),z=Rr.book_new();Rr.book_append_sheet(z,de,""),de["!cols"]=[{wch:5},{wch:12},{wch:14},{wch:12},{wch:8},{wch:8},{wch:14},{wch:14},{wch:15},{wch:25},{wch:10}];const T=new Date().toISOString().split("T")[0];vo(z,`__${T}.xlsx`)},P=()=>{const k=[["","","","",""," ","",""]],de=Rr.aoa_to_sheet(k),z=Rr.book_new();Rr.book_append_sheet(z,de,""),de["!cols"]=[{wch:12},{wch:14},{wch:12},{wch:8},{wch:8},{wch:14},{wch:15},{wch:25}],vo(z,"__.xlsx")},U=async k=>{const de=k.target.files?.[0];if(de){I.current&&(I.current.value=""),Y(!0);try{const z=await de.arrayBuffer(),T=wl(z),R=T.Sheets[T.SheetNames[0]],q=Rr.sheet_to_json(R);if(q.length===0){alert("   .");return}const me=Ce=>{if(!Ce)return"";if(typeof Ce=="number")return new Date((Ce-25569)*86400*1e3).toISOString().split("T")[0];const Je=String(Ce).trim(),$e=Je.match(/(\d{4})[.\-/](\d{1,2})[.\-/](\d{1,2})/);if($e)return`${$e[1]}-${$e[2].padStart(2,"0")}-${$e[3].padStart(2,"0")}`;const tt=Je.match(/(\d{2})[.\-/](\d{1,2})[.\-/](\d{1,2})/);if(tt){const De=parseInt(tt[1],10);return`${De>=50?1900+De:2e3+De}-${tt[2].padStart(2,"0")}-${tt[3].padStart(2,"0")}`}return Je},_e=q.map(Ce=>({admission_date:me(Ce.||Ce.),bupyeong:String(Ce.||Ce.||"").trim(),ganghwa:String(Ce.||Ce.||"").trim(),room:String(Ce.||"").trim(),discharge_date:me(Ce[" "]||Ce.||Ce.),location:String(Ce.||Ce.||Ce.||"").trim(),admin_status:String(Ce.||"").trim(),notes:String(Ce.||"").trim()})).filter(Ce=>Ce.admission_date);if(_e.length===0){alert("  .  .");return}let le=0,Ae=0,Me=0;for(const Ce of _e){const Je=r.find($e=>$e.ganghwa===Ce.ganghwa&&$e.admission_date===Ce.admission_date);if(Je)if(Je.room!==Ce.room||Je.location!==Ce.location||Je.admin_status!==Ce.admin_status||Je.notes!==Ce.notes||Je.bupyeong!==Ce.bupyeong){const{error:tt}=await Pe.from("admission_records").update({bupyeong:Ce.bupyeong,ganghwa:Ce.ganghwa,room:Ce.room,location:Ce.location,admin_status:Ce.admin_status,notes:Ce.notes,discharge_date:Ce.discharge_date||null}).eq("id",Je.id);if(tt)throw tt;Ae++}else Me++;else{const{error:$e}=await Pe.from("admission_records").insert({admission_date:Ce.admission_date,bupyeong:Ce.bupyeong,ganghwa:Ce.ganghwa,room:Ce.room,discharge_date:Ce.discharge_date||null,location:Ce.location,admin_status:Ce.admin_status,notes:Ce.notes,is_discharged:!1});if($e)throw $e;le++}}await ae();const Ee=[];le>0&&Ee.push(` : ${le}`),Ae>0&&Ee.push(`: ${Ae}`),Me>0&&Ee.push(` : ${Me}`),alert(` !
${Ee.join(`
`)}`)}catch(z){console.error("  :",z),alert(`   .
${z?.message||JSON.stringify(z)}`)}finally{Y(!1)}}},ce=r.length,ne=re.length,ie=ve.length,W=re,G=()=>{const de=`
      <div class="stats-grid">
        <div class="stat-box"><div class="label"> </div><div class="value">${ce}<span class="unit"> </span></div></div>
        <div class="stat-box highlight"><div class="label">  </div><div class="value">${ne}<span class="unit"> </span></div></div>
        <div class="stat-box"><div class="label"> </div><div class="value">${ie}<span class="unit"> </span></div></div>
      </div>
      <div class="section-title">   (${ne})</div>
      <table>
        <thead><tr>
          <th>No</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th> </th>
          <th> </th>
          <th></th>
          <th></th>
        </tr></thead>
        <tbody>
          ${re.map((z,T)=>{const R=od(z.admission_date);return`<tr>
              <td style="text-align:center">${T+1}</td>
              <td style="text-align:center">${z.location||"-"}</td>
              <td style="text-align:center">${Os(z.admission_date)}</td>
              <td style="text-align:center">${z.ganghwa||"-"}</td>
              <td style="text-align:center">${z.bupyeong||"-"}</td>
              <td style="text-align:center">${z.room||"-"}</td>
              <td style="text-align:center">${Os(R)}</td>
              <td style="text-align:center">${z.discharge_date?Os(z.discharge_date):"-"}</td>
              <td style="text-align:center;white-space:pre-line">${z.admin_status||"-"}</td>
              <td>${z.notes||"-"}</td>
            </tr>`}).join("")}
        </tbody>
      </table>
    `;ml({title:"   ",content:de})};return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(fl,{size:24})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-1",children:"  "}),a.jsx("p",{className:"text-white/90",children:t?"     ":"    "})]})]})}),a.jsxs(_t,{padding:"p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-blue-50 border-b border-blue-100 cursor-pointer",onClick:()=>L(!B),children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("h3",{className:"font-bold text-toss-gray-900",children:"  "})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:k=>{k.stopPropagation(),O(!0)},className:"p-2 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:a.jsx(nm,{size:18})}),a.jsx("button",{onClick:k=>{k.stopPropagation(),G()},className:"p-2 text-toss-gray-600 hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:a.jsx(ia,{size:18})}),B?a.jsx(Wn,{size:20,className:"text-toss-gray-500"}):a.jsx(Cn,{size:20,className:"text-toss-gray-500"})]})]}),B&&a.jsx("div",{className:"p-4 sm:p-6",children:a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),a.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[ce,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),a.jsxs("div",{className:"bg-blue-50 border-2 border-blue-300 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"  "}),a.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[ne,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),a.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),a.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[ie,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]})]})})]}),a.jsxs(_t,{padding:"p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-toss-gray-100",children:[a.jsxs("h3",{className:"font-bold text-toss-gray-900",children:["  ",a.jsxs("span",{className:"text-sm font-normal text-blue-600 ml-1",children:["(",ne,")"]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(Ye,{variant:"secondary",size:"sm",onClick:P,children:[a.jsx(im,{size:16,className:"mr-1"}),""]}),a.jsxs(Ye,{variant:"secondary",size:"sm",onClick:()=>I.current?.click(),disabled:A,children:[a.jsx(Gn,{size:16,className:"mr-1"}),A?" ...":""]}),a.jsx("input",{ref:I,type:"file",accept:".xlsx,.xls",onChange:U,className:"hidden"}),a.jsxs(Ye,{variant:"secondary",size:"sm",onClick:se,children:[a.jsx(Jr,{size:16,className:"mr-1"}),""]}),a.jsxs(Ye,{variant:"primary",size:"sm",onClick:te,children:[a.jsx(os,{size:16,className:"mr-1"}),""]})]})]}),n?a.jsx("div",{className:"flex justify-center items-center py-20",children:a.jsx("div",{className:"w-10 h-10 border-4 border-toss-blue border-t-transparent rounded-full animate-spin"})}):re.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-toss-gray-400",children:[a.jsx(fl,{size:48,className:"mb-4"}),a.jsx("p",{className:"text-lg font-medium",children:"    "}),a.jsx("p",{className:"text-sm mt-1",children:"+     "})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsxs("thead",{children:[a.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-12",children:"No"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",colSpan:2,children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-36",children:""})]}),a.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[a.jsx("th",{colSpan:6}),a.jsx("th",{className:"px-2 py-1 text-center text-[10px] font-medium text-toss-gray-500",children:" "}),a.jsx("th",{className:"px-2 py-1 text-center text-[10px] font-medium text-toss-gray-500",children:" "}),a.jsx("th",{colSpan:3})]})]}),a.jsx("tbody",{children:re.map((k,de)=>{const z=od(k.admission_date),T=k.discharge_date;return a.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors bg-blue-50/30",children:[a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:de+1}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:k.location||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm font-medium text-toss-gray-900 text-center",children:Os(k.admission_date)}),a.jsx("td",{className:"px-3 py-3 text-sm font-medium text-toss-gray-900 text-center",children:k.ganghwa||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:k.bupyeong||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:k.room||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center",children:a.jsx("span",{className:`font-medium ${d0(z)?"text-red-500":"text-blue-600"}`,children:Os(z)})}),a.jsx("td",{className:"px-3 py-3 text-sm text-center",children:T&&T!==z?a.jsx("span",{className:`font-medium ${d0(T)?"text-red-500":"text-orange-600"}`,children:Os(T)}):a.jsx("span",{className:"text-toss-gray-400",children:"-"})}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center whitespace-pre-line",children:k.admin_status||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 max-w-[150px] truncate",children:k.notes||"-"}),a.jsx("td",{className:"px-2 py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-1 whitespace-nowrap",children:[a.jsx("button",{onClick:()=>J(k.id),className:"px-2 py-1 text-xs font-medium text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",title:"",children:""}),a.jsx("button",{onClick:()=>ke(k),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:"",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>Z(k.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:a.jsx(Xt,{size:16})})]})})]},k.id)})})]})}),a.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:re.map((k,de)=>{const z=od(k.admission_date),T=k.discharge_date;return a.jsxs("div",{className:"px-3 py-2 bg-blue-50/30",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",de+1]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>J(k.id),className:"px-2 py-0.5 text-xs font-medium text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",children:""}),a.jsx("button",{onClick:()=>ke(k),className:"p-1 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",children:a.jsx(js,{size:14})}),a.jsx("button",{onClick:()=>Z(k.id),className:"p-1 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:a.jsx(Xt,{size:14})})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-x-2 gap-y-1 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"font-medium text-toss-gray-900",children:k.ganghwa||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"text-toss-gray-700",children:k.location||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"text-toss-gray-700",children:k.bupyeong||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"font-medium text-toss-gray-900",children:Os(k.admission_date)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:" "}),a.jsx("p",{className:`font-medium ${d0(z)?"text-red-500":"text-blue-600"}`,children:Os(z)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"text-toss-gray-700",children:k.room||"-"})]}),T&&T!==z&&a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:" "}),a.jsx("p",{className:`font-medium ${d0(T)?"text-red-500":"text-orange-600"}`,children:Os(T)})]}),k.admin_status&&a.jsxs("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"text-toss-gray-500 whitespace-pre-line",children:k.admin_status})]}),k.notes&&a.jsxs("div",{className:"col-span-3",children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:k.notes})]})]})]},k.id)})})]})]}),ve.length>0&&a.jsxs(_t,{padding:"p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-gray-50 border-b border-toss-gray-200 cursor-pointer",onClick:()=>ue(!H),children:[a.jsxs("h3",{className:"font-bold text-toss-gray-700",children:["  ",a.jsxs("span",{className:"text-sm font-normal text-toss-gray-500 ml-1",children:["(",ie,")"]})]}),H?a.jsx(Wn,{size:20,className:"text-toss-gray-500"}):a.jsx(Cn,{size:20,className:"text-toss-gray-500"})]}),H&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-12",children:"No"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-20",children:""})]})}),a.jsx("tbody",{children:ve.map((k,de)=>a.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors",children:[a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 text-center",children:de+1}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.location||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:Os(k.admission_date)}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.ganghwa||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.bupyeong||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.room||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:Os(k.discharge_date)}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 text-center whitespace-pre-line",children:k.admin_status||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 max-w-[150px] truncate",children:k.notes||"-"}),a.jsx("td",{className:"px-3 py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("button",{onClick:()=>ke(k),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:"",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>Z(k.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:a.jsx(Xt,{size:16})})]})})]},k.id))})]})}),a.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:ve.map((k,de)=>a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",de+1]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>ke(k),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",children:a.jsx(js,{size:14})}),a.jsx("button",{onClick:()=>Z(k.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:a.jsx(Xt,{size:14})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:k.ganghwa||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:k.location||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:Os(k.admission_date)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:Os(k.discharge_date)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:k.bupyeong||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:k.room||"-"})]}),k.admin_status&&a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-400 whitespace-pre-line",children:k.admin_status})]}),k.notes&&a.jsxs("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-400",children:k.notes})]})]})]},k.id))})]})]}),a.jsx(cr,{isOpen:l,onClose:()=>{u(!1),b(null),N(ld)},title:y?"  ":"  ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:S.ganghwa,onChange:k=>N({...S,ganghwa:k.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsx("input",{type:"text",value:S.location,onChange:k=>N({...S,location:k.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsxs("select",{value:S.bupyeong,onChange:k=>N({...S,bupyeong:k.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue bg-white",children:[a.jsx("option",{value:"",children:""}),a.jsx("option",{value:"",children:""}),a.jsx("option",{value:"",children:""})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsx("input",{type:"text",value:S.room,onChange:k=>N({...S,room:k.target.value}),placeholder:" ",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",value:S.admission_date,onChange:k=>N({...S,admission_date:k.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"}),S.admission_date&&a.jsxs("p",{className:"text-xs text-toss-gray-400 mt-1",children:[" : ",Os(od(S.admission_date))," ( )"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:" "}),a.jsx("input",{type:"date",value:S.discharge_date,onChange:k=>N({...S,discharge_date:k.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"}),a.jsx("p",{className:"text-xs text-toss-gray-400 mt-1",children:"  ,    "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsx("textarea",{value:S.admin_status,onChange:k=>N({...S,admin_status:k.target.value}),placeholder:"  (  )",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue resize-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsx("textarea",{value:S.notes,onChange:k=>N({...S,notes:k.target.value}),placeholder:" ",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue resize-none"})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{u(!1),b(null),N(ld)},children:""}),a.jsx(Ye,{variant:"primary",className:"flex-1",onClick:X,disabled:E,children:E?" ...":y?"":""})]})]})}),a.jsx(cr,{isOpen:d,onClose:()=>{h(!1),g(null)},title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 rounded-lg",children:[a.jsx(Nl,{size:24,className:"text-red-500 flex-shrink-0"}),a.jsx("p",{className:"text-sm text-red-700",children:"   ?     ."})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{h(!1),g(null)},children:""}),a.jsx(Ye,{variant:"danger",className:"flex-1",onClick:M,children:""})]})]})}),a.jsx(cr,{isOpen:m,onClose:()=>{x(!1),w(null)},title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-orange-50 rounded-lg",children:[a.jsx(Lc,{size:24,className:"text-orange-500 flex-shrink-0"}),a.jsxs("p",{className:"text-sm text-orange-700",children:["   ?  (",Os(new Date().toISOString().split("T")[0]),") ."]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{x(!1),w(null)},children:""}),a.jsx(Ye,{variant:"primary",className:"flex-1 !bg-orange-500 hover:!bg-orange-600",onClick:V,children:" "})]})]})}),a.jsx(kb,{isOpen:F,onClose:()=>O(!1),records:W,stats:{total:ce,active:ne,discharged:ie},backgroundImage:"back_gw.jpg",centerType:"ganghwa"})]})}const cd=e=>{if(!e)return"";const t=new Date(e);return t.setMonth(t.getMonth()+4),t.toISOString().split("T")[0]},Fs=e=>e?e.replace(/-/g,"."):"-",f0=e=>{if(!e)return!1;const t=new Date(e),r=new Date,s=new Date(r.getFullYear(),r.getMonth()+1,r.getDate());return t<=s&&t>=r},kc=e=>{if(!e)return!0;const t=e.trim();return/^\d+?$/.test(t)},Xo="bupyeong_admission_records",ud={admission_date:"",name:"",gender:"",room:"",discharge_date:"",nationality:"",admin_status:"",notes:""};function mQ(){const{profile:e,isAdmin:t}=qr(),[r,s]=K.useState([]),[n,o]=K.useState(!0),[l,u]=K.useState(!1),[d,h]=K.useState(!1),[m,x]=K.useState(!1),[y,b]=K.useState(null),[v,g]=K.useState(null),[_,w]=K.useState(null),[S,N]=K.useState(ud),[E,C]=K.useState(!1),[F,O]=K.useState(!1),[B,L]=K.useState(!0),[H,ue]=K.useState(!0),[A,Y]=K.useState(!1),I=K.useRef(null),ae=K.useCallback(async()=>{try{o(!0);const{data:k,error:de}=await Pe.from(Xo).select("*").order("admission_date",{ascending:!1});if(de)throw de;s(k||[])}catch(k){console.error("   :",k)}finally{o(!1)}},[]);K.useEffect(()=>{ae()},[ae]);const Q=k=>{if(!k)return 1/0;const de=parseInt(k.replace(/[^0-9]/g,""),10);return isNaN(de)?1/0:de},re=r.filter(k=>!k.is_discharged).sort((k,de)=>Q(k.room)-Q(de.room)),ve=r.filter(k=>k.is_discharged),te=()=>{b(null),N(ud),u(!0)},ke=k=>{b(k),N({admission_date:k.admission_date||"",name:k.name||"",gender:k.gender||"",room:k.room||"",discharge_date:k.discharge_date||"",nationality:k.nationality||"",admin_status:k.admin_status||"",notes:k.notes||""}),u(!0)},Z=k=>{g(k),h(!0)},M=async()=>{if(v)try{const{error:k}=await Pe.from(Xo).delete().eq("id",v);if(k)throw k;await ae()}catch(k){console.error(" :",k),alert("   .")}finally{h(!1),g(null)}},J=k=>{w(k),x(!0)},V=async()=>{if(_)try{const k=new Date().toISOString().split("T")[0],{error:de}=await Pe.from(Xo).update({is_discharged:!0,discharge_date:k}).eq("id",_);if(de)throw de;await ae()}catch(k){console.error("  :",k),alert(`    .
${k?.message||JSON.stringify(k)}`)}finally{x(!1),w(null)}},X=async()=>{if(!S.admission_date){alert(" .");return}if(!S.name){alert(" .");return}C(!0);try{const k={admission_date:S.admission_date,name:S.name,gender:S.gender,room:S.room,discharge_date:S.discharge_date||null,nationality:S.nationality,admin_status:S.admin_status,notes:S.notes};if(y){const{error:de}=await Pe.from(Xo).update(k).eq("id",y.id);if(de)throw de}else{const{error:de}=await Pe.from(Xo).insert({...k,is_discharged:!1});if(de)throw de}await ae(),u(!1),N(ud),b(null)}catch(k){console.error(" :",k),alert(`   .
${k?.message||JSON.stringify(k)}`)}finally{C(!1)}},se=()=>{if(r.length===0){alert("  .");return}const k=r.map((R,q)=>{const me=kc(R.room)?cd(R.admission_date):"";return{No:q+1,:R.nationality||"",:Fs(R.admission_date),:R.name||"",:R.gender||"","  ()":R.room||""," ":me?Fs(me):""," ":Fs(R.discharge_date),:R.admin_status||"",:R.notes||"",:R.is_discharged?"":" "}}),de=Rr.json_to_sheet(k),z=Rr.book_new();Rr.book_append_sheet(z,de,""),de["!cols"]=[{wch:5},{wch:12},{wch:14},{wch:12},{wch:8},{wch:15},{wch:14},{wch:14},{wch:15},{wch:25},{wch:10}];const T=new Date().toISOString().split("T")[0];vo(z,`__${T}.xlsx`)},P=()=>{const k=[["","","","","  ()"," ","",""]],de=Rr.aoa_to_sheet(k),z=Rr.book_new();Rr.book_append_sheet(z,de,""),de["!cols"]=[{wch:12},{wch:14},{wch:12},{wch:8},{wch:15},{wch:14},{wch:15},{wch:25}],vo(z,"__.xlsx")},U=async k=>{const de=k.target.files?.[0];if(de){I.current&&(I.current.value=""),Y(!0);try{const z=await de.arrayBuffer(),T=wl(z),R=T.Sheets[T.SheetNames[0]],q=Rr.sheet_to_json(R);if(q.length===0){alert("   .");return}const me=Ce=>{if(!Ce)return"";if(typeof Ce=="number")return new Date((Ce-25569)*86400*1e3).toISOString().split("T")[0];const Je=String(Ce).trim(),$e=Je.match(/(\d{4})[.\-/](\d{1,2})[.\-/](\d{1,2})/);if($e)return`${$e[1]}-${$e[2].padStart(2,"0")}-${$e[3].padStart(2,"0")}`;const tt=Je.match(/(\d{2})[.\-/](\d{1,2})[.\-/](\d{1,2})/);if(tt){const De=parseInt(tt[1],10);return`${De>=50?1900+De:2e3+De}-${tt[2].padStart(2,"0")}-${tt[3].padStart(2,"0")}`}return Je},_e=q.map(Ce=>({admission_date:me(Ce.||Ce.),name:String(Ce.||"").trim(),gender:String(Ce.||"").trim(),room:String(Ce["  ()"]||Ce.||"").trim(),discharge_date:me(Ce[" "]||Ce.||Ce.),nationality:String(Ce.||Ce.||"").trim(),admin_status:String(Ce.||"").trim(),notes:String(Ce.||"").trim()})).filter(Ce=>Ce.admission_date);if(_e.length===0){alert("  .  .");return}let le=0,Ae=0,Me=0;for(const Ce of _e){const Je=r.find($e=>$e.name===Ce.name&&$e.admission_date===Ce.admission_date);if(Je)if(Je.room!==Ce.room||Je.nationality!==Ce.nationality||Je.admin_status!==Ce.admin_status||Je.notes!==Ce.notes||Je.gender!==Ce.gender){const{error:tt}=await Pe.from(Xo).update({name:Ce.name,gender:Ce.gender,room:Ce.room,nationality:Ce.nationality,admin_status:Ce.admin_status,notes:Ce.notes,discharge_date:Ce.discharge_date||null}).eq("id",Je.id);if(tt)throw tt;Ae++}else Me++;else{const{error:$e}=await Pe.from(Xo).insert({admission_date:Ce.admission_date,name:Ce.name,gender:Ce.gender,room:Ce.room,discharge_date:Ce.discharge_date||null,nationality:Ce.nationality,admin_status:Ce.admin_status,notes:Ce.notes,is_discharged:!1});if($e)throw $e;le++}}await ae();const Ee=[];le>0&&Ee.push(` : ${le}`),Ae>0&&Ee.push(`: ${Ae}`),Me>0&&Ee.push(` : ${Me}`),alert(` !
${Ee.join(`
`)}`)}catch(z){console.error("  :",z),alert(`   .
${z?.message||JSON.stringify(z)}`)}finally{Y(!1)}}},ce=r.length,ne=re.length,ie=ve.length,W=re.map(k=>({id:k.id,admission_date:k.admission_date,bupyeong:k.gender,ganghwa:k.name,room:k.room,discharge_date:k.discharge_date,location:k.nationality,admin_status:k.admin_status,notes:k.notes})),G=()=>{const de=`
      <div class="stats-grid">
        <div class="stat-box"><div class="label"> </div><div class="value">${ce}<span class="unit"> </span></div></div>
        <div class="stat-box highlight"><div class="label">  </div><div class="value">${ne}<span class="unit"> </span></div></div>
        <div class="stat-box"><div class="label"> </div><div class="value">${ie}<span class="unit"> </span></div></div>
      </div>
      <div class="section-title">   (${ne})</div>
      <table>
        <thead><tr>
          <th>No</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th>  ()</th>
          <th> </th>
          <th> </th>
          <th></th>
          <th></th>
        </tr></thead>
        <tbody>
          ${re.map((z,T)=>{const R=kc(z.room)?cd(z.admission_date):"";return`<tr>
              <td style="text-align:center">${T+1}</td>
              <td style="text-align:center">${z.nationality||"-"}</td>
              <td style="text-align:center">${Fs(z.admission_date)}</td>
              <td style="text-align:center">${z.name||"-"}</td>
              <td style="text-align:center">${z.gender||"-"}</td>
              <td style="text-align:center">${z.room||"-"}</td>
              <td style="text-align:center">${R?Fs(R):"-"}</td>
              <td style="text-align:center">${z.discharge_date?Fs(z.discharge_date):"-"}</td>
              <td style="text-align:center;white-space:pre-line">${z.admin_status||"-"}</td>
              <td>${z.notes||"-"}</td>
            </tr>`}).join("")}
        </tbody>
      </table>
    `;ml({title:"   ",content:de})};return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-emerald-500 to-teal-600 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(fl,{size:24})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-1",children:"  "}),a.jsx("p",{className:"text-white/90",children:t?"     ":"    "})]})]})}),a.jsxs(_t,{padding:"p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-emerald-50 border-b border-emerald-100 cursor-pointer",onClick:()=>L(!B),children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("h3",{className:"font-bold text-toss-gray-900",children:"  "})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:k=>{k.stopPropagation(),O(!0)},className:"p-2 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",title:" ",children:a.jsx(nm,{size:18})}),a.jsx("button",{onClick:k=>{k.stopPropagation(),G()},className:"p-2 text-toss-gray-600 hover:bg-emerald-100 rounded-lg transition-colors",title:" ",children:a.jsx(ia,{size:18})}),B?a.jsx(Wn,{size:20,className:"text-toss-gray-500"}):a.jsx(Cn,{size:20,className:"text-toss-gray-500"})]})]}),B&&a.jsx("div",{className:"p-4 sm:p-6",children:a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),a.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[ce,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),a.jsxs("div",{className:"bg-emerald-50 border-2 border-emerald-300 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-emerald-600 mb-1",children:"  "}),a.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:[ne,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),a.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),a.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[ie,a.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]})]})})]}),a.jsxs(_t,{padding:"p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-toss-gray-100",children:[a.jsxs("h3",{className:"font-bold text-toss-gray-900",children:["  ",a.jsxs("span",{className:"text-sm font-normal text-emerald-600 ml-1",children:["(",ne,")"]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(Ye,{variant:"secondary",size:"sm",onClick:P,children:[a.jsx(im,{size:16,className:"mr-1"}),""]}),a.jsxs(Ye,{variant:"secondary",size:"sm",onClick:()=>I.current?.click(),disabled:A,children:[a.jsx(Gn,{size:16,className:"mr-1"}),A?" ...":""]}),a.jsx("input",{ref:I,type:"file",accept:".xlsx,.xls",onChange:U,className:"hidden"}),a.jsxs(Ye,{variant:"secondary",size:"sm",onClick:se,children:[a.jsx(Jr,{size:16,className:"mr-1"}),""]}),a.jsxs(Ye,{variant:"primary",size:"sm",onClick:te,children:[a.jsx(os,{size:16,className:"mr-1"}),""]})]})]}),n?a.jsx("div",{className:"flex justify-center items-center py-20",children:a.jsx("div",{className:"w-10 h-10 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin"})}):re.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-toss-gray-400",children:[a.jsx(fl,{size:48,className:"mb-4"}),a.jsx("p",{className:"text-lg font-medium",children:"    "}),a.jsx("p",{className:"text-sm mt-1",children:"+     "})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsxs("thead",{children:[a.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-12",children:"No"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:"  ()"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",colSpan:2,children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-24",children:""})]}),a.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[a.jsx("th",{colSpan:6}),a.jsx("th",{className:"px-2 py-1 text-center text-[10px] font-medium text-toss-gray-500",children:" "}),a.jsx("th",{className:"px-2 py-1 text-center text-[10px] font-medium text-toss-gray-500",children:" "}),a.jsx("th",{colSpan:3})]})]}),a.jsx("tbody",{children:re.map((k,de)=>{const T=kc(k.room)?cd(k.admission_date):"",R=k.discharge_date;return a.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors bg-emerald-50/30",children:[a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:de+1}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:k.nationality||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm font-medium text-toss-gray-900 text-center",children:Fs(k.admission_date)}),a.jsx("td",{className:"px-3 py-3 text-sm font-medium text-toss-gray-900 text-center",children:k.name||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:k.gender||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:k.room||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center",children:T?a.jsx("span",{className:`font-medium ${f0(T)?"text-red-500":"text-emerald-600"}`,children:Fs(T)}):a.jsx("span",{className:"text-toss-gray-400",children:"-"})}),a.jsx("td",{className:"px-3 py-3 text-sm text-center",children:R&&R!==T?a.jsx("span",{className:`font-medium ${f0(R)?"text-red-500":"text-orange-600"}`,children:Fs(R)}):a.jsx("span",{className:"text-toss-gray-400",children:"-"})}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center whitespace-pre-line",children:k.admin_status||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 max-w-[150px] truncate",children:k.notes||"-"}),a.jsx("td",{className:"px-2 py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-1 whitespace-nowrap",children:[a.jsx("button",{onClick:()=>J(k.id),className:"px-2 py-1 text-xs font-medium text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",title:"",children:""}),a.jsx("button",{onClick:()=>ke(k),className:"p-1.5 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",title:"",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>Z(k.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:a.jsx(Xt,{size:16})})]})})]},k.id)})})]})}),a.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:re.map((k,de)=>{const T=kc(k.room)?cd(k.admission_date):"",R=k.discharge_date;return a.jsxs("div",{className:"px-3 py-2 bg-emerald-50/30",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",de+1]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>J(k.id),className:"px-2 py-0.5 text-xs font-medium text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",children:""}),a.jsx("button",{onClick:()=>ke(k),className:"p-1 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",children:a.jsx(js,{size:14})}),a.jsx("button",{onClick:()=>Z(k.id),className:"p-1 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:a.jsx(Xt,{size:14})})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-x-2 gap-y-1 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"font-medium text-toss-gray-900",children:k.name||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"text-toss-gray-700",children:k.nationality||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"text-toss-gray-700",children:k.gender||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"font-medium text-toss-gray-900",children:Fs(k.admission_date)})]}),T&&a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:" "}),a.jsx("p",{className:`font-medium ${f0(T)?"text-red-500":"text-emerald-600"}`,children:Fs(T)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:"/"}),a.jsx("p",{className:"text-toss-gray-700",children:k.room||"-"})]}),R&&R!==T&&a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:" "}),a.jsx("p",{className:`font-medium ${f0(R)?"text-red-500":"text-orange-600"}`,children:Fs(R)})]}),k.admin_status&&a.jsxs("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"text-toss-gray-500 whitespace-pre-line",children:k.admin_status})]}),k.notes&&a.jsxs("div",{className:"col-span-3",children:[a.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:k.notes})]})]})]},k.id)})})]})]}),ve.length>0&&a.jsxs(_t,{padding:"p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-gray-50 border-b border-toss-gray-200 cursor-pointer",onClick:()=>ue(!H),children:[a.jsxs("h3",{className:"font-bold text-toss-gray-700",children:["  ",a.jsxs("span",{className:"text-sm font-normal text-toss-gray-500 ml-1",children:["(",ie,")"]})]}),H?a.jsx(Wn,{size:20,className:"text-toss-gray-500"}):a.jsx(Cn,{size:20,className:"text-toss-gray-500"})]}),H&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-12",children:"No"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:"  ()"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-20",children:""})]})}),a.jsx("tbody",{children:ve.map((k,de)=>a.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors",children:[a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 text-center",children:de+1}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.nationality||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:Fs(k.admission_date)}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.name||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.gender||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.room||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:Fs(k.discharge_date)}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 text-center whitespace-pre-line",children:k.admin_status||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 max-w-[150px] truncate",children:k.notes||"-"}),a.jsx("td",{className:"px-3 py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("button",{onClick:()=>ke(k),className:"p-1.5 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",title:"",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>Z(k.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:a.jsx(Xt,{size:16})})]})})]},k.id))})]})}),a.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:ve.map((k,de)=>a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",de+1]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>ke(k),className:"p-1.5 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",children:a.jsx(js,{size:14})}),a.jsx("button",{onClick:()=>Z(k.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:a.jsx(Xt,{size:14})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:k.name||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:k.nationality||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:Fs(k.admission_date)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:Fs(k.discharge_date)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-500",children:k.gender||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:"  ()"}),a.jsx("p",{className:"text-toss-gray-500",children:k.room||"-"})]}),k.admin_status&&a.jsxs("div",{children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-400 whitespace-pre-line",children:k.admin_status})]}),k.notes&&a.jsxs("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),a.jsx("p",{className:"text-toss-gray-400",children:k.notes})]})]})]},k.id))})]})]}),a.jsx(cr,{isOpen:l,onClose:()=>{u(!1),b(null),N(ud)},title:y?"  ":"  ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:S.name,onChange:k=>N({...S,name:k.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsx("input",{type:"text",value:S.nationality,onChange:k=>N({...S,nationality:k.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsxs("select",{value:S.gender,onChange:k=>N({...S,gender:k.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 bg-white",children:[a.jsx("option",{value:"",children:""}),a.jsx("option",{value:"",children:""}),a.jsx("option",{value:"",children:""})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:"  ()"}),a.jsx("input",{type:"text",value:S.room,onChange:k=>N({...S,room:k.target.value}),placeholder:": 301  OO(301)",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",value:S.admission_date,onChange:k=>N({...S,admission_date:k.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"}),S.admission_date&&kc(S.room)&&a.jsxs("p",{className:"text-xs text-toss-gray-400 mt-1",children:[" : ",Fs(cd(S.admission_date))," ( )"]}),S.admission_date&&!kc(S.room)&&a.jsx("p",{className:"text-xs text-orange-400 mt-1",children:"      "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:" "}),a.jsx("input",{type:"date",value:S.discharge_date,onChange:k=>N({...S,discharge_date:k.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"}),a.jsx("p",{className:"text-xs text-toss-gray-400 mt-1",children:"  ,    "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsx("textarea",{value:S.admin_status,onChange:k=>N({...S,admin_status:k.target.value}),placeholder:"  (  )",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 resize-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),a.jsx("textarea",{value:S.notes,onChange:k=>N({...S,notes:k.target.value}),placeholder:" ",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 resize-none"})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{u(!1),b(null),N(ud)},children:""}),a.jsx(Ye,{variant:"primary",className:"flex-1",onClick:X,disabled:E,children:E?" ...":y?"":""})]})]})}),a.jsx(cr,{isOpen:d,onClose:()=>{h(!1),g(null)},title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 rounded-lg",children:[a.jsx(Nl,{size:24,className:"text-red-500 flex-shrink-0"}),a.jsx("p",{className:"text-sm text-red-700",children:"   ?     ."})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{h(!1),g(null)},children:""}),a.jsx(Ye,{variant:"danger",className:"flex-1",onClick:M,children:""})]})]})}),a.jsx(cr,{isOpen:m,onClose:()=>{x(!1),w(null)},title:" ",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-orange-50 rounded-lg",children:[a.jsx(Lc,{size:24,className:"text-orange-500 flex-shrink-0"}),a.jsxs("p",{className:"text-sm text-orange-700",children:["   ?  (",Fs(new Date().toISOString().split("T")[0]),") ."]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(Ye,{variant:"secondary",className:"flex-1",onClick:()=>{x(!1),w(null)},children:""}),a.jsx(Ye,{variant:"primary",className:"flex-1 !bg-orange-500 hover:!bg-orange-600",onClick:V,children:" "})]})]})}),a.jsx(kb,{isOpen:F,onClose:()=>O(!1),records:W,stats:{total:ce,active:ne,discharged:ie},backgroundImage:"back_bp.jpg",centerType:"bupyeong"})]})}const V3=e=>e?e.length===3?e[0]+"O"+e[2]:e.length===2?e[0]+"O":e.length>=4?e[0]+"O".repeat(e.length-2)+e[e.length-1]:e:"",K3=e=>{if(!e)return"";const t=new Date(e);return t.getFullYear()+"."+String(t.getMonth()+1).padStart(2,"0")+"."+String(t.getDate()).padStart(2,"0")};function pQ(){const[e,t]=K.useState([{id:1,roomNum:"",persons:[{date:"",gender:"",name:""},{date:"",gender:"",name:""}]}]),[r,s]=K.useState(2),[n,o]=K.useState(!1),[l,u]=K.useState({col1:16.5,col2:53.6,col3:63.6,row1:23.4,row2:55.5}),[d,h]=K.useState({data:23,name:31,room:22}),m=()=>{t(B=>[...B,{id:r,roomNum:"",persons:[{date:"",gender:"",name:""},{date:"",gender:"",name:""}]}]),s(B=>B+1)},x=B=>{t(L=>L.filter(H=>H.id!==B))},y=(B,L,H,ue)=>{t(A=>A.map(Y=>{if(Y.id!==B)return Y;if(ue!==void 0){const I=[...Y.persons];return I[ue]={...I[ue],[L]:H},{...Y,persons:I}}return{...Y,[L]:H}}))},b=()=>{t([{id:1,roomNum:"",persons:[{date:"",gender:"",name:""},{date:"",gender:"",name:""}]}]),s(2)},v=(B,L)=>u(H=>({...H,[B]:parseFloat(L)})),g=(B,L)=>h(H=>({...H,[B]:parseInt(L)})),_=()=>{const B=`col1:${l.col1} col2:${l.col2} col3:${l.col3} row1:${l.row1} row2:${l.row2} data:${d.data}px name:${d.name}px room:${d.room}px`;navigator.clipboard.writeText(B).then(()=>alert(": "+B))},w=l.col2-l.col1,S=l.col3-l.col2,N=100-l.col3,E=l.row2-l.row1,C=96-l.row2,F={roomNum:{left:0,top:"23.4%",width:`${l.col1}%`,height:"72.6%",fontSize:`${d.room}px`,fontWeight:900,color:"#000"},r1Date:{left:`${l.col1}%`,top:`${l.row1}%`,width:`${w}%`,height:`${E}%`,fontSize:`${d.data}px`,fontWeight:500},r1Gender:{left:`${l.col2}%`,top:`${l.row1}%`,width:`${S}%`,height:`${E}%`,fontSize:`${d.data}px`,fontWeight:500},r1Name:{left:`${l.col3}%`,top:`${l.row1}%`,width:`${N}%`,height:`${E}%`,fontSize:`${d.name}px`,fontWeight:800},r2Date:{left:`${l.col1}%`,top:`${l.row2}%`,width:`${w}%`,height:`${C}%`,fontSize:`${d.data}px`,fontWeight:500},r2Gender:{left:`${l.col2}%`,top:`${l.row2}%`,width:`${S}%`,height:`${C}%`,fontSize:`${d.data}px`,fontWeight:500},r2Name:{left:`${l.col3}%`,top:`${l.row2}%`,width:`${N}%`,height:`${C}%`,fontSize:`${d.name}px`,fontWeight:800}},O={position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"'Noto Sans KR', sans-serif",color:"#1d1d1f"};return a.jsxs(a.Fragment,{children:[a.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;900&display=swap');
        @media print {
          * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
          body { background: #fff !important; margin: 0 !important; padding: 0 !important; }
          .print-hide { display: none !important; }
          .nametag-print-area {
            display: flex !important; flex-wrap: wrap !important; flex-direction: row !important;
            gap: 4mm !important; justify-content: center !important; align-items: flex-start !important;
            padding: 5mm !important;
          }
          .nametag-tag-wrap {
            background: transparent !important; padding: 0 !important; margin: 0 !important;
            box-shadow: none !important; border: none !important;
            page-break-inside: avoid; break-inside: avoid;
            display: inline-block; width: auto; height: auto;
          }
          .nametag-box, .nametag-box * {
            box-shadow: none !important; outline: none !important;
            text-shadow: none !important; filter: none !important;
          }
          aside, header, nav, [class*="shadow-toss"] { display: none !important; }
          main, [class*="flex-1"], [class*="ml-64"] {
            margin: 0 !important; padding: 0 !important; width: 100% !important;
          }
          @page { margin: 5mm; size: auto; }
        }
      `}),a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{padding:"p-0",className:"print-hide overflow-hidden",children:a.jsx("div",{className:"bg-gradient-to-r from-toss-blue to-blue-600 p-6 md:p-8",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-toss flex items-center justify-center",children:a.jsx(Md,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl md:text-2xl font-bold text-white",children:" "}),a.jsx("p",{className:"text-blue-100 text-sm mt-1",children:"    "})]})]})})}),a.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[a.jsxs("div",{className:"w-full lg:w-[400px] lg:min-w-[400px] space-y-4 print-hide",children:[a.jsxs(_t,{children:[a.jsx("div",{className:"flex items-center justify-between mb-4",children:a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-semibold text-toss-gray-500 uppercase tracking-wider",children:""}),a.jsxs("p",{className:"text-sm font-medium text-toss-gray-900 mt-1",children:[": ",a.jsx("strong",{children:"130 x 45 mm"})]})]})}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs(Ye,{size:"sm",variant:"primary",onClick:m,children:[a.jsx(os,{size:16})," "]}),a.jsxs(Ye,{size:"sm",variant:"secondary",onClick:b,children:[a.jsx(TF,{size:16})," "]}),a.jsxs(Ye,{size:"sm",variant:"primary",onClick:()=>window.print(),className:"ml-auto",children:[a.jsx(ia,{size:16})," "]})]})]}),a.jsxs(_t,{padding:"p-0",children:[a.jsxs("button",{onClick:()=>o(!n),className:"w-full flex items-center justify-between p-4 text-sm font-semibold text-toss-gray-700 hover:bg-toss-gray-50 transition-all rounded-toss-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(_l,{size:16,className:"text-toss-gray-500"}),"  ()"]}),n?a.jsx(Wn,{size:16}):a.jsx(Cn,{size:16})]}),n&&a.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[a.jsx("div",{className:"text-[11px] font-semibold text-toss-gray-500 uppercase tracking-wider",children:" "}),[{label:"|",key:"col1",min:5,max:25},{label:"|",key:"col2",min:30,max:65},{label:"|",key:"col3",min:40,max:75}].map(B=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-toss-gray-500 min-w-[80px]",children:B.label}),a.jsx("input",{type:"range",min:B.min,max:B.max,step:"0.1",value:l[B.key],onChange:L=>v(B.key,L.target.value),className:"flex-1 h-1 accent-toss-blue"}),a.jsxs("span",{className:"text-xs text-toss-gray-400 min-w-[40px] text-right tabular-nums",children:[l[B.key],"%"]})]},B.key)),a.jsx("div",{className:"text-[11px] font-semibold text-toss-gray-500 uppercase tracking-wider pt-2",children:" "}),[{label:"|1",key:"row1",min:15,max:35},{label:"1|2",key:"row2",min:45,max:70}].map(B=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-toss-gray-500 min-w-[80px]",children:B.label}),a.jsx("input",{type:"range",min:B.min,max:B.max,step:"0.1",value:l[B.key],onChange:L=>v(B.key,L.target.value),className:"flex-1 h-1 accent-toss-blue"}),a.jsxs("span",{className:"text-xs text-toss-gray-400 min-w-[40px] text-right tabular-nums",children:[l[B.key],"%"]})]},B.key)),a.jsx("div",{className:"text-[11px] font-semibold text-toss-gray-500 uppercase tracking-wider pt-2",children:" "}),[{label:"/",key:"data",min:10,max:30},{label:"",key:"name",min:16,max:40},{label:"",key:"room",min:14,max:36}].map(B=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-toss-gray-500 min-w-[80px]",children:B.label}),a.jsx("input",{type:"range",min:B.min,max:B.max,step:"1",value:d[B.key],onChange:L=>g(B.key,L.target.value),className:"flex-1 h-1 accent-toss-blue"}),a.jsxs("span",{className:"text-xs text-toss-gray-400 min-w-[40px] text-right tabular-nums",children:[d[B.key],"px"]})]},B.key)),a.jsxs("button",{onClick:_,className:"mt-2 flex items-center gap-1 text-xs text-toss-gray-600 hover:text-toss-blue transition-colors",children:[a.jsx(am,{size:12})," CSS  "]})]})]}),a.jsxs(_t,{children:[a.jsxs("div",{className:"text-xs font-semibold text-toss-gray-500 uppercase tracking-wider mb-3",children:["  (",e.length,")"]}),a.jsx("div",{className:"space-y-3",children:e.map((B,L)=>a.jsxs("div",{className:"bg-toss-gray-50 rounded-toss p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"text-sm font-bold text-toss-gray-900",children:[" ",L+1]}),B.roomNum&&a.jsxs("span",{className:"text-[11px] font-semibold text-toss-blue bg-toss-blue/10 px-2 py-0.5 rounded-full",children:[B.roomNum,""]})]}),a.jsx("button",{onClick:()=>x(B.id),className:"text-toss-gray-400 hover:text-red-500 transition-colors",children:a.jsx(Xt,{size:16})})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-xs font-medium text-toss-gray-500 min-w-[56px]",children:""}),a.jsx("input",{type:"text",placeholder:"102",value:B.roomNum,onChange:H=>y(B.id,"roomNum",H.target.value),className:"w-20 px-3 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"})]}),a.jsx("div",{className:"h-px bg-toss-gray-200 my-3"}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-xs font-medium text-toss-gray-500 min-w-[56px]",children:"1"}),a.jsxs("div",{className:"flex gap-1.5 flex-1 flex-wrap",children:[a.jsx("input",{type:"date",value:B.persons[0].date,onChange:H=>y(B.id,"date",H.target.value,0),className:"px-2.5 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"}),a.jsxs("select",{value:B.persons[0].gender,onChange:H=>y(B.id,"gender",H.target.value,0),className:"min-w-[60px] px-2 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all",children:[a.jsx("option",{value:"",children:""}),a.jsx("option",{value:"",children:""}),a.jsx("option",{value:"",children:""})]}),a.jsx("input",{type:"text",placeholder:"",value:B.persons[0].name,onChange:H=>y(B.id,"name",H.target.value,0),className:"flex-1 min-w-[70px] px-3 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs font-medium text-toss-gray-500 min-w-[56px]",children:"2"}),a.jsxs("div",{className:"flex gap-1.5 flex-1 flex-wrap",children:[a.jsx("input",{type:"date",value:B.persons[1].date,onChange:H=>y(B.id,"date",H.target.value,1),className:"px-2.5 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"}),a.jsxs("select",{value:B.persons[1].gender,onChange:H=>y(B.id,"gender",H.target.value,1),className:"min-w-[60px] px-2 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all",children:[a.jsx("option",{value:"",children:""}),a.jsx("option",{value:"",children:""}),a.jsx("option",{value:"",children:""})]}),a.jsx("input",{type:"text",placeholder:"",value:B.persons[1].name,onChange:H=>y(B.id,"name",H.target.value,1),className:"flex-1 min-w-[70px] px-3 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"})]})]})]},B.id))})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx(_t,{className:"print-hide mb-4",children:a.jsx("span",{className:"text-xs font-semibold text-toss-gray-500 uppercase tracking-wider",children:""})}),a.jsx("div",{className:"nametag-print-area flex flex-col gap-6 items-center",children:e.length===0?a.jsx(_t,{className:"w-full text-center py-16",children:a.jsx("p",{className:"text-toss-gray-400 text-sm",children:" "})}):e.map(B=>a.jsx("div",{className:"nametag-tag-wrap",children:a.jsxs("div",{className:"nametag-box",style:{width:"130mm",height:"45mm",position:"relative",backgroundImage:"url('/company-intranet/name.jpg')",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",overflow:"hidden"},children:[a.jsx("div",{style:{...O,...F.roomNum},children:B.roomNum?B.roomNum+"":""}),a.jsx("div",{style:{...O,...F.r1Date},children:K3(B.persons[0].date)}),a.jsx("div",{style:{...O,...F.r1Gender},children:B.persons[0].gender}),a.jsx("div",{style:{...O,...F.r1Name},children:V3(B.persons[0].name)}),a.jsx("div",{style:{...O,...F.r2Date},children:K3(B.persons[1].date)}),a.jsx("div",{style:{...O,...F.r2Gender},children:B.persons[1].gender}),a.jsx("div",{style:{...O,...F.r2Name},children:V3(B.persons[1].name)})]})},B.id))})]})]})]})]})}const xQ=["","","","","","CIS","","",""],gQ={:2816295,:577483,:2820200,:106348,"CIS":444971,:213161,:10422,:17823},X3=7006703,py=[{country:"",population:454,region:""},{country:"",population:58,region:""},{country:"",population:7,region:""},{country:"",population:57,region:""},{country:"",population:5680,region:""},{country:"",population:56,region:""},{country:"",population:379,region:""},{country:"",population:40,region:""},{country:"",population:9,region:""},{country:"",population:33,region:""},{country:"",population:0,region:""},{country:"",population:513,region:""},{country:"",population:16,region:""},{country:"",population:4085,region:""},{country:"",population:10807,region:""},{country:"",population:590,region:""},{country:"",population:8067,region:""},{country:"",population:39155,region:""},{country:"",population:0,region:""},{country:"",population:11,region:""},{country:"",population:626,region:""},{country:"",population:5319,region:""},{country:"",population:9008,region:""},{country:"",population:569,region:""},{country:"",population:0,region:""},{country:"",population:52588,region:""},{country:"",population:137,region:""},{country:"",population:2090,region:""},{country:"",population:31,region:""},{country:"",population:68,region:""},{country:"",population:113042,region:"CIS"},{country:"",population:140,region:""},{country:"",population:9,region:""},{country:"",population:407,region:""},{country:"",population:915,region:""},{country:"",population:215,region:""},{country:"",population:11,region:""},{country:"",population:81,region:""},{country:"",population:4,region:""},{country:"",population:264,region:""},{country:"",population:25,region:""},{country:"",population:10,region:""},{country:"",population:161,region:""},{country:"",population:17979,region:""},{country:"",population:16,region:""},{country:"",population:13680,region:""},{country:"",population:6,region:""},{country:"",population:395,region:""},{country:"",population:33,region:""},{country:"",population:50,region:""},{country:"",population:187,region:""},{country:"",population:10,region:""},{country:"",population:76,region:"CIS"},{country:"",population:23,region:""},{country:"",population:230,region:""},{country:"",population:1765,region:""},{country:"",population:2557047,region:""},{country:"",population:1919,region:""},{country:"",population:53,region:""},{country:"",population:150,region:""},{country:"",population:0,region:""},{country:"",population:0,region:""},{country:"",population:1413,region:""},{country:"",population:32,region:""},{country:"",population:112,region:""},{country:"",population:192683,region:""},{country:"",population:5283,region:""},{country:"",population:450,region:"CIS"},{country:"",population:10,region:""},{country:"",population:12,region:""},{country:"",population:87,region:""},{country:"",population:585,region:""},{country:"",population:21,region:""},{country:"",population:41,region:""},{country:"",population:9,region:""},{country:"",population:19,region:""},{country:"",population:231,region:""},{country:"",population:51640,region:""},{country:"",population:154,region:""},{country:"",population:6,region:""},{country:"",population:3011,region:""},{country:"",population:151,region:""},{country:"",population:0,region:""},{country:"",population:0,region:""},{country:"",population:338,region:""},{country:"",population:158,region:""},{country:"",population:3,region:""},{country:"",population:7,region:""},{country:"",population:4,region:""},{country:"",population:0,region:""},{country:"",population:1,region:""},{country:"",population:58,region:""},{country:"",population:0,region:""},{country:"",population:48,region:""},{country:"",population:4698,region:""},{country:"",population:363,region:""},{country:"",population:11767,region:""},{country:"",population:4281,region:""},{country:"",population:1588,region:""},{country:"",population:69,region:""},{country:"",population:52,region:""},{country:"",population:25032,region:""},{country:"",population:8492,region:""},{country:"",population:358,region:"CIS"},{country:"",population:23208,region:""},{country:"",population:40,region:""},{country:"",population:54,region:""},{country:"",population:1371,region:""},{country:"",population:180,region:"CIS"},{country:"",population:4,region:""},{country:"",population:4,region:""},{country:"",population:133,region:""},{country:"",population:240,region:""},{country:"",population:76,region:""},{country:"",population:0,region:""},{country:"",population:0,region:""},{country:"",population:92,region:""},{country:"",population:223,region:""},{country:"",population:572,region:""},{country:"",population:292,region:""},{country:"",population:225,region:""},{country:"",population:47006,region:""},{country:"",population:6,region:""},{country:"",population:141,region:""},{country:"",population:2710,region:""},{country:"",population:341,region:""},{country:"",population:371,region:""},{country:"",population:640,region:""},{country:"",population:179,region:""},{country:"",population:175338,region:"CIS"},{country:"",population:12800,region:"CIS"},{country:"",population:4550,region:""},{country:"",population:377,region:""},{country:"",population:139,region:""},{country:"",population:489,region:""},{country:"",population:1219,region:""},{country:"",population:12288,region:""},{country:"",population:27308,region:""},{country:"",population:960970,region:""},{country:"",population:61,region:""},{country:"",population:170,region:""},{country:"",population:80,region:""},{country:"",population:306,region:"CIS"},{country:"",population:1848241,region:""},{country:"",population:7,region:""},{country:"",population:7,region:""},{country:"",population:92,region:""},{country:"",population:32,region:""},{country:"",population:3039,region:""},{country:"",population:2348,region:""},{country:"",population:87,region:""},{country:"",population:11,region:""},{country:"",population:122554,region:"CIS"},{country:"",population:1993,region:""},{country:"",population:10626,region:""},{country:"",population:263153,region:""},{country:"",population:1138,region:""},{country:"",population:5,region:""},{country:"",population:21,region:""},{country:"",population:334,region:""},{country:"",population:156,region:""},{country:"",population:468,region:""},{country:"",population:2,region:""},{country:"",population:94,region:""},{country:"",population:33,region:""},{country:"",population:422,region:""},{country:" ",population:0,region:""},{country:"",population:141,region:""},{country:"",population:18434,region:"CIS"},{country:"",population:6,region:""},{country:"",population:342,region:"CIS"},{country:"",population:625,region:""},{country:"",population:20872,region:""},{country:"",population:2449,region:""},{country:"",population:65,region:""},{country:"",population:21,region:""},{country:"",population:1167,region:"CIS"},{country:"",population:0,region:""},{country:"",population:177,region:""},{country:"",population:51,region:""},{country:"",population:487,region:""},{country:"",population:3960,region:""},{country:"",population:536,region:""},{country:"",population:126,region:""},{country:"",population:28,region:""},{country:"",population:1003,region:""},{country:"",population:538,region:""},{country:"",population:3570,region:""},{country:"",population:28103,region:""},{country:"",population:1059,region:""},{country:"",population:1063,region:""},{country:"",population:52695,region:""},{country:"",population:7297,region:""},{country:"",population:170215,region:""}];function yQ(){const[e,t]=K.useState(""),[r,s]=K.useState(""),[n,o]=K.useState("population"),[l,u]=K.useState("desc"),[d,h]=K.useState(1),m=60,x=K.useMemo(()=>{let E=[...py];if(r!==""&&(E=E.filter(C=>C.region===r)),e.trim()){const C=e.trim().toLowerCase();E=E.filter(F=>F.country.toLowerCase().includes(C))}return E.sort((C,F)=>n==="population"?l==="asc"?C.population-F.population:F.population-C.population:l==="asc"?C.country.localeCompare(F.country,"ko"):F.country.localeCompare(C.country,"ko")),E},[e,r,n,l]);K.useMemo(()=>{h(1)},[e,r,n,l]);const y=E=>{n===E?u(C=>C==="asc"?"desc":"asc"):(o(E),u(E==="population"?"desc":"asc"))},b=({field:E})=>n!==E?null:l==="asc"?a.jsx(Wn,{size:14}):a.jsx(Cn,{size:14}),v=Math.max(1,Math.ceil(x.length/m)),g=x.slice((d-1)*m,d*m),_=x.reduce((E,C)=>E+C.population,0),w=E=>E.toLocaleString(),S={:{badge:"bg-red-50 text-red-700 border-red-200",bg:"from-red-500 to-red-600"},:{badge:"bg-blue-50 text-blue-700 border-blue-200",bg:"from-blue-500 to-blue-600"},:{badge:"bg-indigo-50 text-indigo-700 border-indigo-200",bg:"from-indigo-500 to-indigo-600"},:{badge:"bg-amber-50 text-amber-700 border-amber-200",bg:"from-amber-500 to-amber-600"},"CIS":{badge:"bg-purple-50 text-purple-700 border-purple-200",bg:"from-purple-500 to-purple-600"},:{badge:"bg-emerald-50 text-emerald-700 border-emerald-200",bg:"from-emerald-500 to-emerald-600"},:{badge:"bg-orange-50 text-orange-700 border-orange-200",bg:"from-orange-500 to-orange-600"},:{badge:"bg-teal-50 text-teal-700 border-teal-200",bg:"from-teal-500 to-teal-600"}},N=K.useMemo(()=>[...py].sort((E,C)=>C.population-E.population).slice(0,5),[]);return a.jsxs("div",{className:"space-y-4",children:[a.jsx(_t,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(Dy,{size:24})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h2",{className:"text-xl font-bold mb-1",children:" "}),a.jsx("p",{className:"text-white/90 text-sm",children:"2025  (: 2024.12.31, : )"})]}),a.jsxs("div",{className:"text-right hidden sm:block",children:[a.jsx("p",{className:"text-white/70 text-xs",children:"  "}),a.jsxs("p",{className:"text-2xl font-bold",children:[w(X3),a.jsx("span",{className:"text-sm font-normal text-white/80 ml-1",children:""})]}),a.jsx("p",{className:"text-white/70 text-xs",children:"194"})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[a.jsxs(_t,{className:"p-5",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(BF,{size:16,className:"text-toss-blue"}),a.jsx("h3",{className:"text-sm font-bold text-toss-gray-800",children:" 5"})]}),a.jsx("div",{className:"space-y-2",children:N.map((E,C)=>{const F=E.population/N[0].population*100;return a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold ${C===0?"bg-yellow-400 text-yellow-900":C===1?"bg-gray-300 text-gray-700":C===2?"bg-orange-300 text-orange-800":"bg-toss-gray-100 text-toss-gray-500"}`,children:C+1}),a.jsx("span",{className:"text-sm font-medium text-toss-gray-800 w-24 shrink-0",children:E.country}),a.jsx("div",{className:"flex-1 h-5 bg-toss-gray-50 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-gradient-to-r from-toss-blue to-blue-400 rounded-full transition-all",style:{width:`${F}%`}})}),a.jsx("span",{className:"text-sm font-bold text-toss-gray-700 tabular-nums w-24 text-right",children:w(E.population)})]},E.country)})})]}),a.jsxs(_t,{className:"p-5",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(Dy,{size:16,className:"text-toss-blue"}),a.jsx("h3",{className:"text-sm font-bold text-toss-gray-800",children:" "})]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(gQ).map(([E,C])=>{const F=(C/X3*100).toFixed(1),O=r===E;return a.jsxs("button",{onClick:()=>s(O?"":E),className:`flex items-center justify-between px-3 py-2 rounded-lg text-left transition-all ${O?"bg-toss-blue/10 ring-1 ring-toss-blue":"bg-toss-gray-50 hover:bg-toss-gray-100"}`,children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-toss-gray-500",children:E}),a.jsx("p",{className:"text-sm font-bold text-toss-gray-800",children:w(C)})]}),a.jsxs("span",{className:"text-xs text-toss-gray-400 font-medium",children:[F,"%"]})]},E)})})]})]}),a.jsxs(_t,{className:"p-0 overflow-hidden",children:[a.jsxs("div",{className:"px-4 pt-4 pb-3 border-b border-toss-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(qa,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),a.jsx("input",{type:"text",placeholder:" ...",value:e,onChange:E=>t(E.target.value),className:"w-full pl-9 pr-4 py-2 border border-toss-gray-200 rounded-lg focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue outline-none text-sm"})]}),a.jsxs("div",{className:"flex items-center border border-toss-gray-200 rounded-lg overflow-hidden shrink-0",children:[a.jsxs("button",{onClick:()=>y("population"),className:`px-3 py-2 text-xs font-medium transition-colors flex items-center gap-1 ${n==="population"?"bg-toss-blue text-white":"bg-white text-toss-gray-600 hover:bg-toss-gray-50"}`,children:[" ",n==="population"&&a.jsx(b,{field:"population"})]}),a.jsxs("button",{onClick:()=>y("country"),className:`px-3 py-2 text-xs font-medium transition-colors flex items-center gap-1 border-l border-toss-gray-200 ${n==="country"?"bg-toss-blue text-white":"bg-white text-toss-gray-600 hover:bg-toss-gray-50"}`,children:[" ",n==="country"&&a.jsx(b,{field:"country"})]})]})]}),a.jsx("div",{className:"flex flex-wrap gap-1.5 mt-3",children:xQ.map(E=>a.jsxs("button",{onClick:()=>s(E),className:`px-3 py-1 text-xs font-medium rounded-full border transition-colors ${r===E?"bg-toss-blue text-white border-toss-blue":"bg-white text-toss-gray-600 border-toss-gray-200 hover:border-toss-blue hover:text-toss-blue"}`,children:[E,E!==""&&a.jsx("span",{className:"ml-1 opacity-70",children:py.filter(C=>C.region===E).length})]},E))}),a.jsxs("p",{className:"mt-2 text-xs text-toss-gray-400",children:[r!==""&&a.jsxs("span",{className:"text-toss-blue font-medium",children:[r,"  "]}),x.length,"   ",w(_),""]})]}),x.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-toss-gray-400",children:[a.jsx(Gc,{size:40,className:"mb-3"}),a.jsx("p",{className:"text-sm",children:"  "})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:g.map((E,C)=>{const F=(d-1)*m+C+1;return a.jsxs("div",{className:"flex items-center gap-2.5 px-4 py-2 hover:bg-toss-gray-50",children:[a.jsx("span",{className:"text-xs text-toss-gray-400 tabular-nums w-6 text-right shrink-0",children:F}),a.jsx("span",{className:"text-sm font-semibold text-toss-gray-900 truncate",children:E.country}),a.jsx("span",{className:`px-1.5 py-0.5 text-[10px] font-medium rounded border shrink-0 ${S[E.region]?.badge||"bg-gray-50 text-gray-600 border-gray-200"}`,children:E.region}),a.jsx("span",{className:"text-sm font-bold text-toss-gray-700 tabular-nums ml-auto shrink-0",children:w(E.population)})]},E.country)})}),a.jsx("div",{className:"hidden md:grid md:grid-cols-2 lg:hidden divide-x divide-toss-gray-100",children:(()=>{const E=Math.ceil(g.length/2);return[0,1].map(C=>a.jsx("div",{className:"divide-y divide-toss-gray-100",children:g.slice(C*E,(C+1)*E).map((F,O)=>{const B=(d-1)*m+C*E+O+1;return a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 hover:bg-toss-gray-50",children:[a.jsx("span",{className:"text-[11px] text-toss-gray-400 tabular-nums w-5 text-right shrink-0",children:B}),a.jsx("span",{className:"text-[13px] font-semibold text-toss-gray-900 truncate",children:F.country}),a.jsx("span",{className:`px-1 py-px text-[9px] font-medium rounded border shrink-0 ${S[F.region]?.badge||"bg-gray-50 text-gray-600 border-gray-200"}`,children:F.region}),a.jsx("span",{className:"text-[13px] font-bold text-toss-gray-700 tabular-nums ml-auto shrink-0",children:w(F.population)})]},F.country)})},C))})()}),a.jsx("div",{className:"hidden lg:grid lg:grid-cols-3 divide-x divide-toss-gray-100",children:(()=>{const E=Math.ceil(g.length/3);return[0,1,2].map(C=>a.jsx("div",{className:"divide-y divide-toss-gray-100",children:g.slice(C*E,(C+1)*E).map((F,O)=>{const B=(d-1)*m+C*E+O+1;return a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 hover:bg-toss-gray-50",children:[a.jsx("span",{className:"text-[11px] text-toss-gray-400 tabular-nums w-5 text-right shrink-0",children:B}),a.jsx("span",{className:"text-[13px] font-semibold text-toss-gray-900 truncate",children:F.country}),a.jsx("span",{className:`px-1 py-px text-[9px] font-medium rounded border shrink-0 ${S[F.region]?.badge||"bg-gray-50 text-gray-600 border-gray-200"}`,children:F.region}),a.jsx("span",{className:"text-[13px] font-bold text-toss-gray-700 tabular-nums ml-auto shrink-0",children:w(F.population)})]},F.country)})},C))})()}),v>1&&a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-toss-gray-100 bg-toss-gray-50",children:[a.jsxs("button",{onClick:()=>h(E=>Math.max(1,E-1)),disabled:d===1,className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium rounded-lg border border-toss-gray-200 bg-white hover:bg-toss-gray-50 disabled:opacity-30 transition-colors",children:[a.jsx(xa,{size:14})," "]}),a.jsxs("span",{className:"text-xs text-toss-gray-500",children:[a.jsx("strong",{className:"text-toss-gray-700",children:d})," / ",v," "]}),a.jsxs("button",{onClick:()=>h(E=>Math.min(v,E+1)),disabled:d===v,className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium rounded-lg border border-toss-gray-200 bg-white hover:bg-toss-gray-50 disabled:opacity-30 transition-colors",children:[" ",a.jsx(Js,{size:14})]})]})]})]})]})}const vQ="91b8982da85038c643d0b4ed6c988c0c87ecdfad04624fd1bfc795eddcf68104",bQ="https://apis.data.go.kr/1262000/OverseasKoreanGroupService/getOverseasKoreanGroupList";function wQ(){const[e,t]=K.useState([]),[r,s]=K.useState(!1),[n,o]=K.useState(null),[l,u]=K.useState(""),[d,h]=K.useState(""),[m,x]=K.useState(1),[y,b]=K.useState(0),[v,g]=K.useState(null),_=20,w=K.useCallback(async(F,O)=>{s(!0),o(null);try{const B=new URLSearchParams({serviceKey:vQ,numOfRows:String(_),pageNo:String(F),returnType:"JSON"});O&&B.set("cond[country_nm::EQ]",O);const L=await fetch(`${bQ}?${B}`);if(!L.ok)throw new Error(`HTTP ${L.status}`);const H=await L.json(),ue=H?.data||H?.response?.body?.items||[],A=H?.totalCount||H?.response?.body?.totalCount||0;t(Array.isArray(ue)?ue:[]),b(A)}catch(B){const L=B instanceof Error?B.message:"   ";o(`    : ${L}`)}finally{s(!1)}},[]);K.useEffect(()=>{w(1)},[w]);const S=()=>{x(1),w(1,l.trim()||void 0)},N=F=>{h(F),u(F),x(1),w(1,F||void 0)},E=F=>{x(F),w(F,d||void 0)},C=Math.ceil(y/_);return a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"p-0 overflow-hidden",children:a.jsxs("div",{className:"bg-gradient-to-r from-emerald-500 to-green-600 text-white p-6 lg:p-8",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(o4,{size:28}),a.jsx("h1",{className:"text-2xl font-bold",children:"  ()"})]}),a.jsx("p",{className:"text-green-100",children:"  ,      "})]})}),a.jsxs(_t,{className:"p-4",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(qa,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),a.jsx("input",{type:"text",placeholder:"  (: , , )...",value:l,onChange:F=>u(F.target.value),onKeyDown:F=>F.key==="Enter"&&S(),className:"w-full pl-10 pr-4 py-2.5 border border-toss-gray-200 rounded-lg focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none"})]}),a.jsxs("button",{onClick:S,disabled:r,className:"flex items-center gap-2 px-4 py-2.5 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors disabled:opacity-50",children:[a.jsx(qa,{size:16}),""]}),a.jsxs("button",{onClick:()=>{u(""),h(""),w(1)},disabled:r,className:"flex items-center gap-2 px-4 py-2.5 border border-toss-gray-200 rounded-lg hover:bg-toss-gray-50 transition-colors disabled:opacity-50",children:[a.jsx(il,{size:16,className:r?"animate-spin":""}),""]})]}),y>0&&a.jsxs("p",{className:"mt-3 text-sm text-toss-gray-500",children:[" ",a.jsx("strong",{children:y.toLocaleString()}),"  "]})]}),n&&a.jsx(_t,{className:"p-4 border-l-4 border-red-500 bg-red-50",children:a.jsx("p",{className:"text-red-700 text-sm",children:n})}),r?a.jsx("div",{className:"flex items-center justify-center py-20",children:a.jsx("div",{className:"w-10 h-10 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin"})}):e.length===0&&!n?a.jsx(_t,{className:"p-0",children:a.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-toss-gray-400",children:[a.jsx(o4,{size:48,className:"mb-4"}),a.jsx("p",{children:y===0?"   API  ":"  "})]})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map((F,O)=>a.jsxs(_t,{className:"p-4 hover:shadow-md transition-shadow cursor-pointer border border-toss-gray-100",onClick:()=>g(F),children:[a.jsx("div",{className:"flex items-start justify-between mb-3",children:a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-bold text-toss-gray-900 truncate",children:F.grp_nm||"-"}),a.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-emerald-50 text-emerald-700 text-xs font-medium rounded-full cursor-pointer hover:bg-emerald-100",onClick:B=>{B.stopPropagation(),N(F.country_nm)},children:F.country_nm||"-"})]})}),F.charger_nm&&a.jsxs("p",{className:"text-sm text-toss-gray-600 flex items-center gap-1.5 mb-1",children:[a.jsx(Si,{size:14,className:"text-toss-gray-400 flex-shrink-0"}),F.charger_nm]}),F.email&&a.jsxs("p",{className:"text-sm text-toss-gray-600 flex items-center gap-1.5 mb-1",children:[a.jsx(Oy,{size:14,className:"text-toss-gray-400 flex-shrink-0"}),a.jsx("span",{className:"truncate",children:F.email})]}),F.foreign_addr&&a.jsxs("p",{className:"text-sm text-toss-gray-500 flex items-start gap-1.5 mt-2",children:[a.jsx(Id,{size:14,className:"text-toss-gray-400 flex-shrink-0 mt-0.5"}),a.jsx("span",{className:"line-clamp-2",children:F.foreign_addr})]})]},F.id||O))}),C>1&&a.jsxs("div",{className:"flex items-center justify-center gap-2 py-4",children:[a.jsx("button",{onClick:()=>E(m-1),disabled:m===1,className:"p-2 rounded-lg border border-toss-gray-200 hover:bg-toss-gray-50 disabled:opacity-30",children:a.jsx(xa,{size:18})}),a.jsxs("span",{className:"text-sm text-toss-gray-600 px-3",children:[m," / ",C]}),a.jsx("button",{onClick:()=>E(m+1),disabled:m===C,className:"p-2 rounded-lg border border-toss-gray-200 hover:bg-toss-gray-50 disabled:opacity-30",children:a.jsx(Js,{size:18})})]})]}),v&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>g(null),children:a.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg mx-4 max-h-[80vh] overflow-y-auto",onClick:F=>F.stopPropagation(),children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold text-toss-gray-900 pr-4",children:v.grp_nm}),a.jsx("button",{onClick:()=>g(null),className:"text-toss-gray-400 hover:text-toss-gray-600 flex-shrink-0",children:""})]}),a.jsx("span",{className:"inline-block px-2.5 py-1 bg-emerald-50 text-emerald-700 text-sm font-medium rounded-full mb-4",children:v.country_nm}),a.jsxs("div",{className:"space-y-3",children:[v.charger_nm&&a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Si,{size:16,className:"text-toss-gray-400"}),a.jsx("span",{className:"text-toss-gray-600",children:":"}),a.jsx("span",{className:"font-medium",children:v.charger_nm})]}),v.email&&a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(Oy,{size:16,className:"text-toss-gray-400"}),a.jsx("span",{className:"text-toss-gray-600",children:":"}),a.jsx("a",{href:`mailto:${v.email}`,className:"text-toss-blue hover:underline",children:v.email})]}),v.homepage_url&&a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(rl,{size:16,className:"text-toss-gray-400"}),a.jsx("span",{className:"text-toss-gray-600",children:":"}),a.jsx("a",{href:v.homepage_url,target:"_blank",rel:"noopener noreferrer",className:"text-toss-blue hover:underline truncate",children:v.homepage_url})]}),v.foreign_addr&&a.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[a.jsx(Id,{size:16,className:"text-toss-gray-400 mt-0.5"}),a.jsx("span",{className:"text-toss-gray-600",children:":"}),a.jsx("span",{children:v.foreign_addr})]}),v.fndtn_dt&&a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(cF,{size:16,className:"text-toss-gray-400"}),a.jsx("span",{className:"text-toss-gray-600",children:":"}),a.jsx("span",{children:v.fndtn_dt})]}),v.group_intro&&a.jsxs("div",{className:"mt-4 p-3 bg-toss-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:" "}),a.jsx("p",{className:"text-sm text-toss-gray-700 whitespace-pre-line",children:v.group_intro})]})]})]})})})]})}const Sc={domestic:"",overseas:""},_Q=[{key:"name",label:"",width:10},{key:"department",label:"",width:15},{key:"position",label:"",width:10},{key:"phone",label:"",width:15},{key:"email",label:"",width:25},{key:"memo",label:"",width:20}],NQ=[{key:"continent",label:"",width:10},{key:"department",label:"",width:20},{key:"position",label:"",width:10},{key:"name",label:"",width:10},{key:"phone",label:"",width:15},{key:"email",label:"",width:25}],Y3={name:"",department:"",position:"",phone:"",email:"",memo:"",continent:""},kQ=()=>{const{isAdmin:e,isSubAdmin:t}=qr(),r=e||t,s=K.useRef(null),[n,o]=K.useState([]),[l,u]=K.useState(!0),[d,h]=K.useState(!1),[m,x]=K.useState(""),[y,b]=K.useState(""),[v,g]=K.useState("domestic"),[_,w]=K.useState(!1),[S,N]=K.useState(null),[E,C]=K.useState(Y3),[F,O]=K.useState(!1),B=v==="domestic"?_Q:NQ;K.useEffect(()=>{L()},[]);const L=async()=>{try{const{data:X,error:se}=await Pe.from("contacts").select("*").order("department").order("continent").order("name");if(se)throw se;o(X||[])}catch(X){console.error("  :",X)}finally{u(!1)}},H=K.useMemo(()=>n.filter(X=>X.type===v),[n,v]),ue=K.useMemo(()=>v==="domestic"?[...new Set(H.map(se=>se.department).filter(Boolean))].sort():[...new Set(H.map(se=>se.continent).filter(Boolean))].sort(),[H,v]),A=K.useMemo(()=>H.filter(X=>{const se=!m||X.name?.toLowerCase().includes(m.toLowerCase())||X.department?.toLowerCase().includes(m.toLowerCase())||X.position?.toLowerCase().includes(m.toLowerCase())||X.phone?.includes(m)||X.email?.toLowerCase().includes(m.toLowerCase())||X.memo?.toLowerCase().includes(m.toLowerCase())||X.continent?.toLowerCase().includes(m.toLowerCase()),P=!y||(v==="domestic"?X.department===y:X.continent===y);return se&&P}),[H,m,y,v]),Y=K.useMemo(()=>n.filter(X=>X.type==="domestic").length,[n]),I=K.useMemo(()=>n.filter(X=>X.type==="overseas").length,[n]),ae=X=>{g(X),x(""),b("")},Q=()=>{N(null),C(Y3),w(!0)},re=X=>{N(X),C({name:X.name||"",department:X.department||"",position:X.position||"",phone:X.phone||"",email:X.email||"",memo:X.memo||"",continent:X.continent||""}),w(!0)},ve=async()=>{if(!E.name.trim()){alert(v==="domestic"?" .":" .");return}O(!0);try{if(S){const{error:X}=await Pe.from("contacts").update({name:E.name,department:E.department,position:E.position,phone:E.phone,email:E.email,memo:E.memo,continent:E.continent}).eq("id",S.id);if(X)throw X}else{const{error:X}=await Pe.from("contacts").insert({...E,type:v});if(X)throw X}w(!1),L()}catch(X){console.error(" :",X),alert(`   .
${X?.message||""}`)}finally{O(!1)}},te=async X=>{if(confirm(`"${X.name}"  ?`))try{const{error:se}=await Pe.from("contacts").delete().eq("id",X.id);if(se)throw se;L()}catch(se){console.error(" :",se),alert("   .")}},ke=async X=>{const se=X.target.files?.[0];if(se){h(!0);try{const P=await se.arrayBuffer(),U=wl(P),ce=U.Sheets[U.SheetNames[0]],ne=Rr.sheet_to_json(ce);if(ne.length===0){alert("   .");return}let ie;if(v==="overseas"?ie=ne.map(G=>({continent:G.||G.continent||"",department:G.||G.||G.||G.||G.department||"",position:G.||G.||G.position||"",name:G.||G.||G.name||"",phone:String(G.||G.||G.phone||G.||""),email:G.||G.email||G.||"",memo:"",type:"overseas"})).filter(G=>G.name):ie=ne.map(G=>({name:G.||G.name||G.||"",department:G.||G.department||G.||G.||"",position:G.||G.position||G.||G.||"",phone:String(G.||G.phone||G.||G.||G.||""),email:G.||G.email||G.||"",memo:G.||G.memo||G.||"",continent:"",type:"domestic"})).filter(G=>G.name),ie.length===0){alert('  .  ""  ""   .');return}const{error:W}=await Pe.from("contacts").delete().eq("type",v);if(W)throw W;for(let G=0;G<ie.length;G+=50){const k=ie.slice(G,G+50),{error:de}=await Pe.from("contacts").insert(k);if(de)throw de}alert(`${Sc[v]}  ${ie.length} .`),L()}catch(P){console.error(" :",P),alert(`   .
${P?.message||JSON.stringify(P)}`)}finally{h(!1),s.current&&(s.current.value="")}}},Z=()=>{let X;v==="overseas"?X=A.map(ce=>({:ce.continent,:ce.department,:ce.position,:ce.name,:ce.phone,:ce.email})):X=A.map(ce=>({:ce.name,:ce.department,:ce.position,:ce.phone,:ce.email,:ce.memo}));const se=Rr.json_to_sheet(X),P=Rr.book_new();Rr.book_append_sheet(P,se,""),se["!cols"]=B.map(ce=>({wch:ce.width}));const U=Sc[v];vo(P,`_${U}_${new Date().toISOString().slice(0,10)}.xlsx`)},M=async()=>{const X=Sc[v];if(confirm(`${X}   ?`))try{const{error:se}=await Pe.from("contacts").delete().eq("type",v);if(se)throw se;L(),alert(`${X}   .`)}catch(se){console.error(" :",se),alert("   .")}},J=(X,se)=>{const P=X[se]||"";return se==="phone"&&P?a.jsx("a",{href:`tel:${P}`,className:"text-toss-gray-700 hover:text-toss-blue hover:underline text-sm",children:P}):se==="email"&&P?a.jsx("a",{href:`mailto:${P}`,className:"text-toss-gray-700 hover:text-toss-blue hover:underline text-sm",children:P}):se==="name"?a.jsx("span",{className:"font-medium text-toss-gray-900 text-sm",children:P}):a.jsx("span",{className:"text-toss-gray-700 text-sm",children:P})},V=v==="domestic"?[{key:"name",label:"",required:!0},{key:"department",label:""},{key:"position",label:""},{key:"phone",label:""},{key:"email",label:""},{key:"memo",label:""}]:[{key:"continent",label:""},{key:"department",label:""},{key:"position",label:""},{key:"name",label:"",required:!0},{key:"phone",label:""},{key:"email",label:""}];return l?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"w-8 h-8 border-4 border-toss-blue border-t-transparent rounded-full animate-spin"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsx(_t,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(O0,{size:24})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold mb-1",children:""}),a.jsxs("p",{className:"text-white/90",children:[Sc[v]," ",A.length,""]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r&&a.jsxs("button",{onClick:Q,className:"flex items-center gap-2 px-4 py-2 bg-white text-toss-blue hover:bg-white/90 rounded-toss text-sm font-medium transition-all",children:[a.jsx(os,{size:16}),""]}),H.length>0&&a.jsxs("button",{onClick:Z,className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 rounded-toss text-sm font-medium transition-all",children:[a.jsx(Jr,{size:16}),""]}),r&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>s.current?.click(),disabled:d,className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 rounded-toss text-sm font-medium transition-all disabled:opacity-50",children:[a.jsx(Gn,{size:16}),d?" ...":" "]}),H.length>0&&a.jsxs("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-red-500/80 rounded-toss text-sm font-medium transition-all",children:[a.jsx(Xt,{size:16}),""]})]}),a.jsx("input",{ref:s,type:"file",accept:".xlsx,.xls,.csv",className:"hidden",onChange:ke})]})]})}),a.jsx("div",{className:"flex gap-1 bg-toss-gray-100 p-1 rounded-toss-lg w-fit",children:["domestic","overseas"].map(X=>a.jsxs("button",{onClick:()=>ae(X),className:`px-5 py-2.5 rounded-toss font-medium text-sm transition-all ${v===X?"bg-white text-toss-blue shadow-sm":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[Sc[X],a.jsx("span",{className:`ml-1.5 text-xs ${v===X?"text-toss-blue/60":"text-toss-gray-400"}`,children:X==="domestic"?Y:I})]},X))}),a.jsx(_t,{padding:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(qa,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),a.jsx("input",{type:"text",placeholder:v==="domestic"?", ,   ...":", ,   ...",value:m,onChange:X=>x(X.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-toss-gray-100 border-0 rounded-toss text-sm focus:ring-2 focus:ring-toss-blue focus:bg-white transition-all"})]}),ue.length>0&&a.jsxs("select",{value:y,onChange:X=>b(X.target.value),className:"px-4 py-2.5 bg-toss-gray-100 border-0 rounded-toss text-sm focus:ring-2 focus:ring-toss-blue focus:bg-white transition-all",children:[a.jsx("option",{value:"",children:v==="domestic"?" ":" "}),ue.map(X=>a.jsx("option",{value:X,children:X},X))]})]})}),H.length===0?a.jsx(_t,{children:a.jsxs("div",{className:"text-center py-16 text-toss-gray-500",children:[a.jsx(O0,{size:48,className:"mx-auto mb-4 opacity-30"}),a.jsxs("p",{className:"text-lg font-medium mb-2",children:[Sc[v],"  "]}),r&&a.jsxs("p",{className:"text-sm",children:["    .",a.jsx("br",{}),a.jsx("span",{className:"text-toss-gray-400",children:v==="domestic"?": , , , , , ":": , , , , , "})]})]})}):A.length===0?a.jsx(_t,{children:a.jsxs("div",{className:"text-center py-12 text-toss-gray-500",children:[a.jsx(qa,{size:48,className:"mx-auto mb-4 opacity-30"}),a.jsx("p",{children:"  "})]})}):a.jsxs(a.Fragment,{children:[a.jsx(_t,{padding:"p-0",className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-toss-gray-100 bg-toss-gray-50",children:[B.map(X=>a.jsx("th",{className:"text-left px-3 py-2.5 text-xs font-semibold text-toss-gray-500",children:X.label},X.key)),r&&a.jsx("th",{className:"text-right px-3 py-2.5 text-xs font-semibold text-toss-gray-500 w-20",children:""})]})}),a.jsx("tbody",{children:A.map(X=>a.jsxs("tr",{className:"border-b border-toss-gray-50 hover:bg-toss-gray-50/50 transition-colors group",children:[B.map(se=>a.jsx("td",{className:"px-3 py-2",children:J(X,se.key)},se.key)),r&&a.jsx("td",{className:"px-3 py-2 text-right",children:a.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-end gap-1",children:[a.jsx("button",{onClick:()=>re(X),className:"p-1.5 text-toss-gray-400 hover:text-toss-blue hover:bg-toss-blue/10 rounded-toss transition-all",title:"",children:a.jsx(F0,{size:15})}),a.jsx("button",{onClick:()=>te(X),className:"p-1.5 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded-toss transition-all",title:"",children:a.jsx(Xt,{size:15})})]})})]},X.id))})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:A.map(X=>a.jsxs(_t,{padding:"p-4",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-bold text-toss-gray-900",children:X.name}),a.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[v==="overseas"&&X.continent&&a.jsx("span",{className:"text-sm text-toss-gray-500",children:X.continent}),X.department&&a.jsx("span",{className:"text-sm text-toss-gray-500",children:X.department}),X.position&&a.jsxs("span",{className:"text-sm text-toss-gray-400",children:[" ",X.position]})]})]}),r&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>re(X),className:"p-1.5 text-toss-gray-400 hover:text-toss-blue",children:a.jsx(F0,{size:15})}),a.jsx("button",{onClick:()=>te(X),className:"p-1.5 text-toss-gray-400 hover:text-red-500",children:a.jsx(Xt,{size:15})})]})]}),a.jsxs("div",{className:"mt-2 space-y-1",children:[X.phone&&a.jsx("a",{href:`tel:${X.phone}`,className:"block text-sm text-toss-gray-700 hover:text-toss-blue",children:X.phone}),X.email&&a.jsx("a",{href:`mailto:${X.email}`,className:"block text-sm text-toss-gray-700 hover:text-toss-blue",children:X.email}),X.memo&&a.jsx("p",{className:"text-sm text-toss-gray-400",children:X.memo})]})]},X.id))})]}),a.jsx(cr,{isOpen:_,onClose:()=>w(!1),title:S?" ":" ",children:a.jsxs("div",{className:"space-y-4",children:[V.map(X=>a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1.5",children:[X.label,X.required&&a.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),a.jsx("input",{type:X.key==="email"?"email":"text",value:E[X.key],onChange:se=>C(P=>({...P,[X.key]:se.target.value})),placeholder:X.label,className:"w-full px-4 py-2.5 bg-toss-gray-100 border-0 rounded-toss text-sm focus:ring-2 focus:ring-toss-blue focus:bg-white transition-all"})]},X.key)),a.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-toss-gray-100",children:[a.jsx(Ye,{variant:"secondary",onClick:()=>w(!1),children:""}),a.jsx(Ye,{onClick:ve,loading:F,children:S?"":""})]})]})})]})},SQ=({children:e})=>{const{user:t,loading:r}=qr();return r?a.jsx("div",{className:"min-h-screen bg-toss-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-toss-blue border-t-transparent rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-toss-gray-500",children:" ..."})]})}):t?e:a.jsx(el,{to:"/login",replace:!0})},J3=({children:e})=>{const{user:t,loading:r}=qr();return r?a.jsx("div",{className:"min-h-screen bg-toss-gray-50 flex items-center justify-center",children:a.jsx("div",{className:"w-12 h-12 border-4 border-toss-blue border-t-transparent rounded-full animate-spin"})}):t?a.jsx(el,{to:"/",replace:!0}):e};function EQ(){return a.jsxs(P8,{children:[a.jsx(Er,{path:"/login",element:a.jsx(J3,{children:a.jsx(YF,{})})}),a.jsx(Er,{path:"/register",element:a.jsx(J3,{children:a.jsx(JF,{})})}),a.jsxs(Er,{element:a.jsx(SQ,{children:a.jsx(XF,{})}),children:[a.jsx(Er,{path:"/",element:a.jsx(ZF,{})}),a.jsx(Er,{path:"/notices",element:a.jsx(u4,{})}),a.jsx(Er,{path:"/notices/:id",element:a.jsx(u4,{})}),a.jsx(Er,{path:"/events",element:a.jsx(KU,{})}),a.jsx(Er,{path:"/worklogs",element:a.jsx(el,{to:"/worklogs/daily",replace:!0})}),a.jsx(Er,{path:"/worklogs/daily",element:a.jsx(IU,{})}),a.jsx(Er,{path:"/worklogs/weekly",element:a.jsx(PU,{})}),a.jsx(Er,{path:"/worklogs/monthly",element:a.jsx($U,{})}),a.jsx(Er,{path:"/rescue",element:a.jsx(HU,{})}),a.jsx(Er,{path:"/meetings",element:a.jsx(GU,{})}),a.jsx(Er,{path:"/document",element:a.jsx(ez,{})}),a.jsx(Er,{path:"/archive",element:a.jsx(el,{to:"/archive/forms",replace:!0})}),a.jsx(Er,{path:"/archive/:type",element:a.jsx(az,{})}),a.jsx(Er,{path:"/document-ledger",element:a.jsx(iQ,{})}),a.jsx(Er,{path:"/leave",element:a.jsx(lQ,{})}),a.jsx(Er,{path:"/admission",element:a.jsx(fQ,{})}),a.jsx(Er,{path:"/admission/ganghwa",element:a.jsx(hQ,{})}),a.jsx(Er,{path:"/admission/bupyeong",element:a.jsx(mQ,{})}),a.jsx(Er,{path:"/admission/nametag",element:a.jsx(pQ,{})}),a.jsx(Er,{path:"/overseas-korean",element:a.jsx(el,{to:"/overseas-korean/status",replace:!0})}),a.jsx(Er,{path:"/overseas-korean/status",element:a.jsx(yQ,{})}),a.jsx(Er,{path:"/overseas-korean/group",element:a.jsx(wQ,{})}),a.jsx(Er,{path:"/contacts",element:a.jsx(kQ,{})}),a.jsx(Er,{path:"/admin",element:a.jsx(rz,{})}),a.jsx(Er,{path:"/mypage",element:a.jsx(XU,{})})]}),a.jsx(Er,{path:"*",element:a.jsx(el,{to:"/",replace:!0})})]})}function jQ(){return a.jsx(GF,{children:a.jsx(cR,{basename:"/company-intranet/",children:a.jsx(f7,{children:a.jsx(EQ,{})})})})}const Z3=!1,TQ=async()=>{if(S0.isNativePlatform())try{const{LiveUpdate:e}=await vC(async()=>{const{LiveUpdate:r}=await import("./index-BSPFR2_s.js");return{LiveUpdate:r}},[]);(await e.sync()).nextBundleId}catch{}};TQ();AC.createRoot(document.getElementById("root")).render(a.jsx(K.StrictMode,{children:a.jsx(jQ,{})}));export{nv as W,vC as _,av as r};
