(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();const LC="modulepreload",IC=function(e){return"/company-intranet/"+e},z2={},MC=function(t,r,s){let a=Promise.resolve();if(r&&r.length>0){let d=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=c?.nonce||c?.getAttribute("nonce");a=d(r.map(h=>{if(h=IC(h),h in z2)return;z2[h]=!0;const m=h.endsWith(".css"),x=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${x}`))return;const y=document.createElement("link");if(y.rel=m?"stylesheet":LC,m||(y.as="script"),y.crossOrigin="",y.href=h,u&&y.setAttribute("nonce",u),document.head.appendChild(y),m)return new Promise((v,w)=>{y.addEventListener("load",v),y.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${h}`)))})}))}function o(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return a.then(c=>{for(const u of c||[])u.status==="rejected"&&o(u.reason);return t().catch(o)})};var yh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gx={exports:{}},Bu={};var q2;function PC(){if(q2)return Bu;q2=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(s,a,o){var c=null;if(o!==void 0&&(c=""+o),a.key!==void 0&&(c=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:e,type:s,key:c,ref:a!==void 0?a:null,props:o}}return Bu.Fragment=t,Bu.jsx=r,Bu.jsxs=r,Bu}var $2;function BC(){return $2||($2=1,gx.exports=PC()),gx.exports}var n=BC(),yx={exports:{}},Jt={};var H2;function UC(){if(H2)return Jt;H2=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),y=Symbol.iterator;function v(q){return q===null||typeof q!="object"?null:(q=y&&q[y]||q["@@iterator"],typeof q=="function"?q:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,_={};function b(q,I,X){this.props=q,this.context=I,this.refs=_,this.updater=X||w}b.prototype.isReactComponent={},b.prototype.setState=function(q,I){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,I,"setState")},b.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function N(){}N.prototype=b.prototype;function S(q,I,X){this.props=q,this.context=I,this.refs=_,this.updater=X||w}var E=S.prototype=new N;E.constructor=S,g(E,b.prototype),E.isPureReactComponent=!0;var R=Array.isArray;function L(){}var O={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function F(q,I,X){var H=X.ref;return{$$typeof:e,type:q,key:I,ref:H!==void 0?H:null,props:X}}function V(q,I){return F(q.type,I,q.props)}function oe(q){return typeof q=="object"&&q!==null&&q.$$typeof===e}function D(q){var I={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(X){return I[X]})}var K=/\/+/g;function M(q,I){return typeof q=="object"&&q!==null&&q.key!=null?D(""+q.key):I.toString(36)}function ae(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(L,L):(q.status="pending",q.then(function(I){q.status==="pending"&&(q.status="fulfilled",q.value=I)},function(I){q.status==="pending"&&(q.status="rejected",q.reason=I)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function te(q,I,X,H,Q){var ie=typeof q;(ie==="undefined"||ie==="boolean")&&(q=null);var B=!1;if(q===null)B=!0;else switch(ie){case"bigint":case"string":case"number":B=!0;break;case"object":switch(q.$$typeof){case e:case t:B=!0;break;case m:return B=q._init,te(B(q._payload),I,X,H,Q)}}if(B)return Q=Q(q),B=H===""?"."+M(q,0):H,R(Q)?(X="",B!=null&&(X=B.replace(K,"$&/")+"/"),te(Q,I,X,"",function(se){return se})):Q!=null&&(oe(Q)&&(Q=V(Q,X+(Q.key==null||q&&q.key===Q.key?"":(""+Q.key).replace(K,"$&/")+"/")+B)),I.push(Q)),1;B=0;var z=H===""?".":H+":";if(R(q))for(var ue=0;ue<q.length;ue++)H=q[ue],ie=z+M(H,ue),B+=te(H,I,X,ie,Q);else if(ue=v(q),typeof ue=="function")for(q=ue.call(q),ue=0;!(H=q.next()).done;)H=H.value,ie=z+M(H,ue++),B+=te(H,I,X,ie,Q);else if(ie==="object"){if(typeof q.then=="function")return te(ae(q),I,X,H,Q);throw I=String(q),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.")}return B}function Z(q,I,X){if(q==null)return q;var H=[],Q=0;return te(q,H,"","",function(ie){return I.call(X,ie,Q++)}),H}function we(q){if(q._status===-1){var I=q._result;I=I(),I.then(function(X){(q._status===0||q._status===-1)&&(q._status=1,q._result=X)},function(X){(q._status===0||q._status===-1)&&(q._status=2,q._result=X)}),q._status===-1&&(q._status=0,q._result=I)}if(q._status===1)return q._result.default;throw q._result}var ee=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var I=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(I))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},Ne={map:Z,forEach:function(q,I,X){Z(q,function(){I.apply(this,arguments)},X)},count:function(q){var I=0;return Z(q,function(){I++}),I},toArray:function(q){return Z(q,function(I){return I})||[]},only:function(q){if(!oe(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return Jt.Activity=x,Jt.Children=Ne,Jt.Component=b,Jt.Fragment=r,Jt.Profiler=a,Jt.PureComponent=S,Jt.StrictMode=s,Jt.Suspense=d,Jt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Jt.__COMPILER_RUNTIME={__proto__:null,c:function(q){return O.H.useMemoCache(q)}},Jt.cache=function(q){return function(){return q.apply(null,arguments)}},Jt.cacheSignal=function(){return null},Jt.cloneElement=function(q,I,X){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var H=g({},q.props),Q=q.key;if(I!=null)for(ie in I.key!==void 0&&(Q=""+I.key),I)!P.call(I,ie)||ie==="key"||ie==="__self"||ie==="__source"||ie==="ref"&&I.ref===void 0||(H[ie]=I[ie]);var ie=arguments.length-2;if(ie===1)H.children=X;else if(1<ie){for(var B=Array(ie),z=0;z<ie;z++)B[z]=arguments[z+2];H.children=B}return F(q.type,Q,H)},Jt.createContext=function(q){return q={$$typeof:c,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:o,_context:q},q},Jt.createElement=function(q,I,X){var H,Q={},ie=null;if(I!=null)for(H in I.key!==void 0&&(ie=""+I.key),I)P.call(I,H)&&H!=="key"&&H!=="__self"&&H!=="__source"&&(Q[H]=I[H]);var B=arguments.length-2;if(B===1)Q.children=X;else if(1<B){for(var z=Array(B),ue=0;ue<B;ue++)z[ue]=arguments[ue+2];Q.children=z}if(q&&q.defaultProps)for(H in B=q.defaultProps,B)Q[H]===void 0&&(Q[H]=B[H]);return F(q,ie,Q)},Jt.createRef=function(){return{current:null}},Jt.forwardRef=function(q){return{$$typeof:u,render:q}},Jt.isValidElement=oe,Jt.lazy=function(q){return{$$typeof:m,_payload:{_status:-1,_result:q},_init:we}},Jt.memo=function(q,I){return{$$typeof:h,type:q,compare:I===void 0?null:I}},Jt.startTransition=function(q){var I=O.T,X={};O.T=X;try{var H=q(),Q=O.S;Q!==null&&Q(X,H),typeof H=="object"&&H!==null&&typeof H.then=="function"&&H.then(L,ee)}catch(ie){ee(ie)}finally{I!==null&&X.types!==null&&(I.types=X.types),O.T=I}},Jt.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Jt.use=function(q){return O.H.use(q)},Jt.useActionState=function(q,I,X){return O.H.useActionState(q,I,X)},Jt.useCallback=function(q,I){return O.H.useCallback(q,I)},Jt.useContext=function(q){return O.H.useContext(q)},Jt.useDebugValue=function(){},Jt.useDeferredValue=function(q,I){return O.H.useDeferredValue(q,I)},Jt.useEffect=function(q,I){return O.H.useEffect(q,I)},Jt.useEffectEvent=function(q){return O.H.useEffectEvent(q)},Jt.useId=function(){return O.H.useId()},Jt.useImperativeHandle=function(q,I,X){return O.H.useImperativeHandle(q,I,X)},Jt.useInsertionEffect=function(q,I){return O.H.useInsertionEffect(q,I)},Jt.useLayoutEffect=function(q,I){return O.H.useLayoutEffect(q,I)},Jt.useMemo=function(q,I){return O.H.useMemo(q,I)},Jt.useOptimistic=function(q,I){return O.H.useOptimistic(q,I)},Jt.useReducer=function(q,I,X){return O.H.useReducer(q,I,X)},Jt.useRef=function(q){return O.H.useRef(q)},Jt.useState=function(q){return O.H.useState(q)},Jt.useSyncExternalStore=function(q,I,X){return O.H.useSyncExternalStore(q,I,X)},Jt.useTransition=function(){return O.H.useTransition()},Jt.version="19.2.3",Jt}var W2;function Fy(){return W2||(W2=1,yx.exports=UC()),yx.exports}var Y=Fy(),vx={exports:{}},Uu={},wx={exports:{}},bx={};var G2;function zC(){return G2||(G2=1,(function(e){function t(te,Z){var we=te.length;te.push(Z);e:for(;0<we;){var ee=we-1>>>1,Ne=te[ee];if(0<a(Ne,Z))te[ee]=Z,te[we]=Ne,we=ee;else break e}}function r(te){return te.length===0?null:te[0]}function s(te){if(te.length===0)return null;var Z=te[0],we=te.pop();if(we!==Z){te[0]=we;e:for(var ee=0,Ne=te.length,q=Ne>>>1;ee<q;){var I=2*(ee+1)-1,X=te[I],H=I+1,Q=te[H];if(0>a(X,we))H<Ne&&0>a(Q,X)?(te[ee]=Q,te[H]=we,ee=H):(te[ee]=X,te[I]=we,ee=I);else if(H<Ne&&0>a(Q,we))te[ee]=Q,te[H]=we,ee=H;else break e}}return Z}function a(te,Z){var we=te.sortIndex-Z.sortIndex;return we!==0?we:te.id-Z.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var d=[],h=[],m=1,x=null,y=3,v=!1,w=!1,g=!1,_=!1,b=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function E(te){for(var Z=r(h);Z!==null;){if(Z.callback===null)s(h);else if(Z.startTime<=te)s(h),Z.sortIndex=Z.expirationTime,t(d,Z);else break;Z=r(h)}}function R(te){if(g=!1,E(te),!w)if(r(d)!==null)w=!0,L||(L=!0,D());else{var Z=r(h);Z!==null&&ae(R,Z.startTime-te)}}var L=!1,O=-1,P=5,F=-1;function V(){return _?!0:!(e.unstable_now()-F<P)}function oe(){if(_=!1,L){var te=e.unstable_now();F=te;var Z=!0;try{e:{w=!1,g&&(g=!1,N(O),O=-1),v=!0;var we=y;try{t:{for(E(te),x=r(d);x!==null&&!(x.expirationTime>te&&V());){var ee=x.callback;if(typeof ee=="function"){x.callback=null,y=x.priorityLevel;var Ne=ee(x.expirationTime<=te);if(te=e.unstable_now(),typeof Ne=="function"){x.callback=Ne,E(te),Z=!0;break t}x===r(d)&&s(d),E(te)}else s(d);x=r(d)}if(x!==null)Z=!0;else{var q=r(h);q!==null&&ae(R,q.startTime-te),Z=!1}}break e}finally{x=null,y=we,v=!1}Z=void 0}}finally{Z?D():L=!1}}}var D;if(typeof S=="function")D=function(){S(oe)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,M=K.port2;K.port1.onmessage=oe,D=function(){M.postMessage(null)}}else D=function(){b(oe,0)};function ae(te,Z){O=b(function(){te(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(te){switch(y){case 1:case 2:case 3:var Z=3;break;default:Z=y}var we=y;y=Z;try{return te()}finally{y=we}},e.unstable_requestPaint=function(){_=!0},e.unstable_runWithPriority=function(te,Z){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var we=y;y=te;try{return Z()}finally{y=we}},e.unstable_scheduleCallback=function(te,Z,we){var ee=e.unstable_now();switch(typeof we=="object"&&we!==null?(we=we.delay,we=typeof we=="number"&&0<we?ee+we:ee):we=ee,te){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=we+Ne,te={id:m++,callback:Z,priorityLevel:te,startTime:we,expirationTime:Ne,sortIndex:-1},we>ee?(te.sortIndex=we,t(h,te),r(d)===null&&te===r(h)&&(g?(N(O),O=-1):g=!0,ae(R,we-ee))):(te.sortIndex=Ne,t(d,te),w||v||(w=!0,L||(L=!0,D()))),te},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(te){var Z=y;return function(){var we=y;y=Z;try{return te.apply(this,arguments)}finally{y=we}}}})(bx)),bx}var V2;function qC(){return V2||(V2=1,wx.exports=zC()),wx.exports}var _x={exports:{}},Js={};var K2;function $C(){if(K2)return Js;K2=1;var e=Fy();function t(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var s={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(d,h,m){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:d,containerInfo:h,implementation:m}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Js.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Js.createPortal=function(d,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return o(d,h,null,m)},Js.flushSync=function(d){var h=c.T,m=s.p;try{if(c.T=null,s.p=2,d)return d()}finally{c.T=h,s.p=m,s.d.f()}},Js.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,s.d.C(d,h))},Js.prefetchDNS=function(d){typeof d=="string"&&s.d.D(d)},Js.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var m=h.as,x=u(m,h.crossOrigin),y=typeof h.integrity=="string"?h.integrity:void 0,v=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?s.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:v}):m==="script"&&s.d.X(d,{crossOrigin:x,integrity:y,fetchPriority:v,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Js.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=u(h.as,h.crossOrigin);s.d.M(d,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&s.d.M(d)},Js.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,x=u(m,h.crossOrigin);s.d.L(d,m,{crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Js.preloadModule=function(d,h){if(typeof d=="string")if(h){var m=u(h.as,h.crossOrigin);s.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else s.d.m(d)},Js.requestFormReset=function(d){s.d.r(d)},Js.unstable_batchedUpdates=function(d,h){return d(h)},Js.useFormState=function(d,h,m){return c.H.useFormState(d,h,m)},Js.useFormStatus=function(){return c.H.useHostTransitionStatus()},Js.version="19.2.3",Js}var X2;function HC(){if(X2)return _x.exports;X2=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),_x.exports=$C(),_x.exports}var Y2;function WC(){if(Y2)return Uu;Y2=1;var e=qC(),t=Fy(),r=HC();function s(i){var l="https://react.dev/errors/"+i;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+i+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var l=i,f=i;if(i.alternate)for(;l.return;)l=l.return;else{i=l;do l=i,(l.flags&4098)!==0&&(f=l.return),i=l.return;while(i)}return l.tag===3?f:null}function c(i){if(i.tag===13){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function u(i){if(i.tag===31){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function d(i){if(o(i)!==i)throw Error(s(188))}function h(i){var l=i.alternate;if(!l){if(l=o(i),l===null)throw Error(s(188));return l!==i?null:i}for(var f=i,p=l;;){var j=f.return;if(j===null)break;var C=j.alternate;if(C===null){if(p=j.return,p!==null){f=p;continue}break}if(j.child===C.child){for(C=j.child;C;){if(C===f)return d(j),i;if(C===p)return d(j),l;C=C.sibling}throw Error(s(188))}if(f.return!==p.return)f=j,p=C;else{for(var J=!1,pe=j.child;pe;){if(pe===f){J=!0,f=j,p=C;break}if(pe===p){J=!0,p=j,f=C;break}pe=pe.sibling}if(!J){for(pe=C.child;pe;){if(pe===f){J=!0,f=C,p=j;break}if(pe===p){J=!0,p=C,f=j;break}pe=pe.sibling}if(!J)throw Error(s(189))}}if(f.alternate!==p)throw Error(s(190))}if(f.tag!==3)throw Error(s(188));return f.stateNode.current===f?i:l}function m(i){var l=i.tag;if(l===5||l===26||l===27||l===6)return i;for(i=i.child;i!==null;){if(l=m(i),l!==null)return l;i=i.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),S=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),oe=Symbol.iterator;function D(i){return i===null||typeof i!="object"?null:(i=oe&&i[oe]||i["@@iterator"],typeof i=="function"?i:null)}var K=Symbol.for("react.client.reference");function M(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===K?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case g:return"Fragment";case b:return"Profiler";case _:return"StrictMode";case R:return"Suspense";case L:return"SuspenseList";case F:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case w:return"Portal";case S:return i.displayName||"Context";case N:return(i._context.displayName||"Context")+".Consumer";case E:var l=i.render;return i=i.displayName,i||(i=l.displayName||l.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case O:return l=i.displayName||null,l!==null?l:M(i.type)||"Memo";case P:l=i._payload,i=i._init;try{return M(i(l))}catch{}}return null}var ae=Array.isArray,te=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,we={pending:!1,data:null,method:null,action:null},ee=[],Ne=-1;function q(i){return{current:i}}function I(i){0>Ne||(i.current=ee[Ne],ee[Ne]=null,Ne--)}function X(i,l){Ne++,ee[Ne]=i.current,i.current=l}var H=q(null),Q=q(null),ie=q(null),B=q(null);function z(i,l){switch(X(ie,l),X(Q,i),X(H,null),l.nodeType){case 9:case 11:i=(i=l.documentElement)&&(i=i.namespaceURI)?u2(i):0;break;default:if(i=l.tagName,l=l.namespaceURI)l=u2(l),i=d2(l,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}I(H),X(H,i)}function ue(){I(H),I(Q),I(ie)}function se(i){i.memoizedState!==null&&X(B,i);var l=H.current,f=d2(l,i.type);l!==f&&(X(Q,i),X(H,f))}function re(i){Q.current===i&&(I(H),I(Q)),B.current===i&&(I(B),Lu._currentValue=we)}var W,ce;function k(i){if(W===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);W=l&&l[1]||"",ce=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+W+i+ce}var de=!1;function U(i,l){if(!i||de)return"";de=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(l){var ft=function(){throw Error()};if(Object.defineProperty(ft.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ft,[])}catch(et){var Ye=et}Reflect.construct(i,[],ft)}else{try{ft.call()}catch(et){Ye=et}i.call(ft.prototype)}}else{try{throw Error()}catch(et){Ye=et}(ft=i())&&typeof ft.catch=="function"&&ft.catch(function(){})}}catch(et){if(et&&Ye&&typeof et.stack=="string")return[et.stack,Ye.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var j=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");j&&j.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=p.DetermineComponentFrameRoot(),J=C[0],pe=C[1];if(J&&pe){var Fe=J.split(`
`),Xe=pe.split(`
`);for(j=p=0;p<Fe.length&&!Fe[p].includes("DetermineComponentFrameRoot");)p++;for(;j<Xe.length&&!Xe[j].includes("DetermineComponentFrameRoot");)j++;if(p===Fe.length||j===Xe.length)for(p=Fe.length-1,j=Xe.length-1;1<=p&&0<=j&&Fe[p]!==Xe[j];)j--;for(;1<=p&&0<=j;p--,j--)if(Fe[p]!==Xe[j]){if(p!==1||j!==1)do if(p--,j--,0>j||Fe[p]!==Xe[j]){var ot=`
`+Fe[p].replace(" at new "," at ");return i.displayName&&ot.includes("<anonymous>")&&(ot=ot.replace("<anonymous>",i.displayName)),ot}while(1<=p&&0<=j);break}}}finally{de=!1,Error.prepareStackTrace=f}return(f=i?i.displayName||i.name:"")?k(f):""}function T(i,l){switch(i.tag){case 26:case 27:case 5:return k(i.type);case 16:return k("Lazy");case 13:return i.child!==l&&l!==null?k("Suspense Fallback"):k("Suspense");case 19:return k("SuspenseList");case 0:case 15:return U(i.type,!1);case 11:return U(i.type.render,!1);case 1:return U(i.type,!0);case 31:return k("Activity");default:return""}}function A(i){try{var l="",f=null;do l+=T(i,f),f=i,i=i.return;while(i);return l}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var G=Object.prototype.hasOwnProperty,xe=e.unstable_scheduleCallback,be=e.unstable_cancelCallback,ne=e.unstable_shouldYield,je=e.unstable_requestPaint,Me=e.unstable_now,De=e.unstable_getCurrentPriorityLevel,Ce=e.unstable_ImmediatePriority,st=e.unstable_UserBlockingPriority,We=e.unstable_NormalPriority,Ze=e.unstable_LowPriority,Re=e.unstable_IdlePriority,pt=e.log,Tt=e.unstable_setDisableYieldValue,wt=null,jt=null;function Pt(i){if(typeof pt=="function"&&Tt(i),jt&&typeof jt.setStrictMode=="function")try{jt.setStrictMode(wt,i)}catch{}}var Le=Math.clz32?Math.clz32:Ae,nt=Math.log,dt=Math.LN2;function Ae(i){return i>>>=0,i===0?32:31-(nt(i)/dt|0)|0}var Je=256,Ee=262144,Pe=4194304;function he(i){var l=i&42;if(l!==0)return l;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function le(i,l,f){var p=i.pendingLanes;if(p===0)return 0;var j=0,C=i.suspendedLanes,J=i.pingedLanes;i=i.warmLanes;var pe=p&134217727;return pe!==0?(p=pe&~C,p!==0?j=he(p):(J&=pe,J!==0?j=he(J):f||(f=pe&~i,f!==0&&(j=he(f))))):(pe=p&~C,pe!==0?j=he(pe):J!==0?j=he(J):f||(f=p&~i,f!==0&&(j=he(f)))),j===0?0:l!==0&&l!==j&&(l&C)===0&&(C=j&-j,f=l&-l,C>=f||C===32&&(f&4194048)!==0)?l:j}function ve(i,l){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&l)===0}function Oe(i,l){switch(i){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qe(){var i=Pe;return Pe<<=1,(Pe&62914560)===0&&(Pe=4194304),i}function ct(i){for(var l=[],f=0;31>f;f++)l.push(i);return l}function Et(i,l){i.pendingLanes|=l,l!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Xt(i,l,f,p,j,C){var J=i.pendingLanes;i.pendingLanes=f,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=f,i.entangledLanes&=f,i.errorRecoveryDisabledLanes&=f,i.shellSuspendCounter=0;var pe=i.entanglements,Fe=i.expirationTimes,Xe=i.hiddenUpdates;for(f=J&~f;0<f;){var ot=31-Le(f),ft=1<<ot;pe[ot]=0,Fe[ot]=-1;var Ye=Xe[ot];if(Ye!==null)for(Xe[ot]=null,ot=0;ot<Ye.length;ot++){var et=Ye[ot];et!==null&&(et.lane&=-536870913)}f&=~ft}p!==0&&er(i,p,0),C!==0&&j===0&&i.tag!==0&&(i.suspendedLanes|=C&~(J&~l))}function er(i,l,f){i.pendingLanes|=l,i.suspendedLanes&=~l;var p=31-Le(l);i.entangledLanes|=l,i.entanglements[p]=i.entanglements[p]|1073741824|f&261930}function Lt(i,l){var f=i.entangledLanes|=l;for(i=i.entanglements;f;){var p=31-Le(f),j=1<<p;j&l|i[p]&l&&(i[p]|=l),f&=~j}}function Yt(i,l){var f=l&-l;return f=(f&42)!==0?1:Rr(f),(f&(i.suspendedLanes|l))!==0?0:f}function Rr(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Dr(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function fe(){var i=Z.p;return i!==0?i:(i=window.event,i===void 0?32:F2(i.type))}function _e(i,l){var f=Z.p;try{return Z.p=i,l()}finally{Z.p=f}}var ge=Math.random().toString(36).slice(2),ye="__reactFiber$"+ge,Se="__reactProps$"+ge,ke="__reactContainer$"+ge,$e="__reactEvents$"+ge,at="__reactListeners$"+ge,He="__reactHandles$"+ge,Ge="__reactResources$"+ge,Ve="__reactMarker$"+ge;function ht(i){delete i[ye],delete i[Se],delete i[$e],delete i[at],delete i[He]}function vt(i){var l=i[ye];if(l)return l;for(var f=i.parentNode;f;){if(l=f[ke]||f[ye]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(i=y2(i);i!==null;){if(f=i[ye])return f;i=y2(i)}return l}i=f,f=i.parentNode}return null}function Nt(i){if(i=i[ye]||i[ke]){var l=i.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return i}return null}function gt(i){var l=i.tag;if(l===5||l===26||l===27||l===6)return i.stateNode;throw Error(s(33))}function me(i){var l=i[Ge];return l||(l=i[Ge]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Ie(i){i[Ve]=!0}var _t=new Set,bt={};function qt(i,l){Br(i,l),Br(i+"Capture",l)}function Br(i,l){for(bt[i]=l,i=0;i<l.length;i++)_t.add(l[i])}var cs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),us={},Ha={};function go(i){return G.call(Ha,i)?!0:G.call(us,i)?!1:cs.test(i)?Ha[i]=!0:(us[i]=!0,!1)}function Ys(i,l,f){if(go(l))if(f===null)i.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":i.removeAttribute(l);return;case"boolean":var p=l.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(l);return}}i.setAttribute(l,""+f)}}function Wa(i,l,f){if(f===null)i.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttribute(l,""+f)}}function qn(i,l,f,p){if(p===null)i.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(f);return}i.setAttributeNS(l,f,""+p)}}function Ga(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function rw(i){var l=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function T5(i,l,f){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,l);if(!i.hasOwnProperty(l)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var j=p.get,C=p.set;return Object.defineProperty(i,l,{configurable:!0,get:function(){return j.call(this)},set:function(J){f=""+J,C.call(this,J)}}),Object.defineProperty(i,l,{enumerable:p.enumerable}),{getValue:function(){return f},setValue:function(J){f=""+J},stopTracking:function(){i._valueTracker=null,delete i[l]}}}}function um(i){if(!i._valueTracker){var l=rw(i)?"checked":"value";i._valueTracker=T5(i,l,""+i[l])}}function sw(i){if(!i)return!1;var l=i._valueTracker;if(!l)return!0;var f=l.getValue(),p="";return i&&(p=rw(i)?i.checked?"true":"false":i.value),i=p,i!==f?(l.setValue(i),!0):!1}function lf(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var A5=/[\n"\\]/g;function Va(i){return i.replace(A5,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function dm(i,l,f,p,j,C,J,pe){i.name="",J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"?i.type=J:i.removeAttribute("type"),l!=null?J==="number"?(l===0&&i.value===""||i.value!=l)&&(i.value=""+Ga(l)):i.value!==""+Ga(l)&&(i.value=""+Ga(l)):J!=="submit"&&J!=="reset"||i.removeAttribute("value"),l!=null?fm(i,J,Ga(l)):f!=null?fm(i,J,Ga(f)):p!=null&&i.removeAttribute("value"),j==null&&C!=null&&(i.defaultChecked=!!C),j!=null&&(i.checked=j&&typeof j!="function"&&typeof j!="symbol"),pe!=null&&typeof pe!="function"&&typeof pe!="symbol"&&typeof pe!="boolean"?i.name=""+Ga(pe):i.removeAttribute("name")}function aw(i,l,f,p,j,C,J,pe){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(i.type=C),l!=null||f!=null){if(!(C!=="submit"&&C!=="reset"||l!=null)){um(i);return}f=f!=null?""+Ga(f):"",l=l!=null?""+Ga(l):f,pe||l===i.value||(i.value=l),i.defaultValue=l}p=p??j,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=pe?i.checked:!!p,i.defaultChecked=!!p,J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"&&(i.name=J),um(i)}function fm(i,l,f){l==="number"&&lf(i.ownerDocument)===i||i.defaultValue===""+f||(i.defaultValue=""+f)}function Sl(i,l,f,p){if(i=i.options,l){l={};for(var j=0;j<f.length;j++)l["$"+f[j]]=!0;for(f=0;f<i.length;f++)j=l.hasOwnProperty("$"+i[f].value),i[f].selected!==j&&(i[f].selected=j),j&&p&&(i[f].defaultSelected=!0)}else{for(f=""+Ga(f),l=null,j=0;j<i.length;j++){if(i[j].value===f){i[j].selected=!0,p&&(i[j].defaultSelected=!0);return}l!==null||i[j].disabled||(l=i[j])}l!==null&&(l.selected=!0)}}function nw(i,l,f){if(l!=null&&(l=""+Ga(l),l!==i.value&&(i.value=l),f==null)){i.defaultValue!==l&&(i.defaultValue=l);return}i.defaultValue=f!=null?""+Ga(f):""}function iw(i,l,f,p){if(l==null){if(p!=null){if(f!=null)throw Error(s(92));if(ae(p)){if(1<p.length)throw Error(s(93));p=p[0]}f=p}f==null&&(f=""),l=f}f=Ga(l),i.defaultValue=f,p=i.textContent,p===f&&p!==""&&p!==null&&(i.value=p),um(i)}function kl(i,l){if(l){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=l;return}}i.textContent=l}var C5=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ow(i,l,f){var p=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?p?i.setProperty(l,""):l==="float"?i.cssFloat="":i[l]="":p?i.setProperty(l,f):typeof f!="number"||f===0||C5.has(l)?l==="float"?i.cssFloat=f:i[l]=(""+f).trim():i[l]=f+"px"}function lw(i,l,f){if(l!=null&&typeof l!="object")throw Error(s(62));if(i=i.style,f!=null){for(var p in f)!f.hasOwnProperty(p)||l!=null&&l.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var j in l)p=l[j],l.hasOwnProperty(j)&&f[j]!==p&&ow(i,j,p)}else for(var C in l)l.hasOwnProperty(C)&&ow(i,C,l[C])}function hm(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var R5=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),D5=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function cf(i){return D5.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function $n(){}var mm=null;function pm(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Nl=null,El=null;function cw(i){var l=Nt(i);if(l&&(i=l.stateNode)){var f=i[Se]||null;e:switch(i=l.stateNode,l.type){case"input":if(dm(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Va(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var p=f[l];if(p!==i&&p.form===i.form){var j=p[Se]||null;if(!j)throw Error(s(90));dm(p,j.value,j.defaultValue,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name)}}for(l=0;l<f.length;l++)p=f[l],p.form===i.form&&sw(p)}break e;case"textarea":nw(i,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&Sl(i,!!f.multiple,l,!1)}}}var xm=!1;function uw(i,l,f){if(xm)return i(l,f);xm=!0;try{var p=i(l);return p}finally{if(xm=!1,(Nl!==null||El!==null)&&(Yf(),Nl&&(l=Nl,i=El,El=Nl=null,cw(l),i)))for(l=0;l<i.length;l++)cw(i[l])}}function Zc(i,l){var f=i.stateNode;if(f===null)return null;var p=f[Se]||null;if(p===null)return null;f=p[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(s(231,l,typeof f));return f}var Hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gm=!1;if(Hn)try{var Qc={};Object.defineProperty(Qc,"passive",{get:function(){gm=!0}}),window.addEventListener("test",Qc,Qc),window.removeEventListener("test",Qc,Qc)}catch{gm=!1}var Ti=null,ym=null,uf=null;function dw(){if(uf)return uf;var i,l=ym,f=l.length,p,j="value"in Ti?Ti.value:Ti.textContent,C=j.length;for(i=0;i<f&&l[i]===j[i];i++);var J=f-i;for(p=1;p<=J&&l[f-p]===j[C-p];p++);return uf=j.slice(i,1<p?1-p:void 0)}function df(i){var l=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&l===13&&(i=13)):i=l,i===10&&(i=13),32<=i||i===13?i:0}function ff(){return!0}function fw(){return!1}function xa(i){function l(f,p,j,C,J){this._reactName=f,this._targetInst=j,this.type=p,this.nativeEvent=C,this.target=J,this.currentTarget=null;for(var pe in i)i.hasOwnProperty(pe)&&(f=i[pe],this[pe]=f?f(C):C[pe]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?ff:fw,this.isPropagationStopped=fw,this}return x(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ff)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ff)},persist:function(){},isPersistent:ff}),l}var yo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hf=xa(yo),eu=x({},yo,{view:0,detail:0}),O5=xa(eu),vm,wm,tu,mf=x({},eu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_m,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==tu&&(tu&&i.type==="mousemove"?(vm=i.screenX-tu.screenX,wm=i.screenY-tu.screenY):wm=vm=0,tu=i),vm)},movementY:function(i){return"movementY"in i?i.movementY:wm}}),hw=xa(mf),F5=x({},mf,{dataTransfer:0}),L5=xa(F5),I5=x({},eu,{relatedTarget:0}),bm=xa(I5),M5=x({},yo,{animationName:0,elapsedTime:0,pseudoElement:0}),P5=xa(M5),B5=x({},yo,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),U5=xa(B5),z5=x({},yo,{data:0}),mw=xa(z5),q5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function W5(i){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(i):(i=H5[i])?!!l[i]:!1}function _m(){return W5}var G5=x({},eu,{key:function(i){if(i.key){var l=q5[i.key]||i.key;if(l!=="Unidentified")return l}return i.type==="keypress"?(i=df(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?$5[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_m,charCode:function(i){return i.type==="keypress"?df(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?df(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),V5=xa(G5),K5=x({},mf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pw=xa(K5),X5=x({},eu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_m}),Y5=xa(X5),J5=x({},yo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Z5=xa(J5),Q5=x({},mf,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),eA=xa(Q5),tA=x({},yo,{newState:0,oldState:0}),rA=xa(tA),sA=[9,13,27,32],Sm=Hn&&"CompositionEvent"in window,ru=null;Hn&&"documentMode"in document&&(ru=document.documentMode);var aA=Hn&&"TextEvent"in window&&!ru,xw=Hn&&(!Sm||ru&&8<ru&&11>=ru),gw=" ",yw=!1;function vw(i,l){switch(i){case"keyup":return sA.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ww(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var jl=!1;function nA(i,l){switch(i){case"compositionend":return ww(l);case"keypress":return l.which!==32?null:(yw=!0,gw);case"textInput":return i=l.data,i===gw&&yw?null:i;default:return null}}function iA(i,l){if(jl)return i==="compositionend"||!Sm&&vw(i,l)?(i=dw(),uf=ym=Ti=null,jl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return xw&&l.locale!=="ko"?null:l.data;default:return null}}var oA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bw(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l==="input"?!!oA[i.type]:l==="textarea"}function _w(i,l,f,p){Nl?El?El.push(p):El=[p]:Nl=p,l=sh(l,"onChange"),0<l.length&&(f=new hf("onChange","change",null,f,p),i.push({event:f,listeners:l}))}var su=null,au=null;function lA(i){a2(i,0)}function pf(i){var l=gt(i);if(sw(l))return i}function Sw(i,l){if(i==="change")return l}var kw=!1;if(Hn){var km;if(Hn){var Nm="oninput"in document;if(!Nm){var Nw=document.createElement("div");Nw.setAttribute("oninput","return;"),Nm=typeof Nw.oninput=="function"}km=Nm}else km=!1;kw=km&&(!document.documentMode||9<document.documentMode)}function Ew(){su&&(su.detachEvent("onpropertychange",jw),au=su=null)}function jw(i){if(i.propertyName==="value"&&pf(au)){var l=[];_w(l,au,i,pm(i)),uw(lA,l)}}function cA(i,l,f){i==="focusin"?(Ew(),su=l,au=f,su.attachEvent("onpropertychange",jw)):i==="focusout"&&Ew()}function uA(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return pf(au)}function dA(i,l){if(i==="click")return pf(l)}function fA(i,l){if(i==="input"||i==="change")return pf(l)}function hA(i,l){return i===l&&(i!==0||1/i===1/l)||i!==i&&l!==l}var ja=typeof Object.is=="function"?Object.is:hA;function nu(i,l){if(ja(i,l))return!0;if(typeof i!="object"||i===null||typeof l!="object"||l===null)return!1;var f=Object.keys(i),p=Object.keys(l);if(f.length!==p.length)return!1;for(p=0;p<f.length;p++){var j=f[p];if(!G.call(l,j)||!ja(i[j],l[j]))return!1}return!0}function Tw(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Aw(i,l){var f=Tw(i);i=0;for(var p;f;){if(f.nodeType===3){if(p=i+f.textContent.length,i<=l&&p>=l)return{node:f,offset:l-i};i=p}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=Tw(f)}}function Cw(i,l){return i&&l?i===l?!0:i&&i.nodeType===3?!1:l&&l.nodeType===3?Cw(i,l.parentNode):"contains"in i?i.contains(l):i.compareDocumentPosition?!!(i.compareDocumentPosition(l)&16):!1:!1}function Rw(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var l=lf(i.document);l instanceof i.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)i=l.contentWindow;else break;l=lf(i.document)}return l}function Em(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l&&(l==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||l==="textarea"||i.contentEditable==="true")}var mA=Hn&&"documentMode"in document&&11>=document.documentMode,Tl=null,jm=null,iu=null,Tm=!1;function Dw(i,l,f){var p=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Tm||Tl==null||Tl!==lf(p)||(p=Tl,"selectionStart"in p&&Em(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),iu&&nu(iu,p)||(iu=p,p=sh(jm,"onSelect"),0<p.length&&(l=new hf("onSelect","select",null,l,f),i.push({event:l,listeners:p}),l.target=Tl)))}function vo(i,l){var f={};return f[i.toLowerCase()]=l.toLowerCase(),f["Webkit"+i]="webkit"+l,f["Moz"+i]="moz"+l,f}var Al={animationend:vo("Animation","AnimationEnd"),animationiteration:vo("Animation","AnimationIteration"),animationstart:vo("Animation","AnimationStart"),transitionrun:vo("Transition","TransitionRun"),transitionstart:vo("Transition","TransitionStart"),transitioncancel:vo("Transition","TransitionCancel"),transitionend:vo("Transition","TransitionEnd")},Am={},Ow={};Hn&&(Ow=document.createElement("div").style,"AnimationEvent"in window||(delete Al.animationend.animation,delete Al.animationiteration.animation,delete Al.animationstart.animation),"TransitionEvent"in window||delete Al.transitionend.transition);function wo(i){if(Am[i])return Am[i];if(!Al[i])return i;var l=Al[i],f;for(f in l)if(l.hasOwnProperty(f)&&f in Ow)return Am[i]=l[f];return i}var Fw=wo("animationend"),Lw=wo("animationiteration"),Iw=wo("animationstart"),pA=wo("transitionrun"),xA=wo("transitionstart"),gA=wo("transitioncancel"),Mw=wo("transitionend"),Pw=new Map,Cm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Cm.push("scrollEnd");function pn(i,l){Pw.set(i,l),qt(l,[i])}var xf=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ka=[],Cl=0,Rm=0;function gf(){for(var i=Cl,l=Rm=Cl=0;l<i;){var f=Ka[l];Ka[l++]=null;var p=Ka[l];Ka[l++]=null;var j=Ka[l];Ka[l++]=null;var C=Ka[l];if(Ka[l++]=null,p!==null&&j!==null){var J=p.pending;J===null?j.next=j:(j.next=J.next,J.next=j),p.pending=j}C!==0&&Bw(f,j,C)}}function yf(i,l,f,p){Ka[Cl++]=i,Ka[Cl++]=l,Ka[Cl++]=f,Ka[Cl++]=p,Rm|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function Dm(i,l,f,p){return yf(i,l,f,p),vf(i)}function bo(i,l){return yf(i,null,null,l),vf(i)}function Bw(i,l,f){i.lanes|=f;var p=i.alternate;p!==null&&(p.lanes|=f);for(var j=!1,C=i.return;C!==null;)C.childLanes|=f,p=C.alternate,p!==null&&(p.childLanes|=f),C.tag===22&&(i=C.stateNode,i===null||i._visibility&1||(j=!0)),i=C,C=C.return;return i.tag===3?(C=i.stateNode,j&&l!==null&&(j=31-Le(f),i=C.hiddenUpdates,p=i[j],p===null?i[j]=[l]:p.push(l),l.lane=f|536870912),C):null}function vf(i){if(50<Tu)throw Tu=0,zp=null,Error(s(185));for(var l=i.return;l!==null;)i=l,l=i.return;return i.tag===3?i.stateNode:null}var Rl={};function yA(i,l,f,p){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ta(i,l,f,p){return new yA(i,l,f,p)}function Om(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Wn(i,l){var f=i.alternate;return f===null?(f=Ta(i.tag,l,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=l,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&65011712,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,l=i.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f.refCleanup=i.refCleanup,f}function Uw(i,l){i.flags&=65011714;var f=i.alternate;return f===null?(i.childLanes=0,i.lanes=l,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=f.childLanes,i.lanes=f.lanes,i.child=f.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=f.memoizedProps,i.memoizedState=f.memoizedState,i.updateQueue=f.updateQueue,i.type=f.type,l=f.dependencies,i.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),i}function wf(i,l,f,p,j,C){var J=0;if(p=i,typeof i=="function")Om(i)&&(J=1);else if(typeof i=="string")J=SC(i,f,H.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case F:return i=Ta(31,f,l,j),i.elementType=F,i.lanes=C,i;case g:return _o(f.children,j,C,l);case _:J=8,j|=24;break;case b:return i=Ta(12,f,l,j|2),i.elementType=b,i.lanes=C,i;case R:return i=Ta(13,f,l,j),i.elementType=R,i.lanes=C,i;case L:return i=Ta(19,f,l,j),i.elementType=L,i.lanes=C,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case S:J=10;break e;case N:J=9;break e;case E:J=11;break e;case O:J=14;break e;case P:J=16,p=null;break e}J=29,f=Error(s(130,i===null?"null":typeof i,"")),p=null}return l=Ta(J,f,l,j),l.elementType=i,l.type=p,l.lanes=C,l}function _o(i,l,f,p){return i=Ta(7,i,p,l),i.lanes=f,i}function Fm(i,l,f){return i=Ta(6,i,null,l),i.lanes=f,i}function zw(i){var l=Ta(18,null,null,0);return l.stateNode=i,l}function Lm(i,l,f){return l=Ta(4,i.children!==null?i.children:[],i.key,l),l.lanes=f,l.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},l}var qw=new WeakMap;function Xa(i,l){if(typeof i=="object"&&i!==null){var f=qw.get(i);return f!==void 0?f:(l={value:i,source:l,stack:A(l)},qw.set(i,l),l)}return{value:i,source:l,stack:A(l)}}var Dl=[],Ol=0,bf=null,ou=0,Ya=[],Ja=0,Ai=null,jn=1,Tn="";function Gn(i,l){Dl[Ol++]=ou,Dl[Ol++]=bf,bf=i,ou=l}function $w(i,l,f){Ya[Ja++]=jn,Ya[Ja++]=Tn,Ya[Ja++]=Ai,Ai=i;var p=jn;i=Tn;var j=32-Le(p)-1;p&=~(1<<j),f+=1;var C=32-Le(l)+j;if(30<C){var J=j-j%5;C=(p&(1<<J)-1).toString(32),p>>=J,j-=J,jn=1<<32-Le(l)+j|f<<j|p,Tn=C+i}else jn=1<<C|f<<j|p,Tn=i}function Im(i){i.return!==null&&(Gn(i,1),$w(i,1,0))}function Mm(i){for(;i===bf;)bf=Dl[--Ol],Dl[Ol]=null,ou=Dl[--Ol],Dl[Ol]=null;for(;i===Ai;)Ai=Ya[--Ja],Ya[Ja]=null,Tn=Ya[--Ja],Ya[Ja]=null,jn=Ya[--Ja],Ya[Ja]=null}function Hw(i,l){Ya[Ja++]=jn,Ya[Ja++]=Tn,Ya[Ja++]=Ai,jn=l.id,Tn=l.overflow,Ai=i}var Ms=null,$r=null,mr=!1,Ci=null,Za=!1,Pm=Error(s(519));function Ri(i){var l=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw lu(Xa(l,i)),Pm}function Ww(i){var l=i.stateNode,f=i.type,p=i.memoizedProps;switch(l[ye]=i,l[Se]=p,f){case"dialog":dr("cancel",l),dr("close",l);break;case"iframe":case"object":case"embed":dr("load",l);break;case"video":case"audio":for(f=0;f<Cu.length;f++)dr(Cu[f],l);break;case"source":dr("error",l);break;case"img":case"image":case"link":dr("error",l),dr("load",l);break;case"details":dr("toggle",l);break;case"input":dr("invalid",l),aw(l,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":dr("invalid",l);break;case"textarea":dr("invalid",l),iw(l,p.value,p.defaultValue,p.children)}f=p.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||p.suppressHydrationWarning===!0||l2(l.textContent,f)?(p.popover!=null&&(dr("beforetoggle",l),dr("toggle",l)),p.onScroll!=null&&dr("scroll",l),p.onScrollEnd!=null&&dr("scrollend",l),p.onClick!=null&&(l.onclick=$n),l=!0):l=!1,l||Ri(i,!0)}function Gw(i){for(Ms=i.return;Ms;)switch(Ms.tag){case 5:case 31:case 13:Za=!1;return;case 27:case 3:Za=!0;return;default:Ms=Ms.return}}function Fl(i){if(i!==Ms)return!1;if(!mr)return Gw(i),mr=!0,!1;var l=i.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=i.type,f=!(f!=="form"&&f!=="button")||rx(i.type,i.memoizedProps)),f=!f),f&&$r&&Ri(i),Gw(i),l===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));$r=g2(i)}else if(l===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));$r=g2(i)}else l===27?(l=$r,Wi(i.type)?(i=ox,ox=null,$r=i):$r=l):$r=Ms?en(i.stateNode.nextSibling):null;return!0}function So(){$r=Ms=null,mr=!1}function Bm(){var i=Ci;return i!==null&&(wa===null?wa=i:wa.push.apply(wa,i),Ci=null),i}function lu(i){Ci===null?Ci=[i]:Ci.push(i)}var Um=q(null),ko=null,Vn=null;function Di(i,l,f){X(Um,l._currentValue),l._currentValue=f}function Kn(i){i._currentValue=Um.current,I(Um)}function zm(i,l,f){for(;i!==null;){var p=i.alternate;if((i.childLanes&l)!==l?(i.childLanes|=l,p!==null&&(p.childLanes|=l)):p!==null&&(p.childLanes&l)!==l&&(p.childLanes|=l),i===f)break;i=i.return}}function qm(i,l,f,p){var j=i.child;for(j!==null&&(j.return=i);j!==null;){var C=j.dependencies;if(C!==null){var J=j.child;C=C.firstContext;e:for(;C!==null;){var pe=C;C=j;for(var Fe=0;Fe<l.length;Fe++)if(pe.context===l[Fe]){C.lanes|=f,pe=C.alternate,pe!==null&&(pe.lanes|=f),zm(C.return,f,i),p||(J=null);break e}C=pe.next}}else if(j.tag===18){if(J=j.return,J===null)throw Error(s(341));J.lanes|=f,C=J.alternate,C!==null&&(C.lanes|=f),zm(J,f,i),J=null}else J=j.child;if(J!==null)J.return=j;else for(J=j;J!==null;){if(J===i){J=null;break}if(j=J.sibling,j!==null){j.return=J.return,J=j;break}J=J.return}j=J}}function Ll(i,l,f,p){i=null;for(var j=l,C=!1;j!==null;){if(!C){if((j.flags&524288)!==0)C=!0;else if((j.flags&262144)!==0)break}if(j.tag===10){var J=j.alternate;if(J===null)throw Error(s(387));if(J=J.memoizedProps,J!==null){var pe=j.type;ja(j.pendingProps.value,J.value)||(i!==null?i.push(pe):i=[pe])}}else if(j===B.current){if(J=j.alternate,J===null)throw Error(s(387));J.memoizedState.memoizedState!==j.memoizedState.memoizedState&&(i!==null?i.push(Lu):i=[Lu])}j=j.return}i!==null&&qm(l,i,f,p),l.flags|=262144}function _f(i){for(i=i.firstContext;i!==null;){if(!ja(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function No(i){ko=i,Vn=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Ps(i){return Vw(ko,i)}function Sf(i,l){return ko===null&&No(i),Vw(i,l)}function Vw(i,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},Vn===null){if(i===null)throw Error(s(308));Vn=l,i.dependencies={lanes:0,firstContext:l},i.flags|=524288}else Vn=Vn.next=l;return f}var vA=typeof AbortController<"u"?AbortController:function(){var i=[],l=this.signal={aborted:!1,addEventListener:function(f,p){i.push(p)}};this.abort=function(){l.aborted=!0,i.forEach(function(f){return f()})}},wA=e.unstable_scheduleCallback,bA=e.unstable_NormalPriority,gs={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $m(){return{controller:new vA,data:new Map,refCount:0}}function cu(i){i.refCount--,i.refCount===0&&wA(bA,function(){i.controller.abort()})}var uu=null,Hm=0,Il=0,Ml=null;function _A(i,l){if(uu===null){var f=uu=[];Hm=0,Il=Vp(),Ml={status:"pending",value:void 0,then:function(p){f.push(p)}}}return Hm++,l.then(Kw,Kw),l}function Kw(){if(--Hm===0&&uu!==null){Ml!==null&&(Ml.status="fulfilled");var i=uu;uu=null,Il=0,Ml=null;for(var l=0;l<i.length;l++)(0,i[l])()}}function SA(i,l){var f=[],p={status:"pending",value:null,reason:null,then:function(j){f.push(j)}};return i.then(function(){p.status="fulfilled",p.value=l;for(var j=0;j<f.length;j++)(0,f[j])(l)},function(j){for(p.status="rejected",p.reason=j,j=0;j<f.length;j++)(0,f[j])(void 0)}),p}var Xw=te.S;te.S=function(i,l){D_=Me(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&_A(i,l),Xw!==null&&Xw(i,l)};var Eo=q(null);function Wm(){var i=Eo.current;return i!==null?i:Ur.pooledCache}function kf(i,l){l===null?X(Eo,Eo.current):X(Eo,l.pool)}function Yw(){var i=Wm();return i===null?null:{parent:gs._currentValue,pool:i}}var Pl=Error(s(460)),Gm=Error(s(474)),Nf=Error(s(542)),Ef={then:function(){}};function Jw(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Zw(i,l,f){switch(f=i[f],f===void 0?i.push(l):f!==l&&(l.then($n,$n),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw i=l.reason,eb(i),i;default:if(typeof l.status=="string")l.then($n,$n);else{if(i=Ur,i!==null&&100<i.shellSuspendCounter)throw Error(s(482));i=l,i.status="pending",i.then(function(p){if(l.status==="pending"){var j=l;j.status="fulfilled",j.value=p}},function(p){if(l.status==="pending"){var j=l;j.status="rejected",j.reason=p}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw i=l.reason,eb(i),i}throw To=l,Pl}}function jo(i){try{var l=i._init;return l(i._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(To=f,Pl):f}}var To=null;function Qw(){if(To===null)throw Error(s(459));var i=To;return To=null,i}function eb(i){if(i===Pl||i===Nf)throw Error(s(483))}var Bl=null,du=0;function jf(i){var l=du;return du+=1,Bl===null&&(Bl=[]),Zw(Bl,i,l)}function fu(i,l){l=l.props.ref,i.ref=l!==void 0?l:null}function Tf(i,l){throw l.$$typeof===y?Error(s(525)):(i=Object.prototype.toString.call(l),Error(s(31,i==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":i)))}function tb(i){function l(ze,Be){if(i){var Ke=ze.deletions;Ke===null?(ze.deletions=[Be],ze.flags|=16):Ke.push(Be)}}function f(ze,Be){if(!i)return null;for(;Be!==null;)l(ze,Be),Be=Be.sibling;return null}function p(ze){for(var Be=new Map;ze!==null;)ze.key!==null?Be.set(ze.key,ze):Be.set(ze.index,ze),ze=ze.sibling;return Be}function j(ze,Be){return ze=Wn(ze,Be),ze.index=0,ze.sibling=null,ze}function C(ze,Be,Ke){return ze.index=Ke,i?(Ke=ze.alternate,Ke!==null?(Ke=Ke.index,Ke<Be?(ze.flags|=67108866,Be):Ke):(ze.flags|=67108866,Be)):(ze.flags|=1048576,Be)}function J(ze){return i&&ze.alternate===null&&(ze.flags|=67108866),ze}function pe(ze,Be,Ke,ut){return Be===null||Be.tag!==6?(Be=Fm(Ke,ze.mode,ut),Be.return=ze,Be):(Be=j(Be,Ke),Be.return=ze,Be)}function Fe(ze,Be,Ke,ut){var Bt=Ke.type;return Bt===g?ot(ze,Be,Ke.props.children,ut,Ke.key):Be!==null&&(Be.elementType===Bt||typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===P&&jo(Bt)===Be.type)?(Be=j(Be,Ke.props),fu(Be,Ke),Be.return=ze,Be):(Be=wf(Ke.type,Ke.key,Ke.props,null,ze.mode,ut),fu(Be,Ke),Be.return=ze,Be)}function Xe(ze,Be,Ke,ut){return Be===null||Be.tag!==4||Be.stateNode.containerInfo!==Ke.containerInfo||Be.stateNode.implementation!==Ke.implementation?(Be=Lm(Ke,ze.mode,ut),Be.return=ze,Be):(Be=j(Be,Ke.children||[]),Be.return=ze,Be)}function ot(ze,Be,Ke,ut,Bt){return Be===null||Be.tag!==7?(Be=_o(Ke,ze.mode,ut,Bt),Be.return=ze,Be):(Be=j(Be,Ke),Be.return=ze,Be)}function ft(ze,Be,Ke){if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return Be=Fm(""+Be,ze.mode,Ke),Be.return=ze,Be;if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case v:return Ke=wf(Be.type,Be.key,Be.props,null,ze.mode,Ke),fu(Ke,Be),Ke.return=ze,Ke;case w:return Be=Lm(Be,ze.mode,Ke),Be.return=ze,Be;case P:return Be=jo(Be),ft(ze,Be,Ke)}if(ae(Be)||D(Be))return Be=_o(Be,ze.mode,Ke,null),Be.return=ze,Be;if(typeof Be.then=="function")return ft(ze,jf(Be),Ke);if(Be.$$typeof===S)return ft(ze,Sf(ze,Be),Ke);Tf(ze,Be)}return null}function Ye(ze,Be,Ke,ut){var Bt=Be!==null?Be.key:null;if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number"||typeof Ke=="bigint")return Bt!==null?null:pe(ze,Be,""+Ke,ut);if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case v:return Ke.key===Bt?Fe(ze,Be,Ke,ut):null;case w:return Ke.key===Bt?Xe(ze,Be,Ke,ut):null;case P:return Ke=jo(Ke),Ye(ze,Be,Ke,ut)}if(ae(Ke)||D(Ke))return Bt!==null?null:ot(ze,Be,Ke,ut,null);if(typeof Ke.then=="function")return Ye(ze,Be,jf(Ke),ut);if(Ke.$$typeof===S)return Ye(ze,Be,Sf(ze,Ke),ut);Tf(ze,Ke)}return null}function et(ze,Be,Ke,ut,Bt){if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return ze=ze.get(Ke)||null,pe(Be,ze,""+ut,Bt);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case v:return ze=ze.get(ut.key===null?Ke:ut.key)||null,Fe(Be,ze,ut,Bt);case w:return ze=ze.get(ut.key===null?Ke:ut.key)||null,Xe(Be,ze,ut,Bt);case P:return ut=jo(ut),et(ze,Be,Ke,ut,Bt)}if(ae(ut)||D(ut))return ze=ze.get(Ke)||null,ot(Be,ze,ut,Bt,null);if(typeof ut.then=="function")return et(ze,Be,Ke,jf(ut),Bt);if(ut.$$typeof===S)return et(ze,Be,Ke,Sf(Be,ut),Bt);Tf(Be,ut)}return null}function Dt(ze,Be,Ke,ut){for(var Bt=null,wr=null,It=Be,tr=Be=0,hr=null;It!==null&&tr<Ke.length;tr++){It.index>tr?(hr=It,It=null):hr=It.sibling;var br=Ye(ze,It,Ke[tr],ut);if(br===null){It===null&&(It=hr);break}i&&It&&br.alternate===null&&l(ze,It),Be=C(br,Be,tr),wr===null?Bt=br:wr.sibling=br,wr=br,It=hr}if(tr===Ke.length)return f(ze,It),mr&&Gn(ze,tr),Bt;if(It===null){for(;tr<Ke.length;tr++)It=ft(ze,Ke[tr],ut),It!==null&&(Be=C(It,Be,tr),wr===null?Bt=It:wr.sibling=It,wr=It);return mr&&Gn(ze,tr),Bt}for(It=p(It);tr<Ke.length;tr++)hr=et(It,ze,tr,Ke[tr],ut),hr!==null&&(i&&hr.alternate!==null&&It.delete(hr.key===null?tr:hr.key),Be=C(hr,Be,tr),wr===null?Bt=hr:wr.sibling=hr,wr=hr);return i&&It.forEach(function(Yi){return l(ze,Yi)}),mr&&Gn(ze,tr),Bt}function $t(ze,Be,Ke,ut){if(Ke==null)throw Error(s(151));for(var Bt=null,wr=null,It=Be,tr=Be=0,hr=null,br=Ke.next();It!==null&&!br.done;tr++,br=Ke.next()){It.index>tr?(hr=It,It=null):hr=It.sibling;var Yi=Ye(ze,It,br.value,ut);if(Yi===null){It===null&&(It=hr);break}i&&It&&Yi.alternate===null&&l(ze,It),Be=C(Yi,Be,tr),wr===null?Bt=Yi:wr.sibling=Yi,wr=Yi,It=hr}if(br.done)return f(ze,It),mr&&Gn(ze,tr),Bt;if(It===null){for(;!br.done;tr++,br=Ke.next())br=ft(ze,br.value,ut),br!==null&&(Be=C(br,Be,tr),wr===null?Bt=br:wr.sibling=br,wr=br);return mr&&Gn(ze,tr),Bt}for(It=p(It);!br.done;tr++,br=Ke.next())br=et(It,ze,tr,br.value,ut),br!==null&&(i&&br.alternate!==null&&It.delete(br.key===null?tr:br.key),Be=C(br,Be,tr),wr===null?Bt=br:wr.sibling=br,wr=br);return i&&It.forEach(function(FC){return l(ze,FC)}),mr&&Gn(ze,tr),Bt}function Lr(ze,Be,Ke,ut){if(typeof Ke=="object"&&Ke!==null&&Ke.type===g&&Ke.key===null&&(Ke=Ke.props.children),typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case v:e:{for(var Bt=Ke.key;Be!==null;){if(Be.key===Bt){if(Bt=Ke.type,Bt===g){if(Be.tag===7){f(ze,Be.sibling),ut=j(Be,Ke.props.children),ut.return=ze,ze=ut;break e}}else if(Be.elementType===Bt||typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===P&&jo(Bt)===Be.type){f(ze,Be.sibling),ut=j(Be,Ke.props),fu(ut,Ke),ut.return=ze,ze=ut;break e}f(ze,Be);break}else l(ze,Be);Be=Be.sibling}Ke.type===g?(ut=_o(Ke.props.children,ze.mode,ut,Ke.key),ut.return=ze,ze=ut):(ut=wf(Ke.type,Ke.key,Ke.props,null,ze.mode,ut),fu(ut,Ke),ut.return=ze,ze=ut)}return J(ze);case w:e:{for(Bt=Ke.key;Be!==null;){if(Be.key===Bt)if(Be.tag===4&&Be.stateNode.containerInfo===Ke.containerInfo&&Be.stateNode.implementation===Ke.implementation){f(ze,Be.sibling),ut=j(Be,Ke.children||[]),ut.return=ze,ze=ut;break e}else{f(ze,Be);break}else l(ze,Be);Be=Be.sibling}ut=Lm(Ke,ze.mode,ut),ut.return=ze,ze=ut}return J(ze);case P:return Ke=jo(Ke),Lr(ze,Be,Ke,ut)}if(ae(Ke))return Dt(ze,Be,Ke,ut);if(D(Ke)){if(Bt=D(Ke),typeof Bt!="function")throw Error(s(150));return Ke=Bt.call(Ke),$t(ze,Be,Ke,ut)}if(typeof Ke.then=="function")return Lr(ze,Be,jf(Ke),ut);if(Ke.$$typeof===S)return Lr(ze,Be,Sf(ze,Ke),ut);Tf(ze,Ke)}return typeof Ke=="string"&&Ke!==""||typeof Ke=="number"||typeof Ke=="bigint"?(Ke=""+Ke,Be!==null&&Be.tag===6?(f(ze,Be.sibling),ut=j(Be,Ke),ut.return=ze,ze=ut):(f(ze,Be),ut=Fm(Ke,ze.mode,ut),ut.return=ze,ze=ut),J(ze)):f(ze,Be)}return function(ze,Be,Ke,ut){try{du=0;var Bt=Lr(ze,Be,Ke,ut);return Bl=null,Bt}catch(It){if(It===Pl||It===Nf)throw It;var wr=Ta(29,It,null,ze.mode);return wr.lanes=ut,wr.return=ze,wr}}}var Ao=tb(!0),rb=tb(!1),Oi=!1;function Vm(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Km(i,l){i=i.updateQueue,l.updateQueue===i&&(l.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Fi(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Li(i,l,f){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Sr&2)!==0){var j=p.pending;return j===null?l.next=l:(l.next=j.next,j.next=l),p.pending=l,l=vf(i),Bw(i,null,f),l}return yf(i,p,l,f),vf(i)}function hu(i,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var p=l.lanes;p&=i.pendingLanes,f|=p,l.lanes=f,Lt(i,f)}}function Xm(i,l){var f=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,f===p)){var j=null,C=null;if(f=f.firstBaseUpdate,f!==null){do{var J={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};C===null?j=C=J:C=C.next=J,f=f.next}while(f!==null);C===null?j=C=l:C=C.next=l}else j=C=l;f={baseState:p.baseState,firstBaseUpdate:j,lastBaseUpdate:C,shared:p.shared,callbacks:p.callbacks},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=l:i.next=l,f.lastBaseUpdate=l}var Ym=!1;function mu(){if(Ym){var i=Ml;if(i!==null)throw i}}function pu(i,l,f,p){Ym=!1;var j=i.updateQueue;Oi=!1;var C=j.firstBaseUpdate,J=j.lastBaseUpdate,pe=j.shared.pending;if(pe!==null){j.shared.pending=null;var Fe=pe,Xe=Fe.next;Fe.next=null,J===null?C=Xe:J.next=Xe,J=Fe;var ot=i.alternate;ot!==null&&(ot=ot.updateQueue,pe=ot.lastBaseUpdate,pe!==J&&(pe===null?ot.firstBaseUpdate=Xe:pe.next=Xe,ot.lastBaseUpdate=Fe))}if(C!==null){var ft=j.baseState;J=0,ot=Xe=Fe=null,pe=C;do{var Ye=pe.lane&-536870913,et=Ye!==pe.lane;if(et?(fr&Ye)===Ye:(p&Ye)===Ye){Ye!==0&&Ye===Il&&(Ym=!0),ot!==null&&(ot=ot.next={lane:0,tag:pe.tag,payload:pe.payload,callback:null,next:null});e:{var Dt=i,$t=pe;Ye=l;var Lr=f;switch($t.tag){case 1:if(Dt=$t.payload,typeof Dt=="function"){ft=Dt.call(Lr,ft,Ye);break e}ft=Dt;break e;case 3:Dt.flags=Dt.flags&-65537|128;case 0:if(Dt=$t.payload,Ye=typeof Dt=="function"?Dt.call(Lr,ft,Ye):Dt,Ye==null)break e;ft=x({},ft,Ye);break e;case 2:Oi=!0}}Ye=pe.callback,Ye!==null&&(i.flags|=64,et&&(i.flags|=8192),et=j.callbacks,et===null?j.callbacks=[Ye]:et.push(Ye))}else et={lane:Ye,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null},ot===null?(Xe=ot=et,Fe=ft):ot=ot.next=et,J|=Ye;if(pe=pe.next,pe===null){if(pe=j.shared.pending,pe===null)break;et=pe,pe=et.next,et.next=null,j.lastBaseUpdate=et,j.shared.pending=null}}while(!0);ot===null&&(Fe=ft),j.baseState=Fe,j.firstBaseUpdate=Xe,j.lastBaseUpdate=ot,C===null&&(j.shared.lanes=0),Ui|=J,i.lanes=J,i.memoizedState=ft}}function sb(i,l){if(typeof i!="function")throw Error(s(191,i));i.call(l)}function ab(i,l){var f=i.callbacks;if(f!==null)for(i.callbacks=null,i=0;i<f.length;i++)sb(f[i],l)}var Ul=q(null),Af=q(0);function nb(i,l){i=si,X(Af,i),X(Ul,l),si=i|l.baseLanes}function Jm(){X(Af,si),X(Ul,Ul.current)}function Zm(){si=Af.current,I(Ul),I(Af)}var Aa=q(null),Qa=null;function Ii(i){var l=i.alternate;X(ds,ds.current&1),X(Aa,i),Qa===null&&(l===null||Ul.current!==null||l.memoizedState!==null)&&(Qa=i)}function Qm(i){X(ds,ds.current),X(Aa,i),Qa===null&&(Qa=i)}function ib(i){i.tag===22?(X(ds,ds.current),X(Aa,i),Qa===null&&(Qa=i)):Mi()}function Mi(){X(ds,ds.current),X(Aa,Aa.current)}function Ca(i){I(Aa),Qa===i&&(Qa=null),I(ds)}var ds=q(0);function Cf(i){for(var l=i;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||nx(f)||ix(f)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Xn=0,Zt=null,Or=null,ys=null,Rf=!1,zl=!1,Co=!1,Df=0,xu=0,ql=null,kA=0;function es(){throw Error(s(321))}function ep(i,l){if(l===null)return!1;for(var f=0;f<l.length&&f<i.length;f++)if(!ja(i[f],l[f]))return!1;return!0}function tp(i,l,f,p,j,C){return Xn=C,Zt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,te.H=i===null||i.memoizedState===null?$b:xp,Co=!1,C=f(p,j),Co=!1,zl&&(C=lb(l,f,p,j)),ob(i),C}function ob(i){te.H=vu;var l=Or!==null&&Or.next!==null;if(Xn=0,ys=Or=Zt=null,Rf=!1,xu=0,ql=null,l)throw Error(s(300));i===null||vs||(i=i.dependencies,i!==null&&_f(i)&&(vs=!0))}function lb(i,l,f,p){Zt=i;var j=0;do{if(zl&&(ql=null),xu=0,zl=!1,25<=j)throw Error(s(301));if(j+=1,ys=Or=null,i.updateQueue!=null){var C=i.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}te.H=Hb,C=l(f,p)}while(zl);return C}function NA(){var i=te.H,l=i.useState()[0];return l=typeof l.then=="function"?gu(l):l,i=i.useState()[0],(Or!==null?Or.memoizedState:null)!==i&&(Zt.flags|=1024),l}function rp(){var i=Df!==0;return Df=0,i}function sp(i,l,f){l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~f}function ap(i){if(Rf){for(i=i.memoizedState;i!==null;){var l=i.queue;l!==null&&(l.pending=null),i=i.next}Rf=!1}Xn=0,ys=Or=Zt=null,zl=!1,xu=Df=0,ql=null}function ua(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ys===null?Zt.memoizedState=ys=i:ys=ys.next=i,ys}function fs(){if(Or===null){var i=Zt.alternate;i=i!==null?i.memoizedState:null}else i=Or.next;var l=ys===null?Zt.memoizedState:ys.next;if(l!==null)ys=l,Or=i;else{if(i===null)throw Zt.alternate===null?Error(s(467)):Error(s(310));Or=i,i={memoizedState:Or.memoizedState,baseState:Or.baseState,baseQueue:Or.baseQueue,queue:Or.queue,next:null},ys===null?Zt.memoizedState=ys=i:ys=ys.next=i}return ys}function Of(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function gu(i){var l=xu;return xu+=1,ql===null&&(ql=[]),i=Zw(ql,i,l),l=Zt,(ys===null?l.memoizedState:ys.next)===null&&(l=l.alternate,te.H=l===null||l.memoizedState===null?$b:xp),i}function Ff(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return gu(i);if(i.$$typeof===S)return Ps(i)}throw Error(s(438,String(i)))}function np(i){var l=null,f=Zt.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var p=Zt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(l={data:p.data.map(function(j){return j.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=Of(),Zt.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(i),p=0;p<i;p++)f[p]=V;return l.index++,f}function Yn(i,l){return typeof l=="function"?l(i):l}function Lf(i){var l=fs();return ip(l,Or,i)}function ip(i,l,f){var p=i.queue;if(p===null)throw Error(s(311));p.lastRenderedReducer=f;var j=i.baseQueue,C=p.pending;if(C!==null){if(j!==null){var J=j.next;j.next=C.next,C.next=J}l.baseQueue=j=C,p.pending=null}if(C=i.baseState,j===null)i.memoizedState=C;else{l=j.next;var pe=J=null,Fe=null,Xe=l,ot=!1;do{var ft=Xe.lane&-536870913;if(ft!==Xe.lane?(fr&ft)===ft:(Xn&ft)===ft){var Ye=Xe.revertLane;if(Ye===0)Fe!==null&&(Fe=Fe.next={lane:0,revertLane:0,gesture:null,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null}),ft===Il&&(ot=!0);else if((Xn&Ye)===Ye){Xe=Xe.next,Ye===Il&&(ot=!0);continue}else ft={lane:0,revertLane:Xe.revertLane,gesture:null,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null},Fe===null?(pe=Fe=ft,J=C):Fe=Fe.next=ft,Zt.lanes|=Ye,Ui|=Ye;ft=Xe.action,Co&&f(C,ft),C=Xe.hasEagerState?Xe.eagerState:f(C,ft)}else Ye={lane:ft,revertLane:Xe.revertLane,gesture:Xe.gesture,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null},Fe===null?(pe=Fe=Ye,J=C):Fe=Fe.next=Ye,Zt.lanes|=ft,Ui|=ft;Xe=Xe.next}while(Xe!==null&&Xe!==l);if(Fe===null?J=C:Fe.next=pe,!ja(C,i.memoizedState)&&(vs=!0,ot&&(f=Ml,f!==null)))throw f;i.memoizedState=C,i.baseState=J,i.baseQueue=Fe,p.lastRenderedState=C}return j===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function op(i){var l=fs(),f=l.queue;if(f===null)throw Error(s(311));f.lastRenderedReducer=i;var p=f.dispatch,j=f.pending,C=l.memoizedState;if(j!==null){f.pending=null;var J=j=j.next;do C=i(C,J.action),J=J.next;while(J!==j);ja(C,l.memoizedState)||(vs=!0),l.memoizedState=C,l.baseQueue===null&&(l.baseState=C),f.lastRenderedState=C}return[C,p]}function cb(i,l,f){var p=Zt,j=fs(),C=mr;if(C){if(f===void 0)throw Error(s(407));f=f()}else f=l();var J=!ja((Or||j).memoizedState,f);if(J&&(j.memoizedState=f,vs=!0),j=j.queue,up(fb.bind(null,p,j,i),[i]),j.getSnapshot!==l||J||ys!==null&&ys.memoizedState.tag&1){if(p.flags|=2048,$l(9,{destroy:void 0},db.bind(null,p,j,f,l),null),Ur===null)throw Error(s(349));C||(Xn&127)!==0||ub(p,l,f)}return f}function ub(i,l,f){i.flags|=16384,i={getSnapshot:l,value:f},l=Zt.updateQueue,l===null?(l=Of(),Zt.updateQueue=l,l.stores=[i]):(f=l.stores,f===null?l.stores=[i]:f.push(i))}function db(i,l,f,p){l.value=f,l.getSnapshot=p,hb(l)&&mb(i)}function fb(i,l,f){return f(function(){hb(l)&&mb(i)})}function hb(i){var l=i.getSnapshot;i=i.value;try{var f=l();return!ja(i,f)}catch{return!0}}function mb(i){var l=bo(i,2);l!==null&&ba(l,i,2)}function lp(i){var l=ua();if(typeof i=="function"){var f=i;if(i=f(),Co){Pt(!0);try{f()}finally{Pt(!1)}}}return l.memoizedState=l.baseState=i,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yn,lastRenderedState:i},l}function pb(i,l,f,p){return i.baseState=f,ip(i,Or,typeof p=="function"?p:Yn)}function EA(i,l,f,p,j){if(Pf(i))throw Error(s(485));if(i=l.action,i!==null){var C={payload:j,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(J){C.listeners.push(J)}};te.T!==null?f(!0):C.isTransition=!1,p(C),f=l.pending,f===null?(C.next=l.pending=C,xb(l,C)):(C.next=f.next,l.pending=f.next=C)}}function xb(i,l){var f=l.action,p=l.payload,j=i.state;if(l.isTransition){var C=te.T,J={};te.T=J;try{var pe=f(j,p),Fe=te.S;Fe!==null&&Fe(J,pe),gb(i,l,pe)}catch(Xe){cp(i,l,Xe)}finally{C!==null&&J.types!==null&&(C.types=J.types),te.T=C}}else try{C=f(j,p),gb(i,l,C)}catch(Xe){cp(i,l,Xe)}}function gb(i,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(p){yb(i,l,p)},function(p){return cp(i,l,p)}):yb(i,l,f)}function yb(i,l,f){l.status="fulfilled",l.value=f,vb(l),i.state=f,l=i.pending,l!==null&&(f=l.next,f===l?i.pending=null:(f=f.next,l.next=f,xb(i,f)))}function cp(i,l,f){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do l.status="rejected",l.reason=f,vb(l),l=l.next;while(l!==p)}i.action=null}function vb(i){i=i.listeners;for(var l=0;l<i.length;l++)(0,i[l])()}function wb(i,l){return l}function bb(i,l){if(mr){var f=Ur.formState;if(f!==null){e:{var p=Zt;if(mr){if($r){t:{for(var j=$r,C=Za;j.nodeType!==8;){if(!C){j=null;break t}if(j=en(j.nextSibling),j===null){j=null;break t}}C=j.data,j=C==="F!"||C==="F"?j:null}if(j){$r=en(j.nextSibling),p=j.data==="F!";break e}}Ri(p)}p=!1}p&&(l=f[0])}}return f=ua(),f.memoizedState=f.baseState=l,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wb,lastRenderedState:l},f.queue=p,f=Ub.bind(null,Zt,p),p.dispatch=f,p=lp(!1),C=pp.bind(null,Zt,!1,p.queue),p=ua(),j={state:l,dispatch:null,action:i,pending:null},p.queue=j,f=EA.bind(null,Zt,j,C,f),j.dispatch=f,p.memoizedState=i,[l,f,!1]}function _b(i){var l=fs();return Sb(l,Or,i)}function Sb(i,l,f){if(l=ip(i,l,wb)[0],i=Lf(Yn)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var p=gu(l)}catch(J){throw J===Pl?Nf:J}else p=l;l=fs();var j=l.queue,C=j.dispatch;return f!==l.memoizedState&&(Zt.flags|=2048,$l(9,{destroy:void 0},jA.bind(null,j,f),null)),[p,C,i]}function jA(i,l){i.action=l}function kb(i){var l=fs(),f=Or;if(f!==null)return Sb(l,f,i);fs(),l=l.memoizedState,f=fs();var p=f.queue.dispatch;return f.memoizedState=i,[l,p,!1]}function $l(i,l,f,p){return i={tag:i,create:f,deps:p,inst:l,next:null},l=Zt.updateQueue,l===null&&(l=Of(),Zt.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=i.next=i:(p=f.next,f.next=i,i.next=p,l.lastEffect=i),i}function Nb(){return fs().memoizedState}function If(i,l,f,p){var j=ua();Zt.flags|=i,j.memoizedState=$l(1|l,{destroy:void 0},f,p===void 0?null:p)}function Mf(i,l,f,p){var j=fs();p=p===void 0?null:p;var C=j.memoizedState.inst;Or!==null&&p!==null&&ep(p,Or.memoizedState.deps)?j.memoizedState=$l(l,C,f,p):(Zt.flags|=i,j.memoizedState=$l(1|l,C,f,p))}function Eb(i,l){If(8390656,8,i,l)}function up(i,l){Mf(2048,8,i,l)}function TA(i){Zt.flags|=4;var l=Zt.updateQueue;if(l===null)l=Of(),Zt.updateQueue=l,l.events=[i];else{var f=l.events;f===null?l.events=[i]:f.push(i)}}function jb(i){var l=fs().memoizedState;return TA({ref:l,nextImpl:i}),function(){if((Sr&2)!==0)throw Error(s(440));return l.impl.apply(void 0,arguments)}}function Tb(i,l){return Mf(4,2,i,l)}function Ab(i,l){return Mf(4,4,i,l)}function Cb(i,l){if(typeof l=="function"){i=i();var f=l(i);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return i=i(),l.current=i,function(){l.current=null}}function Rb(i,l,f){f=f!=null?f.concat([i]):null,Mf(4,4,Cb.bind(null,l,i),f)}function dp(){}function Db(i,l){var f=fs();l=l===void 0?null:l;var p=f.memoizedState;return l!==null&&ep(l,p[1])?p[0]:(f.memoizedState=[i,l],i)}function Ob(i,l){var f=fs();l=l===void 0?null:l;var p=f.memoizedState;if(l!==null&&ep(l,p[1]))return p[0];if(p=i(),Co){Pt(!0);try{i()}finally{Pt(!1)}}return f.memoizedState=[p,l],p}function fp(i,l,f){return f===void 0||(Xn&1073741824)!==0&&(fr&261930)===0?i.memoizedState=l:(i.memoizedState=f,i=F_(),Zt.lanes|=i,Ui|=i,f)}function Fb(i,l,f,p){return ja(f,l)?f:Ul.current!==null?(i=fp(i,f,p),ja(i,l)||(vs=!0),i):(Xn&42)===0||(Xn&1073741824)!==0&&(fr&261930)===0?(vs=!0,i.memoizedState=f):(i=F_(),Zt.lanes|=i,Ui|=i,l)}function Lb(i,l,f,p,j){var C=Z.p;Z.p=C!==0&&8>C?C:8;var J=te.T,pe={};te.T=pe,pp(i,!1,l,f);try{var Fe=j(),Xe=te.S;if(Xe!==null&&Xe(pe,Fe),Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"){var ot=SA(Fe,p);yu(i,l,ot,Oa(i))}else yu(i,l,p,Oa(i))}catch(ft){yu(i,l,{then:function(){},status:"rejected",reason:ft},Oa())}finally{Z.p=C,J!==null&&pe.types!==null&&(J.types=pe.types),te.T=J}}function AA(){}function hp(i,l,f,p){if(i.tag!==5)throw Error(s(476));var j=Ib(i).queue;Lb(i,j,l,we,f===null?AA:function(){return Mb(i),f(p)})}function Ib(i){var l=i.memoizedState;if(l!==null)return l;l={memoizedState:we,baseState:we,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yn,lastRenderedState:we},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yn,lastRenderedState:f},next:null},i.memoizedState=l,i=i.alternate,i!==null&&(i.memoizedState=l),l}function Mb(i){var l=Ib(i);l.next===null&&(l=i.alternate.memoizedState),yu(i,l.next.queue,{},Oa())}function mp(){return Ps(Lu)}function Pb(){return fs().memoizedState}function Bb(){return fs().memoizedState}function CA(i){for(var l=i.return;l!==null;){switch(l.tag){case 24:case 3:var f=Oa();i=Fi(f);var p=Li(l,i,f);p!==null&&(ba(p,l,f),hu(p,l,f)),l={cache:$m()},i.payload=l;return}l=l.return}}function RA(i,l,f){var p=Oa();f={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Pf(i)?zb(l,f):(f=Dm(i,l,f,p),f!==null&&(ba(f,i,p),qb(f,l,p)))}function Ub(i,l,f){var p=Oa();yu(i,l,f,p)}function yu(i,l,f,p){var j={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Pf(i))zb(l,j);else{var C=i.alternate;if(i.lanes===0&&(C===null||C.lanes===0)&&(C=l.lastRenderedReducer,C!==null))try{var J=l.lastRenderedState,pe=C(J,f);if(j.hasEagerState=!0,j.eagerState=pe,ja(pe,J))return yf(i,l,j,0),Ur===null&&gf(),!1}catch{}if(f=Dm(i,l,j,p),f!==null)return ba(f,i,p),qb(f,l,p),!0}return!1}function pp(i,l,f,p){if(p={lane:2,revertLane:Vp(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Pf(i)){if(l)throw Error(s(479))}else l=Dm(i,f,p,2),l!==null&&ba(l,i,2)}function Pf(i){var l=i.alternate;return i===Zt||l!==null&&l===Zt}function zb(i,l){zl=Rf=!0;var f=i.pending;f===null?l.next=l:(l.next=f.next,f.next=l),i.pending=l}function qb(i,l,f){if((f&4194048)!==0){var p=l.lanes;p&=i.pendingLanes,f|=p,l.lanes=f,Lt(i,f)}}var vu={readContext:Ps,use:Ff,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useLayoutEffect:es,useInsertionEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useSyncExternalStore:es,useId:es,useHostTransitionStatus:es,useFormState:es,useActionState:es,useOptimistic:es,useMemoCache:es,useCacheRefresh:es};vu.useEffectEvent=es;var $b={readContext:Ps,use:Ff,useCallback:function(i,l){return ua().memoizedState=[i,l===void 0?null:l],i},useContext:Ps,useEffect:Eb,useImperativeHandle:function(i,l,f){f=f!=null?f.concat([i]):null,If(4194308,4,Cb.bind(null,l,i),f)},useLayoutEffect:function(i,l){return If(4194308,4,i,l)},useInsertionEffect:function(i,l){If(4,2,i,l)},useMemo:function(i,l){var f=ua();l=l===void 0?null:l;var p=i();if(Co){Pt(!0);try{i()}finally{Pt(!1)}}return f.memoizedState=[p,l],p},useReducer:function(i,l,f){var p=ua();if(f!==void 0){var j=f(l);if(Co){Pt(!0);try{f(l)}finally{Pt(!1)}}}else j=l;return p.memoizedState=p.baseState=j,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:j},p.queue=i,i=i.dispatch=RA.bind(null,Zt,i),[p.memoizedState,i]},useRef:function(i){var l=ua();return i={current:i},l.memoizedState=i},useState:function(i){i=lp(i);var l=i.queue,f=Ub.bind(null,Zt,l);return l.dispatch=f,[i.memoizedState,f]},useDebugValue:dp,useDeferredValue:function(i,l){var f=ua();return fp(f,i,l)},useTransition:function(){var i=lp(!1);return i=Lb.bind(null,Zt,i.queue,!0,!1),ua().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,l,f){var p=Zt,j=ua();if(mr){if(f===void 0)throw Error(s(407));f=f()}else{if(f=l(),Ur===null)throw Error(s(349));(fr&127)!==0||ub(p,l,f)}j.memoizedState=f;var C={value:f,getSnapshot:l};return j.queue=C,Eb(fb.bind(null,p,C,i),[i]),p.flags|=2048,$l(9,{destroy:void 0},db.bind(null,p,C,f,l),null),f},useId:function(){var i=ua(),l=Ur.identifierPrefix;if(mr){var f=Tn,p=jn;f=(p&~(1<<32-Le(p)-1)).toString(32)+f,l="_"+l+"R_"+f,f=Df++,0<f&&(l+="H"+f.toString(32)),l+="_"}else f=kA++,l="_"+l+"r_"+f.toString(32)+"_";return i.memoizedState=l},useHostTransitionStatus:mp,useFormState:bb,useActionState:bb,useOptimistic:function(i){var l=ua();l.memoizedState=l.baseState=i;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=pp.bind(null,Zt,!0,f),f.dispatch=l,[i,l]},useMemoCache:np,useCacheRefresh:function(){return ua().memoizedState=CA.bind(null,Zt)},useEffectEvent:function(i){var l=ua(),f={impl:i};return l.memoizedState=f,function(){if((Sr&2)!==0)throw Error(s(440));return f.impl.apply(void 0,arguments)}}},xp={readContext:Ps,use:Ff,useCallback:Db,useContext:Ps,useEffect:up,useImperativeHandle:Rb,useInsertionEffect:Tb,useLayoutEffect:Ab,useMemo:Ob,useReducer:Lf,useRef:Nb,useState:function(){return Lf(Yn)},useDebugValue:dp,useDeferredValue:function(i,l){var f=fs();return Fb(f,Or.memoizedState,i,l)},useTransition:function(){var i=Lf(Yn)[0],l=fs().memoizedState;return[typeof i=="boolean"?i:gu(i),l]},useSyncExternalStore:cb,useId:Pb,useHostTransitionStatus:mp,useFormState:_b,useActionState:_b,useOptimistic:function(i,l){var f=fs();return pb(f,Or,i,l)},useMemoCache:np,useCacheRefresh:Bb};xp.useEffectEvent=jb;var Hb={readContext:Ps,use:Ff,useCallback:Db,useContext:Ps,useEffect:up,useImperativeHandle:Rb,useInsertionEffect:Tb,useLayoutEffect:Ab,useMemo:Ob,useReducer:op,useRef:Nb,useState:function(){return op(Yn)},useDebugValue:dp,useDeferredValue:function(i,l){var f=fs();return Or===null?fp(f,i,l):Fb(f,Or.memoizedState,i,l)},useTransition:function(){var i=op(Yn)[0],l=fs().memoizedState;return[typeof i=="boolean"?i:gu(i),l]},useSyncExternalStore:cb,useId:Pb,useHostTransitionStatus:mp,useFormState:kb,useActionState:kb,useOptimistic:function(i,l){var f=fs();return Or!==null?pb(f,Or,i,l):(f.baseState=i,[i,f.queue.dispatch])},useMemoCache:np,useCacheRefresh:Bb};Hb.useEffectEvent=jb;function gp(i,l,f,p){l=i.memoizedState,f=f(p,l),f=f==null?l:x({},l,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var yp={enqueueSetState:function(i,l,f){i=i._reactInternals;var p=Oa(),j=Fi(p);j.payload=l,f!=null&&(j.callback=f),l=Li(i,j,p),l!==null&&(ba(l,i,p),hu(l,i,p))},enqueueReplaceState:function(i,l,f){i=i._reactInternals;var p=Oa(),j=Fi(p);j.tag=1,j.payload=l,f!=null&&(j.callback=f),l=Li(i,j,p),l!==null&&(ba(l,i,p),hu(l,i,p))},enqueueForceUpdate:function(i,l){i=i._reactInternals;var f=Oa(),p=Fi(f);p.tag=2,l!=null&&(p.callback=l),l=Li(i,p,f),l!==null&&(ba(l,i,f),hu(l,i,f))}};function Wb(i,l,f,p,j,C,J){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,C,J):l.prototype&&l.prototype.isPureReactComponent?!nu(f,p)||!nu(j,C):!0}function Gb(i,l,f,p){i=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,p),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,p),l.state!==i&&yp.enqueueReplaceState(l,l.state,null)}function Ro(i,l){var f=l;if("ref"in l){f={};for(var p in l)p!=="ref"&&(f[p]=l[p])}if(i=i.defaultProps){f===l&&(f=x({},f));for(var j in i)f[j]===void 0&&(f[j]=i[j])}return f}function Vb(i){xf(i)}function Kb(i){console.error(i)}function Xb(i){xf(i)}function Bf(i,l){try{var f=i.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(p){setTimeout(function(){throw p})}}function Yb(i,l,f){try{var p=i.onCaughtError;p(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(j){setTimeout(function(){throw j})}}function vp(i,l,f){return f=Fi(f),f.tag=3,f.payload={element:null},f.callback=function(){Bf(i,l)},f}function Jb(i){return i=Fi(i),i.tag=3,i}function Zb(i,l,f,p){var j=f.type.getDerivedStateFromError;if(typeof j=="function"){var C=p.value;i.payload=function(){return j(C)},i.callback=function(){Yb(l,f,p)}}var J=f.stateNode;J!==null&&typeof J.componentDidCatch=="function"&&(i.callback=function(){Yb(l,f,p),typeof j!="function"&&(zi===null?zi=new Set([this]):zi.add(this));var pe=p.stack;this.componentDidCatch(p.value,{componentStack:pe!==null?pe:""})})}function DA(i,l,f,p,j){if(f.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(l=f.alternate,l!==null&&Ll(l,f,j,!0),f=Aa.current,f!==null){switch(f.tag){case 31:case 13:return Qa===null?Jf():f.alternate===null&&ts===0&&(ts=3),f.flags&=-257,f.flags|=65536,f.lanes=j,p===Ef?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([p]):l.add(p),Hp(i,p,j)),!1;case 22:return f.flags|=65536,p===Ef?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([p])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([p]):f.add(p)),Hp(i,p,j)),!1}throw Error(s(435,f.tag))}return Hp(i,p,j),Jf(),!1}if(mr)return l=Aa.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=j,p!==Pm&&(i=Error(s(422),{cause:p}),lu(Xa(i,f)))):(p!==Pm&&(l=Error(s(423),{cause:p}),lu(Xa(l,f))),i=i.current.alternate,i.flags|=65536,j&=-j,i.lanes|=j,p=Xa(p,f),j=vp(i.stateNode,p,j),Xm(i,j),ts!==4&&(ts=2)),!1;var C=Error(s(520),{cause:p});if(C=Xa(C,f),ju===null?ju=[C]:ju.push(C),ts!==4&&(ts=2),l===null)return!0;p=Xa(p,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,i=j&-j,f.lanes|=i,i=vp(f.stateNode,p,i),Xm(f,i),!1;case 1:if(l=f.type,C=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(zi===null||!zi.has(C))))return f.flags|=65536,j&=-j,f.lanes|=j,j=Jb(j),Zb(j,i,f,p),Xm(f,j),!1}f=f.return}while(f!==null);return!1}var wp=Error(s(461)),vs=!1;function Bs(i,l,f,p){l.child=i===null?rb(l,null,f,p):Ao(l,i.child,f,p)}function Qb(i,l,f,p,j){f=f.render;var C=l.ref;if("ref"in p){var J={};for(var pe in p)pe!=="ref"&&(J[pe]=p[pe])}else J=p;return No(l),p=tp(i,l,f,J,C,j),pe=rp(),i!==null&&!vs?(sp(i,l,j),Jn(i,l,j)):(mr&&pe&&Im(l),l.flags|=1,Bs(i,l,p,j),l.child)}function e_(i,l,f,p,j){if(i===null){var C=f.type;return typeof C=="function"&&!Om(C)&&C.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=C,t_(i,l,C,p,j)):(i=wf(f.type,null,p,l,l.mode,j),i.ref=l.ref,i.return=l,l.child=i)}if(C=i.child,!Tp(i,j)){var J=C.memoizedProps;if(f=f.compare,f=f!==null?f:nu,f(J,p)&&i.ref===l.ref)return Jn(i,l,j)}return l.flags|=1,i=Wn(C,p),i.ref=l.ref,i.return=l,l.child=i}function t_(i,l,f,p,j){if(i!==null){var C=i.memoizedProps;if(nu(C,p)&&i.ref===l.ref)if(vs=!1,l.pendingProps=p=C,Tp(i,j))(i.flags&131072)!==0&&(vs=!0);else return l.lanes=i.lanes,Jn(i,l,j)}return bp(i,l,f,p,j)}function r_(i,l,f,p){var j=p.children,C=i!==null?i.memoizedState:null;if(i===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((l.flags&128)!==0){if(C=C!==null?C.baseLanes|f:f,i!==null){for(p=l.child=i.child,j=0;p!==null;)j=j|p.lanes|p.childLanes,p=p.sibling;p=j&~C}else p=0,l.child=null;return s_(i,l,C,f,p)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},i!==null&&kf(l,C!==null?C.cachePool:null),C!==null?nb(l,C):Jm(),ib(l);else return p=l.lanes=536870912,s_(i,l,C!==null?C.baseLanes|f:f,f,p)}else C!==null?(kf(l,C.cachePool),nb(l,C),Mi(),l.memoizedState=null):(i!==null&&kf(l,null),Jm(),Mi());return Bs(i,l,j,f),l.child}function wu(i,l){return i!==null&&i.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function s_(i,l,f,p,j){var C=Wm();return C=C===null?null:{parent:gs._currentValue,pool:C},l.memoizedState={baseLanes:f,cachePool:C},i!==null&&kf(l,null),Jm(),ib(l),i!==null&&Ll(i,l,p,!0),l.childLanes=j,null}function Uf(i,l){return l=qf({mode:l.mode,children:l.children},i.mode),l.ref=i.ref,i.child=l,l.return=i,l}function a_(i,l,f){return Ao(l,i.child,null,f),i=Uf(l,l.pendingProps),i.flags|=2,Ca(l),l.memoizedState=null,i}function OA(i,l,f){var p=l.pendingProps,j=(l.flags&128)!==0;if(l.flags&=-129,i===null){if(mr){if(p.mode==="hidden")return i=Uf(l,p),l.lanes=536870912,wu(null,i);if(Qm(l),(i=$r)?(i=x2(i,Za),i=i!==null&&i.data==="&"?i:null,i!==null&&(l.memoizedState={dehydrated:i,treeContext:Ai!==null?{id:jn,overflow:Tn}:null,retryLane:536870912,hydrationErrors:null},f=zw(i),f.return=l,l.child=f,Ms=l,$r=null)):i=null,i===null)throw Ri(l);return l.lanes=536870912,null}return Uf(l,p)}var C=i.memoizedState;if(C!==null){var J=C.dehydrated;if(Qm(l),j)if(l.flags&256)l.flags&=-257,l=a_(i,l,f);else if(l.memoizedState!==null)l.child=i.child,l.flags|=128,l=null;else throw Error(s(558));else if(vs||Ll(i,l,f,!1),j=(f&i.childLanes)!==0,vs||j){if(p=Ur,p!==null&&(J=Yt(p,f),J!==0&&J!==C.retryLane))throw C.retryLane=J,bo(i,J),ba(p,i,J),wp;Jf(),l=a_(i,l,f)}else i=C.treeContext,$r=en(J.nextSibling),Ms=l,mr=!0,Ci=null,Za=!1,i!==null&&Hw(l,i),l=Uf(l,p),l.flags|=4096;return l}return i=Wn(i.child,{mode:p.mode,children:p.children}),i.ref=l.ref,l.child=i,i.return=l,i}function zf(i,l){var f=l.ref;if(f===null)i!==null&&i.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(s(284));(i===null||i.ref!==f)&&(l.flags|=4194816)}}function bp(i,l,f,p,j){return No(l),f=tp(i,l,f,p,void 0,j),p=rp(),i!==null&&!vs?(sp(i,l,j),Jn(i,l,j)):(mr&&p&&Im(l),l.flags|=1,Bs(i,l,f,j),l.child)}function n_(i,l,f,p,j,C){return No(l),l.updateQueue=null,f=lb(l,p,f,j),ob(i),p=rp(),i!==null&&!vs?(sp(i,l,C),Jn(i,l,C)):(mr&&p&&Im(l),l.flags|=1,Bs(i,l,f,C),l.child)}function i_(i,l,f,p,j){if(No(l),l.stateNode===null){var C=Rl,J=f.contextType;typeof J=="object"&&J!==null&&(C=Ps(J)),C=new f(p,C),l.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=yp,l.stateNode=C,C._reactInternals=l,C=l.stateNode,C.props=p,C.state=l.memoizedState,C.refs={},Vm(l),J=f.contextType,C.context=typeof J=="object"&&J!==null?Ps(J):Rl,C.state=l.memoizedState,J=f.getDerivedStateFromProps,typeof J=="function"&&(gp(l,f,J,p),C.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(J=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),J!==C.state&&yp.enqueueReplaceState(C,C.state,null),pu(l,p,C,j),mu(),C.state=l.memoizedState),typeof C.componentDidMount=="function"&&(l.flags|=4194308),p=!0}else if(i===null){C=l.stateNode;var pe=l.memoizedProps,Fe=Ro(f,pe);C.props=Fe;var Xe=C.context,ot=f.contextType;J=Rl,typeof ot=="object"&&ot!==null&&(J=Ps(ot));var ft=f.getDerivedStateFromProps;ot=typeof ft=="function"||typeof C.getSnapshotBeforeUpdate=="function",pe=l.pendingProps!==pe,ot||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(pe||Xe!==J)&&Gb(l,C,p,J),Oi=!1;var Ye=l.memoizedState;C.state=Ye,pu(l,p,C,j),mu(),Xe=l.memoizedState,pe||Ye!==Xe||Oi?(typeof ft=="function"&&(gp(l,f,ft,p),Xe=l.memoizedState),(Fe=Oi||Wb(l,f,Fe,p,Ye,Xe,J))?(ot||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(l.flags|=4194308)):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=p,l.memoizedState=Xe),C.props=p,C.state=Xe,C.context=J,p=Fe):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),p=!1)}else{C=l.stateNode,Km(i,l),J=l.memoizedProps,ot=Ro(f,J),C.props=ot,ft=l.pendingProps,Ye=C.context,Xe=f.contextType,Fe=Rl,typeof Xe=="object"&&Xe!==null&&(Fe=Ps(Xe)),pe=f.getDerivedStateFromProps,(Xe=typeof pe=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(J!==ft||Ye!==Fe)&&Gb(l,C,p,Fe),Oi=!1,Ye=l.memoizedState,C.state=Ye,pu(l,p,C,j),mu();var et=l.memoizedState;J!==ft||Ye!==et||Oi||i!==null&&i.dependencies!==null&&_f(i.dependencies)?(typeof pe=="function"&&(gp(l,f,pe,p),et=l.memoizedState),(ot=Oi||Wb(l,f,ot,p,Ye,et,Fe)||i!==null&&i.dependencies!==null&&_f(i.dependencies))?(Xe||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(p,et,Fe),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(p,et,Fe)),typeof C.componentDidUpdate=="function"&&(l.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof C.componentDidUpdate!="function"||J===i.memoizedProps&&Ye===i.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||J===i.memoizedProps&&Ye===i.memoizedState||(l.flags|=1024),l.memoizedProps=p,l.memoizedState=et),C.props=p,C.state=et,C.context=Fe,p=ot):(typeof C.componentDidUpdate!="function"||J===i.memoizedProps&&Ye===i.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||J===i.memoizedProps&&Ye===i.memoizedState||(l.flags|=1024),p=!1)}return C=p,zf(i,l),p=(l.flags&128)!==0,C||p?(C=l.stateNode,f=p&&typeof f.getDerivedStateFromError!="function"?null:C.render(),l.flags|=1,i!==null&&p?(l.child=Ao(l,i.child,null,j),l.child=Ao(l,null,f,j)):Bs(i,l,f,j),l.memoizedState=C.state,i=l.child):i=Jn(i,l,j),i}function o_(i,l,f,p){return So(),l.flags|=256,Bs(i,l,f,p),l.child}var _p={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Sp(i){return{baseLanes:i,cachePool:Yw()}}function kp(i,l,f){return i=i!==null?i.childLanes&~f:0,l&&(i|=Da),i}function l_(i,l,f){var p=l.pendingProps,j=!1,C=(l.flags&128)!==0,J;if((J=C)||(J=i!==null&&i.memoizedState===null?!1:(ds.current&2)!==0),J&&(j=!0,l.flags&=-129),J=(l.flags&32)!==0,l.flags&=-33,i===null){if(mr){if(j?Ii(l):Mi(),(i=$r)?(i=x2(i,Za),i=i!==null&&i.data!=="&"?i:null,i!==null&&(l.memoizedState={dehydrated:i,treeContext:Ai!==null?{id:jn,overflow:Tn}:null,retryLane:536870912,hydrationErrors:null},f=zw(i),f.return=l,l.child=f,Ms=l,$r=null)):i=null,i===null)throw Ri(l);return ix(i)?l.lanes=32:l.lanes=536870912,null}var pe=p.children;return p=p.fallback,j?(Mi(),j=l.mode,pe=qf({mode:"hidden",children:pe},j),p=_o(p,j,f,null),pe.return=l,p.return=l,pe.sibling=p,l.child=pe,p=l.child,p.memoizedState=Sp(f),p.childLanes=kp(i,J,f),l.memoizedState=_p,wu(null,p)):(Ii(l),Np(l,pe))}var Fe=i.memoizedState;if(Fe!==null&&(pe=Fe.dehydrated,pe!==null)){if(C)l.flags&256?(Ii(l),l.flags&=-257,l=Ep(i,l,f)):l.memoizedState!==null?(Mi(),l.child=i.child,l.flags|=128,l=null):(Mi(),pe=p.fallback,j=l.mode,p=qf({mode:"visible",children:p.children},j),pe=_o(pe,j,f,null),pe.flags|=2,p.return=l,pe.return=l,p.sibling=pe,l.child=p,Ao(l,i.child,null,f),p=l.child,p.memoizedState=Sp(f),p.childLanes=kp(i,J,f),l.memoizedState=_p,l=wu(null,p));else if(Ii(l),ix(pe)){if(J=pe.nextSibling&&pe.nextSibling.dataset,J)var Xe=J.dgst;J=Xe,p=Error(s(419)),p.stack="",p.digest=J,lu({value:p,source:null,stack:null}),l=Ep(i,l,f)}else if(vs||Ll(i,l,f,!1),J=(f&i.childLanes)!==0,vs||J){if(J=Ur,J!==null&&(p=Yt(J,f),p!==0&&p!==Fe.retryLane))throw Fe.retryLane=p,bo(i,p),ba(J,i,p),wp;nx(pe)||Jf(),l=Ep(i,l,f)}else nx(pe)?(l.flags|=192,l.child=i.child,l=null):(i=Fe.treeContext,$r=en(pe.nextSibling),Ms=l,mr=!0,Ci=null,Za=!1,i!==null&&Hw(l,i),l=Np(l,p.children),l.flags|=4096);return l}return j?(Mi(),pe=p.fallback,j=l.mode,Fe=i.child,Xe=Fe.sibling,p=Wn(Fe,{mode:"hidden",children:p.children}),p.subtreeFlags=Fe.subtreeFlags&65011712,Xe!==null?pe=Wn(Xe,pe):(pe=_o(pe,j,f,null),pe.flags|=2),pe.return=l,p.return=l,p.sibling=pe,l.child=p,wu(null,p),p=l.child,pe=i.child.memoizedState,pe===null?pe=Sp(f):(j=pe.cachePool,j!==null?(Fe=gs._currentValue,j=j.parent!==Fe?{parent:Fe,pool:Fe}:j):j=Yw(),pe={baseLanes:pe.baseLanes|f,cachePool:j}),p.memoizedState=pe,p.childLanes=kp(i,J,f),l.memoizedState=_p,wu(i.child,p)):(Ii(l),f=i.child,i=f.sibling,f=Wn(f,{mode:"visible",children:p.children}),f.return=l,f.sibling=null,i!==null&&(J=l.deletions,J===null?(l.deletions=[i],l.flags|=16):J.push(i)),l.child=f,l.memoizedState=null,f)}function Np(i,l){return l=qf({mode:"visible",children:l},i.mode),l.return=i,i.child=l}function qf(i,l){return i=Ta(22,i,null,l),i.lanes=0,i}function Ep(i,l,f){return Ao(l,i.child,null,f),i=Np(l,l.pendingProps.children),i.flags|=2,l.memoizedState=null,i}function c_(i,l,f){i.lanes|=l;var p=i.alternate;p!==null&&(p.lanes|=l),zm(i.return,l,f)}function jp(i,l,f,p,j,C){var J=i.memoizedState;J===null?i.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:p,tail:f,tailMode:j,treeForkCount:C}:(J.isBackwards=l,J.rendering=null,J.renderingStartTime=0,J.last=p,J.tail=f,J.tailMode=j,J.treeForkCount=C)}function u_(i,l,f){var p=l.pendingProps,j=p.revealOrder,C=p.tail;p=p.children;var J=ds.current,pe=(J&2)!==0;if(pe?(J=J&1|2,l.flags|=128):J&=1,X(ds,J),Bs(i,l,p,f),p=mr?ou:0,!pe&&i!==null&&(i.flags&128)!==0)e:for(i=l.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&c_(i,f,l);else if(i.tag===19)c_(i,f,l);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break e;for(;i.sibling===null;){if(i.return===null||i.return===l)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(j){case"forwards":for(f=l.child,j=null;f!==null;)i=f.alternate,i!==null&&Cf(i)===null&&(j=f),f=f.sibling;f=j,f===null?(j=l.child,l.child=null):(j=f.sibling,f.sibling=null),jp(l,!1,j,f,C,p);break;case"backwards":case"unstable_legacy-backwards":for(f=null,j=l.child,l.child=null;j!==null;){if(i=j.alternate,i!==null&&Cf(i)===null){l.child=j;break}i=j.sibling,j.sibling=f,f=j,j=i}jp(l,!0,f,null,C,p);break;case"together":jp(l,!1,null,null,void 0,p);break;default:l.memoizedState=null}return l.child}function Jn(i,l,f){if(i!==null&&(l.dependencies=i.dependencies),Ui|=l.lanes,(f&l.childLanes)===0)if(i!==null){if(Ll(i,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(i!==null&&l.child!==i.child)throw Error(s(153));if(l.child!==null){for(i=l.child,f=Wn(i,i.pendingProps),l.child=f,f.return=l;i.sibling!==null;)i=i.sibling,f=f.sibling=Wn(i,i.pendingProps),f.return=l;f.sibling=null}return l.child}function Tp(i,l){return(i.lanes&l)!==0?!0:(i=i.dependencies,!!(i!==null&&_f(i)))}function FA(i,l,f){switch(l.tag){case 3:z(l,l.stateNode.containerInfo),Di(l,gs,i.memoizedState.cache),So();break;case 27:case 5:se(l);break;case 4:z(l,l.stateNode.containerInfo);break;case 10:Di(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Qm(l),null;break;case 13:var p=l.memoizedState;if(p!==null)return p.dehydrated!==null?(Ii(l),l.flags|=128,null):(f&l.child.childLanes)!==0?l_(i,l,f):(Ii(l),i=Jn(i,l,f),i!==null?i.sibling:null);Ii(l);break;case 19:var j=(i.flags&128)!==0;if(p=(f&l.childLanes)!==0,p||(Ll(i,l,f,!1),p=(f&l.childLanes)!==0),j){if(p)return u_(i,l,f);l.flags|=128}if(j=l.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),X(ds,ds.current),p)break;return null;case 22:return l.lanes=0,r_(i,l,f,l.pendingProps);case 24:Di(l,gs,i.memoizedState.cache)}return Jn(i,l,f)}function d_(i,l,f){if(i!==null)if(i.memoizedProps!==l.pendingProps)vs=!0;else{if(!Tp(i,f)&&(l.flags&128)===0)return vs=!1,FA(i,l,f);vs=(i.flags&131072)!==0}else vs=!1,mr&&(l.flags&1048576)!==0&&$w(l,ou,l.index);switch(l.lanes=0,l.tag){case 16:e:{var p=l.pendingProps;if(i=jo(l.elementType),l.type=i,typeof i=="function")Om(i)?(p=Ro(i,p),l.tag=1,l=i_(null,l,i,p,f)):(l.tag=0,l=bp(null,l,i,p,f));else{if(i!=null){var j=i.$$typeof;if(j===E){l.tag=11,l=Qb(null,l,i,p,f);break e}else if(j===O){l.tag=14,l=e_(null,l,i,p,f);break e}}throw l=M(i)||i,Error(s(306,l,""))}}return l;case 0:return bp(i,l,l.type,l.pendingProps,f);case 1:return p=l.type,j=Ro(p,l.pendingProps),i_(i,l,p,j,f);case 3:e:{if(z(l,l.stateNode.containerInfo),i===null)throw Error(s(387));p=l.pendingProps;var C=l.memoizedState;j=C.element,Km(i,l),pu(l,p,null,f);var J=l.memoizedState;if(p=J.cache,Di(l,gs,p),p!==C.cache&&qm(l,[gs],f,!0),mu(),p=J.element,C.isDehydrated)if(C={element:p,isDehydrated:!1,cache:J.cache},l.updateQueue.baseState=C,l.memoizedState=C,l.flags&256){l=o_(i,l,p,f);break e}else if(p!==j){j=Xa(Error(s(424)),l),lu(j),l=o_(i,l,p,f);break e}else for(i=l.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,$r=en(i.firstChild),Ms=l,mr=!0,Ci=null,Za=!0,f=rb(l,null,p,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(So(),p===j){l=Jn(i,l,f);break e}Bs(i,l,p,f)}l=l.child}return l;case 26:return zf(i,l),i===null?(f=_2(l.type,null,l.pendingProps,null))?l.memoizedState=f:mr||(f=l.type,i=l.pendingProps,p=ah(ie.current).createElement(f),p[ye]=l,p[Se]=i,Us(p,f,i),Ie(p),l.stateNode=p):l.memoizedState=_2(l.type,i.memoizedProps,l.pendingProps,i.memoizedState),null;case 27:return se(l),i===null&&mr&&(p=l.stateNode=v2(l.type,l.pendingProps,ie.current),Ms=l,Za=!0,j=$r,Wi(l.type)?(ox=j,$r=en(p.firstChild)):$r=j),Bs(i,l,l.pendingProps.children,f),zf(i,l),i===null&&(l.flags|=4194304),l.child;case 5:return i===null&&mr&&((j=p=$r)&&(p=uC(p,l.type,l.pendingProps,Za),p!==null?(l.stateNode=p,Ms=l,$r=en(p.firstChild),Za=!1,j=!0):j=!1),j||Ri(l)),se(l),j=l.type,C=l.pendingProps,J=i!==null?i.memoizedProps:null,p=C.children,rx(j,C)?p=null:J!==null&&rx(j,J)&&(l.flags|=32),l.memoizedState!==null&&(j=tp(i,l,NA,null,null,f),Lu._currentValue=j),zf(i,l),Bs(i,l,p,f),l.child;case 6:return i===null&&mr&&((i=f=$r)&&(f=dC(f,l.pendingProps,Za),f!==null?(l.stateNode=f,Ms=l,$r=null,i=!0):i=!1),i||Ri(l)),null;case 13:return l_(i,l,f);case 4:return z(l,l.stateNode.containerInfo),p=l.pendingProps,i===null?l.child=Ao(l,null,p,f):Bs(i,l,p,f),l.child;case 11:return Qb(i,l,l.type,l.pendingProps,f);case 7:return Bs(i,l,l.pendingProps,f),l.child;case 8:return Bs(i,l,l.pendingProps.children,f),l.child;case 12:return Bs(i,l,l.pendingProps.children,f),l.child;case 10:return p=l.pendingProps,Di(l,l.type,p.value),Bs(i,l,p.children,f),l.child;case 9:return j=l.type._context,p=l.pendingProps.children,No(l),j=Ps(j),p=p(j),l.flags|=1,Bs(i,l,p,f),l.child;case 14:return e_(i,l,l.type,l.pendingProps,f);case 15:return t_(i,l,l.type,l.pendingProps,f);case 19:return u_(i,l,f);case 31:return OA(i,l,f);case 22:return r_(i,l,f,l.pendingProps);case 24:return No(l),p=Ps(gs),i===null?(j=Wm(),j===null&&(j=Ur,C=$m(),j.pooledCache=C,C.refCount++,C!==null&&(j.pooledCacheLanes|=f),j=C),l.memoizedState={parent:p,cache:j},Vm(l),Di(l,gs,j)):((i.lanes&f)!==0&&(Km(i,l),pu(l,null,null,f),mu()),j=i.memoizedState,C=l.memoizedState,j.parent!==p?(j={parent:p,cache:p},l.memoizedState=j,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=j),Di(l,gs,p)):(p=C.cache,Di(l,gs,p),p!==j.cache&&qm(l,[gs],f,!0))),Bs(i,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(s(156,l.tag))}function Zn(i){i.flags|=4}function Ap(i,l,f,p,j){if((l=(i.mode&32)!==0)&&(l=!1),l){if(i.flags|=16777216,(j&335544128)===j)if(i.stateNode.complete)i.flags|=8192;else if(P_())i.flags|=8192;else throw To=Ef,Gm}else i.flags&=-16777217}function f_(i,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!j2(l))if(P_())i.flags|=8192;else throw To=Ef,Gm}function $f(i,l){l!==null&&(i.flags|=4),i.flags&16384&&(l=i.tag!==22?qe():536870912,i.lanes|=l,Vl|=l)}function bu(i,l){if(!mr)switch(i.tailMode){case"hidden":l=i.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?l||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Hr(i){var l=i.alternate!==null&&i.alternate.child===i.child,f=0,p=0;if(l)for(var j=i.child;j!==null;)f|=j.lanes|j.childLanes,p|=j.subtreeFlags&65011712,p|=j.flags&65011712,j.return=i,j=j.sibling;else for(j=i.child;j!==null;)f|=j.lanes|j.childLanes,p|=j.subtreeFlags,p|=j.flags,j.return=i,j=j.sibling;return i.subtreeFlags|=p,i.childLanes=f,l}function LA(i,l,f){var p=l.pendingProps;switch(Mm(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hr(l),null;case 1:return Hr(l),null;case 3:return f=l.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),l.memoizedState.cache!==p&&(l.flags|=2048),Kn(gs),ue(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(Fl(l)?Zn(l):i===null||i.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Bm())),Hr(l),null;case 26:var j=l.type,C=l.memoizedState;return i===null?(Zn(l),C!==null?(Hr(l),f_(l,C)):(Hr(l),Ap(l,j,null,p,f))):C?C!==i.memoizedState?(Zn(l),Hr(l),f_(l,C)):(Hr(l),l.flags&=-16777217):(i=i.memoizedProps,i!==p&&Zn(l),Hr(l),Ap(l,j,i,p,f)),null;case 27:if(re(l),f=ie.current,j=l.type,i!==null&&l.stateNode!=null)i.memoizedProps!==p&&Zn(l);else{if(!p){if(l.stateNode===null)throw Error(s(166));return Hr(l),null}i=H.current,Fl(l)?Ww(l):(i=v2(j,p,f),l.stateNode=i,Zn(l))}return Hr(l),null;case 5:if(re(l),j=l.type,i!==null&&l.stateNode!=null)i.memoizedProps!==p&&Zn(l);else{if(!p){if(l.stateNode===null)throw Error(s(166));return Hr(l),null}if(C=H.current,Fl(l))Ww(l);else{var J=ah(ie.current);switch(C){case 1:C=J.createElementNS("http://www.w3.org/2000/svg",j);break;case 2:C=J.createElementNS("http://www.w3.org/1998/Math/MathML",j);break;default:switch(j){case"svg":C=J.createElementNS("http://www.w3.org/2000/svg",j);break;case"math":C=J.createElementNS("http://www.w3.org/1998/Math/MathML",j);break;case"script":C=J.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof p.is=="string"?J.createElement("select",{is:p.is}):J.createElement("select"),p.multiple?C.multiple=!0:p.size&&(C.size=p.size);break;default:C=typeof p.is=="string"?J.createElement(j,{is:p.is}):J.createElement(j)}}C[ye]=l,C[Se]=p;e:for(J=l.child;J!==null;){if(J.tag===5||J.tag===6)C.appendChild(J.stateNode);else if(J.tag!==4&&J.tag!==27&&J.child!==null){J.child.return=J,J=J.child;continue}if(J===l)break e;for(;J.sibling===null;){if(J.return===null||J.return===l)break e;J=J.return}J.sibling.return=J.return,J=J.sibling}l.stateNode=C;e:switch(Us(C,j,p),j){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&Zn(l)}}return Hr(l),Ap(l,l.type,i===null?null:i.memoizedProps,l.pendingProps,f),null;case 6:if(i&&l.stateNode!=null)i.memoizedProps!==p&&Zn(l);else{if(typeof p!="string"&&l.stateNode===null)throw Error(s(166));if(i=ie.current,Fl(l)){if(i=l.stateNode,f=l.memoizedProps,p=null,j=Ms,j!==null)switch(j.tag){case 27:case 5:p=j.memoizedProps}i[ye]=l,i=!!(i.nodeValue===f||p!==null&&p.suppressHydrationWarning===!0||l2(i.nodeValue,f)),i||Ri(l,!0)}else i=ah(i).createTextNode(p),i[ye]=l,l.stateNode=i}return Hr(l),null;case 31:if(f=l.memoizedState,i===null||i.memoizedState!==null){if(p=Fl(l),f!==null){if(i===null){if(!p)throw Error(s(318));if(i=l.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(557));i[ye]=l}else So(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Hr(l),i=!1}else f=Bm(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=f),i=!0;if(!i)return l.flags&256?(Ca(l),l):(Ca(l),null);if((l.flags&128)!==0)throw Error(s(558))}return Hr(l),null;case 13:if(p=l.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(j=Fl(l),p!==null&&p.dehydrated!==null){if(i===null){if(!j)throw Error(s(318));if(j=l.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(s(317));j[ye]=l}else So(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Hr(l),j=!1}else j=Bm(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=j),j=!0;if(!j)return l.flags&256?(Ca(l),l):(Ca(l),null)}return Ca(l),(l.flags&128)!==0?(l.lanes=f,l):(f=p!==null,i=i!==null&&i.memoizedState!==null,f&&(p=l.child,j=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(j=p.alternate.memoizedState.cachePool.pool),C=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(C=p.memoizedState.cachePool.pool),C!==j&&(p.flags|=2048)),f!==i&&f&&(l.child.flags|=8192),$f(l,l.updateQueue),Hr(l),null);case 4:return ue(),i===null&&Jp(l.stateNode.containerInfo),Hr(l),null;case 10:return Kn(l.type),Hr(l),null;case 19:if(I(ds),p=l.memoizedState,p===null)return Hr(l),null;if(j=(l.flags&128)!==0,C=p.rendering,C===null)if(j)bu(p,!1);else{if(ts!==0||i!==null&&(i.flags&128)!==0)for(i=l.child;i!==null;){if(C=Cf(i),C!==null){for(l.flags|=128,bu(p,!1),i=C.updateQueue,l.updateQueue=i,$f(l,i),l.subtreeFlags=0,i=f,f=l.child;f!==null;)Uw(f,i),f=f.sibling;return X(ds,ds.current&1|2),mr&&Gn(l,p.treeForkCount),l.child}i=i.sibling}p.tail!==null&&Me()>Kf&&(l.flags|=128,j=!0,bu(p,!1),l.lanes=4194304)}else{if(!j)if(i=Cf(C),i!==null){if(l.flags|=128,j=!0,i=i.updateQueue,l.updateQueue=i,$f(l,i),bu(p,!0),p.tail===null&&p.tailMode==="hidden"&&!C.alternate&&!mr)return Hr(l),null}else 2*Me()-p.renderingStartTime>Kf&&f!==536870912&&(l.flags|=128,j=!0,bu(p,!1),l.lanes=4194304);p.isBackwards?(C.sibling=l.child,l.child=C):(i=p.last,i!==null?i.sibling=C:l.child=C,p.last=C)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=Me(),i.sibling=null,f=ds.current,X(ds,j?f&1|2:f&1),mr&&Gn(l,p.treeForkCount),i):(Hr(l),null);case 22:case 23:return Ca(l),Zm(),p=l.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(l.flags|=8192):p&&(l.flags|=8192),p?(f&536870912)!==0&&(l.flags&128)===0&&(Hr(l),l.subtreeFlags&6&&(l.flags|=8192)):Hr(l),f=l.updateQueue,f!==null&&$f(l,f.retryQueue),f=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),p=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),p!==f&&(l.flags|=2048),i!==null&&I(Eo),null;case 24:return f=null,i!==null&&(f=i.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),Kn(gs),Hr(l),null;case 25:return null;case 30:return null}throw Error(s(156,l.tag))}function IA(i,l){switch(Mm(l),l.tag){case 1:return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 3:return Kn(gs),ue(),i=l.flags,(i&65536)!==0&&(i&128)===0?(l.flags=i&-65537|128,l):null;case 26:case 27:case 5:return re(l),null;case 31:if(l.memoizedState!==null){if(Ca(l),l.alternate===null)throw Error(s(340));So()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 13:if(Ca(l),i=l.memoizedState,i!==null&&i.dehydrated!==null){if(l.alternate===null)throw Error(s(340));So()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 19:return I(ds),null;case 4:return ue(),null;case 10:return Kn(l.type),null;case 22:case 23:return Ca(l),Zm(),i!==null&&I(Eo),i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 24:return Kn(gs),null;case 25:return null;default:return null}}function h_(i,l){switch(Mm(l),l.tag){case 3:Kn(gs),ue();break;case 26:case 27:case 5:re(l);break;case 4:ue();break;case 31:l.memoizedState!==null&&Ca(l);break;case 13:Ca(l);break;case 19:I(ds);break;case 10:Kn(l.type);break;case 22:case 23:Ca(l),Zm(),i!==null&&I(Eo);break;case 24:Kn(gs)}}function _u(i,l){try{var f=l.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var j=p.next;f=j;do{if((f.tag&i)===i){p=void 0;var C=f.create,J=f.inst;p=C(),J.destroy=p}f=f.next}while(f!==j)}}catch(pe){Er(l,l.return,pe)}}function Pi(i,l,f){try{var p=l.updateQueue,j=p!==null?p.lastEffect:null;if(j!==null){var C=j.next;p=C;do{if((p.tag&i)===i){var J=p.inst,pe=J.destroy;if(pe!==void 0){J.destroy=void 0,j=l;var Fe=f,Xe=pe;try{Xe()}catch(ot){Er(j,Fe,ot)}}}p=p.next}while(p!==C)}}catch(ot){Er(l,l.return,ot)}}function m_(i){var l=i.updateQueue;if(l!==null){var f=i.stateNode;try{ab(l,f)}catch(p){Er(i,i.return,p)}}}function p_(i,l,f){f.props=Ro(i.type,i.memoizedProps),f.state=i.memoizedState;try{f.componentWillUnmount()}catch(p){Er(i,l,p)}}function Su(i,l){try{var f=i.ref;if(f!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof f=="function"?i.refCleanup=f(p):f.current=p}}catch(j){Er(i,l,j)}}function An(i,l){var f=i.ref,p=i.refCleanup;if(f!==null)if(typeof p=="function")try{p()}catch(j){Er(i,l,j)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(j){Er(i,l,j)}else f.current=null}function x_(i){var l=i.type,f=i.memoizedProps,p=i.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&p.focus();break e;case"img":f.src?p.src=f.src:f.srcSet&&(p.srcset=f.srcSet)}}catch(j){Er(i,i.return,j)}}function Cp(i,l,f){try{var p=i.stateNode;aC(p,i.type,f,l),p[Se]=l}catch(j){Er(i,i.return,j)}}function g_(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Wi(i.type)||i.tag===4}function Rp(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||g_(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Wi(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Dp(i,l,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(i,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(i),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=$n));else if(p!==4&&(p===27&&Wi(i.type)&&(f=i.stateNode,l=null),i=i.child,i!==null))for(Dp(i,l,f),i=i.sibling;i!==null;)Dp(i,l,f),i=i.sibling}function Hf(i,l,f){var p=i.tag;if(p===5||p===6)i=i.stateNode,l?f.insertBefore(i,l):f.appendChild(i);else if(p!==4&&(p===27&&Wi(i.type)&&(f=i.stateNode),i=i.child,i!==null))for(Hf(i,l,f),i=i.sibling;i!==null;)Hf(i,l,f),i=i.sibling}function y_(i){var l=i.stateNode,f=i.memoizedProps;try{for(var p=i.type,j=l.attributes;j.length;)l.removeAttributeNode(j[0]);Us(l,p,f),l[ye]=i,l[Se]=f}catch(C){Er(i,i.return,C)}}var Qn=!1,ws=!1,Op=!1,v_=typeof WeakSet=="function"?WeakSet:Set,Cs=null;function MA(i,l){if(i=i.containerInfo,ex=dh,i=Rw(i),Em(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else e:{f=(f=i.ownerDocument)&&f.defaultView||window;var p=f.getSelection&&f.getSelection();if(p&&p.rangeCount!==0){f=p.anchorNode;var j=p.anchorOffset,C=p.focusNode;p=p.focusOffset;try{f.nodeType,C.nodeType}catch{f=null;break e}var J=0,pe=-1,Fe=-1,Xe=0,ot=0,ft=i,Ye=null;t:for(;;){for(var et;ft!==f||j!==0&&ft.nodeType!==3||(pe=J+j),ft!==C||p!==0&&ft.nodeType!==3||(Fe=J+p),ft.nodeType===3&&(J+=ft.nodeValue.length),(et=ft.firstChild)!==null;)Ye=ft,ft=et;for(;;){if(ft===i)break t;if(Ye===f&&++Xe===j&&(pe=J),Ye===C&&++ot===p&&(Fe=J),(et=ft.nextSibling)!==null)break;ft=Ye,Ye=ft.parentNode}ft=et}f=pe===-1||Fe===-1?null:{start:pe,end:Fe}}else f=null}f=f||{start:0,end:0}}else f=null;for(tx={focusedElem:i,selectionRange:f},dh=!1,Cs=l;Cs!==null;)if(l=Cs,i=l.child,(l.subtreeFlags&1028)!==0&&i!==null)i.return=l,Cs=i;else for(;Cs!==null;){switch(l=Cs,C=l.alternate,i=l.flags,l.tag){case 0:if((i&4)!==0&&(i=l.updateQueue,i=i!==null?i.events:null,i!==null))for(f=0;f<i.length;f++)j=i[f],j.ref.impl=j.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&C!==null){i=void 0,f=l,j=C.memoizedProps,C=C.memoizedState,p=f.stateNode;try{var Dt=Ro(f.type,j);i=p.getSnapshotBeforeUpdate(Dt,C),p.__reactInternalSnapshotBeforeUpdate=i}catch($t){Er(f,f.return,$t)}}break;case 3:if((i&1024)!==0){if(i=l.stateNode.containerInfo,f=i.nodeType,f===9)ax(i);else if(f===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":ax(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(s(163))}if(i=l.sibling,i!==null){i.return=l.return,Cs=i;break}Cs=l.return}}function w_(i,l,f){var p=f.flags;switch(f.tag){case 0:case 11:case 15:ti(i,f),p&4&&_u(5,f);break;case 1:if(ti(i,f),p&4)if(i=f.stateNode,l===null)try{i.componentDidMount()}catch(J){Er(f,f.return,J)}else{var j=Ro(f.type,l.memoizedProps);l=l.memoizedState;try{i.componentDidUpdate(j,l,i.__reactInternalSnapshotBeforeUpdate)}catch(J){Er(f,f.return,J)}}p&64&&m_(f),p&512&&Su(f,f.return);break;case 3:if(ti(i,f),p&64&&(i=f.updateQueue,i!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{ab(i,l)}catch(J){Er(f,f.return,J)}}break;case 27:l===null&&p&4&&y_(f);case 26:case 5:ti(i,f),l===null&&p&4&&x_(f),p&512&&Su(f,f.return);break;case 12:ti(i,f);break;case 31:ti(i,f),p&4&&S_(i,f);break;case 13:ti(i,f),p&4&&k_(i,f),p&64&&(i=f.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(f=GA.bind(null,f),fC(i,f))));break;case 22:if(p=f.memoizedState!==null||Qn,!p){l=l!==null&&l.memoizedState!==null||ws,j=Qn;var C=ws;Qn=p,(ws=l)&&!C?ri(i,f,(f.subtreeFlags&8772)!==0):ti(i,f),Qn=j,ws=C}break;case 30:break;default:ti(i,f)}}function b_(i){var l=i.alternate;l!==null&&(i.alternate=null,b_(l)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(l=i.stateNode,l!==null&&ht(l)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Kr=null,ga=!1;function ei(i,l,f){for(f=f.child;f!==null;)__(i,l,f),f=f.sibling}function __(i,l,f){if(jt&&typeof jt.onCommitFiberUnmount=="function")try{jt.onCommitFiberUnmount(wt,f)}catch{}switch(f.tag){case 26:ws||An(f,l),ei(i,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:ws||An(f,l);var p=Kr,j=ga;Wi(f.type)&&(Kr=f.stateNode,ga=!1),ei(i,l,f),Du(f.stateNode),Kr=p,ga=j;break;case 5:ws||An(f,l);case 6:if(p=Kr,j=ga,Kr=null,ei(i,l,f),Kr=p,ga=j,Kr!==null)if(ga)try{(Kr.nodeType===9?Kr.body:Kr.nodeName==="HTML"?Kr.ownerDocument.body:Kr).removeChild(f.stateNode)}catch(C){Er(f,l,C)}else try{Kr.removeChild(f.stateNode)}catch(C){Er(f,l,C)}break;case 18:Kr!==null&&(ga?(i=Kr,m2(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,f.stateNode),tc(i)):m2(Kr,f.stateNode));break;case 4:p=Kr,j=ga,Kr=f.stateNode.containerInfo,ga=!0,ei(i,l,f),Kr=p,ga=j;break;case 0:case 11:case 14:case 15:Pi(2,f,l),ws||Pi(4,f,l),ei(i,l,f);break;case 1:ws||(An(f,l),p=f.stateNode,typeof p.componentWillUnmount=="function"&&p_(f,l,p)),ei(i,l,f);break;case 21:ei(i,l,f);break;case 22:ws=(p=ws)||f.memoizedState!==null,ei(i,l,f),ws=p;break;default:ei(i,l,f)}}function S_(i,l){if(l.memoizedState===null&&(i=l.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{tc(i)}catch(f){Er(l,l.return,f)}}}function k_(i,l){if(l.memoizedState===null&&(i=l.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{tc(i)}catch(f){Er(l,l.return,f)}}function PA(i){switch(i.tag){case 31:case 13:case 19:var l=i.stateNode;return l===null&&(l=i.stateNode=new v_),l;case 22:return i=i.stateNode,l=i._retryCache,l===null&&(l=i._retryCache=new v_),l;default:throw Error(s(435,i.tag))}}function Wf(i,l){var f=PA(i);l.forEach(function(p){if(!f.has(p)){f.add(p);var j=VA.bind(null,i,p);p.then(j,j)}})}function ya(i,l){var f=l.deletions;if(f!==null)for(var p=0;p<f.length;p++){var j=f[p],C=i,J=l,pe=J;e:for(;pe!==null;){switch(pe.tag){case 27:if(Wi(pe.type)){Kr=pe.stateNode,ga=!1;break e}break;case 5:Kr=pe.stateNode,ga=!1;break e;case 3:case 4:Kr=pe.stateNode.containerInfo,ga=!0;break e}pe=pe.return}if(Kr===null)throw Error(s(160));__(C,J,j),Kr=null,ga=!1,C=j.alternate,C!==null&&(C.return=null),j.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)N_(l,i),l=l.sibling}var xn=null;function N_(i,l){var f=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ya(l,i),va(i),p&4&&(Pi(3,i,i.return),_u(3,i),Pi(5,i,i.return));break;case 1:ya(l,i),va(i),p&512&&(ws||f===null||An(f,f.return)),p&64&&Qn&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(f=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=f===null?p:f.concat(p))));break;case 26:var j=xn;if(ya(l,i),va(i),p&512&&(ws||f===null||An(f,f.return)),p&4){var C=f!==null?f.memoizedState:null;if(p=i.memoizedState,f===null)if(p===null)if(i.stateNode===null){e:{p=i.type,f=i.memoizedProps,j=j.ownerDocument||j;t:switch(p){case"title":C=j.getElementsByTagName("title")[0],(!C||C[Ve]||C[ye]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=j.createElement(p),j.head.insertBefore(C,j.querySelector("head > title"))),Us(C,p,f),C[ye]=i,Ie(C),p=C;break e;case"link":var J=N2("link","href",j).get(p+(f.href||""));if(J){for(var pe=0;pe<J.length;pe++)if(C=J[pe],C.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&C.getAttribute("rel")===(f.rel==null?null:f.rel)&&C.getAttribute("title")===(f.title==null?null:f.title)&&C.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){J.splice(pe,1);break t}}C=j.createElement(p),Us(C,p,f),j.head.appendChild(C);break;case"meta":if(J=N2("meta","content",j).get(p+(f.content||""))){for(pe=0;pe<J.length;pe++)if(C=J[pe],C.getAttribute("content")===(f.content==null?null:""+f.content)&&C.getAttribute("name")===(f.name==null?null:f.name)&&C.getAttribute("property")===(f.property==null?null:f.property)&&C.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&C.getAttribute("charset")===(f.charSet==null?null:f.charSet)){J.splice(pe,1);break t}}C=j.createElement(p),Us(C,p,f),j.head.appendChild(C);break;default:throw Error(s(468,p))}C[ye]=i,Ie(C),p=C}i.stateNode=p}else E2(j,i.type,i.stateNode);else i.stateNode=k2(j,p,i.memoizedProps);else C!==p?(C===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):C.count--,p===null?E2(j,i.type,i.stateNode):k2(j,p,i.memoizedProps)):p===null&&i.stateNode!==null&&Cp(i,i.memoizedProps,f.memoizedProps)}break;case 27:ya(l,i),va(i),p&512&&(ws||f===null||An(f,f.return)),f!==null&&p&4&&Cp(i,i.memoizedProps,f.memoizedProps);break;case 5:if(ya(l,i),va(i),p&512&&(ws||f===null||An(f,f.return)),i.flags&32){j=i.stateNode;try{kl(j,"")}catch(Dt){Er(i,i.return,Dt)}}p&4&&i.stateNode!=null&&(j=i.memoizedProps,Cp(i,j,f!==null?f.memoizedProps:j)),p&1024&&(Op=!0);break;case 6:if(ya(l,i),va(i),p&4){if(i.stateNode===null)throw Error(s(162));p=i.memoizedProps,f=i.stateNode;try{f.nodeValue=p}catch(Dt){Er(i,i.return,Dt)}}break;case 3:if(oh=null,j=xn,xn=nh(l.containerInfo),ya(l,i),xn=j,va(i),p&4&&f!==null&&f.memoizedState.isDehydrated)try{tc(l.containerInfo)}catch(Dt){Er(i,i.return,Dt)}Op&&(Op=!1,E_(i));break;case 4:p=xn,xn=nh(i.stateNode.containerInfo),ya(l,i),va(i),xn=p;break;case 12:ya(l,i),va(i);break;case 31:ya(l,i),va(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Wf(i,p)));break;case 13:ya(l,i),va(i),i.child.flags&8192&&i.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Vf=Me()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Wf(i,p)));break;case 22:j=i.memoizedState!==null;var Fe=f!==null&&f.memoizedState!==null,Xe=Qn,ot=ws;if(Qn=Xe||j,ws=ot||Fe,ya(l,i),ws=ot,Qn=Xe,va(i),p&8192)e:for(l=i.stateNode,l._visibility=j?l._visibility&-2:l._visibility|1,j&&(f===null||Fe||Qn||ws||Do(i)),f=null,l=i;;){if(l.tag===5||l.tag===26){if(f===null){Fe=f=l;try{if(C=Fe.stateNode,j)J=C.style,typeof J.setProperty=="function"?J.setProperty("display","none","important"):J.display="none";else{pe=Fe.stateNode;var ft=Fe.memoizedProps.style,Ye=ft!=null&&ft.hasOwnProperty("display")?ft.display:null;pe.style.display=Ye==null||typeof Ye=="boolean"?"":(""+Ye).trim()}}catch(Dt){Er(Fe,Fe.return,Dt)}}}else if(l.tag===6){if(f===null){Fe=l;try{Fe.stateNode.nodeValue=j?"":Fe.memoizedProps}catch(Dt){Er(Fe,Fe.return,Dt)}}}else if(l.tag===18){if(f===null){Fe=l;try{var et=Fe.stateNode;j?p2(et,!0):p2(Fe.stateNode,!1)}catch(Dt){Er(Fe,Fe.return,Dt)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===i)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break e;for(;l.sibling===null;){if(l.return===null||l.return===i)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}p&4&&(p=i.updateQueue,p!==null&&(f=p.retryQueue,f!==null&&(p.retryQueue=null,Wf(i,f))));break;case 19:ya(l,i),va(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Wf(i,p)));break;case 30:break;case 21:break;default:ya(l,i),va(i)}}function va(i){var l=i.flags;if(l&2){try{for(var f,p=i.return;p!==null;){if(g_(p)){f=p;break}p=p.return}if(f==null)throw Error(s(160));switch(f.tag){case 27:var j=f.stateNode,C=Rp(i);Hf(i,C,j);break;case 5:var J=f.stateNode;f.flags&32&&(kl(J,""),f.flags&=-33);var pe=Rp(i);Hf(i,pe,J);break;case 3:case 4:var Fe=f.stateNode.containerInfo,Xe=Rp(i);Dp(i,Xe,Fe);break;default:throw Error(s(161))}}catch(ot){Er(i,i.return,ot)}i.flags&=-3}l&4096&&(i.flags&=-4097)}function E_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var l=i;E_(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),i=i.sibling}}function ti(i,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)w_(i,l.alternate,l),l=l.sibling}function Do(i){for(i=i.child;i!==null;){var l=i;switch(l.tag){case 0:case 11:case 14:case 15:Pi(4,l,l.return),Do(l);break;case 1:An(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&p_(l,l.return,f),Do(l);break;case 27:Du(l.stateNode);case 26:case 5:An(l,l.return),Do(l);break;case 22:l.memoizedState===null&&Do(l);break;case 30:Do(l);break;default:Do(l)}i=i.sibling}}function ri(i,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var p=l.alternate,j=i,C=l,J=C.flags;switch(C.tag){case 0:case 11:case 15:ri(j,C,f),_u(4,C);break;case 1:if(ri(j,C,f),p=C,j=p.stateNode,typeof j.componentDidMount=="function")try{j.componentDidMount()}catch(Xe){Er(p,p.return,Xe)}if(p=C,j=p.updateQueue,j!==null){var pe=p.stateNode;try{var Fe=j.shared.hiddenCallbacks;if(Fe!==null)for(j.shared.hiddenCallbacks=null,j=0;j<Fe.length;j++)sb(Fe[j],pe)}catch(Xe){Er(p,p.return,Xe)}}f&&J&64&&m_(C),Su(C,C.return);break;case 27:y_(C);case 26:case 5:ri(j,C,f),f&&p===null&&J&4&&x_(C),Su(C,C.return);break;case 12:ri(j,C,f);break;case 31:ri(j,C,f),f&&J&4&&S_(j,C);break;case 13:ri(j,C,f),f&&J&4&&k_(j,C);break;case 22:C.memoizedState===null&&ri(j,C,f),Su(C,C.return);break;case 30:break;default:ri(j,C,f)}l=l.sibling}}function Fp(i,l){var f=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),i=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(i=l.memoizedState.cachePool.pool),i!==f&&(i!=null&&i.refCount++,f!=null&&cu(f))}function Lp(i,l){i=null,l.alternate!==null&&(i=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==i&&(l.refCount++,i!=null&&cu(i))}function gn(i,l,f,p){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)j_(i,l,f,p),l=l.sibling}function j_(i,l,f,p){var j=l.flags;switch(l.tag){case 0:case 11:case 15:gn(i,l,f,p),j&2048&&_u(9,l);break;case 1:gn(i,l,f,p);break;case 3:gn(i,l,f,p),j&2048&&(i=null,l.alternate!==null&&(i=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==i&&(l.refCount++,i!=null&&cu(i)));break;case 12:if(j&2048){gn(i,l,f,p),i=l.stateNode;try{var C=l.memoizedProps,J=C.id,pe=C.onPostCommit;typeof pe=="function"&&pe(J,l.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Fe){Er(l,l.return,Fe)}}else gn(i,l,f,p);break;case 31:gn(i,l,f,p);break;case 13:gn(i,l,f,p);break;case 23:break;case 22:C=l.stateNode,J=l.alternate,l.memoizedState!==null?C._visibility&2?gn(i,l,f,p):ku(i,l):C._visibility&2?gn(i,l,f,p):(C._visibility|=2,Hl(i,l,f,p,(l.subtreeFlags&10256)!==0||!1)),j&2048&&Fp(J,l);break;case 24:gn(i,l,f,p),j&2048&&Lp(l.alternate,l);break;default:gn(i,l,f,p)}}function Hl(i,l,f,p,j){for(j=j&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var C=i,J=l,pe=f,Fe=p,Xe=J.flags;switch(J.tag){case 0:case 11:case 15:Hl(C,J,pe,Fe,j),_u(8,J);break;case 23:break;case 22:var ot=J.stateNode;J.memoizedState!==null?ot._visibility&2?Hl(C,J,pe,Fe,j):ku(C,J):(ot._visibility|=2,Hl(C,J,pe,Fe,j)),j&&Xe&2048&&Fp(J.alternate,J);break;case 24:Hl(C,J,pe,Fe,j),j&&Xe&2048&&Lp(J.alternate,J);break;default:Hl(C,J,pe,Fe,j)}l=l.sibling}}function ku(i,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=i,p=l,j=p.flags;switch(p.tag){case 22:ku(f,p),j&2048&&Fp(p.alternate,p);break;case 24:ku(f,p),j&2048&&Lp(p.alternate,p);break;default:ku(f,p)}l=l.sibling}}var Nu=8192;function Wl(i,l,f){if(i.subtreeFlags&Nu)for(i=i.child;i!==null;)T_(i,l,f),i=i.sibling}function T_(i,l,f){switch(i.tag){case 26:Wl(i,l,f),i.flags&Nu&&i.memoizedState!==null&&kC(f,xn,i.memoizedState,i.memoizedProps);break;case 5:Wl(i,l,f);break;case 3:case 4:var p=xn;xn=nh(i.stateNode.containerInfo),Wl(i,l,f),xn=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=Nu,Nu=16777216,Wl(i,l,f),Nu=p):Wl(i,l,f));break;default:Wl(i,l,f)}}function A_(i){var l=i.alternate;if(l!==null&&(i=l.child,i!==null)){l.child=null;do l=i.sibling,i.sibling=null,i=l;while(i!==null)}}function Eu(i){var l=i.deletions;if((i.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var p=l[f];Cs=p,R_(p,i)}A_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)C_(i),i=i.sibling}function C_(i){switch(i.tag){case 0:case 11:case 15:Eu(i),i.flags&2048&&Pi(9,i,i.return);break;case 3:Eu(i);break;case 12:Eu(i);break;case 22:var l=i.stateNode;i.memoizedState!==null&&l._visibility&2&&(i.return===null||i.return.tag!==13)?(l._visibility&=-3,Gf(i)):Eu(i);break;default:Eu(i)}}function Gf(i){var l=i.deletions;if((i.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var p=l[f];Cs=p,R_(p,i)}A_(i)}for(i=i.child;i!==null;){switch(l=i,l.tag){case 0:case 11:case 15:Pi(8,l,l.return),Gf(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,Gf(l));break;default:Gf(l)}i=i.sibling}}function R_(i,l){for(;Cs!==null;){var f=Cs;switch(f.tag){case 0:case 11:case 15:Pi(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var p=f.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:cu(f.memoizedState.cache)}if(p=f.child,p!==null)p.return=f,Cs=p;else e:for(f=i;Cs!==null;){p=Cs;var j=p.sibling,C=p.return;if(b_(p),p===f){Cs=null;break e}if(j!==null){j.return=C,Cs=j;break e}Cs=C}}}var BA={getCacheForType:function(i){var l=Ps(gs),f=l.data.get(i);return f===void 0&&(f=i(),l.data.set(i,f)),f},cacheSignal:function(){return Ps(gs).controller.signal}},UA=typeof WeakMap=="function"?WeakMap:Map,Sr=0,Ur=null,ur=null,fr=0,Nr=0,Ra=null,Bi=!1,Gl=!1,Ip=!1,si=0,ts=0,Ui=0,Oo=0,Mp=0,Da=0,Vl=0,ju=null,wa=null,Pp=!1,Vf=0,D_=0,Kf=1/0,Xf=null,zi=null,Es=0,qi=null,Kl=null,ai=0,Bp=0,Up=null,O_=null,Tu=0,zp=null;function Oa(){return(Sr&2)!==0&&fr!==0?fr&-fr:te.T!==null?Vp():fe()}function F_(){if(Da===0)if((fr&536870912)===0||mr){var i=Ee;Ee<<=1,(Ee&3932160)===0&&(Ee=262144),Da=i}else Da=536870912;return i=Aa.current,i!==null&&(i.flags|=32),Da}function ba(i,l,f){(i===Ur&&(Nr===2||Nr===9)||i.cancelPendingCommit!==null)&&(Xl(i,0),$i(i,fr,Da,!1)),Et(i,f),((Sr&2)===0||i!==Ur)&&(i===Ur&&((Sr&2)===0&&(Oo|=f),ts===4&&$i(i,fr,Da,!1)),Cn(i))}function L_(i,l,f){if((Sr&6)!==0)throw Error(s(327));var p=!f&&(l&127)===0&&(l&i.expiredLanes)===0||ve(i,l),j=p?$A(i,l):$p(i,l,!0),C=p;do{if(j===0){Gl&&!p&&$i(i,l,0,!1);break}else{if(f=i.current.alternate,C&&!zA(f)){j=$p(i,l,!1),C=!1;continue}if(j===2){if(C=l,i.errorRecoveryDisabledLanes&C)var J=0;else J=i.pendingLanes&-536870913,J=J!==0?J:J&536870912?536870912:0;if(J!==0){l=J;e:{var pe=i;j=ju;var Fe=pe.current.memoizedState.isDehydrated;if(Fe&&(Xl(pe,J).flags|=256),J=$p(pe,J,!1),J!==2){if(Ip&&!Fe){pe.errorRecoveryDisabledLanes|=C,Oo|=C,j=4;break e}C=wa,wa=j,C!==null&&(wa===null?wa=C:wa.push.apply(wa,C))}j=J}if(C=!1,j!==2)continue}}if(j===1){Xl(i,0),$i(i,l,0,!0);break}e:{switch(p=i,C=j,C){case 0:case 1:throw Error(s(345));case 4:if((l&4194048)!==l)break;case 6:$i(p,l,Da,!Bi);break e;case 2:wa=null;break;case 3:case 5:break;default:throw Error(s(329))}if((l&62914560)===l&&(j=Vf+300-Me(),10<j)){if($i(p,l,Da,!Bi),le(p,0,!0)!==0)break e;ai=l,p.timeoutHandle=f2(I_.bind(null,p,f,wa,Xf,Pp,l,Da,Oo,Vl,Bi,C,"Throttled",-0,0),j);break e}I_(p,f,wa,Xf,Pp,l,Da,Oo,Vl,Bi,C,null,-0,0)}}break}while(!0);Cn(i)}function I_(i,l,f,p,j,C,J,pe,Fe,Xe,ot,ft,Ye,et){if(i.timeoutHandle=-1,ft=l.subtreeFlags,ft&8192||(ft&16785408)===16785408){ft={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:$n},T_(l,C,ft);var Dt=(C&62914560)===C?Vf-Me():(C&4194048)===C?D_-Me():0;if(Dt=NC(ft,Dt),Dt!==null){ai=C,i.cancelPendingCommit=Dt(H_.bind(null,i,l,C,f,p,j,J,pe,Fe,ot,ft,null,Ye,et)),$i(i,C,J,!Xe);return}}H_(i,l,C,f,p,j,J,pe,Fe)}function zA(i){for(var l=i;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var p=0;p<f.length;p++){var j=f[p],C=j.getSnapshot;j=j.value;try{if(!ja(C(),j))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function $i(i,l,f,p){l&=~Mp,l&=~Oo,i.suspendedLanes|=l,i.pingedLanes&=~l,p&&(i.warmLanes|=l),p=i.expirationTimes;for(var j=l;0<j;){var C=31-Le(j),J=1<<C;p[C]=-1,j&=~J}f!==0&&er(i,f,l)}function Yf(){return(Sr&6)===0?(Au(0),!1):!0}function qp(){if(ur!==null){if(Nr===0)var i=ur.return;else i=ur,Vn=ko=null,ap(i),Bl=null,du=0,i=ur;for(;i!==null;)h_(i.alternate,i),i=i.return;ur=null}}function Xl(i,l){var f=i.timeoutHandle;f!==-1&&(i.timeoutHandle=-1,oC(f)),f=i.cancelPendingCommit,f!==null&&(i.cancelPendingCommit=null,f()),ai=0,qp(),Ur=i,ur=f=Wn(i.current,null),fr=l,Nr=0,Ra=null,Bi=!1,Gl=ve(i,l),Ip=!1,Vl=Da=Mp=Oo=Ui=ts=0,wa=ju=null,Pp=!1,(l&8)!==0&&(l|=l&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=l;0<p;){var j=31-Le(p),C=1<<j;l|=i[j],p&=~C}return si=l,gf(),f}function M_(i,l){Zt=null,te.H=vu,l===Pl||l===Nf?(l=Qw(),Nr=3):l===Gm?(l=Qw(),Nr=4):Nr=l===wp?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Ra=l,ur===null&&(ts=1,Bf(i,Xa(l,i.current)))}function P_(){var i=Aa.current;return i===null?!0:(fr&4194048)===fr?Qa===null:(fr&62914560)===fr||(fr&536870912)!==0?i===Qa:!1}function B_(){var i=te.H;return te.H=vu,i===null?vu:i}function U_(){var i=te.A;return te.A=BA,i}function Jf(){ts=4,Bi||(fr&4194048)!==fr&&Aa.current!==null||(Gl=!0),(Ui&134217727)===0&&(Oo&134217727)===0||Ur===null||$i(Ur,fr,Da,!1)}function $p(i,l,f){var p=Sr;Sr|=2;var j=B_(),C=U_();(Ur!==i||fr!==l)&&(Xf=null,Xl(i,l)),l=!1;var J=ts;e:do try{if(Nr!==0&&ur!==null){var pe=ur,Fe=Ra;switch(Nr){case 8:qp(),J=6;break e;case 3:case 2:case 9:case 6:Aa.current===null&&(l=!0);var Xe=Nr;if(Nr=0,Ra=null,Yl(i,pe,Fe,Xe),f&&Gl){J=0;break e}break;default:Xe=Nr,Nr=0,Ra=null,Yl(i,pe,Fe,Xe)}}qA(),J=ts;break}catch(ot){M_(i,ot)}while(!0);return l&&i.shellSuspendCounter++,Vn=ko=null,Sr=p,te.H=j,te.A=C,ur===null&&(Ur=null,fr=0,gf()),J}function qA(){for(;ur!==null;)z_(ur)}function $A(i,l){var f=Sr;Sr|=2;var p=B_(),j=U_();Ur!==i||fr!==l?(Xf=null,Kf=Me()+500,Xl(i,l)):Gl=ve(i,l);e:do try{if(Nr!==0&&ur!==null){l=ur;var C=Ra;t:switch(Nr){case 1:Nr=0,Ra=null,Yl(i,l,C,1);break;case 2:case 9:if(Jw(C)){Nr=0,Ra=null,q_(l);break}l=function(){Nr!==2&&Nr!==9||Ur!==i||(Nr=7),Cn(i)},C.then(l,l);break e;case 3:Nr=7;break e;case 4:Nr=5;break e;case 7:Jw(C)?(Nr=0,Ra=null,q_(l)):(Nr=0,Ra=null,Yl(i,l,C,7));break;case 5:var J=null;switch(ur.tag){case 26:J=ur.memoizedState;case 5:case 27:var pe=ur;if(J?j2(J):pe.stateNode.complete){Nr=0,Ra=null;var Fe=pe.sibling;if(Fe!==null)ur=Fe;else{var Xe=pe.return;Xe!==null?(ur=Xe,Zf(Xe)):ur=null}break t}}Nr=0,Ra=null,Yl(i,l,C,5);break;case 6:Nr=0,Ra=null,Yl(i,l,C,6);break;case 8:qp(),ts=6;break e;default:throw Error(s(462))}}HA();break}catch(ot){M_(i,ot)}while(!0);return Vn=ko=null,te.H=p,te.A=j,Sr=f,ur!==null?0:(Ur=null,fr=0,gf(),ts)}function HA(){for(;ur!==null&&!ne();)z_(ur)}function z_(i){var l=d_(i.alternate,i,si);i.memoizedProps=i.pendingProps,l===null?Zf(i):ur=l}function q_(i){var l=i,f=l.alternate;switch(l.tag){case 15:case 0:l=n_(f,l,l.pendingProps,l.type,void 0,fr);break;case 11:l=n_(f,l,l.pendingProps,l.type.render,l.ref,fr);break;case 5:ap(l);default:h_(f,l),l=ur=Uw(l,si),l=d_(f,l,si)}i.memoizedProps=i.pendingProps,l===null?Zf(i):ur=l}function Yl(i,l,f,p){Vn=ko=null,ap(l),Bl=null,du=0;var j=l.return;try{if(DA(i,j,l,f,fr)){ts=1,Bf(i,Xa(f,i.current)),ur=null;return}}catch(C){if(j!==null)throw ur=j,C;ts=1,Bf(i,Xa(f,i.current)),ur=null;return}l.flags&32768?(mr||p===1?i=!0:Gl||(fr&536870912)!==0?i=!1:(Bi=i=!0,(p===2||p===9||p===3||p===6)&&(p=Aa.current,p!==null&&p.tag===13&&(p.flags|=16384))),$_(l,i)):Zf(l)}function Zf(i){var l=i;do{if((l.flags&32768)!==0){$_(l,Bi);return}i=l.return;var f=LA(l.alternate,l,si);if(f!==null){ur=f;return}if(l=l.sibling,l!==null){ur=l;return}ur=l=i}while(l!==null);ts===0&&(ts=5)}function $_(i,l){do{var f=IA(i.alternate,i);if(f!==null){f.flags&=32767,ur=f;return}if(f=i.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(i=i.sibling,i!==null)){ur=i;return}ur=i=f}while(i!==null);ts=6,ur=null}function H_(i,l,f,p,j,C,J,pe,Fe){i.cancelPendingCommit=null;do Qf();while(Es!==0);if((Sr&6)!==0)throw Error(s(327));if(l!==null){if(l===i.current)throw Error(s(177));if(C=l.lanes|l.childLanes,C|=Rm,Xt(i,f,C,J,pe,Fe),i===Ur&&(ur=Ur=null,fr=0),Kl=l,qi=i,ai=f,Bp=C,Up=j,O_=p,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,KA(We,function(){return X_(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||p){p=te.T,te.T=null,j=Z.p,Z.p=2,J=Sr,Sr|=4;try{MA(i,l,f)}finally{Sr=J,Z.p=j,te.T=p}}Es=1,W_(),G_(),V_()}}function W_(){if(Es===1){Es=0;var i=qi,l=Kl,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=te.T,te.T=null;var p=Z.p;Z.p=2;var j=Sr;Sr|=4;try{N_(l,i);var C=tx,J=Rw(i.containerInfo),pe=C.focusedElem,Fe=C.selectionRange;if(J!==pe&&pe&&pe.ownerDocument&&Cw(pe.ownerDocument.documentElement,pe)){if(Fe!==null&&Em(pe)){var Xe=Fe.start,ot=Fe.end;if(ot===void 0&&(ot=Xe),"selectionStart"in pe)pe.selectionStart=Xe,pe.selectionEnd=Math.min(ot,pe.value.length);else{var ft=pe.ownerDocument||document,Ye=ft&&ft.defaultView||window;if(Ye.getSelection){var et=Ye.getSelection(),Dt=pe.textContent.length,$t=Math.min(Fe.start,Dt),Lr=Fe.end===void 0?$t:Math.min(Fe.end,Dt);!et.extend&&$t>Lr&&(J=Lr,Lr=$t,$t=J);var ze=Aw(pe,$t),Be=Aw(pe,Lr);if(ze&&Be&&(et.rangeCount!==1||et.anchorNode!==ze.node||et.anchorOffset!==ze.offset||et.focusNode!==Be.node||et.focusOffset!==Be.offset)){var Ke=ft.createRange();Ke.setStart(ze.node,ze.offset),et.removeAllRanges(),$t>Lr?(et.addRange(Ke),et.extend(Be.node,Be.offset)):(Ke.setEnd(Be.node,Be.offset),et.addRange(Ke))}}}}for(ft=[],et=pe;et=et.parentNode;)et.nodeType===1&&ft.push({element:et,left:et.scrollLeft,top:et.scrollTop});for(typeof pe.focus=="function"&&pe.focus(),pe=0;pe<ft.length;pe++){var ut=ft[pe];ut.element.scrollLeft=ut.left,ut.element.scrollTop=ut.top}}dh=!!ex,tx=ex=null}finally{Sr=j,Z.p=p,te.T=f}}i.current=l,Es=2}}function G_(){if(Es===2){Es=0;var i=qi,l=Kl,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=te.T,te.T=null;var p=Z.p;Z.p=2;var j=Sr;Sr|=4;try{w_(i,l.alternate,l)}finally{Sr=j,Z.p=p,te.T=f}}Es=3}}function V_(){if(Es===4||Es===3){Es=0,je();var i=qi,l=Kl,f=ai,p=O_;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Es=5:(Es=0,Kl=qi=null,K_(i,i.pendingLanes));var j=i.pendingLanes;if(j===0&&(zi=null),Dr(f),l=l.stateNode,jt&&typeof jt.onCommitFiberRoot=="function")try{jt.onCommitFiberRoot(wt,l,void 0,(l.current.flags&128)===128)}catch{}if(p!==null){l=te.T,j=Z.p,Z.p=2,te.T=null;try{for(var C=i.onRecoverableError,J=0;J<p.length;J++){var pe=p[J];C(pe.value,{componentStack:pe.stack})}}finally{te.T=l,Z.p=j}}(ai&3)!==0&&Qf(),Cn(i),j=i.pendingLanes,(f&261930)!==0&&(j&42)!==0?i===zp?Tu++:(Tu=0,zp=i):Tu=0,Au(0)}}function K_(i,l){(i.pooledCacheLanes&=l)===0&&(l=i.pooledCache,l!=null&&(i.pooledCache=null,cu(l)))}function Qf(){return W_(),G_(),V_(),X_()}function X_(){if(Es!==5)return!1;var i=qi,l=Bp;Bp=0;var f=Dr(ai),p=te.T,j=Z.p;try{Z.p=32>f?32:f,te.T=null,f=Up,Up=null;var C=qi,J=ai;if(Es=0,Kl=qi=null,ai=0,(Sr&6)!==0)throw Error(s(331));var pe=Sr;if(Sr|=4,C_(C.current),j_(C,C.current,J,f),Sr=pe,Au(0,!1),jt&&typeof jt.onPostCommitFiberRoot=="function")try{jt.onPostCommitFiberRoot(wt,C)}catch{}return!0}finally{Z.p=j,te.T=p,K_(i,l)}}function Y_(i,l,f){l=Xa(f,l),l=vp(i.stateNode,l,2),i=Li(i,l,2),i!==null&&(Et(i,2),Cn(i))}function Er(i,l,f){if(i.tag===3)Y_(i,i,f);else for(;l!==null;){if(l.tag===3){Y_(l,i,f);break}else if(l.tag===1){var p=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(zi===null||!zi.has(p))){i=Xa(f,i),f=Jb(2),p=Li(l,f,2),p!==null&&(Zb(f,p,l,i),Et(p,2),Cn(p));break}}l=l.return}}function Hp(i,l,f){var p=i.pingCache;if(p===null){p=i.pingCache=new UA;var j=new Set;p.set(l,j)}else j=p.get(l),j===void 0&&(j=new Set,p.set(l,j));j.has(f)||(Ip=!0,j.add(f),i=WA.bind(null,i,l,f),l.then(i,i))}function WA(i,l,f){var p=i.pingCache;p!==null&&p.delete(l),i.pingedLanes|=i.suspendedLanes&f,i.warmLanes&=~f,Ur===i&&(fr&f)===f&&(ts===4||ts===3&&(fr&62914560)===fr&&300>Me()-Vf?(Sr&2)===0&&Xl(i,0):Mp|=f,Vl===fr&&(Vl=0)),Cn(i)}function J_(i,l){l===0&&(l=qe()),i=bo(i,l),i!==null&&(Et(i,l),Cn(i))}function GA(i){var l=i.memoizedState,f=0;l!==null&&(f=l.retryLane),J_(i,f)}function VA(i,l){var f=0;switch(i.tag){case 31:case 13:var p=i.stateNode,j=i.memoizedState;j!==null&&(f=j.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(s(314))}p!==null&&p.delete(l),J_(i,f)}function KA(i,l){return xe(i,l)}var eh=null,Jl=null,Wp=!1,th=!1,Gp=!1,Hi=0;function Cn(i){i!==Jl&&i.next===null&&(Jl===null?eh=Jl=i:Jl=Jl.next=i),th=!0,Wp||(Wp=!0,YA())}function Au(i,l){if(!Gp&&th){Gp=!0;do for(var f=!1,p=eh;p!==null;){if(i!==0){var j=p.pendingLanes;if(j===0)var C=0;else{var J=p.suspendedLanes,pe=p.pingedLanes;C=(1<<31-Le(42|i)+1)-1,C&=j&~(J&~pe),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(f=!0,t2(p,C))}else C=fr,C=le(p,p===Ur?C:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(C&3)===0||ve(p,C)||(f=!0,t2(p,C));p=p.next}while(f);Gp=!1}}function XA(){Z_()}function Z_(){th=Wp=!1;var i=0;Hi!==0&&iC()&&(i=Hi);for(var l=Me(),f=null,p=eh;p!==null;){var j=p.next,C=Q_(p,l);C===0?(p.next=null,f===null?eh=j:f.next=j,j===null&&(Jl=f)):(f=p,(i!==0||(C&3)!==0)&&(th=!0)),p=j}Es!==0&&Es!==5||Au(i),Hi!==0&&(Hi=0)}function Q_(i,l){for(var f=i.suspendedLanes,p=i.pingedLanes,j=i.expirationTimes,C=i.pendingLanes&-62914561;0<C;){var J=31-Le(C),pe=1<<J,Fe=j[J];Fe===-1?((pe&f)===0||(pe&p)!==0)&&(j[J]=Oe(pe,l)):Fe<=l&&(i.expiredLanes|=pe),C&=~pe}if(l=Ur,f=fr,f=le(i,i===l?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,f===0||i===l&&(Nr===2||Nr===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&be(p),i.callbackNode=null,i.callbackPriority=0;if((f&3)===0||ve(i,f)){if(l=f&-f,l===i.callbackPriority)return l;switch(p!==null&&be(p),Dr(f)){case 2:case 8:f=st;break;case 32:f=We;break;case 268435456:f=Re;break;default:f=We}return p=e2.bind(null,i),f=xe(f,p),i.callbackPriority=l,i.callbackNode=f,l}return p!==null&&p!==null&&be(p),i.callbackPriority=2,i.callbackNode=null,2}function e2(i,l){if(Es!==0&&Es!==5)return i.callbackNode=null,i.callbackPriority=0,null;var f=i.callbackNode;if(Qf()&&i.callbackNode!==f)return null;var p=fr;return p=le(i,i===Ur?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(L_(i,p,l),Q_(i,Me()),i.callbackNode!=null&&i.callbackNode===f?e2.bind(null,i):null)}function t2(i,l){if(Qf())return null;L_(i,l,!0)}function YA(){lC(function(){(Sr&6)!==0?xe(Ce,XA):Z_()})}function Vp(){if(Hi===0){var i=Il;i===0&&(i=Je,Je<<=1,(Je&261888)===0&&(Je=256)),Hi=i}return Hi}function r2(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:cf(""+i)}function s2(i,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,i.id&&f.setAttribute("form",i.id),l.parentNode.insertBefore(f,l),i=new FormData(i),f.parentNode.removeChild(f),i}function JA(i,l,f,p,j){if(l==="submit"&&f&&f.stateNode===j){var C=r2((j[Se]||null).action),J=p.submitter;J&&(l=(l=J[Se]||null)?r2(l.formAction):J.getAttribute("formAction"),l!==null&&(C=l,J=null));var pe=new hf("action","action",null,p,j);i.push({event:pe,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Hi!==0){var Fe=J?s2(j,J):new FormData(j);hp(f,{pending:!0,data:Fe,method:j.method,action:C},null,Fe)}}else typeof C=="function"&&(pe.preventDefault(),Fe=J?s2(j,J):new FormData(j),hp(f,{pending:!0,data:Fe,method:j.method,action:C},C,Fe))},currentTarget:j}]})}}for(var Kp=0;Kp<Cm.length;Kp++){var Xp=Cm[Kp],ZA=Xp.toLowerCase(),QA=Xp[0].toUpperCase()+Xp.slice(1);pn(ZA,"on"+QA)}pn(Fw,"onAnimationEnd"),pn(Lw,"onAnimationIteration"),pn(Iw,"onAnimationStart"),pn("dblclick","onDoubleClick"),pn("focusin","onFocus"),pn("focusout","onBlur"),pn(pA,"onTransitionRun"),pn(xA,"onTransitionStart"),pn(gA,"onTransitionCancel"),pn(Mw,"onTransitionEnd"),Br("onMouseEnter",["mouseout","mouseover"]),Br("onMouseLeave",["mouseout","mouseover"]),Br("onPointerEnter",["pointerout","pointerover"]),Br("onPointerLeave",["pointerout","pointerover"]),qt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),qt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),qt("onBeforeInput",["compositionend","keypress","textInput","paste"]),qt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),qt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),qt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Cu));function a2(i,l){l=(l&4)!==0;for(var f=0;f<i.length;f++){var p=i[f],j=p.event;p=p.listeners;e:{var C=void 0;if(l)for(var J=p.length-1;0<=J;J--){var pe=p[J],Fe=pe.instance,Xe=pe.currentTarget;if(pe=pe.listener,Fe!==C&&j.isPropagationStopped())break e;C=pe,j.currentTarget=Xe;try{C(j)}catch(ot){xf(ot)}j.currentTarget=null,C=Fe}else for(J=0;J<p.length;J++){if(pe=p[J],Fe=pe.instance,Xe=pe.currentTarget,pe=pe.listener,Fe!==C&&j.isPropagationStopped())break e;C=pe,j.currentTarget=Xe;try{C(j)}catch(ot){xf(ot)}j.currentTarget=null,C=Fe}}}}function dr(i,l){var f=l[$e];f===void 0&&(f=l[$e]=new Set);var p=i+"__bubble";f.has(p)||(n2(l,i,2,!1),f.add(p))}function Yp(i,l,f){var p=0;l&&(p|=4),n2(f,i,p,l)}var rh="_reactListening"+Math.random().toString(36).slice(2);function Jp(i){if(!i[rh]){i[rh]=!0,_t.forEach(function(f){f!=="selectionchange"&&(eC.has(f)||Yp(f,!1,i),Yp(f,!0,i))});var l=i.nodeType===9?i:i.ownerDocument;l===null||l[rh]||(l[rh]=!0,Yp("selectionchange",!1,l))}}function n2(i,l,f,p){switch(F2(l)){case 2:var j=TC;break;case 8:j=AC;break;default:j=fx}f=j.bind(null,l,f,i),j=void 0,!gm||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(j=!0),p?j!==void 0?i.addEventListener(l,f,{capture:!0,passive:j}):i.addEventListener(l,f,!0):j!==void 0?i.addEventListener(l,f,{passive:j}):i.addEventListener(l,f,!1)}function Zp(i,l,f,p,j){var C=p;if((l&1)===0&&(l&2)===0&&p!==null)e:for(;;){if(p===null)return;var J=p.tag;if(J===3||J===4){var pe=p.stateNode.containerInfo;if(pe===j)break;if(J===4)for(J=p.return;J!==null;){var Fe=J.tag;if((Fe===3||Fe===4)&&J.stateNode.containerInfo===j)return;J=J.return}for(;pe!==null;){if(J=vt(pe),J===null)return;if(Fe=J.tag,Fe===5||Fe===6||Fe===26||Fe===27){p=C=J;continue e}pe=pe.parentNode}}p=p.return}uw(function(){var Xe=C,ot=pm(f),ft=[];e:{var Ye=Pw.get(i);if(Ye!==void 0){var et=hf,Dt=i;switch(i){case"keypress":if(df(f)===0)break e;case"keydown":case"keyup":et=V5;break;case"focusin":Dt="focus",et=bm;break;case"focusout":Dt="blur",et=bm;break;case"beforeblur":case"afterblur":et=bm;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":et=hw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":et=L5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":et=Y5;break;case Fw:case Lw:case Iw:et=P5;break;case Mw:et=Z5;break;case"scroll":case"scrollend":et=O5;break;case"wheel":et=eA;break;case"copy":case"cut":case"paste":et=U5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":et=pw;break;case"toggle":case"beforetoggle":et=rA}var $t=(l&4)!==0,Lr=!$t&&(i==="scroll"||i==="scrollend"),ze=$t?Ye!==null?Ye+"Capture":null:Ye;$t=[];for(var Be=Xe,Ke;Be!==null;){var ut=Be;if(Ke=ut.stateNode,ut=ut.tag,ut!==5&&ut!==26&&ut!==27||Ke===null||ze===null||(ut=Zc(Be,ze),ut!=null&&$t.push(Ru(Be,ut,Ke))),Lr)break;Be=Be.return}0<$t.length&&(Ye=new et(Ye,Dt,null,f,ot),ft.push({event:Ye,listeners:$t}))}}if((l&7)===0){e:{if(Ye=i==="mouseover"||i==="pointerover",et=i==="mouseout"||i==="pointerout",Ye&&f!==mm&&(Dt=f.relatedTarget||f.fromElement)&&(vt(Dt)||Dt[ke]))break e;if((et||Ye)&&(Ye=ot.window===ot?ot:(Ye=ot.ownerDocument)?Ye.defaultView||Ye.parentWindow:window,et?(Dt=f.relatedTarget||f.toElement,et=Xe,Dt=Dt?vt(Dt):null,Dt!==null&&(Lr=o(Dt),$t=Dt.tag,Dt!==Lr||$t!==5&&$t!==27&&$t!==6)&&(Dt=null)):(et=null,Dt=Xe),et!==Dt)){if($t=hw,ut="onMouseLeave",ze="onMouseEnter",Be="mouse",(i==="pointerout"||i==="pointerover")&&($t=pw,ut="onPointerLeave",ze="onPointerEnter",Be="pointer"),Lr=et==null?Ye:gt(et),Ke=Dt==null?Ye:gt(Dt),Ye=new $t(ut,Be+"leave",et,f,ot),Ye.target=Lr,Ye.relatedTarget=Ke,ut=null,vt(ot)===Xe&&($t=new $t(ze,Be+"enter",Dt,f,ot),$t.target=Ke,$t.relatedTarget=Lr,ut=$t),Lr=ut,et&&Dt)t:{for($t=tC,ze=et,Be=Dt,Ke=0,ut=ze;ut;ut=$t(ut))Ke++;ut=0;for(var Bt=Be;Bt;Bt=$t(Bt))ut++;for(;0<Ke-ut;)ze=$t(ze),Ke--;for(;0<ut-Ke;)Be=$t(Be),ut--;for(;Ke--;){if(ze===Be||Be!==null&&ze===Be.alternate){$t=ze;break t}ze=$t(ze),Be=$t(Be)}$t=null}else $t=null;et!==null&&i2(ft,Ye,et,$t,!1),Dt!==null&&Lr!==null&&i2(ft,Lr,Dt,$t,!0)}}e:{if(Ye=Xe?gt(Xe):window,et=Ye.nodeName&&Ye.nodeName.toLowerCase(),et==="select"||et==="input"&&Ye.type==="file")var wr=Sw;else if(bw(Ye))if(kw)wr=fA;else{wr=uA;var It=cA}else et=Ye.nodeName,!et||et.toLowerCase()!=="input"||Ye.type!=="checkbox"&&Ye.type!=="radio"?Xe&&hm(Xe.elementType)&&(wr=Sw):wr=dA;if(wr&&(wr=wr(i,Xe))){_w(ft,wr,f,ot);break e}It&&It(i,Ye,Xe),i==="focusout"&&Xe&&Ye.type==="number"&&Xe.memoizedProps.value!=null&&fm(Ye,"number",Ye.value)}switch(It=Xe?gt(Xe):window,i){case"focusin":(bw(It)||It.contentEditable==="true")&&(Tl=It,jm=Xe,iu=null);break;case"focusout":iu=jm=Tl=null;break;case"mousedown":Tm=!0;break;case"contextmenu":case"mouseup":case"dragend":Tm=!1,Dw(ft,f,ot);break;case"selectionchange":if(mA)break;case"keydown":case"keyup":Dw(ft,f,ot)}var tr;if(Sm)e:{switch(i){case"compositionstart":var hr="onCompositionStart";break e;case"compositionend":hr="onCompositionEnd";break e;case"compositionupdate":hr="onCompositionUpdate";break e}hr=void 0}else jl?vw(i,f)&&(hr="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(hr="onCompositionStart");hr&&(xw&&f.locale!=="ko"&&(jl||hr!=="onCompositionStart"?hr==="onCompositionEnd"&&jl&&(tr=dw()):(Ti=ot,ym="value"in Ti?Ti.value:Ti.textContent,jl=!0)),It=sh(Xe,hr),0<It.length&&(hr=new mw(hr,i,null,f,ot),ft.push({event:hr,listeners:It}),tr?hr.data=tr:(tr=ww(f),tr!==null&&(hr.data=tr)))),(tr=aA?nA(i,f):iA(i,f))&&(hr=sh(Xe,"onBeforeInput"),0<hr.length&&(It=new mw("onBeforeInput","beforeinput",null,f,ot),ft.push({event:It,listeners:hr}),It.data=tr)),JA(ft,i,Xe,f,ot)}a2(ft,l)})}function Ru(i,l,f){return{instance:i,listener:l,currentTarget:f}}function sh(i,l){for(var f=l+"Capture",p=[];i!==null;){var j=i,C=j.stateNode;if(j=j.tag,j!==5&&j!==26&&j!==27||C===null||(j=Zc(i,f),j!=null&&p.unshift(Ru(i,j,C)),j=Zc(i,l),j!=null&&p.push(Ru(i,j,C))),i.tag===3)return p;i=i.return}return[]}function tC(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function i2(i,l,f,p,j){for(var C=l._reactName,J=[];f!==null&&f!==p;){var pe=f,Fe=pe.alternate,Xe=pe.stateNode;if(pe=pe.tag,Fe!==null&&Fe===p)break;pe!==5&&pe!==26&&pe!==27||Xe===null||(Fe=Xe,j?(Xe=Zc(f,C),Xe!=null&&J.unshift(Ru(f,Xe,Fe))):j||(Xe=Zc(f,C),Xe!=null&&J.push(Ru(f,Xe,Fe)))),f=f.return}J.length!==0&&i.push({event:l,listeners:J})}var rC=/\r\n?/g,sC=/\u0000|\uFFFD/g;function o2(i){return(typeof i=="string"?i:""+i).replace(rC,`
`).replace(sC,"")}function l2(i,l){return l=o2(l),o2(i)===l}function Fr(i,l,f,p,j,C){switch(f){case"children":typeof p=="string"?l==="body"||l==="textarea"&&p===""||kl(i,p):(typeof p=="number"||typeof p=="bigint")&&l!=="body"&&kl(i,""+p);break;case"className":Wa(i,"class",p);break;case"tabIndex":Wa(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Wa(i,f,p);break;case"style":lw(i,p,C);break;case"data":if(l!=="object"){Wa(i,"data",p);break}case"src":case"href":if(p===""&&(l!=="a"||f!=="href")){i.removeAttribute(f);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=cf(""+p),i.setAttribute(f,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(f==="formAction"?(l!=="input"&&Fr(i,l,"name",j.name,j,null),Fr(i,l,"formEncType",j.formEncType,j,null),Fr(i,l,"formMethod",j.formMethod,j,null),Fr(i,l,"formTarget",j.formTarget,j,null)):(Fr(i,l,"encType",j.encType,j,null),Fr(i,l,"method",j.method,j,null),Fr(i,l,"target",j.target,j,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(f);break}p=cf(""+p),i.setAttribute(f,p);break;case"onClick":p!=null&&(i.onclick=$n);break;case"onScroll":p!=null&&dr("scroll",i);break;case"onScrollEnd":p!=null&&dr("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(s(61));if(f=p.__html,f!=null){if(j.children!=null)throw Error(s(60));i.innerHTML=f}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}f=cf(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""+p):i.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,""):i.removeAttribute(f);break;case"capture":case"download":p===!0?i.setAttribute(f,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(f,p):i.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(f,p):i.removeAttribute(f);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(f):i.setAttribute(f,p);break;case"popover":dr("beforetoggle",i),dr("toggle",i),Ys(i,"popover",p);break;case"xlinkActuate":qn(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":qn(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":qn(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":qn(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":qn(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":qn(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":qn(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":qn(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":qn(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Ys(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=R5.get(f)||f,Ys(i,f,p))}}function Qp(i,l,f,p,j,C){switch(f){case"style":lw(i,p,C);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(s(61));if(f=p.__html,f!=null){if(j.children!=null)throw Error(s(60));i.innerHTML=f}}break;case"children":typeof p=="string"?kl(i,p):(typeof p=="number"||typeof p=="bigint")&&kl(i,""+p);break;case"onScroll":p!=null&&dr("scroll",i);break;case"onScrollEnd":p!=null&&dr("scrollend",i);break;case"onClick":p!=null&&(i.onclick=$n);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!bt.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(j=f.endsWith("Capture"),l=f.slice(2,j?f.length-7:void 0),C=i[Se]||null,C=C!=null?C[f]:null,typeof C=="function"&&i.removeEventListener(l,C,j),typeof p=="function")){typeof C!="function"&&C!==null&&(f in i?i[f]=null:i.hasAttribute(f)&&i.removeAttribute(f)),i.addEventListener(l,p,j);break e}f in i?i[f]=p:p===!0?i.setAttribute(f,""):Ys(i,f,p)}}}function Us(i,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":dr("error",i),dr("load",i);var p=!1,j=!1,C;for(C in f)if(f.hasOwnProperty(C)){var J=f[C];if(J!=null)switch(C){case"src":p=!0;break;case"srcSet":j=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,l));default:Fr(i,l,C,J,f,null)}}j&&Fr(i,l,"srcSet",f.srcSet,f,null),p&&Fr(i,l,"src",f.src,f,null);return;case"input":dr("invalid",i);var pe=C=J=j=null,Fe=null,Xe=null;for(p in f)if(f.hasOwnProperty(p)){var ot=f[p];if(ot!=null)switch(p){case"name":j=ot;break;case"type":J=ot;break;case"checked":Fe=ot;break;case"defaultChecked":Xe=ot;break;case"value":C=ot;break;case"defaultValue":pe=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(s(137,l));break;default:Fr(i,l,p,ot,f,null)}}aw(i,C,pe,Fe,Xe,J,j,!1);return;case"select":dr("invalid",i),p=J=C=null;for(j in f)if(f.hasOwnProperty(j)&&(pe=f[j],pe!=null))switch(j){case"value":C=pe;break;case"defaultValue":J=pe;break;case"multiple":p=pe;default:Fr(i,l,j,pe,f,null)}l=C,f=J,i.multiple=!!p,l!=null?Sl(i,!!p,l,!1):f!=null&&Sl(i,!!p,f,!0);return;case"textarea":dr("invalid",i),C=j=p=null;for(J in f)if(f.hasOwnProperty(J)&&(pe=f[J],pe!=null))switch(J){case"value":p=pe;break;case"defaultValue":j=pe;break;case"children":C=pe;break;case"dangerouslySetInnerHTML":if(pe!=null)throw Error(s(91));break;default:Fr(i,l,J,pe,f,null)}iw(i,p,j,C);return;case"option":for(Fe in f)f.hasOwnProperty(Fe)&&(p=f[Fe],p!=null)&&(Fe==="selected"?i.selected=p&&typeof p!="function"&&typeof p!="symbol":Fr(i,l,Fe,p,f,null));return;case"dialog":dr("beforetoggle",i),dr("toggle",i),dr("cancel",i),dr("close",i);break;case"iframe":case"object":dr("load",i);break;case"video":case"audio":for(p=0;p<Cu.length;p++)dr(Cu[p],i);break;case"image":dr("error",i),dr("load",i);break;case"details":dr("toggle",i);break;case"embed":case"source":case"link":dr("error",i),dr("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Xe in f)if(f.hasOwnProperty(Xe)&&(p=f[Xe],p!=null))switch(Xe){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,l));default:Fr(i,l,Xe,p,f,null)}return;default:if(hm(l)){for(ot in f)f.hasOwnProperty(ot)&&(p=f[ot],p!==void 0&&Qp(i,l,ot,p,f,void 0));return}}for(pe in f)f.hasOwnProperty(pe)&&(p=f[pe],p!=null&&Fr(i,l,pe,p,f,null))}function aC(i,l,f,p){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var j=null,C=null,J=null,pe=null,Fe=null,Xe=null,ot=null;for(et in f){var ft=f[et];if(f.hasOwnProperty(et)&&ft!=null)switch(et){case"checked":break;case"value":break;case"defaultValue":Fe=ft;default:p.hasOwnProperty(et)||Fr(i,l,et,null,p,ft)}}for(var Ye in p){var et=p[Ye];if(ft=f[Ye],p.hasOwnProperty(Ye)&&(et!=null||ft!=null))switch(Ye){case"type":C=et;break;case"name":j=et;break;case"checked":Xe=et;break;case"defaultChecked":ot=et;break;case"value":J=et;break;case"defaultValue":pe=et;break;case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(s(137,l));break;default:et!==ft&&Fr(i,l,Ye,et,p,ft)}}dm(i,J,pe,Fe,Xe,ot,C,j);return;case"select":et=J=pe=Ye=null;for(C in f)if(Fe=f[C],f.hasOwnProperty(C)&&Fe!=null)switch(C){case"value":break;case"multiple":et=Fe;default:p.hasOwnProperty(C)||Fr(i,l,C,null,p,Fe)}for(j in p)if(C=p[j],Fe=f[j],p.hasOwnProperty(j)&&(C!=null||Fe!=null))switch(j){case"value":Ye=C;break;case"defaultValue":pe=C;break;case"multiple":J=C;default:C!==Fe&&Fr(i,l,j,C,p,Fe)}l=pe,f=J,p=et,Ye!=null?Sl(i,!!f,Ye,!1):!!p!=!!f&&(l!=null?Sl(i,!!f,l,!0):Sl(i,!!f,f?[]:"",!1));return;case"textarea":et=Ye=null;for(pe in f)if(j=f[pe],f.hasOwnProperty(pe)&&j!=null&&!p.hasOwnProperty(pe))switch(pe){case"value":break;case"children":break;default:Fr(i,l,pe,null,p,j)}for(J in p)if(j=p[J],C=f[J],p.hasOwnProperty(J)&&(j!=null||C!=null))switch(J){case"value":Ye=j;break;case"defaultValue":et=j;break;case"children":break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(91));break;default:j!==C&&Fr(i,l,J,j,p,C)}nw(i,Ye,et);return;case"option":for(var Dt in f)Ye=f[Dt],f.hasOwnProperty(Dt)&&Ye!=null&&!p.hasOwnProperty(Dt)&&(Dt==="selected"?i.selected=!1:Fr(i,l,Dt,null,p,Ye));for(Fe in p)Ye=p[Fe],et=f[Fe],p.hasOwnProperty(Fe)&&Ye!==et&&(Ye!=null||et!=null)&&(Fe==="selected"?i.selected=Ye&&typeof Ye!="function"&&typeof Ye!="symbol":Fr(i,l,Fe,Ye,p,et));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $t in f)Ye=f[$t],f.hasOwnProperty($t)&&Ye!=null&&!p.hasOwnProperty($t)&&Fr(i,l,$t,null,p,Ye);for(Xe in p)if(Ye=p[Xe],et=f[Xe],p.hasOwnProperty(Xe)&&Ye!==et&&(Ye!=null||et!=null))switch(Xe){case"children":case"dangerouslySetInnerHTML":if(Ye!=null)throw Error(s(137,l));break;default:Fr(i,l,Xe,Ye,p,et)}return;default:if(hm(l)){for(var Lr in f)Ye=f[Lr],f.hasOwnProperty(Lr)&&Ye!==void 0&&!p.hasOwnProperty(Lr)&&Qp(i,l,Lr,void 0,p,Ye);for(ot in p)Ye=p[ot],et=f[ot],!p.hasOwnProperty(ot)||Ye===et||Ye===void 0&&et===void 0||Qp(i,l,ot,Ye,p,et);return}}for(var ze in f)Ye=f[ze],f.hasOwnProperty(ze)&&Ye!=null&&!p.hasOwnProperty(ze)&&Fr(i,l,ze,null,p,Ye);for(ft in p)Ye=p[ft],et=f[ft],!p.hasOwnProperty(ft)||Ye===et||Ye==null&&et==null||Fr(i,l,ft,Ye,p,et)}function c2(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function nC(){if(typeof performance.getEntriesByType=="function"){for(var i=0,l=0,f=performance.getEntriesByType("resource"),p=0;p<f.length;p++){var j=f[p],C=j.transferSize,J=j.initiatorType,pe=j.duration;if(C&&pe&&c2(J)){for(J=0,pe=j.responseEnd,p+=1;p<f.length;p++){var Fe=f[p],Xe=Fe.startTime;if(Xe>pe)break;var ot=Fe.transferSize,ft=Fe.initiatorType;ot&&c2(ft)&&(Fe=Fe.responseEnd,J+=ot*(Fe<pe?1:(pe-Xe)/(Fe-Xe)))}if(--p,l+=8*(C+J)/(j.duration/1e3),i++,10<i)break}}if(0<i)return l/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var ex=null,tx=null;function ah(i){return i.nodeType===9?i:i.ownerDocument}function u2(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function d2(i,l){if(i===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&l==="foreignObject"?0:i}function rx(i,l){return i==="textarea"||i==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var sx=null;function iC(){var i=window.event;return i&&i.type==="popstate"?i===sx?!1:(sx=i,!0):(sx=null,!1)}var f2=typeof setTimeout=="function"?setTimeout:void 0,oC=typeof clearTimeout=="function"?clearTimeout:void 0,h2=typeof Promise=="function"?Promise:void 0,lC=typeof queueMicrotask=="function"?queueMicrotask:typeof h2<"u"?function(i){return h2.resolve(null).then(i).catch(cC)}:f2;function cC(i){setTimeout(function(){throw i})}function Wi(i){return i==="head"}function m2(i,l){var f=l,p=0;do{var j=f.nextSibling;if(i.removeChild(f),j&&j.nodeType===8)if(f=j.data,f==="/$"||f==="/&"){if(p===0){i.removeChild(j),tc(l);return}p--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")p++;else if(f==="html")Du(i.ownerDocument.documentElement);else if(f==="head"){f=i.ownerDocument.head,Du(f);for(var C=f.firstChild;C;){var J=C.nextSibling,pe=C.nodeName;C[Ve]||pe==="SCRIPT"||pe==="STYLE"||pe==="LINK"&&C.rel.toLowerCase()==="stylesheet"||f.removeChild(C),C=J}}else f==="body"&&Du(i.ownerDocument.body);f=j}while(f);tc(l)}function p2(i,l){var f=i;i=0;do{var p=f.nextSibling;if(f.nodeType===1?l?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(l?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),p&&p.nodeType===8)if(f=p.data,f==="/$"){if(i===0)break;i--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||i++;f=p}while(f)}function ax(i){var l=i.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":ax(f),ht(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}i.removeChild(f)}}function uC(i,l,f,p){for(;i.nodeType===1;){var j=f;if(i.nodeName.toLowerCase()!==l.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Ve])switch(l){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(C=i.getAttribute("rel"),C==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(C!==j.rel||i.getAttribute("href")!==(j.href==null||j.href===""?null:j.href)||i.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin)||i.getAttribute("title")!==(j.title==null?null:j.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(C=i.getAttribute("src"),(C!==(j.src==null?null:j.src)||i.getAttribute("type")!==(j.type==null?null:j.type)||i.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin))&&C&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(l==="input"&&i.type==="hidden"){var C=j.name==null?null:""+j.name;if(j.type==="hidden"&&i.getAttribute("name")===C)return i}else return i;if(i=en(i.nextSibling),i===null)break}return null}function dC(i,l,f){if(l==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!f||(i=en(i.nextSibling),i===null))return null;return i}function x2(i,l){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=en(i.nextSibling),i===null))return null;return i}function nx(i){return i.data==="$?"||i.data==="$~"}function ix(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function fC(i,l){var f=i.ownerDocument;if(i.data==="$~")i._reactRetry=l;else if(i.data!=="$?"||f.readyState!=="loading")l();else{var p=function(){l(),f.removeEventListener("DOMContentLoaded",p)};f.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function en(i){for(;i!=null;i=i.nextSibling){var l=i.nodeType;if(l===1||l===3)break;if(l===8){if(l=i.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return i}var ox=null;function g2(i){i=i.nextSibling;for(var l=0;i;){if(i.nodeType===8){var f=i.data;if(f==="/$"||f==="/&"){if(l===0)return en(i.nextSibling);l--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||l++}i=i.nextSibling}return null}function y2(i){i=i.previousSibling;for(var l=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(l===0)return i;l--}else f!=="/$"&&f!=="/&"||l++}i=i.previousSibling}return null}function v2(i,l,f){switch(l=ah(f),i){case"html":if(i=l.documentElement,!i)throw Error(s(452));return i;case"head":if(i=l.head,!i)throw Error(s(453));return i;case"body":if(i=l.body,!i)throw Error(s(454));return i;default:throw Error(s(451))}}function Du(i){for(var l=i.attributes;l.length;)i.removeAttributeNode(l[0]);ht(i)}var tn=new Map,w2=new Set;function nh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var ni=Z.d;Z.d={f:hC,r:mC,D:pC,C:xC,L:gC,m:yC,X:wC,S:vC,M:bC};function hC(){var i=ni.f(),l=Yf();return i||l}function mC(i){var l=Nt(i);l!==null&&l.tag===5&&l.type==="form"?Mb(l):ni.r(i)}var Zl=typeof document>"u"?null:document;function b2(i,l,f){var p=Zl;if(p&&typeof l=="string"&&l){var j=Va(l);j='link[rel="'+i+'"][href="'+j+'"]',typeof f=="string"&&(j+='[crossorigin="'+f+'"]'),w2.has(j)||(w2.add(j),i={rel:i,crossOrigin:f,href:l},p.querySelector(j)===null&&(l=p.createElement("link"),Us(l,"link",i),Ie(l),p.head.appendChild(l)))}}function pC(i){ni.D(i),b2("dns-prefetch",i,null)}function xC(i,l){ni.C(i,l),b2("preconnect",i,l)}function gC(i,l,f){ni.L(i,l,f);var p=Zl;if(p&&i&&l){var j='link[rel="preload"][as="'+Va(l)+'"]';l==="image"&&f&&f.imageSrcSet?(j+='[imagesrcset="'+Va(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(j+='[imagesizes="'+Va(f.imageSizes)+'"]')):j+='[href="'+Va(i)+'"]';var C=j;switch(l){case"style":C=Ql(i);break;case"script":C=ec(i)}tn.has(C)||(i=x({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:i,as:l},f),tn.set(C,i),p.querySelector(j)!==null||l==="style"&&p.querySelector(Ou(C))||l==="script"&&p.querySelector(Fu(C))||(l=p.createElement("link"),Us(l,"link",i),Ie(l),p.head.appendChild(l)))}}function yC(i,l){ni.m(i,l);var f=Zl;if(f&&i){var p=l&&typeof l.as=="string"?l.as:"script",j='link[rel="modulepreload"][as="'+Va(p)+'"][href="'+Va(i)+'"]',C=j;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=ec(i)}if(!tn.has(C)&&(i=x({rel:"modulepreload",href:i},l),tn.set(C,i),f.querySelector(j)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Fu(C)))return}p=f.createElement("link"),Us(p,"link",i),Ie(p),f.head.appendChild(p)}}}function vC(i,l,f){ni.S(i,l,f);var p=Zl;if(p&&i){var j=me(p).hoistableStyles,C=Ql(i);l=l||"default";var J=j.get(C);if(!J){var pe={loading:0,preload:null};if(J=p.querySelector(Ou(C)))pe.loading=5;else{i=x({rel:"stylesheet",href:i,"data-precedence":l},f),(f=tn.get(C))&&lx(i,f);var Fe=J=p.createElement("link");Ie(Fe),Us(Fe,"link",i),Fe._p=new Promise(function(Xe,ot){Fe.onload=Xe,Fe.onerror=ot}),Fe.addEventListener("load",function(){pe.loading|=1}),Fe.addEventListener("error",function(){pe.loading|=2}),pe.loading|=4,ih(J,l,p)}J={type:"stylesheet",instance:J,count:1,state:pe},j.set(C,J)}}}function wC(i,l){ni.X(i,l);var f=Zl;if(f&&i){var p=me(f).hoistableScripts,j=ec(i),C=p.get(j);C||(C=f.querySelector(Fu(j)),C||(i=x({src:i,async:!0},l),(l=tn.get(j))&&cx(i,l),C=f.createElement("script"),Ie(C),Us(C,"link",i),f.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(j,C))}}function bC(i,l){ni.M(i,l);var f=Zl;if(f&&i){var p=me(f).hoistableScripts,j=ec(i),C=p.get(j);C||(C=f.querySelector(Fu(j)),C||(i=x({src:i,async:!0,type:"module"},l),(l=tn.get(j))&&cx(i,l),C=f.createElement("script"),Ie(C),Us(C,"link",i),f.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(j,C))}}function _2(i,l,f,p){var j=(j=ie.current)?nh(j):null;if(!j)throw Error(s(446));switch(i){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=Ql(f.href),f=me(j).hoistableStyles,p=f.get(l),p||(p={type:"style",instance:null,count:0,state:null},f.set(l,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){i=Ql(f.href);var C=me(j).hoistableStyles,J=C.get(i);if(J||(j=j.ownerDocument||j,J={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(i,J),(C=j.querySelector(Ou(i)))&&!C._p&&(J.instance=C,J.state.loading=5),tn.has(i)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},tn.set(i,f),C||_C(j,i,f,J.state))),l&&p===null)throw Error(s(528,""));return J}if(l&&p!==null)throw Error(s(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=ec(f),f=me(j).hoistableScripts,p=f.get(l),p||(p={type:"script",instance:null,count:0,state:null},f.set(l,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,i))}}function Ql(i){return'href="'+Va(i)+'"'}function Ou(i){return'link[rel="stylesheet"]['+i+"]"}function S2(i){return x({},i,{"data-precedence":i.precedence,precedence:null})}function _C(i,l,f,p){i.querySelector('link[rel="preload"][as="style"]['+l+"]")?p.loading=1:(l=i.createElement("link"),p.preload=l,l.addEventListener("load",function(){return p.loading|=1}),l.addEventListener("error",function(){return p.loading|=2}),Us(l,"link",f),Ie(l),i.head.appendChild(l))}function ec(i){return'[src="'+Va(i)+'"]'}function Fu(i){return"script[async]"+i}function k2(i,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var p=i.querySelector('style[data-href~="'+Va(f.href)+'"]');if(p)return l.instance=p,Ie(p),p;var j=x({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Ie(p),Us(p,"style",j),ih(p,f.precedence,i),l.instance=p;case"stylesheet":j=Ql(f.href);var C=i.querySelector(Ou(j));if(C)return l.state.loading|=4,l.instance=C,Ie(C),C;p=S2(f),(j=tn.get(j))&&lx(p,j),C=(i.ownerDocument||i).createElement("link"),Ie(C);var J=C;return J._p=new Promise(function(pe,Fe){J.onload=pe,J.onerror=Fe}),Us(C,"link",p),l.state.loading|=4,ih(C,f.precedence,i),l.instance=C;case"script":return C=ec(f.src),(j=i.querySelector(Fu(C)))?(l.instance=j,Ie(j),j):(p=f,(j=tn.get(C))&&(p=x({},f),cx(p,j)),i=i.ownerDocument||i,j=i.createElement("script"),Ie(j),Us(j,"link",p),i.head.appendChild(j),l.instance=j);case"void":return null;default:throw Error(s(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(p=l.instance,l.state.loading|=4,ih(p,f.precedence,i));return l.instance}function ih(i,l,f){for(var p=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),j=p.length?p[p.length-1]:null,C=j,J=0;J<p.length;J++){var pe=p[J];if(pe.dataset.precedence===l)C=pe;else if(C!==j)break}C?C.parentNode.insertBefore(i,C.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(i,l.firstChild))}function lx(i,l){i.crossOrigin==null&&(i.crossOrigin=l.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=l.referrerPolicy),i.title==null&&(i.title=l.title)}function cx(i,l){i.crossOrigin==null&&(i.crossOrigin=l.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=l.referrerPolicy),i.integrity==null&&(i.integrity=l.integrity)}var oh=null;function N2(i,l,f){if(oh===null){var p=new Map,j=oh=new Map;j.set(f,p)}else j=oh,p=j.get(f),p||(p=new Map,j.set(f,p));if(p.has(i))return p;for(p.set(i,null),f=f.getElementsByTagName(i),j=0;j<f.length;j++){var C=f[j];if(!(C[Ve]||C[ye]||i==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var J=C.getAttribute(l)||"";J=i+J;var pe=p.get(J);pe?pe.push(C):p.set(J,[C])}}return p}function E2(i,l,f){i=i.ownerDocument||i,i.head.insertBefore(f,l==="title"?i.querySelector("head > title"):null)}function SC(i,l,f){if(f===1||l.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(i=l.disabled,typeof l.precedence=="string"&&i==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function j2(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function kC(i,l,f,p){if(f.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var j=Ql(p.href),C=l.querySelector(Ou(j));if(C){l=C._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(i.count++,i=lh.bind(i),l.then(i,i)),f.state.loading|=4,f.instance=C,Ie(C);return}C=l.ownerDocument||l,p=S2(p),(j=tn.get(j))&&lx(p,j),C=C.createElement("link"),Ie(C);var J=C;J._p=new Promise(function(pe,Fe){J.onload=pe,J.onerror=Fe}),Us(C,"link",p),f.instance=C}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(f,l),(l=f.state.preload)&&(f.state.loading&3)===0&&(i.count++,f=lh.bind(i),l.addEventListener("load",f),l.addEventListener("error",f))}}var ux=0;function NC(i,l){return i.stylesheets&&i.count===0&&uh(i,i.stylesheets),0<i.count||0<i.imgCount?function(f){var p=setTimeout(function(){if(i.stylesheets&&uh(i,i.stylesheets),i.unsuspend){var C=i.unsuspend;i.unsuspend=null,C()}},6e4+l);0<i.imgBytes&&ux===0&&(ux=62500*nC());var j=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&uh(i,i.stylesheets),i.unsuspend)){var C=i.unsuspend;i.unsuspend=null,C()}},(i.imgBytes>ux?50:800)+l);return i.unsuspend=f,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(j)}}:null}function lh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)uh(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var ch=null;function uh(i,l){i.stylesheets=null,i.unsuspend!==null&&(i.count++,ch=new Map,l.forEach(EC,i),ch=null,lh.call(i))}function EC(i,l){if(!(l.state.loading&4)){var f=ch.get(i);if(f)var p=f.get(null);else{f=new Map,ch.set(i,f);for(var j=i.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<j.length;C++){var J=j[C];(J.nodeName==="LINK"||J.getAttribute("media")!=="not all")&&(f.set(J.dataset.precedence,J),p=J)}p&&f.set(null,p)}j=l.instance,J=j.getAttribute("data-precedence"),C=f.get(J)||p,C===p&&f.set(null,j),f.set(J,j),this.count++,p=lh.bind(this),j.addEventListener("load",p),j.addEventListener("error",p),C?C.parentNode.insertBefore(j,C.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(j,i.firstChild)),l.state.loading|=4}}var Lu={$$typeof:S,Provider:null,Consumer:null,_currentValue:we,_currentValue2:we,_threadCount:0};function jC(i,l,f,p,j,C,J,pe,Fe){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ct(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ct(0),this.hiddenUpdates=ct(null),this.identifierPrefix=p,this.onUncaughtError=j,this.onCaughtError=C,this.onRecoverableError=J,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Fe,this.incompleteTransitions=new Map}function T2(i,l,f,p,j,C,J,pe,Fe,Xe,ot,ft){return i=new jC(i,l,f,J,Fe,Xe,ot,ft,pe),l=1,C===!0&&(l|=24),C=Ta(3,null,null,l),i.current=C,C.stateNode=i,l=$m(),l.refCount++,i.pooledCache=l,l.refCount++,C.memoizedState={element:p,isDehydrated:f,cache:l},Vm(C),i}function A2(i){return i?(i=Rl,i):Rl}function C2(i,l,f,p,j,C){j=A2(j),p.context===null?p.context=j:p.pendingContext=j,p=Fi(l),p.payload={element:f},C=C===void 0?null:C,C!==null&&(p.callback=C),f=Li(i,p,l),f!==null&&(ba(f,i,l),hu(f,i,l))}function R2(i,l){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<l?f:l}}function dx(i,l){R2(i,l),(i=i.alternate)&&R2(i,l)}function D2(i){if(i.tag===13||i.tag===31){var l=bo(i,67108864);l!==null&&ba(l,i,67108864),dx(i,67108864)}}function O2(i){if(i.tag===13||i.tag===31){var l=Oa();l=Rr(l);var f=bo(i,l);f!==null&&ba(f,i,l),dx(i,l)}}var dh=!0;function TC(i,l,f,p){var j=te.T;te.T=null;var C=Z.p;try{Z.p=2,fx(i,l,f,p)}finally{Z.p=C,te.T=j}}function AC(i,l,f,p){var j=te.T;te.T=null;var C=Z.p;try{Z.p=8,fx(i,l,f,p)}finally{Z.p=C,te.T=j}}function fx(i,l,f,p){if(dh){var j=hx(p);if(j===null)Zp(i,l,p,fh,f),L2(i,p);else if(RC(j,i,l,f,p))p.stopPropagation();else if(L2(i,p),l&4&&-1<CC.indexOf(i)){for(;j!==null;){var C=Nt(j);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var J=he(C.pendingLanes);if(J!==0){var pe=C;for(pe.pendingLanes|=2,pe.entangledLanes|=2;J;){var Fe=1<<31-Le(J);pe.entanglements[1]|=Fe,J&=~Fe}Cn(C),(Sr&6)===0&&(Kf=Me()+500,Au(0))}}break;case 31:case 13:pe=bo(C,2),pe!==null&&ba(pe,C,2),Yf(),dx(C,2)}if(C=hx(p),C===null&&Zp(i,l,p,fh,f),C===j)break;j=C}j!==null&&p.stopPropagation()}else Zp(i,l,p,null,f)}}function hx(i){return i=pm(i),mx(i)}var fh=null;function mx(i){if(fh=null,i=vt(i),i!==null){var l=o(i);if(l===null)i=null;else{var f=l.tag;if(f===13){if(i=c(l),i!==null)return i;i=null}else if(f===31){if(i=u(l),i!==null)return i;i=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;i=null}else l!==i&&(i=null)}}return fh=i,null}function F2(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(De()){case Ce:return 2;case st:return 8;case We:case Ze:return 32;case Re:return 268435456;default:return 32}default:return 32}}var px=!1,Gi=null,Vi=null,Ki=null,Iu=new Map,Mu=new Map,Xi=[],CC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function L2(i,l){switch(i){case"focusin":case"focusout":Gi=null;break;case"dragenter":case"dragleave":Vi=null;break;case"mouseover":case"mouseout":Ki=null;break;case"pointerover":case"pointerout":Iu.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mu.delete(l.pointerId)}}function Pu(i,l,f,p,j,C){return i===null||i.nativeEvent!==C?(i={blockedOn:l,domEventName:f,eventSystemFlags:p,nativeEvent:C,targetContainers:[j]},l!==null&&(l=Nt(l),l!==null&&D2(l)),i):(i.eventSystemFlags|=p,l=i.targetContainers,j!==null&&l.indexOf(j)===-1&&l.push(j),i)}function RC(i,l,f,p,j){switch(l){case"focusin":return Gi=Pu(Gi,i,l,f,p,j),!0;case"dragenter":return Vi=Pu(Vi,i,l,f,p,j),!0;case"mouseover":return Ki=Pu(Ki,i,l,f,p,j),!0;case"pointerover":var C=j.pointerId;return Iu.set(C,Pu(Iu.get(C)||null,i,l,f,p,j)),!0;case"gotpointercapture":return C=j.pointerId,Mu.set(C,Pu(Mu.get(C)||null,i,l,f,p,j)),!0}return!1}function I2(i){var l=vt(i.target);if(l!==null){var f=o(l);if(f!==null){if(l=f.tag,l===13){if(l=c(f),l!==null){i.blockedOn=l,_e(i.priority,function(){O2(f)});return}}else if(l===31){if(l=u(f),l!==null){i.blockedOn=l,_e(i.priority,function(){O2(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function hh(i){if(i.blockedOn!==null)return!1;for(var l=i.targetContainers;0<l.length;){var f=hx(i.nativeEvent);if(f===null){f=i.nativeEvent;var p=new f.constructor(f.type,f);mm=p,f.target.dispatchEvent(p),mm=null}else return l=Nt(f),l!==null&&D2(l),i.blockedOn=f,!1;l.shift()}return!0}function M2(i,l,f){hh(i)&&f.delete(l)}function DC(){px=!1,Gi!==null&&hh(Gi)&&(Gi=null),Vi!==null&&hh(Vi)&&(Vi=null),Ki!==null&&hh(Ki)&&(Ki=null),Iu.forEach(M2),Mu.forEach(M2)}function mh(i,l){i.blockedOn===l&&(i.blockedOn=null,px||(px=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,DC)))}var ph=null;function P2(i){ph!==i&&(ph=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){ph===i&&(ph=null);for(var l=0;l<i.length;l+=3){var f=i[l],p=i[l+1],j=i[l+2];if(typeof p!="function"){if(mx(p||f)===null)continue;break}var C=Nt(f);C!==null&&(i.splice(l,3),l-=3,hp(C,{pending:!0,data:j,method:f.method,action:p},p,j))}}))}function tc(i){function l(Fe){return mh(Fe,i)}Gi!==null&&mh(Gi,i),Vi!==null&&mh(Vi,i),Ki!==null&&mh(Ki,i),Iu.forEach(l),Mu.forEach(l);for(var f=0;f<Xi.length;f++){var p=Xi[f];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Xi.length&&(f=Xi[0],f.blockedOn===null);)I2(f),f.blockedOn===null&&Xi.shift();if(f=(i.ownerDocument||i).$$reactFormReplay,f!=null)for(p=0;p<f.length;p+=3){var j=f[p],C=f[p+1],J=j[Se]||null;if(typeof C=="function")J||P2(f);else if(J){var pe=null;if(C&&C.hasAttribute("formAction")){if(j=C,J=C[Se]||null)pe=J.formAction;else if(mx(j)!==null)continue}else pe=J.action;typeof pe=="function"?f[p+1]=pe:(f.splice(p,3),p-=3),P2(f)}}}function B2(){function i(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(J){return j=J})},focusReset:"manual",scroll:"manual"})}function l(){j!==null&&(j(),j=null),p||setTimeout(f,20)}function f(){if(!p&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,j=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(f,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),j!==null&&(j(),j=null)}}}function xx(i){this._internalRoot=i}xh.prototype.render=xx.prototype.render=function(i){var l=this._internalRoot;if(l===null)throw Error(s(409));var f=l.current,p=Oa();C2(f,p,i,l,null,null)},xh.prototype.unmount=xx.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var l=i.containerInfo;C2(i.current,2,null,i,null,null),Yf(),l[ke]=null}};function xh(i){this._internalRoot=i}xh.prototype.unstable_scheduleHydration=function(i){if(i){var l=fe();i={blockedOn:null,target:i,priority:l};for(var f=0;f<Xi.length&&l!==0&&l<Xi[f].priority;f++);Xi.splice(f,0,i),f===0&&I2(i)}};var U2=t.version;if(U2!=="19.2.3")throw Error(s(527,U2,"19.2.3"));Z.findDOMNode=function(i){var l=i._reactInternals;if(l===void 0)throw typeof i.render=="function"?Error(s(188)):(i=Object.keys(i).join(","),Error(s(268,i)));return i=h(l),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var OC={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gh.isDisabled&&gh.supportsFiber)try{wt=gh.inject(OC),jt=gh}catch{}}return Uu.createRoot=function(i,l){if(!a(i))throw Error(s(299));var f=!1,p="",j=Vb,C=Kb,J=Xb;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(j=l.onUncaughtError),l.onCaughtError!==void 0&&(C=l.onCaughtError),l.onRecoverableError!==void 0&&(J=l.onRecoverableError)),l=T2(i,1,!1,null,null,f,p,null,j,C,J,B2),i[ke]=l.current,Jp(i),new xx(l)},Uu.hydrateRoot=function(i,l,f){if(!a(i))throw Error(s(299));var p=!1,j="",C=Vb,J=Kb,pe=Xb,Fe=null;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(j=f.identifierPrefix),f.onUncaughtError!==void 0&&(C=f.onUncaughtError),f.onCaughtError!==void 0&&(J=f.onCaughtError),f.onRecoverableError!==void 0&&(pe=f.onRecoverableError),f.formState!==void 0&&(Fe=f.formState)),l=T2(i,1,!0,l,f??null,p,j,Fe,C,J,pe,B2),l.context=A2(null),f=l.current,p=Oa(),p=Rr(p),j=Fi(p),j.callback=null,Li(f,j,p),f=p,l.current.lanes=f,Et(l,f),Cn(l),i[ke]=l.current,Jp(i),new xh(l)},Uu.version="19.2.3",Uu}var J2;function GC(){if(J2)return vx.exports;J2=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),vx.exports=WC(),vx.exports}var VC=GC();var Rc;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(Rc||(Rc={}));class Sx extends Error{constructor(t,r,s){super(t),this.message=t,this.code=r,this.data=s}}const KC=e=>{var t,r;return e?.androidBridge?"android":!((r=(t=e?.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},XC=e=>{const t=e.CapacitorCustomPlatform||null,r=e.Capacitor||{},s=r.Plugins=r.Plugins||{},a=()=>t!==null?t.name:KC(e),o=()=>a()!=="web",c=x=>{const y=h.get(x);return!!(y?.platforms.has(a())||u(x))},u=x=>{var y;return(y=r.PluginHeaders)===null||y===void 0?void 0:y.find(v=>v.name===x)},d=x=>e.console.error(x),h=new Map,m=(x,y={})=>{const v=h.get(x);if(v)return console.warn(`Capacitor plugin "${x}" already registered. Cannot register plugins twice.`),v.proxy;const w=a(),g=u(x);let _;const b=async()=>(!_&&w in y?_=typeof y[w]=="function"?_=await y[w]():_=y[w]:t!==null&&!_&&"web"in y&&(_=typeof y.web=="function"?_=await y.web():_=y.web),_),N=(P,F)=>{var V,oe;if(g){const D=g?.methods.find(K=>F===K.name);if(D)return D.rtype==="promise"?K=>r.nativePromise(x,F.toString(),K):(K,M)=>r.nativeCallback(x,F.toString(),K,M);if(P)return(V=P[F])===null||V===void 0?void 0:V.bind(P)}else{if(P)return(oe=P[F])===null||oe===void 0?void 0:oe.bind(P);throw new Sx(`"${x}" plugin is not implemented on ${w}`,Rc.Unimplemented)}},S=P=>{let F;const V=(...oe)=>{const D=b().then(K=>{const M=N(K,P);if(M){const ae=M(...oe);return F=ae?.remove,ae}else throw new Sx(`"${x}.${P}()" is not implemented on ${w}`,Rc.Unimplemented)});return P==="addListener"&&(D.remove=async()=>F()),D};return V.toString=()=>`${P.toString()}() { [capacitor code] }`,Object.defineProperty(V,"name",{value:P,writable:!1,configurable:!1}),V},E=S("addListener"),R=S("removeListener"),L=(P,F)=>{const V=E({eventName:P},F),oe=async()=>{const K=await V;R({eventName:P,callbackId:K},F)},D=new Promise(K=>V.then(()=>K({remove:oe})));return D.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await oe()},D},O=new Proxy({},{get(P,F){switch(F){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return g?L:E;case"removeListener":return R;default:return S(F)}}});return s[x]=O,h.set(x,{name:x,proxy:O,platforms:new Set([...Object.keys(y),...g?[w]:[]])}),O};return r.convertFileSrc||(r.convertFileSrc=x=>x),r.getPlatform=a,r.handleError=d,r.isNativePlatform=o,r.isPluginAvailable=c,r.registerPlugin=m,r.Exception=Sx,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},YC=e=>e.Capacitor=XC(e),h0=YC(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Ly=h0.registerPlugin;class Iy{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,r){let s=!1;this.listeners[t]||(this.listeners[t]=[],s=!0),this.listeners[t].push(r);const o=this.windowListeners[t];o&&!o.registered&&this.addWindowListener(o),s&&this.sendRetainedArgumentsForEvent(t);const c=async()=>this.removeListener(t,r);return Promise.resolve({remove:c})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,r,s){const a=this.listeners[t];if(!a){if(s){let o=this.retainedEventArguments[t];o||(o=[]),o.push(r),this.retainedEventArguments[t]=o}return}a.forEach(o=>o(r))}hasListeners(t){var r;return!!(!((r=this.listeners[t])===null||r===void 0)&&r.length)}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:s=>{this.notifyListeners(r,s)}}}unimplemented(t="not implemented"){return new h0.Exception(t,Rc.Unimplemented)}unavailable(t="not available"){return new h0.Exception(t,Rc.Unavailable)}async removeListener(t,r){const s=this.listeners[t];if(!s)return;const a=s.indexOf(r);this.listeners[t].splice(a,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const r=this.retainedEventArguments[t];r&&(delete this.retainedEventArguments[t],r.forEach(s=>{this.notifyListeners(t,s)}))}}const Z2=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Q2=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class JC extends Iy{async getCookies(){const t=document.cookie,r={};return t.split(";").forEach(s=>{if(s.length<=0)return;let[a,o]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=Q2(a).trim(),o=Q2(o).trim(),r[a]=o}),r}async setCookie(t){try{const r=Z2(t.key),s=Z2(t.value),a=`; expires=${(t.expires||"").replace("expires=","")}`,o=(t.path||"/").replace("path=",""),c=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${s||""}${a}; path=${o}; ${c};`}catch(r){return Promise.reject(r)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}Ly("CapacitorCookies",{web:()=>new JC});const ZC=async e=>new Promise((t,r)=>{const s=new FileReader;s.onload=()=>{const a=s.result;t(a.indexOf(",")>=0?a.split(",")[1]:a)},s.onerror=a=>r(a),s.readAsDataURL(e)}),QC=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(a=>a.toLocaleLowerCase()).reduce((a,o,c)=>(a[o]=e[t[c]],a),{})},e6=(e,t=!0)=>e?Object.entries(e).reduce((s,a)=>{const[o,c]=a;let u,d;return Array.isArray(c)?(d="",c.forEach(h=>{u=t?encodeURIComponent(h):h,d+=`${o}=${u}&`}),d.slice(0,-1)):(u=t?encodeURIComponent(c):c,d=`${o}=${u}`),`${s}&${d}`},"").substr(1):null,t6=(e,t={})=>{const r=Object.assign({method:e.method||"GET",headers:e.headers},t),a=QC(e.headers)["content-type"]||"";if(typeof e.data=="string")r.body=e.data;else if(a.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[c,u]of Object.entries(e.data||{}))o.set(c,u);r.body=o.toString()}else if(a.includes("multipart/form-data")||e.data instanceof FormData){const o=new FormData;if(e.data instanceof FormData)e.data.forEach((u,d)=>{o.append(d,u)});else for(const u of Object.keys(e.data))o.append(u,e.data[u]);r.body=o;const c=new Headers(r.headers);c.delete("content-type"),r.headers=c}else(a.includes("application/json")||typeof e.data=="object")&&(r.body=JSON.stringify(e.data));return r};class r6 extends Iy{async request(t){const r=t6(t,t.webFetchExtra),s=e6(t.params,t.shouldEncodeUrlParams),a=s?`${t.url}?${s}`:t.url,o=await fetch(a,r),c=o.headers.get("content-type")||"";let{responseType:u="text"}=o.ok?t:{};c.includes("application/json")&&(u="json");let d,h;switch(u){case"arraybuffer":case"blob":h=await o.blob(),d=await ZC(h);break;case"json":d=await o.json();break;default:d=await o.text()}const m={};return o.headers.forEach((x,y)=>{m[y]=x}),{data:d,headers:m,status:o.status,url:o.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}Ly("CapacitorHttp",{web:()=>new r6});var eS;(function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"})(eS||(eS={}));var tS;(function(e){e.StatusBar="StatusBar",e.NavigationBar="NavigationBar"})(tS||(tS={}));class s6 extends Iy{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}Ly("SystemBars",{web:()=>new s6});var rS="popstate";function a6(e={}){function t(s,a){let{pathname:o,search:c,hash:u}=s.location;return Y1("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(s,a){return typeof a=="string"?a:md(a)}return i6(t,r,null,e)}function Xr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function dn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function n6(){return Math.random().toString(36).substring(2,10)}function sS(e,t){return{usr:e.state,key:e.key,idx:t}}function Y1(e,t,r=null,s){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?qc(t):t,state:r,key:t&&t.key||s||n6()}}function md({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function qc(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let s=e.indexOf("?");s>=0&&(t.search=e.substring(s),e=e.substring(0,s)),e&&(t.pathname=e)}return t}function i6(e,t,r,s={}){let{window:a=document.defaultView,v5Compat:o=!1}=s,c=a.history,u="POP",d=null,h=m();h==null&&(h=0,c.replaceState({...c.state,idx:h},""));function m(){return(c.state||{idx:null}).idx}function x(){u="POP";let _=m(),b=_==null?null:_-h;h=_,d&&d({action:u,location:g.location,delta:b})}function y(_,b){u="PUSH";let N=Y1(g.location,_,b);h=m()+1;let S=sS(N,h),E=g.createHref(N);try{c.pushState(S,"",E)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;a.location.assign(E)}o&&d&&d({action:u,location:g.location,delta:1})}function v(_,b){u="REPLACE";let N=Y1(g.location,_,b);h=m();let S=sS(N,h),E=g.createHref(N);c.replaceState(S,"",E),o&&d&&d({action:u,location:g.location,delta:0})}function w(_){return o6(_)}let g={get action(){return u},get location(){return e(a,c)},listen(_){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(rS,x),d=_,()=>{a.removeEventListener(rS,x),d=null}},createHref(_){return t(a,_)},createURL:w,encodeLocation(_){let b=w(_);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:y,replace:v,go(_){return c.go(_)}};return g}function o6(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Xr(r,"No window.location.(origin|href) available to create URL");let s=typeof e=="string"?e:md(e);return s=s.replace(/ $/,"%20"),!t&&s.startsWith("//")&&(s=r+s),new URL(s,r)}function _j(e,t,r="/"){return l6(e,t,r,!1)}function l6(e,t,r,s){let a=typeof t=="string"?qc(t):t,o=gi(a.pathname||"/",r);if(o==null)return null;let c=Sj(e);c6(c);let u=null;for(let d=0;u==null&&d<c.length;++d){let h=w6(o);u=y6(c[d],h,s)}return u}function Sj(e,t=[],r=[],s="",a=!1){let o=(c,u,d=a,h)=>{let m={relativePath:h===void 0?c.path||"":h,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(s)&&d)return;Xr(m.relativePath.startsWith(s),`Absolute route path "${m.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(s.length)}let x=hi([s,m.relativePath]),y=r.concat(m);c.children&&c.children.length>0&&(Xr(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),Sj(c.children,t,y,x,d)),!(c.path==null&&!c.index)&&t.push({path:x,score:x6(x,c.index),routesMeta:y})};return e.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))o(c,u);else for(let d of kj(c.path))o(c,u,!0,d)}),t}function kj(e){let t=e.split("/");if(t.length===0)return[];let[r,...s]=t,a=r.endsWith("?"),o=r.replace(/\?$/,"");if(s.length===0)return a?[o,""]:[o];let c=kj(s.join("/")),u=[];return u.push(...c.map(d=>d===""?o:[o,d].join("/"))),a&&u.push(...c),u.map(d=>e.startsWith("/")&&d===""?"/":d)}function c6(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:g6(t.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}var u6=/^:[\w-]+$/,d6=3,f6=2,h6=1,m6=10,p6=-2,aS=e=>e==="*";function x6(e,t){let r=e.split("/"),s=r.length;return r.some(aS)&&(s+=p6),t&&(s+=f6),r.filter(a=>!aS(a)).reduce((a,o)=>a+(u6.test(o)?d6:o===""?h6:m6),s)}function g6(e,t){return e.length===t.length&&e.slice(0,-1).every((s,a)=>s===t[a])?e[e.length-1]-t[t.length-1]:0}function y6(e,t,r=!1){let{routesMeta:s}=e,a={},o="/",c=[];for(let u=0;u<s.length;++u){let d=s[u],h=u===s.length-1,m=o==="/"?t:t.slice(o.length)||"/",x=m0({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},m),y=d.route;if(!x&&h&&r&&!s[s.length-1].route.index&&(x=m0({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!x)return null;Object.assign(a,x.params),c.push({params:a,pathname:hi([o,x.pathname]),pathnameBase:k6(hi([o,x.pathnameBase])),route:y}),x.pathnameBase!=="/"&&(o=hi([o,x.pathnameBase]))}return c}function m0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,s]=v6(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let o=a[0],c=o.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:s.reduce((h,{paramName:m,isOptional:x},y)=>{if(m==="*"){let w=u[y]||"";c=o.slice(0,o.length-w.length).replace(/(.)\/+$/,"$1")}const v=u[y];return x&&!v?h[m]=void 0:h[m]=(v||"").replace(/%2F/g,"/"),h},{}),pathname:o,pathnameBase:c,pattern:e}}function v6(e,t=!1,r=!0){dn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let s=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,d)=>(s.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(s.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),s]}function w6(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return dn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function gi(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=e.charAt(r);return s&&s!=="/"?null:e.slice(r)||"/"}var Nj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,b6=e=>Nj.test(e);function _6(e,t="/"){let{pathname:r,search:s="",hash:a=""}=typeof e=="string"?qc(e):e,o;if(r)if(b6(r))o=r;else{if(r.includes("//")){let c=r;r=r.replace(/\/\/+/g,"/"),dn(!1,`Pathnames cannot have embedded double slashes - normalizing ${c} -> ${r}`)}r.startsWith("/")?o=nS(r.substring(1),"/"):o=nS(r,t)}else o=t;return{pathname:o,search:N6(s),hash:E6(a)}}function nS(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function kx(e,t,r,s){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function S6(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function My(e){let t=S6(e);return t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase)}function Py(e,t,r,s=!1){let a;typeof e=="string"?a=qc(e):(a={...e},Xr(!a.pathname||!a.pathname.includes("?"),kx("?","pathname","search",a)),Xr(!a.pathname||!a.pathname.includes("#"),kx("#","pathname","hash",a)),Xr(!a.search||!a.search.includes("#"),kx("#","search","hash",a)));let o=e===""||a.pathname==="",c=o?"/":a.pathname,u;if(c==null)u=r;else{let x=t.length-1;if(!s&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),x-=1;a.pathname=y.join("/")}u=x>=0?t[x]:"/"}let d=_6(a,u),h=c&&c!=="/"&&c.endsWith("/"),m=(o||c===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(h||m)&&(d.pathname+="/"),d}var hi=e=>e.join("/").replace(/\/\/+/g,"/"),k6=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),N6=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,E6=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,j6=class{constructor(e,t,r,s=!1){this.status=e,this.statusText=t||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function T6(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function A6(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Ej=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function jj(e,t){let r=e;if(typeof r!="string"||!Nj.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let s=r,a=!1;if(Ej)try{let o=new URL(window.location.href),c=r.startsWith("//")?new URL(o.protocol+r):new URL(r),u=gi(c.pathname,t);c.origin===o.origin&&u!=null?r=u+c.search+c.hash:a=!0}catch{dn(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:a,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Tj=["POST","PUT","PATCH","DELETE"];new Set(Tj);var C6=["GET",...Tj];new Set(C6);var $c=Y.createContext(null);$c.displayName="DataRouter";var P0=Y.createContext(null);P0.displayName="DataRouterState";var R6=Y.createContext(!1),Aj=Y.createContext({isTransitioning:!1});Aj.displayName="ViewTransition";var D6=Y.createContext(new Map);D6.displayName="Fetchers";var O6=Y.createContext(null);O6.displayName="Await";var $a=Y.createContext(null);$a.displayName="Navigation";var qd=Y.createContext(null);qd.displayName="Location";var hn=Y.createContext({outlet:null,matches:[],isDataRoute:!1});hn.displayName="Route";var By=Y.createContext(null);By.displayName="RouteError";var Cj="REACT_ROUTER_ERROR",F6="REDIRECT",L6="ROUTE_ERROR_RESPONSE";function I6(e){if(e.startsWith(`${Cj}:${F6}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function M6(e){if(e.startsWith(`${Cj}:${L6}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new j6(t.status,t.statusText,t.data)}catch{}}function P6(e,{relative:t}={}){Xr(Hc(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:s}=Y.useContext($a),{hash:a,pathname:o,search:c}=$d(e,{relative:t}),u=o;return r!=="/"&&(u=o==="/"?r:hi([r,o])),s.createHref({pathname:u,search:c,hash:a})}function Hc(){return Y.useContext(qd)!=null}function wi(){return Xr(Hc(),"useLocation() may be used only in the context of a <Router> component."),Y.useContext(qd).location}var Rj="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Dj(e){Y.useContext($a).static||Y.useLayoutEffect(e)}function Wc(){let{isDataRoute:e}=Y.useContext(hn);return e?Q6():B6()}function B6(){Xr(Hc(),"useNavigate() may be used only in the context of a <Router> component.");let e=Y.useContext($c),{basename:t,navigator:r}=Y.useContext($a),{matches:s}=Y.useContext(hn),{pathname:a}=wi(),o=JSON.stringify(My(s)),c=Y.useRef(!1);return Dj(()=>{c.current=!0}),Y.useCallback((d,h={})=>{if(dn(c.current,Rj),!c.current)return;if(typeof d=="number"){r.go(d);return}let m=Py(d,JSON.parse(o),a,h.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:hi([t,m.pathname])),(h.replace?r.replace:r.push)(m,h.state,h)},[t,r,o,a,e])}var U6=Y.createContext(null);function z6(e){let t=Y.useContext(hn).outlet;return Y.useMemo(()=>t&&Y.createElement(U6.Provider,{value:e},t),[t,e])}function Oj(){let{matches:e}=Y.useContext(hn),t=e[e.length-1];return t?t.params:{}}function $d(e,{relative:t}={}){let{matches:r}=Y.useContext(hn),{pathname:s}=wi(),a=JSON.stringify(My(r));return Y.useMemo(()=>Py(e,JSON.parse(a),s,t==="path"),[e,a,s,t])}function q6(e,t){return Fj(e,t)}function Fj(e,t,r,s,a){Xr(Hc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=Y.useContext($a),{matches:c}=Y.useContext(hn),u=c[c.length-1],d=u?u.params:{},h=u?u.pathname:"/",m=u?u.pathnameBase:"/",x=u&&u.route;{let N=x&&x.path||"";Ij(h,!x||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let y=wi(),v;if(t){let N=typeof t=="string"?qc(t):t;Xr(m==="/"||N.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${N.pathname}" was given in the \`location\` prop.`),v=N}else v=y;let w=v.pathname||"/",g=w;if(m!=="/"){let N=m.replace(/^\//,"").split("/");g="/"+w.replace(/^\//,"").split("/").slice(N.length).join("/")}let _=_j(e,{pathname:g});dn(x||_!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),dn(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=V6(_&&_.map(N=>Object.assign({},N,{params:Object.assign({},d,N.params),pathname:hi([m,o.encodeLocation?o.encodeLocation(N.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?m:hi([m,o.encodeLocation?o.encodeLocation(N.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathnameBase])})),c,r,s,a);return t&&b?Y.createElement(qd.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},b):b}function $6(){let e=Z6(),t=T6(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:s},o={padding:"2px 4px",backgroundColor:s},c=null;return console.error("Error handled by React Router default ErrorBoundary:",e),c=Y.createElement(Y.Fragment,null,Y.createElement("p",null," Hey developer "),Y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Y.createElement("code",{style:o},"ErrorBoundary")," or"," ",Y.createElement("code",{style:o},"errorElement")," prop on your route.")),Y.createElement(Y.Fragment,null,Y.createElement("h2",null,"Unexpected Application Error!"),Y.createElement("h3",{style:{fontStyle:"italic"}},t),r?Y.createElement("pre",{style:a},r):null,c)}var H6=Y.createElement($6,null),Lj=class extends Y.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const r=M6(e.digest);r&&(e=r)}let t=e!==void 0?Y.createElement(hn.Provider,{value:this.props.routeContext},Y.createElement(By.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?Y.createElement(W6,{error:e},t):t}};Lj.contextType=R6;var Nx=new WeakMap;function W6({children:e,error:t}){let{basename:r}=Y.useContext($a);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let s=I6(t.digest);if(s){let a=Nx.get(t);if(a)throw a;let o=jj(s.location,r);if(Ej&&!Nx.get(t))if(o.isExternal||s.reloadDocument)window.location.href=o.absoluteURL||o.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(o.to,{replace:s.replace}));throw Nx.set(t,c),c}return Y.createElement("meta",{httpEquiv:"refresh",content:`0;url=${o.absoluteURL||o.to}`})}}return e}function G6({routeContext:e,match:t,children:r}){let s=Y.useContext($c);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),Y.createElement(hn.Provider,{value:e},r)}function V6(e,t=[],r=null,s=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,c=r?.errors;if(c!=null){let m=o.findIndex(x=>x.route.id&&c?.[x.route.id]!==void 0);Xr(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,d=-1;if(r)for(let m=0;m<o.length;m++){let x=o[m];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(d=m),x.route.id){let{loaderData:y,errors:v}=r,w=x.route.loader&&!y.hasOwnProperty(x.route.id)&&(!v||v[x.route.id]===void 0);if(x.route.lazy||w){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}let h=r&&s?(m,x)=>{s(m,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:A6(r.matches),errorInfo:x})}:void 0;return o.reduceRight((m,x,y)=>{let v,w=!1,g=null,_=null;r&&(v=c&&x.route.id?c[x.route.id]:void 0,g=x.route.errorElement||H6,u&&(d<0&&y===0?(Ij("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,_=null):d===y&&(w=!0,_=x.route.hydrateFallbackElement||null)));let b=t.concat(o.slice(0,y+1)),N=()=>{let S;return v?S=g:w?S=_:x.route.Component?S=Y.createElement(x.route.Component,null):x.route.element?S=x.route.element:S=m,Y.createElement(G6,{match:x,routeContext:{outlet:m,matches:b,isDataRoute:r!=null},children:S})};return r&&(x.route.ErrorBoundary||x.route.errorElement||y===0)?Y.createElement(Lj,{location:r.location,revalidation:r.revalidation,component:g,error:v,children:N(),routeContext:{outlet:null,matches:b,isDataRoute:!0},onError:h}):N()},null)}function Uy(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function K6(e){let t=Y.useContext($c);return Xr(t,Uy(e)),t}function X6(e){let t=Y.useContext(P0);return Xr(t,Uy(e)),t}function Y6(e){let t=Y.useContext(hn);return Xr(t,Uy(e)),t}function zy(e){let t=Y6(e),r=t.matches[t.matches.length-1];return Xr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function J6(){return zy("useRouteId")}function Z6(){let e=Y.useContext(By),t=X6("useRouteError"),r=zy("useRouteError");return e!==void 0?e:t.errors?.[r]}function Q6(){let{router:e}=K6("useNavigate"),t=zy("useNavigate"),r=Y.useRef(!1);return Dj(()=>{r.current=!0}),Y.useCallback(async(a,o={})=>{dn(r.current,Rj),r.current&&(typeof a=="number"?await e.navigate(a):await e.navigate(a,{fromRouteId:t,...o}))},[e,t])}var iS={};function Ij(e,t,r){!t&&!iS[e]&&(iS[e]=!0,dn(!1,r))}Y.memo(e8);function e8({routes:e,future:t,state:r,onError:s}){return Fj(e,void 0,r,s,t)}function Go({to:e,replace:t,state:r,relative:s}){Xr(Hc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=Y.useContext($a);dn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=Y.useContext(hn),{pathname:c}=wi(),u=Wc(),d=Py(e,My(o),c,s==="path"),h=JSON.stringify(d);return Y.useEffect(()=>{u(JSON.parse(h),{replace:t,state:r,relative:s})},[u,h,s,t,r]),null}function t8(e){return z6(e.context)}function zr(e){Xr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function r8({basename:e="/",children:t=null,location:r,navigationType:s="POP",navigator:a,static:o=!1,unstable_useTransitions:c}){Xr(!Hc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=e.replace(/^\/*/,"/"),d=Y.useMemo(()=>({basename:u,navigator:a,static:o,unstable_useTransitions:c,future:{}}),[u,a,o,c]);typeof r=="string"&&(r=qc(r));let{pathname:h="/",search:m="",hash:x="",state:y=null,key:v="default"}=r,w=Y.useMemo(()=>{let g=gi(h,u);return g==null?null:{location:{pathname:g,search:m,hash:x,state:y,key:v},navigationType:s}},[u,h,m,x,y,v,s]);return dn(w!=null,`<Router basename="${u}"> is not able to match the URL "${h}${m}${x}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:Y.createElement($a.Provider,{value:d},Y.createElement(qd.Provider,{children:t,value:w}))}function s8({children:e,location:t}){return q6(J1(e),t)}function J1(e,t=[]){let r=[];return Y.Children.forEach(e,(s,a)=>{if(!Y.isValidElement(s))return;let o=[...t,a];if(s.type===Y.Fragment){r.push.apply(r,J1(s.props.children,o));return}Xr(s.type===zr,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xr(!s.props.index||!s.props.children,"An index route cannot have child routes.");let c={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=J1(s.props.children,o)),r.push(c)}),r}var t0="get",r0="application/x-www-form-urlencoded";function B0(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function a8(e){return B0(e)&&e.tagName.toLowerCase()==="button"}function n8(e){return B0(e)&&e.tagName.toLowerCase()==="form"}function i8(e){return B0(e)&&e.tagName.toLowerCase()==="input"}function o8(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function l8(e,t){return e.button===0&&(!t||t==="_self")&&!o8(e)}var vh=null;function c8(){if(vh===null)try{new FormData(document.createElement("form"),0),vh=!1}catch{vh=!0}return vh}var u8=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ex(e){return e!=null&&!u8.has(e)?(dn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${r0}"`),null):e}function d8(e,t){let r,s,a,o,c;if(n8(e)){let u=e.getAttribute("action");s=u?gi(u,t):null,r=e.getAttribute("method")||t0,a=Ex(e.getAttribute("enctype"))||r0,o=new FormData(e)}else if(a8(e)||i8(e)&&(e.type==="submit"||e.type==="image")){let u=e.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||u.getAttribute("action");if(s=d?gi(d,t):null,r=e.getAttribute("formmethod")||u.getAttribute("method")||t0,a=Ex(e.getAttribute("formenctype"))||Ex(u.getAttribute("enctype"))||r0,o=new FormData(u,e),!c8()){let{name:h,type:m,value:x}=e;if(m==="image"){let y=h?`${h}.`:"";o.append(`${y}x`,"0"),o.append(`${y}y`,"0")}else h&&o.append(h,x)}}else{if(B0(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=t0,s=null,a=r0,c=e}return o&&a==="text/plain"&&(c=o,o=void 0),{action:s,method:r.toLowerCase(),encType:a,formData:o,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function qy(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function f8(e,t,r,s){let a=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${s}`:a.pathname=`${a.pathname}.${s}`:a.pathname==="/"?a.pathname=`_root.${s}`:t&&gi(a.pathname,t)==="/"?a.pathname=`${t.replace(/\/$/,"")}/_root.${s}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${s}`,a}async function h8(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function m8(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function p8(e,t,r){let s=await Promise.all(e.map(async a=>{let o=t.routes[a.route.id];if(o){let c=await h8(o,r);return c.links?c.links():[]}return[]}));return v8(s.flat(1).filter(m8).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function oS(e,t,r,s,a,o){let c=(d,h)=>r[h]?d.route.id!==r[h].route.id:!0,u=(d,h)=>r[h].pathname!==d.pathname||r[h].route.path?.endsWith("*")&&r[h].params["*"]!==d.params["*"];return o==="assets"?t.filter((d,h)=>c(d,h)||u(d,h)):o==="data"?t.filter((d,h)=>{let m=s.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(c(d,h)||u(d,h))return!0;if(d.route.shouldRevalidate){let x=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function x8(e,t,{includeHydrateFallback:r}={}){return g8(e.map(s=>{let a=t.routes[s.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function g8(e){return[...new Set(e)]}function y8(e){let t={},r=Object.keys(e).sort();for(let s of r)t[s]=e[s];return t}function v8(e,t){let r=new Set;return new Set(t),e.reduce((s,a)=>{let o=JSON.stringify(y8(a));return r.has(o)||(r.add(o),s.push({key:o,link:a})),s},[])}function Mj(){let e=Y.useContext($c);return qy(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function w8(){let e=Y.useContext(P0);return qy(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var $y=Y.createContext(void 0);$y.displayName="FrameworkContext";function Pj(){let e=Y.useContext($y);return qy(e,"You must render this element inside a <HydratedRouter> element"),e}function b8(e,t){let r=Y.useContext($y),[s,a]=Y.useState(!1),[o,c]=Y.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:h,onMouseLeave:m,onTouchStart:x}=t,y=Y.useRef(null);Y.useEffect(()=>{if(e==="render"&&c(!0),e==="viewport"){let g=b=>{b.forEach(N=>{c(N.isIntersecting)})},_=new IntersectionObserver(g,{threshold:.5});return y.current&&_.observe(y.current),()=>{_.disconnect()}}},[e]),Y.useEffect(()=>{if(s){let g=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(g)}}},[s]);let v=()=>{a(!0)},w=()=>{a(!1),c(!1)};return r?e!=="intent"?[o,y,{}]:[o,y,{onFocus:zu(u,v),onBlur:zu(d,w),onMouseEnter:zu(h,v),onMouseLeave:zu(m,w),onTouchStart:zu(x,v)}]:[!1,y,{}]}function zu(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function _8({page:e,...t}){let{router:r}=Mj(),s=Y.useMemo(()=>_j(r.routes,e,r.basename),[r.routes,e,r.basename]);return s?Y.createElement(k8,{page:e,matches:s,...t}):null}function S8(e){let{manifest:t,routeModules:r}=Pj(),[s,a]=Y.useState([]);return Y.useEffect(()=>{let o=!1;return p8(e,t,r).then(c=>{o||a(c)}),()=>{o=!0}},[e,t,r]),s}function k8({page:e,matches:t,...r}){let s=wi(),{future:a,manifest:o,routeModules:c}=Pj(),{basename:u}=Mj(),{loaderData:d,matches:h}=w8(),m=Y.useMemo(()=>oS(e,t,h,o,s,"data"),[e,t,h,o,s]),x=Y.useMemo(()=>oS(e,t,h,o,s,"assets"),[e,t,h,o,s]),y=Y.useMemo(()=>{if(e===s.pathname+s.search+s.hash)return[];let g=new Set,_=!1;if(t.forEach(N=>{let S=o.routes[N.route.id];!S||!S.hasLoader||(!m.some(E=>E.route.id===N.route.id)&&N.route.id in d&&c[N.route.id]?.shouldRevalidate||S.hasClientLoader?_=!0:g.add(N.route.id))}),g.size===0)return[];let b=f8(e,u,a.unstable_trailingSlashAwareDataRequests,"data");return _&&g.size>0&&b.searchParams.set("_routes",t.filter(N=>g.has(N.route.id)).map(N=>N.route.id).join(",")),[b.pathname+b.search]},[u,a.unstable_trailingSlashAwareDataRequests,d,s,o,m,t,e,c]),v=Y.useMemo(()=>x8(x,o),[x,o]),w=S8(x);return Y.createElement(Y.Fragment,null,y.map(g=>Y.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...r})),v.map(g=>Y.createElement("link",{key:g,rel:"modulepreload",href:g,...r})),w.map(({key:g,link:_})=>Y.createElement("link",{key:g,nonce:r.nonce,..._})))}function N8(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var E8=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{E8&&(window.__reactRouterVersion="7.12.0")}catch{}function j8({basename:e,children:t,unstable_useTransitions:r,window:s}){let a=Y.useRef();a.current==null&&(a.current=a6({window:s,v5Compat:!0}));let o=a.current,[c,u]=Y.useState({action:o.action,location:o.location}),d=Y.useCallback(h=>{r===!1?u(h):Y.startTransition(()=>u(h))},[r]);return Y.useLayoutEffect(()=>o.listen(d),[o,d]),Y.createElement(r8,{basename:e,children:t,location:c.location,navigationType:c.action,navigator:o,unstable_useTransitions:r})}var Bj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Gs=Y.forwardRef(function({onClick:t,discover:r="render",prefetch:s="none",relative:a,reloadDocument:o,replace:c,state:u,target:d,to:h,preventScrollReset:m,viewTransition:x,unstable_defaultShouldRevalidate:y,...v},w){let{basename:g,unstable_useTransitions:_}=Y.useContext($a),b=typeof h=="string"&&Bj.test(h),N=jj(h,g);h=N.to;let S=P6(h,{relative:a}),[E,R,L]=b8(s,v),O=C8(h,{replace:c,state:u,target:d,preventScrollReset:m,relative:a,viewTransition:x,unstable_defaultShouldRevalidate:y,unstable_useTransitions:_});function P(V){t&&t(V),V.defaultPrevented||O(V)}let F=Y.createElement("a",{...v,...L,href:N.absoluteURL||S,onClick:N.isExternal||o?t:P,ref:N8(w,R),target:d,"data-discover":!b&&r==="render"?"true":void 0});return E&&!b?Y.createElement(Y.Fragment,null,F,Y.createElement(_8,{page:S})):F});Gs.displayName="Link";var Z1=Y.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:s="",end:a=!1,style:o,to:c,viewTransition:u,children:d,...h},m){let x=$d(c,{relative:h.relative}),y=wi(),v=Y.useContext(P0),{navigator:w,basename:g}=Y.useContext($a),_=v!=null&&L8(x)&&u===!0,b=w.encodeLocation?w.encodeLocation(x).pathname:x.pathname,N=y.pathname,S=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(N=N.toLowerCase(),S=S?S.toLowerCase():null,b=b.toLowerCase()),S&&g&&(S=gi(S,g)||S);const E=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let R=N===b||!a&&N.startsWith(b)&&N.charAt(E)==="/",L=S!=null&&(S===b||!a&&S.startsWith(b)&&S.charAt(b.length)==="/"),O={isActive:R,isPending:L,isTransitioning:_},P=R?t:void 0,F;typeof s=="function"?F=s(O):F=[s,R?"active":null,L?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let V=typeof o=="function"?o(O):o;return Y.createElement(Gs,{...h,"aria-current":P,className:F,ref:m,style:V,to:c,viewTransition:u},typeof d=="function"?d(O):d)});Z1.displayName="NavLink";var T8=Y.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:s,replace:a,state:o,method:c=t0,action:u,onSubmit:d,relative:h,preventScrollReset:m,viewTransition:x,unstable_defaultShouldRevalidate:y,...v},w)=>{let{unstable_useTransitions:g}=Y.useContext($a),_=O8(),b=F8(u,{relative:h}),N=c.toLowerCase()==="get"?"get":"post",S=typeof u=="string"&&Bj.test(u),E=R=>{if(d&&d(R),R.defaultPrevented)return;R.preventDefault();let L=R.nativeEvent.submitter,O=L?.getAttribute("formmethod")||c,P=()=>_(L||R.currentTarget,{fetcherKey:t,method:O,navigate:r,replace:a,state:o,relative:h,preventScrollReset:m,viewTransition:x,unstable_defaultShouldRevalidate:y});g&&r!==!1?Y.startTransition(()=>P()):P()};return Y.createElement("form",{ref:w,method:N,action:b,onSubmit:s?d:E,...v,"data-discover":!S&&e==="render"?"true":void 0})});T8.displayName="Form";function A8(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Uj(e){let t=Y.useContext($c);return Xr(t,A8(e)),t}function C8(e,{target:t,replace:r,state:s,preventScrollReset:a,relative:o,viewTransition:c,unstable_defaultShouldRevalidate:u,unstable_useTransitions:d}={}){let h=Wc(),m=wi(),x=$d(e,{relative:o});return Y.useCallback(y=>{if(l8(y,t)){y.preventDefault();let v=r!==void 0?r:md(m)===md(x),w=()=>h(e,{replace:v,state:s,preventScrollReset:a,relative:o,viewTransition:c,unstable_defaultShouldRevalidate:u});d?Y.startTransition(()=>w()):w()}},[m,h,x,r,s,t,e,a,o,c,u,d])}var R8=0,D8=()=>`__${String(++R8)}__`;function O8(){let{router:e}=Uj("useSubmit"),{basename:t}=Y.useContext($a),r=J6(),s=e.fetch,a=e.navigate;return Y.useCallback(async(o,c={})=>{let{action:u,method:d,encType:h,formData:m,body:x}=d8(o,t);if(c.navigate===!1){let y=c.fetcherKey||D8();await s(y,r,c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:m,body:x,formMethod:c.method||d,formEncType:c.encType||h,flushSync:c.flushSync})}else await a(c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:m,body:x,formMethod:c.method||d,formEncType:c.encType||h,replace:c.replace,state:c.state,fromRouteId:r,flushSync:c.flushSync,viewTransition:c.viewTransition})},[s,a,t,r])}function F8(e,{relative:t}={}){let{basename:r}=Y.useContext($a),s=Y.useContext(hn);Xr(s,"useFormAction must be used inside a RouteContext");let[a]=s.matches.slice(-1),o={...$d(e||".",{relative:t})},c=wi();if(e==null){o.search=c.search;let u=new URLSearchParams(o.search),d=u.getAll("index");if(d.some(m=>m==="")){u.delete("index"),d.filter(x=>x).forEach(x=>u.append("index",x));let m=u.toString();o.search=m?`?${m}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(o.pathname=o.pathname==="/"?r:hi([r,o.pathname])),md(o)}function L8(e,{relative:t}={}){let r=Y.useContext(Aj);Xr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Uj("useViewTransitionState"),a=$d(e,{relative:t});if(!r.isTransitioning)return!1;let o=gi(r.currentLocation.pathname,s)||r.currentLocation.pathname,c=gi(r.nextLocation.pathname,s)||r.nextLocation.pathname;return m0(a.pathname,c)!=null||m0(a.pathname,o)!=null}function U0(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r}function I8(e,t,r,s){function a(o){return o instanceof r?o:new r(function(c){c(o)})}return new(r||(r=Promise))(function(o,c){function u(m){try{h(s.next(m))}catch(x){c(x)}}function d(m){try{h(s.throw(m))}catch(x){c(x)}}function h(m){m.done?o(m.value):a(m.value).then(u,d)}h((s=s.apply(e,t||[])).next())})}const M8=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Hy extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class P8 extends Hy{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class lS extends Hy{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class cS extends Hy{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Q1;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Q1||(Q1={}));class B8{constructor(t,{headers:r={},customFetch:s,region:a=Q1.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=M8(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return I8(this,arguments,void 0,function*(r,s={}){var a;let o,c;try{const{headers:u,method:d,body:h,signal:m,timeout:x}=s;let y={},{region:v}=s;v||(v=this.region);const w=new URL(`${this.url}/${r}`);v&&v!=="any"&&(y["x-region"]=v,w.searchParams.set("forceFunctionRegion",v));let g;h&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",g=h):typeof h=="string"?(y["Content-Type"]="text/plain",g=h):typeof FormData<"u"&&h instanceof FormData?g=h:(y["Content-Type"]="application/json",g=JSON.stringify(h)):h&&typeof h!="string"&&!(typeof Blob<"u"&&h instanceof Blob)&&!(h instanceof ArrayBuffer)&&!(typeof FormData<"u"&&h instanceof FormData)?g=JSON.stringify(h):g=h;let _=m;x&&(c=new AbortController,o=setTimeout(()=>c.abort(),x),m?(_=c.signal,m.addEventListener("abort",()=>c.abort())):_=c.signal);const b=yield this.fetch(w.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),u),body:g,signal:_}).catch(R=>{throw new P8(R)}),N=b.headers.get("x-relay-error");if(N&&N==="true")throw new lS(b);if(!b.ok)throw new cS(b);let S=((a=b.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),E;return S==="application/json"?E=yield b.json():S==="application/octet-stream"||S==="application/pdf"?E=yield b.blob():S==="text/event-stream"?E=b:S==="multipart/form-data"?E=yield b.formData():E=yield b.text(),{data:E,error:null,response:b}}catch(u){return{data:null,error:u,response:u instanceof cS||u instanceof lS?u.context:void 0}}finally{o&&clearTimeout(o)}})}}var U8=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},z8=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let a=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{let c=null,u=null,d=null,h=o.status,m=o.statusText;if(o.ok){var x,y;if(r.method!=="HEAD"){var v;const b=await o.text();b===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((v=r.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?u=b:u=JSON.parse(b))}const g=(x=r.headers.get("Prefer"))===null||x===void 0?void 0:x.match(/count=(exact|planned|estimated)/),_=(y=o.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");g&&_&&_.length>1&&(d=parseInt(_[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,h=406,m="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var w;const g=await o.text();try{c=JSON.parse(g),Array.isArray(c)&&o.status===404&&(u=[],c=null,h=200,m="OK")}catch{o.status===404&&g===""?(h=204,m="No Content"):c={message:g}}if(c&&r.isMaybeSingle&&(!(c==null||(w=c.details)===null||w===void 0)&&w.includes("0 rows"))&&(c=null,h=200,m="OK"),c&&r.shouldThrowOnError)throw new U8(c)}return{error:c,data:u,count:d,status:h,statusText:m}});return this.shouldThrowOnError||(a=a.catch(o=>{var c;let u="";const d=o?.cause;if(d){var h,m,x,y;const w=(h=d?.message)!==null&&h!==void 0?h:"",g=(m=d?.code)!==null&&m!==void 0?m:"";u=`${(x=o?.name)!==null&&x!==void 0?x:"FetchError"}: ${o?.message}`,u+=`

Caused by: ${(y=d?.name)!==null&&y!==void 0?y:"Error"}: ${w}`,g&&(u+=` (${g})`),d?.stack&&(u+=`
${d.stack}`)}else{var v;u=(v=o?.stack)!==null&&v!==void 0?v:""}return{error:{message:`${(c=o?.name)!==null&&c!==void 0?c:"FetchError"}: ${o?.message}`,details:u,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},q8=class extends z8{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:a=s}={}){const o=a?`${a}.order`:"order",c=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${c?`${c},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const a=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:a=!1,format:o="text"}={}){var c;const u=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),d=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${u};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const uS=new RegExp("[,()]");var mc=class extends q8{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&uS.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&uS.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},$8=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:s}=t??{},a=r?"HEAD":"GET";let o=!1;const c=(e??"*").split("").map(h=>/\s/.test(h)&&!o?"":(h==='"'&&(o=!o),h)).join(""),{url:u,headers:d}=this.cloneRequestState();return u.searchParams.set("select",c),s&&d.append("Prefer",`count=${s}`),new mc({method:a,url:u,headers:d,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var s;const a="POST",{url:o,headers:c}=this.cloneRequestState();if(t&&c.append("Prefer",`count=${t}`),r||c.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);o.searchParams.set("columns",d.join(","))}}return new mc({method:a,url:o,headers:c,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:a=!0}={}){var o;const c="POST",{url:u,headers:d}=this.cloneRequestState();if(d.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&u.searchParams.set("on_conflict",t),s&&d.append("Prefer",`count=${s}`),a||d.append("Prefer","missing=default"),Array.isArray(e)){const h=e.reduce((m,x)=>m.concat(Object.keys(x)),[]);if(h.length>0){const m=[...new Set(h)].map(x=>`"${x}"`);u.searchParams.set("columns",m.join(","))}}return new mc({method:c,url:u,headers:d,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:t}={}){var r;const s="PATCH",{url:a,headers:o}=this.cloneRequestState();return t&&o.append("Prefer",`count=${t}`),new mc({method:s,url:a,headers:o,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:s,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new mc({method:r,url:s,headers:a,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},H8=class zj{constructor(t,{headers:r={},schema:s,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=s,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new $8(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new zj(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:s=!1,get:a=!1,count:o}={}){var c;let u;const d=new URL(`${this.url}/rpc/${t}`);let h;const m=v=>v!==null&&typeof v=="object"&&(!Array.isArray(v)||v.some(m)),x=s&&Object.values(r).some(m);x?(u="POST",h=r):s||a?(u=s?"HEAD":"GET",Object.entries(r).filter(([v,w])=>w!==void 0).map(([v,w])=>[v,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([v,w])=>{d.searchParams.append(v,w)})):(u="POST",h=r);const y=new Headers(this.headers);return x?y.set("Prefer",o?`count=${o},return=minimal`:"return=minimal"):o&&y.set("Prefer",`count=${o}`),new mc({method:u,url:d,headers:y,schema:this.schemaName,body:h,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}};class W8{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const s=r.versions;if(s&&s.node){const a=s.node,o=parseInt(a.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const G8="2.90.1",V8=`realtime-js/${G8}`,qj="1.0.0",K8="2.0.0",dS=qj,ey=1e4,X8=1e3,Y8=100;var Qi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Qi||(Qi={}));var js;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(js||(js={}));var bn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(bn||(bn={}));var ty;(function(e){e.websocket="websocket"})(ty||(ty={}));var $o;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})($o||($o={}));class J8{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,s;const a=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,s;const a=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},c=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(t,r,s){var a,o;const c=t.topic,u=(a=t.ref)!==null&&a!==void 0?a:"",d=(o=t.join_ref)!==null&&o!==void 0?o:"",h=t.payload.event,m=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},x=Object.keys(m).length===0?"":JSON.stringify(m);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`userEvent length ${h.length} exceeds maximum of 255`);if(x.length>255)throw new Error(`metadata length ${x.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+u.length+c.length+h.length+x.length,v=new ArrayBuffer(this.HEADER_LENGTH+y);let w=new DataView(v),g=0;w.setUint8(g++,this.KINDS.userBroadcastPush),w.setUint8(g++,d.length),w.setUint8(g++,u.length),w.setUint8(g++,c.length),w.setUint8(g++,h.length),w.setUint8(g++,x.length),w.setUint8(g++,r),Array.from(d,b=>w.setUint8(g++,b.charCodeAt(0))),Array.from(u,b=>w.setUint8(g++,b.charCodeAt(0))),Array.from(c,b=>w.setUint8(g++,b.charCodeAt(0))),Array.from(h,b=>w.setUint8(g++,b.charCodeAt(0))),Array.from(x,b=>w.setUint8(g++,b.charCodeAt(0)));var _=new Uint8Array(v.byteLength+s.byteLength);return _.set(new Uint8Array(v),0),_.set(new Uint8Array(s),v.byteLength),_.buffer}decode(t,r){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return r(s)}if(typeof t=="string"){const s=JSON.parse(t),[a,o,c,u,d]=s;return r({join_ref:a,ref:o,topic:c,event:u,payload:d})}return r({})}_binaryDecode(t){const r=new DataView(t),s=r.getUint8(0),a=new TextDecoder;if(s===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,r,a)}_decodeUserBroadcast(t,r,s){const a=r.getUint8(1),o=r.getUint8(2),c=r.getUint8(3),u=r.getUint8(4);let d=this.HEADER_LENGTH+4;const h=s.decode(t.slice(d,d+a));d=d+a;const m=s.decode(t.slice(d,d+o));d=d+o;const x=s.decode(t.slice(d,d+c));d=d+c;const y=t.slice(d,t.byteLength),v=u===this.JSON_ENCODING?JSON.parse(s.decode(y)):y,w={type:this.BROADCAST_EVENT,event:m,payload:v};return c>0&&(w.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([s])=>r.includes(s)))}}class $j{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var qr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(qr||(qr={}));const fS=(e,t,r={})=>{var s;const a=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((o,c)=>(o[c]=Z8(c,e,t,a),o),{}):{}},Z8=(e,t,r,s)=>{const a=t.find(u=>u.name===e),o=a?.type,c=r[e];return o&&!s.includes(o)?Hj(o,c):ry(c)},Hj=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return rR(t,r)}switch(e){case qr.bool:return Q8(t);case qr.float4:case qr.float8:case qr.int2:case qr.int4:case qr.int8:case qr.numeric:case qr.oid:return eR(t);case qr.json:case qr.jsonb:return tR(t);case qr.timestamp:return sR(t);case qr.abstime:case qr.date:case qr.daterange:case qr.int4range:case qr.int8range:case qr.money:case qr.reltime:case qr.text:case qr.time:case qr.timestamptz:case qr.timetz:case qr.tsrange:case qr.tstzrange:return ry(t);default:return ry(t)}},ry=e=>e,Q8=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},eR=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},tR=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},rR=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,s=e[r];if(e[0]==="{"&&s==="}"){let o;const c=e.slice(1,r);try{o=JSON.parse("["+c+"]")}catch{o=c?c.split(","):[]}return o.map(u=>Hj(t,u))}return e},sR=e=>typeof e=="string"?e.replace(" ","T"):e,Wj=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class jx{constructor(t,r,s={},a=ey){this.channel=t,this.event=r,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var hS;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(hS||(hS={}));class rd{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:o,onLeave:c,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=rd.syncState(this.state,a,o,c),this.pendingDiffs.forEach(d=>{this.state=rd.syncDiff(this.state,d,o,c)}),this.pendingDiffs=[],u()}),this.channel._on(s.diff,{},a=>{const{onJoin:o,onLeave:c,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=rd.syncDiff(this.state,a,o,c),u())}),this.onJoin((a,o,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:o,newPresences:c})}),this.onLeave((a,o,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:o,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,a){const o=this.cloneDeep(t),c=this.transformState(r),u={},d={};return this.map(o,(h,m)=>{c[h]||(d[h]=m)}),this.map(c,(h,m)=>{const x=o[h];if(x){const y=m.map(_=>_.presence_ref),v=x.map(_=>_.presence_ref),w=m.filter(_=>v.indexOf(_.presence_ref)<0),g=x.filter(_=>y.indexOf(_.presence_ref)<0);w.length>0&&(u[h]=w),g.length>0&&(d[h]=g)}else u[h]=m}),this.syncDiff(o,{joins:u,leaves:d},s,a)}static syncDiff(t,r,s,a){const{joins:o,leaves:c}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(o,(u,d)=>{var h;const m=(h=t[u])!==null&&h!==void 0?h:[];if(t[u]=this.cloneDeep(d),m.length>0){const x=t[u].map(v=>v.presence_ref),y=m.filter(v=>x.indexOf(v.presence_ref)<0);t[u].unshift(...y)}s(u,m,d)}),this.map(c,(u,d)=>{let h=t[u];if(!h)return;const m=d.map(x=>x.presence_ref);h=h.filter(x=>m.indexOf(x.presence_ref)<0),t[u]=h,a(u,h,d),h.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const a=t[s];return"metas"in a?r[s]=a.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[s]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var mS;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(mS||(mS={}));var sd;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(sd||(sd={}));var li;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(li||(li={}));class vc{constructor(t,r={config:{}},s){var a,o;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=js.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new jx(this,bn.join,this.params,this.timeout),this.rejoinTimer=new $j(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=js.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=js.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=js.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=js.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=js.errored,this.rejoinTimer.scheduleTimeout())}),this._on(bn.reply,{},(c,u)=>{this._trigger(this._replyEventName(u),c)}),this.presence=new rd(this),this.broadcastEndpointURL=Wj(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,a,o;if(this.socket.isConnected()||this.socket.connect(),this.state==js.closed){const{config:{broadcast:c,presence:u,private:d}}=this.params,h=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(v=>v.filter))!==null&&a!==void 0?a:[],m=!!this.bindings[sd.PRESENCE]&&this.bindings[sd.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,x={},y={broadcast:c,presence:Object.assign(Object.assign({},u),{enabled:m}),postgres_changes:h,private:d};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(v=>t?.(li.CHANNEL_ERROR,v)),this._onClose(()=>t?.(li.CLOSED)),this.updateJoinPayload(Object.assign({config:y},x)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:v})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),v===void 0){t?.(li.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,_=(w=g?.length)!==null&&w!==void 0?w:0,b=[];for(let N=0;N<_;N++){const S=g[N],{filter:{event:E,schema:R,table:L,filter:O}}=S,P=v&&v[N];if(P&&P.event===E&&vc.isFilterValueEqual(P.schema,R)&&vc.isFilterValueEqual(P.table,L)&&vc.isFilterValueEqual(P.filter,O))b.push(Object.assign(Object.assign({},S),{id:P.id}));else{this.unsubscribe(),this.state=js.errored,t?.(li.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,t&&t(li.SUBSCRIBED);return}}).receive("error",v=>{this.state=js.errored,t?.(li.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{t?.(li.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===js.joined&&t===sd.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,s)}async httpSend(t,r,s={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=s.timeout)!==null&&a!==void 0?a:this.timeout);if(u.status===202)return{success:!0};let d=u.statusText;try{const h=await u.json();d=h.error||h.message||d}catch{}return Promise.reject(new Error(d))}async send(t,r={}){var s,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:c}=t,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:c,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=h.body)===null||a===void 0?void 0:a.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var c,u,d;const h=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(u=(c=this.params)===null||c===void 0?void 0:c.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.ack)&&o("ok"),h.receive("ok",()=>o("ok")),h.receive("error",()=>o("error")),h.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=js.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(bn.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new jx(this,bn.leave,{},t),s.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=js.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const a=new AbortController,o=setTimeout(()=>a.abort(),s),c=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(o),c}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new jx(this,t,r,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Y8){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var a,o;const c=t.toLocaleLowerCase(),{close:u,error:d,leave:h,join:m}=bn;if(s&&[u,d,h,m].indexOf(c)>=0&&s!==this._joinRef())return;let y=this._onMessage(c,r,s);if(r&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(v=>{var w,g,_;return((w=v.filter)===null||w===void 0?void 0:w.event)==="*"||((_=(g=v.filter)===null||g===void 0?void 0:g.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===c}).map(v=>v.callback(y,s)):(o=this.bindings[c])===null||o===void 0||o.filter(v=>{var w,g,_,b,N,S,E,R;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in v){const L=v.id,O=(w=v.filter)===null||w===void 0?void 0:w.event;return L&&((g=r.ids)===null||g===void 0?void 0:g.includes(L))&&(O==="*"||O?.toLocaleLowerCase()===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))&&(!(!((b=v.filter)===null||b===void 0)&&b.table)||v.filter.table===((N=r.data)===null||N===void 0?void 0:N.table))}else{const L=(E=(S=v?.filter)===null||S===void 0?void 0:S.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return L==="*"||L===((R=r?.event)===null||R===void 0?void 0:R.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===c}).map(v=>{if(typeof y=="object"&&"ids"in y){const w=y.data,{schema:g,table:_,commit_timestamp:b,type:N,errors:S}=w;y=Object.assign(Object.assign({},{schema:g,table:_,commit_timestamp:b,eventType:N,new:{},old:{},errors:S}),this._getPayloadRecords(w))}v.callback(y,s)})}_isClosed(){return this.state===js.closed}_isJoined(){return this.state===js.joined}_isJoining(){return this.state===js.joining}_isLeaving(){return this.state===js.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const a=t.toLocaleLowerCase(),o={type:a,filter:r,callback:s};return this.bindings[a]?this.bindings[a].push(o):this.bindings[a]=[o],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var o;return!(((o=a.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===s&&vc.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(bn.close,{},t)}_onError(t){this._on(bn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=js.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=fS(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=fS(t.columns,t.old_record)),r}}const Tx=()=>{},wh={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},aR=[1e3,2e3,5e3,1e4],nR=1e4,iR=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class oR{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ey,this.transport=null,this.heartbeatIntervalMs=wh.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Tx,this.ref=0,this.reconnectTimer=null,this.vsn=dS,this.logger=Tx,this.conn=null,this.sendBuffer=[],this.serializer=new J8,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...o)=>a(...o):(...o)=>fetch(...o),!(!((s=r?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${ty.websocket}`,this.httpEndpoint=Wj(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=W8.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Qi.connecting:return $o.Connecting;case Qi.open:return $o.Open;case Qi.closing:return $o.Closing;default:return $o.Closed}}isConnected(){return this.connectionState()===$o.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,a=this.getChannels().find(o=>o.topic===s);if(a)return a;{const o=new vc(`realtime:${t}`,r,this);return this.channels.push(o),o}}push(t){const{topic:r,event:s,payload:a,ref:o}=t,c=()=>{this.encode(t,u=>{var d;(d=this.conn)===null||d===void 0||d.send(u)})};this.log("push",`${r} ${s} (${o})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(X8,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},wh.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const h=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",h)}catch(m){this.log("error","error in heartbeat callback",m)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:a,payload:o,ref:c}=r,u=c?`(${c})`:"",d=o.status||"";this.log("receive",`${d} ${s} ${a} ${u}`.trim(),o),this.channels.filter(h=>h._isMember(s)).forEach(h=>h._trigger(a,o,c)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Qi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Qi.open||this.conn.readyState===Qi.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(bn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${s}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([iR],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,s=!1;if(t)r=t,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const o={access_token:r,version:V8};r&&a.updateJoinPayload(o),a.joinedOnce&&a._isJoined()&&a._push(bn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new $j(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},wh.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,a,o,c,u,d,h,m,x,y,v;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t?.timeout)!==null&&s!==void 0?s:ey,this.heartbeatIntervalMs=(a=t?.heartbeatIntervalMs)!==null&&a!==void 0?a:wh.HEARTBEAT_INTERVAL,this.worker=(o=t?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(c=t?.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:Tx,this.vsn=(d=t?.vsn)!==null&&d!==void 0?d:dS,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=t?.reconnectAfterMs)!==null&&h!==void 0?h:(w=>aR[w-1]||nR),this.vsn){case qj:this.encode=(m=t?.encode)!==null&&m!==void 0?m:((w,g)=>g(JSON.stringify(w))),this.decode=(x=t?.decode)!==null&&x!==void 0?x:((w,g)=>g(JSON.parse(w)));break;case K8:this.encode=(y=t?.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(v=t?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var pd=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function lR(e,t,r){const s=new URL(t,e);if(r)for(const[a,o]of Object.entries(r))o!==void 0&&s.searchParams.set(a,o);return s.toString()}async function cR(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function uR(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:a,body:o,headers:c}){const u=lR(e.baseUrl,s,a),d=await cR(e.auth),h=await t(u,{method:r,headers:{...o?{"Content-Type":"application/json"}:{},...d,...c},body:o?JSON.stringify(o):void 0}),m=await h.text(),x=(h.headers.get("content-type")||"").includes("application/json"),y=x&&m?JSON.parse(m):m;if(!h.ok){const v=x?y:void 0,w=v?.error;throw new pd(w?.message??`Request failed with status ${h.status}`,{status:h.status,icebergType:w?.type,icebergCode:w?.code,details:v})}return{status:h.status,headers:h.headers,data:y}}}}function bh(e){return e.join("")}var dR=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:bh(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${bh(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bh(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${bh(e.namespace)}`}),!0}catch(t){if(t instanceof pd&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof pd&&r.status===409)return;throw r}}};function rc(e){return e.join("")}var fR=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${rc(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${rc(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${rc(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${rc(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${rc(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${rc(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof pd&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof pd&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},hR=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=uR({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new dR(this.client,t),this.tableOps=new fR(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},z0=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Jr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var mR=class extends z0{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},sy=class extends z0{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const Wy=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),pR=()=>Response,ay=e=>{if(Array.isArray(e))return e.map(r=>ay(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,s])=>{const a=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[a]=ay(s)}),t},xR=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},gR=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function xd(e){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xd(e)}function yR(e,t){if(xd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(xd(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vR(e){var t=yR(e,"string");return xd(t)=="symbol"?t:t+""}function wR(e,t,r){return(t=vR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Wt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pS(Object(r),!0).forEach(function(s){wR(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pS(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const Ax=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},bR=async(e,t,r)=>{e instanceof await pR()&&!r?.noResolveJson?e.json().then(s=>{const a=e.status||500,o=s?.statusCode||a+"";t(new mR(Ax(s),a,o))}).catch(s=>{t(new sy(Ax(s),s))}):t(new sy(Ax(e),e))},_R=(e,t,r,s)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"||!s?a:(xR(s)?(a.headers=Wt({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(s)):a.body=s,t?.duplex&&(a.duplex=t.duplex),Wt(Wt({},a),r))};async function Hd(e,t,r,s,a,o){return new Promise((c,u)=>{e(r,_R(t,s,a,o)).then(d=>{if(!d.ok)throw d;return s?.noResolveJson?d:d.json()}).then(d=>c(d)).catch(d=>bR(d,u,s))})}async function gd(e,t,r,s){return Hd(e,"GET",t,r,s)}async function wn(e,t,r,s,a){return Hd(e,"POST",t,s,a,r)}async function ny(e,t,r,s,a){return Hd(e,"PUT",t,s,a,r)}async function SR(e,t,r,s){return Hd(e,"HEAD",t,Wt(Wt({},r),{},{noResolveJson:!0}),s)}async function Gy(e,t,r,s,a){return Hd(e,"DELETE",t,s,a,r)}var kR=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Jr(t))return{data:null,error:t};throw t}}};let Gj;Gj=Symbol.toStringTag;var NR=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Gj]="BlobDownloadBuilder",this.promise=null}asStream(){return new kR(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Jr(t))return{data:null,error:t};throw t}}};const ER={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},xS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var jR=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=Wy(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,s){var a=this;try{let o;const c=Wt(Wt({},xS),s);let u=Wt(Wt({},a.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const d=c.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",c.cacheControl),d&&o.append("metadata",a.encodeMetadata(d)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.has("cacheControl")||o.append("cacheControl",c.cacheControl),d&&!o.has("metadata")&&o.append("metadata",a.encodeMetadata(d))):(o=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType,d&&(u["x-metadata"]=a.toBase64(a.encodeMetadata(d))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!c.duplex&&(c.duplex="half")),s?.headers&&(u=Wt(Wt({},u),s.headers));const h=a._removeEmptyFolders(t),m=a._getFinalPath(h),x=await(e=="PUT"?ny:wn)(a.fetch,`${a.url}/object/${m}`,o,Wt({headers:u},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:h,id:x.Id,fullPath:x.Key},error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(Jr(o))return{data:null,error:o};throw o}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,s){var a=this;const o=a._removeEmptyFolders(e),c=a._getFinalPath(o),u=new URL(a.url+`/object/upload/sign/${c}`);u.searchParams.set("token",t);try{let d;const h=Wt({upsert:xS.upsert},s),m=Wt(Wt({},a.headers),{"x-upsert":String(h.upsert)});return typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",h.cacheControl)):(d=r,m["cache-control"]=`max-age=${h.cacheControl}`,m["content-type"]=h.contentType),{data:{path:o,fullPath:(await ny(a.fetch,u.toString(),d,{headers:m})).Key},error:null}}catch(d){if(a.shouldThrowOnError)throw d;if(Jr(d))return{data:null,error:d};throw d}}async createSignedUploadUrl(e,t){var r=this;try{let s=r._getFinalPath(e);const a=Wt({},r.headers);t?.upsert&&(a["x-upsert"]="true");const o=await wn(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:a}),c=new URL(r.url+o.url),u=c.searchParams.get("token");if(!u)throw new z0("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:u},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Jr(s))return{data:null,error:s};throw s}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var s=this;try{return{data:await wn(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:s.headers}),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Jr(a))return{data:null,error:a};throw a}}async copy(e,t,r){var s=this;try{return{data:{path:(await wn(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:s.headers})).Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Jr(a))return{data:null,error:a};throw a}}async createSignedUrl(e,t,r){var s=this;try{let a=s._getFinalPath(e),o=await wn(s.fetch,`${s.url}/object/sign/${a}`,Wt({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:s.headers});const c=r?.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${s.url}${o.signedURL}${c}`)},{data:o,error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Jr(a))return{data:null,error:a};throw a}}async createSignedUrls(e,t,r){var s=this;try{const a=await wn(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:t,paths:e},{headers:s.headers}),o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(c=>Wt(Wt({},c),{},{signedUrl:c.signedURL?encodeURI(`${s.url}${c.signedURL}${o}`):null})),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Jr(a))return{data:null,error:a};throw a}}download(e,t){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(t?.transform||{}),a=s?`?${s}`:"",o=this._getFinalPath(e),c=()=>gd(this.fetch,`${this.url}/${r}/${o}${a}`,{headers:this.headers,noResolveJson:!0});return new NR(c,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:ay(await gd(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Jr(s))return{data:null,error:s};throw s}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await SR(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Jr(s)&&s instanceof sy){const a=s.originalError;if([400,404].includes(a?.status))return{data:!1,error:s}}throw s}}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&s.push(a);const o=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${u}`)}}}async remove(e){var t=this;try{return{data:await Gy(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jr(r))return{data:null,error:r};throw r}}async list(e,t,r){var s=this;try{const a=Wt(Wt(Wt({},ER),t),{},{prefix:e||""});return{data:await wn(s.fetch,`${s.url}/object/list/${s.bucketId}`,a,{headers:s.headers},r),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Jr(a))return{data:null,error:a};throw a}}async listV2(e,t){var r=this;try{const s=Wt({},e);return{data:await wn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},t),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Jr(s))return{data:null,error:s};throw s}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const Vj="2.90.1",Kj={"X-Client-Info":`storage-js/${Vj}`};var TR=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const a=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Wt(Wt({},Kj),t),this.fetch=Wy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await gd(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await gd(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jr(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await wn(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Jr(s))return{data:null,error:s};throw s}}async updateBucket(e,t){var r=this;try{return{data:await ny(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Jr(s))return{data:null,error:s};throw s}}async emptyBucket(e){var t=this;try{return{data:await wn(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Gy(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jr(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},AR=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Wt(Wt({},Kj),t),this.fetch=Wy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await wn(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jr(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const s=r.toString(),a=s?`${t.url}/bucket?${s}`:`${t.url}/bucket`;return{data:await gd(t.fetch,a,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Gy(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Jr(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!gR(e))throw new z0("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new hR({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(a,o){const c=a[o];return typeof c!="function"?c:async(...u)=>{try{return{data:await c.apply(a,u),error:null}}catch(d){if(s)throw d;return{data:null,error:d}}}}})}};const Vy={"X-Client-Info":`storage-js/${Vj}`,"Content-Type":"application/json"};var Xj=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ma(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var Cx=class extends Xj{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},CR=class extends Xj{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const Ky=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),RR=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},gS=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),DR=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const s=e.status||500,a=e;if(typeof a.json=="function")a.json().then(o=>{const c=o?.statusCode||o?.code||s+"";t(new Cx(gS(o),s,c))}).catch(()=>{const o=s+"";t(new Cx(a.statusText||`HTTP ${s} error`,s,o))});else{const o=s+"";t(new Cx(a.statusText||`HTTP ${s} error`,s,o))}}else t(new CR(gS(e),e))},OR=(e,t,r,s)=>{const a={method:e,headers:t?.headers||{}};return s?(RR(s)?(a.headers=Wt({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(s)):a.body=s,Wt(Wt({},a),r)):a};async function FR(e,t,r,s,a,o){return new Promise((c,u)=>{e(r,OR(t,s,a,o)).then(d=>{if(!d.ok)throw d;if(s?.noResolveJson)return d;const h=d.headers.get("content-type");return!h||!h.includes("application/json")?{}:d.json()}).then(d=>c(d)).catch(d=>DR(d,u,s))})}async function Pa(e,t,r,s,a){return FR(e,"POST",t,s,a,r)}var LR=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Wt(Wt({},Vy),t),this.fetch=Ky(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ma(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Pa(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ma(s))return{data:null,error:s};throw s}}async listIndexes(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ma(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Pa(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ma(s))return{data:null,error:s};throw s}}},IR=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Wt(Wt({},Vy),t),this.fetch=Ky(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Pa(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ma(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ma(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Pa(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ma(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ma(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Pa(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ma(r))return{data:null,error:r};throw r}}},MR=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Wt(Wt({},Vy),t),this.fetch=Ky(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ma(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ma(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ma(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Pa(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ma(r))return{data:null,error:r};throw r}}},PR=class extends MR{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new BR(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},BR=class extends LR{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new UR(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},UR=class extends IR{constructor(e,t,r,s,a){super(e,t,a),this.vectorBucketName=r,this.indexName=s}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Wt(Wt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},zR=class extends TR{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new jR(this.url,this.headers,e,this.fetch)}get vectors(){return new PR(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new AR(this.url+"/iceberg",this.headers,this.fetch)}};const Yj="2.90.1",pc=30*1e3,iy=3,Rx=iy*pc,qR="http://localhost:9999",$R="supabase.auth.token",HR={"X-Client-Info":`gotrue-js/${Yj}`},oy="X-Supabase-Api-Version",Jj={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},WR=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,GR=600*1e3;class yd extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function Mt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class VR extends yd{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function KR(e){return Mt(e)&&e.name==="AuthApiError"}class Ho extends yd{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class bi extends yd{constructor(t,r,s,a){super(t,s,a),this.name=r,this.status=s}}class Fa extends bi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function XR(e){return Mt(e)&&e.name==="AuthSessionMissingError"}class sc extends bi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class _h extends bi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Sh extends bi{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function YR(e){return Mt(e)&&e.name==="AuthImplicitGrantRedirectError"}class yS extends bi{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class JR extends bi{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class ly extends bi{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Dx(e){return Mt(e)&&e.name==="AuthRetryableFetchError"}class vS extends bi{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class cy extends bi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const p0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),wS=` 	
\r=`.split(""),ZR=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<wS.length;t+=1)e[wS[t].charCodeAt(0)]=-2;for(let t=0;t<p0.length;t+=1)e[p0[t].charCodeAt(0)]=t;return e})();function bS(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(p0[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(p0[s]),t.queuedBits-=6}}function Zj(e,t,r){const s=ZR[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function _S(e){const t=[],r=c=>{t.push(String.fromCodePoint(c))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},o=c=>{tD(c,s,r)};for(let c=0;c<e.length;c+=1)Zj(e.charCodeAt(c),a,o);return t.join("")}function QR(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function eD(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}QR(s,t)}}function tD(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let s=1;s<6;s+=1)if((e>>7-s&1)===0){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function _c(e){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Zj(e.charCodeAt(a),r,s);return new Uint8Array(t)}function rD(e){const t=[];return eD(e,r=>t.push(r)),new Uint8Array(t)}function Vo(e){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};return e.forEach(a=>bS(a,r,s)),bS(null,r,s),t.join("")}function sD(e){return Math.round(Date.now()/1e3)+e}function aD(){return Symbol("auth-callback")}const qs=()=>typeof window<"u"&&typeof document<"u",Fo={tested:!1,writable:!1},Qj=()=>{if(!qs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Fo.tested)return Fo.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Fo.tested=!0,Fo.writable=!0}catch{Fo.tested=!0,Fo.writable=!1}return Fo.writable};function nD(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,o)=>{t[o]=a})}catch{}return r.searchParams.forEach((s,a)=>{t[a]=s}),t}const e4=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),iD=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",xc=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Lo=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},zs=async(e,t)=>{await e.removeItem(t)};class q0{constructor(){this.promise=new q0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}q0.promiseConstructor=Promise;function Ox(e){const t=e.split(".");if(t.length!==3)throw new cy("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!WR.test(t[s]))throw new cy("JWT not in base64url format");return{header:JSON.parse(_S(t[0])),payload:JSON.parse(_S(t[1])),signature:_c(t[2]),raw:{header:t[0],payload:t[1]}}}async function oD(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function lD(e,t){return new Promise((s,a)=>{(async()=>{for(let o=0;o<1/0;o++)try{const c=await e(o);if(!t(o,null,c)){s(c);return}}catch(c){if(!t(o,c)){a(c);return}}})()})}function cD(e){return("0"+e.toString(16)).substr(-2)}function uD(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let a="";for(let o=0;o<56;o++)a+=r.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(t),Array.from(t,cD).join("")}async function dD(e){const r=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(s);return Array.from(a).map(o=>String.fromCharCode(o)).join("")}async function fD(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await dD(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ac(e,t,r=!1){const s=uD();let a=s;r&&(a+="/PASSWORD_RECOVERY"),await xc(e,`${t}-code-verifier`,a);const o=await fD(s);return[o,s===o?"plain":"s256"]}const hD=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function mD(e){const t=e.headers.get(oy);if(!t||!t.match(hD))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function pD(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function xD(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const gD=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function nc(e){if(!gD.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Fx(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function yD(e,t){return new Proxy(e,{get:(r,s,a)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const o=s.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,a)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,s,a)}})}function SS(e){return JSON.parse(JSON.stringify(e))}const qo=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),vD=[502,503,504];async function kS(e){var t;if(!iD(e))throw new ly(qo(e),0);if(vD.includes(e.status))throw new ly(qo(e),e.status);let r;try{r=await e.json()}catch(o){throw new Ho(qo(o),o)}let s;const a=mD(e);if(a&&a.getTime()>=Jj["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new vS(qo(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new Fa}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,c)=>o&&typeof c=="string",!0))throw new vS(qo(r),e.status,r.weak_password.reasons);throw new VR(qo(r),e.status||500,s)}const wD=(e,t,r,s)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),r))};async function Ht(e,t,r,s){var a;const o=Object.assign({},s?.headers);o[oy]||(o[oy]=Jj["2024-01-01"].name),s?.jwt&&(o.Authorization=`Bearer ${s.jwt}`);const c=(a=s?.query)!==null&&a!==void 0?a:{};s?.redirectTo&&(c.redirect_to=s.redirectTo);const u=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",d=await bD(e,t,r+u,{headers:o,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(d):{data:Object.assign({},d),error:null}}async function bD(e,t,r,s,a,o){const c=wD(t,s,a,o);let u;try{u=await e(r,Object.assign({},c))}catch(d){throw console.error(d),new ly(qo(d),0)}if(u.ok||await kS(u),s?.noResolveJson)return u;try{return await u.json()}catch(d){await kS(d)}}function vn(e){var t;let r=null;kD(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=sD(e.expires_in)));const s=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:s},error:null}}function NS(e){const t=vn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=e.weak_password),t}function eo(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function _D(e){return{data:e,error:null}}function SD(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:o}=e,c=U0(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:o},d=Object.assign({},c);return{data:{properties:u,user:d},error:null}}function ES(e){return e}function kD(e){return e.access_token&&e.refresh_token&&e.expires_in}const Lx=["global","local","others"];class ND{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=e4(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Lx[0]){if(Lx.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Lx.join(", ")}`);try{return await Ht(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Mt(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await Ht(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:eo})}catch(s){if(Mt(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=U0(t,["options"]),a=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(a.new_email=s?.newEmail,delete a.newEmail),await Ht(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:SD,redirectTo:r?.redirectTo})}catch(r){if(Mt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ht(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:eo})}catch(r){if(Mt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,a,o,c,u,d;try{const h={nextPage:null,lastPage:0,total:0},m=await Ht(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(o=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:ES});if(m.error)throw m.error;const x=await m.json(),y=(c=m.headers.get("x-total-count"))!==null&&c!==void 0?c:0,v=(d=(u=m.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return v.length>0&&(v.forEach(w=>{const g=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(w.split(";")[1].split("=")[1]);h[`${_}Page`]=g}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},x),h),error:null}}catch(h){if(Mt(h))return{data:{users:[]},error:h};throw h}}async getUserById(t){nc(t);try{return await Ht(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:eo})}catch(r){if(Mt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){nc(t);try{return await Ht(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:eo})}catch(s){if(Mt(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){nc(t);try{return await Ht(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:eo})}catch(s){if(Mt(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){nc(t.userId);try{const{data:r,error:s}=await Ht(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:s}}catch(r){if(Mt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){nc(t.userId),nc(t.id);try{return{data:await Ht(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Mt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,a,o,c,u,d;try{const h={nextPage:null,lastPage:0,total:0},m=await Ht(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(o=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:ES});if(m.error)throw m.error;const x=await m.json(),y=(c=m.headers.get("x-total-count"))!==null&&c!==void 0?c:0,v=(d=(u=m.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return v.length>0&&(v.forEach(w=>{const g=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(w.split(";")[1].split("=")[1]);h[`${_}Page`]=g}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},x),h),error:null}}catch(h){if(Mt(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(t){try{return await Ht(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Mt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ht(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Mt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ht(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Mt(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await Ht(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Mt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ht(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Mt(r))return{data:null,error:r};throw r}}}function jS(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const ic={debug:!!(globalThis&&Qj()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class t4 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class ED extends t4{}async function jD(e,t,r){ic.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),ic.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){ic.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{ic.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw ic.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new ED(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ic.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function TD(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function r4(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function AD(e){return parseInt(e,16)}function CD(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function RD(e){var t;const{chainId:r,domain:s,expirationTime:a,issuedAt:o=new Date,nonce:c,notBefore:u,requestId:d,resources:h,scheme:m,uri:x,version:y}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const v=r4(e.address),w=m?`${m}://${s}`:s,g=e.statement?`${e.statement}
`:"",_=`${w} wants you to sign in with your Ethereum account:
${v}

${g}`;let b=`URI: ${x}
Version: ${y}
Chain ID: ${r}${c?`
Nonce: ${c}`:""}
Issued At: ${o.toISOString()}`;if(a&&(b+=`
Expiration Time: ${a.toISOString()}`),u&&(b+=`
Not Before: ${u.toISOString()}`),d&&(b+=`
Request ID: ${d}`),h){let N=`
Resources:`;for(const S of h){if(!S||typeof S!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${S}`);N+=`
- ${S}`}b+=N}return`${_}
${b}`}class ks extends Error{constructor({message:t,code:r,cause:s,name:a}){var o;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(o=a??(s instanceof Error?s.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=r}}class x0 extends ks{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function DD({error:e,options:t}){var r,s,a;const{publicKey:o}=t;if(!o)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ks({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new ks({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new ks({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=o.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new ks({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new ks({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new ks({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return o.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new ks({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new ks({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const c=window.location.hostname;if(s4(c)){if(o.rp.id!==c)return new ks({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new ks({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new ks({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new ks({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new ks({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function OD({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ks({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new ks({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(s4(s)){if(r.rpId!==s)return new ks({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new ks({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new ks({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new ks({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class FD{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const LD=new FD;function ID(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,a=U0(e,["challenge","user","excludeCredentials"]),o=_c(t).buffer,c=Object.assign(Object.assign({},r),{id:_c(r.id).buffer}),u=Object.assign(Object.assign({},a),{challenge:o,user:c});if(s&&s.length>0){u.excludeCredentials=new Array(s.length);for(let d=0;d<s.length;d++){const h=s[d];u.excludeCredentials[d]=Object.assign(Object.assign({},h),{id:_c(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return u}function MD(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=U0(e,["challenge","allowCredentials"]),a=_c(t).buffer,o=Object.assign(Object.assign({},s),{challenge:a});if(r&&r.length>0){o.allowCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const u=r[c];o.allowCredentials[c]=Object.assign(Object.assign({},u),{id:_c(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function PD(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Vo(new Uint8Array(e.response.attestationObject)),clientDataJSON:Vo(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function BD(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,s=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Vo(new Uint8Array(a.authenticatorData)),clientDataJSON:Vo(new Uint8Array(a.clientDataJSON)),signature:Vo(new Uint8Array(a.signature)),userHandle:a.userHandle?Vo(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function s4(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function TS(){var e,t;return!!(qs()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function UD(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new x0("Browser returned unexpected credential type",t)}:{data:null,error:new x0("Empty credential response",t)}}catch(t){return{data:null,error:DD({error:t,options:e})}}}async function zD(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new x0("Browser returned unexpected credential type",t)}:{data:null,error:new x0("Empty credential response",t)}}catch(t){return{data:null,error:OD({error:t,options:e})}}}const qD={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},$D={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function g0(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),s={};for(const a of e)if(a)for(const o in a){const c=a[o];if(c!==void 0)if(Array.isArray(c))s[o]=c;else if(r(c))s[o]=c;else if(t(c)){const u=s[o];t(u)?s[o]=g0(u,c):s[o]=g0(c)}else s[o]=c}return s}function HD(e,t){return g0(qD,e,t||{})}function WD(e,t){return g0($D,e,t||{})}class GD{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:a},o){try{const{data:c,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!c)return{data:null,error:u};const d=a??LD.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:h}=c.webauthn.credential_options.publicKey;h.name||(h.name=`${h.id}:${s}`),h.displayName||(h.displayName=h.name)}switch(c.webauthn.type){case"create":{const h=HD(c.webauthn.credential_options.publicKey,o?.create),{data:m,error:x}=await UD({publicKey:h,signal:d});return m?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:m}},error:null}:{data:null,error:x}}case"request":{const h=WD(c.webauthn.credential_options.publicKey,o?.request),{data:m,error:x}=await zD(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:h,signal:d}));return m?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:m}},error:null}:{data:null,error:x}}}}catch(c){return Mt(c)?{data:null,error:c}:{data:null,error:new Ho("Unexpected error in challenge",c)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},o){if(!r)return{data:null,error:new yd("rpId is required for WebAuthn authentication")};try{if(!TS())return{data:null,error:new Ho("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:a},{request:o});if(!c)return{data:null,error:u};const{webauthn:d}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:d.type,rpId:r,rpOrigins:s,credential_response:d.credential_response}})}catch(c){return Mt(c)?{data:null,error:c}:{data:null,error:new Ho("Unexpected error in authenticate",c)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},o){if(!r)return{data:null,error:new yd("rpId is required for WebAuthn registration")};try{if(!TS())return{data:null,error:new Ho("Browser does not support WebAuthn",null)};const{data:c,error:u}=await this._enroll({friendlyName:t});if(!c)return await this.client.mfa.listFactors().then(m=>{var x;return(x=m.data)===null||x===void 0?void 0:x.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===t&&y.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m?.id}):void 0),{data:null,error:u};const{data:d,error:h}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:a},{create:o});return d?this._verify({factorId:c.id,challengeId:d.challengeId,webauthn:{rpId:r,rpOrigins:s,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:h}}catch(c){return Mt(c)?{data:null,error:c}:{data:null,error:new Ho("Unexpected error in register",c)}}}}TD();const VD={url:qR,storageKey:$R,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:HR,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function AS(e,t,r){return await r()}const oc={};class vd{get jwks(){var t,r;return(r=(t=oc[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){oc[this.storageKey]=Object.assign(Object.assign({},oc[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=oc[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){oc[this.storageKey]=Object.assign(Object.assign({},oc[this.storageKey]),{cachedAt:t})}constructor(t){var r,s,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},VD),t);if(this.storageKey=o.storageKey,this.instanceID=(r=vd.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,vd.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&qs()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new ND({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=e4(o.fetch),this.lock=o.lock||AS,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,this.lockAcquireTimeout=o.lockAcquireTimeout,o.lock?this.lock=o.lock:this.persistSession&&qs()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=jD:this.lock=AS,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new GD(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Qj()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=jS(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=jS(this.memoryStorage)),qs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Yj}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},s="none";if(qs()&&(r=nD(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),qs()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:o}=await this._getSessionFromURL(r,s);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),YR(o)){const d=(t=o.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:o}}return{error:o}}const{session:c,redirectType:u}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",u),await this._saveSession(c),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Mt(r)?this._returnResult({error:r}):this._returnResult({error:new Ho("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,a;try{const o=await Ht(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=t?.options)===null||a===void 0?void 0:a.captchaToken}},xform:vn}),{data:c,error:u}=o;if(u||!c)return this._returnResult({data:{user:null,session:null},error:u});const d=c.session,h=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(o){if(Mt(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(t){var r,s,a;try{let o;if("email"in t){const{email:m,password:x,options:y}=t;let v=null,w=null;this.flowType==="pkce"&&([v,w]=await ac(this.storage,this.storageKey)),o=await Ht(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:m,password:x,data:(r=y?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:v,code_challenge_method:w},xform:vn})}else if("phone"in t){const{phone:m,password:x,options:y}=t;o=await Ht(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:x,data:(s=y?.data)!==null&&s!==void 0?s:{},channel:(a=y?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:vn})}else throw new _h("You must provide either an email or phone number and a password");const{data:c,error:u}=o;if(u||!c)return await zs(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const d=c.session,h=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(o){if(await zs(this.storage,`${this.storageKey}-code-verifier`),Mt(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(t){try{let r;if("email"in t){const{email:o,password:c,options:u}=t;r=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:NS})}else if("phone"in t){const{phone:o,password:c,options:u}=t;r=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:c,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:NS})}else throw new _h("You must provide either an email or phone number and a password");const{data:s,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!s||!s.session||!s.user){const o=new sc;return this._returnResult({data:{user:null,session:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(r){if(Mt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,s,a,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,a,o,c,u,d,h,m,x,y;let v,w;if("message"in t)v=t.message,w=t.signature;else{const{chain:g,wallet:_,statement:b,options:N}=t;let S;if(qs())if(typeof _=="object")S=_;else{const F=window;if("ethereum"in F&&typeof F.ethereum=="object"&&"request"in F.ethereum&&typeof F.ethereum.request=="function")S=F.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!N?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=_}const E=new URL((r=N?.url)!==null&&r!==void 0?r:window.location.href),R=await S.request({method:"eth_requestAccounts"}).then(F=>F).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!R||R.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=r4(R[0]);let O=(s=N?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!O){const F=await S.request({method:"eth_chainId"});O=AD(F)}const P={domain:E.host,address:L,statement:b,uri:E.href,version:"1",chainId:O,nonce:(a=N?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(c=(o=N?.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(u=N?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(d=N?.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(h=N?.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(m=N?.signInWithEthereum)===null||m===void 0?void 0:m.resources};v=RD(P),w=await S.request({method:"personal_sign",params:[CD(v),L]})}try{const{data:g,error:_}=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:w},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:vn});if(_)throw _;if(!g||!g.session||!g.user){const b=new sc;return this._returnResult({data:{user:null,session:null},error:b})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:_})}catch(g){if(Mt(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(t){var r,s,a,o,c,u,d,h,m,x,y,v;let w,g;if("message"in t)w=t.message,g=t.signature;else{const{chain:_,wallet:b,statement:N,options:S}=t;let E;if(qs())if(typeof b=="object")E=b;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))E=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!S?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=b}const R=new URL((r=S?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in E&&E.signIn){const L=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S?.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),N?{statement:N}:null));let O;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")O=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)O=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)w=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),g=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${R.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(a=(s=S?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((o=S?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((c=S?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((u=S?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((d=S?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((h=S?.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((x=(m=S?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||x===void 0)&&x.length?["Resources",...S.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const L=await E.signMessage(new TextEncoder().encode(w),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=L}}try{const{data:_,error:b}=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Vo(g)},!((y=t.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:vn});if(b)throw b;if(!_||!_.session||!_.user){const N=new sc;return this._returnResult({data:{user:null,session:null},error:N})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:b})}catch(_){if(Mt(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async _exchangeCodeForSession(t){const r=await Lo(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new JR;const{data:o,error:c}=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:vn});if(await zs(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!o||!o.session||!o.user){const u=new sc;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:a??null}),error:c})}catch(o){if(await zs(this.storage,`${this.storageKey}-code-verifier`),Mt(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(t){try{const{options:r,provider:s,token:a,access_token:o,nonce:c}=t,u=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:o,nonce:c,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:vn}),{data:d,error:h}=u;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!d||!d.session||!d.user){const m=new sc;return this._returnResult({data:{user:null,session:null},error:m})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:h})}catch(r){if(Mt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,s,a,o,c;try{if("email"in t){const{email:u,options:d}=t;let h=null,m=null;this.flowType==="pkce"&&([h,m]=await ac(this.storage,this.storageKey));const{error:x}=await Ht(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=d?.data)!==null&&r!==void 0?r:{},create_user:(s=d?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:h,code_challenge_method:m},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in t){const{phone:u,options:d}=t,{data:h,error:m}=await Ht(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(a=d?.data)!==null&&a!==void 0?a:{},create_user:(o=d?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(c=d?.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:m})}throw new _h("You must provide either an email or phone number.")}catch(u){if(await zs(this.storage,`${this.storageKey}-code-verifier`),Mt(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var r,s;try{let a,o;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,o=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:c,error:u}=await Ht(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:a,xform:vn});if(u)throw u;if(!c)throw new Error("An error occurred on token verification.");const d=c.session,h=c.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:h,session:d},error:null})}catch(a){if(Mt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,s,a,o,c;try{let u=null,d=null;this.flowType==="pkce"&&([u,d]=await ac(this.storage,this.storageKey));const h=await Ht(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=t?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:d}),headers:this.headers,xform:_D});return!((o=h.data)===null||o===void 0)&&o.url&&qs()&&!(!((c=t.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(u){if(await zs(this.storage,`${this.storageKey}-code-verifier`),Mt(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new Fa;const{error:a}=await Ht(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(Mt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:a,options:o}=t,{error:c}=await Ht(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in t){const{phone:s,type:a,options:o}=t,{data:c,error:u}=await Ht(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:u})}throw new _h("You must provide either an email or phone number and a type")}catch(r){if(Mt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Lo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<Rx:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const c=await Lo(this.userStorage,this.storageKey+"-user");c?.user?t.user=c.user:t.user=Fx()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};t.user=yD(t.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:o}=await this._callRefreshToken(t.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Ht(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:eo}):await this._useSession(async r=>{var s,a,o;const{data:c,error:u}=r;if(u)throw u;return!(!((s=c.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Fa}:await Ht(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&o!==void 0?o:void 0,xform:eo})})}catch(r){if(Mt(r))return XR(r)&&(await this._removeSession(),await zs(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:a,error:o}=s;if(o)throw o;if(!a.session)throw new Fa;const c=a.session;let u=null,d=null;this.flowType==="pkce"&&t.email!=null&&([u,d]=await ac(this.storage,this.storageKey));const{data:h,error:m}=await Ht(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:d}),jwt:c.access_token,xform:eo});if(m)throw m;return c.user=h.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(s){if(await zs(this.storage,`${this.storageKey}-code-verifier`),Mt(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Fa;const r=Date.now()/1e3;let s=r,a=!0,o=null;const{payload:c}=Ox(t.access_token);if(c.exp&&(s=c.exp,a=s<=r),a){const{data:u,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!u)return{data:{user:null,session:null},error:null};o=u}else{const{data:u,error:d}=await this._getUser(t.access_token);if(d)throw d;o={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(r){if(Mt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:c,error:u}=r;if(u)throw u;t=(s=c.session)!==null&&s!==void 0?s:void 0}if(!t?.refresh_token)throw new Fa;const{data:a,error:o}=await this._callRefreshToken(t.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Mt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!qs())throw new Sh("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Sh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new yS("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Sh("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new yS("No code detected.");const{data:N,error:S}=await this._exchangeCodeForSession(t.code);if(S)throw S;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:o,refresh_token:c,expires_in:u,expires_at:d,token_type:h}=t;if(!o||!u||!c||!h)throw new Sh("No session defined in URL");const m=Math.round(Date.now()/1e3),x=parseInt(u);let y=m+x;d&&(y=parseInt(d));const v=y-m;v*1e3<=pc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${x}s`);const w=y-x;m-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,y,m):m-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,y,m);const{data:g,error:_}=await this._getUser(o);if(_)throw _;const b={provider_token:s,provider_refresh_token:a,access_token:o,expires_in:x,expires_at:y,refresh_token:c,token_type:h,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:b,redirectType:t.type},error:null})}catch(s){if(Mt(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Lo(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:a,error:o}=r;if(o)return this._returnResult({error:o});const c=(s=a.session)===null||s===void 0?void 0:s.access_token;if(c){const{error:u}=await this.admin.signOut(c,t);if(u&&!(KR(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await zs(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=aD(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,a;try{const{data:{session:o},error:c}=r;if(c)throw c;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,r={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await ac(this.storage,this.storageKey,!0));try{return await Ht(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(await zs(this.storage,`${this.storageKey}-code-verifier`),Mt(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:a}=await this._useSession(async o=>{var c,u,d,h,m;const{data:x,error:y}=o;if(y)throw y;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(c=t.options)===null||c===void 0?void 0:c.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Ht(this.fetch,"GET",v,{headers:this.headers,jwt:(m=(h=x.session)===null||h===void 0?void 0:h.access_token)!==null&&m!==void 0?m:void 0})});if(a)throw a;return qs()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:t.provider,url:s?.url},error:null})}catch(s){if(Mt(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:a,data:{session:o}}=r;if(a)throw a;const{options:c,provider:u,token:d,access_token:h,nonce:m}=t,x=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=o?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:u,id_token:d,access_token:h,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:vn}),{data:y,error:v}=x;return v?this._returnResult({data:{user:null,session:null},error:v}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new sc}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:v}))}catch(a){if(await zs(this.storage,`${this.storageKey}-code-verifier`),Mt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,a;const{data:o,error:c}=r;if(c)throw c;return await Ht(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await lD(async a=>(a>0&&await oD(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Ht(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:vn})),(a,o)=>{const c=200*Math.pow(2,a);return o&&Dx(o)&&Date.now()+c-s<pc})}catch(s){if(this._debug(r,"error",s),Mt(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),qs()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await Lo(this.storage,this.storageKey);if(a&&this.userStorage){let c=await Lo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await xc(this.userStorage,this.storageKey+"-user",c)),a.user=(t=c?.user)!==null&&t!==void 0?t:Fx()}else if(a&&!a.user&&!a.user){const c=await Lo(this.storage,this.storageKey+"-user");c&&c?.user?(a.user=c.user,await zs(this.storage,this.storageKey+"-user"),await xc(this.storage,this.storageKey,a)):a.user=Fx()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const o=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Rx;if(this._debug(s,`session has${o?"":" not"} expired with margin of ${Rx}s`),o){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),Dx(c)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:u}=await this._getUser(a.access_token);!u&&c?.user?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(s,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new Fa;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new q0;const{data:o,error:c}=await this._refreshAccessToken(t);if(c)throw c;if(!o.session)throw new Fa;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const u={data:o.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(o){if(this._debug(a,"error",o),Mt(o)){const c={data:null,error:o};return Dx(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(c),c}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(o),o}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,s=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const o=[],c=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(d){o.push(d)}});if(await Promise.all(c),o.length>0){for(let u=0;u<o.length;u+=1)console.error(o[u]);throw o[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await zs(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await xc(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const o=SS(a);await xc(this.storage,this.storageKey,o)}else{const a=SS(r);await xc(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await zs(this.storage,this.storageKey),await zs(this.storage,this.storageKey+"-code-verifier"),await zs(this.storage,this.storageKey+"-user"),this.userStorage&&await zs(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&qs()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),pc);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-t)/pc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${pc}ms, refresh threshold is ${iy} ticks`),a<=iy&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof t4)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qs()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const a=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[o,c]=await ac(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(u.toString())}if(s?.queryParams){const o=new URLSearchParams(s.queryParams);a.push(o.toString())}return s?.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:a,error:o}=r;return o?this._returnResult({data:null,error:o}):await Ht(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,a;const{data:o,error:c}=r;if(c)return this._returnResult({data:null,error:c});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:h}=await Ht(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(s=o?.session)===null||s===void 0?void 0:s.access_token});return h?this._returnResult({data:null,error:h}):(t.factorType==="totp"&&d.type==="totp"&&(!((a=d?.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:o}=r;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?PD(t.webauthn.credential_response):BD(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:d}=await Ht(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:c,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:d}))})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:o}=r;if(o)return this._returnResult({data:null,error:o});const c=await Ht(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});if(c.error)return c;const{data:u}=c;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:ID(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:MD(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const a={all:[],phone:[],totp:[],webauthn:[]};for(const o of(t=r?.factors)!==null&&t!==void 0?t:[])a.all.push(o),o.status==="verified"&&a[o.factor_type].push(o);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:s},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Ox(s.access_token);let c=null;o.aal&&(c=o.aal);let u=c;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(m=>m.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const h=o.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;return a?this._returnResult({data:null,error:a}):s?await Ht(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new Fa})})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:a},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!a)return this._returnResult({data:null,error:new Fa});const c=await Ht(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&qs()&&!r?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(s){if(Mt(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:a},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!a)return this._returnResult({data:null,error:new Fa});const c=await Ht(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return c.data&&c.data.redirect_url&&qs()&&!r?.skipBrowserRedirect&&window.location.assign(c.data.redirect_url),c})}catch(s){if(Mt(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await Ht(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Fa})})}catch(t){if(Mt(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;return a?this._returnResult({data:null,error:a}):s?(await Ht(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Fa})})}catch(r){if(Mt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(u=>u.kid===t);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(u=>u.kid===t),s&&this.jwks_cached_at+GR>a)return s;const{data:o,error:c}=await Ht(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=a,s=o.keys.find(u=>u.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:v,error:w}=await this.getSession();if(w||!v.session)return this._returnResult({data:null,error:w});s=v.session.access_token}const{header:a,payload:o,signature:c,raw:{header:u,payload:d}}=Ox(s);r?.allowExpired||pD(o.exp);const h=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!h){const{error:v}=await this.getUser(s);if(v)throw v;return{data:{claims:o,header:a,signature:c},error:null}}const m=xD(a.alg),x=await crypto.subtle.importKey("jwk",h,m,!0,["verify"]);if(!await crypto.subtle.verify(m,x,c,rD(`${u}.${d}`)))throw new cy("Invalid JWT signature");return{data:{claims:o,header:a,signature:c},error:null}}catch(s){if(Mt(s))return this._returnResult({data:null,error:s});throw s}}}vd.nextInstanceID={};const KD=vd,XD="2.90.1";let Zu="";typeof Deno<"u"?Zu="deno":typeof document<"u"?Zu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Zu="react-native":Zu="node";const YD={"X-Client-Info":`supabase-js-${Zu}/${XD}`},JD={headers:YD},ZD={schema:"public"},QD={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},eO={};function wd(e){"@babel/helpers - typeof";return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wd(e)}function tO(e,t){if(wd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(wd(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rO(e){var t=tO(e,"string");return wd(t)=="symbol"?t:t+""}function sO(e,t,r){return(t=rO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function ss(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CS(Object(r),!0).forEach(function(s){sO(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CS(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const aO=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),nO=()=>Headers,iO=(e,t,r)=>{const s=aO(r),a=nO();return async(o,c)=>{var u;const d=(u=await t())!==null&&u!==void 0?u:e;let h=new a(c?.headers);return h.has("apikey")||h.set("apikey",e),h.has("Authorization")||h.set("Authorization",`Bearer ${d}`),s(o,ss(ss({},c),{},{headers:h}))}};function oO(e){return e.endsWith("/")?e:e+"/"}function lO(e,t){var r,s;const{db:a,auth:o,realtime:c,global:u}=e,{db:d,auth:h,realtime:m,global:x}=t,y={db:ss(ss({},d),a),auth:ss(ss({},h),o),realtime:ss(ss({},m),c),storage:{},global:ss(ss(ss({},x),u),{},{headers:ss(ss({},(r=x?.headers)!==null&&r!==void 0?r:{}),(s=u?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return e.accessToken?y.accessToken=e.accessToken:delete y.accessToken,y}function cO(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(oO(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var uO=class extends KD{constructor(e){super(e)}},dO=class{constructor(e,t,r){var s,a;this.supabaseUrl=e,this.supabaseKey=t;const o=cO(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const c=`sb-${o.hostname.split(".")[0]}-auth-token`,u={db:ZD,realtime:eO,auth:ss(ss({},QD),{},{storageKey:c}),global:JD},d=lO(r??{},u);if(this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken)this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(m,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}});else{var h;this.auth=this._initSupabaseAuthClient((h=d.auth)!==null&&h!==void 0?h:{},this.headers,d.global.fetch)}this.fetch=iO(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(ss({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&this.accessToken().then(m=>this.realtime.setAuth(m)).catch(m=>console.warn("Failed to set initial Realtime auth token:",m)),this.rest=new H8(new URL("rest/v1",o).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new zR(this.storageUrl.href,this.headers,this.fetch,r?.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new B8(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:s}=await e.auth.getSession();return(t=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,storageKey:o,flowType:c,lock:u,debug:d,throwOnError:h},m,x){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new uO({url:this.authUrl.href,headers:ss(ss({},y),m),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,flowType:c,lock:u,debug:d,throwOnError:h,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new oR(this.realtimeUrl.href,ss(ss({},e),{},{params:ss(ss({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const fO=(e,t,r)=>new dO(e,t,r);function hO(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}hO()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const mO="https://khwzdwewgadvpglptvua.supabase.co",pO="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imtod3pkd2V3Z2FkdnBnbHB0dnVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyNDIxODAsImV4cCI6MjA4MzgxODE4MH0.EiDPa3pJuEDNzfM-mho7PZ0NR83MGAH2XPf1lvP-9l4",Ue=fO(mO,pO),a4=Y.createContext({}),xO=({children:e})=>{const[t,r]=Y.useState(null),[s,a]=Y.useState(null),[o,c]=Y.useState(!0);Y.useEffect(()=>{const y=localStorage.getItem("user");if(y){const v=JSON.parse(y);r(v),a(v)}c(!1)},[]);const x={user:t,profile:s,loading:o,signInWithPassword:async(y,v)=>{try{const{data:w,error:g}=await Ue.from("users").select("id, user_id, name, team, rank, role, created_at").eq("user_id",y).eq("password",v).single();return g||!w?{error:{message:"    ."}}:(localStorage.setItem("user",JSON.stringify(w)),r(w),a(w),{data:w,error:null})}catch{return{error:{message:"   ."}}}},signUp:async({id:y,password:v,name:w,team:g,rank:_})=>{try{const{data:b}=await Ue.from("users").select("user_id").eq("user_id",y).single();if(b)return{error:{message:"   ."}};const{data:N,error:S}=await Ue.from("users").insert([{user_id:y,password:v,name:w,team:g,rank:_,role:"user",created_at:new Date().toISOString()}]).select().single();return S?{error:{message:"   ."}}:{data:N,error:null}}catch{return{error:{message:"   ."}}}},signOut:async()=>(localStorage.removeItem("user"),r(null),a(null),{error:null}),updateProfile:async y=>{if(!t||!t.user_id)return{data:null,error:{message:" ."}};const{data:v,error:w}=await Ue.from("users").update(y).eq("user_id",t.user_id).select().single();if(!w&&v){const g={...t,...v};localStorage.setItem("user",JSON.stringify(g)),r(g),a(g)}return{data:v,error:w}},isAdmin:s?.role==="admin",isSubAdmin:s?.role==="sub_admin"};return n.jsx(a4.Provider,{value:x,children:e})},Yr=()=>{const e=Y.useContext(a4);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};const gO=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),yO=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,s)=>s?s.toUpperCase():r.toLowerCase()),RS=e=>{const t=yO(e);return t.charAt(0).toUpperCase()+t.slice(1)},n4=(...e)=>e.filter((t,r,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===r).join(" ").trim(),vO=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var wO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const bO=Y.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:a="",children:o,iconNode:c,...u},d)=>Y.createElement("svg",{ref:d,...wO,width:t,height:t,stroke:e,strokeWidth:s?Number(r)*24/Number(t):r,className:n4("lucide",a),...!o&&!vO(u)&&{"aria-hidden":"true"},...u},[...c.map(([h,m])=>Y.createElement(h,m)),...Array.isArray(o)?o:[o]]));const Ft=(e,t)=>{const r=Y.forwardRef(({className:s,...a},o)=>Y.createElement(bO,{ref:o,iconNode:t,className:n4(`lucide-${gO(RS(e))}`,`lucide-${e}`,s),...a}));return r.displayName=RS(e),r};const _O=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],DS=Ft("arrow-down",_O);const SO=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Wd=Ft("arrow-left",SO);const kO=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],i4=Ft("arrow-right",kO);const NO=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],OS=Ft("arrow-up",NO);const EO=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],jO=Ft("award",EO);const TO=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],o4=Ft("book-open",TO);const AO=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],l4=Ft("briefcase",AO);const CO=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],bd=Ft("building-2",CO);const RO=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],c4=Ft("calendar-days",RO);const DO=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ha=Ft("calendar",DO);const OO=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],FO=Ft("camera",OO);const LO=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],y0=Ft("check",LO);const IO=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],no=Ft("chevron-down",IO);const MO=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],za=Ft("chevron-left",MO);const PO=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],pa=Ft("chevron-right",PO);const BO=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],sl=Ft("chevron-up",BO);const UO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],_n=Ft("circle-alert",UO);const zO=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Hs=Ft("circle-check-big",zO);const qO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],v0=Ft("circle-plus",qO);const $O=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],to=Ft("circle-x",$O);const HO=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],s0=Ft("clipboard-list",HO);const WO=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ea=Ft("clock",WO);const GO=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],u4=Ft("copy",GO);const VO=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ns=Ft("download",VO);const KO=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],wc=Ft("external-link",KO);const XO=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Xy=Ft("eye",XO);const YO=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],JO=Ft("file-down",YO);const ZO=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Yy=Ft("file-spreadsheet",ZO);const QO=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ws=Ft("file-text",QO);const eF=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],ka=Ft("file",eF);const tF=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],rF=Ft("folder-open",tF);const sF=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],aF=Ft("folder",sF);const nF=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],iF=Ft("funnel",nF);const oF=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],FS=Ft("history",oF);const lF=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],d4=Ft("house",lF);const cF=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],f4=Ft("image",cF);const uF=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],dF=Ft("lock-open",uF);const fF=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],al=Ft("lock",fF);const hF=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Jy=Ft("log-out",hF);const mF=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],pF=Ft("mail",mF);const xF=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],uy=Ft("map-pin",xF);const gF=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],h4=Ft("maximize-2",gF);const yF=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],vF=Ft("megaphone",yF);const wF=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],Dc=Ft("paperclip",wF);const bF=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Oc=Ft("pen-line",bF);const _F=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],aa=Ft("pen",_F);const SF=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],kF=Ft("phone",SF);const NF=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],LS=Ft("pin",NF);const EF=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ns=Ft("plus",EF);const jF=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],na=Ft("printer",jF);const TF=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Sc=Ft("refresh-cw",TF);const AF=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],CF=Ft("rotate-ccw",AF);const RF=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],dy=Ft("save",RF);const DF=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ao=Ft("search",DF);const OF=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],hl=Ft("settings",OF);const FF=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],LF=Ft("smartphone",FF);const IF=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],m4=Ft("square-pen",IF);const MF=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],_d=Ft("tag",MF);const PF=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],cr=Ft("trash-2",PF);const BF=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Gc=Ft("triangle-alert",BF);const UF=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],uo=Ft("upload",UF);const zF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],qF=Ft("user-plus",zF);const $F=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],nl=Ft("user",$F);const HF=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Sd=Ft("users",HF);const WF=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],pr=Ft("x",WF);class GF extends Y.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){this.setState({errorInfo:r})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset?.()};handleGoHome=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.href="/"};render(){return this.state.hasError?this.props.fallback?this.props.fallback(this.state.error,this.handleReset):n.jsx("div",{className:"min-h-[400px] flex items-center justify-center p-8",children:n.jsxs("div",{className:"max-w-md w-full text-center",children:[n.jsx("div",{className:"w-16 h-16 mx-auto mb-6 bg-red-100 rounded-full flex items-center justify-center",children:n.jsx(Gc,{className:"w-8 h-8 text-red-500"})}),n.jsx("h2",{className:"text-xl font-bold text-toss-gray-900 mb-2",children:" "}),n.jsx("p",{className:"text-toss-gray-500 mb-6",children:this.props.message||"    .    ."}),!1,n.jsxs("div",{className:"flex gap-3 justify-center",children:[n.jsxs(rt,{onClick:this.handleReset,variant:"secondary",className:"flex items-center gap-2",children:[n.jsx(Sc,{size:16})," "]}),n.jsxs(rt,{onClick:this.handleGoHome,className:"flex items-center gap-2",children:[n.jsx(d4,{size:16}),""]})]})]})}):this.props.children}}const rt=({children:e,variant:t="primary",size:r="md",disabled:s=!1,loading:a=!1,className:o="",...c})=>{const u="font-semibold transition-all duration-200 active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",d={primary:"bg-toss-blue text-white hover:bg-toss-blue-dark",secondary:"bg-toss-gray-100 text-toss-gray-800 hover:bg-toss-gray-200",ghost:"bg-transparent text-toss-gray-600 hover:bg-toss-gray-100",danger:"bg-red-500 text-white hover:bg-red-600"},h={sm:"py-2 px-4 text-sm rounded-toss",md:"py-3 px-6 rounded-toss",lg:"py-4 px-8 text-lg rounded-toss-lg"};return n.jsxs("button",{className:`${u} ${d[t]} ${h[r]} ${o}`,disabled:s||a,...c,children:[a&&n.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),e]})},At=({children:e,className:t="",padding:r="p-6",...s})=>n.jsx("div",{className:`bg-white rounded-toss-lg shadow-toss ${r} ${t}`,...s,children:e}),yr=({isOpen:e,onClose:t,title:r,children:s,size:a="default"})=>{if(!e)return null;const o={default:"max-w-2xl max-h-[90vh]",large:"max-w-4xl max-h-[95vh]",xl:"max-w-6xl max-h-[95vh]",full:"max-w-[95vw] max-h-[95vh]",a4:"max-w-[900px] max-h-[95vh]"};return n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),n.jsxs("div",{className:`relative bg-white rounded-toss-lg shadow-toss-lg w-full mx-4 overflow-auto ${o[a]||o.default}`,children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-toss-gray-100",children:[n.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:r}),n.jsx("button",{onClick:t,className:"text-toss-gray-500 hover:text-toss-gray-700",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsx("div",{className:"p-6",children:s})]})]})},VF=()=>{const{isAdmin:e,isSubAdmin:t}=Yr(),[r,s]=Y.useState(!1),[a,o]=Y.useState({}),c=wi(),u=x=>{o(y=>({...y,[x]:!y[x]}))};Y.useEffect(()=>{c.pathname.startsWith("/worklogs")&&o(x=>({...x,worklogs:!0})),c.pathname.startsWith("/archive")&&o(x=>({...x,archive:!0})),c.pathname.startsWith("/admission")&&o(x=>({...x,admission:!0}))},[c.pathname]);const d=[{to:"/",icon:d4,label:""},{to:"/notices",icon:vF,label:""},{to:"/events",icon:c4,label:""},{icon:s0,label:"",isSubmenu:!0,menuKey:"worklogs",pathPrefix:"/worklogs",subItems:[{to:"/worklogs/daily",label:" "},{to:"/worklogs/weekly",label:" "},{to:"/worklogs/monthly",label:" "}]},{to:"/rescue",icon:Gc,label:""},{icon:bd,label:"",isSubmenu:!0,menuKey:"admission",pathPrefix:"/admission",subItems:[{to:"/admission/ganghwa",label:" "},{to:"/admission/bupyeong",label:" "},{to:"/admission/nametag",label:" "}]},{to:"/meetings",icon:ha,label:""},{to:"/document-ledger",icon:o4,label:""},{to:"/document",icon:Ws,label:" "},{to:"/mypage",icon:nl,label:""}],h=[{href:"https://heony1216-eng.github.io/rescue-board/",icon:wc,label:""},{href:"https://login.ecount.com/",icon:wc,label:""},{href:"https://www.dropbox.com/home",icon:wc,label:""},{href:"https://auth.worksmobile.com/login/login?accessUrl=https%3A%2F%2Fdrive.worksmobile.com%2Fdrive%2Fweb%2Fmy%3FresourceKey%3Droot&isRefreshed=true",icon:wc,label:""}],m=({to:x,icon:y,label:v})=>n.jsxs(Z1,{to:x,onClick:()=>s(!1),className:({isActive:w})=>`flex items-center gap-3 px-4 py-3 rounded-toss transition-all ${w?"bg-toss-blue text-white":"text-toss-gray-900 hover:bg-toss-blue/10 hover:text-toss-blue"}`,children:[n.jsx(y,{size:20}),n.jsx("span",{className:"font-medium",children:v})]});return n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>s(!0),className:"lg:hidden fixed top-4 left-4 z-40 p-2 bg-white rounded-toss shadow-toss",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),r&&n.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-40",onClick:()=>s(!1)}),n.jsxs("aside",{className:`fixed top-0 left-0 h-full w-64 bg-white shadow-toss-lg z-50 transform transition-transform duration-300 flex flex-col ${r?"translate-x-0":"-translate-x-full lg:translate-x-0"}`,children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-toss-gray-100 flex-shrink-0",children:[n.jsxs("h1",{className:"text-xl font-bold text-toss-gray-900",children:[n.jsx("span",{className:"text-toss-blue",children:""})," "]}),n.jsx("button",{onClick:()=>s(!1),className:"lg:hidden text-toss-gray-500",children:n.jsx(pr,{size:24})})]}),n.jsxs("nav",{className:"p-4 space-y-2 flex-1 overflow-y-auto",children:[n.jsxs("a",{href:"https://www.dropbox.com/scl/fi/vz0zmnbpr1kfzw2w3fu6g/.apk?rlkey=lp7l2m97ssh1nixykcjxwiaqf&st=m08bikmg&dl=1",target:"_blank",rel:"noopener noreferrer",onClick:()=>s(!1),className:"flex items-center gap-3 px-4 py-3 rounded-toss transition-all bg-toss-gray-100 text-toss-gray-600 hover:bg-toss-gray-200 mb-4",children:[n.jsx(LF,{size:20}),n.jsx("span",{className:"font-medium",children:" "})]}),d.map(x=>x.isSubmenu?n.jsxs("div",{children:[n.jsxs("button",{onClick:()=>u(x.menuKey),className:`w-full flex items-center justify-between gap-3 px-4 py-3 rounded-toss transition-all ${c.pathname.startsWith(x.pathPrefix)?"bg-toss-blue/10 text-toss-blue":"text-toss-gray-900 hover:bg-toss-blue/10 hover:text-toss-blue"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(x.icon,{size:20}),n.jsx("span",{className:"font-medium",children:x.label})]}),n.jsx(no,{size:16,className:`transition-transform ${a[x.menuKey]?"rotate-180":""}`})]}),a[x.menuKey]&&n.jsx("div",{className:"ml-4 mt-1 space-y-1",children:x.subItems.map(y=>n.jsxs(Z1,{to:y.to,end:!0,onClick:()=>s(!1),className:({isActive:v})=>`flex items-center gap-3 px-4 py-2 rounded-toss transition-all text-sm ${v?"bg-toss-blue text-white":"text-toss-gray-700 hover:bg-toss-blue/10 hover:text-toss-blue"}`,children:[n.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current"}),n.jsx("span",{className:"font-medium",children:y.label})]},y.to))})]},x.label):n.jsx(m,{...x},x.to)),n.jsx("div",{className:"pt-4 mt-4 border-t border-toss-gray-100",children:h.map(x=>n.jsxs("a",{href:x.href,target:"_blank",rel:"noopener noreferrer",onClick:()=>s(!1),className:"flex items-center gap-3 px-4 py-3 rounded-toss transition-all text-toss-gray-900 hover:bg-toss-blue/10 hover:text-toss-blue",children:[n.jsx(x.icon,{size:20}),n.jsx("span",{className:"font-medium",children:x.label})]},x.href))})]})]})]})},KF=()=>{const{profile:e,signOut:t,isAdmin:r}=Yr(),s=Wc(),a=async()=>{await t(),s("/login")};return n.jsx("header",{className:"bg-white shadow-toss sticky top-0 z-30",children:n.jsxs("div",{className:"flex items-center justify-between px-4 lg:px-8 py-4",children:[n.jsx("div",{className:"lg:hidden w-10"})," ",n.jsxs("div",{className:"flex items-center gap-4 ml-auto",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-toss-blue/10 rounded-full flex items-center justify-center",children:n.jsx(nl,{size:20,className:"text-toss-blue"})}),n.jsxs("div",{className:"hidden sm:block",children:[n.jsxs("p",{className:"font-semibold text-toss-gray-900",children:[e?.name||"",r&&n.jsx("span",{className:"ml-2 text-xs bg-toss-blue text-white px-2 py-0.5 rounded-full",children:""})]}),n.jsxs("p",{className:"text-sm text-toss-gray-500",children:[e?.team&&`${e.team}  `,e?.rank||""]})]})]}),n.jsx("button",{onClick:a,className:"p-2 text-toss-gray-500 hover:text-toss-gray-700 hover:bg-toss-gray-100 rounded-toss transition-all",title:"",children:n.jsx(Jy,{size:20})})]})]})})},XF=()=>n.jsxs("div",{className:"min-h-screen bg-toss-gray-50 overflow-hidden",children:[n.jsx(VF,{}),n.jsxs("div",{className:"lg:ml-64 min-h-screen",children:[n.jsx(KF,{}),n.jsx("main",{className:"p-4 lg:p-8 overflow-x-hidden",children:n.jsx(t8,{})})]})]}),YF=()=>{const[e,t]=Y.useState("user"),[r,s]=Y.useState(""),[a,o]=Y.useState(""),[c,u]=Y.useState(!1),[d,h]=Y.useState(!1),[m,x]=Y.useState(""),{signInWithPassword:y}=Yr(),v=Wc();Y.useEffect(()=>{const g=localStorage.getItem("savedId");g&&(s(g),u(!0))},[]);const w=async g=>{g.preventDefault(),h(!0),x("");const{error:_}=await y(r,a);_?x(_.message||"    ."):(c?localStorage.setItem("savedId",r):localStorage.removeItem("savedId"),v("/")),h(!1)};return n.jsx("div",{className:"min-h-screen bg-toss-gray-50 flex items-center justify-center p-4",children:n.jsxs("div",{className:"w-full max-w-md",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsxs("h1",{className:"text-3xl font-bold text-toss-gray-900 mb-2",children:[n.jsx("span",{className:"text-toss-blue",children:""})," "]}),n.jsx("p",{className:"text-toss-gray-500",children:"  "})]}),n.jsxs(At,{className:"mb-4",children:[n.jsxs("div",{className:"flex mb-6 bg-toss-gray-100 p-1 rounded-toss",children:[n.jsx("button",{onClick:()=>t("user"),className:`flex-1 py-2 px-4 rounded-toss text-sm font-medium transition-all ${e==="user"?"bg-white text-toss-gray-900 shadow-sm":"text-toss-gray-500"}`,children:" "}),n.jsx("button",{onClick:()=>t("admin"),className:`flex-1 py-2 px-4 rounded-toss text-sm font-medium transition-all ${e==="admin"?"bg-white text-toss-gray-900 shadow-sm":"text-toss-gray-500"}`,children:" "})]}),n.jsxs("form",{onSubmit:w,className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(nl,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"text",value:r,onChange:g=>s(g.target.value),placeholder:e==="admin"?" ":"",required:!0,className:"w-full pl-12 pr-4 py-3 bg-toss-gray-100 border-0 rounded-toss text-toss-gray-900 placeholder-toss-gray-500 focus:ring-2 focus:ring-toss-blue focus:bg-white transition-all"})]}),n.jsxs("div",{className:"relative",children:[n.jsx(al,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"password",value:a,onChange:g=>o(g.target.value),placeholder:"",required:!0,className:"w-full pl-12 pr-4 py-3 bg-toss-gray-100 border-0 rounded-toss text-toss-gray-900 placeholder-toss-gray-500 focus:ring-2 focus:ring-toss-blue focus:bg-white transition-all"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"rememberMe",checked:c,onChange:g=>u(g.target.checked),className:"w-4 h-4 text-toss-blue bg-toss-gray-100 border-toss-gray-300 rounded focus:ring-toss-blue focus:ring-2"}),n.jsx("label",{htmlFor:"rememberMe",className:"ml-2 text-sm text-toss-gray-700 cursor-pointer",children:"  "})]}),m&&n.jsx("p",{className:"text-sm text-red-500 bg-red-50 p-3 rounded-toss",children:m}),n.jsxs(rt,{type:"submit",className:"w-full",loading:d,children:["",n.jsx(i4,{size:18})]})]}),e==="user"&&n.jsx("div",{className:"mt-6 pt-6 border-t border-toss-gray-200",children:n.jsxs(Gs,{to:"/register",className:"flex items-center justify-center gap-2 w-full py-3 bg-toss-gray-100 text-toss-gray-700 rounded-toss hover:bg-toss-gray-200 transition-colors font-medium",children:[n.jsx(qF,{size:18}),""]})})]}),n.jsx("p",{className:"text-center text-sm text-toss-gray-500",children:e==="user"?"   ":"  "})]})})},JF=()=>{const[e,t]=Y.useState({id:"",password:"",confirmPassword:"",name:"",team:"",rank:""}),[r,s]=Y.useState(!1),[a,o]=Y.useState(""),[c,u]=Y.useState(!1),{signUp:d}=Yr(),h=Wc(),m=v=>{const{name:w,value:g}=v.target;t(_=>({..._,[w]:g}))},x=async v=>{if(v.preventDefault(),s(!0),o(""),e.password!==e.confirmPassword){o("  ."),s(!1);return}if(e.password.length<6){o(" 6  ."),s(!1);return}const{error:w}=await d({id:e.id,password:e.password,name:e.name,team:e.team,rank:e.rank});w?o(w.message||" .  ."):(u(!0),setTimeout(()=>{h("/login")},2e3)),s(!1)},y="w-full pl-12 pr-4 py-3 bg-toss-gray-100 border-0 rounded-toss text-toss-gray-900 placeholder-toss-gray-500 focus:ring-2 focus:ring-toss-blue focus:bg-white transition-all";return n.jsx("div",{className:"min-h-screen bg-toss-gray-50 flex items-center justify-center p-4",children:n.jsxs("div",{className:"w-full max-w-md",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsxs("h1",{className:"text-3xl font-bold text-toss-gray-900 mb-2",children:[n.jsx("span",{className:"text-toss-blue",children:""})," "]}),n.jsx("p",{className:"text-toss-gray-500",children:""})]}),n.jsx(At,{className:"mb-4",children:c?n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),n.jsx("h2",{className:"text-xl font-semibold text-toss-gray-900 mb-2",children:" !"}),n.jsx("p",{className:"text-toss-gray-500",children:"  ..."})]}):n.jsxs("form",{onSubmit:x,className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(nl,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"text",name:"id",value:e.id,onChange:m,placeholder:" *",required:!0,className:y})]}),n.jsxs("div",{className:"relative",children:[n.jsx(al,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"password",name:"password",value:e.password,onChange:m,placeholder:" * (6 )",required:!0,className:y})]}),n.jsxs("div",{className:"relative",children:[n.jsx(al,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"password",name:"confirmPassword",value:e.confirmPassword,onChange:m,placeholder:"  *",required:!0,className:y})]}),n.jsx("div",{className:"border-t border-toss-gray-200 pt-4"}),n.jsxs("div",{className:"relative",children:[n.jsx(nl,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"text",name:"name",value:e.name,onChange:m,placeholder:" *",required:!0,className:y})]}),n.jsxs("div",{className:"relative",children:[n.jsx(l4,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"text",name:"team",value:e.team,onChange:m,placeholder:" (: , )",className:y})]}),n.jsxs("div",{className:"relative",children:[n.jsx(jO,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-toss-gray-400",size:20}),n.jsx("input",{type:"text",name:"rank",value:e.rank,onChange:m,placeholder:" (: , )",className:y})]}),a&&n.jsx("p",{className:"text-sm text-red-500 bg-red-50 p-3 rounded-toss",children:a}),n.jsxs(rt,{type:"submit",className:"w-full",loading:r,children:["",n.jsx(i4,{size:18})]})]})}),n.jsxs(Gs,{to:"/login",className:"flex items-center justify-center gap-2 text-sm text-toss-gray-500 hover:text-toss-blue transition-colors",children:[n.jsx(Wd,{size:16})," "]})]})})},ZF=()=>{const{profile:e,isAdmin:t}=Yr(),[r,s]=Y.useState(0),[a,o]=Y.useState([]),[c,u]=Y.useState([]),[d,h]=Y.useState(null),[m,x]=Y.useState(!1),[y,v]=Y.useState({daily:!1,weekly:!1,monthly:!1});Y.useEffect(()=>{g(),S(),_(),e?.user_id&&w()},[e?.user_id]);const w=async()=>{if(!e?.user_id)return;const E=new Date,R=E.getHours(),L=E.getDay(),O=E.toISOString().split("T")[0],P={daily:!1,weekly:!1,monthly:!1};if(L>=1&&L<=5&&R>=15){const{data:V}=await Ue.from("work_logs").select("id").eq("user_id",e.user_id).eq("type","daily").eq("work_date",O).limit(1).maybeSingle();V||(P.daily=!0)}if(L===5&&R>=15){const V=new Date(E);V.setDate(E.getDate()-(L-1));const oe=V.toISOString().split("T")[0],K=new Date(E).toISOString().split("T")[0],{data:M}=await Ue.from("work_logs").select("id").eq("user_id",e.user_id).eq("type","weekly").gte("work_date",oe).lte("work_date",K).limit(1).maybeSingle();M||(P.weekly=!0)}const F=new Date(E.getFullYear(),E.getMonth()+1,0).getDate();if(E.getDate()===F&&R>=15){const V=new Date(E.getFullYear(),E.getMonth(),1).toISOString().split("T")[0],oe=O,{data:D}=await Ue.from("work_logs").select("id").eq("user_id",e.user_id).eq("type","monthly").gte("work_date",V).lte("work_date",oe).limit(1).maybeSingle();D||(P.monthly=!0)}v(P)},g=async()=>{try{const{count:E}=await Ue.from("rescue_situations").select("id",{count:"exact"}).eq("is_completed",!1);s(E||0)}catch(E){console.error("Error fetching rescue count:",E)}},_=async()=>{try{const{data:E}=await Ue.from("rescue_situations").select("*").eq("is_completed",!1).order("created_at",{ascending:!1}).limit(10);u(E||[])}catch(E){console.error("Error fetching rescues:",E)}},b=E=>{h(E),x(!0)},N=()=>{x(!1),h(null)},S=async()=>{try{const{data:E}=await Ue.from("notices").select("id, title, created_at, is_pinned").order("is_pinned",{ascending:!1}).order("created_at",{ascending:!1}).limit(5);o(E||[])}catch(E){console.error("Error fetching notices:",E)}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(At,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx("span",{className:"text-2xl font-bold",children:e?.name?.charAt(0)||"U"})}),n.jsxs("div",{children:[n.jsxs("h2",{className:"text-2xl font-bold mb-1",children:[", ",e?.name||"","!",t&&n.jsx("span",{className:"ml-2 text-xs bg-white/20 px-2 py-1 rounded-full",children:""})]}),n.jsxs("p",{className:"text-white/80",children:[e?.team&&`${e.team}  `,e?.position||" "]})]})]})}),(y.daily||y.weekly||y.monthly)&&n.jsx(At,{className:"bg-amber-50 border border-amber-200",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0",children:n.jsx(_n,{size:20,className:"text-amber-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-bold text-amber-800 mb-2",children:"  "}),n.jsxs("div",{className:"space-y-2",children:[y.daily&&n.jsxs(Gs,{to:"/worklogs/daily",className:"flex items-center justify-between p-2 bg-white rounded-lg hover:bg-amber-100 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(s0,{size:16,className:"text-amber-600"}),n.jsx("span",{className:"text-sm text-amber-800",children:"   "})]}),n.jsx("span",{className:"text-xs text-amber-600 font-medium",children:" "})]}),y.weekly&&n.jsxs(Gs,{to:"/worklogs/weekly",className:"flex items-center justify-between p-2 bg-white rounded-lg hover:bg-amber-100 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(s0,{size:16,className:"text-amber-600"}),n.jsx("span",{className:"text-sm text-amber-800",children:"    "})]}),n.jsx("span",{className:"text-xs text-amber-600 font-medium",children:" "})]}),y.monthly&&n.jsxs(Gs,{to:"/worklogs/monthly",className:"flex items-center justify-between p-2 bg-white rounded-lg hover:bg-amber-100 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(s0,{size:16,className:"text-amber-600"}),n.jsx("span",{className:"text-sm text-amber-800",children:"    "})]}),n.jsx("span",{className:"text-xs text-amber-600 font-medium",children:" "})]})]})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs(At,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Gc,{size:18,className:"text-orange-500"}),n.jsx("h3",{className:"text-base font-bold text-toss-gray-900",children:" "}),n.jsxs("span",{className:"text-xs bg-orange-100 text-orange-600 px-2 py-0.5 rounded-full font-medium",children:[r,""]})]}),n.jsx(Gs,{to:"/rescue",className:"text-sm text-toss-blue hover:underline",children:""})]}),c.length>0?n.jsx("div",{className:"space-y-2 max-h-[320px] overflow-y-auto",children:c.map(E=>n.jsxs("div",{onClick:()=>b(E),className:"block p-3 rounded-lg hover:bg-toss-gray-50 transition-colors border border-toss-gray-100 cursor-pointer",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("p",{className:"font-medium text-toss-gray-900 text-sm",children:E.name}),n.jsx("span",{className:"text-toss-gray-300",children:"|"}),n.jsx("p",{className:"text-sm text-toss-gray-600",children:E.location})]}),n.jsx("p",{className:"text-xs text-toss-gray-400",children:E.request_date||"-"})]}),n.jsx("p",{className:"text-sm text-toss-gray-700 line-clamp-2",children:E.status||"-"})]},E.id))}):n.jsx("p",{className:"text-center text-toss-gray-500 py-8 text-sm",children:"  "})]}),n.jsxs(At,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-base font-bold text-toss-gray-900",children:" "}),n.jsx(Gs,{to:"/notices",className:"text-sm text-toss-blue hover:underline",children:""})]}),a.length>0?n.jsx("div",{className:"space-y-2 max-h-[320px] overflow-y-auto",children:a.map(E=>n.jsxs(Gs,{to:`/notices/${E.id}`,className:"block p-3 rounded-lg hover:bg-toss-gray-50 transition-colors border border-toss-gray-100",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[E.is_pinned&&n.jsx("span",{className:"text-xs bg-toss-blue text-white px-2 py-0.5 rounded-full",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900 flex-1 truncate text-sm",children:E.title})]}),n.jsx("p",{className:"text-xs text-toss-gray-400 mt-1",children:new Date(E.created_at).toLocaleDateString("ko-KR")})]},E.id))}):n.jsx("p",{className:"text-center text-toss-gray-500 py-8 text-sm",children:"  "})]})]}),n.jsx(yr,{isOpen:m,onClose:N,title:" ",children:d&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(nl,{size:16,className:"text-toss-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-toss-gray-500",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:d.name||"-"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(uy,{size:16,className:"text-toss-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-toss-gray-500",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:d.location||"-"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(kF,{size:16,className:"text-toss-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-toss-gray-500",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:d.contact||"-"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ha,{size:16,className:"text-toss-gray-400"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-toss-gray-500",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:d.request_date||"-"})]})]})]}),(d.animal_type||d.animal_count)&&n.jsxs("div",{className:"p-3 bg-toss-gray-50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-toss-gray-900",children:[d.animal_type||"-",d.animal_count&&` (${d.animal_count})`]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Ws,{size:16,className:"text-toss-gray-400"}),n.jsx("p",{className:"text-sm font-medium text-toss-gray-700",children:" "})]}),n.jsx("div",{className:"p-3 bg-orange-50 rounded-lg",children:n.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:d.status||"  "})})]}),d.notes&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("div",{className:"p-3 bg-toss-gray-50 rounded-lg",children:n.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:d.notes})})]}),n.jsx("div",{className:"pt-4 border-t border-toss-gray-100",children:n.jsx(Gs,{to:"/rescue",onClick:N,className:"block w-full text-center py-3 bg-toss-blue text-white rounded-lg hover:bg-blue-600 transition-colors",children:"  "})})]})})]})},IS=()=>{const{id:e}=Oj(),t=Wc(),{isAdmin:r,isSubAdmin:s,profile:a}=Yr(),[o,c]=Y.useState([]),[u,d]=Y.useState(null),[h,m]=Y.useState(!1),[x,y]=Y.useState(!1),[v,w]=Y.useState(!0),[g,_]=Y.useState({title:"",content:"",is_pinned:!1});Y.useEffect(()=>{b()},[]),Y.useEffect(()=>{e?N(e):d(null)},[e]);const b=async()=>{try{const{data:V,error:oe}=await Ue.from("notices").select("*, author:users(name)").order("is_pinned",{ascending:!1}).order("created_at",{ascending:!1});if(oe)throw oe;c(V||[])}catch(V){console.error("Error fetching notices:",V)}finally{w(!1)}},N=async V=>{try{const{data:oe,error:D}=await Ue.from("notices").select("*, author:users(name)").eq("id",V).single();if(D)throw D;d(oe)}catch(oe){console.error("Error fetching notice:",oe)}},S=async()=>{if(!g.title||!g.content){alert("  .");return}try{const{error:V}=await Ue.from("notices").insert({title:g.title,content:g.content,is_pinned:g.is_pinned,author_id:a.user_id});if(V)throw console.error("Notice insert error:",V),V;m(!1),_({title:"",content:"",is_pinned:!1}),b(),alert(" .")}catch(V){console.error("Error creating notice:",V),alert("  : "+V.message)}},E=async()=>{if(!L){alert("    .");return}try{const{error:V}=await Ue.from("notices").update({title:g.title,content:g.content,is_pinned:g.is_pinned,updated_at:new Date().toISOString()}).eq("id",L.id);if(V)throw V;m(!1),O(null),b(),u&&u.id===L.id&&N(L.id),alert(" .")}catch(V){console.error("Error updating notice:",V),alert("  .")}},R=async V=>{if(confirm(" ?"))try{const{error:oe}=await Ue.from("notices").delete().eq("id",V);if(oe)throw oe;t("/notices"),b()}catch(oe){console.error("Error deleting notice:",oe)}},[L,O]=Y.useState(null),P=V=>{O(V),_({title:V.title,content:V.content,is_pinned:V.is_pinned}),y(!1),m(!0)},F=()=>{_({title:"",content:"",is_pinned:!1}),y(!0),m(!0)};return u?n.jsxs("div",{className:"space-y-6",children:[n.jsxs(Gs,{to:"/notices",className:"inline-flex items-center gap-2 text-toss-gray-500 hover:text-toss-gray-700",children:[n.jsx(za,{size:20}),""]}),n.jsxs(At,{children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsx("div",{className:"flex items-center gap-2",children:u.is_pinned&&n.jsxs("span",{className:"bg-toss-blue text-white text-xs px-2 py-1 rounded-full flex items-center gap-1",children:[n.jsx(LS,{size:12})," "]})}),(r||s)&&n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:V=>{V.preventDefault(),V.stopPropagation(),P(u)},className:"p-2 text-toss-gray-500 hover:bg-toss-gray-100 rounded-toss",children:n.jsx(m4,{size:18})}),n.jsx("button",{onClick:V=>{V.preventDefault(),V.stopPropagation(),R(u.id)},className:"p-2 text-red-500 hover:bg-red-50 rounded-toss",children:n.jsx(cr,{size:18})})]})]}),n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900 mb-2",children:u.title}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-toss-gray-500 mb-6 pb-6 border-b border-toss-gray-100",children:[n.jsx("span",{children:u.author?.name||""}),n.jsx("span",{children:new Date(u.created_at).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})})]}),n.jsx("div",{className:"prose max-w-none text-toss-gray-800 whitespace-pre-wrap leading-relaxed",children:u.content})]}),n.jsx(yr,{isOpen:h,onClose:()=>m(!1),title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",value:g.title,onChange:V=>_({...g,title:V.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue",placeholder:"  "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("textarea",{value:g.content,onChange:V=>_({...g,content:V.target.value}),rows:6,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:"  "})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:g.is_pinned,onChange:V=>_({...g,is_pinned:V.target.checked}),className:"w-5 h-5 rounded border-toss-gray-300 text-toss-blue focus:ring-toss-blue"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:" "})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>m(!1),className:"flex-1",children:""}),n.jsx(rt,{onClick:E,className:"flex-1",children:""})]})]})})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:""}),(r||s)&&n.jsxs(rt,{onClick:F,children:[n.jsx(Ns,{size:18}),"  "]})]}),n.jsx(At,{padding:"p-0",children:v?n.jsx("div",{className:"p-8 text-center text-toss-gray-500",children:" ..."}):o.length>0?n.jsx("div",{className:"divide-y divide-toss-gray-100",children:o.map(V=>n.jsxs(Gs,{to:`/notices/${V.id}`,className:"block p-4 hover:bg-toss-gray-50 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[V.is_pinned&&n.jsxs("span",{className:"bg-toss-blue text-white text-xs px-2 py-0.5 rounded-full flex items-center gap-1",children:[n.jsx(LS,{size:10})," "]}),n.jsx("h3",{className:"font-medium text-toss-gray-900 flex-1 truncate",children:V.title}),n.jsx("span",{className:"text-sm text-toss-gray-400 shrink-0",children:new Date(V.created_at).toLocaleDateString("ko-KR")})]}),n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1 truncate",children:V.content})]},V.id))}):n.jsx("div",{className:"p-8 text-center text-toss-gray-500",children:"  "})}),n.jsx(yr,{isOpen:h,onClose:()=>m(!1),title:x?"  ":" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",value:g.title,onChange:V=>_({...g,title:V.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue",placeholder:"  "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("textarea",{value:g.content,onChange:V=>_({...g,content:V.target.value}),rows:6,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:"  "})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:g.is_pinned,onChange:V=>_({...g,is_pinned:V.target.checked}),className:"w-5 h-5 rounded border-toss-gray-300 text-toss-blue focus:ring-toss-blue"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:" "})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>m(!1),className:"flex-1",children:""}),n.jsx(rt,{onClick:x?S:E,className:"flex-1",children:x?"":""})]})]})})]})};var QF="rpc",eL="upload",tL="download",Ix="app",Mx="user",Px="team",rL="noauth",sL="cookie",w0="dropboxapi.com",MS="dropbox.com",fy={api:"api",notify:"bolt",content:"api-content"},Te={};Te.accountSetProfilePhoto=function(e){return this.request("account/set_profile_photo",e,"user","api","rpc","account_info.write")};Te.authTokenFromOauth1=function(e){return this.request("auth/token/from_oauth1",e,"app","api","rpc",null)};Te.authTokenRevoke=function(){return this.request("auth/token/revoke",null,"user","api","rpc",null)};Te.checkApp=function(e){return this.request("check/app",e,"app","api","rpc",null)};Te.checkUser=function(e){return this.request("check/user",e,"user","api","rpc","account_info.read")};Te.contactsDeleteManualContacts=function(){return this.request("contacts/delete_manual_contacts",null,"user","api","rpc","contacts.write")};Te.contactsDeleteManualContactsBatch=function(e){return this.request("contacts/delete_manual_contacts_batch",e,"user","api","rpc","contacts.write")};Te.filePropertiesPropertiesAdd=function(e){return this.request("file_properties/properties/add",e,"user","api","rpc","files.metadata.write")};Te.filePropertiesPropertiesOverwrite=function(e){return this.request("file_properties/properties/overwrite",e,"user","api","rpc","files.metadata.write")};Te.filePropertiesPropertiesRemove=function(e){return this.request("file_properties/properties/remove",e,"user","api","rpc","files.metadata.write")};Te.filePropertiesPropertiesSearch=function(e){return this.request("file_properties/properties/search",e,"user","api","rpc","files.metadata.read")};Te.filePropertiesPropertiesSearchContinue=function(e){return this.request("file_properties/properties/search/continue",e,"user","api","rpc","files.metadata.read")};Te.filePropertiesPropertiesUpdate=function(e){return this.request("file_properties/properties/update",e,"user","api","rpc","files.metadata.write")};Te.filePropertiesTemplatesAddForTeam=function(e){return this.request("file_properties/templates/add_for_team",e,"team","api","rpc","files.team_metadata.write")};Te.filePropertiesTemplatesAddForUser=function(e){return this.request("file_properties/templates/add_for_user",e,"user","api","rpc","files.metadata.write")};Te.filePropertiesTemplatesGetForTeam=function(e){return this.request("file_properties/templates/get_for_team",e,"team","api","rpc","files.team_metadata.write")};Te.filePropertiesTemplatesGetForUser=function(e){return this.request("file_properties/templates/get_for_user",e,"user","api","rpc","files.metadata.read")};Te.filePropertiesTemplatesListForTeam=function(){return this.request("file_properties/templates/list_for_team",null,"team","api","rpc","files.team_metadata.write")};Te.filePropertiesTemplatesListForUser=function(){return this.request("file_properties/templates/list_for_user",null,"user","api","rpc","files.metadata.read")};Te.filePropertiesTemplatesRemoveForTeam=function(e){return this.request("file_properties/templates/remove_for_team",e,"team","api","rpc","files.team_metadata.write")};Te.filePropertiesTemplatesRemoveForUser=function(e){return this.request("file_properties/templates/remove_for_user",e,"user","api","rpc","files.metadata.write")};Te.filePropertiesTemplatesUpdateForTeam=function(e){return this.request("file_properties/templates/update_for_team",e,"team","api","rpc","files.team_metadata.write")};Te.filePropertiesTemplatesUpdateForUser=function(e){return this.request("file_properties/templates/update_for_user",e,"user","api","rpc","files.metadata.write")};Te.fileRequestsCount=function(){return this.request("file_requests/count",null,"user","api","rpc","file_requests.read")};Te.fileRequestsCreate=function(e){return this.request("file_requests/create",e,"user","api","rpc","file_requests.write")};Te.fileRequestsDelete=function(e){return this.request("file_requests/delete",e,"user","api","rpc","file_requests.write")};Te.fileRequestsDeleteAllClosed=function(){return this.request("file_requests/delete_all_closed",null,"user","api","rpc","file_requests.write")};Te.fileRequestsGet=function(e){return this.request("file_requests/get",e,"user","api","rpc","file_requests.read")};Te.fileRequestsListV2=function(e){return this.request("file_requests/list_v2",e,"user","api","rpc","file_requests.read")};Te.fileRequestsList=function(){return this.request("file_requests/list",null,"user","api","rpc","file_requests.read")};Te.fileRequestsListContinue=function(e){return this.request("file_requests/list/continue",e,"user","api","rpc","file_requests.read")};Te.fileRequestsUpdate=function(e){return this.request("file_requests/update",e,"user","api","rpc","file_requests.write")};Te.filesAlphaGetMetadata=function(e){return this.request("files/alpha/get_metadata",e,"user","api","rpc","files.metadata.read")};Te.filesAlphaUpload=function(e){return this.request("files/alpha/upload",e,"user","content","upload","files.content.write")};Te.filesCopyV2=function(e){return this.request("files/copy_v2",e,"user","api","rpc","files.content.write")};Te.filesCopy=function(e){return this.request("files/copy",e,"user","api","rpc","files.content.write")};Te.filesCopyBatchV2=function(e){return this.request("files/copy_batch_v2",e,"user","api","rpc","files.content.write")};Te.filesCopyBatch=function(e){return this.request("files/copy_batch",e,"user","api","rpc","files.content.write")};Te.filesCopyBatchCheckV2=function(e){return this.request("files/copy_batch/check_v2",e,"user","api","rpc","files.content.write")};Te.filesCopyBatchCheck=function(e){return this.request("files/copy_batch/check",e,"user","api","rpc","files.content.write")};Te.filesCopyReferenceGet=function(e){return this.request("files/copy_reference/get",e,"user","api","rpc","files.content.write")};Te.filesCopyReferenceSave=function(e){return this.request("files/copy_reference/save",e,"user","api","rpc","files.content.write")};Te.filesCreateFolderV2=function(e){return this.request("files/create_folder_v2",e,"user","api","rpc","files.content.write")};Te.filesCreateFolder=function(e){return this.request("files/create_folder",e,"user","api","rpc","files.content.write")};Te.filesCreateFolderBatch=function(e){return this.request("files/create_folder_batch",e,"user","api","rpc","files.content.write")};Te.filesCreateFolderBatchCheck=function(e){return this.request("files/create_folder_batch/check",e,"user","api","rpc","files.content.write")};Te.filesDeleteV2=function(e){return this.request("files/delete_v2",e,"user","api","rpc","files.content.write")};Te.filesDelete=function(e){return this.request("files/delete",e,"user","api","rpc","files.content.write")};Te.filesDeleteBatch=function(e){return this.request("files/delete_batch",e,"user","api","rpc","files.content.write")};Te.filesDeleteBatchCheck=function(e){return this.request("files/delete_batch/check",e,"user","api","rpc","files.content.write")};Te.filesDownload=function(e){return this.request("files/download",e,"user","content","download","files.content.read")};Te.filesDownloadZip=function(e){return this.request("files/download_zip",e,"user","content","download","files.content.read")};Te.filesExport=function(e){return this.request("files/export",e,"user","content","download","files.content.read")};Te.filesGetFileLockBatch=function(e){return this.request("files/get_file_lock_batch",e,"user","api","rpc","files.content.read")};Te.filesGetMetadata=function(e){return this.request("files/get_metadata",e,"user","api","rpc","files.metadata.read")};Te.filesGetPreview=function(e){return this.request("files/get_preview",e,"user","content","download","files.content.read")};Te.filesGetTemporaryLink=function(e){return this.request("files/get_temporary_link",e,"user","api","rpc","files.content.read")};Te.filesGetTemporaryUploadLink=function(e){return this.request("files/get_temporary_upload_link",e,"user","api","rpc","files.content.write")};Te.filesGetThumbnail=function(e){return this.request("files/get_thumbnail",e,"user","content","download","files.content.read")};Te.filesGetThumbnailV2=function(e){return this.request("files/get_thumbnail_v2",e,"app, user","content","download","files.content.read")};Te.filesGetThumbnailBatch=function(e){return this.request("files/get_thumbnail_batch",e,"user","content","rpc","files.content.read")};Te.filesListFolder=function(e){return this.request("files/list_folder",e,"app, user","api","rpc","files.metadata.read")};Te.filesListFolderContinue=function(e){return this.request("files/list_folder/continue",e,"app, user","api","rpc","files.metadata.read")};Te.filesListFolderGetLatestCursor=function(e){return this.request("files/list_folder/get_latest_cursor",e,"user","api","rpc","files.metadata.read")};Te.filesListFolderLongpoll=function(e){return this.request("files/list_folder/longpoll",e,"noauth","notify","rpc","files.metadata.read")};Te.filesListRevisions=function(e){return this.request("files/list_revisions",e,"user","api","rpc","files.metadata.read")};Te.filesLockFileBatch=function(e){return this.request("files/lock_file_batch",e,"user","api","rpc","files.content.write")};Te.filesMoveV2=function(e){return this.request("files/move_v2",e,"user","api","rpc","files.content.write")};Te.filesMove=function(e){return this.request("files/move",e,"user","api","rpc","files.content.write")};Te.filesMoveBatchV2=function(e){return this.request("files/move_batch_v2",e,"user","api","rpc","files.content.write")};Te.filesMoveBatch=function(e){return this.request("files/move_batch",e,"user","api","rpc","files.content.write")};Te.filesMoveBatchCheckV2=function(e){return this.request("files/move_batch/check_v2",e,"user","api","rpc","files.content.write")};Te.filesMoveBatchCheck=function(e){return this.request("files/move_batch/check",e,"user","api","rpc","files.content.write")};Te.filesPaperCreate=function(e){return this.request("files/paper/create",e,"user","api","upload","files.content.write")};Te.filesPaperUpdate=function(e){return this.request("files/paper/update",e,"user","api","upload","files.content.write")};Te.filesPermanentlyDelete=function(e){return this.request("files/permanently_delete",e,"user","api","rpc","files.permanent_delete")};Te.filesPropertiesAdd=function(e){return this.request("files/properties/add",e,"user","api","rpc","files.metadata.write")};Te.filesPropertiesOverwrite=function(e){return this.request("files/properties/overwrite",e,"user","api","rpc","files.metadata.write")};Te.filesPropertiesRemove=function(e){return this.request("files/properties/remove",e,"user","api","rpc","files.metadata.write")};Te.filesPropertiesTemplateGet=function(e){return this.request("files/properties/template/get",e,"user","api","rpc","files.metadata.read")};Te.filesPropertiesTemplateList=function(){return this.request("files/properties/template/list",null,"user","api","rpc","files.metadata.read")};Te.filesPropertiesUpdate=function(e){return this.request("files/properties/update",e,"user","api","rpc","files.metadata.write")};Te.filesRestore=function(e){return this.request("files/restore",e,"user","api","rpc","files.content.write")};Te.filesSaveUrl=function(e){return this.request("files/save_url",e,"user","api","rpc","files.content.write")};Te.filesSaveUrlCheckJobStatus=function(e){return this.request("files/save_url/check_job_status",e,"user","api","rpc","files.content.write")};Te.filesSearch=function(e){return this.request("files/search",e,"user","api","rpc","files.metadata.read")};Te.filesSearchV2=function(e){return this.request("files/search_v2",e,"user","api","rpc","files.metadata.read")};Te.filesSearchContinueV2=function(e){return this.request("files/search/continue_v2",e,"user","api","rpc","files.metadata.read")};Te.filesTagsAdd=function(e){return this.request("files/tags/add",e,"user","api","rpc","files.metadata.write")};Te.filesTagsGet=function(e){return this.request("files/tags/get",e,"user","api","rpc","files.metadata.read")};Te.filesTagsRemove=function(e){return this.request("files/tags/remove",e,"user","api","rpc","files.metadata.write")};Te.filesUnlockFileBatch=function(e){return this.request("files/unlock_file_batch",e,"user","api","rpc","files.content.write")};Te.filesUpload=function(e){return this.request("files/upload",e,"user","content","upload","files.content.write")};Te.filesUploadSessionAppendV2=function(e){return this.request("files/upload_session/append_v2",e,"user","content","upload","files.content.write")};Te.filesUploadSessionAppend=function(e){return this.request("files/upload_session/append",e,"user","content","upload","files.content.write")};Te.filesUploadSessionFinish=function(e){return this.request("files/upload_session/finish",e,"user","content","upload","files.content.write")};Te.filesUploadSessionFinishBatch=function(e){return this.request("files/upload_session/finish_batch",e,"user","api","rpc","files.content.write")};Te.filesUploadSessionFinishBatchV2=function(e){return this.request("files/upload_session/finish_batch_v2",e,"user","api","rpc","files.content.write")};Te.filesUploadSessionFinishBatchCheck=function(e){return this.request("files/upload_session/finish_batch/check",e,"user","api","rpc","files.content.write")};Te.filesUploadSessionStart=function(e){return this.request("files/upload_session/start",e,"user","content","upload","files.content.write")};Te.filesUploadSessionStartBatch=function(e){return this.request("files/upload_session/start_batch",e,"user","api","rpc","files.content.write")};Te.openidUserinfo=function(e){return this.request("openid/userinfo",e,"user","api","rpc","openid")};Te.paperDocsArchive=function(e){return this.request("paper/docs/archive",e,"user","api","rpc","files.content.write")};Te.paperDocsCreate=function(e){return this.request("paper/docs/create",e,"user","api","upload","files.content.write")};Te.paperDocsDownload=function(e){return this.request("paper/docs/download",e,"user","api","download","files.content.read")};Te.paperDocsFolderUsersList=function(e){return this.request("paper/docs/folder_users/list",e,"user","api","rpc","sharing.read")};Te.paperDocsFolderUsersListContinue=function(e){return this.request("paper/docs/folder_users/list/continue",e,"user","api","rpc","sharing.read")};Te.paperDocsGetFolderInfo=function(e){return this.request("paper/docs/get_folder_info",e,"user","api","rpc","sharing.read")};Te.paperDocsList=function(e){return this.request("paper/docs/list",e,"user","api","rpc","files.metadata.read")};Te.paperDocsListContinue=function(e){return this.request("paper/docs/list/continue",e,"user","api","rpc","files.metadata.read")};Te.paperDocsPermanentlyDelete=function(e){return this.request("paper/docs/permanently_delete",e,"user","api","rpc","files.permanent_delete")};Te.paperDocsSharingPolicyGet=function(e){return this.request("paper/docs/sharing_policy/get",e,"user","api","rpc","sharing.read")};Te.paperDocsSharingPolicySet=function(e){return this.request("paper/docs/sharing_policy/set",e,"user","api","rpc","sharing.write")};Te.paperDocsUpdate=function(e){return this.request("paper/docs/update",e,"user","api","upload","files.content.write")};Te.paperDocsUsersAdd=function(e){return this.request("paper/docs/users/add",e,"user","api","rpc","sharing.write")};Te.paperDocsUsersList=function(e){return this.request("paper/docs/users/list",e,"user","api","rpc","sharing.read")};Te.paperDocsUsersListContinue=function(e){return this.request("paper/docs/users/list/continue",e,"user","api","rpc","sharing.read")};Te.paperDocsUsersRemove=function(e){return this.request("paper/docs/users/remove",e,"user","api","rpc","sharing.write")};Te.paperFoldersCreate=function(e){return this.request("paper/folders/create",e,"user","api","rpc","files.content.write")};Te.sharingAddFileMember=function(e){return this.request("sharing/add_file_member",e,"user","api","rpc","sharing.write")};Te.sharingAddFolderMember=function(e){return this.request("sharing/add_folder_member",e,"user","api","rpc","sharing.write")};Te.sharingCheckJobStatus=function(e){return this.request("sharing/check_job_status",e,"user","api","rpc","sharing.write")};Te.sharingCheckRemoveMemberJobStatus=function(e){return this.request("sharing/check_remove_member_job_status",e,"user","api","rpc","sharing.write")};Te.sharingCheckShareJobStatus=function(e){return this.request("sharing/check_share_job_status",e,"user","api","rpc","sharing.write")};Te.sharingCreateSharedLink=function(e){return this.request("sharing/create_shared_link",e,"user","api","rpc","sharing.write")};Te.sharingCreateSharedLinkWithSettings=function(e){return this.request("sharing/create_shared_link_with_settings",e,"user","api","rpc","sharing.write")};Te.sharingGetFileMetadata=function(e){return this.request("sharing/get_file_metadata",e,"user","api","rpc","sharing.read")};Te.sharingGetFileMetadataBatch=function(e){return this.request("sharing/get_file_metadata/batch",e,"user","api","rpc","sharing.read")};Te.sharingGetFolderMetadata=function(e){return this.request("sharing/get_folder_metadata",e,"user","api","rpc","sharing.read")};Te.sharingGetSharedLinkFile=function(e){return this.request("sharing/get_shared_link_file",e,"user","content","download","sharing.read")};Te.sharingGetSharedLinkMetadata=function(e){return this.request("sharing/get_shared_link_metadata",e,"app, user","api","rpc","sharing.read")};Te.sharingGetSharedLinks=function(e){return this.request("sharing/get_shared_links",e,"user","api","rpc","sharing.read")};Te.sharingListFileMembers=function(e){return this.request("sharing/list_file_members",e,"user","api","rpc","sharing.read")};Te.sharingListFileMembersBatch=function(e){return this.request("sharing/list_file_members/batch",e,"user","api","rpc","sharing.read")};Te.sharingListFileMembersContinue=function(e){return this.request("sharing/list_file_members/continue",e,"user","api","rpc","sharing.read")};Te.sharingListFolderMembers=function(e){return this.request("sharing/list_folder_members",e,"user","api","rpc","sharing.read")};Te.sharingListFolderMembersContinue=function(e){return this.request("sharing/list_folder_members/continue",e,"user","api","rpc","sharing.read")};Te.sharingListFolders=function(e){return this.request("sharing/list_folders",e,"user","api","rpc","sharing.read")};Te.sharingListFoldersContinue=function(e){return this.request("sharing/list_folders/continue",e,"user","api","rpc","sharing.read")};Te.sharingListMountableFolders=function(e){return this.request("sharing/list_mountable_folders",e,"user","api","rpc","sharing.read")};Te.sharingListMountableFoldersContinue=function(e){return this.request("sharing/list_mountable_folders/continue",e,"user","api","rpc","sharing.read")};Te.sharingListReceivedFiles=function(e){return this.request("sharing/list_received_files",e,"user","api","rpc","sharing.read")};Te.sharingListReceivedFilesContinue=function(e){return this.request("sharing/list_received_files/continue",e,"user","api","rpc","sharing.read")};Te.sharingListSharedLinks=function(e){return this.request("sharing/list_shared_links",e,"user","api","rpc","sharing.read")};Te.sharingModifySharedLinkSettings=function(e){return this.request("sharing/modify_shared_link_settings",e,"user","api","rpc","sharing.write")};Te.sharingMountFolder=function(e){return this.request("sharing/mount_folder",e,"user","api","rpc","sharing.write")};Te.sharingRelinquishFileMembership=function(e){return this.request("sharing/relinquish_file_membership",e,"user","api","rpc","sharing.write")};Te.sharingRelinquishFolderMembership=function(e){return this.request("sharing/relinquish_folder_membership",e,"user","api","rpc","sharing.write")};Te.sharingRemoveFileMember=function(e){return this.request("sharing/remove_file_member",e,"user","api","rpc","sharing.write")};Te.sharingRemoveFileMember2=function(e){return this.request("sharing/remove_file_member_2",e,"user","api","rpc","sharing.write")};Te.sharingRemoveFolderMember=function(e){return this.request("sharing/remove_folder_member",e,"user","api","rpc","sharing.write")};Te.sharingRevokeSharedLink=function(e){return this.request("sharing/revoke_shared_link",e,"user","api","rpc","sharing.write")};Te.sharingSetAccessInheritance=function(e){return this.request("sharing/set_access_inheritance",e,"user","api","rpc","sharing.write")};Te.sharingShareFolder=function(e){return this.request("sharing/share_folder",e,"user","api","rpc","sharing.write")};Te.sharingTransferFolder=function(e){return this.request("sharing/transfer_folder",e,"user","api","rpc","sharing.write")};Te.sharingUnmountFolder=function(e){return this.request("sharing/unmount_folder",e,"user","api","rpc","sharing.write")};Te.sharingUnshareFile=function(e){return this.request("sharing/unshare_file",e,"user","api","rpc","sharing.write")};Te.sharingUnshareFolder=function(e){return this.request("sharing/unshare_folder",e,"user","api","rpc","sharing.write")};Te.sharingUpdateFileMember=function(e){return this.request("sharing/update_file_member",e,"user","api","rpc","sharing.write")};Te.sharingUpdateFolderMember=function(e){return this.request("sharing/update_folder_member",e,"user","api","rpc","sharing.write")};Te.sharingUpdateFolderPolicy=function(e){return this.request("sharing/update_folder_policy",e,"user","api","rpc","sharing.write")};Te.teamDevicesListMemberDevices=function(e){return this.request("team/devices/list_member_devices",e,"team","api","rpc","sessions.list")};Te.teamDevicesListMembersDevices=function(e){return this.request("team/devices/list_members_devices",e,"team","api","rpc","sessions.list")};Te.teamDevicesListTeamDevices=function(e){return this.request("team/devices/list_team_devices",e,"team","api","rpc","sessions.list")};Te.teamDevicesRevokeDeviceSession=function(e){return this.request("team/devices/revoke_device_session",e,"team","api","rpc","sessions.modify")};Te.teamDevicesRevokeDeviceSessionBatch=function(e){return this.request("team/devices/revoke_device_session_batch",e,"team","api","rpc","sessions.modify")};Te.teamFeaturesGetValues=function(e){return this.request("team/features/get_values",e,"team","api","rpc","team_info.read")};Te.teamGetInfo=function(){return this.request("team/get_info",null,"team","api","rpc","team_info.read")};Te.teamGroupsCreate=function(e){return this.request("team/groups/create",e,"team","api","rpc","groups.write")};Te.teamGroupsDelete=function(e){return this.request("team/groups/delete",e,"team","api","rpc","groups.write")};Te.teamGroupsGetInfo=function(e){return this.request("team/groups/get_info",e,"team","api","rpc","groups.read")};Te.teamGroupsJobStatusGet=function(e){return this.request("team/groups/job_status/get",e,"team","api","rpc","groups.write")};Te.teamGroupsList=function(e){return this.request("team/groups/list",e,"team","api","rpc","groups.read")};Te.teamGroupsListContinue=function(e){return this.request("team/groups/list/continue",e,"team","api","rpc","groups.read")};Te.teamGroupsMembersAdd=function(e){return this.request("team/groups/members/add",e,"team","api","rpc","groups.write")};Te.teamGroupsMembersList=function(e){return this.request("team/groups/members/list",e,"team","api","rpc","groups.read")};Te.teamGroupsMembersListContinue=function(e){return this.request("team/groups/members/list/continue",e,"team","api","rpc","groups.read")};Te.teamGroupsMembersRemove=function(e){return this.request("team/groups/members/remove",e,"team","api","rpc","groups.write")};Te.teamGroupsMembersSetAccessType=function(e){return this.request("team/groups/members/set_access_type",e,"team","api","rpc","groups.write")};Te.teamGroupsUpdate=function(e){return this.request("team/groups/update",e,"team","api","rpc","groups.write")};Te.teamLegalHoldsCreatePolicy=function(e){return this.request("team/legal_holds/create_policy",e,"team","api","rpc","team_data.governance.write")};Te.teamLegalHoldsGetPolicy=function(e){return this.request("team/legal_holds/get_policy",e,"team","api","rpc","team_data.governance.write")};Te.teamLegalHoldsListHeldRevisions=function(e){return this.request("team/legal_holds/list_held_revisions",e,"team","api","rpc","team_data.governance.write")};Te.teamLegalHoldsListHeldRevisionsContinue=function(e){return this.request("team/legal_holds/list_held_revisions_continue",e,"team","api","rpc","team_data.governance.write")};Te.teamLegalHoldsListPolicies=function(e){return this.request("team/legal_holds/list_policies",e,"team","api","rpc","team_data.governance.write")};Te.teamLegalHoldsReleasePolicy=function(e){return this.request("team/legal_holds/release_policy",e,"team","api","rpc","team_data.governance.write")};Te.teamLegalHoldsUpdatePolicy=function(e){return this.request("team/legal_holds/update_policy",e,"team","api","rpc","team_data.governance.write")};Te.teamLinkedAppsListMemberLinkedApps=function(e){return this.request("team/linked_apps/list_member_linked_apps",e,"team","api","rpc","sessions.list")};Te.teamLinkedAppsListMembersLinkedApps=function(e){return this.request("team/linked_apps/list_members_linked_apps",e,"team","api","rpc","sessions.list")};Te.teamLinkedAppsListTeamLinkedApps=function(e){return this.request("team/linked_apps/list_team_linked_apps",e,"team","api","rpc","sessions.list")};Te.teamLinkedAppsRevokeLinkedApp=function(e){return this.request("team/linked_apps/revoke_linked_app",e,"team","api","rpc","sessions.modify")};Te.teamLinkedAppsRevokeLinkedAppBatch=function(e){return this.request("team/linked_apps/revoke_linked_app_batch",e,"team","api","rpc","sessions.modify")};Te.teamMemberSpaceLimitsExcludedUsersAdd=function(e){return this.request("team/member_space_limits/excluded_users/add",e,"team","api","rpc","members.write")};Te.teamMemberSpaceLimitsExcludedUsersList=function(e){return this.request("team/member_space_limits/excluded_users/list",e,"team","api","rpc","members.read")};Te.teamMemberSpaceLimitsExcludedUsersListContinue=function(e){return this.request("team/member_space_limits/excluded_users/list/continue",e,"team","api","rpc","members.read")};Te.teamMemberSpaceLimitsExcludedUsersRemove=function(e){return this.request("team/member_space_limits/excluded_users/remove",e,"team","api","rpc","members.write")};Te.teamMemberSpaceLimitsGetCustomQuota=function(e){return this.request("team/member_space_limits/get_custom_quota",e,"team","api","rpc","members.read")};Te.teamMemberSpaceLimitsRemoveCustomQuota=function(e){return this.request("team/member_space_limits/remove_custom_quota",e,"team","api","rpc","members.write")};Te.teamMemberSpaceLimitsSetCustomQuota=function(e){return this.request("team/member_space_limits/set_custom_quota",e,"team","api","rpc","members.read")};Te.teamMembersAddV2=function(e){return this.request("team/members/add_v2",e,"team","api","rpc","members.write")};Te.teamMembersAdd=function(e){return this.request("team/members/add",e,"team","api","rpc","members.write")};Te.teamMembersAddJobStatusGetV2=function(e){return this.request("team/members/add/job_status/get_v2",e,"team","api","rpc","members.write")};Te.teamMembersAddJobStatusGet=function(e){return this.request("team/members/add/job_status/get",e,"team","api","rpc","members.write")};Te.teamMembersDeleteProfilePhotoV2=function(e){return this.request("team/members/delete_profile_photo_v2",e,"team","api","rpc","members.write")};Te.teamMembersDeleteProfilePhoto=function(e){return this.request("team/members/delete_profile_photo",e,"team","api","rpc","members.write")};Te.teamMembersGetAvailableTeamMemberRoles=function(){return this.request("team/members/get_available_team_member_roles",null,"team","api","rpc","members.read")};Te.teamMembersGetInfoV2=function(e){return this.request("team/members/get_info_v2",e,"team","api","rpc","members.read")};Te.teamMembersGetInfo=function(e){return this.request("team/members/get_info",e,"team","api","rpc","members.read")};Te.teamMembersListV2=function(e){return this.request("team/members/list_v2",e,"team","api","rpc","members.read")};Te.teamMembersList=function(e){return this.request("team/members/list",e,"team","api","rpc","members.read")};Te.teamMembersListContinueV2=function(e){return this.request("team/members/list/continue_v2",e,"team","api","rpc","members.read")};Te.teamMembersListContinue=function(e){return this.request("team/members/list/continue",e,"team","api","rpc","members.read")};Te.teamMembersMoveFormerMemberFiles=function(e){return this.request("team/members/move_former_member_files",e,"team","api","rpc","members.write")};Te.teamMembersMoveFormerMemberFilesJobStatusCheck=function(e){return this.request("team/members/move_former_member_files/job_status/check",e,"team","api","rpc","members.write")};Te.teamMembersRecover=function(e){return this.request("team/members/recover",e,"team","api","rpc","members.delete")};Te.teamMembersRemove=function(e){return this.request("team/members/remove",e,"team","api","rpc","members.delete")};Te.teamMembersRemoveJobStatusGet=function(e){return this.request("team/members/remove/job_status/get",e,"team","api","rpc","members.delete")};Te.teamMembersSecondaryEmailsAdd=function(e){return this.request("team/members/secondary_emails/add",e,"team","api","rpc","members.write")};Te.teamMembersSecondaryEmailsDelete=function(e){return this.request("team/members/secondary_emails/delete",e,"team","api","rpc","members.write")};Te.teamMembersSecondaryEmailsResendVerificationEmails=function(e){return this.request("team/members/secondary_emails/resend_verification_emails",e,"team","api","rpc","members.write")};Te.teamMembersSendWelcomeEmail=function(e){return this.request("team/members/send_welcome_email",e,"team","api","rpc","members.write")};Te.teamMembersSetAdminPermissionsV2=function(e){return this.request("team/members/set_admin_permissions_v2",e,"team","api","rpc","members.write")};Te.teamMembersSetAdminPermissions=function(e){return this.request("team/members/set_admin_permissions",e,"team","api","rpc","members.write")};Te.teamMembersSetProfileV2=function(e){return this.request("team/members/set_profile_v2",e,"team","api","rpc","members.write")};Te.teamMembersSetProfile=function(e){return this.request("team/members/set_profile",e,"team","api","rpc","members.write")};Te.teamMembersSetProfilePhotoV2=function(e){return this.request("team/members/set_profile_photo_v2",e,"team","api","rpc","members.write")};Te.teamMembersSetProfilePhoto=function(e){return this.request("team/members/set_profile_photo",e,"team","api","rpc","members.write")};Te.teamMembersSuspend=function(e){return this.request("team/members/suspend",e,"team","api","rpc","members.write")};Te.teamMembersUnsuspend=function(e){return this.request("team/members/unsuspend",e,"team","api","rpc","members.write")};Te.teamNamespacesList=function(e){return this.request("team/namespaces/list",e,"team","api","rpc","team_data.member")};Te.teamNamespacesListContinue=function(e){return this.request("team/namespaces/list/continue",e,"team","api","rpc","team_data.member")};Te.teamPropertiesTemplateAdd=function(e){return this.request("team/properties/template/add",e,"team","api","rpc","files.team_metadata.write")};Te.teamPropertiesTemplateGet=function(e){return this.request("team/properties/template/get",e,"team","api","rpc","files.team_metadata.write")};Te.teamPropertiesTemplateList=function(){return this.request("team/properties/template/list",null,"team","api","rpc","files.team_metadata.write")};Te.teamPropertiesTemplateUpdate=function(e){return this.request("team/properties/template/update",e,"team","api","rpc","files.team_metadata.write")};Te.teamReportsGetActivity=function(e){return this.request("team/reports/get_activity",e,"team","api","rpc","team_info.read")};Te.teamReportsGetDevices=function(e){return this.request("team/reports/get_devices",e,"team","api","rpc","team_info.read")};Te.teamReportsGetMembership=function(e){return this.request("team/reports/get_membership",e,"team","api","rpc","team_info.read")};Te.teamReportsGetStorage=function(e){return this.request("team/reports/get_storage",e,"team","api","rpc","team_info.read")};Te.teamSharingAllowlistAdd=function(e){return this.request("team/sharing_allowlist/add",e,"team","api","rpc","team_info.write")};Te.teamSharingAllowlistList=function(e){return this.request("team/sharing_allowlist/list",e,"team","api","rpc","team_info.read")};Te.teamSharingAllowlistListContinue=function(e){return this.request("team/sharing_allowlist/list/continue",e,"team","api","rpc","team_info.read")};Te.teamSharingAllowlistRemove=function(e){return this.request("team/sharing_allowlist/remove",e,"team","api","rpc","team_info.write")};Te.teamTeamFolderActivate=function(e){return this.request("team/team_folder/activate",e,"team","api","rpc","team_data.content.write")};Te.teamTeamFolderArchive=function(e){return this.request("team/team_folder/archive",e,"team","api","rpc","team_data.content.write")};Te.teamTeamFolderArchiveCheck=function(e){return this.request("team/team_folder/archive/check",e,"team","api","rpc","team_data.content.write")};Te.teamTeamFolderCreate=function(e){return this.request("team/team_folder/create",e,"team","api","rpc","team_data.content.write")};Te.teamTeamFolderGetInfo=function(e){return this.request("team/team_folder/get_info",e,"team","api","rpc","team_data.content.read")};Te.teamTeamFolderList=function(e){return this.request("team/team_folder/list",e,"team","api","rpc","team_data.content.read")};Te.teamTeamFolderListContinue=function(e){return this.request("team/team_folder/list/continue",e,"team","api","rpc","team_data.content.read")};Te.teamTeamFolderPermanentlyDelete=function(e){return this.request("team/team_folder/permanently_delete",e,"team","api","rpc","team_data.content.write")};Te.teamTeamFolderRename=function(e){return this.request("team/team_folder/rename",e,"team","api","rpc","team_data.content.write")};Te.teamTeamFolderUpdateSyncSettings=function(e){return this.request("team/team_folder/update_sync_settings",e,"team","api","rpc","team_data.content.write")};Te.teamTokenGetAuthenticatedAdmin=function(){return this.request("team/token/get_authenticated_admin",null,"team","api","rpc","team_info.read")};Te.teamLogGetEvents=function(e){return this.request("team_log/get_events",e,"team","api","rpc","events.read")};Te.teamLogGetEventsContinue=function(e){return this.request("team_log/get_events/continue",e,"team","api","rpc","events.read")};Te.usersFeaturesGetValues=function(e){return this.request("users/features/get_values",e,"user","api","rpc","account_info.read")};Te.usersGetAccount=function(e){return this.request("users/get_account",e,"user","api","rpc","sharing.read")};Te.usersGetAccountBatch=function(e){return this.request("users/get_account_batch",e,"user","api","rpc","sharing.read")};Te.usersGetCurrentAccount=function(){return this.request("users/get_current_account",null,"user","api","rpc","account_info.read")};Te.usersGetSpaceUsage=function(){return this.request("users/get_space_usage",null,"user","api","rpc","account_info.read")};function aL(e){var t="000".concat(e.charCodeAt(0).toString(16)).slice(-4);return"\\u".concat(t)}var Bx=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";return s?(r!==w0&&fy[t]!==void 0&&(t=fy[t],s="-"),"https://".concat(t).concat(s).concat(r,"/2/")):"https://".concat(r,"/2/")},nL=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:MS;return t!==MS&&(t="meta-".concat(t)),"https://".concat(t,"/oauth2/authorize")},PS=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:w0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:".",s="api";return t!==w0&&(s=fy[s],r="-"),"https://".concat(s).concat(r).concat(t,"/oauth2/token")};function BS(e){return JSON.stringify(e).replace(/[\u007f-\uffff]/g,aL)}function iL(e){return new Date(Date.now()+e*1e3)}function US(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope||typeof module>"u"||typeof window<"u"}function Ux(){return typeof window<"u"}function zx(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function kh(e){var t=e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");return t}function a0(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?a0=function(r){return typeof r}:a0=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},a0(e)}function oL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lL(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kd(e,t)}function cL(e){var t=p4();return function(){var s=Nd(e),a;if(t){var o=Nd(this).constructor;a=Reflect.construct(s,arguments,o)}else a=s.apply(this,arguments);return uL(this,a)}}function uL(e,t){return t&&(a0(t)==="object"||typeof t=="function")?t:dL(e)}function dL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hy(e){var t=typeof Map=="function"?new Map:void 0;return hy=function(s){if(s===null||!fL(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(s))return t.get(s);t.set(s,a)}function a(){return n0(s,arguments,Nd(this).constructor)}return a.prototype=Object.create(s.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),kd(a,s)},hy(e)}function n0(e,t,r){return p4()?n0=Reflect.construct:n0=function(a,o,c){var u=[null];u.push.apply(u,o);var d=Function.bind.apply(a,u),h=new d;return c&&kd(h,c.prototype),h},n0.apply(null,arguments)}function p4(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function fL(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function kd(e,t){return kd=Object.setPrototypeOf||function(s,a){return s.__proto__=a,s},kd(e,t)}function Nd(e){return Nd=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Nd(e)}var hL=(function(e){lL(r,e);var t=cL(r);function r(s,a,o){var c;return oL(this,r),c=t.call(this,"Response failed with a ".concat(s," code")),c.name="DropboxResponseError",c.status=s,c.headers=a,c.error=o,c}return r})(hy(Error));function mL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var x4=function e(t,r,s){mL(this,e),this.status=t,this.headers=r,this.result=s};function g4(e){return e.text().then(function(t){var r;try{r=JSON.parse(t)}catch{r=t}throw new hL(e.status,e.headers,r)})}function b0(e){return e.ok?e.text().then(function(t){var r;try{r=JSON.parse(t)}catch{r=t}return new x4(e.status,e.headers,r)}):g4(e)}function pL(e){return e.ok?new Promise(function(t){US()?e.blob().then(function(r){return t(r)}):e.buffer().then(function(r){return t(r)})}).then(function(t){var r=JSON.parse(e.headers.get("dropbox-api-result"));return US()?r.fileBlob=t:r.fileBinary=t,new x4(e.status,e.headers,r)}):g4(e)}function xL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gL(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function yL(e,t,r){return t&&gL(e.prototype,t),e}var Nh,Io,qx,vL=300*1e3,zS=128,wL=["legacy","offline","online"],bL=["code","token"],_L=["none","user","team"],SL=(function(){function e(t){xL(this,e),t=t||{},Ux()?(Nh=window.fetch.bind(window),Io=window.crypto||window.msCrypto):zx()?(Nh=self.fetch.bind(self),Io=self.crypto):(Nh=require("node-fetch"),Io=require("crypto")),typeof TextEncoder>"u"?qx=require("util").TextEncoder:qx=TextEncoder,this.fetch=t.fetch||Nh,this.accessToken=t.accessToken,this.accessTokenExpiresAt=t.accessTokenExpiresAt,this.refreshToken=t.refreshToken,this.clientId=t.clientId,this.clientSecret=t.clientSecret,this.domain=t.domain,this.domainDelimiter=t.domainDelimiter,this.customHeaders=t.customHeaders,this.dataOnBody=t.dataOnBody}return yL(e,[{key:"setAccessToken",value:function(r){this.accessToken=r}},{key:"getAccessToken",value:function(){return this.accessToken}},{key:"setClientId",value:function(r){this.clientId=r}},{key:"getClientId",value:function(){return this.clientId}},{key:"setClientSecret",value:function(r){this.clientSecret=r}},{key:"getClientSecret",value:function(){return this.clientSecret}},{key:"getRefreshToken",value:function(){return this.refreshToken}},{key:"setRefreshToken",value:function(r){this.refreshToken=r}},{key:"getAccessTokenExpiresAt",value:function(){return this.accessTokenExpiresAt}},{key:"setAccessTokenExpiresAt",value:function(r){this.accessTokenExpiresAt=r}},{key:"setCodeVerifier",value:function(r){this.codeVerifier=r}},{key:"getCodeVerifier",value:function(){return this.codeVerifier}},{key:"generateCodeChallenge",value:function(){var r=this,s=new qx,a=s.encode(this.codeVerifier),o;if(Ux()||zx())return Io.subtle.digest("SHA-256",a).then(function(u){var d=btoa(String.fromCharCode.apply(null,new Uint8Array(u)));o=kh(d).substr(0,128),r.codeChallenge=o});var c=Io.createHash("sha256").update(a).digest();return o=kh(c),this.codeChallenge=o,Promise.resolve()}},{key:"generatePKCECodes",value:function(){var r;if(Ux()||zx()){var s=new Uint8Array(zS),a=Io.getRandomValues(s),o=btoa(a);r=kh(o).substr(0,128)}else{var c=Io.randomBytes(zS);r=kh(c).substr(0,128)}return this.codeVerifier=r,this.generateCodeChallenge()}},{key:"getAuthenticationUrl",value:function(r,s){var a=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"token",c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,d=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"none",h=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,m=this.getClientId(),x=nL(this.domain);if(!m)throw new Error("A client id is required. You can set the client id using .setClientId().");if(o!=="code"&&!r)throw new Error("A redirect uri is required.");if(!bL.includes(o))throw new Error("Authorization type must be code or token");if(c&&!wL.includes(c))throw new Error("Token Access Type must be legacy, offline, or online");if(u&&!(u instanceof Array))throw new Error("Scope must be an array of strings");if(!_L.includes(d))throw new Error("includeGrantedScopes must be none, user, or team");var y;return o==="code"?y="".concat(x,"?response_type=code&client_id=").concat(m):y="".concat(x,"?response_type=token&client_id=").concat(m),r&&(y+="&redirect_uri=".concat(r)),s&&(y+="&state=".concat(s)),c&&(y+="&token_access_type=".concat(c)),u&&(y+="&scope=".concat(u.join(" "))),d!=="none"&&(y+="&include_granted_scopes=".concat(d)),h?this.generatePKCECodes().then(function(){return y+="&code_challenge_method=S256",y+="&code_challenge=".concat(a.codeChallenge),y}):Promise.resolve(y)}},{key:"getAccessTokenFromCode",value:function(r,s){var a=this.getClientId(),o=this.getClientSecret();if(!a)throw new Error("A client id is required. You can set the client id using .setClientId().");var c=PS(this.domain,this.domainDelimiter);if(c+="?grant_type=authorization_code",c+="&code=".concat(s),c+="&client_id=".concat(a),o)c+="&client_secret=".concat(o);else{if(!this.codeVerifier)throw new Error("You must use PKCE when generating the authorization URL to not include a client secret");c+="&code_verifier=".concat(this.codeVerifier)}r&&(c+="&redirect_uri=".concat(r));var u={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}};return this.fetch(c,u).then(function(d){return b0(d)})}},{key:"checkAndRefreshAccessToken",value:function(){var r=this.getRefreshToken()&&this.getClientId(),s=!this.getAccessTokenExpiresAt()||new Date(Date.now()+vL)>=this.getAccessTokenExpiresAt(),a=!this.getAccessToken();return(s||a)&&r?this.refreshAccessToken():Promise.resolve()}},{key:"refreshAccessToken",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,a=this.getClientId(),o=this.getClientSecret();if(!a)throw new Error("A client id is required. You can set the client id using .setClientId().");if(s&&!(s instanceof Array))throw new Error("Scope must be an array of strings");var c=PS(this.domain,this.domainDelimiter),u={headers:{"Content-Type":"application/json"},method:"POST"};if(this.dataOnBody){var d={grant_type:"refresh_token",client_id:a,refresh_token:this.getRefreshToken()};o&&(d.client_secret=o),s&&(d.scope=s.join(" ")),u.body=d}else c+="?grant_type=refresh_token&refresh_token=".concat(this.getRefreshToken()),c+="&client_id=".concat(a),o&&(c+="&client_secret=".concat(o)),s&&(c+="&scope=".concat(s.join(" ")));return this.fetch(c,u).then(function(h){return b0(h)}).then(function(h){r.setAccessToken(h.result.access_token),r.setAccessTokenExpiresAt(iL(h.result.expires_in))})}}]),e})();function kL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NL(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function EL(e,t,r){return t&&NL(e.prototype,t),e}var jL=typeof btoa>"u"?function(e){return Buffer.from(e).toString("base64")}:btoa,TL=(function(){function e(t){kL(this,e),t=t||{},t.auth?this.auth=t.auth:this.auth=new SL(t),this.fetch=t.fetch||this.auth.fetch,this.selectUser=t.selectUser,this.selectAdmin=t.selectAdmin,this.pathRoot=t.pathRoot,this.domain=t.domain||this.auth.domain,this.domainDelimiter=t.domainDelimiter||this.auth.domainDelimiter,this.customHeaders=t.customHeaders||this.auth.customHeaders,Object.assign(this,Te)}return EL(e,[{key:"request",value:function(r,s,a,o,c){switch(c){case QF:return this.rpcRequest(r,s,a,o);case tL:return this.downloadRequest(r,s,a,o);case eL:return this.uploadRequest(r,s,a,o);default:throw new Error("Invalid request style: ".concat(c))}}},{key:"rpcRequest",value:function(r,s,a,o){var c=this;return this.auth.checkAndRefreshAccessToken().then(function(){var u={method:"POST",body:s?JSON.stringify(s):null,headers:{}};return s&&(u.headers["Content-Type"]="application/json"),c.setAuthHeaders(a,u),c.setCommonHeaders(u),u}).then(function(u){return c.fetch(Bx(o,c.domain,c.domainDelimiter)+r,u)}).then(function(u){return b0(u)})}},{key:"downloadRequest",value:function(r,s,a,o){var c=this;return this.auth.checkAndRefreshAccessToken().then(function(){var u={method:"POST",headers:{"Dropbox-API-Arg":BS(s)}};return c.setAuthHeaders(a,u),c.setCommonHeaders(u),u}).then(function(u){return c.fetch(Bx(o,c.domain,c.domainDelimiter)+r,u)}).then(function(u){return pL(u)})}},{key:"uploadRequest",value:function(r,s,a,o){var c=this;return this.auth.checkAndRefreshAccessToken().then(function(){var u=s.contents;delete s.contents;var d={body:u,method:"POST",headers:{"Content-Type":"application/octet-stream","Dropbox-API-Arg":BS(s)}};return c.setAuthHeaders(a,d),c.setCommonHeaders(d),d}).then(function(u){return c.fetch(Bx(o,c.domain,c.domainDelimiter)+r,u)}).then(function(u){return b0(u)})}},{key:"setAuthHeaders",value:function(r,s){if(r.split(",").length>1){var a=r.replace(" ","").split(",");a.includes(Mx)&&this.auth.getAccessToken()?r=Mx:a.includes(Px)&&this.auth.getAccessToken()?r=Px:a.includes(Ix)&&(r=Ix)}switch(r){case Ix:if(this.auth.clientId&&this.auth.clientSecret){var o=jL("".concat(this.auth.clientId,":").concat(this.auth.clientSecret));s.headers.Authorization="Basic ".concat(o)}break;case Px:case Mx:this.auth.getAccessToken()&&(s.headers.Authorization="Bearer ".concat(this.auth.getAccessToken()));break;case rL:case sL:break;default:throw new Error("Unhandled auth type: ".concat(r))}}},{key:"setCommonHeaders",value:function(r){var s=this;if(this.selectUser&&(r.headers["Dropbox-API-Select-User"]=this.selectUser),this.selectAdmin&&(r.headers["Dropbox-API-Select-Admin"]=this.selectAdmin),this.pathRoot&&(r.headers["Dropbox-API-Path-Root"]=this.pathRoot),this.customHeaders){var a=Object.keys(this.customHeaders);a.forEach(function(o){r.headers[o]=s.customHeaders[o]})}}}]),e})();const AL="fvr4cismfdje3d8",CL="ov7ykh1arjvag8q",RL="wCxiziVcNH0AAAAAAAAAATYQOTE7ajbAsA4aSyDz0_B0YMpZ5jqrelvDPamyPrf4";let Eh=null,$x=null;const DL=async()=>{if(Eh&&$x&&Date.now()<$x-6e5)return Eh;const e=await fetch("https://api.dropbox.com/oauth2/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:RL,client_id:AL,client_secret:CL})});if(!e.ok){const r=await e.json();throw console.error("Token refresh error:",r),new Error("Access Token  : "+(r.error_description||r.error))}const t=await e.json();return Eh=t.access_token,$x=Date.now()+t.expires_in*1e3,Eh},ml=async()=>{const e=await DL();return new TL({accessToken:e})},i0=async(e,t="/intranet")=>{try{const r=await ml(),a=`${Date.now()}_${e.name}`,o=`${t}/${a}`,c=await e.arrayBuffer(),u=await r.filesUpload({path:o,contents:c,mode:{".tag":"add"},autorename:!0});let d;try{d=(await r.sharingCreateSharedLinkWithSettings({path:u.result.path_display,settings:{requested_visibility:{".tag":"public"},audience:{".tag":"public"},access:{".tag":"viewer"}}})).result.url}catch(m){if(m.error?.error?.[".tag"]==="shared_link_already_exists")d=(await r.sharingListSharedLinks({path:u.result.path_display})).result.links[0]?.url;else throw m}return{url:d.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0",""),name:e.name,path:u.result.path_display,size:e.size}}catch(r){throw console.error("Dropbox upload error:",r),console.error("Error details:",JSON.stringify(r,null,2)),r.error&&console.error("Error response:",r.error),new Error("  : "+(r.error?.error_summary||r.message||"   "))}},Gd=async(e,t="/intranet")=>{const r=[];for(const s of e){const a=await i0(s,t);r.push(a)}return r},OL=async e=>{try{return await(await ml()).filesDeleteV2({path:e}),!0}catch(t){return console.error("Dropbox delete error:",t),!1}},o0=async e=>{try{if(!e)return!1;let t=e.replace("dl.dropboxusercontent.com","www.dropbox.com");t.includes("dl=")||(t+=t.includes("?")?"&dl=0":"?dl=0");const r=await ml(),s=await r.sharingGetSharedLinkMetadata({url:t});return s.result?.path_lower?(await r.filesDeleteV2({path:s.result.path_lower}),!0):!1}catch(t){return console.error("Dropbox delete by URL error:",t),!!(t.error?.error?.[".tag"]==="path"||t.error?.error_summary?.includes("not_found"))}},$0=async e=>{if(!(!e||e.length===0))for(const t of e){const r=typeof t=="string"?t:t?.url;r&&await o0(r)}},FL=async(e="")=>{try{return(await(await ml()).filesListFolder({path:e})).result.entries.map(a=>({name:a.name,path:a.path_display,id:a.id,isFolder:a[".tag"]==="folder",size:a.size||0,modified:a.client_modified||a.server_modified}))}catch(t){throw console.error("Dropbox list files error:",t),new Error("   : "+(t.error?.error_summary||t.message))}},LL=async e=>{try{return(await(await ml()).filesGetTemporaryLink({path:e})).result.link}catch(t){throw console.error("Dropbox get download link error:",t),new Error("   .")}},IL=async(e,t="/")=>{try{const r=await ml(),s=`${t}/${e.name}`,a=await e.arrayBuffer();return{path:(await r.filesUpload({path:s,contents:a,mode:{".tag":"overwrite"},autorename:!1})).result.path_display,name:e.name,size:e.size}}catch(r){throw console.error("Dropbox upload error:",r),new Error("  : "+(r.error?.error_summary||r.message))}},qS=async e=>{try{return await(await ml()).filesCreateFolderV2({path:e,autorename:!1}),!0}catch(t){if(t.error?.error?.[".tag"]==="path"&&t.error?.error?.path?.[".tag"]==="conflict")return!0;throw console.error("Dropbox create folder error:",t),new Error("  : "+(t.error?.error_summary||t.message))}};var ML=Object.defineProperty,PL=Object.defineProperties,BL=Object.getOwnPropertyDescriptors,$S=Object.getOwnPropertySymbols,UL=Object.prototype.hasOwnProperty,zL=Object.prototype.propertyIsEnumerable,my=(e,t,r)=>t in e?ML(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ar=(e,t)=>{for(var r in t||(t={}))UL.call(t,r)&&my(e,r,t[r]);if($S)for(var r of $S(t))zL.call(t,r)&&my(e,r,t[r]);return e},yi=(e,t)=>PL(e,BL(t)),Qe=(e,t,r)=>my(e,typeof t!="symbol"?t+"":t,r),qL=(e,t,r)=>new Promise((s,a)=>{var o=d=>{try{u(r.next(d))}catch(h){a(h)}},c=d=>{try{u(r.throw(d))}catch(h){a(h)}},u=d=>d.done?s(d.value):Promise.resolve(d.value).then(o,c);u((r=r.apply(e,t)).next())});class _0{constructor(t){Qe(this,"rootKey"),this.rootKey=t}}const $L=Object.seal({});class tt extends _0{constructor(t){super(t),Qe(this,"root"),this.root=new Array}prepForXml(t){var r;t.stack.push(this);const s=this.root.map(a=>a instanceof _0?a.prepForXml(t):a).filter(a=>a!==void 0);return t.stack.pop(),{[this.rootKey]:s.length?s.length===1&&((r=s[0])!=null&&r._attr)?s[0]:s:$L}}addChildElement(t){return this.root.push(t),this}}class _i extends tt{prepForXml(t){const r=super.prepForXml(t);if(r&&(typeof r[this.rootKey]!="object"||Object.keys(r[this.rootKey]).length))return r}}class Ct extends _0{constructor(t){super("_attr"),Qe(this,"xmlKeys"),this.root=t}prepForXml(t){const r={};return Object.entries(this.root).forEach(([s,a])=>{if(a!==void 0){const o=this.xmlKeys&&this.xmlKeys[s]||s;r[o]=a}}),{_attr:r}}}class Si extends _0{constructor(t){super("_attr"),this.root=t}prepForXml(t){return{_attr:Object.values(this.root).filter(({value:s})=>s!==void 0).reduce((s,{key:a,value:o})=>yi(ar({},s),{[a]:o}),{})}}}class ls extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}}var Mn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Hx={},jh={exports:{}},HS;function Qy(){if(HS)return jh.exports;HS=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(R,L,O){return Function.prototype.apply.call(R,L,O)},r;e&&typeof e.ownKeys=="function"?r=e.ownKeys:Object.getOwnPropertySymbols?r=function(R){return Object.getOwnPropertyNames(R).concat(Object.getOwnPropertySymbols(R))}:r=function(R){return Object.getOwnPropertyNames(R)};function s(E){console&&console.warn&&console.warn(E)}var a=Number.isNaN||function(R){return R!==R};function o(){o.init.call(this)}jh.exports=o,jh.exports.once=b,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var c=10;function u(E){if(typeof E!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(E){if(typeof E!="number"||E<0||a(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");c=E}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(R){if(typeof R!="number"||R<0||a(R))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+R+".");return this._maxListeners=R,this};function d(E){return E._maxListeners===void 0?o.defaultMaxListeners:E._maxListeners}o.prototype.getMaxListeners=function(){return d(this)},o.prototype.emit=function(R){for(var L=[],O=1;O<arguments.length;O++)L.push(arguments[O]);var P=R==="error",F=this._events;if(F!==void 0)P=P&&F.error===void 0;else if(!P)return!1;if(P){var V;if(L.length>0&&(V=L[0]),V instanceof Error)throw V;var oe=new Error("Unhandled error."+(V?" ("+V.message+")":""));throw oe.context=V,oe}var D=F[R];if(D===void 0)return!1;if(typeof D=="function")t(D,this,L);else for(var K=D.length,M=w(D,K),O=0;O<K;++O)t(M[O],this,L);return!0};function h(E,R,L,O){var P,F,V;if(u(L),F=E._events,F===void 0?(F=E._events=Object.create(null),E._eventsCount=0):(F.newListener!==void 0&&(E.emit("newListener",R,L.listener?L.listener:L),F=E._events),V=F[R]),V===void 0)V=F[R]=L,++E._eventsCount;else if(typeof V=="function"?V=F[R]=O?[L,V]:[V,L]:O?V.unshift(L):V.push(L),P=d(E),P>0&&V.length>P&&!V.warned){V.warned=!0;var oe=new Error("Possible EventEmitter memory leak detected. "+V.length+" "+String(R)+" listeners added. Use emitter.setMaxListeners() to increase limit");oe.name="MaxListenersExceededWarning",oe.emitter=E,oe.type=R,oe.count=V.length,s(oe)}return E}o.prototype.addListener=function(R,L){return h(this,R,L,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(R,L){return h(this,R,L,!0)};function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function x(E,R,L){var O={fired:!1,wrapFn:void 0,target:E,type:R,listener:L},P=m.bind(O);return P.listener=L,O.wrapFn=P,P}o.prototype.once=function(R,L){return u(L),this.on(R,x(this,R,L)),this},o.prototype.prependOnceListener=function(R,L){return u(L),this.prependListener(R,x(this,R,L)),this},o.prototype.removeListener=function(R,L){var O,P,F,V,oe;if(u(L),P=this._events,P===void 0)return this;if(O=P[R],O===void 0)return this;if(O===L||O.listener===L)--this._eventsCount===0?this._events=Object.create(null):(delete P[R],P.removeListener&&this.emit("removeListener",R,O.listener||L));else if(typeof O!="function"){for(F=-1,V=O.length-1;V>=0;V--)if(O[V]===L||O[V].listener===L){oe=O[V].listener,F=V;break}if(F<0)return this;F===0?O.shift():g(O,F),O.length===1&&(P[R]=O[0]),P.removeListener!==void 0&&this.emit("removeListener",R,oe||L)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(R){var L,O,P;if(O=this._events,O===void 0)return this;if(O.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):O[R]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete O[R]),this;if(arguments.length===0){var F=Object.keys(O),V;for(P=0;P<F.length;++P)V=F[P],V!=="removeListener"&&this.removeAllListeners(V);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(L=O[R],typeof L=="function")this.removeListener(R,L);else if(L!==void 0)for(P=L.length-1;P>=0;P--)this.removeListener(R,L[P]);return this};function y(E,R,L){var O=E._events;if(O===void 0)return[];var P=O[R];return P===void 0?[]:typeof P=="function"?L?[P.listener||P]:[P]:L?_(P):w(P,P.length)}o.prototype.listeners=function(R){return y(this,R,!0)},o.prototype.rawListeners=function(R){return y(this,R,!1)},o.listenerCount=function(E,R){return typeof E.listenerCount=="function"?E.listenerCount(R):v.call(E,R)},o.prototype.listenerCount=v;function v(E){var R=this._events;if(R!==void 0){var L=R[E];if(typeof L=="function")return 1;if(L!==void 0)return L.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function w(E,R){for(var L=new Array(R),O=0;O<R;++O)L[O]=E[O];return L}function g(E,R){for(;R+1<E.length;R++)E[R]=E[R+1];E.pop()}function _(E){for(var R=new Array(E.length),L=0;L<R.length;++L)R[L]=E[L].listener||E[L];return R}function b(E,R){return new Promise(function(L,O){function P(V){E.removeListener(R,F),O(V)}function F(){typeof E.removeListener=="function"&&E.removeListener("error",P),L([].slice.call(arguments))}S(E,R,F,{once:!0}),R!=="error"&&N(E,P,{once:!0})})}function N(E,R,L){typeof E.on=="function"&&S(E,"error",R,L)}function S(E,R,L,O){if(typeof E.on=="function")O.once?E.once(R,L):E.on(R,L);else if(typeof E.addEventListener=="function")E.addEventListener(R,function P(F){O.once&&E.removeEventListener(R,P),L(F)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E)}return jh.exports}var Th={exports:{}},WS;function fo(){return WS||(WS=1,typeof Object.create=="function"?Th.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Th.exports=function(t,r){if(r){t.super_=r;var s=function(){};s.prototype=r.prototype,t.prototype=new s,t.prototype.constructor=t}}),Th.exports}function HL(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var y4={exports:{}},ps=y4.exports={},Ln,In;function py(){throw new Error("setTimeout has not been defined")}function xy(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Ln=setTimeout:Ln=py}catch{Ln=py}try{typeof clearTimeout=="function"?In=clearTimeout:In=xy}catch{In=xy}})();function v4(e){if(Ln===setTimeout)return setTimeout(e,0);if((Ln===py||!Ln)&&setTimeout)return Ln=setTimeout,setTimeout(e,0);try{return Ln(e,0)}catch{try{return Ln.call(null,e,0)}catch{return Ln.call(this,e,0)}}}function WL(e){if(In===clearTimeout)return clearTimeout(e);if((In===xy||!In)&&clearTimeout)return In=clearTimeout,clearTimeout(e);try{return In(e)}catch{try{return In.call(null,e)}catch{return In.call(this,e)}}}var ui=[],kc=!1,Ko,l0=-1;function GL(){!kc||!Ko||(kc=!1,Ko.length?ui=Ko.concat(ui):l0=-1,ui.length&&w4())}function w4(){if(!kc){var e=v4(GL);kc=!0;for(var t=ui.length;t;){for(Ko=ui,ui=[];++l0<t;)Ko&&Ko[l0].run();l0=-1,t=ui.length}Ko=null,kc=!1,WL(e)}}ps.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];ui.push(new b4(e,t)),ui.length===1&&!kc&&v4(w4)};function b4(e,t){this.fun=e,this.array=t}b4.prototype.run=function(){this.fun.apply(null,this.array)};ps.title="browser";ps.browser=!0;ps.env={};ps.argv=[];ps.version="";ps.versions={};function ki(){}ps.on=ki;ps.addListener=ki;ps.once=ki;ps.off=ki;ps.removeListener=ki;ps.removeAllListeners=ki;ps.emit=ki;ps.prependListener=ki;ps.prependOnceListener=ki;ps.listeners=function(e){return[]};ps.binding=function(e){throw new Error("process.binding is not supported")};ps.cwd=function(){return"/"};ps.chdir=function(e){throw new Error("process.chdir is not supported")};ps.umask=function(){return 0};var VL=y4.exports;const nr=HL(VL);var Wx,GS;function _4(){return GS||(GS=1,Wx=Qy().EventEmitter),Wx}var Gx={},qu={},VS;function KL(){if(VS)return qu;VS=1,qu.byteLength=u,qu.toByteArray=h,qu.fromByteArray=y;for(var e=[],t=[],r=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,o=s.length;a<o;++a)e[a]=s[a],t[s.charCodeAt(a)]=a;t[45]=62,t[95]=63;function c(v){var w=v.length;if(w%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=v.indexOf("=");g===-1&&(g=w);var _=g===w?0:4-g%4;return[g,_]}function u(v){var w=c(v),g=w[0],_=w[1];return(g+_)*3/4-_}function d(v,w,g){return(w+g)*3/4-g}function h(v){var w,g=c(v),_=g[0],b=g[1],N=new r(d(v,_,b)),S=0,E=b>0?_-4:_,R;for(R=0;R<E;R+=4)w=t[v.charCodeAt(R)]<<18|t[v.charCodeAt(R+1)]<<12|t[v.charCodeAt(R+2)]<<6|t[v.charCodeAt(R+3)],N[S++]=w>>16&255,N[S++]=w>>8&255,N[S++]=w&255;return b===2&&(w=t[v.charCodeAt(R)]<<2|t[v.charCodeAt(R+1)]>>4,N[S++]=w&255),b===1&&(w=t[v.charCodeAt(R)]<<10|t[v.charCodeAt(R+1)]<<4|t[v.charCodeAt(R+2)]>>2,N[S++]=w>>8&255,N[S++]=w&255),N}function m(v){return e[v>>18&63]+e[v>>12&63]+e[v>>6&63]+e[v&63]}function x(v,w,g){for(var _,b=[],N=w;N<g;N+=3)_=(v[N]<<16&16711680)+(v[N+1]<<8&65280)+(v[N+2]&255),b.push(m(_));return b.join("")}function y(v){for(var w,g=v.length,_=g%3,b=[],N=16383,S=0,E=g-_;S<E;S+=N)b.push(x(v,S,S+N>E?E:S+N));return _===1?(w=v[g-1],b.push(e[w>>2]+e[w<<4&63]+"==")):_===2&&(w=(v[g-2]<<8)+v[g-1],b.push(e[w>>10]+e[w>>4&63]+e[w<<2&63]+"=")),b.join("")}return qu}var Ah={};var KS;function XL(){return KS||(KS=1,Ah.read=function(e,t,r,s,a){var o,c,u=a*8-s-1,d=(1<<u)-1,h=d>>1,m=-7,x=r?a-1:0,y=r?-1:1,v=e[t+x];for(x+=y,o=v&(1<<-m)-1,v>>=-m,m+=u;m>0;o=o*256+e[t+x],x+=y,m-=8);for(c=o&(1<<-m)-1,o>>=-m,m+=s;m>0;c=c*256+e[t+x],x+=y,m-=8);if(o===0)o=1-h;else{if(o===d)return c?NaN:(v?-1:1)*(1/0);c=c+Math.pow(2,s),o=o-h}return(v?-1:1)*c*Math.pow(2,o-s)},Ah.write=function(e,t,r,s,a,o){var c,u,d,h=o*8-a-1,m=(1<<h)-1,x=m>>1,y=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=s?0:o-1,w=s?1:-1,g=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,c=m):(c=Math.floor(Math.log(t)/Math.LN2),t*(d=Math.pow(2,-c))<1&&(c--,d*=2),c+x>=1?t+=y/d:t+=y*Math.pow(2,1-x),t*d>=2&&(c++,d/=2),c+x>=m?(u=0,c=m):c+x>=1?(u=(t*d-1)*Math.pow(2,a),c=c+x):(u=t*Math.pow(2,x-1)*Math.pow(2,a),c=0));a>=8;e[r+v]=u&255,v+=w,u/=256,a-=8);for(c=c<<a|u,h+=a;h>0;e[r+v]=c&255,v+=w,c/=256,h-=8);e[r+v-w]|=g*128}),Ah}var XS;function H0(){return XS||(XS=1,(function(e){var t=KL(),r=XL(),s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=N,e.INSPECT_MAX_BYTES=50;var a=2147483647;e.kMaxLength=a,u.TYPED_ARRAY_SUPPORT=o(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var U=new Uint8Array(1),T={foo:function(){return 42}};return Object.setPrototypeOf(T,Uint8Array.prototype),Object.setPrototypeOf(U,T),U.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(U){if(U>a)throw new RangeError('The value "'+U+'" is invalid for option "size"');var T=new Uint8Array(U);return Object.setPrototypeOf(T,u.prototype),T}function u(U,T,A){if(typeof U=="number"){if(typeof T=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return x(U)}return d(U,T,A)}u.poolSize=8192;function d(U,T,A){if(typeof U=="string")return y(U,T);if(ArrayBuffer.isView(U))return w(U);if(U==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof U);if(ce(U,ArrayBuffer)||U&&ce(U.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ce(U,SharedArrayBuffer)||U&&ce(U.buffer,SharedArrayBuffer)))return g(U,T,A);if(typeof U=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var G=U.valueOf&&U.valueOf();if(G!=null&&G!==U)return u.from(G,T,A);var xe=_(U);if(xe)return xe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof U[Symbol.toPrimitive]=="function")return u.from(U[Symbol.toPrimitive]("string"),T,A);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof U)}u.from=function(U,T,A){return d(U,T,A)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function h(U){if(typeof U!="number")throw new TypeError('"size" argument must be of type number');if(U<0)throw new RangeError('The value "'+U+'" is invalid for option "size"')}function m(U,T,A){return h(U),U<=0?c(U):T!==void 0?typeof A=="string"?c(U).fill(T,A):c(U).fill(T):c(U)}u.alloc=function(U,T,A){return m(U,T,A)};function x(U){return h(U),c(U<0?0:b(U)|0)}u.allocUnsafe=function(U){return x(U)},u.allocUnsafeSlow=function(U){return x(U)};function y(U,T){if((typeof T!="string"||T==="")&&(T="utf8"),!u.isEncoding(T))throw new TypeError("Unknown encoding: "+T);var A=S(U,T)|0,G=c(A),xe=G.write(U,T);return xe!==A&&(G=G.slice(0,xe)),G}function v(U){for(var T=U.length<0?0:b(U.length)|0,A=c(T),G=0;G<T;G+=1)A[G]=U[G]&255;return A}function w(U){if(ce(U,Uint8Array)){var T=new Uint8Array(U);return g(T.buffer,T.byteOffset,T.byteLength)}return v(U)}function g(U,T,A){if(T<0||U.byteLength<T)throw new RangeError('"offset" is outside of buffer bounds');if(U.byteLength<T+(A||0))throw new RangeError('"length" is outside of buffer bounds');var G;return T===void 0&&A===void 0?G=new Uint8Array(U):A===void 0?G=new Uint8Array(U,T):G=new Uint8Array(U,T,A),Object.setPrototypeOf(G,u.prototype),G}function _(U){if(u.isBuffer(U)){var T=b(U.length)|0,A=c(T);return A.length===0||U.copy(A,0,0,T),A}if(U.length!==void 0)return typeof U.length!="number"||k(U.length)?c(0):v(U);if(U.type==="Buffer"&&Array.isArray(U.data))return v(U.data)}function b(U){if(U>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return U|0}function N(U){return+U!=U&&(U=0),u.alloc(+U)}u.isBuffer=function(T){return T!=null&&T._isBuffer===!0&&T!==u.prototype},u.compare=function(T,A){if(ce(T,Uint8Array)&&(T=u.from(T,T.offset,T.byteLength)),ce(A,Uint8Array)&&(A=u.from(A,A.offset,A.byteLength)),!u.isBuffer(T)||!u.isBuffer(A))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(T===A)return 0;for(var G=T.length,xe=A.length,be=0,ne=Math.min(G,xe);be<ne;++be)if(T[be]!==A[be]){G=T[be],xe=A[be];break}return G<xe?-1:xe<G?1:0},u.isEncoding=function(T){switch(String(T).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(T,A){if(!Array.isArray(T))throw new TypeError('"list" argument must be an Array of Buffers');if(T.length===0)return u.alloc(0);var G;if(A===void 0)for(A=0,G=0;G<T.length;++G)A+=T[G].length;var xe=u.allocUnsafe(A),be=0;for(G=0;G<T.length;++G){var ne=T[G];if(ce(ne,Uint8Array))be+ne.length>xe.length?u.from(ne).copy(xe,be):Uint8Array.prototype.set.call(xe,ne,be);else if(u.isBuffer(ne))ne.copy(xe,be);else throw new TypeError('"list" argument must be an Array of Buffers');be+=ne.length}return xe};function S(U,T){if(u.isBuffer(U))return U.length;if(ArrayBuffer.isView(U)||ce(U,ArrayBuffer))return U.byteLength;if(typeof U!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof U);var A=U.length,G=arguments.length>2&&arguments[2]===!0;if(!G&&A===0)return 0;for(var xe=!1;;)switch(T){case"ascii":case"latin1":case"binary":return A;case"utf8":case"utf-8":return z(U).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A*2;case"hex":return A>>>1;case"base64":return re(U).length;default:if(xe)return G?-1:z(U).length;T=(""+T).toLowerCase(),xe=!0}}u.byteLength=S;function E(U,T,A){var G=!1;if((T===void 0||T<0)&&(T=0),T>this.length||((A===void 0||A>this.length)&&(A=this.length),A<=0)||(A>>>=0,T>>>=0,A<=T))return"";for(U||(U="utf8");;)switch(U){case"hex":return ee(this,T,A);case"utf8":case"utf-8":return M(this,T,A);case"ascii":return Z(this,T,A);case"latin1":case"binary":return we(this,T,A);case"base64":return K(this,T,A);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ne(this,T,A);default:if(G)throw new TypeError("Unknown encoding: "+U);U=(U+"").toLowerCase(),G=!0}}u.prototype._isBuffer=!0;function R(U,T,A){var G=U[T];U[T]=U[A],U[A]=G}u.prototype.swap16=function(){var T=this.length;if(T%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var A=0;A<T;A+=2)R(this,A,A+1);return this},u.prototype.swap32=function(){var T=this.length;if(T%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var A=0;A<T;A+=4)R(this,A,A+3),R(this,A+1,A+2);return this},u.prototype.swap64=function(){var T=this.length;if(T%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var A=0;A<T;A+=8)R(this,A,A+7),R(this,A+1,A+6),R(this,A+2,A+5),R(this,A+3,A+4);return this},u.prototype.toString=function(){var T=this.length;return T===0?"":arguments.length===0?M(this,0,T):E.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(T){if(!u.isBuffer(T))throw new TypeError("Argument must be a Buffer");return this===T?!0:u.compare(this,T)===0},u.prototype.inspect=function(){var T="",A=e.INSPECT_MAX_BYTES;return T=this.toString("hex",0,A).replace(/(.{2})/g,"$1 ").trim(),this.length>A&&(T+=" ... "),"<Buffer "+T+">"},s&&(u.prototype[s]=u.prototype.inspect),u.prototype.compare=function(T,A,G,xe,be){if(ce(T,Uint8Array)&&(T=u.from(T,T.offset,T.byteLength)),!u.isBuffer(T))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof T);if(A===void 0&&(A=0),G===void 0&&(G=T?T.length:0),xe===void 0&&(xe=0),be===void 0&&(be=this.length),A<0||G>T.length||xe<0||be>this.length)throw new RangeError("out of range index");if(xe>=be&&A>=G)return 0;if(xe>=be)return-1;if(A>=G)return 1;if(A>>>=0,G>>>=0,xe>>>=0,be>>>=0,this===T)return 0;for(var ne=be-xe,je=G-A,Me=Math.min(ne,je),De=this.slice(xe,be),Ce=T.slice(A,G),st=0;st<Me;++st)if(De[st]!==Ce[st]){ne=De[st],je=Ce[st];break}return ne<je?-1:je<ne?1:0};function L(U,T,A,G,xe){if(U.length===0)return-1;if(typeof A=="string"?(G=A,A=0):A>2147483647?A=2147483647:A<-2147483648&&(A=-2147483648),A=+A,k(A)&&(A=xe?0:U.length-1),A<0&&(A=U.length+A),A>=U.length){if(xe)return-1;A=U.length-1}else if(A<0)if(xe)A=0;else return-1;if(typeof T=="string"&&(T=u.from(T,G)),u.isBuffer(T))return T.length===0?-1:O(U,T,A,G,xe);if(typeof T=="number")return T=T&255,typeof Uint8Array.prototype.indexOf=="function"?xe?Uint8Array.prototype.indexOf.call(U,T,A):Uint8Array.prototype.lastIndexOf.call(U,T,A):O(U,[T],A,G,xe);throw new TypeError("val must be string, number or Buffer")}function O(U,T,A,G,xe){var be=1,ne=U.length,je=T.length;if(G!==void 0&&(G=String(G).toLowerCase(),G==="ucs2"||G==="ucs-2"||G==="utf16le"||G==="utf-16le")){if(U.length<2||T.length<2)return-1;be=2,ne/=2,je/=2,A/=2}function Me(Ze,Re){return be===1?Ze[Re]:Ze.readUInt16BE(Re*be)}var De;if(xe){var Ce=-1;for(De=A;De<ne;De++)if(Me(U,De)===Me(T,Ce===-1?0:De-Ce)){if(Ce===-1&&(Ce=De),De-Ce+1===je)return Ce*be}else Ce!==-1&&(De-=De-Ce),Ce=-1}else for(A+je>ne&&(A=ne-je),De=A;De>=0;De--){for(var st=!0,We=0;We<je;We++)if(Me(U,De+We)!==Me(T,We)){st=!1;break}if(st)return De}return-1}u.prototype.includes=function(T,A,G){return this.indexOf(T,A,G)!==-1},u.prototype.indexOf=function(T,A,G){return L(this,T,A,G,!0)},u.prototype.lastIndexOf=function(T,A,G){return L(this,T,A,G,!1)};function P(U,T,A,G){A=Number(A)||0;var xe=U.length-A;G?(G=Number(G),G>xe&&(G=xe)):G=xe;var be=T.length;G>be/2&&(G=be/2);for(var ne=0;ne<G;++ne){var je=parseInt(T.substr(ne*2,2),16);if(k(je))return ne;U[A+ne]=je}return ne}function F(U,T,A,G){return W(z(T,U.length-A),U,A,G)}function V(U,T,A,G){return W(ue(T),U,A,G)}function oe(U,T,A,G){return W(re(T),U,A,G)}function D(U,T,A,G){return W(se(T,U.length-A),U,A,G)}u.prototype.write=function(T,A,G,xe){if(A===void 0)xe="utf8",G=this.length,A=0;else if(G===void 0&&typeof A=="string")xe=A,G=this.length,A=0;else if(isFinite(A))A=A>>>0,isFinite(G)?(G=G>>>0,xe===void 0&&(xe="utf8")):(xe=G,G=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var be=this.length-A;if((G===void 0||G>be)&&(G=be),T.length>0&&(G<0||A<0)||A>this.length)throw new RangeError("Attempt to write outside buffer bounds");xe||(xe="utf8");for(var ne=!1;;)switch(xe){case"hex":return P(this,T,A,G);case"utf8":case"utf-8":return F(this,T,A,G);case"ascii":case"latin1":case"binary":return V(this,T,A,G);case"base64":return oe(this,T,A,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,T,A,G);default:if(ne)throw new TypeError("Unknown encoding: "+xe);xe=(""+xe).toLowerCase(),ne=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(U,T,A){return T===0&&A===U.length?t.fromByteArray(U):t.fromByteArray(U.slice(T,A))}function M(U,T,A){A=Math.min(U.length,A);for(var G=[],xe=T;xe<A;){var be=U[xe],ne=null,je=be>239?4:be>223?3:be>191?2:1;if(xe+je<=A){var Me,De,Ce,st;switch(je){case 1:be<128&&(ne=be);break;case 2:Me=U[xe+1],(Me&192)===128&&(st=(be&31)<<6|Me&63,st>127&&(ne=st));break;case 3:Me=U[xe+1],De=U[xe+2],(Me&192)===128&&(De&192)===128&&(st=(be&15)<<12|(Me&63)<<6|De&63,st>2047&&(st<55296||st>57343)&&(ne=st));break;case 4:Me=U[xe+1],De=U[xe+2],Ce=U[xe+3],(Me&192)===128&&(De&192)===128&&(Ce&192)===128&&(st=(be&15)<<18|(Me&63)<<12|(De&63)<<6|Ce&63,st>65535&&st<1114112&&(ne=st))}}ne===null?(ne=65533,je=1):ne>65535&&(ne-=65536,G.push(ne>>>10&1023|55296),ne=56320|ne&1023),G.push(ne),xe+=je}return te(G)}var ae=4096;function te(U){var T=U.length;if(T<=ae)return String.fromCharCode.apply(String,U);for(var A="",G=0;G<T;)A+=String.fromCharCode.apply(String,U.slice(G,G+=ae));return A}function Z(U,T,A){var G="";A=Math.min(U.length,A);for(var xe=T;xe<A;++xe)G+=String.fromCharCode(U[xe]&127);return G}function we(U,T,A){var G="";A=Math.min(U.length,A);for(var xe=T;xe<A;++xe)G+=String.fromCharCode(U[xe]);return G}function ee(U,T,A){var G=U.length;(!T||T<0)&&(T=0),(!A||A<0||A>G)&&(A=G);for(var xe="",be=T;be<A;++be)xe+=de[U[be]];return xe}function Ne(U,T,A){for(var G=U.slice(T,A),xe="",be=0;be<G.length-1;be+=2)xe+=String.fromCharCode(G[be]+G[be+1]*256);return xe}u.prototype.slice=function(T,A){var G=this.length;T=~~T,A=A===void 0?G:~~A,T<0?(T+=G,T<0&&(T=0)):T>G&&(T=G),A<0?(A+=G,A<0&&(A=0)):A>G&&(A=G),A<T&&(A=T);var xe=this.subarray(T,A);return Object.setPrototypeOf(xe,u.prototype),xe};function q(U,T,A){if(U%1!==0||U<0)throw new RangeError("offset is not uint");if(U+T>A)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(T,A,G){T=T>>>0,A=A>>>0,G||q(T,A,this.length);for(var xe=this[T],be=1,ne=0;++ne<A&&(be*=256);)xe+=this[T+ne]*be;return xe},u.prototype.readUintBE=u.prototype.readUIntBE=function(T,A,G){T=T>>>0,A=A>>>0,G||q(T,A,this.length);for(var xe=this[T+--A],be=1;A>0&&(be*=256);)xe+=this[T+--A]*be;return xe},u.prototype.readUint8=u.prototype.readUInt8=function(T,A){return T=T>>>0,A||q(T,1,this.length),this[T]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(T,A){return T=T>>>0,A||q(T,2,this.length),this[T]|this[T+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(T,A){return T=T>>>0,A||q(T,2,this.length),this[T]<<8|this[T+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(T,A){return T=T>>>0,A||q(T,4,this.length),(this[T]|this[T+1]<<8|this[T+2]<<16)+this[T+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(T,A){return T=T>>>0,A||q(T,4,this.length),this[T]*16777216+(this[T+1]<<16|this[T+2]<<8|this[T+3])},u.prototype.readIntLE=function(T,A,G){T=T>>>0,A=A>>>0,G||q(T,A,this.length);for(var xe=this[T],be=1,ne=0;++ne<A&&(be*=256);)xe+=this[T+ne]*be;return be*=128,xe>=be&&(xe-=Math.pow(2,8*A)),xe},u.prototype.readIntBE=function(T,A,G){T=T>>>0,A=A>>>0,G||q(T,A,this.length);for(var xe=A,be=1,ne=this[T+--xe];xe>0&&(be*=256);)ne+=this[T+--xe]*be;return be*=128,ne>=be&&(ne-=Math.pow(2,8*A)),ne},u.prototype.readInt8=function(T,A){return T=T>>>0,A||q(T,1,this.length),this[T]&128?(255-this[T]+1)*-1:this[T]},u.prototype.readInt16LE=function(T,A){T=T>>>0,A||q(T,2,this.length);var G=this[T]|this[T+1]<<8;return G&32768?G|4294901760:G},u.prototype.readInt16BE=function(T,A){T=T>>>0,A||q(T,2,this.length);var G=this[T+1]|this[T]<<8;return G&32768?G|4294901760:G},u.prototype.readInt32LE=function(T,A){return T=T>>>0,A||q(T,4,this.length),this[T]|this[T+1]<<8|this[T+2]<<16|this[T+3]<<24},u.prototype.readInt32BE=function(T,A){return T=T>>>0,A||q(T,4,this.length),this[T]<<24|this[T+1]<<16|this[T+2]<<8|this[T+3]},u.prototype.readFloatLE=function(T,A){return T=T>>>0,A||q(T,4,this.length),r.read(this,T,!0,23,4)},u.prototype.readFloatBE=function(T,A){return T=T>>>0,A||q(T,4,this.length),r.read(this,T,!1,23,4)},u.prototype.readDoubleLE=function(T,A){return T=T>>>0,A||q(T,8,this.length),r.read(this,T,!0,52,8)},u.prototype.readDoubleBE=function(T,A){return T=T>>>0,A||q(T,8,this.length),r.read(this,T,!1,52,8)};function I(U,T,A,G,xe,be){if(!u.isBuffer(U))throw new TypeError('"buffer" argument must be a Buffer instance');if(T>xe||T<be)throw new RangeError('"value" argument is out of bounds');if(A+G>U.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(T,A,G,xe){if(T=+T,A=A>>>0,G=G>>>0,!xe){var be=Math.pow(2,8*G)-1;I(this,T,A,G,be,0)}var ne=1,je=0;for(this[A]=T&255;++je<G&&(ne*=256);)this[A+je]=T/ne&255;return A+G},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(T,A,G,xe){if(T=+T,A=A>>>0,G=G>>>0,!xe){var be=Math.pow(2,8*G)-1;I(this,T,A,G,be,0)}var ne=G-1,je=1;for(this[A+ne]=T&255;--ne>=0&&(je*=256);)this[A+ne]=T/je&255;return A+G},u.prototype.writeUint8=u.prototype.writeUInt8=function(T,A,G){return T=+T,A=A>>>0,G||I(this,T,A,1,255,0),this[A]=T&255,A+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(T,A,G){return T=+T,A=A>>>0,G||I(this,T,A,2,65535,0),this[A]=T&255,this[A+1]=T>>>8,A+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(T,A,G){return T=+T,A=A>>>0,G||I(this,T,A,2,65535,0),this[A]=T>>>8,this[A+1]=T&255,A+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(T,A,G){return T=+T,A=A>>>0,G||I(this,T,A,4,4294967295,0),this[A+3]=T>>>24,this[A+2]=T>>>16,this[A+1]=T>>>8,this[A]=T&255,A+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(T,A,G){return T=+T,A=A>>>0,G||I(this,T,A,4,4294967295,0),this[A]=T>>>24,this[A+1]=T>>>16,this[A+2]=T>>>8,this[A+3]=T&255,A+4},u.prototype.writeIntLE=function(T,A,G,xe){if(T=+T,A=A>>>0,!xe){var be=Math.pow(2,8*G-1);I(this,T,A,G,be-1,-be)}var ne=0,je=1,Me=0;for(this[A]=T&255;++ne<G&&(je*=256);)T<0&&Me===0&&this[A+ne-1]!==0&&(Me=1),this[A+ne]=(T/je>>0)-Me&255;return A+G},u.prototype.writeIntBE=function(T,A,G,xe){if(T=+T,A=A>>>0,!xe){var be=Math.pow(2,8*G-1);I(this,T,A,G,be-1,-be)}var ne=G-1,je=1,Me=0;for(this[A+ne]=T&255;--ne>=0&&(je*=256);)T<0&&Me===0&&this[A+ne+1]!==0&&(Me=1),this[A+ne]=(T/je>>0)-Me&255;return A+G},u.prototype.writeInt8=function(T,A,G){return T=+T,A=A>>>0,G||I(this,T,A,1,127,-128),T<0&&(T=255+T+1),this[A]=T&255,A+1},u.prototype.writeInt16LE=function(T,A,G){return T=+T,A=A>>>0,G||I(this,T,A,2,32767,-32768),this[A]=T&255,this[A+1]=T>>>8,A+2},u.prototype.writeInt16BE=function(T,A,G){return T=+T,A=A>>>0,G||I(this,T,A,2,32767,-32768),this[A]=T>>>8,this[A+1]=T&255,A+2},u.prototype.writeInt32LE=function(T,A,G){return T=+T,A=A>>>0,G||I(this,T,A,4,2147483647,-2147483648),this[A]=T&255,this[A+1]=T>>>8,this[A+2]=T>>>16,this[A+3]=T>>>24,A+4},u.prototype.writeInt32BE=function(T,A,G){return T=+T,A=A>>>0,G||I(this,T,A,4,2147483647,-2147483648),T<0&&(T=4294967295+T+1),this[A]=T>>>24,this[A+1]=T>>>16,this[A+2]=T>>>8,this[A+3]=T&255,A+4};function X(U,T,A,G,xe,be){if(A+G>U.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("Index out of range")}function H(U,T,A,G,xe){return T=+T,A=A>>>0,xe||X(U,T,A,4),r.write(U,T,A,G,23,4),A+4}u.prototype.writeFloatLE=function(T,A,G){return H(this,T,A,!0,G)},u.prototype.writeFloatBE=function(T,A,G){return H(this,T,A,!1,G)};function Q(U,T,A,G,xe){return T=+T,A=A>>>0,xe||X(U,T,A,8),r.write(U,T,A,G,52,8),A+8}u.prototype.writeDoubleLE=function(T,A,G){return Q(this,T,A,!0,G)},u.prototype.writeDoubleBE=function(T,A,G){return Q(this,T,A,!1,G)},u.prototype.copy=function(T,A,G,xe){if(!u.isBuffer(T))throw new TypeError("argument should be a Buffer");if(G||(G=0),!xe&&xe!==0&&(xe=this.length),A>=T.length&&(A=T.length),A||(A=0),xe>0&&xe<G&&(xe=G),xe===G||T.length===0||this.length===0)return 0;if(A<0)throw new RangeError("targetStart out of bounds");if(G<0||G>=this.length)throw new RangeError("Index out of range");if(xe<0)throw new RangeError("sourceEnd out of bounds");xe>this.length&&(xe=this.length),T.length-A<xe-G&&(xe=T.length-A+G);var be=xe-G;return this===T&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(A,G,xe):Uint8Array.prototype.set.call(T,this.subarray(G,xe),A),be},u.prototype.fill=function(T,A,G,xe){if(typeof T=="string"){if(typeof A=="string"?(xe=A,A=0,G=this.length):typeof G=="string"&&(xe=G,G=this.length),xe!==void 0&&typeof xe!="string")throw new TypeError("encoding must be a string");if(typeof xe=="string"&&!u.isEncoding(xe))throw new TypeError("Unknown encoding: "+xe);if(T.length===1){var be=T.charCodeAt(0);(xe==="utf8"&&be<128||xe==="latin1")&&(T=be)}}else typeof T=="number"?T=T&255:typeof T=="boolean"&&(T=Number(T));if(A<0||this.length<A||this.length<G)throw new RangeError("Out of range index");if(G<=A)return this;A=A>>>0,G=G===void 0?this.length:G>>>0,T||(T=0);var ne;if(typeof T=="number")for(ne=A;ne<G;++ne)this[ne]=T;else{var je=u.isBuffer(T)?T:u.from(T,xe),Me=je.length;if(Me===0)throw new TypeError('The value "'+T+'" is invalid for argument "value"');for(ne=0;ne<G-A;++ne)this[ne+A]=je[ne%Me]}return this};var ie=/[^+/0-9A-Za-z-_]/g;function B(U){if(U=U.split("=")[0],U=U.trim().replace(ie,""),U.length<2)return"";for(;U.length%4!==0;)U=U+"=";return U}function z(U,T){T=T||1/0;for(var A,G=U.length,xe=null,be=[],ne=0;ne<G;++ne){if(A=U.charCodeAt(ne),A>55295&&A<57344){if(!xe){if(A>56319){(T-=3)>-1&&be.push(239,191,189);continue}else if(ne+1===G){(T-=3)>-1&&be.push(239,191,189);continue}xe=A;continue}if(A<56320){(T-=3)>-1&&be.push(239,191,189),xe=A;continue}A=(xe-55296<<10|A-56320)+65536}else xe&&(T-=3)>-1&&be.push(239,191,189);if(xe=null,A<128){if((T-=1)<0)break;be.push(A)}else if(A<2048){if((T-=2)<0)break;be.push(A>>6|192,A&63|128)}else if(A<65536){if((T-=3)<0)break;be.push(A>>12|224,A>>6&63|128,A&63|128)}else if(A<1114112){if((T-=4)<0)break;be.push(A>>18|240,A>>12&63|128,A>>6&63|128,A&63|128)}else throw new Error("Invalid code point")}return be}function ue(U){for(var T=[],A=0;A<U.length;++A)T.push(U.charCodeAt(A)&255);return T}function se(U,T){for(var A,G,xe,be=[],ne=0;ne<U.length&&!((T-=2)<0);++ne)A=U.charCodeAt(ne),G=A>>8,xe=A%256,be.push(xe),be.push(G);return be}function re(U){return t.toByteArray(B(U))}function W(U,T,A,G){for(var xe=0;xe<G&&!(xe+A>=T.length||xe>=U.length);++xe)T[xe+A]=U[xe];return xe}function ce(U,T){return U instanceof T||U!=null&&U.constructor!=null&&U.constructor.name!=null&&U.constructor.name===T.name}function k(U){return U!==U}var de=(function(){for(var U="0123456789abcdef",T=new Array(256),A=0;A<16;++A)for(var G=A*16,xe=0;xe<16;++xe)T[G+xe]=U[A]+U[xe];return T})()})(Gx)),Gx}var Vx={},Kx={},Xx,YS;function S4(){return YS||(YS=1,Xx=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),s=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(s)!=="[object Symbol]")return!1;var a=42;t[r]=a;for(var o in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var c=Object.getOwnPropertySymbols(t);if(c.length!==1||c[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(t,r);if(u.value!==a||u.enumerable!==!0)return!1}return!0}),Xx}var Yx,JS;function ev(){if(JS)return Yx;JS=1;var e=S4();return Yx=function(){return e()&&!!Symbol.toStringTag},Yx}var Jx,ZS;function k4(){return ZS||(ZS=1,Jx=Object),Jx}var Zx,QS;function YL(){return QS||(QS=1,Zx=Error),Zx}var Qx,ek;function JL(){return ek||(ek=1,Qx=EvalError),Qx}var eg,tk;function ZL(){return tk||(tk=1,eg=RangeError),eg}var tg,rk;function QL(){return rk||(rk=1,tg=ReferenceError),tg}var rg,sk;function N4(){return sk||(sk=1,rg=SyntaxError),rg}var sg,ak;function Vd(){return ak||(ak=1,sg=TypeError),sg}var ag,nk;function e7(){return nk||(nk=1,ag=URIError),ag}var ng,ik;function t7(){return ik||(ik=1,ng=Math.abs),ng}var ig,ok;function r7(){return ok||(ok=1,ig=Math.floor),ig}var og,lk;function s7(){return lk||(lk=1,og=Math.max),og}var lg,ck;function a7(){return ck||(ck=1,lg=Math.min),lg}var cg,uk;function n7(){return uk||(uk=1,cg=Math.pow),cg}var ug,dk;function i7(){return dk||(dk=1,ug=Math.round),ug}var dg,fk;function o7(){return fk||(fk=1,dg=Number.isNaN||function(t){return t!==t}),dg}var fg,hk;function l7(){if(hk)return fg;hk=1;var e=o7();return fg=function(r){return e(r)||r===0?r:r<0?-1:1},fg}var hg,mk;function c7(){return mk||(mk=1,hg=Object.getOwnPropertyDescriptor),hg}var mg,pk;function Kd(){if(pk)return mg;pk=1;var e=c7();if(e)try{e([],"length")}catch{e=null}return mg=e,mg}var pg,xk;function W0(){if(xk)return pg;xk=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return pg=e,pg}var xg,gk;function u7(){if(gk)return xg;gk=1;var e=typeof Symbol<"u"&&Symbol,t=S4();return xg=function(){return typeof e!="function"||typeof Symbol!="function"||typeof e("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},xg}var gg,yk;function E4(){return yk||(yk=1,gg=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),gg}var yg,vk;function j4(){if(vk)return yg;vk=1;var e=k4();return yg=e.getPrototypeOf||null,yg}var vg,wk;function d7(){if(wk)return vg;wk=1;var e="Function.prototype.bind called on incompatible ",t=Object.prototype.toString,r=Math.max,s="[object Function]",a=function(d,h){for(var m=[],x=0;x<d.length;x+=1)m[x]=d[x];for(var y=0;y<h.length;y+=1)m[y+d.length]=h[y];return m},o=function(d,h){for(var m=[],x=h,y=0;x<d.length;x+=1,y+=1)m[y]=d[x];return m},c=function(u,d){for(var h="",m=0;m<u.length;m+=1)h+=u[m],m+1<u.length&&(h+=d);return h};return vg=function(d){var h=this;if(typeof h!="function"||t.apply(h)!==s)throw new TypeError(e+h);for(var m=o(arguments,1),x,y=function(){if(this instanceof x){var b=h.apply(this,a(m,arguments));return Object(b)===b?b:this}return h.apply(d,a(m,arguments))},v=r(0,h.length-m.length),w=[],g=0;g<v;g++)w[g]="$"+g;if(x=Function("binder","return function ("+c(w,",")+"){ return binder.apply(this,arguments); }")(y),h.prototype){var _=function(){};_.prototype=h.prototype,x.prototype=new _,_.prototype=null}return x},vg}var wg,bk;function Xd(){if(bk)return wg;bk=1;var e=d7();return wg=Function.prototype.bind||e,wg}var bg,_k;function tv(){return _k||(_k=1,bg=Function.prototype.call),bg}var _g,Sk;function T4(){return Sk||(Sk=1,_g=Function.prototype.apply),_g}var Sg,kk;function f7(){return kk||(kk=1,Sg=typeof Reflect<"u"&&Reflect&&Reflect.apply),Sg}var kg,Nk;function h7(){if(Nk)return kg;Nk=1;var e=Xd(),t=T4(),r=tv(),s=f7();return kg=s||e.call(r,t),kg}var Ng,Ek;function m7(){if(Ek)return Ng;Ek=1;var e=Xd(),t=Vd(),r=tv(),s=h7();return Ng=function(o){if(o.length<1||typeof o[0]!="function")throw new t("a function is required");return s(e,r,o)},Ng}var Eg,jk;function p7(){if(jk)return Eg;jk=1;var e=m7(),t=Kd(),r;try{r=[].__proto__===Array.prototype}catch(c){if(!c||typeof c!="object"||!("code"in c)||c.code!=="ERR_PROTO_ACCESS")throw c}var s=!!r&&t&&t(Object.prototype,"__proto__"),a=Object,o=a.getPrototypeOf;return Eg=s&&typeof s.get=="function"?e([s.get]):typeof o=="function"?(function(u){return o(u==null?u:a(u))}):!1,Eg}var jg,Tk;function x7(){if(Tk)return jg;Tk=1;var e=E4(),t=j4(),r=p7();return jg=e?function(a){return e(a)}:t?function(a){if(!a||typeof a!="object"&&typeof a!="function")throw new TypeError("getProto: not an object");return t(a)}:r?function(a){return r(a)}:null,jg}var Tg,Ak;function g7(){if(Ak)return Tg;Ak=1;var e=Function.prototype.call,t=Object.prototype.hasOwnProperty,r=Xd();return Tg=r.call(e,t),Tg}var Ag,Ck;function rv(){if(Ck)return Ag;Ck=1;var e,t=k4(),r=YL(),s=JL(),a=ZL(),o=QL(),c=N4(),u=Vd(),d=e7(),h=t7(),m=r7(),x=s7(),y=a7(),v=n7(),w=i7(),g=l7(),_=Function,b=function(ue){try{return _('"use strict"; return ('+ue+").constructor;")()}catch{}},N=Kd(),S=W0(),E=function(){throw new u},R=N?(function(){try{return arguments.callee,E}catch{try{return N(arguments,"callee").get}catch{return E}}})():E,L=u7()(),O=x7(),P=j4(),F=E4(),V=T4(),oe=tv(),D={},K=typeof Uint8Array>"u"||!O?e:O(Uint8Array),M={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?e:ArrayBuffer,"%ArrayIteratorPrototype%":L&&O?O([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":D,"%AsyncGenerator%":D,"%AsyncGeneratorFunction%":D,"%AsyncIteratorPrototype%":D,"%Atomics%":typeof Atomics>"u"?e:Atomics,"%BigInt%":typeof BigInt>"u"?e:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?e:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":s,"%Float16Array%":typeof Float16Array>"u"?e:Float16Array,"%Float32Array%":typeof Float32Array>"u"?e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?e:FinalizationRegistry,"%Function%":_,"%GeneratorFunction%":D,"%Int8Array%":typeof Int8Array>"u"?e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":L&&O?O(O([][Symbol.iterator]())):e,"%JSON%":typeof JSON=="object"?JSON:e,"%Map%":typeof Map>"u"?e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!L||!O?e:O(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":N,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?e:Promise,"%Proxy%":typeof Proxy>"u"?e:Proxy,"%RangeError%":a,"%ReferenceError%":o,"%Reflect%":typeof Reflect>"u"?e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!L||!O?e:O(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":L&&O?O(""[Symbol.iterator]()):e,"%Symbol%":L?Symbol:e,"%SyntaxError%":c,"%ThrowTypeError%":R,"%TypedArray%":K,"%TypeError%":u,"%Uint8Array%":typeof Uint8Array>"u"?e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?e:Uint32Array,"%URIError%":d,"%WeakMap%":typeof WeakMap>"u"?e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?e:WeakSet,"%Function.prototype.call%":oe,"%Function.prototype.apply%":V,"%Object.defineProperty%":S,"%Object.getPrototypeOf%":P,"%Math.abs%":h,"%Math.floor%":m,"%Math.max%":x,"%Math.min%":y,"%Math.pow%":v,"%Math.round%":w,"%Math.sign%":g,"%Reflect.getPrototypeOf%":F};if(O)try{null.error}catch(ue){var ae=O(O(ue));M["%Error.prototype%"]=ae}var te=function ue(se){var re;if(se==="%AsyncFunction%")re=b("async function () {}");else if(se==="%GeneratorFunction%")re=b("function* () {}");else if(se==="%AsyncGeneratorFunction%")re=b("async function* () {}");else if(se==="%AsyncGenerator%"){var W=ue("%AsyncGeneratorFunction%");W&&(re=W.prototype)}else if(se==="%AsyncIteratorPrototype%"){var ce=ue("%AsyncGenerator%");ce&&O&&(re=O(ce.prototype))}return M[se]=re,re},Z={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},we=Xd(),ee=g7(),Ne=we.call(oe,Array.prototype.concat),q=we.call(V,Array.prototype.splice),I=we.call(oe,String.prototype.replace),X=we.call(oe,String.prototype.slice),H=we.call(oe,RegExp.prototype.exec),Q=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ie=/\\(\\)?/g,B=function(se){var re=X(se,0,1),W=X(se,-1);if(re==="%"&&W!=="%")throw new c("invalid intrinsic syntax, expected closing `%`");if(W==="%"&&re!=="%")throw new c("invalid intrinsic syntax, expected opening `%`");var ce=[];return I(se,Q,function(k,de,U,T){ce[ce.length]=U?I(T,ie,"$1"):de||k}),ce},z=function(se,re){var W=se,ce;if(ee(Z,W)&&(ce=Z[W],W="%"+ce[0]+"%"),ee(M,W)){var k=M[W];if(k===D&&(k=te(W)),typeof k>"u"&&!re)throw new u("intrinsic "+se+" exists, but is not available. Please file an issue!");return{alias:ce,name:W,value:k}}throw new c("intrinsic "+se+" does not exist!")};return Ag=function(se,re){if(typeof se!="string"||se.length===0)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof re!="boolean")throw new u('"allowMissing" argument must be a boolean');if(H(/^%?[^%]*%?$/,se)===null)throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var W=B(se),ce=W.length>0?W[0]:"",k=z("%"+ce+"%",re),de=k.name,U=k.value,T=!1,A=k.alias;A&&(ce=A[0],q(W,Ne([0,1],A)));for(var G=1,xe=!0;G<W.length;G+=1){var be=W[G],ne=X(be,0,1),je=X(be,-1);if((ne==='"'||ne==="'"||ne==="`"||je==='"'||je==="'"||je==="`")&&ne!==je)throw new c("property names with quotes must have matching quotes");if((be==="constructor"||!xe)&&(T=!0),ce+="."+be,de="%"+ce+"%",ee(M,de))U=M[de];else if(U!=null){if(!(be in U)){if(!re)throw new u("base intrinsic for "+se+" exists, but the property is not available.");return}if(N&&G+1>=W.length){var Me=N(U,be);xe=!!Me,xe&&"get"in Me&&!("originalValue"in Me.get)?U=Me.get:U=U[be]}else xe=ee(U,be),U=U[be];xe&&!T&&(M[de]=U)}}return U},Ag}var Cg={exports:{}},Rg,Rk;function y7(){if(Rk)return Rg;Rk=1;var e=W0(),t=N4(),r=Vd(),s=Kd();return Rg=function(o,c,u){if(!o||typeof o!="object"&&typeof o!="function")throw new r("`obj` must be an object or a function`");if(typeof c!="string"&&typeof c!="symbol")throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new r("`loose`, if provided, must be a boolean");var d=arguments.length>3?arguments[3]:null,h=arguments.length>4?arguments[4]:null,m=arguments.length>5?arguments[5]:null,x=arguments.length>6?arguments[6]:!1,y=!!s&&s(o,c);if(e)e(o,c,{configurable:m===null&&y?y.configurable:!m,enumerable:d===null&&y?y.enumerable:!d,value:u,writable:h===null&&y?y.writable:!h});else if(x||!d&&!h&&!m)o[c]=u;else throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Rg}var Dg,Dk;function v7(){if(Dk)return Dg;Dk=1;var e=W0(),t=function(){return!!e};return t.hasArrayLengthDefineBug=function(){if(!e)return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},Dg=t,Dg}var Og,Ok;function w7(){if(Ok)return Og;Ok=1;var e=rv(),t=y7(),r=v7()(),s=Kd(),a=Vd(),o=e("%Math.floor%");return Og=function(u,d){if(typeof u!="function")throw new a("`fn` is not a function");if(typeof d!="number"||d<0||d>4294967295||o(d)!==d)throw new a("`length` must be a positive 32-bit integer");var h=arguments.length>2&&!!arguments[2],m=!0,x=!0;if("length"in u&&s){var y=s(u,"length");y&&!y.configurable&&(m=!1),y&&!y.writable&&(x=!1)}return(m||x||!h)&&(r?t(u,"length",d,!0,!0):t(u,"length",d)),u},Og}var Fk;function A4(){return Fk||(Fk=1,(function(e){var t=Xd(),r=rv(),s=w7(),a=Vd(),o=r("%Function.prototype.apply%"),c=r("%Function.prototype.call%"),u=r("%Reflect.apply%",!0)||t.call(c,o),d=W0(),h=r("%Math.max%");e.exports=function(y){if(typeof y!="function")throw new a("a function is required");var v=u(t,c,arguments);return s(v,1+h(0,y.length-(arguments.length-1)),!0)};var m=function(){return u(t,o,arguments)};d?d(e.exports,"apply",{value:m}):e.exports.apply=m})(Cg)),Cg.exports}var Fg,Lk;function C4(){if(Lk)return Fg;Lk=1;var e=rv(),t=A4(),r=t(e("String.prototype.indexOf"));return Fg=function(a,o){var c=e(a,!!o);return typeof c=="function"&&r(a,".prototype.")>-1?t(c):c},Fg}var Lg,Ik;function b7(){if(Ik)return Lg;Ik=1;var e=ev()(),t=C4(),r=t("Object.prototype.toString"),s=function(u){return e&&u&&typeof u=="object"&&Symbol.toStringTag in u?!1:r(u)==="[object Arguments]"},a=function(u){return s(u)?!0:u!==null&&typeof u=="object"&&typeof u.length=="number"&&u.length>=0&&r(u)!=="[object Array]"&&r(u.callee)==="[object Function]"},o=(function(){return s(arguments)})();return s.isLegacyArguments=a,Lg=o?s:a,Lg}var Ig,Mk;function _7(){if(Mk)return Ig;Mk=1;var e=Object.prototype.toString,t=Function.prototype.toString,r=/^\s*(?:function)?\*/,s=ev()(),a=Object.getPrototypeOf,o=function(){if(!s)return!1;try{return Function("return function*() {}")()}catch{}},c;return Ig=function(d){if(typeof d!="function")return!1;if(r.test(t.call(d)))return!0;if(!s){var h=e.call(d);return h==="[object GeneratorFunction]"}if(!a)return!1;if(typeof c>"u"){var m=o();c=m?a(m):!1}return a(d)===c},Ig}var Mg,Pk;function S7(){if(Pk)return Mg;Pk=1;var e=Function.prototype.toString,t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,s;if(typeof t=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw s}}),s={},t(function(){throw 42},null,r)}catch(N){N!==s&&(t=null)}else t=null;var a=/^\s*class\b/,o=function(S){try{var E=e.call(S);return a.test(E)}catch{return!1}},c=function(S){try{return o(S)?!1:(e.call(S),!0)}catch{return!1}},u=Object.prototype.toString,d="[object Object]",h="[object Function]",m="[object GeneratorFunction]",x="[object HTMLAllCollection]",y="[object HTML document.all class]",v="[object HTMLCollection]",w=typeof Symbol=="function"&&!!Symbol.toStringTag,g=!(0 in[,]),_=function(){return!1};if(typeof document=="object"){var b=document.all;u.call(b)===u.call(document.all)&&(_=function(S){if((g||!S)&&(typeof S>"u"||typeof S=="object"))try{var E=u.call(S);return(E===x||E===y||E===v||E===d)&&S("")==null}catch{}return!1})}return Mg=t?function(S){if(_(S))return!0;if(!S||typeof S!="function"&&typeof S!="object")return!1;try{t(S,null,r)}catch(E){if(E!==s)return!1}return!o(S)&&c(S)}:function(S){if(_(S))return!0;if(!S||typeof S!="function"&&typeof S!="object")return!1;if(w)return c(S);if(o(S))return!1;var E=u.call(S);return E!==h&&E!==m&&!/^\[object HTML/.test(E)?!1:c(S)},Mg}var Pg,Bk;function k7(){if(Bk)return Pg;Bk=1;var e=S7(),t=Object.prototype.toString,r=Object.prototype.hasOwnProperty,s=function(d,h,m){for(var x=0,y=d.length;x<y;x++)r.call(d,x)&&(m==null?h(d[x],x,d):h.call(m,d[x],x,d))},a=function(d,h,m){for(var x=0,y=d.length;x<y;x++)m==null?h(d.charAt(x),x,d):h.call(m,d.charAt(x),x,d)},o=function(d,h,m){for(var x in d)r.call(d,x)&&(m==null?h(d[x],x,d):h.call(m,d[x],x,d))},c=function(d,h,m){if(!e(h))throw new TypeError("iterator must be a function");var x;arguments.length>=3&&(x=m),t.call(d)==="[object Array]"?s(d,h,x):typeof d=="string"?a(d,h,x):o(d,h,x)};return Pg=c,Pg}var Bg,Uk;function N7(){return Uk||(Uk=1,Bg=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),Bg}var Ug,zk;function E7(){if(zk)return Ug;zk=1;var e=N7(),t=typeof globalThis>"u"?Mn:globalThis;return Ug=function(){for(var s=[],a=0;a<e.length;a++)typeof t[e[a]]=="function"&&(s[s.length]=e[a]);return s},Ug}var zg,qk;function R4(){if(qk)return zg;qk=1;var e=k7(),t=E7(),r=A4(),s=C4(),a=Kd(),o=s("Object.prototype.toString"),c=ev()(),u=typeof globalThis>"u"?Mn:globalThis,d=t(),h=s("String.prototype.slice"),m=Object.getPrototypeOf,x=s("Array.prototype.indexOf",!0)||function(_,b){for(var N=0;N<_.length;N+=1)if(_[N]===b)return N;return-1},y={__proto__:null};c&&a&&m?e(d,function(g){var _=new u[g];if(Symbol.toStringTag in _){var b=m(_),N=a(b,Symbol.toStringTag);if(!N){var S=m(b);N=a(S,Symbol.toStringTag)}y["$"+g]=r(N.get)}}):e(d,function(g){var _=new u[g],b=_.slice||_.set;b&&(y["$"+g]=r(b))});var v=function(_){var b=!1;return e(y,function(N,S){if(!b)try{"$"+N(_)===S&&(b=h(S,1))}catch{}}),b},w=function(_){var b=!1;return e(y,function(N,S){if(!b)try{N(_),b=h(S,1)}catch{}}),b};return zg=function(_){if(!_||typeof _!="object")return!1;if(!c){var b=h(o(_),8,-1);return x(d,b)>-1?b:b!=="Object"?!1:w(_)}return a?v(_):null},zg}var qg,$k;function j7(){if($k)return qg;$k=1;var e=R4();return qg=function(r){return!!e(r)},qg}var Hk;function T7(){return Hk||(Hk=1,(function(e){var t=b7(),r=_7(),s=R4(),a=j7();function o(G){return G.call.bind(G)}var c=typeof BigInt<"u",u=typeof Symbol<"u",d=o(Object.prototype.toString),h=o(Number.prototype.valueOf),m=o(String.prototype.valueOf),x=o(Boolean.prototype.valueOf);if(c)var y=o(BigInt.prototype.valueOf);if(u)var v=o(Symbol.prototype.valueOf);function w(G,xe){if(typeof G!="object")return!1;try{return xe(G),!0}catch{return!1}}e.isArgumentsObject=t,e.isGeneratorFunction=r,e.isTypedArray=a;function g(G){return typeof Promise<"u"&&G instanceof Promise||G!==null&&typeof G=="object"&&typeof G.then=="function"&&typeof G.catch=="function"}e.isPromise=g;function _(G){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(G):a(G)||X(G)}e.isArrayBufferView=_;function b(G){return s(G)==="Uint8Array"}e.isUint8Array=b;function N(G){return s(G)==="Uint8ClampedArray"}e.isUint8ClampedArray=N;function S(G){return s(G)==="Uint16Array"}e.isUint16Array=S;function E(G){return s(G)==="Uint32Array"}e.isUint32Array=E;function R(G){return s(G)==="Int8Array"}e.isInt8Array=R;function L(G){return s(G)==="Int16Array"}e.isInt16Array=L;function O(G){return s(G)==="Int32Array"}e.isInt32Array=O;function P(G){return s(G)==="Float32Array"}e.isFloat32Array=P;function F(G){return s(G)==="Float64Array"}e.isFloat64Array=F;function V(G){return s(G)==="BigInt64Array"}e.isBigInt64Array=V;function oe(G){return s(G)==="BigUint64Array"}e.isBigUint64Array=oe;function D(G){return d(G)==="[object Map]"}D.working=typeof Map<"u"&&D(new Map);function K(G){return typeof Map>"u"?!1:D.working?D(G):G instanceof Map}e.isMap=K;function M(G){return d(G)==="[object Set]"}M.working=typeof Set<"u"&&M(new Set);function ae(G){return typeof Set>"u"?!1:M.working?M(G):G instanceof Set}e.isSet=ae;function te(G){return d(G)==="[object WeakMap]"}te.working=typeof WeakMap<"u"&&te(new WeakMap);function Z(G){return typeof WeakMap>"u"?!1:te.working?te(G):G instanceof WeakMap}e.isWeakMap=Z;function we(G){return d(G)==="[object WeakSet]"}we.working=typeof WeakSet<"u"&&we(new WeakSet);function ee(G){return we(G)}e.isWeakSet=ee;function Ne(G){return d(G)==="[object ArrayBuffer]"}Ne.working=typeof ArrayBuffer<"u"&&Ne(new ArrayBuffer);function q(G){return typeof ArrayBuffer>"u"?!1:Ne.working?Ne(G):G instanceof ArrayBuffer}e.isArrayBuffer=q;function I(G){return d(G)==="[object DataView]"}I.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&I(new DataView(new ArrayBuffer(1),0,1));function X(G){return typeof DataView>"u"?!1:I.working?I(G):G instanceof DataView}e.isDataView=X;var H=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function Q(G){return d(G)==="[object SharedArrayBuffer]"}function ie(G){return typeof H>"u"?!1:(typeof Q.working>"u"&&(Q.working=Q(new H)),Q.working?Q(G):G instanceof H)}e.isSharedArrayBuffer=ie;function B(G){return d(G)==="[object AsyncFunction]"}e.isAsyncFunction=B;function z(G){return d(G)==="[object Map Iterator]"}e.isMapIterator=z;function ue(G){return d(G)==="[object Set Iterator]"}e.isSetIterator=ue;function se(G){return d(G)==="[object Generator]"}e.isGeneratorObject=se;function re(G){return d(G)==="[object WebAssembly.Module]"}e.isWebAssemblyCompiledModule=re;function W(G){return w(G,h)}e.isNumberObject=W;function ce(G){return w(G,m)}e.isStringObject=ce;function k(G){return w(G,x)}e.isBooleanObject=k;function de(G){return c&&w(G,y)}e.isBigIntObject=de;function U(G){return u&&w(G,v)}e.isSymbolObject=U;function T(G){return W(G)||ce(G)||k(G)||de(G)||U(G)}e.isBoxedPrimitive=T;function A(G){return typeof Uint8Array<"u"&&(q(G)||ie(G))}e.isAnyArrayBuffer=A,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(G){Object.defineProperty(e,G,{enumerable:!1,value:function(){throw new Error(G+" is not supported in userland")}})})})(Kx)),Kx}var $g,Wk;function A7(){return Wk||(Wk=1,$g=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}),$g}var Gk;function D4(){return Gk||(Gk=1,(function(e){var t=Object.getOwnPropertyDescriptors||function(X){for(var H=Object.keys(X),Q={},ie=0;ie<H.length;ie++)Q[H[ie]]=Object.getOwnPropertyDescriptor(X,H[ie]);return Q},r=/%[sdj%]/g;e.format=function(I){if(!R(I)){for(var X=[],H=0;H<arguments.length;H++)X.push(c(arguments[H]));return X.join(" ")}for(var H=1,Q=arguments,ie=Q.length,B=String(I).replace(r,function(ue){if(ue==="%%")return"%";if(H>=ie)return ue;switch(ue){case"%s":return String(Q[H++]);case"%d":return Number(Q[H++]);case"%j":try{return JSON.stringify(Q[H++])}catch{return"[Circular]"}default:return ue}}),z=Q[H];H<ie;z=Q[++H])N(z)||!F(z)?B+=" "+z:B+=" "+c(z);return B},e.deprecate=function(I,X){if(typeof nr<"u"&&nr.noDeprecation===!0)return I;if(typeof nr>"u")return function(){return e.deprecate(I,X).apply(this,arguments)};var H=!1;function Q(){if(!H){if(nr.throwDeprecation)throw new Error(X);nr.traceDeprecation?console.trace(X):console.error(X),H=!0}return I.apply(this,arguments)}return Q};var s={},a=/^$/;if(nr.env.NODE_DEBUG){var o=nr.env.NODE_DEBUG;o=o.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),a=new RegExp("^"+o+"$","i")}e.debuglog=function(I){if(I=I.toUpperCase(),!s[I])if(a.test(I)){var X=nr.pid;s[I]=function(){var H=e.format.apply(e,arguments);console.error("%s %d: %s",I,X,H)}}else s[I]=function(){};return s[I]};function c(I,X){var H={seen:[],stylize:d};return arguments.length>=3&&(H.depth=arguments[2]),arguments.length>=4&&(H.colors=arguments[3]),b(X)?H.showHidden=X:X&&e._extend(H,X),O(H.showHidden)&&(H.showHidden=!1),O(H.depth)&&(H.depth=2),O(H.colors)&&(H.colors=!1),O(H.customInspect)&&(H.customInspect=!0),H.colors&&(H.stylize=u),m(H,I,H.depth)}e.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function u(I,X){var H=c.styles[X];return H?"\x1B["+c.colors[H][0]+"m"+I+"\x1B["+c.colors[H][1]+"m":I}function d(I,X){return I}function h(I){var X={};return I.forEach(function(H,Q){X[H]=!0}),X}function m(I,X,H){if(I.customInspect&&X&&D(X.inspect)&&X.inspect!==e.inspect&&!(X.constructor&&X.constructor.prototype===X)){var Q=X.inspect(H,I);return R(Q)||(Q=m(I,Q,H)),Q}var ie=x(I,X);if(ie)return ie;var B=Object.keys(X),z=h(B);if(I.showHidden&&(B=Object.getOwnPropertyNames(X)),oe(X)&&(B.indexOf("message")>=0||B.indexOf("description")>=0))return y(X);if(B.length===0){if(D(X)){var ue=X.name?": "+X.name:"";return I.stylize("[Function"+ue+"]","special")}if(P(X))return I.stylize(RegExp.prototype.toString.call(X),"regexp");if(V(X))return I.stylize(Date.prototype.toString.call(X),"date");if(oe(X))return y(X)}var se="",re=!1,W=["{","}"];if(_(X)&&(re=!0,W=["[","]"]),D(X)){var ce=X.name?": "+X.name:"";se=" [Function"+ce+"]"}if(P(X)&&(se=" "+RegExp.prototype.toString.call(X)),V(X)&&(se=" "+Date.prototype.toUTCString.call(X)),oe(X)&&(se=" "+y(X)),B.length===0&&(!re||X.length==0))return W[0]+se+W[1];if(H<0)return P(X)?I.stylize(RegExp.prototype.toString.call(X),"regexp"):I.stylize("[Object]","special");I.seen.push(X);var k;return re?k=v(I,X,H,z,B):k=B.map(function(de){return w(I,X,H,z,de,re)}),I.seen.pop(),g(k,se,W)}function x(I,X){if(O(X))return I.stylize("undefined","undefined");if(R(X)){var H="'"+JSON.stringify(X).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return I.stylize(H,"string")}if(E(X))return I.stylize(""+X,"number");if(b(X))return I.stylize(""+X,"boolean");if(N(X))return I.stylize("null","null")}function y(I){return"["+Error.prototype.toString.call(I)+"]"}function v(I,X,H,Q,ie){for(var B=[],z=0,ue=X.length;z<ue;++z)we(X,String(z))?B.push(w(I,X,H,Q,String(z),!0)):B.push("");return ie.forEach(function(se){se.match(/^\d+$/)||B.push(w(I,X,H,Q,se,!0))}),B}function w(I,X,H,Q,ie,B){var z,ue,se;if(se=Object.getOwnPropertyDescriptor(X,ie)||{value:X[ie]},se.get?se.set?ue=I.stylize("[Getter/Setter]","special"):ue=I.stylize("[Getter]","special"):se.set&&(ue=I.stylize("[Setter]","special")),we(Q,ie)||(z="["+ie+"]"),ue||(I.seen.indexOf(se.value)<0?(N(H)?ue=m(I,se.value,null):ue=m(I,se.value,H-1),ue.indexOf(`
`)>-1&&(B?ue=ue.split(`
`).map(function(re){return"  "+re}).join(`
`).slice(2):ue=`
`+ue.split(`
`).map(function(re){return"   "+re}).join(`
`))):ue=I.stylize("[Circular]","special")),O(z)){if(B&&ie.match(/^\d+$/))return ue;z=JSON.stringify(""+ie),z.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(z=z.slice(1,-1),z=I.stylize(z,"name")):(z=z.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),z=I.stylize(z,"string"))}return z+": "+ue}function g(I,X,H){var Q=I.reduce(function(ie,B){return B.indexOf(`
`)>=0,ie+B.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Q>60?H[0]+(X===""?"":X+`
 `)+" "+I.join(`,
  `)+" "+H[1]:H[0]+X+" "+I.join(", ")+" "+H[1]}e.types=T7();function _(I){return Array.isArray(I)}e.isArray=_;function b(I){return typeof I=="boolean"}e.isBoolean=b;function N(I){return I===null}e.isNull=N;function S(I){return I==null}e.isNullOrUndefined=S;function E(I){return typeof I=="number"}e.isNumber=E;function R(I){return typeof I=="string"}e.isString=R;function L(I){return typeof I=="symbol"}e.isSymbol=L;function O(I){return I===void 0}e.isUndefined=O;function P(I){return F(I)&&M(I)==="[object RegExp]"}e.isRegExp=P,e.types.isRegExp=P;function F(I){return typeof I=="object"&&I!==null}e.isObject=F;function V(I){return F(I)&&M(I)==="[object Date]"}e.isDate=V,e.types.isDate=V;function oe(I){return F(I)&&(M(I)==="[object Error]"||I instanceof Error)}e.isError=oe,e.types.isNativeError=oe;function D(I){return typeof I=="function"}e.isFunction=D;function K(I){return I===null||typeof I=="boolean"||typeof I=="number"||typeof I=="string"||typeof I=="symbol"||typeof I>"u"}e.isPrimitive=K,e.isBuffer=A7();function M(I){return Object.prototype.toString.call(I)}function ae(I){return I<10?"0"+I.toString(10):I.toString(10)}var te=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Z(){var I=new Date,X=[ae(I.getHours()),ae(I.getMinutes()),ae(I.getSeconds())].join(":");return[I.getDate(),te[I.getMonth()],X].join(" ")}e.log=function(){console.log("%s - %s",Z(),e.format.apply(e,arguments))},e.inherits=fo(),e._extend=function(I,X){if(!X||!F(X))return I;for(var H=Object.keys(X),Q=H.length;Q--;)I[H[Q]]=X[H[Q]];return I};function we(I,X){return Object.prototype.hasOwnProperty.call(I,X)}var ee=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;e.promisify=function(X){if(typeof X!="function")throw new TypeError('The "original" argument must be of type Function');if(ee&&X[ee]){var H=X[ee];if(typeof H!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(H,ee,{value:H,enumerable:!1,writable:!1,configurable:!0}),H}function H(){for(var Q,ie,B=new Promise(function(se,re){Q=se,ie=re}),z=[],ue=0;ue<arguments.length;ue++)z.push(arguments[ue]);z.push(function(se,re){se?ie(se):Q(re)});try{X.apply(this,z)}catch(se){ie(se)}return B}return Object.setPrototypeOf(H,Object.getPrototypeOf(X)),ee&&Object.defineProperty(H,ee,{value:H,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(H,t(X))},e.promisify.custom=ee;function Ne(I,X){if(!I){var H=new Error("Promise was rejected with a falsy value");H.reason=I,I=H}return X(I)}function q(I){if(typeof I!="function")throw new TypeError('The "original" argument must be of type Function');function X(){for(var H=[],Q=0;Q<arguments.length;Q++)H.push(arguments[Q]);var ie=H.pop();if(typeof ie!="function")throw new TypeError("The last argument must be of type Function");var B=this,z=function(){return ie.apply(B,arguments)};I.apply(this,H).then(function(ue){nr.nextTick(z.bind(null,null,ue))},function(ue){nr.nextTick(Ne.bind(null,ue,z))})}return Object.setPrototypeOf(X,Object.getPrototypeOf(I)),Object.defineProperties(X,t(I)),X}e.callbackify=q})(Vx)),Vx}var Hg,Vk;function C7(){if(Vk)return Hg;Vk=1;function e(y,v){var w=Object.keys(y);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(y);v&&(g=g.filter(function(_){return Object.getOwnPropertyDescriptor(y,_).enumerable})),w.push.apply(w,g)}return w}function t(y){for(var v=1;v<arguments.length;v++){var w=arguments[v]!=null?arguments[v]:{};v%2?e(Object(w),!0).forEach(function(g){r(y,g,w[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(w)):e(Object(w)).forEach(function(g){Object.defineProperty(y,g,Object.getOwnPropertyDescriptor(w,g))})}return y}function r(y,v,w){return v in y?Object.defineProperty(y,v,{value:w,enumerable:!0,configurable:!0,writable:!0}):y[v]=w,y}function s(y,v){if(!(y instanceof v))throw new TypeError("Cannot call a class as a function")}function a(y,v){for(var w=0;w<v.length;w++){var g=v[w];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(y,g.key,g)}}function o(y,v,w){return v&&a(y.prototype,v),y}var c=H0(),u=c.Buffer,d=D4(),h=d.inspect,m=h&&h.custom||"inspect";function x(y,v,w){u.prototype.copy.call(y,v,w)}return Hg=(function(){function y(){s(this,y),this.head=null,this.tail=null,this.length=0}return o(y,[{key:"push",value:function(w){var g={data:w,next:null};this.length>0?this.tail.next=g:this.head=g,this.tail=g,++this.length}},{key:"unshift",value:function(w){var g={data:w,next:this.head};this.length===0&&(this.tail=g),this.head=g,++this.length}},{key:"shift",value:function(){if(this.length!==0){var w=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,w}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(w){if(this.length===0)return"";for(var g=this.head,_=""+g.data;g=g.next;)_+=w+g.data;return _}},{key:"concat",value:function(w){if(this.length===0)return u.alloc(0);for(var g=u.allocUnsafe(w>>>0),_=this.head,b=0;_;)x(_.data,g,b),b+=_.data.length,_=_.next;return g}},{key:"consume",value:function(w,g){var _;return w<this.head.data.length?(_=this.head.data.slice(0,w),this.head.data=this.head.data.slice(w)):w===this.head.data.length?_=this.shift():_=g?this._getString(w):this._getBuffer(w),_}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(w){var g=this.head,_=1,b=g.data;for(w-=b.length;g=g.next;){var N=g.data,S=w>N.length?N.length:w;if(S===N.length?b+=N:b+=N.slice(0,w),w-=S,w===0){S===N.length?(++_,g.next?this.head=g.next:this.head=this.tail=null):(this.head=g,g.data=N.slice(S));break}++_}return this.length-=_,b}},{key:"_getBuffer",value:function(w){var g=u.allocUnsafe(w),_=this.head,b=1;for(_.data.copy(g),w-=_.data.length;_=_.next;){var N=_.data,S=w>N.length?N.length:w;if(N.copy(g,g.length-w,0,S),w-=S,w===0){S===N.length?(++b,_.next?this.head=_.next:this.head=this.tail=null):(this.head=_,_.data=N.slice(S));break}++b}return this.length-=b,g}},{key:m,value:function(w,g){return h(this,t({},g,{depth:0,customInspect:!1}))}}]),y})(),Hg}var Wg,Kk;function O4(){if(Kk)return Wg;Kk=1;function e(c,u){var d=this,h=this._readableState&&this._readableState.destroyed,m=this._writableState&&this._writableState.destroyed;return h||m?(u?u(c):c&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,nr.nextTick(a,this,c)):nr.nextTick(a,this,c)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,function(x){!u&&x?d._writableState?d._writableState.errorEmitted?nr.nextTick(r,d):(d._writableState.errorEmitted=!0,nr.nextTick(t,d,x)):nr.nextTick(t,d,x):u?(nr.nextTick(r,d),u(x)):nr.nextTick(r,d)}),this)}function t(c,u){a(c,u),r(c)}function r(c){c._writableState&&!c._writableState.emitClose||c._readableState&&!c._readableState.emitClose||c.emit("close")}function s(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function a(c,u){c.emit("error",u)}function o(c,u){var d=c._readableState,h=c._writableState;d&&d.autoDestroy||h&&h.autoDestroy?c.destroy(u):c.emit("error",u)}return Wg={destroy:e,undestroy:s,errorOrDestroy:o},Wg}var Gg={},Xk;function Vc(){if(Xk)return Gg;Xk=1;function e(u,d){u.prototype=Object.create(d.prototype),u.prototype.constructor=u,u.__proto__=d}var t={};function r(u,d,h){h||(h=Error);function m(y,v,w){return typeof d=="string"?d:d(y,v,w)}var x=(function(y){e(v,y);function v(w,g,_){return y.call(this,m(w,g,_))||this}return v})(h);x.prototype.name=h.name,x.prototype.code=u,t[u]=x}function s(u,d){if(Array.isArray(u)){var h=u.length;return u=u.map(function(m){return String(m)}),h>2?"one of ".concat(d," ").concat(u.slice(0,h-1).join(", "),", or ")+u[h-1]:h===2?"one of ".concat(d," ").concat(u[0]," or ").concat(u[1]):"of ".concat(d," ").concat(u[0])}else return"of ".concat(d," ").concat(String(u))}function a(u,d,h){return u.substr(0,d.length)===d}function o(u,d,h){return(h===void 0||h>u.length)&&(h=u.length),u.substring(h-d.length,h)===d}function c(u,d,h){return typeof h!="number"&&(h=0),h+d.length>u.length?!1:u.indexOf(d,h)!==-1}return r("ERR_INVALID_OPT_VALUE",function(u,d){return'The value "'+d+'" is invalid for option "'+u+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(u,d,h){var m;typeof d=="string"&&a(d,"not ")?(m="must not be",d=d.replace(/^not /,"")):m="must be";var x;if(o(u," argument"))x="The ".concat(u," ").concat(m," ").concat(s(d,"type"));else{var y=c(u,".")?"property":"argument";x='The "'.concat(u,'" ').concat(y," ").concat(m," ").concat(s(d,"type"))}return x+=". Received type ".concat(typeof h),x},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Gg.codes=t,Gg}var Vg,Yk;function F4(){if(Yk)return Vg;Yk=1;var e=Vc().codes.ERR_INVALID_OPT_VALUE;function t(s,a,o){return s.highWaterMark!=null?s.highWaterMark:a?s[o]:null}function r(s,a,o,c){var u=t(a,c,o);if(u!=null){if(!(isFinite(u)&&Math.floor(u)===u)||u<0){var d=c?o:"highWaterMark";throw new e(d,u)}return Math.floor(u)}return s.objectMode?16:16*1024}return Vg={getHighWaterMark:r},Vg}var Kg,Jk;function R7(){if(Jk)return Kg;Jk=1,Kg=e;function e(r,s){if(t("noDeprecation"))return r;var a=!1;function o(){if(!a){if(t("throwDeprecation"))throw new Error(s);t("traceDeprecation")?console.trace(s):console.warn(s),a=!0}return r.apply(this,arguments)}return o}function t(r){try{if(!Mn.localStorage)return!1}catch{return!1}var s=Mn.localStorage[r];return s==null?!1:String(s).toLowerCase()==="true"}return Kg}var Xg,Zk;function L4(){if(Zk)return Xg;Zk=1,Xg=P;function e(ie){var B=this;this.next=null,this.entry=null,this.finish=function(){Q(B,ie)}}var t;P.WritableState=L;var r={deprecate:R7()},s=_4(),a=H0().Buffer,o=Mn.Uint8Array||function(){};function c(ie){return a.from(ie)}function u(ie){return a.isBuffer(ie)||ie instanceof o}var d=O4(),h=F4(),m=h.getHighWaterMark,x=Vc().codes,y=x.ERR_INVALID_ARG_TYPE,v=x.ERR_METHOD_NOT_IMPLEMENTED,w=x.ERR_MULTIPLE_CALLBACK,g=x.ERR_STREAM_CANNOT_PIPE,_=x.ERR_STREAM_DESTROYED,b=x.ERR_STREAM_NULL_VALUES,N=x.ERR_STREAM_WRITE_AFTER_END,S=x.ERR_UNKNOWN_ENCODING,E=d.errorOrDestroy;fo()(P,s);function R(){}function L(ie,B,z){t=t||Fc(),ie=ie||{},typeof z!="boolean"&&(z=B instanceof t),this.objectMode=!!ie.objectMode,z&&(this.objectMode=this.objectMode||!!ie.writableObjectMode),this.highWaterMark=m(this,ie,"writableHighWaterMark",z),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var ue=ie.decodeStrings===!1;this.decodeStrings=!ue,this.defaultEncoding=ie.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(se){te(B,se)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=ie.emitClose!==!1,this.autoDestroy=!!ie.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}L.prototype.getBuffer=function(){for(var B=this.bufferedRequest,z=[];B;)z.push(B),B=B.next;return z},(function(){try{Object.defineProperty(L.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var O;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(O=Function.prototype[Symbol.hasInstance],Object.defineProperty(P,Symbol.hasInstance,{value:function(B){return O.call(this,B)?!0:this!==P?!1:B&&B._writableState instanceof L}})):O=function(B){return B instanceof this};function P(ie){t=t||Fc();var B=this instanceof t;if(!B&&!O.call(P,this))return new P(ie);this._writableState=new L(ie,this,B),this.writable=!0,ie&&(typeof ie.write=="function"&&(this._write=ie.write),typeof ie.writev=="function"&&(this._writev=ie.writev),typeof ie.destroy=="function"&&(this._destroy=ie.destroy),typeof ie.final=="function"&&(this._final=ie.final)),s.call(this)}P.prototype.pipe=function(){E(this,new g)};function F(ie,B){var z=new N;E(ie,z),nr.nextTick(B,z)}function V(ie,B,z,ue){var se;return z===null?se=new b:typeof z!="string"&&!B.objectMode&&(se=new y("chunk",["string","Buffer"],z)),se?(E(ie,se),nr.nextTick(ue,se),!1):!0}P.prototype.write=function(ie,B,z){var ue=this._writableState,se=!1,re=!ue.objectMode&&u(ie);return re&&!a.isBuffer(ie)&&(ie=c(ie)),typeof B=="function"&&(z=B,B=null),re?B="buffer":B||(B=ue.defaultEncoding),typeof z!="function"&&(z=R),ue.ending?F(this,z):(re||V(this,ue,ie,z))&&(ue.pendingcb++,se=D(this,ue,re,ie,B,z)),se},P.prototype.cork=function(){this._writableState.corked++},P.prototype.uncork=function(){var ie=this._writableState;ie.corked&&(ie.corked--,!ie.writing&&!ie.corked&&!ie.bufferProcessing&&ie.bufferedRequest&&ee(this,ie))},P.prototype.setDefaultEncoding=function(B){if(typeof B=="string"&&(B=B.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((B+"").toLowerCase())>-1))throw new S(B);return this._writableState.defaultEncoding=B,this},Object.defineProperty(P.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function oe(ie,B,z){return!ie.objectMode&&ie.decodeStrings!==!1&&typeof B=="string"&&(B=a.from(B,z)),B}Object.defineProperty(P.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function D(ie,B,z,ue,se,re){if(!z){var W=oe(B,ue,se);ue!==W&&(z=!0,se="buffer",ue=W)}var ce=B.objectMode?1:ue.length;B.length+=ce;var k=B.length<B.highWaterMark;if(k||(B.needDrain=!0),B.writing||B.corked){var de=B.lastBufferedRequest;B.lastBufferedRequest={chunk:ue,encoding:se,isBuf:z,callback:re,next:null},de?de.next=B.lastBufferedRequest:B.bufferedRequest=B.lastBufferedRequest,B.bufferedRequestCount+=1}else K(ie,B,!1,ce,ue,se,re);return k}function K(ie,B,z,ue,se,re,W){B.writelen=ue,B.writecb=W,B.writing=!0,B.sync=!0,B.destroyed?B.onwrite(new _("write")):z?ie._writev(se,B.onwrite):ie._write(se,re,B.onwrite),B.sync=!1}function M(ie,B,z,ue,se){--B.pendingcb,z?(nr.nextTick(se,ue),nr.nextTick(X,ie,B),ie._writableState.errorEmitted=!0,E(ie,ue)):(se(ue),ie._writableState.errorEmitted=!0,E(ie,ue),X(ie,B))}function ae(ie){ie.writing=!1,ie.writecb=null,ie.length-=ie.writelen,ie.writelen=0}function te(ie,B){var z=ie._writableState,ue=z.sync,se=z.writecb;if(typeof se!="function")throw new w;if(ae(z),B)M(ie,z,ue,B,se);else{var re=Ne(z)||ie.destroyed;!re&&!z.corked&&!z.bufferProcessing&&z.bufferedRequest&&ee(ie,z),ue?nr.nextTick(Z,ie,z,re,se):Z(ie,z,re,se)}}function Z(ie,B,z,ue){z||we(ie,B),B.pendingcb--,ue(),X(ie,B)}function we(ie,B){B.length===0&&B.needDrain&&(B.needDrain=!1,ie.emit("drain"))}function ee(ie,B){B.bufferProcessing=!0;var z=B.bufferedRequest;if(ie._writev&&z&&z.next){var ue=B.bufferedRequestCount,se=new Array(ue),re=B.corkedRequestsFree;re.entry=z;for(var W=0,ce=!0;z;)se[W]=z,z.isBuf||(ce=!1),z=z.next,W+=1;se.allBuffers=ce,K(ie,B,!0,B.length,se,"",re.finish),B.pendingcb++,B.lastBufferedRequest=null,re.next?(B.corkedRequestsFree=re.next,re.next=null):B.corkedRequestsFree=new e(B),B.bufferedRequestCount=0}else{for(;z;){var k=z.chunk,de=z.encoding,U=z.callback,T=B.objectMode?1:k.length;if(K(ie,B,!1,T,k,de,U),z=z.next,B.bufferedRequestCount--,B.writing)break}z===null&&(B.lastBufferedRequest=null)}B.bufferedRequest=z,B.bufferProcessing=!1}P.prototype._write=function(ie,B,z){z(new v("_write()"))},P.prototype._writev=null,P.prototype.end=function(ie,B,z){var ue=this._writableState;return typeof ie=="function"?(z=ie,ie=null,B=null):typeof B=="function"&&(z=B,B=null),ie!=null&&this.write(ie,B),ue.corked&&(ue.corked=1,this.uncork()),ue.ending||H(this,ue,z),this},Object.defineProperty(P.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Ne(ie){return ie.ending&&ie.length===0&&ie.bufferedRequest===null&&!ie.finished&&!ie.writing}function q(ie,B){ie._final(function(z){B.pendingcb--,z&&E(ie,z),B.prefinished=!0,ie.emit("prefinish"),X(ie,B)})}function I(ie,B){!B.prefinished&&!B.finalCalled&&(typeof ie._final=="function"&&!B.destroyed?(B.pendingcb++,B.finalCalled=!0,nr.nextTick(q,ie,B)):(B.prefinished=!0,ie.emit("prefinish")))}function X(ie,B){var z=Ne(B);if(z&&(I(ie,B),B.pendingcb===0&&(B.finished=!0,ie.emit("finish"),B.autoDestroy))){var ue=ie._readableState;(!ue||ue.autoDestroy&&ue.endEmitted)&&ie.destroy()}return z}function H(ie,B,z){B.ending=!0,X(ie,B),z&&(B.finished?nr.nextTick(z):ie.once("finish",z)),B.ended=!0,ie.writable=!1}function Q(ie,B,z){var ue=ie.entry;for(ie.entry=null;ue;){var se=ue.callback;B.pendingcb--,se(z),ue=ue.next}B.corkedRequestsFree.next=ie}return Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(B){this._writableState&&(this._writableState.destroyed=B)}}),P.prototype.destroy=d.destroy,P.prototype._undestroy=d.undestroy,P.prototype._destroy=function(ie,B){B(ie)},Xg}var Yg,Qk;function Fc(){if(Qk)return Yg;Qk=1;var e=Object.keys||function(h){var m=[];for(var x in h)m.push(x);return m};Yg=c;var t=I4(),r=L4();fo()(c,t);for(var s=e(r.prototype),a=0;a<s.length;a++){var o=s[a];c.prototype[o]||(c.prototype[o]=r.prototype[o])}function c(h){if(!(this instanceof c))return new c(h);t.call(this,h),r.call(this,h),this.allowHalfOpen=!0,h&&(h.readable===!1&&(this.readable=!1),h.writable===!1&&(this.writable=!1),h.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",u)))}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function u(){this._writableState.ended||nr.nextTick(d,this)}function d(h){h.end()}return Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(m){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=m,this._writableState.destroyed=m)}}),Yg}var Jg={},Ch={exports:{}},eN;function D7(){return eN||(eN=1,(function(e,t){var r=H0(),s=r.Buffer;function a(c,u){for(var d in c)u[d]=c[d]}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=r:(a(r,t),t.Buffer=o);function o(c,u,d){return s(c,u,d)}a(s,o),o.from=function(c,u,d){if(typeof c=="number")throw new TypeError("Argument must not be a number");return s(c,u,d)},o.alloc=function(c,u,d){if(typeof c!="number")throw new TypeError("Argument must be a number");var h=s(c);return u!==void 0?typeof d=="string"?h.fill(u,d):h.fill(u):h.fill(0),h},o.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return s(c)},o.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(c)}})(Ch,Ch.exports)),Ch.exports}var tN;function gy(){if(tN)return Jg;tN=1;var e=D7().Buffer,t=e.isEncoding||function(b){switch(b=""+b,b&&b.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(b){if(!b)return"utf8";for(var N;;)switch(b){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return b;default:if(N)return;b=(""+b).toLowerCase(),N=!0}}function s(b){var N=r(b);if(typeof N!="string"&&(e.isEncoding===t||!t(b)))throw new Error("Unknown encoding: "+b);return N||b}Jg.StringDecoder=a;function a(b){this.encoding=s(b);var N;switch(this.encoding){case"utf16le":this.text=x,this.end=y,N=4;break;case"utf8":this.fillLast=d,N=4;break;case"base64":this.text=v,this.end=w,N=3;break;default:this.write=g,this.end=_;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(N)}a.prototype.write=function(b){if(b.length===0)return"";var N,S;if(this.lastNeed){if(N=this.fillLast(b),N===void 0)return"";S=this.lastNeed,this.lastNeed=0}else S=0;return S<b.length?N?N+this.text(b,S):this.text(b,S):N||""},a.prototype.end=m,a.prototype.text=h,a.prototype.fillLast=function(b){if(this.lastNeed<=b.length)return b.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);b.copy(this.lastChar,this.lastTotal-this.lastNeed,0,b.length),this.lastNeed-=b.length};function o(b){return b<=127?0:b>>5===6?2:b>>4===14?3:b>>3===30?4:b>>6===2?-1:-2}function c(b,N,S){var E=N.length-1;if(E<S)return 0;var R=o(N[E]);return R>=0?(R>0&&(b.lastNeed=R-1),R):--E<S||R===-2?0:(R=o(N[E]),R>=0?(R>0&&(b.lastNeed=R-2),R):--E<S||R===-2?0:(R=o(N[E]),R>=0?(R>0&&(R===2?R=0:b.lastNeed=R-3),R):0))}function u(b,N,S){if((N[0]&192)!==128)return b.lastNeed=0,"";if(b.lastNeed>1&&N.length>1){if((N[1]&192)!==128)return b.lastNeed=1,"";if(b.lastNeed>2&&N.length>2&&(N[2]&192)!==128)return b.lastNeed=2,""}}function d(b){var N=this.lastTotal-this.lastNeed,S=u(this,b);if(S!==void 0)return S;if(this.lastNeed<=b.length)return b.copy(this.lastChar,N,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);b.copy(this.lastChar,N,0,b.length),this.lastNeed-=b.length}function h(b,N){var S=c(this,b,N);if(!this.lastNeed)return b.toString("utf8",N);this.lastTotal=S;var E=b.length-(S-this.lastNeed);return b.copy(this.lastChar,0,E),b.toString("utf8",N,E)}function m(b){var N=b&&b.length?this.write(b):"";return this.lastNeed?N+"":N}function x(b,N){if((b.length-N)%2===0){var S=b.toString("utf16le",N);if(S){var E=S.charCodeAt(S.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=b[b.length-2],this.lastChar[1]=b[b.length-1],S.slice(0,-1)}return S}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=b[b.length-1],b.toString("utf16le",N,b.length-1)}function y(b){var N=b&&b.length?this.write(b):"";if(this.lastNeed){var S=this.lastTotal-this.lastNeed;return N+this.lastChar.toString("utf16le",0,S)}return N}function v(b,N){var S=(b.length-N)%3;return S===0?b.toString("base64",N):(this.lastNeed=3-S,this.lastTotal=3,S===1?this.lastChar[0]=b[b.length-1]:(this.lastChar[0]=b[b.length-2],this.lastChar[1]=b[b.length-1]),b.toString("base64",N,b.length-S))}function w(b){var N=b&&b.length?this.write(b):"";return this.lastNeed?N+this.lastChar.toString("base64",0,3-this.lastNeed):N}function g(b){return b.toString(this.encoding)}function _(b){return b&&b.length?this.write(b):""}return Jg}var Zg,rN;function sv(){if(rN)return Zg;rN=1;var e=Vc().codes.ERR_STREAM_PREMATURE_CLOSE;function t(o){var c=!1;return function(){if(!c){c=!0;for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];o.apply(this,d)}}}function r(){}function s(o){return o.setHeader&&typeof o.abort=="function"}function a(o,c,u){if(typeof c=="function")return a(o,null,c);c||(c={}),u=t(u||r);var d=c.readable||c.readable!==!1&&o.readable,h=c.writable||c.writable!==!1&&o.writable,m=function(){o.writable||y()},x=o._writableState&&o._writableState.finished,y=function(){h=!1,x=!0,d||u.call(o)},v=o._readableState&&o._readableState.endEmitted,w=function(){d=!1,v=!0,h||u.call(o)},g=function(S){u.call(o,S)},_=function(){var S;if(d&&!v)return(!o._readableState||!o._readableState.ended)&&(S=new e),u.call(o,S);if(h&&!x)return(!o._writableState||!o._writableState.ended)&&(S=new e),u.call(o,S)},b=function(){o.req.on("finish",y)};return s(o)?(o.on("complete",y),o.on("abort",_),o.req?b():o.on("request",b)):h&&!o._writableState&&(o.on("end",m),o.on("close",m)),o.on("end",w),o.on("finish",y),c.error!==!1&&o.on("error",g),o.on("close",_),function(){o.removeListener("complete",y),o.removeListener("abort",_),o.removeListener("request",b),o.req&&o.req.removeListener("finish",y),o.removeListener("end",m),o.removeListener("close",m),o.removeListener("finish",y),o.removeListener("end",w),o.removeListener("error",g),o.removeListener("close",_)}}return Zg=a,Zg}var Qg,sN;function O7(){if(sN)return Qg;sN=1;var e;function t(b,N,S){return N in b?Object.defineProperty(b,N,{value:S,enumerable:!0,configurable:!0,writable:!0}):b[N]=S,b}var r=sv(),s=Symbol("lastResolve"),a=Symbol("lastReject"),o=Symbol("error"),c=Symbol("ended"),u=Symbol("lastPromise"),d=Symbol("handlePromise"),h=Symbol("stream");function m(b,N){return{value:b,done:N}}function x(b){var N=b[s];if(N!==null){var S=b[h].read();S!==null&&(b[u]=null,b[s]=null,b[a]=null,N(m(S,!1)))}}function y(b){nr.nextTick(x,b)}function v(b,N){return function(S,E){b.then(function(){if(N[c]){S(m(void 0,!0));return}N[d](S,E)},E)}}var w=Object.getPrototypeOf(function(){}),g=Object.setPrototypeOf((e={get stream(){return this[h]},next:function(){var N=this,S=this[o];if(S!==null)return Promise.reject(S);if(this[c])return Promise.resolve(m(void 0,!0));if(this[h].destroyed)return new Promise(function(O,P){nr.nextTick(function(){N[o]?P(N[o]):O(m(void 0,!0))})});var E=this[u],R;if(E)R=new Promise(v(E,this));else{var L=this[h].read();if(L!==null)return Promise.resolve(m(L,!1));R=new Promise(this[d])}return this[u]=R,R}},t(e,Symbol.asyncIterator,function(){return this}),t(e,"return",function(){var N=this;return new Promise(function(S,E){N[h].destroy(null,function(R){if(R){E(R);return}S(m(void 0,!0))})})}),e),w),_=function(N){var S,E=Object.create(g,(S={},t(S,h,{value:N,writable:!0}),t(S,s,{value:null,writable:!0}),t(S,a,{value:null,writable:!0}),t(S,o,{value:null,writable:!0}),t(S,c,{value:N._readableState.endEmitted,writable:!0}),t(S,d,{value:function(L,O){var P=E[h].read();P?(E[u]=null,E[s]=null,E[a]=null,L(m(P,!1))):(E[s]=L,E[a]=O)},writable:!0}),S));return E[u]=null,r(N,function(R){if(R&&R.code!=="ERR_STREAM_PREMATURE_CLOSE"){var L=E[a];L!==null&&(E[u]=null,E[s]=null,E[a]=null,L(R)),E[o]=R;return}var O=E[s];O!==null&&(E[u]=null,E[s]=null,E[a]=null,O(m(void 0,!0))),E[c]=!0}),N.on("readable",y.bind(null,E)),E};return Qg=_,Qg}var e1,aN;function F7(){return aN||(aN=1,e1=function(){throw new Error("Readable.from is not available in the browser")}),e1}var t1,nN;function I4(){if(nN)return t1;nN=1,t1=F;var e;F.ReadableState=P,Qy().EventEmitter;var t=function(W,ce){return W.listeners(ce).length},r=_4(),s=H0().Buffer,a=Mn.Uint8Array||function(){};function o(re){return s.from(re)}function c(re){return s.isBuffer(re)||re instanceof a}var u=D4(),d;u&&u.debuglog?d=u.debuglog("stream"):d=function(){};var h=C7(),m=O4(),x=F4(),y=x.getHighWaterMark,v=Vc().codes,w=v.ERR_INVALID_ARG_TYPE,g=v.ERR_STREAM_PUSH_AFTER_EOF,_=v.ERR_METHOD_NOT_IMPLEMENTED,b=v.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,N,S,E;fo()(F,r);var R=m.errorOrDestroy,L=["error","close","destroy","pause","resume"];function O(re,W,ce){if(typeof re.prependListener=="function")return re.prependListener(W,ce);!re._events||!re._events[W]?re.on(W,ce):Array.isArray(re._events[W])?re._events[W].unshift(ce):re._events[W]=[ce,re._events[W]]}function P(re,W,ce){e=e||Fc(),re=re||{},typeof ce!="boolean"&&(ce=W instanceof e),this.objectMode=!!re.objectMode,ce&&(this.objectMode=this.objectMode||!!re.readableObjectMode),this.highWaterMark=y(this,re,"readableHighWaterMark",ce),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=re.emitClose!==!1,this.autoDestroy=!!re.autoDestroy,this.destroyed=!1,this.defaultEncoding=re.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,re.encoding&&(N||(N=gy().StringDecoder),this.decoder=new N(re.encoding),this.encoding=re.encoding)}function F(re){if(e=e||Fc(),!(this instanceof F))return new F(re);var W=this instanceof e;this._readableState=new P(re,this,W),this.readable=!0,re&&(typeof re.read=="function"&&(this._read=re.read),typeof re.destroy=="function"&&(this._destroy=re.destroy)),r.call(this)}Object.defineProperty(F.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(W){this._readableState&&(this._readableState.destroyed=W)}}),F.prototype.destroy=m.destroy,F.prototype._undestroy=m.undestroy,F.prototype._destroy=function(re,W){W(re)},F.prototype.push=function(re,W){var ce=this._readableState,k;return ce.objectMode?k=!0:typeof re=="string"&&(W=W||ce.defaultEncoding,W!==ce.encoding&&(re=s.from(re,W),W=""),k=!0),V(this,re,W,!1,k)},F.prototype.unshift=function(re){return V(this,re,null,!0,!1)};function V(re,W,ce,k,de){d("readableAddChunk",W);var U=re._readableState;if(W===null)U.reading=!1,te(re,U);else{var T;if(de||(T=D(U,W)),T)R(re,T);else if(U.objectMode||W&&W.length>0)if(typeof W!="string"&&!U.objectMode&&Object.getPrototypeOf(W)!==s.prototype&&(W=o(W)),k)U.endEmitted?R(re,new b):oe(re,U,W,!0);else if(U.ended)R(re,new g);else{if(U.destroyed)return!1;U.reading=!1,U.decoder&&!ce?(W=U.decoder.write(W),U.objectMode||W.length!==0?oe(re,U,W,!1):ee(re,U)):oe(re,U,W,!1)}else k||(U.reading=!1,ee(re,U))}return!U.ended&&(U.length<U.highWaterMark||U.length===0)}function oe(re,W,ce,k){W.flowing&&W.length===0&&!W.sync?(W.awaitDrain=0,re.emit("data",ce)):(W.length+=W.objectMode?1:ce.length,k?W.buffer.unshift(ce):W.buffer.push(ce),W.needReadable&&Z(re)),ee(re,W)}function D(re,W){var ce;return!c(W)&&typeof W!="string"&&W!==void 0&&!re.objectMode&&(ce=new w("chunk",["string","Buffer","Uint8Array"],W)),ce}F.prototype.isPaused=function(){return this._readableState.flowing===!1},F.prototype.setEncoding=function(re){N||(N=gy().StringDecoder);var W=new N(re);this._readableState.decoder=W,this._readableState.encoding=this._readableState.decoder.encoding;for(var ce=this._readableState.buffer.head,k="";ce!==null;)k+=W.write(ce.data),ce=ce.next;return this._readableState.buffer.clear(),k!==""&&this._readableState.buffer.push(k),this._readableState.length=k.length,this};var K=1073741824;function M(re){return re>=K?re=K:(re--,re|=re>>>1,re|=re>>>2,re|=re>>>4,re|=re>>>8,re|=re>>>16,re++),re}function ae(re,W){return re<=0||W.length===0&&W.ended?0:W.objectMode?1:re!==re?W.flowing&&W.length?W.buffer.head.data.length:W.length:(re>W.highWaterMark&&(W.highWaterMark=M(re)),re<=W.length?re:W.ended?W.length:(W.needReadable=!0,0))}F.prototype.read=function(re){d("read",re),re=parseInt(re,10);var W=this._readableState,ce=re;if(re!==0&&(W.emittedReadable=!1),re===0&&W.needReadable&&((W.highWaterMark!==0?W.length>=W.highWaterMark:W.length>0)||W.ended))return d("read: emitReadable",W.length,W.ended),W.length===0&&W.ended?z(this):Z(this),null;if(re=ae(re,W),re===0&&W.ended)return W.length===0&&z(this),null;var k=W.needReadable;d("need readable",k),(W.length===0||W.length-re<W.highWaterMark)&&(k=!0,d("length less than watermark",k)),W.ended||W.reading?(k=!1,d("reading or ended",k)):k&&(d("do read"),W.reading=!0,W.sync=!0,W.length===0&&(W.needReadable=!0),this._read(W.highWaterMark),W.sync=!1,W.reading||(re=ae(ce,W)));var de;return re>0?de=B(re,W):de=null,de===null?(W.needReadable=W.length<=W.highWaterMark,re=0):(W.length-=re,W.awaitDrain=0),W.length===0&&(W.ended||(W.needReadable=!0),ce!==re&&W.ended&&z(this)),de!==null&&this.emit("data",de),de};function te(re,W){if(d("onEofChunk"),!W.ended){if(W.decoder){var ce=W.decoder.end();ce&&ce.length&&(W.buffer.push(ce),W.length+=W.objectMode?1:ce.length)}W.ended=!0,W.sync?Z(re):(W.needReadable=!1,W.emittedReadable||(W.emittedReadable=!0,we(re)))}}function Z(re){var W=re._readableState;d("emitReadable",W.needReadable,W.emittedReadable),W.needReadable=!1,W.emittedReadable||(d("emitReadable",W.flowing),W.emittedReadable=!0,nr.nextTick(we,re))}function we(re){var W=re._readableState;d("emitReadable_",W.destroyed,W.length,W.ended),!W.destroyed&&(W.length||W.ended)&&(re.emit("readable"),W.emittedReadable=!1),W.needReadable=!W.flowing&&!W.ended&&W.length<=W.highWaterMark,ie(re)}function ee(re,W){W.readingMore||(W.readingMore=!0,nr.nextTick(Ne,re,W))}function Ne(re,W){for(;!W.reading&&!W.ended&&(W.length<W.highWaterMark||W.flowing&&W.length===0);){var ce=W.length;if(d("maybeReadMore read 0"),re.read(0),ce===W.length)break}W.readingMore=!1}F.prototype._read=function(re){R(this,new _("_read()"))},F.prototype.pipe=function(re,W){var ce=this,k=this._readableState;switch(k.pipesCount){case 0:k.pipes=re;break;case 1:k.pipes=[k.pipes,re];break;default:k.pipes.push(re);break}k.pipesCount+=1,d("pipe count=%d opts=%j",k.pipesCount,W);var de=(!W||W.end!==!1)&&re!==nr.stdout&&re!==nr.stderr,U=de?A:Ce;k.endEmitted?nr.nextTick(U):ce.once("end",U),re.on("unpipe",T);function T(st,We){d("onunpipe"),st===ce&&We&&We.hasUnpiped===!1&&(We.hasUnpiped=!0,be())}function A(){d("onend"),re.end()}var G=q(ce);re.on("drain",G);var xe=!1;function be(){d("cleanup"),re.removeListener("close",Me),re.removeListener("finish",De),re.removeListener("drain",G),re.removeListener("error",je),re.removeListener("unpipe",T),ce.removeListener("end",A),ce.removeListener("end",Ce),ce.removeListener("data",ne),xe=!0,k.awaitDrain&&(!re._writableState||re._writableState.needDrain)&&G()}ce.on("data",ne);function ne(st){d("ondata");var We=re.write(st);d("dest.write",We),We===!1&&((k.pipesCount===1&&k.pipes===re||k.pipesCount>1&&se(k.pipes,re)!==-1)&&!xe&&(d("false write response, pause",k.awaitDrain),k.awaitDrain++),ce.pause())}function je(st){d("onerror",st),Ce(),re.removeListener("error",je),t(re,"error")===0&&R(re,st)}O(re,"error",je);function Me(){re.removeListener("finish",De),Ce()}re.once("close",Me);function De(){d("onfinish"),re.removeListener("close",Me),Ce()}re.once("finish",De);function Ce(){d("unpipe"),ce.unpipe(re)}return re.emit("pipe",ce),k.flowing||(d("pipe resume"),ce.resume()),re};function q(re){return function(){var ce=re._readableState;d("pipeOnDrain",ce.awaitDrain),ce.awaitDrain&&ce.awaitDrain--,ce.awaitDrain===0&&t(re,"data")&&(ce.flowing=!0,ie(re))}}F.prototype.unpipe=function(re){var W=this._readableState,ce={hasUnpiped:!1};if(W.pipesCount===0)return this;if(W.pipesCount===1)return re&&re!==W.pipes?this:(re||(re=W.pipes),W.pipes=null,W.pipesCount=0,W.flowing=!1,re&&re.emit("unpipe",this,ce),this);if(!re){var k=W.pipes,de=W.pipesCount;W.pipes=null,W.pipesCount=0,W.flowing=!1;for(var U=0;U<de;U++)k[U].emit("unpipe",this,{hasUnpiped:!1});return this}var T=se(W.pipes,re);return T===-1?this:(W.pipes.splice(T,1),W.pipesCount-=1,W.pipesCount===1&&(W.pipes=W.pipes[0]),re.emit("unpipe",this,ce),this)},F.prototype.on=function(re,W){var ce=r.prototype.on.call(this,re,W),k=this._readableState;return re==="data"?(k.readableListening=this.listenerCount("readable")>0,k.flowing!==!1&&this.resume()):re==="readable"&&!k.endEmitted&&!k.readableListening&&(k.readableListening=k.needReadable=!0,k.flowing=!1,k.emittedReadable=!1,d("on readable",k.length,k.reading),k.length?Z(this):k.reading||nr.nextTick(X,this)),ce},F.prototype.addListener=F.prototype.on,F.prototype.removeListener=function(re,W){var ce=r.prototype.removeListener.call(this,re,W);return re==="readable"&&nr.nextTick(I,this),ce},F.prototype.removeAllListeners=function(re){var W=r.prototype.removeAllListeners.apply(this,arguments);return(re==="readable"||re===void 0)&&nr.nextTick(I,this),W};function I(re){var W=re._readableState;W.readableListening=re.listenerCount("readable")>0,W.resumeScheduled&&!W.paused?W.flowing=!0:re.listenerCount("data")>0&&re.resume()}function X(re){d("readable nexttick read 0"),re.read(0)}F.prototype.resume=function(){var re=this._readableState;return re.flowing||(d("resume"),re.flowing=!re.readableListening,H(this,re)),re.paused=!1,this};function H(re,W){W.resumeScheduled||(W.resumeScheduled=!0,nr.nextTick(Q,re,W))}function Q(re,W){d("resume",W.reading),W.reading||re.read(0),W.resumeScheduled=!1,re.emit("resume"),ie(re),W.flowing&&!W.reading&&re.read(0)}F.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function ie(re){var W=re._readableState;for(d("flow",W.flowing);W.flowing&&re.read()!==null;);}F.prototype.wrap=function(re){var W=this,ce=this._readableState,k=!1;re.on("end",function(){if(d("wrapped end"),ce.decoder&&!ce.ended){var T=ce.decoder.end();T&&T.length&&W.push(T)}W.push(null)}),re.on("data",function(T){if(d("wrapped data"),ce.decoder&&(T=ce.decoder.write(T)),!(ce.objectMode&&T==null)&&!(!ce.objectMode&&(!T||!T.length))){var A=W.push(T);A||(k=!0,re.pause())}});for(var de in re)this[de]===void 0&&typeof re[de]=="function"&&(this[de]=(function(A){return function(){return re[A].apply(re,arguments)}})(de));for(var U=0;U<L.length;U++)re.on(L[U],this.emit.bind(this,L[U]));return this._read=function(T){d("wrapped _read",T),k&&(k=!1,re.resume())},this},typeof Symbol=="function"&&(F.prototype[Symbol.asyncIterator]=function(){return S===void 0&&(S=O7()),S(this)}),Object.defineProperty(F.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(F.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(F.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(W){this._readableState&&(this._readableState.flowing=W)}}),F._fromList=B,Object.defineProperty(F.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function B(re,W){if(W.length===0)return null;var ce;return W.objectMode?ce=W.buffer.shift():!re||re>=W.length?(W.decoder?ce=W.buffer.join(""):W.buffer.length===1?ce=W.buffer.first():ce=W.buffer.concat(W.length),W.buffer.clear()):ce=W.buffer.consume(re,W.decoder),ce}function z(re){var W=re._readableState;d("endReadable",W.endEmitted),W.endEmitted||(W.ended=!0,nr.nextTick(ue,W,re))}function ue(re,W){if(d("endReadableNT",re.endEmitted,re.length),!re.endEmitted&&re.length===0&&(re.endEmitted=!0,W.readable=!1,W.emit("end"),re.autoDestroy)){var ce=W._writableState;(!ce||ce.autoDestroy&&ce.finished)&&W.destroy()}}typeof Symbol=="function"&&(F.from=function(re,W){return E===void 0&&(E=F7()),E(F,re,W)});function se(re,W){for(var ce=0,k=re.length;ce<k;ce++)if(re[ce]===W)return ce;return-1}return t1}var r1,iN;function M4(){if(iN)return r1;iN=1,r1=u;var e=Vc().codes,t=e.ERR_METHOD_NOT_IMPLEMENTED,r=e.ERR_MULTIPLE_CALLBACK,s=e.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=e.ERR_TRANSFORM_WITH_LENGTH_0,o=Fc();fo()(u,o);function c(m,x){var y=this._transformState;y.transforming=!1;var v=y.writecb;if(v===null)return this.emit("error",new r);y.writechunk=null,y.writecb=null,x!=null&&this.push(x),v(m);var w=this._readableState;w.reading=!1,(w.needReadable||w.length<w.highWaterMark)&&this._read(w.highWaterMark)}function u(m){if(!(this instanceof u))return new u(m);o.call(this,m),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,m&&(typeof m.transform=="function"&&(this._transform=m.transform),typeof m.flush=="function"&&(this._flush=m.flush)),this.on("prefinish",d)}function d(){var m=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(x,y){h(m,x,y)}):h(this,null,null)}u.prototype.push=function(m,x){return this._transformState.needTransform=!1,o.prototype.push.call(this,m,x)},u.prototype._transform=function(m,x,y){y(new t("_transform()"))},u.prototype._write=function(m,x,y){var v=this._transformState;if(v.writecb=y,v.writechunk=m,v.writeencoding=x,!v.transforming){var w=this._readableState;(v.needTransform||w.needReadable||w.length<w.highWaterMark)&&this._read(w.highWaterMark)}},u.prototype._read=function(m){var x=this._transformState;x.writechunk!==null&&!x.transforming?(x.transforming=!0,this._transform(x.writechunk,x.writeencoding,x.afterTransform)):x.needTransform=!0},u.prototype._destroy=function(m,x){o.prototype._destroy.call(this,m,function(y){x(y)})};function h(m,x,y){if(x)return m.emit("error",x);if(y!=null&&m.push(y),m._writableState.length)throw new a;if(m._transformState.transforming)throw new s;return m.push(null)}return r1}var s1,oN;function L7(){if(oN)return s1;oN=1,s1=t;var e=M4();fo()(t,e);function t(r){if(!(this instanceof t))return new t(r);e.call(this,r)}return t.prototype._transform=function(r,s,a){a(null,r)},s1}var a1,lN;function I7(){if(lN)return a1;lN=1;var e;function t(y){var v=!1;return function(){v||(v=!0,y.apply(void 0,arguments))}}var r=Vc().codes,s=r.ERR_MISSING_ARGS,a=r.ERR_STREAM_DESTROYED;function o(y){if(y)throw y}function c(y){return y.setHeader&&typeof y.abort=="function"}function u(y,v,w,g){g=t(g);var _=!1;y.on("close",function(){_=!0}),e===void 0&&(e=sv()),e(y,{readable:v,writable:w},function(N){if(N)return g(N);_=!0,g()});var b=!1;return function(N){if(!_&&!b){if(b=!0,c(y))return y.abort();if(typeof y.destroy=="function")return y.destroy();g(N||new a("pipe"))}}}function d(y){y()}function h(y,v){return y.pipe(v)}function m(y){return!y.length||typeof y[y.length-1]!="function"?o:y.pop()}function x(){for(var y=arguments.length,v=new Array(y),w=0;w<y;w++)v[w]=arguments[w];var g=m(v);if(Array.isArray(v[0])&&(v=v[0]),v.length<2)throw new s("streams");var _,b=v.map(function(N,S){var E=S<v.length-1,R=S>0;return u(N,E,R,function(L){_||(_=L),L&&b.forEach(d),!E&&(b.forEach(d),g(_))})});return v.reduce(h)}return a1=x,a1}var n1,cN;function av(){if(cN)return n1;cN=1,n1=r;var e=Qy().EventEmitter,t=fo();t(r,e),r.Readable=I4(),r.Writable=L4(),r.Duplex=Fc(),r.Transform=M4(),r.PassThrough=L7(),r.finished=sv(),r.pipeline=I7(),r.Stream=r;function r(){e.call(this)}return r.prototype.pipe=function(s,a){var o=this;function c(v){s.writable&&s.write(v)===!1&&o.pause&&o.pause()}o.on("data",c);function u(){o.readable&&o.resume&&o.resume()}s.on("drain",u),!s._isStdio&&(!a||a.end!==!1)&&(o.on("end",h),o.on("close",m));var d=!1;function h(){d||(d=!0,s.end())}function m(){d||(d=!0,typeof s.destroy=="function"&&s.destroy())}function x(v){if(y(),e.listenerCount(this,"error")===0)throw v}o.on("error",x),s.on("error",x);function y(){o.removeListener("data",c),s.removeListener("drain",u),o.removeListener("end",h),o.removeListener("close",m),o.removeListener("error",x),s.removeListener("error",x),o.removeListener("end",y),o.removeListener("close",y),s.removeListener("close",y)}return o.on("end",y),o.on("close",y),s.on("close",y),s.emit("pipe",o),s},n1}var uN;function M7(){return uN||(uN=1,(function(e){(function(t){t.parser=function(B,z){return new s(B,z)},t.SAXParser=s,t.SAXStream=m,t.createStream=h,t.MAX_BUFFER_LENGTH=64*1024;var r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function s(B,z){if(!(this instanceof s))return new s(B,z);var ue=this;o(ue),ue.q=ue.c="",ue.bufferCheckPosition=t.MAX_BUFFER_LENGTH,ue.opt=z||{},ue.opt.lowercase=ue.opt.lowercase||ue.opt.lowercasetags,ue.looseCase=ue.opt.lowercase?"toLowerCase":"toUpperCase",ue.tags=[],ue.closed=ue.closedRoot=ue.sawRoot=!1,ue.tag=ue.error=null,ue.strict=!!B,ue.noscript=!!(B||ue.opt.noscript),ue.state=F.BEGIN,ue.strictEntities=ue.opt.strictEntities,ue.ENTITIES=ue.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),ue.attribList=[],ue.opt.xmlns&&(ue.ns=Object.create(g)),ue.trackPosition=ue.opt.position!==!1,ue.trackPosition&&(ue.position=ue.line=ue.column=0),oe(ue,"onready")}Object.create||(Object.create=function(B){function z(){}z.prototype=B;var ue=new z;return ue}),Object.keys||(Object.keys=function(B){var z=[];for(var ue in B)B.hasOwnProperty(ue)&&z.push(ue);return z});function a(B){for(var z=Math.max(t.MAX_BUFFER_LENGTH,10),ue=0,se=0,re=r.length;se<re;se++){var W=B[r[se]].length;if(W>z)switch(r[se]){case"textNode":K(B);break;case"cdata":D(B,"oncdata",B.cdata),B.cdata="";break;case"script":D(B,"onscript",B.script),B.script="";break;default:ae(B,"Max buffer length exceeded: "+r[se])}ue=Math.max(ue,W)}var ce=t.MAX_BUFFER_LENGTH-ue;B.bufferCheckPosition=ce+B.position}function o(B){for(var z=0,ue=r.length;z<ue;z++)B[r[z]]=""}function c(B){K(B),B.cdata!==""&&(D(B,"oncdata",B.cdata),B.cdata=""),B.script!==""&&(D(B,"onscript",B.script),B.script="")}s.prototype={end:function(){te(this)},write:ie,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){c(this)}};var u;try{u=av().Stream}catch{u=function(){}}var d=t.EVENTS.filter(function(B){return B!=="error"&&B!=="end"});function h(B,z){return new m(B,z)}function m(B,z){if(!(this instanceof m))return new m(B,z);u.apply(this),this._parser=new s(B,z),this.writable=!0,this.readable=!0;var ue=this;this._parser.onend=function(){ue.emit("end")},this._parser.onerror=function(se){ue.emit("error",se),ue._parser.error=null},this._decoder=null,d.forEach(function(se){Object.defineProperty(ue,"on"+se,{get:function(){return ue._parser["on"+se]},set:function(re){if(!re)return ue.removeAllListeners(se),ue._parser["on"+se]=re,re;ue.on(se,re)},enumerable:!0,configurable:!1})})}m.prototype=Object.create(u.prototype,{constructor:{value:m}}),m.prototype.write=function(B){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(B)){if(!this._decoder){var z=gy().StringDecoder;this._decoder=new z("utf8")}B=this._decoder.write(B)}return this._parser.write(B.toString()),this.emit("data",B),!0},m.prototype.end=function(B){return B&&B.length&&this.write(B),this._parser.end(),!0},m.prototype.on=function(B,z){var ue=this;return!ue._parser["on"+B]&&d.indexOf(B)!==-1&&(ue._parser["on"+B]=function(){var se=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);se.splice(0,0,B),ue.emit.apply(ue,se)}),u.prototype.on.call(ue,B,z)};var x="[CDATA[",y="DOCTYPE",v="http://www.w3.org/XML/1998/namespace",w="http://www.w3.org/2000/xmlns/",g={xml:v,xmlns:w},_=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,b=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,N=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,S=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function E(B){return B===" "||B===`
`||B==="\r"||B==="	"}function R(B){return B==='"'||B==="'"}function L(B){return B===">"||E(B)}function O(B,z){return B.test(z)}function P(B,z){return!O(B,z)}var F=0;t.STATE={BEGIN:F++,BEGIN_WHITESPACE:F++,TEXT:F++,TEXT_ENTITY:F++,OPEN_WAKA:F++,SGML_DECL:F++,SGML_DECL_QUOTED:F++,DOCTYPE:F++,DOCTYPE_QUOTED:F++,DOCTYPE_DTD:F++,DOCTYPE_DTD_QUOTED:F++,COMMENT_STARTING:F++,COMMENT:F++,COMMENT_ENDING:F++,COMMENT_ENDED:F++,CDATA:F++,CDATA_ENDING:F++,CDATA_ENDING_2:F++,PROC_INST:F++,PROC_INST_BODY:F++,PROC_INST_ENDING:F++,OPEN_TAG:F++,OPEN_TAG_SLASH:F++,ATTRIB:F++,ATTRIB_NAME:F++,ATTRIB_NAME_SAW_WHITE:F++,ATTRIB_VALUE:F++,ATTRIB_VALUE_QUOTED:F++,ATTRIB_VALUE_CLOSED:F++,ATTRIB_VALUE_UNQUOTED:F++,ATTRIB_VALUE_ENTITY_Q:F++,ATTRIB_VALUE_ENTITY_U:F++,CLOSE_TAG:F++,CLOSE_TAG_SAW_WHITE:F++,SCRIPT:F++,SCRIPT_ENDING:F++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(B){var z=t.ENTITIES[B],ue=typeof z=="number"?String.fromCharCode(z):z;t.ENTITIES[B]=ue});for(var V in t.STATE)t.STATE[t.STATE[V]]=V;F=t.STATE;function oe(B,z,ue){B[z]&&B[z](ue)}function D(B,z,ue){B.textNode&&K(B),oe(B,z,ue)}function K(B){B.textNode=M(B.opt,B.textNode),B.textNode&&oe(B,"ontext",B.textNode),B.textNode=""}function M(B,z){return B.trim&&(z=z.trim()),B.normalize&&(z=z.replace(/\s+/g," ")),z}function ae(B,z){return K(B),B.trackPosition&&(z+=`
Line: `+B.line+`
Column: `+B.column+`
Char: `+B.c),z=new Error(z),B.error=z,oe(B,"onerror",z),B}function te(B){return B.sawRoot&&!B.closedRoot&&Z(B,"Unclosed root tag"),B.state!==F.BEGIN&&B.state!==F.BEGIN_WHITESPACE&&B.state!==F.TEXT&&ae(B,"Unexpected end"),K(B),B.c="",B.closed=!0,oe(B,"onend"),s.call(B,B.strict,B.opt),B}function Z(B,z){if(typeof B!="object"||!(B instanceof s))throw new Error("bad call to strictFail");B.strict&&ae(B,z)}function we(B){B.strict||(B.tagName=B.tagName[B.looseCase]());var z=B.tags[B.tags.length-1]||B,ue=B.tag={name:B.tagName,attributes:{}};B.opt.xmlns&&(ue.ns=z.ns),B.attribList.length=0,D(B,"onopentagstart",ue)}function ee(B,z){var ue=B.indexOf(":"),se=ue<0?["",B]:B.split(":"),re=se[0],W=se[1];return z&&B==="xmlns"&&(re="xmlns",W=""),{prefix:re,local:W}}function Ne(B){if(B.strict||(B.attribName=B.attribName[B.looseCase]()),B.attribList.indexOf(B.attribName)!==-1||B.tag.attributes.hasOwnProperty(B.attribName)){B.attribName=B.attribValue="";return}if(B.opt.xmlns){var z=ee(B.attribName,!0),ue=z.prefix,se=z.local;if(ue==="xmlns")if(se==="xml"&&B.attribValue!==v)Z(B,"xml: prefix must be bound to "+v+`
Actual: `+B.attribValue);else if(se==="xmlns"&&B.attribValue!==w)Z(B,"xmlns: prefix must be bound to "+w+`
Actual: `+B.attribValue);else{var re=B.tag,W=B.tags[B.tags.length-1]||B;re.ns===W.ns&&(re.ns=Object.create(W.ns)),re.ns[se]=B.attribValue}B.attribList.push([B.attribName,B.attribValue])}else B.tag.attributes[B.attribName]=B.attribValue,D(B,"onattribute",{name:B.attribName,value:B.attribValue});B.attribName=B.attribValue=""}function q(B,z){if(B.opt.xmlns){var ue=B.tag,se=ee(B.tagName);ue.prefix=se.prefix,ue.local=se.local,ue.uri=ue.ns[se.prefix]||"",ue.prefix&&!ue.uri&&(Z(B,"Unbound namespace prefix: "+JSON.stringify(B.tagName)),ue.uri=se.prefix);var re=B.tags[B.tags.length-1]||B;ue.ns&&re.ns!==ue.ns&&Object.keys(ue.ns).forEach(function(ne){D(B,"onopennamespace",{prefix:ne,uri:ue.ns[ne]})});for(var W=0,ce=B.attribList.length;W<ce;W++){var k=B.attribList[W],de=k[0],U=k[1],T=ee(de,!0),A=T.prefix,G=T.local,xe=A===""?"":ue.ns[A]||"",be={name:de,value:U,prefix:A,local:G,uri:xe};A&&A!=="xmlns"&&!xe&&(Z(B,"Unbound namespace prefix: "+JSON.stringify(A)),be.uri=A),B.tag.attributes[de]=be,D(B,"onattribute",be)}B.attribList.length=0}B.tag.isSelfClosing=!!z,B.sawRoot=!0,B.tags.push(B.tag),D(B,"onopentag",B.tag),z||(!B.noscript&&B.tagName.toLowerCase()==="script"?B.state=F.SCRIPT:B.state=F.TEXT,B.tag=null,B.tagName=""),B.attribName=B.attribValue="",B.attribList.length=0}function I(B){if(!B.tagName){Z(B,"Weird empty close tag."),B.textNode+="</>",B.state=F.TEXT;return}if(B.script){if(B.tagName!=="script"){B.script+="</"+B.tagName+">",B.tagName="",B.state=F.SCRIPT;return}D(B,"onscript",B.script),B.script=""}var z=B.tags.length,ue=B.tagName;B.strict||(ue=ue[B.looseCase]());for(var se=ue;z--;){var re=B.tags[z];if(re.name!==se)Z(B,"Unexpected close tag");else break}if(z<0){Z(B,"Unmatched closing tag: "+B.tagName),B.textNode+="</"+B.tagName+">",B.state=F.TEXT;return}B.tagName=ue;for(var W=B.tags.length;W-- >z;){var ce=B.tag=B.tags.pop();B.tagName=B.tag.name,D(B,"onclosetag",B.tagName);var k={};for(var de in ce.ns)k[de]=ce.ns[de];var U=B.tags[B.tags.length-1]||B;B.opt.xmlns&&ce.ns!==U.ns&&Object.keys(ce.ns).forEach(function(T){var A=ce.ns[T];D(B,"onclosenamespace",{prefix:T,uri:A})})}z===0&&(B.closedRoot=!0),B.tagName=B.attribValue=B.attribName="",B.attribList.length=0,B.state=F.TEXT}function X(B){var z=B.entity,ue=z.toLowerCase(),se,re="";return B.ENTITIES[z]?B.ENTITIES[z]:B.ENTITIES[ue]?B.ENTITIES[ue]:(z=ue,z.charAt(0)==="#"&&(z.charAt(1)==="x"?(z=z.slice(2),se=parseInt(z,16),re=se.toString(16)):(z=z.slice(1),se=parseInt(z,10),re=se.toString(10))),z=z.replace(/^0+/,""),isNaN(se)||re.toLowerCase()!==z?(Z(B,"Invalid character entity"),"&"+B.entity+";"):String.fromCodePoint(se))}function H(B,z){z==="<"?(B.state=F.OPEN_WAKA,B.startTagPosition=B.position):E(z)||(Z(B,"Non-whitespace before first tag."),B.textNode=z,B.state=F.TEXT)}function Q(B,z){var ue="";return z<B.length&&(ue=B.charAt(z)),ue}function ie(B){var z=this;if(this.error)throw this.error;if(z.closed)return ae(z,"Cannot write after close. Assign an onready handler.");if(B===null)return te(z);typeof B=="object"&&(B=B.toString());for(var ue=0,se="";se=Q(B,ue++),z.c=se,!!se;)switch(z.trackPosition&&(z.position++,se===`
`?(z.line++,z.column=0):z.column++),z.state){case F.BEGIN:if(z.state=F.BEGIN_WHITESPACE,se==="\uFEFF")continue;H(z,se);continue;case F.BEGIN_WHITESPACE:H(z,se);continue;case F.TEXT:if(z.sawRoot&&!z.closedRoot){for(var re=ue-1;se&&se!=="<"&&se!=="&";)se=Q(B,ue++),se&&z.trackPosition&&(z.position++,se===`
`?(z.line++,z.column=0):z.column++);z.textNode+=B.substring(re,ue-1)}se==="<"&&!(z.sawRoot&&z.closedRoot&&!z.strict)?(z.state=F.OPEN_WAKA,z.startTagPosition=z.position):(!E(se)&&(!z.sawRoot||z.closedRoot)&&Z(z,"Text data outside of root node."),se==="&"?z.state=F.TEXT_ENTITY:z.textNode+=se);continue;case F.SCRIPT:se==="<"?z.state=F.SCRIPT_ENDING:z.script+=se;continue;case F.SCRIPT_ENDING:se==="/"?z.state=F.CLOSE_TAG:(z.script+="<"+se,z.state=F.SCRIPT);continue;case F.OPEN_WAKA:if(se==="!")z.state=F.SGML_DECL,z.sgmlDecl="";else if(!E(se))if(O(_,se))z.state=F.OPEN_TAG,z.tagName=se;else if(se==="/")z.state=F.CLOSE_TAG,z.tagName="";else if(se==="?")z.state=F.PROC_INST,z.procInstName=z.procInstBody="";else{if(Z(z,"Unencoded <"),z.startTagPosition+1<z.position){var W=z.position-z.startTagPosition;se=new Array(W).join(" ")+se}z.textNode+="<"+se,z.state=F.TEXT}continue;case F.SGML_DECL:(z.sgmlDecl+se).toUpperCase()===x?(D(z,"onopencdata"),z.state=F.CDATA,z.sgmlDecl="",z.cdata=""):z.sgmlDecl+se==="--"?(z.state=F.COMMENT,z.comment="",z.sgmlDecl=""):(z.sgmlDecl+se).toUpperCase()===y?(z.state=F.DOCTYPE,(z.doctype||z.sawRoot)&&Z(z,"Inappropriately located doctype declaration"),z.doctype="",z.sgmlDecl=""):se===">"?(D(z,"onsgmldeclaration",z.sgmlDecl),z.sgmlDecl="",z.state=F.TEXT):(R(se)&&(z.state=F.SGML_DECL_QUOTED),z.sgmlDecl+=se);continue;case F.SGML_DECL_QUOTED:se===z.q&&(z.state=F.SGML_DECL,z.q=""),z.sgmlDecl+=se;continue;case F.DOCTYPE:se===">"?(z.state=F.TEXT,D(z,"ondoctype",z.doctype),z.doctype=!0):(z.doctype+=se,se==="["?z.state=F.DOCTYPE_DTD:R(se)&&(z.state=F.DOCTYPE_QUOTED,z.q=se));continue;case F.DOCTYPE_QUOTED:z.doctype+=se,se===z.q&&(z.q="",z.state=F.DOCTYPE);continue;case F.DOCTYPE_DTD:z.doctype+=se,se==="]"?z.state=F.DOCTYPE:R(se)&&(z.state=F.DOCTYPE_DTD_QUOTED,z.q=se);continue;case F.DOCTYPE_DTD_QUOTED:z.doctype+=se,se===z.q&&(z.state=F.DOCTYPE_DTD,z.q="");continue;case F.COMMENT:se==="-"?z.state=F.COMMENT_ENDING:z.comment+=se;continue;case F.COMMENT_ENDING:se==="-"?(z.state=F.COMMENT_ENDED,z.comment=M(z.opt,z.comment),z.comment&&D(z,"oncomment",z.comment),z.comment=""):(z.comment+="-"+se,z.state=F.COMMENT);continue;case F.COMMENT_ENDED:se!==">"?(Z(z,"Malformed comment"),z.comment+="--"+se,z.state=F.COMMENT):z.state=F.TEXT;continue;case F.CDATA:se==="]"?z.state=F.CDATA_ENDING:z.cdata+=se;continue;case F.CDATA_ENDING:se==="]"?z.state=F.CDATA_ENDING_2:(z.cdata+="]"+se,z.state=F.CDATA);continue;case F.CDATA_ENDING_2:se===">"?(z.cdata&&D(z,"oncdata",z.cdata),D(z,"onclosecdata"),z.cdata="",z.state=F.TEXT):se==="]"?z.cdata+="]":(z.cdata+="]]"+se,z.state=F.CDATA);continue;case F.PROC_INST:se==="?"?z.state=F.PROC_INST_ENDING:E(se)?z.state=F.PROC_INST_BODY:z.procInstName+=se;continue;case F.PROC_INST_BODY:if(!z.procInstBody&&E(se))continue;se==="?"?z.state=F.PROC_INST_ENDING:z.procInstBody+=se;continue;case F.PROC_INST_ENDING:se===">"?(D(z,"onprocessinginstruction",{name:z.procInstName,body:z.procInstBody}),z.procInstName=z.procInstBody="",z.state=F.TEXT):(z.procInstBody+="?"+se,z.state=F.PROC_INST_BODY);continue;case F.OPEN_TAG:O(b,se)?z.tagName+=se:(we(z),se===">"?q(z):se==="/"?z.state=F.OPEN_TAG_SLASH:(E(se)||Z(z,"Invalid character in tag name"),z.state=F.ATTRIB));continue;case F.OPEN_TAG_SLASH:se===">"?(q(z,!0),I(z)):(Z(z,"Forward-slash in opening tag not followed by >"),z.state=F.ATTRIB);continue;case F.ATTRIB:if(E(se))continue;se===">"?q(z):se==="/"?z.state=F.OPEN_TAG_SLASH:O(_,se)?(z.attribName=se,z.attribValue="",z.state=F.ATTRIB_NAME):Z(z,"Invalid attribute name");continue;case F.ATTRIB_NAME:se==="="?z.state=F.ATTRIB_VALUE:se===">"?(Z(z,"Attribute without value"),z.attribValue=z.attribName,Ne(z),q(z)):E(se)?z.state=F.ATTRIB_NAME_SAW_WHITE:O(b,se)?z.attribName+=se:Z(z,"Invalid attribute name");continue;case F.ATTRIB_NAME_SAW_WHITE:if(se==="=")z.state=F.ATTRIB_VALUE;else{if(E(se))continue;Z(z,"Attribute without value"),z.tag.attributes[z.attribName]="",z.attribValue="",D(z,"onattribute",{name:z.attribName,value:""}),z.attribName="",se===">"?q(z):O(_,se)?(z.attribName=se,z.state=F.ATTRIB_NAME):(Z(z,"Invalid attribute name"),z.state=F.ATTRIB)}continue;case F.ATTRIB_VALUE:if(E(se))continue;R(se)?(z.q=se,z.state=F.ATTRIB_VALUE_QUOTED):(Z(z,"Unquoted attribute value"),z.state=F.ATTRIB_VALUE_UNQUOTED,z.attribValue=se);continue;case F.ATTRIB_VALUE_QUOTED:if(se!==z.q){se==="&"?z.state=F.ATTRIB_VALUE_ENTITY_Q:z.attribValue+=se;continue}Ne(z),z.q="",z.state=F.ATTRIB_VALUE_CLOSED;continue;case F.ATTRIB_VALUE_CLOSED:E(se)?z.state=F.ATTRIB:se===">"?q(z):se==="/"?z.state=F.OPEN_TAG_SLASH:O(_,se)?(Z(z,"No whitespace between attributes"),z.attribName=se,z.attribValue="",z.state=F.ATTRIB_NAME):Z(z,"Invalid attribute name");continue;case F.ATTRIB_VALUE_UNQUOTED:if(!L(se)){se==="&"?z.state=F.ATTRIB_VALUE_ENTITY_U:z.attribValue+=se;continue}Ne(z),se===">"?q(z):z.state=F.ATTRIB;continue;case F.CLOSE_TAG:if(z.tagName)se===">"?I(z):O(b,se)?z.tagName+=se:z.script?(z.script+="</"+z.tagName,z.tagName="",z.state=F.SCRIPT):(E(se)||Z(z,"Invalid tagname in closing tag"),z.state=F.CLOSE_TAG_SAW_WHITE);else{if(E(se))continue;P(_,se)?z.script?(z.script+="</"+se,z.state=F.SCRIPT):Z(z,"Invalid tagname in closing tag."):z.tagName=se}continue;case F.CLOSE_TAG_SAW_WHITE:if(E(se))continue;se===">"?I(z):Z(z,"Invalid characters in closing tag");continue;case F.TEXT_ENTITY:case F.ATTRIB_VALUE_ENTITY_Q:case F.ATTRIB_VALUE_ENTITY_U:var ce,k;switch(z.state){case F.TEXT_ENTITY:ce=F.TEXT,k="textNode";break;case F.ATTRIB_VALUE_ENTITY_Q:ce=F.ATTRIB_VALUE_QUOTED,k="attribValue";break;case F.ATTRIB_VALUE_ENTITY_U:ce=F.ATTRIB_VALUE_UNQUOTED,k="attribValue";break}se===";"?(z[k]+=X(z),z.entity="",z.state=ce):O(z.entity.length?S:N,se)?z.entity+=se:(Z(z,"Invalid character in entity name"),z[k]+="&"+z.entity+se,z.entity="",z.state=ce);continue;default:throw new Error(z,"Unknown state: "+z.state)}return z.position>=z.bufferCheckPosition&&a(z),z}String.fromCodePoint||(function(){var B=String.fromCharCode,z=Math.floor,ue=function(){var se=16384,re=[],W,ce,k=-1,de=arguments.length;if(!de)return"";for(var U="";++k<de;){var T=Number(arguments[k]);if(!isFinite(T)||T<0||T>1114111||z(T)!==T)throw RangeError("Invalid code point: "+T);T<=65535?re.push(T):(T-=65536,W=(T>>10)+55296,ce=T%1024+56320,re.push(W,ce)),(k+1===de||re.length>se)&&(U+=B.apply(null,re),re.length=0)}return U};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:ue,configurable:!0,writable:!0}):String.fromCodePoint=ue})()})(e)})(Hx)),Hx}var i1,dN;function nv(){return dN||(dN=1,i1={isArray:function(e){return Array.isArray?Array.isArray(e):Object.prototype.toString.call(e)==="[object Array]"}}),i1}var o1,fN;function iv(){if(fN)return o1;fN=1;var e=nv().isArray;return o1={copyOptions:function(t){var r,s={};for(r in t)t.hasOwnProperty(r)&&(s[r]=t[r]);return s},ensureFlagExists:function(t,r){(!(t in r)||typeof r[t]!="boolean")&&(r[t]=!1)},ensureSpacesExists:function(t){(!("spaces"in t)||typeof t.spaces!="number"&&typeof t.spaces!="string")&&(t.spaces=0)},ensureAlwaysArrayExists:function(t){(!("alwaysArray"in t)||typeof t.alwaysArray!="boolean"&&!e(t.alwaysArray))&&(t.alwaysArray=!1)},ensureKeyExists:function(t,r){(!(t+"Key"in r)||typeof r[t+"Key"]!="string")&&(r[t+"Key"]=r.compact?"_"+t:t)},checkFnExists:function(t,r){return t+"Fn"in r}},o1}var l1,hN;function P4(){if(hN)return l1;hN=1;var e=M7(),t=iv(),r=nv().isArray,s,a;function o(b){return s=t.copyOptions(b),t.ensureFlagExists("ignoreDeclaration",s),t.ensureFlagExists("ignoreInstruction",s),t.ensureFlagExists("ignoreAttributes",s),t.ensureFlagExists("ignoreText",s),t.ensureFlagExists("ignoreComment",s),t.ensureFlagExists("ignoreCdata",s),t.ensureFlagExists("ignoreDoctype",s),t.ensureFlagExists("compact",s),t.ensureFlagExists("alwaysChildren",s),t.ensureFlagExists("addParent",s),t.ensureFlagExists("trim",s),t.ensureFlagExists("nativeType",s),t.ensureFlagExists("nativeTypeAttributes",s),t.ensureFlagExists("sanitize",s),t.ensureFlagExists("instructionHasAttributes",s),t.ensureFlagExists("captureSpacesBetweenElements",s),t.ensureAlwaysArrayExists(s),t.ensureKeyExists("declaration",s),t.ensureKeyExists("instruction",s),t.ensureKeyExists("attributes",s),t.ensureKeyExists("text",s),t.ensureKeyExists("comment",s),t.ensureKeyExists("cdata",s),t.ensureKeyExists("doctype",s),t.ensureKeyExists("type",s),t.ensureKeyExists("name",s),t.ensureKeyExists("elements",s),t.ensureKeyExists("parent",s),t.checkFnExists("doctype",s),t.checkFnExists("instruction",s),t.checkFnExists("cdata",s),t.checkFnExists("comment",s),t.checkFnExists("text",s),t.checkFnExists("instructionName",s),t.checkFnExists("elementName",s),t.checkFnExists("attributeName",s),t.checkFnExists("attributeValue",s),t.checkFnExists("attributes",s),s}function c(b){var N=Number(b);if(!isNaN(N))return N;var S=b.toLowerCase();return S==="true"?!0:S==="false"?!1:b}function u(b,N){var S;if(s.compact){if(!a[s[b+"Key"]]&&(r(s.alwaysArray)?s.alwaysArray.indexOf(s[b+"Key"])!==-1:s.alwaysArray)&&(a[s[b+"Key"]]=[]),a[s[b+"Key"]]&&!r(a[s[b+"Key"]])&&(a[s[b+"Key"]]=[a[s[b+"Key"]]]),b+"Fn"in s&&typeof N=="string"&&(N=s[b+"Fn"](N,a)),b==="instruction"&&("instructionFn"in s||"instructionNameFn"in s)){for(S in N)if(N.hasOwnProperty(S))if("instructionFn"in s)N[S]=s.instructionFn(N[S],S,a);else{var E=N[S];delete N[S],N[s.instructionNameFn(S,E,a)]=E}}r(a[s[b+"Key"]])?a[s[b+"Key"]].push(N):a[s[b+"Key"]]=N}else{a[s.elementsKey]||(a[s.elementsKey]=[]);var R={};if(R[s.typeKey]=b,b==="instruction"){for(S in N)if(N.hasOwnProperty(S))break;R[s.nameKey]="instructionNameFn"in s?s.instructionNameFn(S,N,a):S,s.instructionHasAttributes?(R[s.attributesKey]=N[S][s.attributesKey],"instructionFn"in s&&(R[s.attributesKey]=s.instructionFn(R[s.attributesKey],S,a))):("instructionFn"in s&&(N[S]=s.instructionFn(N[S],S,a)),R[s.instructionKey]=N[S])}else b+"Fn"in s&&(N=s[b+"Fn"](N,a)),R[s[b+"Key"]]=N;s.addParent&&(R[s.parentKey]=a),a[s.elementsKey].push(R)}}function d(b){if("attributesFn"in s&&b&&(b=s.attributesFn(b,a)),(s.trim||"attributeValueFn"in s||"attributeNameFn"in s||s.nativeTypeAttributes)&&b){var N;for(N in b)if(b.hasOwnProperty(N)&&(s.trim&&(b[N]=b[N].trim()),s.nativeTypeAttributes&&(b[N]=c(b[N])),"attributeValueFn"in s&&(b[N]=s.attributeValueFn(b[N],N,a)),"attributeNameFn"in s)){var S=b[N];delete b[N],b[s.attributeNameFn(N,b[N],a)]=S}}return b}function h(b){var N={};if(b.body&&(b.name.toLowerCase()==="xml"||s.instructionHasAttributes)){for(var S=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,E;(E=S.exec(b.body))!==null;)N[E[1]]=E[2]||E[3]||E[4];N=d(N)}if(b.name.toLowerCase()==="xml"){if(s.ignoreDeclaration)return;a[s.declarationKey]={},Object.keys(N).length&&(a[s.declarationKey][s.attributesKey]=N),s.addParent&&(a[s.declarationKey][s.parentKey]=a)}else{if(s.ignoreInstruction)return;s.trim&&(b.body=b.body.trim());var R={};s.instructionHasAttributes&&Object.keys(N).length?(R[b.name]={},R[b.name][s.attributesKey]=N):R[b.name]=b.body,u("instruction",R)}}function m(b,N){var S;if(typeof b=="object"&&(N=b.attributes,b=b.name),N=d(N),"elementNameFn"in s&&(b=s.elementNameFn(b,a)),s.compact){if(S={},!s.ignoreAttributes&&N&&Object.keys(N).length){S[s.attributesKey]={};var E;for(E in N)N.hasOwnProperty(E)&&(S[s.attributesKey][E]=N[E])}!(b in a)&&(r(s.alwaysArray)?s.alwaysArray.indexOf(b)!==-1:s.alwaysArray)&&(a[b]=[]),a[b]&&!r(a[b])&&(a[b]=[a[b]]),r(a[b])?a[b].push(S):a[b]=S}else a[s.elementsKey]||(a[s.elementsKey]=[]),S={},S[s.typeKey]="element",S[s.nameKey]=b,!s.ignoreAttributes&&N&&Object.keys(N).length&&(S[s.attributesKey]=N),s.alwaysChildren&&(S[s.elementsKey]=[]),a[s.elementsKey].push(S);S[s.parentKey]=a,a=S}function x(b){s.ignoreText||!b.trim()&&!s.captureSpacesBetweenElements||(s.trim&&(b=b.trim()),s.nativeType&&(b=c(b)),s.sanitize&&(b=b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),u("text",b))}function y(b){s.ignoreComment||(s.trim&&(b=b.trim()),u("comment",b))}function v(b){var N=a[s.parentKey];s.addParent||delete a[s.parentKey],a=N}function w(b){s.ignoreCdata||(s.trim&&(b=b.trim()),u("cdata",b))}function g(b){s.ignoreDoctype||(b=b.replace(/^ /,""),s.trim&&(b=b.trim()),u("doctype",b))}function _(b){b.note=b}return l1=function(b,N){var S=e.parser(!0,{}),E={};if(a=E,s=o(N),S.opt={strictEntities:!0},S.onopentag=m,S.ontext=x,S.oncomment=y,S.onclosetag=v,S.onerror=_,S.oncdata=w,S.ondoctype=g,S.onprocessinginstruction=h,S.write(b).close(),E[s.elementsKey]){var R=E[s.elementsKey];delete E[s.elementsKey],E[s.elementsKey]=R,delete E.text}return E},l1}var c1,mN;function P7(){if(mN)return c1;mN=1;var e=iv(),t=P4();function r(s){var a=e.copyOptions(s);return e.ensureSpacesExists(a),a}return c1=function(s,a){var o,c,u,d;return o=r(a),c=t(s,o),d="compact"in o&&o.compact?"_parent":"parent","addParent"in o&&o.addParent?u=JSON.stringify(c,function(h,m){return h===d?"_":m},o.spaces):u=JSON.stringify(c,null,o.spaces),u.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},c1}var u1,pN;function B4(){if(pN)return u1;pN=1;var e=iv(),t=nv().isArray,r,s;function a(S){var E=e.copyOptions(S);return e.ensureFlagExists("ignoreDeclaration",E),e.ensureFlagExists("ignoreInstruction",E),e.ensureFlagExists("ignoreAttributes",E),e.ensureFlagExists("ignoreText",E),e.ensureFlagExists("ignoreComment",E),e.ensureFlagExists("ignoreCdata",E),e.ensureFlagExists("ignoreDoctype",E),e.ensureFlagExists("compact",E),e.ensureFlagExists("indentText",E),e.ensureFlagExists("indentCdata",E),e.ensureFlagExists("indentAttributes",E),e.ensureFlagExists("indentInstruction",E),e.ensureFlagExists("fullTagEmptyElement",E),e.ensureFlagExists("noQuotesForNativeAttributes",E),e.ensureSpacesExists(E),typeof E.spaces=="number"&&(E.spaces=Array(E.spaces+1).join(" ")),e.ensureKeyExists("declaration",E),e.ensureKeyExists("instruction",E),e.ensureKeyExists("attributes",E),e.ensureKeyExists("text",E),e.ensureKeyExists("comment",E),e.ensureKeyExists("cdata",E),e.ensureKeyExists("doctype",E),e.ensureKeyExists("type",E),e.ensureKeyExists("name",E),e.ensureKeyExists("elements",E),e.checkFnExists("doctype",E),e.checkFnExists("instruction",E),e.checkFnExists("cdata",E),e.checkFnExists("comment",E),e.checkFnExists("text",E),e.checkFnExists("instructionName",E),e.checkFnExists("elementName",E),e.checkFnExists("attributeName",E),e.checkFnExists("attributeValue",E),e.checkFnExists("attributes",E),e.checkFnExists("fullTagEmptyElement",E),E}function o(S,E,R){return(!R&&S.spaces?`
`:"")+Array(E+1).join(S.spaces)}function c(S,E,R){if(E.ignoreAttributes)return"";"attributesFn"in E&&(S=E.attributesFn(S,s,r));var L,O,P,F,V=[];for(L in S)S.hasOwnProperty(L)&&S[L]!==null&&S[L]!==void 0&&(F=E.noQuotesForNativeAttributes&&typeof S[L]!="string"?"":'"',O=""+S[L],O=O.replace(/"/g,"&quot;"),P="attributeNameFn"in E?E.attributeNameFn(L,O,s,r):L,V.push(E.spaces&&E.indentAttributes?o(E,R+1,!1):" "),V.push(P+"="+F+("attributeValueFn"in E?E.attributeValueFn(O,L,s,r):O)+F));return S&&Object.keys(S).length&&E.spaces&&E.indentAttributes&&V.push(o(E,R,!1)),V.join("")}function u(S,E,R){return r=S,s="xml",E.ignoreDeclaration?"":"<?xml"+c(S[E.attributesKey],E,R)+"?>"}function d(S,E,R){if(E.ignoreInstruction)return"";var L;for(L in S)if(S.hasOwnProperty(L))break;var O="instructionNameFn"in E?E.instructionNameFn(L,S[L],s,r):L;if(typeof S[L]=="object")return r=S,s=O,"<?"+O+c(S[L][E.attributesKey],E,R)+"?>";var P=S[L]?S[L]:"";return"instructionFn"in E&&(P=E.instructionFn(P,L,s,r)),"<?"+O+(P?" "+P:"")+"?>"}function h(S,E){return E.ignoreComment?"":"<!--"+("commentFn"in E?E.commentFn(S,s,r):S)+"-->"}function m(S,E){return E.ignoreCdata?"":"<![CDATA["+("cdataFn"in E?E.cdataFn(S,s,r):S.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function x(S,E){return E.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in E?E.doctypeFn(S,s,r):S)+">"}function y(S,E){return E.ignoreText?"":(S=""+S,S=S.replace(/&amp;/g,"&"),S=S.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in E?E.textFn(S,s,r):S)}function v(S,E){var R;if(S.elements&&S.elements.length)for(R=0;R<S.elements.length;++R)switch(S.elements[R][E.typeKey]){case"text":if(E.indentText)return!0;break;case"cdata":if(E.indentCdata)return!0;break;case"instruction":if(E.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function w(S,E,R){r=S,s=S.name;var L=[],O="elementNameFn"in E?E.elementNameFn(S.name,S):S.name;L.push("<"+O),S[E.attributesKey]&&L.push(c(S[E.attributesKey],E,R));var P=S[E.elementsKey]&&S[E.elementsKey].length||S[E.attributesKey]&&S[E.attributesKey]["xml:space"]==="preserve";return P||("fullTagEmptyElementFn"in E?P=E.fullTagEmptyElementFn(S.name,S):P=E.fullTagEmptyElement),P?(L.push(">"),S[E.elementsKey]&&S[E.elementsKey].length&&(L.push(g(S[E.elementsKey],E,R+1)),r=S,s=S.name),L.push(E.spaces&&v(S,E)?`
`+Array(R+1).join(E.spaces):""),L.push("</"+O+">")):L.push("/>"),L.join("")}function g(S,E,R,L){return S.reduce(function(O,P){var F=o(E,R,L&&!O);switch(P.type){case"element":return O+F+w(P,E,R);case"comment":return O+F+h(P[E.commentKey],E);case"doctype":return O+F+x(P[E.doctypeKey],E);case"cdata":return O+(E.indentCdata?F:"")+m(P[E.cdataKey],E);case"text":return O+(E.indentText?F:"")+y(P[E.textKey],E);case"instruction":var V={};return V[P[E.nameKey]]=P[E.attributesKey]?P:P[E.instructionKey],O+(E.indentInstruction?F:"")+d(V,E,R)}},"")}function _(S,E,R){var L;for(L in S)if(S.hasOwnProperty(L))switch(L){case E.parentKey:case E.attributesKey:break;case E.textKey:if(E.indentText||R)return!0;break;case E.cdataKey:if(E.indentCdata||R)return!0;break;case E.instructionKey:if(E.indentInstruction||R)return!0;break;case E.doctypeKey:case E.commentKey:return!0;default:return!0}return!1}function b(S,E,R,L,O){r=S,s=E;var P="elementNameFn"in R?R.elementNameFn(E,S):E;if(typeof S>"u"||S===null||S==="")return"fullTagEmptyElementFn"in R&&R.fullTagEmptyElementFn(E,S)||R.fullTagEmptyElement?"<"+P+"></"+P+">":"<"+P+"/>";var F=[];if(E){if(F.push("<"+P),typeof S!="object")return F.push(">"+y(S,R)+"</"+P+">"),F.join("");S[R.attributesKey]&&F.push(c(S[R.attributesKey],R,L));var V=_(S,R,!0)||S[R.attributesKey]&&S[R.attributesKey]["xml:space"]==="preserve";if(V||("fullTagEmptyElementFn"in R?V=R.fullTagEmptyElementFn(E,S):V=R.fullTagEmptyElement),V)F.push(">");else return F.push("/>"),F.join("")}return F.push(N(S,R,L+1,!1)),r=S,s=E,E&&F.push((O?o(R,L,!1):"")+"</"+P+">"),F.join("")}function N(S,E,R,L){var O,P,F,V=[];for(P in S)if(S.hasOwnProperty(P))for(F=t(S[P])?S[P]:[S[P]],O=0;O<F.length;++O){switch(P){case E.declarationKey:V.push(u(F[O],E,R));break;case E.instructionKey:V.push((E.indentInstruction?o(E,R,L):"")+d(F[O],E,R));break;case E.attributesKey:case E.parentKey:break;case E.textKey:V.push((E.indentText?o(E,R,L):"")+y(F[O],E));break;case E.cdataKey:V.push((E.indentCdata?o(E,R,L):"")+m(F[O],E));break;case E.doctypeKey:V.push(o(E,R,L)+x(F[O],E));break;case E.commentKey:V.push(o(E,R,L)+h(F[O],E));break;default:V.push(o(E,R,L)+b(F[O],P,E,R,_(F[O],E)))}L=L&&!V.length}return V.join("")}return u1=function(S,E){E=a(E);var R=[];return r=S,s="_root_",E.compact?R.push(N(S,E,0,!0)):(S[E.declarationKey]&&R.push(u(S[E.declarationKey],E,0)),S[E.elementsKey]&&S[E.elementsKey].length&&R.push(g(S[E.elementsKey],E,0,!R.length))),R.join("")},u1}var d1,xN;function B7(){if(xN)return d1;xN=1;var e=B4();return d1=function(t,r){t instanceof Buffer&&(t=t.toString());var s=null;if(typeof t=="string")try{s=JSON.parse(t)}catch{throw new Error("The JSON structure is invalid")}else s=t;return e(s,r)},d1}var f1,gN;function U7(){if(gN)return f1;gN=1;var e=P4(),t=P7(),r=B4(),s=B7();return f1={xml2js:e,xml2json:t,js2xml:r,json2xml:s},f1}var U4=U7();const ov=e=>{switch(e.type){case void 0:case"element":const t=new q7(e.name,e.attributes),r=e.elements||[];for(const s of r){const a=ov(s);a!==void 0&&t.push(a)}return t;case"text":return e.text;default:return}};class z7 extends Ct{}class q7 extends tt{static fromXmlString(t){const r=U4.xml2js(t,{compact:!1});return ov(r)}constructor(t,r){super(t),r&&this.root.push(new z7(r))}push(t){this.root.push(t)}}class $7 extends tt{constructor(t){super(""),this._attr=t}prepForXml(t){return{_attr:this._attr}}}class z4 extends tt{constructor(t,r){super(t),r&&(this.root=r.root)}}const oa=e=>{if(isNaN(e))throw new Error(`Invalid value '${e}' specified. Must be an integer.`);return Math.floor(e)},G0=e=>{const t=oa(e);if(t<0)throw new Error(`Invalid value '${e}' specified. Must be a positive integer.`);return t},q4=(e,t)=>{const r=t*2;if(e.length!==r||isNaN(+`0x${e}`))throw new Error(`Invalid hex value '${e}'. Expected ${r} digit hex value`);return e},yN=e=>q4(e,1),lv=e=>{const t=e.slice(-2),r=e.substring(0,e.length-2);return`${Number(r)}${t}`},$4=e=>{const t=lv(e);if(parseFloat(t)<0)throw new Error(`Invalid value '${t}' specified. Expected a positive number.`);return t},Lc=e=>{if(e==="auto")return e;const t=e.charAt(0)==="#"?e.substring(1):e;return q4(t,3)},di=e=>typeof e=="string"?lv(e):oa(e),H7=e=>typeof e=="string"?$4(e):G0(e),Ks=e=>typeof e=="string"?$4(e):G0(e),W7=e=>{const t=e.substring(0,e.length-1);return`${Number(t)}%`},H4=e=>typeof e=="number"?oa(e):e.slice(-1)==="%"?W7(e):lv(e),G7=G0,V7=G0,K7=e=>e.toISOString();class xt extends tt{constructor(t,r=!0){super(t),r!==!0&&this.root.push(new ls({val:r}))}}class h1 extends tt{constructor(t,r){super(t),this.root.push(new ls({val:H7(r)}))}}class Jo extends tt{constructor(t,r){super(t),this.root.push(new ls({val:r}))}}const $u=(e,t)=>new Cr({name:e,attributes:{value:{key:"w:val",value:t}}});class ad extends tt{constructor(t,r){super(t),this.root.push(new ls({val:r}))}}class X7 extends tt{constructor(t,r){super(t),this.root.push(new ls({val:r}))}}class Mo extends tt{constructor(t,r){super(t),this.root.push(r)}}class Cr extends tt{constructor({name:t,attributes:r,children:s}){super(t),r&&this.root.push(new Si(r)),s&&this.root.push(...s)}}const Ot={START:"start",CENTER:"center",LEFT:"left",RIGHT:"right"};class Y7 extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{val:"w:val"})}}class W4 extends tt{constructor(t){super("w:jc"),this.root.push(new Y7({val:t}))}}class Mr extends tt{constructor(t,{color:r,size:s,space:a,style:o}){super(t),this.root.push(new J7({style:o,color:r===void 0?void 0:Lc(r),size:s===void 0?void 0:G7(s),space:a===void 0?void 0:V7(a)}))}}class J7 extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}}const or={SINGLE:"single",NONE:"none"};class Z7 extends _i{constructor(t){super("w:pBdr"),t.top&&this.root.push(new Mr("w:top",t.top)),t.bottom&&this.root.push(new Mr("w:bottom",t.bottom)),t.left&&this.root.push(new Mr("w:left",t.left)),t.right&&this.root.push(new Mr("w:right",t.right))}}class Q7 extends tt{constructor(){super("w:pBdr");const t=new Mr("w:bottom",{color:"auto",space:1,style:or.SINGLE,size:6});this.root.push(t)}}class e9 extends tt{constructor({start:t,end:r,left:s,right:a,hanging:o,firstLine:c}){super("w:ind"),this.root.push(new Si({start:{key:"w:start",value:t===void 0?void 0:di(t)},end:{key:"w:end",value:r===void 0?void 0:di(r)},left:{key:"w:left",value:s===void 0?void 0:di(s)},right:{key:"w:right",value:a===void 0?void 0:di(a)},hanging:{key:"w:hanging",value:o===void 0?void 0:Ks(o)},firstLine:{key:"w:firstLine",value:c===void 0?void 0:Ks(c)}}))}}let t9=class extends tt{constructor(){super("w:br")}};const cv={BEGIN:"begin",END:"end",SEPARATE:"separate"};class uv extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}}class Rh extends tt{constructor(t){super("w:fldChar"),this.root.push(new uv({type:cv.BEGIN,dirty:t}))}}class Dh extends tt{constructor(t){super("w:fldChar"),this.root.push(new uv({type:cv.SEPARATE,dirty:t}))}}class Oh extends tt{constructor(t){super("w:fldChar"),this.root.push(new uv({type:cv.END,dirty:t}))}}const Ic={DEFAULT:"default",PRESERVE:"preserve"};class Mc extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{space:"xml:space"})}}class r9 extends tt{constructor(){super("w:instrText"),this.root.push(new Mc({space:Ic.PRESERVE})),this.root.push("PAGE")}}class s9 extends tt{constructor(){super("w:instrText"),this.root.push(new Mc({space:Ic.PRESERVE})),this.root.push("NUMPAGES")}}class a9 extends tt{constructor(){super("w:instrText"),this.root.push(new Mc({space:Ic.PRESERVE})),this.root.push("SECTIONPAGES")}}class n9 extends tt{constructor(){super("w:instrText"),this.root.push(new Mc({space:Ic.PRESERVE})),this.root.push("SECTION")}}class i9 extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}}class V0 extends tt{constructor({fill:t,color:r,type:s}){super("w:shd"),this.root.push(new i9({fill:t===void 0?void 0:Lc(t),color:r===void 0?void 0:Lc(r),type:s}))}}class o9 extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}}const l9={DOT:"dot"};class c9 extends tt{constructor(t){super("w:em"),this.root.push(new ls({val:t}))}}class u9 extends c9{constructor(t=l9.DOT){super(t)}}class d9 extends tt{constructor(t){super("w:spacing"),this.root.push(new ls({val:di(t)}))}}class f9 extends tt{constructor(t){super("w:color"),this.root.push(new ls({val:Lc(t)}))}}class h9 extends tt{constructor(t){super("w:highlight"),this.root.push(new ls({val:t}))}}class m9 extends tt{constructor(t){super("w:highlightCs"),this.root.push(new ls({val:t}))}}const p9=e=>new Cr({name:"w:lang",attributes:{value:{key:"w:val",value:e.value},eastAsia:{key:"w:eastAsia",value:e.eastAsia},bidirectional:{key:"w:bidi",value:e.bidirectional}}});class vN extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}}class m1 extends tt{constructor(t,r){if(super("w:rFonts"),typeof t=="string"){const s=t;this.root.push(new vN({ascii:s,cs:s,eastAsia:s,hAnsi:s,hint:r}))}else{const s=t;this.root.push(new vN(s))}}}let G4=class extends tt{constructor(t){super("w:vertAlign"),this.root.push(new ls({val:t}))}};class x9 extends G4{constructor(){super("superscript")}}class g9 extends G4{constructor(){super("subscript")}}const V4={SINGLE:"single"};class y9 extends tt{constructor(t=V4.SINGLE,r){super("w:u"),this.root.push(new ls({val:t,color:r===void 0?void 0:Lc(r)}))}}class pl extends _i{constructor(t){var r,s;if(super("w:rPr"),!t)return;t.style&&this.push(new Jo("w:rStyle",t.style)),t.font&&(typeof t.font=="string"?this.push(new m1(t.font)):"name"in t.font?this.push(new m1(t.font.name,t.font.hint)):this.push(new m1(t.font))),t.bold!==void 0&&this.push(new xt("w:b",t.bold)),(t.boldComplexScript===void 0&&t.bold!==void 0||t.boldComplexScript)&&this.push(new xt("w:bCs",(r=t.boldComplexScript)!=null?r:t.bold)),t.italics!==void 0&&this.push(new xt("w:i",t.italics)),(t.italicsComplexScript===void 0&&t.italics!==void 0||t.italicsComplexScript)&&this.push(new xt("w:iCs",(s=t.italicsComplexScript)!=null?s:t.italics)),t.smallCaps!==void 0?this.push(new xt("w:smallCaps",t.smallCaps)):t.allCaps!==void 0&&this.push(new xt("w:caps",t.allCaps)),t.strike!==void 0&&this.push(new xt("w:strike",t.strike)),t.doubleStrike!==void 0&&this.push(new xt("w:dstrike",t.doubleStrike)),t.emboss!==void 0&&this.push(new xt("w:emboss",t.emboss)),t.imprint!==void 0&&this.push(new xt("w:imprint",t.imprint)),t.noProof!==void 0&&this.push(new xt("w:noProof",t.noProof)),t.snapToGrid!==void 0&&this.push(new xt("w:snapToGrid",t.snapToGrid)),t.vanish&&this.push(new xt("w:vanish",t.vanish)),t.color&&this.push(new f9(t.color)),t.characterSpacing&&this.push(new d9(t.characterSpacing)),t.scale!==void 0&&this.push(new ad("w:w",t.scale)),t.kern&&this.push(new h1("w:kern",t.kern)),t.position&&this.push(new Jo("w:position",t.position)),t.size!==void 0&&this.push(new h1("w:sz",t.size));const a=t.sizeComplexScript===void 0||t.sizeComplexScript===!0?t.size:t.sizeComplexScript;a&&this.push(new h1("w:szCs",a)),t.highlight&&this.push(new h9(t.highlight));const o=t.highlightComplexScript===void 0||t.highlightComplexScript===!0?t.highlight:t.highlightComplexScript;o&&this.push(new m9(o)),t.underline&&this.push(new y9(t.underline.type,t.underline.color)),t.effect&&this.push(new Jo("w:effect",t.effect)),t.border&&this.push(new Mr("w:bdr",t.border)),t.shading&&this.push(new V0(t.shading)),t.subScript&&this.push(new g9),t.superScript&&this.push(new x9),t.rightToLeft!==void 0&&this.push(new xt("w:rtl",t.rightToLeft)),t.emphasisMark&&this.push(new u9(t.emphasisMark.type)),t.language&&this.push(p9(t.language)),t.specVanish&&this.push(new xt("w:specVanish",t.vanish)),t.math&&this.push(new xt("w:oMath",t.math)),t.revision&&this.push(new v9(t.revision))}push(t){this.root.push(t)}}class v9 extends tt{constructor(t){super("w:rPrChange"),this.root.push(new o9({id:t.id,author:t.author,date:t.date})),this.addChildElement(new pl(t))}}class wN extends tt{constructor(t){var r;super("w:t"),typeof t=="string"?(this.root.push(new Mc({space:Ic.PRESERVE})),this.root.push(t)):(this.root.push(new Mc({space:(r=t.space)!=null?r:Ic.DEFAULT})),this.root.push(t.text))}}const Fh={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"};class Yd extends tt{constructor(t){if(super("w:r"),Qe(this,"properties"),this.properties=new pl(t),this.root.push(this.properties),t.break)for(let r=0;r<t.break;r++)this.root.push(new t9);if(t.children)for(const r of t.children){if(typeof r=="string"){switch(r){case Fh.CURRENT:this.root.push(new Rh),this.root.push(new r9),this.root.push(new Dh),this.root.push(new Oh);break;case Fh.TOTAL_PAGES:this.root.push(new Rh),this.root.push(new s9),this.root.push(new Dh),this.root.push(new Oh);break;case Fh.TOTAL_PAGES_IN_SECTION:this.root.push(new Rh),this.root.push(new a9),this.root.push(new Dh),this.root.push(new Oh);break;case Fh.CURRENT_SECTION:this.root.push(new Rh),this.root.push(new n9),this.root.push(new Dh),this.root.push(new Oh);break;default:this.root.push(new wN(r));break}continue}this.root.push(r)}else t.text!==void 0&&this.root.push(new wN(t.text))}}class Rt extends Yd{constructor(t){super(typeof t=="string"?{text:t}:t)}}var p1={},Ir={},x1,bN;function Jd(){if(bN)return x1;bN=1,x1=e;function e(t,r){if(!t)throw new Error(r||"Assertion failed")}return e.equal=function(r,s,a){if(r!=s)throw new Error(a||"Assertion failed: "+r+" != "+s)},x1}var _N;function Bn(){if(_N)return Ir;_N=1;var e=Jd(),t=fo();Ir.inherits=t;function r(D,K){return(D.charCodeAt(K)&64512)!==55296||K<0||K+1>=D.length?!1:(D.charCodeAt(K+1)&64512)===56320}function s(D,K){if(Array.isArray(D))return D.slice();if(!D)return[];var M=[];if(typeof D=="string")if(K){if(K==="hex")for(D=D.replace(/[^a-z0-9]+/ig,""),D.length%2!==0&&(D="0"+D),te=0;te<D.length;te+=2)M.push(parseInt(D[te]+D[te+1],16))}else for(var ae=0,te=0;te<D.length;te++){var Z=D.charCodeAt(te);Z<128?M[ae++]=Z:Z<2048?(M[ae++]=Z>>6|192,M[ae++]=Z&63|128):r(D,te)?(Z=65536+((Z&1023)<<10)+(D.charCodeAt(++te)&1023),M[ae++]=Z>>18|240,M[ae++]=Z>>12&63|128,M[ae++]=Z>>6&63|128,M[ae++]=Z&63|128):(M[ae++]=Z>>12|224,M[ae++]=Z>>6&63|128,M[ae++]=Z&63|128)}else for(te=0;te<D.length;te++)M[te]=D[te]|0;return M}Ir.toArray=s;function a(D){for(var K="",M=0;M<D.length;M++)K+=u(D[M].toString(16));return K}Ir.toHex=a;function o(D){var K=D>>>24|D>>>8&65280|D<<8&16711680|(D&255)<<24;return K>>>0}Ir.htonl=o;function c(D,K){for(var M="",ae=0;ae<D.length;ae++){var te=D[ae];K==="little"&&(te=o(te)),M+=d(te.toString(16))}return M}Ir.toHex32=c;function u(D){return D.length===1?"0"+D:D}Ir.zero2=u;function d(D){return D.length===7?"0"+D:D.length===6?"00"+D:D.length===5?"000"+D:D.length===4?"0000"+D:D.length===3?"00000"+D:D.length===2?"000000"+D:D.length===1?"0000000"+D:D}Ir.zero8=d;function h(D,K,M,ae){var te=M-K;e(te%4===0);for(var Z=new Array(te/4),we=0,ee=K;we<Z.length;we++,ee+=4){var Ne;ae==="big"?Ne=D[ee]<<24|D[ee+1]<<16|D[ee+2]<<8|D[ee+3]:Ne=D[ee+3]<<24|D[ee+2]<<16|D[ee+1]<<8|D[ee],Z[we]=Ne>>>0}return Z}Ir.join32=h;function m(D,K){for(var M=new Array(D.length*4),ae=0,te=0;ae<D.length;ae++,te+=4){var Z=D[ae];K==="big"?(M[te]=Z>>>24,M[te+1]=Z>>>16&255,M[te+2]=Z>>>8&255,M[te+3]=Z&255):(M[te+3]=Z>>>24,M[te+2]=Z>>>16&255,M[te+1]=Z>>>8&255,M[te]=Z&255)}return M}Ir.split32=m;function x(D,K){return D>>>K|D<<32-K}Ir.rotr32=x;function y(D,K){return D<<K|D>>>32-K}Ir.rotl32=y;function v(D,K){return D+K>>>0}Ir.sum32=v;function w(D,K,M){return D+K+M>>>0}Ir.sum32_3=w;function g(D,K,M,ae){return D+K+M+ae>>>0}Ir.sum32_4=g;function _(D,K,M,ae,te){return D+K+M+ae+te>>>0}Ir.sum32_5=_;function b(D,K,M,ae){var te=D[K],Z=D[K+1],we=ae+Z>>>0,ee=(we<ae?1:0)+M+te;D[K]=ee>>>0,D[K+1]=we}Ir.sum64=b;function N(D,K,M,ae){var te=K+ae>>>0,Z=(te<K?1:0)+D+M;return Z>>>0}Ir.sum64_hi=N;function S(D,K,M,ae){var te=K+ae;return te>>>0}Ir.sum64_lo=S;function E(D,K,M,ae,te,Z,we,ee){var Ne=0,q=K;q=q+ae>>>0,Ne+=q<K?1:0,q=q+Z>>>0,Ne+=q<Z?1:0,q=q+ee>>>0,Ne+=q<ee?1:0;var I=D+M+te+we+Ne;return I>>>0}Ir.sum64_4_hi=E;function R(D,K,M,ae,te,Z,we,ee){var Ne=K+ae+Z+ee;return Ne>>>0}Ir.sum64_4_lo=R;function L(D,K,M,ae,te,Z,we,ee,Ne,q){var I=0,X=K;X=X+ae>>>0,I+=X<K?1:0,X=X+Z>>>0,I+=X<Z?1:0,X=X+ee>>>0,I+=X<ee?1:0,X=X+q>>>0,I+=X<q?1:0;var H=D+M+te+we+Ne+I;return H>>>0}Ir.sum64_5_hi=L;function O(D,K,M,ae,te,Z,we,ee,Ne,q){var I=K+ae+Z+ee+q;return I>>>0}Ir.sum64_5_lo=O;function P(D,K,M){var ae=K<<32-M|D>>>M;return ae>>>0}Ir.rotr64_hi=P;function F(D,K,M){var ae=D<<32-M|K>>>M;return ae>>>0}Ir.rotr64_lo=F;function V(D,K,M){return D>>>M}Ir.shr64_hi=V;function oe(D,K,M){var ae=D<<32-M|K>>>M;return ae>>>0}return Ir.shr64_lo=oe,Ir}var g1={},SN;function Zd(){if(SN)return g1;SN=1;var e=Bn(),t=Jd();function r(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return g1.BlockHash=r,r.prototype.update=function(a,o){if(a=e.toArray(a,o),this.pending?this.pending=this.pending.concat(a):this.pending=a,this.pendingTotal+=a.length,this.pending.length>=this._delta8){a=this.pending;var c=a.length%this._delta8;this.pending=a.slice(a.length-c,a.length),this.pending.length===0&&(this.pending=null),a=e.join32(a,0,a.length-c,this.endian);for(var u=0;u<a.length;u+=this._delta32)this._update(a,u,u+this._delta32)}return this},r.prototype.digest=function(a){return this.update(this._pad()),t(this.pending===null),this._digest(a)},r.prototype._pad=function(){var a=this.pendingTotal,o=this._delta8,c=o-(a+this.padLength)%o,u=new Array(c+this.padLength);u[0]=128;for(var d=1;d<c;d++)u[d]=0;if(a<<=3,this.endian==="big"){for(var h=8;h<this.padLength;h++)u[d++]=0;u[d++]=0,u[d++]=0,u[d++]=0,u[d++]=0,u[d++]=a>>>24&255,u[d++]=a>>>16&255,u[d++]=a>>>8&255,u[d++]=a&255}else for(u[d++]=a&255,u[d++]=a>>>8&255,u[d++]=a>>>16&255,u[d++]=a>>>24&255,u[d++]=0,u[d++]=0,u[d++]=0,u[d++]=0,h=8;h<this.padLength;h++)u[d++]=0;return u},g1}var Po={},Rn={},kN;function K4(){if(kN)return Rn;kN=1;var e=Bn(),t=e.rotr32;function r(m,x,y,v){if(m===0)return s(x,y,v);if(m===1||m===3)return o(x,y,v);if(m===2)return a(x,y,v)}Rn.ft_1=r;function s(m,x,y){return m&x^~m&y}Rn.ch32=s;function a(m,x,y){return m&x^m&y^x&y}Rn.maj32=a;function o(m,x,y){return m^x^y}Rn.p32=o;function c(m){return t(m,2)^t(m,13)^t(m,22)}Rn.s0_256=c;function u(m){return t(m,6)^t(m,11)^t(m,25)}Rn.s1_256=u;function d(m){return t(m,7)^t(m,18)^m>>>3}Rn.g0_256=d;function h(m){return t(m,17)^t(m,19)^m>>>10}return Rn.g1_256=h,Rn}var y1,NN;function w9(){if(NN)return y1;NN=1;var e=Bn(),t=Zd(),r=K4(),s=e.rotl32,a=e.sum32,o=e.sum32_5,c=r.ft_1,u=t.BlockHash,d=[1518500249,1859775393,2400959708,3395469782];function h(){if(!(this instanceof h))return new h;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return e.inherits(h,u),y1=h,h.blockSize=512,h.outSize=160,h.hmacStrength=80,h.padLength=64,h.prototype._update=function(x,y){for(var v=this.W,w=0;w<16;w++)v[w]=x[y+w];for(;w<v.length;w++)v[w]=s(v[w-3]^v[w-8]^v[w-14]^v[w-16],1);var g=this.h[0],_=this.h[1],b=this.h[2],N=this.h[3],S=this.h[4];for(w=0;w<v.length;w++){var E=~~(w/20),R=o(s(g,5),c(E,_,b,N),S,v[w],d[E]);S=N,N=b,b=s(_,30),_=g,g=R}this.h[0]=a(this.h[0],g),this.h[1]=a(this.h[1],_),this.h[2]=a(this.h[2],b),this.h[3]=a(this.h[3],N),this.h[4]=a(this.h[4],S)},h.prototype._digest=function(x){return x==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")},y1}var v1,EN;function X4(){if(EN)return v1;EN=1;var e=Bn(),t=Zd(),r=K4(),s=Jd(),a=e.sum32,o=e.sum32_4,c=e.sum32_5,u=r.ch32,d=r.maj32,h=r.s0_256,m=r.s1_256,x=r.g0_256,y=r.g1_256,v=t.BlockHash,w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function g(){if(!(this instanceof g))return new g;v.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=w,this.W=new Array(64)}return e.inherits(g,v),v1=g,g.blockSize=512,g.outSize=256,g.hmacStrength=192,g.padLength=64,g.prototype._update=function(b,N){for(var S=this.W,E=0;E<16;E++)S[E]=b[N+E];for(;E<S.length;E++)S[E]=o(y(S[E-2]),S[E-7],x(S[E-15]),S[E-16]);var R=this.h[0],L=this.h[1],O=this.h[2],P=this.h[3],F=this.h[4],V=this.h[5],oe=this.h[6],D=this.h[7];for(s(this.k.length===S.length),E=0;E<S.length;E++){var K=c(D,m(F),u(F,V,oe),this.k[E],S[E]),M=a(h(R),d(R,L,O));D=oe,oe=V,V=F,F=a(P,K),P=O,O=L,L=R,R=a(K,M)}this.h[0]=a(this.h[0],R),this.h[1]=a(this.h[1],L),this.h[2]=a(this.h[2],O),this.h[3]=a(this.h[3],P),this.h[4]=a(this.h[4],F),this.h[5]=a(this.h[5],V),this.h[6]=a(this.h[6],oe),this.h[7]=a(this.h[7],D)},g.prototype._digest=function(b){return b==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")},v1}var w1,jN;function b9(){if(jN)return w1;jN=1;var e=Bn(),t=X4();function r(){if(!(this instanceof r))return new r;t.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return e.inherits(r,t),w1=r,r.blockSize=512,r.outSize=224,r.hmacStrength=192,r.padLength=64,r.prototype._digest=function(a){return a==="hex"?e.toHex32(this.h.slice(0,7),"big"):e.split32(this.h.slice(0,7),"big")},w1}var b1,TN;function Y4(){if(TN)return b1;TN=1;var e=Bn(),t=Zd(),r=Jd(),s=e.rotr64_hi,a=e.rotr64_lo,o=e.shr64_hi,c=e.shr64_lo,u=e.sum64,d=e.sum64_hi,h=e.sum64_lo,m=e.sum64_4_hi,x=e.sum64_4_lo,y=e.sum64_5_hi,v=e.sum64_5_lo,w=t.BlockHash,g=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function _(){if(!(this instanceof _))return new _;w.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=g,this.W=new Array(160)}e.inherits(_,w),b1=_,_.blockSize=1024,_.outSize=512,_.hmacStrength=192,_.padLength=128,_.prototype._prepareBlock=function(M,ae){for(var te=this.W,Z=0;Z<32;Z++)te[Z]=M[ae+Z];for(;Z<te.length;Z+=2){var we=oe(te[Z-4],te[Z-3]),ee=D(te[Z-4],te[Z-3]),Ne=te[Z-14],q=te[Z-13],I=F(te[Z-30],te[Z-29]),X=V(te[Z-30],te[Z-29]),H=te[Z-32],Q=te[Z-31];te[Z]=m(we,ee,Ne,q,I,X,H,Q),te[Z+1]=x(we,ee,Ne,q,I,X,H,Q)}},_.prototype._update=function(M,ae){this._prepareBlock(M,ae);var te=this.W,Z=this.h[0],we=this.h[1],ee=this.h[2],Ne=this.h[3],q=this.h[4],I=this.h[5],X=this.h[6],H=this.h[7],Q=this.h[8],ie=this.h[9],B=this.h[10],z=this.h[11],ue=this.h[12],se=this.h[13],re=this.h[14],W=this.h[15];r(this.k.length===te.length);for(var ce=0;ce<te.length;ce+=2){var k=re,de=W,U=O(Q,ie),T=P(Q,ie),A=b(Q,ie,B,z,ue),G=N(Q,ie,B,z,ue,se),xe=this.k[ce],be=this.k[ce+1],ne=te[ce],je=te[ce+1],Me=y(k,de,U,T,A,G,xe,be,ne,je),De=v(k,de,U,T,A,G,xe,be,ne,je);k=R(Z,we),de=L(Z,we),U=S(Z,we,ee,Ne,q),T=E(Z,we,ee,Ne,q,I);var Ce=d(k,de,U,T),st=h(k,de,U,T);re=ue,W=se,ue=B,se=z,B=Q,z=ie,Q=d(X,H,Me,De),ie=h(H,H,Me,De),X=q,H=I,q=ee,I=Ne,ee=Z,Ne=we,Z=d(Me,De,Ce,st),we=h(Me,De,Ce,st)}u(this.h,0,Z,we),u(this.h,2,ee,Ne),u(this.h,4,q,I),u(this.h,6,X,H),u(this.h,8,Q,ie),u(this.h,10,B,z),u(this.h,12,ue,se),u(this.h,14,re,W)},_.prototype._digest=function(M){return M==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")};function b(K,M,ae,te,Z){var we=K&ae^~K&Z;return we<0&&(we+=4294967296),we}function N(K,M,ae,te,Z,we){var ee=M&te^~M&we;return ee<0&&(ee+=4294967296),ee}function S(K,M,ae,te,Z){var we=K&ae^K&Z^ae&Z;return we<0&&(we+=4294967296),we}function E(K,M,ae,te,Z,we){var ee=M&te^M&we^te&we;return ee<0&&(ee+=4294967296),ee}function R(K,M){var ae=s(K,M,28),te=s(M,K,2),Z=s(M,K,7),we=ae^te^Z;return we<0&&(we+=4294967296),we}function L(K,M){var ae=a(K,M,28),te=a(M,K,2),Z=a(M,K,7),we=ae^te^Z;return we<0&&(we+=4294967296),we}function O(K,M){var ae=s(K,M,14),te=s(K,M,18),Z=s(M,K,9),we=ae^te^Z;return we<0&&(we+=4294967296),we}function P(K,M){var ae=a(K,M,14),te=a(K,M,18),Z=a(M,K,9),we=ae^te^Z;return we<0&&(we+=4294967296),we}function F(K,M){var ae=s(K,M,1),te=s(K,M,8),Z=o(K,M,7),we=ae^te^Z;return we<0&&(we+=4294967296),we}function V(K,M){var ae=a(K,M,1),te=a(K,M,8),Z=c(K,M,7),we=ae^te^Z;return we<0&&(we+=4294967296),we}function oe(K,M){var ae=s(K,M,19),te=s(M,K,29),Z=o(K,M,6),we=ae^te^Z;return we<0&&(we+=4294967296),we}function D(K,M){var ae=a(K,M,19),te=a(M,K,29),Z=c(K,M,6),we=ae^te^Z;return we<0&&(we+=4294967296),we}return b1}var _1,AN;function _9(){if(AN)return _1;AN=1;var e=Bn(),t=Y4();function r(){if(!(this instanceof r))return new r;t.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return e.inherits(r,t),_1=r,r.blockSize=1024,r.outSize=384,r.hmacStrength=192,r.padLength=128,r.prototype._digest=function(a){return a==="hex"?e.toHex32(this.h.slice(0,12),"big"):e.split32(this.h.slice(0,12),"big")},_1}var CN;function S9(){return CN||(CN=1,Po.sha1=w9(),Po.sha224=b9(),Po.sha256=X4(),Po.sha384=_9(),Po.sha512=Y4()),Po}var S1={},RN;function k9(){if(RN)return S1;RN=1;var e=Bn(),t=Zd(),r=e.rotl32,s=e.sum32,a=e.sum32_3,o=e.sum32_4,c=t.BlockHash;function u(){if(!(this instanceof u))return new u;c.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}e.inherits(u,c),S1.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(_,b){for(var N=this.h[0],S=this.h[1],E=this.h[2],R=this.h[3],L=this.h[4],O=N,P=S,F=E,V=R,oe=L,D=0;D<80;D++){var K=s(r(o(N,d(D,S,E,R),_[x[D]+b],h(D)),v[D]),L);N=L,L=R,R=r(E,10),E=S,S=K,K=s(r(o(O,d(79-D,P,F,V),_[y[D]+b],m(D)),w[D]),oe),O=oe,oe=V,V=r(F,10),F=P,P=K}K=a(this.h[1],E,V),this.h[1]=a(this.h[2],R,oe),this.h[2]=a(this.h[3],L,O),this.h[3]=a(this.h[4],N,P),this.h[4]=a(this.h[0],S,F),this.h[0]=K},u.prototype._digest=function(_){return _==="hex"?e.toHex32(this.h,"little"):e.split32(this.h,"little")};function d(g,_,b,N){return g<=15?_^b^N:g<=31?_&b|~_&N:g<=47?(_|~b)^N:g<=63?_&N|b&~N:_^(b|~N)}function h(g){return g<=15?0:g<=31?1518500249:g<=47?1859775393:g<=63?2400959708:2840853838}function m(g){return g<=15?1352829926:g<=31?1548603684:g<=47?1836072691:g<=63?2053994217:0}var x=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],y=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],v=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],w=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return S1}var k1,DN;function N9(){if(DN)return k1;DN=1;var e=Bn(),t=Jd();function r(s,a,o){if(!(this instanceof r))return new r(s,a,o);this.Hash=s,this.blockSize=s.blockSize/8,this.outSize=s.outSize/8,this.inner=null,this.outer=null,this._init(e.toArray(a,o))}return k1=r,r.prototype._init=function(a){a.length>this.blockSize&&(a=new this.Hash().update(a).digest()),t(a.length<=this.blockSize);for(var o=a.length;o<this.blockSize;o++)a.push(0);for(o=0;o<a.length;o++)a[o]^=54;for(this.inner=new this.Hash().update(a),o=0;o<a.length;o++)a[o]^=106;this.outer=new this.Hash().update(a)},r.prototype.update=function(a,o){return this.inner.update(a,o),this},r.prototype.digest=function(a){return this.outer.update(this.inner.digest()),this.outer.digest(a)},k1}var ON;function E9(){return ON||(ON=1,(function(e){var t=e;t.utils=Bn(),t.common=Zd(),t.sha=S9(),t.ripemd=k9(),t.hmac=N9(),t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160})(p1)),p1}var j9=E9();const T9=Zy(j9);let A9="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",C9=(e,t=21)=>(r=t)=>{let s="",a=r|0;for(;a--;)s+=e[Math.random()*e.length|0];return s},R9=(e=21)=>{let t="",r=e|0;for(;r--;)t+=A9[Math.random()*64|0];return t};const kr=e=>Math.floor(e*72*20),K0=(e=0)=>{let t=e;return()=>++t},D9=()=>K0(),O9=()=>K0(1),F9=()=>K0(),L9=()=>K0(),I9=()=>R9().toLowerCase(),FN=e=>T9.sha1().update(e instanceof ArrayBuffer?new Uint8Array(e):e).digest("hex"),Hu=e=>C9("1234567890abcdef",e)(),M9=()=>`${Hu(8)}-${Hu(4)}-${Hu(4)}-${Hu(4)}-${Hu(12)}`,P9={PAGE:"page"},B9={PAGE:"page"},U9=()=>new Cr({name:"wp:simplePos",attributes:{x:{key:"x",value:0},y:{key:"y",value:0}}}),J4=e=>new Cr({name:"wp:align",children:[e]}),Z4=e=>new Cr({name:"wp:posOffset",children:[e.toString()]}),z9=({relative:e,align:t,offset:r})=>new Cr({name:"wp:positionH",attributes:{relativeFrom:{key:"relativeFrom",value:e??P9.PAGE}},children:[(()=>{if(t)return J4(t);if(r!==void 0)return Z4(r);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]}),q9=({relative:e,align:t,offset:r})=>new Cr({name:"wp:positionV",attributes:{relativeFrom:{key:"relativeFrom",value:e??B9.PAGE}},children:[(()=>{if(t)return J4(t);if(r!==void 0)return Z4(r);throw new Error("There is no configuration provided for floating position (Align or offset)")})()]});class $9 extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{uri:"uri"})}}const H9=e=>new Cr({name:"asvg:svgBlip",attributes:{asvg:{key:"xmlns:asvg",value:"http://schemas.microsoft.com/office/drawing/2016/SVG/main"},embed:{key:"r:embed",value:`rId{${e.fileName}}`}}}),W9=e=>new Cr({name:"a:ext",attributes:{uri:{key:"uri",value:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"}},children:[H9(e)]}),G9=e=>new Cr({name:"a:extLst",children:[W9(e)]}),V9=e=>new Cr({name:"a:blip",attributes:{embed:{key:"r:embed",value:`rId{${e.type==="svg"?e.fallback.fileName:e.fileName}}`},cstate:{key:"cstate",value:"none"}},children:e.type==="svg"?[G9(e)]:[]});class K9 extends tt{constructor(){super("a:srcRect")}}class X9 extends tt{constructor(){super("a:fillRect")}}class Y9 extends tt{constructor(){super("a:stretch"),this.root.push(new X9)}}class J9 extends tt{constructor(t){super("pic:blipFill"),this.root.push(V9(t)),this.root.push(new K9),this.root.push(new Y9)}}class Z9 extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{noChangeAspect:"noChangeAspect",noChangeArrowheads:"noChangeArrowheads"})}}class Q9 extends tt{constructor(){super("a:picLocks"),this.root.push(new Z9({noChangeAspect:1,noChangeArrowheads:1}))}}class eI extends tt{constructor(){super("pic:cNvPicPr"),this.root.push(new Q9)}}const Q4=(e,t)=>new Cr({name:"a:hlinkClick",attributes:yi(ar({},t?{xmlns:{key:"xmlns:a",value:"http://schemas.openxmlformats.org/drawingml/2006/main"}}:{}),{id:{key:"r:id",value:`rId${e}`}})});class tI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{id:"id",name:"name",descr:"descr"})}}class rI extends tt{constructor(){super("pic:cNvPr"),this.root.push(new tI({id:0,name:"",descr:""}))}prepForXml(t){for(let r=t.stack.length-1;r>=0;r--){const s=t.stack[r];if(s instanceof dv){this.root.push(Q4(s.linkId,!1));break}}return super.prepForXml(t)}}class sI extends tt{constructor(){super("pic:nvPicPr"),this.root.push(new rI),this.root.push(new eI)}}class aI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{xmlns:"xmlns:pic"})}}class nI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{cx:"cx",cy:"cy"})}}class iI extends tt{constructor(t,r){super("a:ext"),Qe(this,"attributes"),this.attributes=new nI({cx:t,cy:r}),this.root.push(this.attributes)}}class oI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{x:"x",y:"y"})}}class lI extends tt{constructor(){super("a:off"),this.root.push(new oI({x:0,y:0}))}}class cI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{flipVertical:"flipV",flipHorizontal:"flipH",rotation:"rot"})}}class uI extends tt{constructor(t){var r,s;super("a:xfrm"),Qe(this,"extents"),this.root.push(new cI({flipVertical:(r=t.flip)==null?void 0:r.vertical,flipHorizontal:(s=t.flip)==null?void 0:s.horizontal,rotation:t.rotation})),this.extents=new iI(t.emus.x,t.emus.y),this.root.push(new lI),this.root.push(this.extents)}}const eT=()=>new Cr({name:"a:noFill"}),dI=e=>new Cr({name:"a:srgbClr",attributes:{value:{key:"val",value:e.value}}}),fI=e=>new Cr({name:"a:schemeClr",attributes:{value:{key:"val",value:e.value}}}),LN=e=>new Cr({name:"a:solidFill",children:[e.type==="rgb"?dI(e):fI(e)]}),hI=e=>new Cr({name:"a:ln",attributes:{width:{key:"w",value:e.width},cap:{key:"cap",value:e.cap},compoundLine:{key:"cmpd",value:e.compoundLine},align:{key:"algn",value:e.align}},children:[e.type==="noFill"?eT():e.solidFillType==="rgb"?LN({type:"rgb",value:e.value}):LN({type:"scheme",value:e.value})]});class mI extends tt{constructor(){super("a:avLst")}}class pI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{prst:"prst"})}}class xI extends tt{constructor(){super("a:prstGeom"),this.root.push(new pI({prst:"rect"})),this.root.push(new mI)}}class gI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{bwMode:"bwMode"})}}class yI extends tt{constructor({outline:t,transform:r}){super("pic:spPr"),Qe(this,"form"),this.root.push(new gI({bwMode:"auto"})),this.form=new uI(r),this.root.push(this.form),this.root.push(new xI),t&&(this.root.push(eT()),this.root.push(hI(t)))}}class vI extends tt{constructor({mediaData:t,transform:r,outline:s}){super("pic:pic"),this.root.push(new aI({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.root.push(new sI),this.root.push(new J9(t)),this.root.push(new yI({transform:r,outline:s}))}}class wI extends tt{constructor({mediaData:t,transform:r,outline:s}){super("a:graphicData"),Qe(this,"pic"),this.root.push(new $9({uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.pic=new vI({mediaData:t,transform:r,outline:s}),this.root.push(this.pic)}}class bI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{a:"xmlns:a"})}}class tT extends tt{constructor({mediaData:t,transform:r,outline:s}){super("a:graphic"),Qe(this,"data"),this.root.push(new bI({a:"http://schemas.openxmlformats.org/drawingml/2006/main"})),this.data=new wI({mediaData:t,transform:r,outline:s}),this.root.push(this.data)}}const Lh={NONE:0,SQUARE:1,TIGHT:2,TOP_AND_BOTTOM:3},_I={BOTH_SIDES:"bothSides"};class IN extends tt{constructor(){super("wp:wrapNone")}}class SI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",wrapText:"wrapText"})}}class kI extends tt{constructor(t,r={top:0,bottom:0,left:0,right:0}){super("wp:wrapSquare"),this.root.push(new SI({wrapText:t.side||_I.BOTH_SIDES,distT:r.top,distB:r.bottom,distL:r.left,distR:r.right}))}}class NI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{distT:"distT",distB:"distB"})}}class EI extends tt{constructor(t={top:0,bottom:0}){super("wp:wrapTight"),this.root.push(new NI({distT:t.top,distB:t.bottom}))}}class jI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{distT:"distT",distB:"distB"})}}class TI extends tt{constructor(t={top:0,bottom:0}){super("wp:wrapTopAndBottom"),this.root.push(new jI({distT:t.top,distB:t.bottom}))}}class rT extends tt{constructor({name:t,description:r,title:s}={name:"",description:"",title:""}){super("wp:docPr"),Qe(this,"docPropertiesUniqueNumericId",F9());const a={id:{key:"id",value:this.docPropertiesUniqueNumericId()},name:{key:"name",value:t}};r!=null&&(a.description={key:"descr",value:r}),s!=null&&(a.title={key:"title",value:s}),this.root.push(new Si(a))}prepForXml(t){for(let r=t.stack.length-1;r>=0;r--){const s=t.stack[r];if(s instanceof dv){this.root.push(Q4(s.linkId,!0));break}}return super.prepForXml(t)}}const sT=({top:e,right:t,bottom:r,left:s})=>new Cr({name:"wp:effectExtent",attributes:{top:{key:"t",value:e},right:{key:"r",value:t},bottom:{key:"b",value:r},left:{key:"l",value:s}}}),aT=({x:e,y:t})=>new Cr({name:"wp:extent",attributes:{x:{key:"cx",value:e},y:{key:"cy",value:t}}});class AI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{xmlns:"xmlns:a",noChangeAspect:"noChangeAspect"})}}class CI extends tt{constructor(){super("a:graphicFrameLocks"),this.root.push(new AI({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:1}))}}const nT=()=>new Cr({name:"wp:cNvGraphicFramePr",children:[new CI]});class RI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",allowOverlap:"allowOverlap",behindDoc:"behindDoc",layoutInCell:"layoutInCell",locked:"locked",relativeHeight:"relativeHeight",simplePos:"simplePos"})}}class DI extends tt{constructor({mediaData:t,transform:r,drawingOptions:s}){super("wp:anchor");const a=ar({allowOverlap:!0,behindDocument:!1,lockAnchor:!1,layoutInCell:!0,verticalPosition:{},horizontalPosition:{}},s.floating);if(this.root.push(new RI({distT:a.margins&&a.margins.top||0,distB:a.margins&&a.margins.bottom||0,distL:a.margins&&a.margins.left||0,distR:a.margins&&a.margins.right||0,simplePos:"0",allowOverlap:a.allowOverlap===!0?"1":"0",behindDoc:a.behindDocument===!0?"1":"0",locked:a.lockAnchor===!0?"1":"0",layoutInCell:a.layoutInCell===!0?"1":"0",relativeHeight:a.zIndex?a.zIndex:r.emus.y})),this.root.push(U9()),this.root.push(z9(a.horizontalPosition)),this.root.push(q9(a.verticalPosition)),this.root.push(aT({x:r.emus.x,y:r.emus.y})),this.root.push(sT({top:0,right:0,bottom:0,left:0})),s.floating!==void 0&&s.floating.wrap!==void 0)switch(s.floating.wrap.type){case Lh.SQUARE:this.root.push(new kI(s.floating.wrap,s.floating.margins));break;case Lh.TIGHT:this.root.push(new EI(s.floating.margins));break;case Lh.TOP_AND_BOTTOM:this.root.push(new TI(s.floating.margins));break;case Lh.NONE:default:this.root.push(new IN)}else this.root.push(new IN);this.root.push(new rT(s.docProperties)),this.root.push(nT()),this.root.push(new tT({mediaData:t,transform:r,outline:s.outline}))}}const OI=({mediaData:e,transform:t,docProperties:r,outline:s})=>{var a,o,c,u;return new Cr({name:"wp:inline",attributes:{distanceTop:{key:"distT",value:0},distanceBottom:{key:"distB",value:0},distanceLeft:{key:"distL",value:0},distanceRight:{key:"distR",value:0}},children:[aT({x:t.emus.x,y:t.emus.y}),sT(s?{top:((a=s.width)!=null?a:9525)*2,right:((o=s.width)!=null?o:9525)*2,bottom:((c=s.width)!=null?c:9525)*2,left:((u=s.width)!=null?u:9525)*2}:{top:0,right:0,bottom:0,left:0}),new rT(r),nT(),new tT({mediaData:e,transform:t,outline:s})]})};class FI extends tt{constructor(t,r={}){super("w:drawing"),r.floating?this.root.push(new DI({mediaData:t,transform:t.transformation,drawingOptions:r})):this.root.push(OI({mediaData:t,transform:t.transformation,docProperties:r.docProperties,outline:r.outline}))}}const LI=e=>{if(typeof atob=="function"){const t=";base64,",r=e.indexOf(t),s=r===-1?0:r+t.length;return new Uint8Array(atob(e.substring(s)).split("").map(a=>a.charCodeAt(0)))}else{const t=require("buffer");return new t.Buffer(e,"base64")}},II=e=>typeof e=="string"?LI(e):e,N1=(e,t)=>({data:II(e.data),fileName:t,transformation:{pixels:{x:Math.round(e.transformation.width),y:Math.round(e.transformation.height)},emus:{x:Math.round(e.transformation.width*9525),y:Math.round(e.transformation.height*9525)},flip:e.transformation.flip,rotation:e.transformation.rotation?e.transformation.rotation*6e4:void 0}});class MN extends Yd{constructor(t){super({}),Qe(this,"imageData");const s=`${FN(t.data)}.${t.type}`;this.imageData=t.type==="svg"?yi(ar({type:t.type},N1(t,s)),{fallback:ar({type:t.fallback.type},N1(yi(ar({},t.fallback),{transformation:t.transformation}),`${FN(t.fallback.data)}.${t.fallback.type}`))}):ar({type:t.type},N1(t,s));const a=new FI(this.imageData,{floating:t.floating,docProperties:t.altText,outline:t.outline});this.root.push(a)}prepForXml(t){return t.file.Media.addImage(this.imageData.fileName,this.imageData),this.imageData.type==="svg"&&t.file.Media.addImage(this.imageData.fallback.fileName,this.imageData.fallback),super.prepForXml(t)}}class MI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{xmlns:"xmlns"})}}class PI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}}const BI={EXTERNAL:"External"};class UI extends tt{constructor(t,r,s,a){super("Relationship"),this.root.push(new PI({id:t,type:r,target:s,targetMode:a}))}}class xl extends tt{constructor(){super("Relationships"),this.root.push(new MI({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(t,r,s,a){const o=new UI(`rId${t}`,r,s,a);return this.root.push(o),o}get RelationshipCount(){return this.root.length-1}}class zI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}}class qI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}}class $I extends tt{constructor({id:t,initials:r,author:s,date:a=new Date,children:o}){super("w:comment"),this.root.push(new zI({id:t,initials:r,author:s,date:a.toISOString()}));for(const c of o)this.root.push(c)}}class HI extends tt{constructor({children:t}){super("w:comments"),Qe(this,"relationships"),this.root.push(new qI({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(const r of t)this.root.push(new $I(r));this.relationships=new xl}get Relationships(){return this.relationships}}class WI extends tt{constructor(){super("w:pageBreakBefore")}}const yy={AUTO:"auto"};class GI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule",beforeAutoSpacing:"w:beforeAutospacing",afterAutoSpacing:"w:afterAutospacing"})}}class VI extends tt{constructor(t){super("w:spacing"),this.root.push(new GI(t))}}let Ih=class extends tt{constructor(t){super("w:pStyle"),this.root.push(new ls({val:t}))}};class KI extends tt{constructor(t){super("w:tabs");for(const r of t)this.root.push(new YI(r))}}const PN={LEFT:"left",RIGHT:"right"};class XI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}}class YI extends tt{constructor({type:t,position:r,leader:s}){super("w:tab"),this.root.push(new XI({val:t,pos:r,leader:s}))}}class E1 extends tt{constructor(t,r){super("w:numPr"),this.root.push(new JI(r)),this.root.push(new ZI(t))}}class JI extends tt{constructor(t){if(super("w:ilvl"),t>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new ls({val:t}))}}class ZI extends tt{constructor(t){super("w:numId"),this.root.push(new ls({val:typeof t=="string"?`{${t}}`:t}))}}class iT extends tt{constructor(){super(...arguments),Qe(this,"fileChild",Symbol())}}class QI extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}}class dv extends tt{constructor(t,r,s){super("w:hyperlink"),Qe(this,"linkId"),this.linkId=r;const a={history:1,anchor:s||void 0,id:s?void 0:`rId${this.linkId}`},o=new QI(a);this.root.push(o),t.forEach(c=>{this.root.push(c)})}}class eM extends tt{constructor(t){super("w:externalHyperlink"),this.options=t}}class tM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{id:"w:id",name:"w:name"})}}class rM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{id:"w:id"})}}class sM{constructor(t){Qe(this,"bookmarkUniqueNumericId",L9()),Qe(this,"start"),Qe(this,"children"),Qe(this,"end");const r=this.bookmarkUniqueNumericId();this.start=new aM(t.id,r),this.children=t.children,this.end=new nM(r)}}class aM extends tt{constructor(t,r){super("w:bookmarkStart");const s=new tM({name:t,id:r});this.root.push(s)}}class nM extends tt{constructor(t){super("w:bookmarkEnd");const r=new rM({id:t});this.root.push(r)}}class iM extends tt{constructor(t){super("w:outlineLvl"),this.level=t,this.root.push(new ls({val:t}))}}const oM={TOP:"top",CENTER:"center",BOTTOM:"bottom"};yi(ar({},oM),{BOTH:"both"});class lM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{verticalAlign:"w:val"})}}class oT extends tt{constructor(t){super("w:vAlign"),this.root.push(new lM({verticalAlign:t}))}}class cM extends tt{constructor({space:t,count:r,separate:s,equalWidth:a,children:o}){super("w:cols"),this.root.push(new Si({space:{key:"w:space",value:t===void 0?void 0:Ks(t)},count:{key:"w:num",value:r===void 0?void 0:oa(r)},separate:{key:"w:sep",value:s},equalWidth:{key:"w:equalWidth",value:a}})),!a&&o&&o.forEach(c=>this.addChildElement(c))}}const uM=({type:e,linePitch:t,charSpace:r})=>new Cr({name:"w:docGrid",attributes:{type:{key:"w:type",value:e},linePitch:{key:"w:linePitch",value:oa(t)},charSpace:{key:"w:charSpace",value:r?oa(r):void 0}}}),Nc={DEFAULT:"default",FIRST:"first",EVEN:"even"};class dM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{type:"w:type",id:"r:id"})}}const BN={HEADER:"w:headerReference",FOOTER:"w:footerReference"};class j1 extends tt{constructor(t,r){super(t),this.root.push(new dM({type:r.type||Nc.DEFAULT,id:`rId${r.id}`}))}}const fM=({countBy:e,start:t,restart:r,distance:s})=>new Cr({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:e===void 0?void 0:oa(e)},start:{key:"w:start",value:t===void 0?void 0:oa(t)},restart:{key:"w:restart",value:r},distance:{key:"w:distance",value:s===void 0?void 0:Ks(s)}}});class UN extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}}class hM extends _i{constructor(t){if(super("w:pgBorders"),!t)return this;t.pageBorders?this.root.push(new UN({display:t.pageBorders.display,offsetFrom:t.pageBorders.offsetFrom,zOrder:t.pageBorders.zOrder})):this.root.push(new UN({})),t.pageBorderTop&&this.root.push(new Mr("w:top",t.pageBorderTop)),t.pageBorderLeft&&this.root.push(new Mr("w:left",t.pageBorderLeft)),t.pageBorderBottom&&this.root.push(new Mr("w:bottom",t.pageBorderBottom)),t.pageBorderRight&&this.root.push(new Mr("w:right",t.pageBorderRight))}}class mM extends tt{constructor(t,r,s,a,o,c,u){super("w:pgMar"),this.root.push(new Si({top:{key:"w:top",value:di(t)},right:{key:"w:right",value:Ks(r)},bottom:{key:"w:bottom",value:di(s)},left:{key:"w:left",value:Ks(a)},header:{key:"w:header",value:Ks(o)},footer:{key:"w:footer",value:Ks(c)},gutter:{key:"w:gutter",value:Ks(u)}}))}}class pM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}}class xM extends tt{constructor({start:t,formatType:r,separator:s}){super("w:pgNumType"),this.root.push(new pM({start:t===void 0?void 0:oa(t),formatType:r,separator:s}))}}const vy={PORTRAIT:"portrait",LANDSCAPE:"landscape"},gM=({width:e,height:t,orientation:r,code:s})=>{const a=Ks(e),o=Ks(t);return new Cr({name:"w:pgSz",attributes:{width:{key:"w:w",value:r===vy.LANDSCAPE?o:a},height:{key:"w:h",value:r===vy.LANDSCAPE?a:o},orientation:{key:"w:orient",value:r},code:{key:"w:code",value:s}}})};class yM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{val:"w:val"})}}class vM extends tt{constructor(t){super("w:textDirection"),this.root.push(new yM({val:t}))}}class wM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{val:"w:val"})}}class bM extends tt{constructor(t){super("w:type"),this.root.push(new wM({val:t}))}}const Bo={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},T1={WIDTH:11906,HEIGHT:16838,ORIENTATION:vy.PORTRAIT};class _M extends tt{constructor({page:{size:{width:t=T1.WIDTH,height:r=T1.HEIGHT,orientation:s=T1.ORIENTATION}={},margin:{top:a=Bo.TOP,right:o=Bo.RIGHT,bottom:c=Bo.BOTTOM,left:u=Bo.LEFT,header:d=Bo.HEADER,footer:h=Bo.FOOTER,gutter:m=Bo.GUTTER}={},pageNumbers:x={},borders:y,textDirection:v}={},grid:{linePitch:w=360,charSpace:g,type:_}={},headerWrapperGroup:b={},footerWrapperGroup:N={},lineNumbers:S,titlePage:E,verticalAlign:R,column:L,type:O}={}){super("w:sectPr"),this.addHeaderFooterGroup(BN.HEADER,b),this.addHeaderFooterGroup(BN.FOOTER,N),O&&this.root.push(new bM(O)),this.root.push(gM({width:t,height:r,orientation:s})),this.root.push(new mM(a,o,c,u,d,h,m)),y&&this.root.push(new hM(y)),S&&this.root.push(fM(S)),this.root.push(new xM(x)),L&&this.root.push(new cM(L)),R&&this.root.push(new oT(R)),E!==void 0&&this.root.push(new xt("w:titlePg",E)),v&&this.root.push(new vM(v)),this.root.push(uM({linePitch:w,charSpace:g,type:_}))}addHeaderFooterGroup(t,r){r.default&&this.root.push(new j1(t,{type:Nc.DEFAULT,id:r.default.View.ReferenceId})),r.first&&this.root.push(new j1(t,{type:Nc.FIRST,id:r.first.View.ReferenceId})),r.even&&this.root.push(new j1(t,{type:Nc.EVEN,id:r.even.View.ReferenceId}))}}class SM extends tt{constructor(){super("w:body"),Qe(this,"sections",[])}addSection(t){const r=this.sections.pop();this.root.push(this.createSectionParagraph(r)),this.sections.push(new _M(t))}prepForXml(t){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(t)}push(t){this.root.push(t)}createSectionParagraph(t){const r=new lt({}),s=new Pc({});return s.push(t),r.addChildElement(s),r}}const zN={wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"};class X0 extends Ct{constructor(t,r){super(ar({Ignorable:r},Object.fromEntries(t.map(s=>[s,zN[s]])))),Qe(this,"xmlKeys",ar({Ignorable:"mc:Ignorable"},Object.fromEntries(Object.keys(zN).map(s=>[s,`xmlns:${s}`]))))}}class kM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}}class NM extends tt{constructor(t){super("w:background"),this.root.push(new kM({color:t.color===void 0?void 0:Lc(t.color),themeColor:t.themeColor,themeShade:t.themeShade===void 0?void 0:yN(t.themeShade),themeTint:t.themeTint===void 0?void 0:yN(t.themeTint)}))}}class EM extends tt{constructor(t){super("w:document"),Qe(this,"body"),this.root.push(new X0(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps","cx","cx1","cx2","cx3","cx4","cx5","cx6","cx7","cx8","aink","am3d","w16cex","w16cid","w16","w16sdtdh","w16se"],"w14 w15 wp14")),this.body=new SM,t.background&&this.root.push(new NM(t.background)),this.root.push(this.body)}add(t){return this.body.push(t),this}get Body(){return this.body}}class lT{constructor(t){Qe(this,"document"),Qe(this,"relationships"),this.document=new EM(t),this.relationships=new xl}get View(){return this.document}get Relationships(){return this.relationships}}class jM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{val:"w:val"})}}class TM extends tt{constructor(){super("w:wordWrap"),this.root.push(new jM({val:0}))}}const AM=e=>{var t,r;return new Cr({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:e.anchorLock},dropCap:{key:"w:dropCap",value:e.dropCap},width:{key:"w:w",value:e.width},height:{key:"w:h",value:e.height},x:{key:"w:x",value:e.position?e.position.x:void 0},y:{key:"w:y",value:e.position?e.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:e.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:e.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(t=e.space)==null?void 0:t.horizontal},spaceVertical:{key:"w:vSpace",value:(r=e.space)==null?void 0:r.vertical},rule:{key:"w:hRule",value:e.rule},alignmentX:{key:"w:xAlign",value:e.alignment?e.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:e.alignment?e.alignment.y:void 0},lines:{key:"w:lines",value:e.lines},wrap:{key:"w:wrap",value:e.wrap}}})};class Pc extends _i{constructor(t){var r,s;if(super("w:pPr"),Qe(this,"numberingReferences",[]),!t)return this;t.heading&&this.push(new Ih(t.heading)),t.bullet&&this.push(new Ih("ListParagraph")),t.numbering&&!t.style&&!t.heading&&(t.numbering.custom||this.push(new Ih("ListParagraph"))),t.style&&this.push(new Ih(t.style)),t.keepNext!==void 0&&this.push(new xt("w:keepNext",t.keepNext)),t.keepLines!==void 0&&this.push(new xt("w:keepLines",t.keepLines)),t.pageBreakBefore&&this.push(new WI),t.frame&&this.push(AM(t.frame)),t.widowControl!==void 0&&this.push(new xt("w:widowControl",t.widowControl)),t.bullet&&this.push(new E1(1,t.bullet.level)),t.numbering?(this.numberingReferences.push({reference:t.numbering.reference,instance:(r=t.numbering.instance)!=null?r:0}),this.push(new E1(`${t.numbering.reference}-${(s=t.numbering.instance)!=null?s:0}`,t.numbering.level))):t.numbering===!1&&this.push(new E1(0,0)),t.border&&this.push(new Z7(t.border)),t.thematicBreak&&this.push(new Q7),t.shading&&this.push(new V0(t.shading)),t.wordWrap&&this.push(new TM),t.overflowPunctuation&&this.push(new xt("w:overflowPunct",t.overflowPunctuation));const a=[...t.rightTabStop!==void 0?[{type:PN.RIGHT,position:t.rightTabStop}]:[],...t.tabStops?t.tabStops:[],...t.leftTabStop!==void 0?[{type:PN.LEFT,position:t.leftTabStop}]:[]];a.length>0&&this.push(new KI(a)),t.bidirectional!==void 0&&this.push(new xt("w:bidi",t.bidirectional)),t.spacing&&this.push(new VI(t.spacing)),t.indent&&this.push(new e9(t.indent)),t.contextualSpacing!==void 0&&this.push(new xt("w:contextualSpacing",t.contextualSpacing)),t.alignment&&this.push(new W4(t.alignment)),t.outlineLevel!==void 0&&this.push(new iM(t.outlineLevel)),t.suppressLineNumbers!==void 0&&this.push(new xt("w:suppressLineNumbers",t.suppressLineNumbers)),t.autoSpaceEastAsianText!==void 0&&this.push(new xt("w:autoSpaceDN",t.autoSpaceEastAsianText)),t.run&&this.push(new pl(t.run))}push(t){this.root.push(t)}prepForXml(t){if(t.viewWrapper instanceof lT)for(const r of this.numberingReferences)t.file.Numbering.createConcreteNumberingInstance(r.reference,r.instance);return super.prepForXml(t)}}class lt extends iT{constructor(t){if(super("w:p"),Qe(this,"properties"),typeof t=="string")return this.properties=new Pc({}),this.root.push(this.properties),this.root.push(new Rt(t)),this;if(this.properties=new Pc(t),this.root.push(this.properties),t.text&&this.root.push(new Rt(t.text)),t.children)for(const r of t.children){if(r instanceof sM){this.root.push(r.start);for(const s of r.children)this.root.push(s);this.root.push(r.end);continue}this.root.push(r)}}prepForXml(t){for(const r of this.root)if(r instanceof eM){const s=this.root.indexOf(r),a=new dv(r.options.children,I9());t.viewWrapper.Relationships.createRelationship(a.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",r.options.link,BI.EXTERNAL),this.root[s]=a}return super.prepForXml(t)}addRunToFront(t){return this.root.splice(1,0,t),this}}class CM extends tt{constructor(t){super("w:tblGrid");for(const r of t)this.root.push(new RM(r))}}class RM extends tt{constructor(t){super("w:gridCol"),t!==void 0&&this.root.push(new Si({width:{key:"w:w",value:Ks(t)}}))}}const cT={TABLE:"w:tblCellMar",TABLE_CELL:"w:tcMar"};class uT extends _i{constructor(t,{marginUnitType:r=Ut.DXA,top:s,left:a,bottom:o,right:c}){super(t),s!==void 0&&this.root.push(new Xo("w:top",{type:r,size:s})),a!==void 0&&this.root.push(new Xo("w:left",{type:r,size:a})),o!==void 0&&this.root.push(new Xo("w:bottom",{type:r,size:o})),c!==void 0&&this.root.push(new Xo("w:right",{type:r,size:c}))}}const Ut={AUTO:"auto",DXA:"dxa",PERCENTAGE:"pct"};class Xo extends tt{constructor(t,{type:r=Ut.AUTO,size:s}){super(t);let a=s;r===Ut.PERCENTAGE&&typeof s=="number"&&(a=`${s}%`),this.root.push(new Si({type:{key:"w:type",value:r},size:{key:"w:w",value:H4(a)}}))}}class DM extends _i{constructor(t){super("w:tcBorders"),t.top&&this.root.push(new Mr("w:top",t.top)),t.start&&this.root.push(new Mr("w:start",t.start)),t.left&&this.root.push(new Mr("w:left",t.left)),t.bottom&&this.root.push(new Mr("w:bottom",t.bottom)),t.end&&this.root.push(new Mr("w:end",t.end)),t.right&&this.root.push(new Mr("w:right",t.right))}}class OM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{val:"w:val"})}}class FM extends tt{constructor(t){super("w:gridSpan"),this.root.push(new OM({val:oa(t)}))}}const dT={CONTINUE:"continue",RESTART:"restart"};class LM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{val:"w:val"})}}class qN extends tt{constructor(t){super("w:vMerge"),this.root.push(new LM({val:t}))}}class IM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{val:"w:val"})}}class MM extends tt{constructor(t){super("w:textDirection"),this.root.push(new IM({val:t}))}}class PM extends _i{constructor(t){super("w:tcPr"),t.width&&this.root.push(new Xo("w:tcW",t.width)),t.columnSpan&&this.root.push(new FM(t.columnSpan)),t.verticalMerge?this.root.push(new qN(t.verticalMerge)):t.rowSpan&&t.rowSpan>1&&this.root.push(new qN(dT.RESTART)),t.borders&&this.root.push(new DM(t.borders)),t.shading&&this.root.push(new V0(t.shading)),t.margins&&this.root.push(new uT(cT.TABLE_CELL,t.margins)),t.textDirection&&this.root.push(new MM(t.textDirection)),t.verticalAlign&&this.root.push(new oT(t.verticalAlign))}}class yt extends tt{constructor(t){super("w:tc"),this.options=t,this.root.push(new PM(t));for(const r of t.children)this.root.push(r)}prepForXml(t){return this.root[this.root.length-1]instanceof lt||this.root.push(new lt({})),super.prepForXml(t)}}const lc={style:or.NONE,size:0,color:"auto"},cc={style:or.SINGLE,size:4,color:"auto"};class fT extends tt{constructor(t){super("w:tblBorders"),t.top?this.root.push(new Mr("w:top",t.top)):this.root.push(new Mr("w:top",cc)),t.left?this.root.push(new Mr("w:left",t.left)):this.root.push(new Mr("w:left",cc)),t.bottom?this.root.push(new Mr("w:bottom",t.bottom)):this.root.push(new Mr("w:bottom",cc)),t.right?this.root.push(new Mr("w:right",t.right)):this.root.push(new Mr("w:right",cc)),t.insideHorizontal?this.root.push(new Mr("w:insideH",t.insideHorizontal)):this.root.push(new Mr("w:insideH",cc)),t.insideVertical?this.root.push(new Mr("w:insideV",t.insideVertical)):this.root.push(new Mr("w:insideV",cc))}}Qe(fT,"NONE",{top:lc,bottom:lc,left:lc,right:lc,insideHorizontal:lc,insideVertical:lc});class BM extends tt{constructor({horizontalAnchor:t,verticalAnchor:r,absoluteHorizontalPosition:s,relativeHorizontalPosition:a,absoluteVerticalPosition:o,relativeVerticalPosition:c,bottomFromText:u,topFromText:d,leftFromText:h,rightFromText:m,overlap:x}){super("w:tblpPr"),this.root.push(new Si({leftFromText:{key:"w:leftFromText",value:h===void 0?void 0:Ks(h)},rightFromText:{key:"w:rightFromText",value:m===void 0?void 0:Ks(m)},topFromText:{key:"w:topFromText",value:d===void 0?void 0:Ks(d)},bottomFromText:{key:"w:bottomFromText",value:u===void 0?void 0:Ks(u)},absoluteHorizontalPosition:{key:"w:tblpX",value:s===void 0?void 0:di(s)},absoluteVerticalPosition:{key:"w:tblpY",value:o===void 0?void 0:di(o)},horizontalAnchor:{key:"w:horzAnchor",value:t===void 0?void 0:t},relativeHorizontalPosition:{key:"w:tblpXSpec",value:a},relativeVerticalPosition:{key:"w:tblpYSpec",value:c},verticalAnchor:{key:"w:vertAnchor",value:r}})),x&&this.root.push(new X7("w:tblOverlap",x))}}class UM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{type:"w:type"})}}class zM extends tt{constructor(t){super("w:tblLayout"),this.root.push(new UM({type:t}))}}const qM={DXA:"dxa"};class hT extends tt{constructor({type:t=qM.DXA,value:r}){super("w:tblCellSpacing"),this.root.push(new Si({type:{key:"w:type",value:t},value:{key:"w:w",value:H4(r)}}))}}class $M extends _i{constructor(t){super("w:tblPr"),t.style&&this.root.push(new Jo("w:tblStyle",t.style)),t.float&&this.root.push(new BM(t.float)),t.visuallyRightToLeft!==void 0&&this.root.push(new xt("w:bidiVisual",t.visuallyRightToLeft)),t.width&&this.root.push(new Xo("w:tblW",t.width)),t.alignment&&this.root.push(new W4(t.alignment)),t.indent&&this.root.push(new Xo("w:tblInd",t.indent)),t.borders&&this.root.push(new fT(t.borders)),t.shading&&this.root.push(new V0(t.shading)),t.layout&&this.root.push(new zM(t.layout)),t.cellMargin&&this.root.push(new uT(cT.TABLE,t.cellMargin)),t.cellSpacing&&this.root.push(new hT(t.cellSpacing))}}class Sa extends iT{constructor({rows:t,width:r,columnWidths:s=Array(Math.max(...t.map(v=>v.CellCount))).fill(100),margins:a,indent:o,float:c,layout:u,style:d,borders:h,alignment:m,visuallyRightToLeft:x,cellSpacing:y}){super("w:tbl"),this.root.push(new $M({borders:h??{},width:r??{size:100},indent:o,float:c,layout:u,style:d,alignment:m,cellMargin:a,visuallyRightToLeft:x,cellSpacing:y})),this.root.push(new CM(s));for(const v of t)this.root.push(v);t.forEach((v,w)=>{if(w===t.length-1)return;let g=0;v.cells.forEach(_=>{if(_.options.rowSpan&&_.options.rowSpan>1){const b=new yt({rowSpan:_.options.rowSpan-1,columnSpan:_.options.columnSpan,borders:_.options.borders,children:[],verticalMerge:dT.CONTINUE});t[w+1].addCellToColumnIndex(b,g)}g+=_.options.columnSpan||1})})}}class HM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{value:"w:val",rule:"w:hRule"})}}class WM extends tt{constructor(t,r){super("w:trHeight"),this.root.push(new HM({value:Ks(t),rule:r}))}}class GM extends _i{constructor(t){super("w:trPr"),t.cantSplit!==void 0&&this.root.push(new xt("w:cantSplit",t.cantSplit)),t.tableHeader!==void 0&&this.root.push(new xt("w:tblHeader",t.tableHeader)),t.height&&this.root.push(new WM(t.height.value,t.height.rule)),t.cellSpacing&&this.root.push(new hT(t.cellSpacing))}}class xr extends tt{constructor(t){super("w:tr"),this.options=t,this.root.push(new GM(t));for(const r of t.children)this.root.push(r)}get CellCount(){return this.options.children.length}get cells(){return this.root.filter(t=>t instanceof yt)}addCellToIndex(t,r){this.root.splice(r+1,0,t)}addCellToColumnIndex(t,r){const s=this.columnIndexToRootIndex(r,!0);this.addCellToIndex(t,s-1)}rootIndexToColumnIndex(t){if(t<1||t>=this.root.length)throw new Error(`cell 'rootIndex' should between 1 to ${this.root.length-1}`);let r=0;for(let s=1;s<t;s++){const a=this.root[s];r+=a.options.columnSpan||1}return r}columnIndexToRootIndex(t,r=!1){if(t<0)throw new Error("cell 'columnIndex' should not less than zero");let s=0,a=1;for(;s<=t;){if(a>=this.root.length){if(r)return this.root.length;throw new Error(`cell 'columnIndex' should not great than ${s-1}`)}const o=this.root[a];a+=1,s+=o&&o.options.columnSpan||1}return a-1}}class VM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class KM extends tt{constructor(){super("Properties"),this.root.push(new VM({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class XM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{xmlns:"xmlns"})}}class YM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}}class ii extends tt{constructor(t,r){super("Default"),this.root.push(new YM({contentType:t,extension:r}))}}class JM extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}}class rn extends tt{constructor(t,r){super("Override"),this.root.push(new JM({contentType:t,partName:r}))}}class ZM extends tt{constructor(){super("Types"),this.root.push(new XM({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new ii("image/png","png")),this.root.push(new ii("image/jpeg","jpeg")),this.root.push(new ii("image/jpeg","jpg")),this.root.push(new ii("image/bmp","bmp")),this.root.push(new ii("image/gif","gif")),this.root.push(new ii("image/svg+xml","svg")),this.root.push(new ii("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new ii("application/xml","xml")),this.root.push(new ii("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new rn("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new rn("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new rn("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new rn("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new rn("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new rn("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new rn("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new rn("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new rn("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new rn("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(t){this.root.push(new rn("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${t}.xml`))}addHeader(t){this.root.push(new rn("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${t}.xml`))}}class QM extends tt{constructor(t){super("cp:coreProperties"),this.root.push(new X0(["cp","dc","dcterms","dcmitype","xsi"])),t.title&&this.root.push(new Mo("dc:title",t.title)),t.subject&&this.root.push(new Mo("dc:subject",t.subject)),t.creator&&this.root.push(new Mo("dc:creator",t.creator)),t.keywords&&this.root.push(new Mo("cp:keywords",t.keywords)),t.description&&this.root.push(new Mo("dc:description",t.description)),t.lastModifiedBy&&this.root.push(new Mo("cp:lastModifiedBy",t.lastModifiedBy)),t.revision&&this.root.push(new Mo("cp:revision",String(t.revision))),this.root.push(new $N("dcterms:created")),this.root.push(new $N("dcterms:modified"))}}class eP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{type:"xsi:type"})}}class $N extends tt{constructor(t){super(t),this.root.push(new eP({type:"dcterms:W3CDTF"})),this.root.push(K7(new Date))}}class tP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class rP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}}class sP extends tt{constructor(t,r){super("property"),this.root.push(new rP({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t.toString(),name:r.name})),this.root.push(new aP(r.value))}}class aP extends tt{constructor(t){super("vt:lpwstr"),this.root.push(t)}}class nP extends tt{constructor(t){super("Properties"),Qe(this,"nextId"),Qe(this,"properties",[]),this.root.push(new tP({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const r of t)this.addCustomProperty(r)}prepForXml(t){return this.properties.forEach(r=>this.root.push(r)),super.prepForXml(t)}addCustomProperty(t){this.properties.push(new sP(this.nextId++,t))}}const Mh=({id:e,fontKey:t,subsetted:r},s)=>new Cr({name:s,attributes:ar({id:{key:"r:id",value:e}},t?{fontKey:{key:"w:fontKey",value:`{${t}}`}}:{}),children:[...r?[new xt("w:subsetted",r)]:[]]}),iP=({name:e,altName:t,panose1:r,charset:s,family:a,notTrueType:o,pitch:c,sig:u,embedRegular:d,embedBold:h,embedItalic:m,embedBoldItalic:x})=>new Cr({name:"w:font",attributes:{name:{key:"w:name",value:e}},children:[...t?[$u("w:altName",t)]:[],...r?[$u("w:panose1",r)]:[],...s?[$u("w:charset",s)]:[],$u("w:family",a),...o?[new xt("w:notTrueType",o)]:[],$u("w:pitch",c),...u?[new Cr({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:u.usb0},usb1:{key:"w:usb1",value:u.usb1},usb2:{key:"w:usb2",value:u.usb2},usb3:{key:"w:usb3",value:u.usb3},csb0:{key:"w:csb0",value:u.csb0},csb1:{key:"w:csb1",value:u.csb1}}})]:[],...d?[Mh(d,"w:embedRegular")]:[],...h?[Mh(h,"w:embedBold")]:[],...m?[Mh(m,"w:embedItalic")]:[],...x?[Mh(x,"w:embedBoldItalic")]:[]]}),oP=({name:e,index:t,fontKey:r,characterSet:s})=>iP({name:e,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:s,family:"auto",pitch:"variable",embedRegular:{fontKey:r,id:`rId${t}`}}),lP=e=>new Cr({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:e.map((t,r)=>oP({name:t.name,index:r+1,fontKey:t.fontKey}))});class cP{constructor(t){Qe(this,"fontTable"),Qe(this,"relationships"),Qe(this,"fontOptionsWithKey",[]),this.options=t,this.fontOptionsWithKey=t.map(r=>yi(ar({},r),{fontKey:M9()})),this.fontTable=lP(this.fontOptionsWithKey),this.relationships=new xl;for(let r=0;r<t.length;r++)this.relationships.createRelationship(r+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${t[r].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}}class uP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}}let dP=class extends z4{constructor(t,r){super("w:ftr",r),Qe(this,"refId"),this.refId=t,r||this.root.push(new uP({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(t){this.root.push(t)}};class fP{constructor(t,r,s){Qe(this,"footer"),Qe(this,"relationships"),this.media=t,this.footer=new dP(r,s),this.relationships=new xl}add(t){this.footer.add(t)}addChildElement(t){this.footer.addChildElement(t)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class hP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{type:"w:type",id:"w:id"})}}class mP extends tt{constructor(){super("w:footnoteRef")}}class pP extends Yd{constructor(){super({style:"FootnoteReference"}),this.root.push(new mP)}}const HN={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"};class A1 extends tt{constructor(t){super("w:footnote"),this.root.push(new hP({type:t.type,id:t.id}));for(let r=0;r<t.children.length;r++){const s=t.children[r];r===0&&s.addRunToFront(new pP),this.root.push(s)}}}class xP extends tt{constructor(){super("w:continuationSeparator")}}class gP extends Yd{constructor(){super({}),this.root.push(new xP)}}class yP extends tt{constructor(){super("w:separator")}}class vP extends Yd{constructor(){super({}),this.root.push(new yP)}}class wP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class bP extends tt{constructor(){super("w:footnotes"),this.root.push(new wP({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const t=new A1({id:-1,type:HN.SEPERATOR,children:[new lt({spacing:{after:0,line:240,lineRule:yy.AUTO},children:[new vP]})]});this.root.push(t);const r=new A1({id:0,type:HN.CONTINUATION_SEPERATOR,children:[new lt({spacing:{after:0,line:240,lineRule:yy.AUTO},children:[new gP]})]});this.root.push(r)}createFootNote(t,r){const s=new A1({id:t,children:r});this.root.push(s)}}class _P{constructor(){Qe(this,"footnotess"),Qe(this,"relationships"),this.footnotess=new bP,this.relationships=new xl}get View(){return this.footnotess}get Relationships(){return this.relationships}}class SP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}}let kP=class extends z4{constructor(t,r){super("w:hdr",r),Qe(this,"refId"),this.refId=t,r||this.root.push(new SP({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(t){this.root.push(t)}};class NP{constructor(t,r,s){Qe(this,"header"),Qe(this,"relationships"),this.media=t,this.header=new kP(r,s),this.relationships=new xl}add(t){return this.header.add(t),this}addChildElement(t){this.header.addChildElement(t)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class EP{constructor(){Qe(this,"map"),this.map=new Map}addImage(t,r){this.map.set(t,r)}get Array(){return Array.from(this.map.values())}}const oi={BULLET:"bullet"};class jP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}}class TP extends tt{constructor(t){super("w:numFmt"),this.root.push(new ls({val:t}))}}class AP extends tt{constructor(t){super("w:lvlText"),this.root.push(new ls({val:t}))}}class CP extends tt{constructor(t){super("w:lvlJc"),this.root.push(new ls({val:t}))}}class RP extends tt{constructor(t){super("w:suff"),this.root.push(new ls({val:t}))}}class DP extends tt{constructor(){super("w:isLgl")}}class OP extends tt{constructor({level:t,format:r,text:s,alignment:a=Ot.START,start:o=1,style:c,suffix:u,isLegalNumberingStyle:d}){if(super("w:lvl"),Qe(this,"paragraphProperties"),Qe(this,"runProperties"),this.root.push(new ad("w:start",oa(o))),r&&this.root.push(new TP(r)),u&&this.root.push(new RP(u)),d&&this.root.push(new DP),s&&this.root.push(new AP(s)),this.root.push(new CP(a)),this.paragraphProperties=new Pc(c&&c.paragraph),this.runProperties=new pl(c&&c.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),t>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new jP({ilvl:oa(t),tentative:1}))}}class FP extends OP{}class LP extends tt{constructor(t){super("w:multiLevelType"),this.root.push(new ls({val:t}))}}class IP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}}class WN extends tt{constructor(t,r){super("w:abstractNum"),Qe(this,"id"),this.root.push(new IP({abstractNumId:oa(t),restartNumberingAfterBreak:0})),this.root.push(new LP("hybridMultilevel")),this.id=t;for(const s of r)this.root.push(new FP(s))}}class MP extends tt{constructor(t){super("w:abstractNumId"),this.root.push(new ls({val:t}))}}class PP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{numId:"w:numId"})}}class GN extends tt{constructor(t){if(super("w:num"),Qe(this,"numId"),Qe(this,"reference"),Qe(this,"instance"),this.numId=t.numId,this.reference=t.reference,this.instance=t.instance,this.root.push(new PP({numId:oa(t.numId)})),this.root.push(new MP(oa(t.abstractNumId))),t.overrideLevels&&t.overrideLevels.length)for(const r of t.overrideLevels)this.root.push(new UP(r.num,r.start))}}class BP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{ilvl:"w:ilvl"})}}class UP extends tt{constructor(t,r){super("w:lvlOverride"),this.root.push(new BP({ilvl:t})),r!==void 0&&this.root.push(new qP(r))}}class zP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{val:"w:val"})}}class qP extends tt{constructor(t){super("w:startOverride"),this.root.push(new zP({val:t}))}}class $P extends tt{constructor(t){super("w:numbering"),Qe(this,"abstractNumberingMap",new Map),Qe(this,"concreteNumberingMap",new Map),Qe(this,"referenceConfigMap",new Map),Qe(this,"abstractNumUniqueNumericId",D9()),Qe(this,"concreteNumUniqueNumericId",O9()),this.root.push(new X0(["wpc","mc","o","r","m","v","wp14","wp","w10","w","w14","w15","wpg","wpi","wne","wps"],"w14 w15 wp14"));const r=new WN(this.abstractNumUniqueNumericId(),[{level:0,format:oi.BULLET,text:"",alignment:Ot.LEFT,style:{paragraph:{indent:{left:kr(.5),hanging:kr(.25)}}}},{level:1,format:oi.BULLET,text:"",alignment:Ot.LEFT,style:{paragraph:{indent:{left:kr(1),hanging:kr(.25)}}}},{level:2,format:oi.BULLET,text:"",alignment:Ot.LEFT,style:{paragraph:{indent:{left:2160,hanging:kr(.25)}}}},{level:3,format:oi.BULLET,text:"",alignment:Ot.LEFT,style:{paragraph:{indent:{left:2880,hanging:kr(.25)}}}},{level:4,format:oi.BULLET,text:"",alignment:Ot.LEFT,style:{paragraph:{indent:{left:3600,hanging:kr(.25)}}}},{level:5,format:oi.BULLET,text:"",alignment:Ot.LEFT,style:{paragraph:{indent:{left:4320,hanging:kr(.25)}}}},{level:6,format:oi.BULLET,text:"",alignment:Ot.LEFT,style:{paragraph:{indent:{left:5040,hanging:kr(.25)}}}},{level:7,format:oi.BULLET,text:"",alignment:Ot.LEFT,style:{paragraph:{indent:{left:5760,hanging:kr(.25)}}}},{level:8,format:oi.BULLET,text:"",alignment:Ot.LEFT,style:{paragraph:{indent:{left:6480,hanging:kr(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new GN({numId:1,abstractNumId:r.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",r);for(const s of t.config)this.abstractNumberingMap.set(s.reference,new WN(this.abstractNumUniqueNumericId(),s.levels)),this.referenceConfigMap.set(s.reference,s.levels)}prepForXml(t){for(const r of this.abstractNumberingMap.values())this.root.push(r);for(const r of this.concreteNumberingMap.values())this.root.push(r);return super.prepForXml(t)}createConcreteNumberingInstance(t,r){const s=this.abstractNumberingMap.get(t);if(!s)return;const a=`${t}-${r}`;if(this.concreteNumberingMap.has(a))return;const o=this.referenceConfigMap.get(t),c=o&&o[0].start,u={numId:this.concreteNumUniqueNumericId(),abstractNumId:s.id,reference:t,instance:r,overrideLevels:[c&&Number.isInteger(c)?{num:0,start:c}:{num:0,start:1}]};this.concreteNumberingMap.set(a,new GN(u))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class HP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}}class WP extends tt{constructor(t){super("w:compatSetting"),this.root.push(new HP({version:t,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class GP extends tt{constructor(t){super("w:compat"),t.version&&this.root.push(new WP(t.version)),t.useSingleBorderforContiguousCells&&this.root.push(new xt("w:useSingleBorderforContiguousCells",t.useSingleBorderforContiguousCells)),t.wordPerfectJustification&&this.root.push(new xt("w:wpJustification",t.wordPerfectJustification)),t.noTabStopForHangingIndent&&this.root.push(new xt("w:noTabHangInd",t.noTabStopForHangingIndent)),t.noLeading&&this.root.push(new xt("w:noLeading",t.noLeading)),t.spaceForUnderline&&this.root.push(new xt("w:spaceForUL",t.spaceForUnderline)),t.noColumnBalance&&this.root.push(new xt("w:noColumnBalance",t.noColumnBalance)),t.balanceSingleByteDoubleByteWidth&&this.root.push(new xt("w:balanceSingleByteDoubleByteWidth",t.balanceSingleByteDoubleByteWidth)),t.noExtraLineSpacing&&this.root.push(new xt("w:noExtraLineSpacing",t.noExtraLineSpacing)),t.doNotLeaveBackslashAlone&&this.root.push(new xt("w:doNotLeaveBackslashAlone",t.doNotLeaveBackslashAlone)),t.underlineTrailingSpaces&&this.root.push(new xt("w:ulTrailSpace",t.underlineTrailingSpaces)),t.doNotExpandShiftReturn&&this.root.push(new xt("w:doNotExpandShiftReturn",t.doNotExpandShiftReturn)),t.spacingInWholePoints&&this.root.push(new xt("w:spacingInWholePoints",t.spacingInWholePoints)),t.lineWrapLikeWord6&&this.root.push(new xt("w:lineWrapLikeWord6",t.lineWrapLikeWord6)),t.printBodyTextBeforeHeader&&this.root.push(new xt("w:printBodyTextBeforeHeader",t.printBodyTextBeforeHeader)),t.printColorsBlack&&this.root.push(new xt("w:printColBlack",t.printColorsBlack)),t.spaceWidth&&this.root.push(new xt("w:wpSpaceWidth",t.spaceWidth)),t.showBreaksInFrames&&this.root.push(new xt("w:showBreaksInFrames",t.showBreaksInFrames)),t.subFontBySize&&this.root.push(new xt("w:subFontBySize",t.subFontBySize)),t.suppressBottomSpacing&&this.root.push(new xt("w:suppressBottomSpacing",t.suppressBottomSpacing)),t.suppressTopSpacing&&this.root.push(new xt("w:suppressTopSpacing",t.suppressTopSpacing)),t.suppressSpacingAtTopOfPage&&this.root.push(new xt("w:suppressSpacingAtTopOfPage",t.suppressSpacingAtTopOfPage)),t.suppressTopSpacingWP&&this.root.push(new xt("w:suppressTopSpacingWP",t.suppressTopSpacingWP)),t.suppressSpBfAfterPgBrk&&this.root.push(new xt("w:suppressSpBfAfterPgBrk",t.suppressSpBfAfterPgBrk)),t.swapBordersFacingPages&&this.root.push(new xt("w:swapBordersFacingPages",t.swapBordersFacingPages)),t.convertMailMergeEsc&&this.root.push(new xt("w:convMailMergeEsc",t.convertMailMergeEsc)),t.truncateFontHeightsLikeWP6&&this.root.push(new xt("w:truncateFontHeightsLikeWP6",t.truncateFontHeightsLikeWP6)),t.macWordSmallCaps&&this.root.push(new xt("w:mwSmallCaps",t.macWordSmallCaps)),t.usePrinterMetrics&&this.root.push(new xt("w:usePrinterMetrics",t.usePrinterMetrics)),t.doNotSuppressParagraphBorders&&this.root.push(new xt("w:doNotSuppressParagraphBorders",t.doNotSuppressParagraphBorders)),t.wrapTrailSpaces&&this.root.push(new xt("w:wrapTrailSpaces",t.wrapTrailSpaces)),t.footnoteLayoutLikeWW8&&this.root.push(new xt("w:footnoteLayoutLikeWW8",t.footnoteLayoutLikeWW8)),t.shapeLayoutLikeWW8&&this.root.push(new xt("w:shapeLayoutLikeWW8",t.shapeLayoutLikeWW8)),t.alignTablesRowByRow&&this.root.push(new xt("w:alignTablesRowByRow",t.alignTablesRowByRow)),t.forgetLastTabAlignment&&this.root.push(new xt("w:forgetLastTabAlignment",t.forgetLastTabAlignment)),t.adjustLineHeightInTable&&this.root.push(new xt("w:adjustLineHeightInTable",t.adjustLineHeightInTable)),t.autoSpaceLikeWord95&&this.root.push(new xt("w:autoSpaceLikeWord95",t.autoSpaceLikeWord95)),t.noSpaceRaiseLower&&this.root.push(new xt("w:noSpaceRaiseLower",t.noSpaceRaiseLower)),t.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new xt("w:doNotUseHTMLParagraphAutoSpacing",t.doNotUseHTMLParagraphAutoSpacing)),t.layoutRawTableWidth&&this.root.push(new xt("w:layoutRawTableWidth",t.layoutRawTableWidth)),t.layoutTableRowsApart&&this.root.push(new xt("w:layoutTableRowsApart",t.layoutTableRowsApart)),t.useWord97LineBreakRules&&this.root.push(new xt("w:useWord97LineBreakRules",t.useWord97LineBreakRules)),t.doNotBreakWrappedTables&&this.root.push(new xt("w:doNotBreakWrappedTables",t.doNotBreakWrappedTables)),t.doNotSnapToGridInCell&&this.root.push(new xt("w:doNotSnapToGridInCell",t.doNotSnapToGridInCell)),t.selectFieldWithFirstOrLastCharacter&&this.root.push(new xt("w:selectFldWithFirstOrLastChar",t.selectFieldWithFirstOrLastCharacter)),t.applyBreakingRules&&this.root.push(new xt("w:applyBreakingRules",t.applyBreakingRules)),t.doNotWrapTextWithPunctuation&&this.root.push(new xt("w:doNotWrapTextWithPunct",t.doNotWrapTextWithPunctuation)),t.doNotUseEastAsianBreakRules&&this.root.push(new xt("w:doNotUseEastAsianBreakRules",t.doNotUseEastAsianBreakRules)),t.useWord2002TableStyleRules&&this.root.push(new xt("w:useWord2002TableStyleRules",t.useWord2002TableStyleRules)),t.growAutofit&&this.root.push(new xt("w:growAutofit",t.growAutofit)),t.useFELayout&&this.root.push(new xt("w:useFELayout",t.useFELayout)),t.useNormalStyleForList&&this.root.push(new xt("w:useNormalStyleForList",t.useNormalStyleForList)),t.doNotUseIndentAsNumberingTabStop&&this.root.push(new xt("w:doNotUseIndentAsNumberingTabStop",t.doNotUseIndentAsNumberingTabStop)),t.useAlternateEastAsianLineBreakRules&&this.root.push(new xt("w:useAltKinsokuLineBreakRules",t.useAlternateEastAsianLineBreakRules)),t.allowSpaceOfSameStyleInTable&&this.root.push(new xt("w:allowSpaceOfSameStyleInTable",t.allowSpaceOfSameStyleInTable)),t.doNotSuppressIndentation&&this.root.push(new xt("w:doNotSuppressIndentation",t.doNotSuppressIndentation)),t.doNotAutofitConstrainedTables&&this.root.push(new xt("w:doNotAutofitConstrainedTables",t.doNotAutofitConstrainedTables)),t.autofitToFirstFixedWidthCell&&this.root.push(new xt("w:autofitToFirstFixedWidthCell",t.autofitToFirstFixedWidthCell)),t.underlineTabInNumberingList&&this.root.push(new xt("w:underlineTabInNumList",t.underlineTabInNumberingList)),t.displayHangulFixedWidth&&this.root.push(new xt("w:displayHangulFixedWidth",t.displayHangulFixedWidth)),t.splitPgBreakAndParaMark&&this.root.push(new xt("w:splitPgBreakAndParaMark",t.splitPgBreakAndParaMark)),t.doNotVerticallyAlignCellWithSp&&this.root.push(new xt("w:doNotVertAlignCellWithSp",t.doNotVerticallyAlignCellWithSp)),t.doNotBreakConstrainedForcedTable&&this.root.push(new xt("w:doNotBreakConstrainedForcedTable",t.doNotBreakConstrainedForcedTable)),t.ignoreVerticalAlignmentInTextboxes&&this.root.push(new xt("w:doNotVertAlignInTxbx",t.ignoreVerticalAlignmentInTextboxes)),t.useAnsiKerningPairs&&this.root.push(new xt("w:useAnsiKerningPairs",t.useAnsiKerningPairs)),t.cachedColumnBalance&&this.root.push(new xt("w:cachedColBalance",t.cachedColumnBalance))}}class VP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class KP extends tt{constructor(t){var r,s,a,o,c,u,d,h;super("w:settings"),this.root.push(new VP({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new xt("w:displayBackgroundShape",!0)),t.trackRevisions!==void 0&&this.root.push(new xt("w:trackRevisions",t.trackRevisions)),t.evenAndOddHeaders!==void 0&&this.root.push(new xt("w:evenAndOddHeaders",t.evenAndOddHeaders)),t.updateFields!==void 0&&this.root.push(new xt("w:updateFields",t.updateFields)),t.defaultTabStop!==void 0&&this.root.push(new ad("w:defaultTabStop",t.defaultTabStop)),((r=t.hyphenation)==null?void 0:r.autoHyphenation)!==void 0&&this.root.push(new xt("w:autoHyphenation",t.hyphenation.autoHyphenation)),((s=t.hyphenation)==null?void 0:s.hyphenationZone)!==void 0&&this.root.push(new ad("w:hyphenationZone",t.hyphenation.hyphenationZone)),((a=t.hyphenation)==null?void 0:a.consecutiveHyphenLimit)!==void 0&&this.root.push(new ad("w:consecutiveHyphenLimit",t.hyphenation.consecutiveHyphenLimit)),((o=t.hyphenation)==null?void 0:o.doNotHyphenateCaps)!==void 0&&this.root.push(new xt("w:doNotHyphenateCaps",t.hyphenation.doNotHyphenateCaps)),this.root.push(new GP(yi(ar({},(c=t.compatibility)!=null?c:{}),{version:(h=(d=(u=t.compatibility)==null?void 0:u.version)!=null?d:t.compatibilityModeVersion)!=null?h:15})))}}class mT extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{val:"w:val"})}}class XP extends tt{constructor(t){super("w:name"),this.root.push(new mT({val:t}))}}class YP extends tt{constructor(t){super("w:uiPriority"),this.root.push(new mT({val:oa(t)}))}}class JP extends Ct{constructor(){super(...arguments),Qe(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}}class pT extends tt{constructor(t,r){super("w:style"),this.root.push(new JP(t)),r.name&&this.root.push(new XP(r.name)),r.basedOn&&this.root.push(new Jo("w:basedOn",r.basedOn)),r.next&&this.root.push(new Jo("w:next",r.next)),r.link&&this.root.push(new Jo("w:link",r.link)),r.uiPriority!==void 0&&this.root.push(new YP(r.uiPriority)),r.semiHidden!==void 0&&this.root.push(new xt("w:semiHidden",r.semiHidden)),r.unhideWhenUsed!==void 0&&this.root.push(new xt("w:unhideWhenUsed",r.unhideWhenUsed)),r.quickFormat!==void 0&&this.root.push(new xt("w:qFormat",r.quickFormat))}}class Y0 extends pT{constructor(t){super({type:"paragraph",styleId:t.id},t),Qe(this,"paragraphProperties"),Qe(this,"runProperties"),this.paragraphProperties=new Pc(t.paragraph),this.runProperties=new pl(t.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class J0 extends pT{constructor(t){super({type:"character",styleId:t.id},ar({uiPriority:99,unhideWhenUsed:!0},t)),Qe(this,"runProperties"),this.runProperties=new pl(t.run),this.root.push(this.runProperties)}}class ho extends Y0{constructor(t){super(ar({basedOn:"Normal",next:"Normal",quickFormat:!0},t))}}class ZP extends ho{constructor(t){super(ar({id:"Title",name:"Title"},t))}}class QP extends ho{constructor(t){super(ar({id:"Heading1",name:"Heading 1"},t))}}class eB extends ho{constructor(t){super(ar({id:"Heading2",name:"Heading 2"},t))}}class tB extends ho{constructor(t){super(ar({id:"Heading3",name:"Heading 3"},t))}}class rB extends ho{constructor(t){super(ar({id:"Heading4",name:"Heading 4"},t))}}class sB extends ho{constructor(t){super(ar({id:"Heading5",name:"Heading 5"},t))}}class aB extends ho{constructor(t){super(ar({id:"Heading6",name:"Heading 6"},t))}}class nB extends ho{constructor(t){super(ar({id:"Strong",name:"Strong"},t))}}class iB extends Y0{constructor(t){super(ar({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},t))}}class oB extends Y0{constructor(t){super(ar({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:yy.AUTO}},run:{size:20}},t))}}class lB extends J0{constructor(t){super(ar({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},t))}}class cB extends J0{constructor(t){super(ar({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},t))}}class uB extends J0{constructor(t){super(ar({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:V4.SINGLE}}},t))}}class wy extends tt{constructor(t){if(super("w:styles"),t.initialStyles&&this.root.push(t.initialStyles),t.importedStyles)for(const r of t.importedStyles)this.root.push(r);if(t.paragraphStyles)for(const r of t.paragraphStyles)this.root.push(new Y0(r));if(t.characterStyles)for(const r of t.characterStyles)this.root.push(new J0(r))}}class dB extends tt{constructor(t){super("w:pPrDefault"),this.root.push(new Pc(t))}}class fB extends tt{constructor(t){super("w:rPrDefault"),this.root.push(new pl(t))}}class hB extends tt{constructor(t){super("w:docDefaults"),Qe(this,"runPropertiesDefaults"),Qe(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new fB(t.run),this.paragraphPropertiesDefaults=new dB(t.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class mB{newInstance(t){const r=U4.xml2js(t,{compact:!1});let s;for(const c of r.elements||[])c.name==="w:styles"&&(s=c);if(s===void 0)throw new Error("can not find styles element");const a=s.elements||[];return new wy({initialStyles:new $7(s.attributes),importedStyles:a.map(c=>ov(c))})}}class VN{newInstance(t={}){var r;return{initialStyles:new X0(["mc","r","w","w14","w15"],"w14 w15"),importedStyles:[new hB((r=t.document)!=null?r:{}),new ZP(ar({run:{size:56}},t.title)),new QP(ar({run:{color:"2E74B5",size:32}},t.heading1)),new eB(ar({run:{color:"2E74B5",size:26}},t.heading2)),new tB(ar({run:{color:"1F4D78",size:24}},t.heading3)),new rB(ar({run:{color:"2E74B5",italics:!0}},t.heading4)),new sB(ar({run:{color:"2E74B5"}},t.heading5)),new aB(ar({run:{color:"1F4D78"}},t.heading6)),new nB(ar({run:{bold:!0}},t.strong)),new iB(t.listParagraph||{}),new uB(t.hyperlink||{}),new lB(t.footnoteReference||{}),new oB(t.footnoteText||{}),new cB(t.footnoteTextChar||{})]}}}let Z0=class{constructor(t){Qe(this,"currentRelationshipId",1),Qe(this,"documentWrapper"),Qe(this,"headers",[]),Qe(this,"footers",[]),Qe(this,"coreProperties"),Qe(this,"numbering"),Qe(this,"media"),Qe(this,"fileRelationships"),Qe(this,"footnotesWrapper"),Qe(this,"settings"),Qe(this,"contentTypes"),Qe(this,"customProperties"),Qe(this,"appProperties"),Qe(this,"styles"),Qe(this,"comments"),Qe(this,"fontWrapper");var r,s,a,o,c,u,d,h,m,x,y,v;if(this.coreProperties=new QM(yi(ar({},t),{creator:(r=t.creator)!=null?r:"Un-named",revision:(s=t.revision)!=null?s:1,lastModifiedBy:(a=t.lastModifiedBy)!=null?a:"Un-named"})),this.numbering=new $P(t.numbering?t.numbering:{config:[]}),this.comments=new HI((o=t.comments)!=null?o:{children:[]}),this.fileRelationships=new xl,this.customProperties=new nP((c=t.customProperties)!=null?c:[]),this.appProperties=new KM,this.footnotesWrapper=new _P,this.contentTypes=new ZM,this.documentWrapper=new lT({background:t.background}),this.settings=new KP({compatibilityModeVersion:t.compatabilityModeVersion,compatibility:t.compatibility,evenAndOddHeaders:!!t.evenAndOddHeaderAndFooters,trackRevisions:(u=t.features)==null?void 0:u.trackRevisions,updateFields:(d=t.features)==null?void 0:d.updateFields,defaultTabStop:t.defaultTabStop,hyphenation:{autoHyphenation:(h=t.hyphenation)==null?void 0:h.autoHyphenation,hyphenationZone:(m=t.hyphenation)==null?void 0:m.hyphenationZone,consecutiveHyphenLimit:(x=t.hyphenation)==null?void 0:x.consecutiveHyphenLimit,doNotHyphenateCaps:(y=t.hyphenation)==null?void 0:y.doNotHyphenateCaps}}),this.media=new EP,t.externalStyles!==void 0){const w=new mB;this.styles=w.newInstance(t.externalStyles)}else if(t.styles){const g=new VN().newInstance(t.styles.default);this.styles=new wy(ar(ar({},g),t.styles))}else{const w=new VN;this.styles=new wy(w.newInstance())}this.addDefaultRelationships();for(const w of t.sections)this.addSection(w);if(t.footnotes)for(const w in t.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(w),t.footnotes[w].children);this.fontWrapper=new cP((v=t.fonts)!=null?v:[])}addSection({headers:t={},footers:r={},children:s,properties:a}){this.documentWrapper.View.Body.addSection(yi(ar({},a),{headerWrapperGroup:{default:t.default?this.createHeader(t.default):void 0,first:t.first?this.createHeader(t.first):void 0,even:t.even?this.createHeader(t.even):void 0},footerWrapperGroup:{default:r.default?this.createFooter(r.default):void 0,first:r.first?this.createFooter(r.first):void 0,even:r.even?this.createFooter(r.even):void 0}}));for(const o of s)this.documentWrapper.View.add(o)}createHeader(t){const r=new NP(this.media,this.currentRelationshipId++);for(const s of t.options.children)r.add(s);return this.addHeaderToDocument(r),r}createFooter(t){const r=new fP(this.media,this.currentRelationshipId++);for(const s of t.options.children)r.add(s);return this.addFooterToDocument(r),r}addHeaderToDocument(t,r=Nc.DEFAULT){this.headers.push({header:t,type:r}),this.documentWrapper.Relationships.createRelationship(t.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(t,r=Nc.DEFAULT){this.footers.push({footer:t,type:r}),this.documentWrapper.Relationships.createRelationship(t.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(t=>t.header)}get Footers(){return this.footers.map(t=>t.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}};var pB=av();function Ph(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var C1={exports:{}},KN;function xB(){return KN||(KN=1,(function(e,t){(function(r){e.exports=r()})(function(){return(function r(s,a,o){function c(h,m){if(!a[h]){if(!s[h]){var x=typeof Ph=="function"&&Ph;if(!m&&x)return x(h,!0);if(u)return u(h,!0);var y=new Error("Cannot find module '"+h+"'");throw y.code="MODULE_NOT_FOUND",y}var v=a[h]={exports:{}};s[h][0].call(v.exports,function(w){var g=s[h][1][w];return c(g||w)},v,v.exports,r,s,a,o)}return a[h].exports}for(var u=typeof Ph=="function"&&Ph,d=0;d<o.length;d++)c(o[d]);return c})({1:[function(r,s,a){var o=r("./utils"),c=r("./support"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(d){for(var h,m,x,y,v,w,g,_=[],b=0,N=d.length,S=N,E=o.getTypeOf(d)!=="string";b<d.length;)S=N-b,x=E?(h=d[b++],m=b<N?d[b++]:0,b<N?d[b++]:0):(h=d.charCodeAt(b++),m=b<N?d.charCodeAt(b++):0,b<N?d.charCodeAt(b++):0),y=h>>2,v=(3&h)<<4|m>>4,w=1<S?(15&m)<<2|x>>6:64,g=2<S?63&x:64,_.push(u.charAt(y)+u.charAt(v)+u.charAt(w)+u.charAt(g));return _.join("")},a.decode=function(d){var h,m,x,y,v,w,g=0,_=0,b="data:";if(d.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var N,S=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===u.charAt(64)&&S--,d.charAt(d.length-2)===u.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(N=c.uint8array?new Uint8Array(0|S):new Array(0|S);g<d.length;)h=u.indexOf(d.charAt(g++))<<2|(y=u.indexOf(d.charAt(g++)))>>4,m=(15&y)<<4|(v=u.indexOf(d.charAt(g++)))>>2,x=(3&v)<<6|(w=u.indexOf(d.charAt(g++))),N[_++]=h,v!==64&&(N[_++]=m),w!==64&&(N[_++]=x);return N}},{"./support":30,"./utils":32}],2:[function(r,s,a){var o=r("./external"),c=r("./stream/DataWorker"),u=r("./stream/Crc32Probe"),d=r("./stream/DataLengthProbe");function h(m,x,y,v,w){this.compressedSize=m,this.uncompressedSize=x,this.crc32=y,this.compression=v,this.compressedContent=w}h.prototype={getContentWorker:function(){var m=new c(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),x=this;return m.on("end",function(){if(this.streamInfo.data_length!==x.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),m},getCompressedWorker:function(){return new c(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(m,x,y){return m.pipe(new u).pipe(new d("uncompressedSize")).pipe(x.compressWorker(y)).pipe(new d("compressedSize")).withStreamInfo("compression",x)},s.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,s,a){var o=r("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},a.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,s,a){var o=r("./utils"),c=(function(){for(var u,d=[],h=0;h<256;h++){u=h;for(var m=0;m<8;m++)u=1&u?3988292384^u>>>1:u>>>1;d[h]=u}return d})();s.exports=function(u,d){return u!==void 0&&u.length?o.getTypeOf(u)!=="string"?(function(h,m,x,y){var v=c,w=y+x;h^=-1;for(var g=y;g<w;g++)h=h>>>8^v[255&(h^m[g])];return-1^h})(0|d,u,u.length,0):(function(h,m,x,y){var v=c,w=y+x;h^=-1;for(var g=y;g<w;g++)h=h>>>8^v[255&(h^m.charCodeAt(g))];return-1^h})(0|d,u,u.length,0):0}},{"./utils":32}],5:[function(r,s,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(r,s,a){var o=null;o=typeof Promise<"u"?Promise:r("lie"),s.exports={Promise:o}},{lie:37}],7:[function(r,s,a){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",c=r("pako"),u=r("./utils"),d=r("./stream/GenericWorker"),h=o?"uint8array":"array";function m(x,y){d.call(this,"FlateWorker/"+x),this._pako=null,this._pakoAction=x,this._pakoOptions=y,this.meta={}}a.magic="\b\0",u.inherits(m,d),m.prototype.processChunk=function(x){this.meta=x.meta,this._pako===null&&this._createPako(),this._pako.push(u.transformTo(h,x.data),!1)},m.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},m.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},m.prototype._createPako=function(){this._pako=new c[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var x=this;this._pako.onData=function(y){x.push({data:y,meta:x.meta})}},a.compressWorker=function(x){return new m("Deflate",x)},a.uncompressWorker=function(){return new m("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,s,a){function o(v,w){var g,_="";for(g=0;g<w;g++)_+=String.fromCharCode(255&v),v>>>=8;return _}function c(v,w,g,_,b,N){var S,E,R=v.file,L=v.compression,O=N!==h.utf8encode,P=u.transformTo("string",N(R.name)),F=u.transformTo("string",h.utf8encode(R.name)),V=R.comment,oe=u.transformTo("string",N(V)),D=u.transformTo("string",h.utf8encode(V)),K=F.length!==R.name.length,M=D.length!==V.length,ae="",te="",Z="",we=R.dir,ee=R.date,Ne={crc32:0,compressedSize:0,uncompressedSize:0};w&&!g||(Ne.crc32=v.crc32,Ne.compressedSize=v.compressedSize,Ne.uncompressedSize=v.uncompressedSize);var q=0;w&&(q|=8),O||!K&&!M||(q|=2048);var I=0,X=0;we&&(I|=16),b==="UNIX"?(X=798,I|=(function(Q,ie){var B=Q;return Q||(B=ie?16893:33204),(65535&B)<<16})(R.unixPermissions,we)):(X=20,I|=(function(Q){return 63&(Q||0)})(R.dosPermissions)),S=ee.getUTCHours(),S<<=6,S|=ee.getUTCMinutes(),S<<=5,S|=ee.getUTCSeconds()/2,E=ee.getUTCFullYear()-1980,E<<=4,E|=ee.getUTCMonth()+1,E<<=5,E|=ee.getUTCDate(),K&&(te=o(1,1)+o(m(P),4)+F,ae+="up"+o(te.length,2)+te),M&&(Z=o(1,1)+o(m(oe),4)+D,ae+="uc"+o(Z.length,2)+Z);var H="";return H+=`
\0`,H+=o(q,2),H+=L.magic,H+=o(S,2),H+=o(E,2),H+=o(Ne.crc32,4),H+=o(Ne.compressedSize,4),H+=o(Ne.uncompressedSize,4),H+=o(P.length,2),H+=o(ae.length,2),{fileRecord:x.LOCAL_FILE_HEADER+H+P+ae,dirRecord:x.CENTRAL_FILE_HEADER+o(X,2)+H+o(oe.length,2)+"\0\0\0\0"+o(I,4)+o(_,4)+P+ae+oe}}var u=r("../utils"),d=r("../stream/GenericWorker"),h=r("../utf8"),m=r("../crc32"),x=r("../signature");function y(v,w,g,_){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=g,this.encodeFileName=_,this.streamFiles=v,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}u.inherits(y,d),y.prototype.push=function(v){var w=v.meta.percent||0,g=this.entriesCount,_=this._sources.length;this.accumulate?this.contentBuffer.push(v):(this.bytesWritten+=v.data.length,d.prototype.push.call(this,{data:v.data,meta:{currentFile:this.currentFile,percent:g?(w+100*(g-_-1))/g:100}}))},y.prototype.openedSource=function(v){this.currentSourceOffset=this.bytesWritten,this.currentFile=v.file.name;var w=this.streamFiles&&!v.file.dir;if(w){var g=c(v,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(v){this.accumulate=!1;var w=this.streamFiles&&!v.file.dir,g=c(v,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),w)this.push({data:(function(_){return x.DATA_DESCRIPTOR+o(_.crc32,4)+o(_.compressedSize,4)+o(_.uncompressedSize,4)})(v),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var v=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var g=this.bytesWritten-v,_=(function(b,N,S,E,R){var L=u.transformTo("string",R(E));return x.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(b,2)+o(b,2)+o(N,4)+o(S,4)+o(L.length,2)+L})(this.dirRecords.length,g,v,this.zipComment,this.encodeFileName);this.push({data:_,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(v){this._sources.push(v);var w=this;return v.on("data",function(g){w.processChunk(g)}),v.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),v.on("error",function(g){w.error(g)}),this},y.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(v){var w=this._sources;if(!d.prototype.error.call(this,v))return!1;for(var g=0;g<w.length;g++)try{w[g].error(v)}catch{}return!0},y.prototype.lock=function(){d.prototype.lock.call(this);for(var v=this._sources,w=0;w<v.length;w++)v[w].lock()},s.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,s,a){var o=r("../compressions"),c=r("./ZipFileWorker");a.generateWorker=function(u,d,h){var m=new c(d.streamFiles,h,d.platform,d.encodeFileName),x=0;try{u.forEach(function(y,v){x++;var w=(function(N,S){var E=N||S,R=o[E];if(!R)throw new Error(E+" is not a valid compression method !");return R})(v.options.compression,d.compression),g=v.options.compressionOptions||d.compressionOptions||{},_=v.dir,b=v.date;v._compressWorker(w,g).withStreamInfo("file",{name:y,dir:_,date:b,comment:v.comment||"",unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions}).pipe(m)}),m.entriesCount=x}catch(y){m.error(y)}return m}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,s,a){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var c=new o;for(var u in this)typeof this[u]!="function"&&(c[u]=this[u]);return c}}(o.prototype=r("./object")).loadAsync=r("./load"),o.support=r("./support"),o.defaults=r("./defaults"),o.version="3.10.1",o.loadAsync=function(c,u){return new o().loadAsync(c,u)},o.external=r("./external"),s.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,s,a){var o=r("./utils"),c=r("./external"),u=r("./utf8"),d=r("./zipEntries"),h=r("./stream/Crc32Probe"),m=r("./nodejsUtils");function x(y){return new c.Promise(function(v,w){var g=y.decompressed.getContentWorker().pipe(new h);g.on("error",function(_){w(_)}).on("end",function(){g.streamInfo.crc32!==y.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):v()}).resume()})}s.exports=function(y,v){var w=this;return v=o.extend(v||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:u.utf8decode}),m.isNode&&m.isStream(y)?c.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",y,!0,v.optimizedBinaryString,v.base64).then(function(g){var _=new d(v);return _.load(g),_}).then(function(g){var _=[c.Promise.resolve(g)],b=g.files;if(v.checkCRC32)for(var N=0;N<b.length;N++)_.push(x(b[N]));return c.Promise.all(_)}).then(function(g){for(var _=g.shift(),b=_.files,N=0;N<b.length;N++){var S=b[N],E=S.fileNameStr,R=o.resolve(S.fileNameStr);w.file(R,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:v.createFolders}),S.dir||(w.file(R).unsafeOriginalName=E)}return _.zipComment.length&&(w.comment=_.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,s,a){var o=r("../utils"),c=r("../stream/GenericWorker");function u(d,h){c.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(h)}o.inherits(u,c),u.prototype._bindStream=function(d){var h=this;(this._stream=d).pause(),d.on("data",function(m){h.push({data:m,meta:{percent:0}})}).on("error",function(m){h.isPaused?this.generatedError=m:h.error(m)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},u.prototype.pause=function(){return!!c.prototype.pause.call(this)&&(this._stream.pause(),!0)},u.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=u},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,s,a){var o=r("readable-stream").Readable;function c(u,d,h){o.call(this,d),this._helper=u;var m=this;u.on("data",function(x,y){m.push(x)||m._helper.pause(),h&&h(y)}).on("error",function(x){m.emit("error",x)}).on("end",function(){m.push(null)})}r("../utils").inherits(c,o),c.prototype._read=function(){this._helper.resume()},s.exports=c},{"../utils":32,"readable-stream":16}],14:[function(r,s,a){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,c){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,c);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,c)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var c=new Buffer(o);return c.fill(0),c},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(r,s,a){function o(R,L,O){var P,F=u.getTypeOf(L),V=u.extend(O||{},m);V.date=V.date||new Date,V.compression!==null&&(V.compression=V.compression.toUpperCase()),typeof V.unixPermissions=="string"&&(V.unixPermissions=parseInt(V.unixPermissions,8)),V.unixPermissions&&16384&V.unixPermissions&&(V.dir=!0),V.dosPermissions&&16&V.dosPermissions&&(V.dir=!0),V.dir&&(R=b(R)),V.createFolders&&(P=_(R))&&N.call(this,P,!0);var oe=F==="string"&&V.binary===!1&&V.base64===!1;O&&O.binary!==void 0||(V.binary=!oe),(L instanceof x&&L.uncompressedSize===0||V.dir||!L||L.length===0)&&(V.base64=!1,V.binary=!0,L="",V.compression="STORE",F="string");var D=null;D=L instanceof x||L instanceof d?L:w.isNode&&w.isStream(L)?new g(R,L):u.prepareContent(R,L,V.binary,V.optimizedBinaryString,V.base64);var K=new y(R,D,V);this.files[R]=K}var c=r("./utf8"),u=r("./utils"),d=r("./stream/GenericWorker"),h=r("./stream/StreamHelper"),m=r("./defaults"),x=r("./compressedObject"),y=r("./zipObject"),v=r("./generate"),w=r("./nodejsUtils"),g=r("./nodejs/NodejsStreamInputAdapter"),_=function(R){R.slice(-1)==="/"&&(R=R.substring(0,R.length-1));var L=R.lastIndexOf("/");return 0<L?R.substring(0,L):""},b=function(R){return R.slice(-1)!=="/"&&(R+="/"),R},N=function(R,L){return L=L!==void 0?L:m.createFolders,R=b(R),this.files[R]||o.call(this,R,null,{dir:!0,createFolders:L}),this.files[R]};function S(R){return Object.prototype.toString.call(R)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(R){var L,O,P;for(L in this.files)P=this.files[L],(O=L.slice(this.root.length,L.length))&&L.slice(0,this.root.length)===this.root&&R(O,P)},filter:function(R){var L=[];return this.forEach(function(O,P){R(O,P)&&L.push(P)}),L},file:function(R,L,O){if(arguments.length!==1)return R=this.root+R,o.call(this,R,L,O),this;if(S(R)){var P=R;return this.filter(function(V,oe){return!oe.dir&&P.test(V)})}var F=this.files[this.root+R];return F&&!F.dir?F:null},folder:function(R){if(!R)return this;if(S(R))return this.filter(function(F,V){return V.dir&&R.test(F)});var L=this.root+R,O=N.call(this,L),P=this.clone();return P.root=O.name,P},remove:function(R){R=this.root+R;var L=this.files[R];if(L||(R.slice(-1)!=="/"&&(R+="/"),L=this.files[R]),L&&!L.dir)delete this.files[R];else for(var O=this.filter(function(F,V){return V.name.slice(0,R.length)===R}),P=0;P<O.length;P++)delete this.files[O[P].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(R){var L,O={};try{if((O=u.extend(R||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:c.utf8encode})).type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");u.checkSupport(O.type),O.platform!=="darwin"&&O.platform!=="freebsd"&&O.platform!=="linux"&&O.platform!=="sunos"||(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var P=O.comment||this.comment||"";L=v.generateWorker(this,O,P)}catch(F){(L=new d("error")).error(F)}return new h(L,O.type||"string",O.mimeType)},generateAsync:function(R,L){return this.generateInternalStream(R).accumulate(L)},generateNodeStream:function(R,L){return(R=R||{}).type||(R.type="nodebuffer"),this.generateInternalStream(R).toNodejsStream(L)}};s.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,s,a){s.exports=r("stream")},{stream:void 0}],17:[function(r,s,a){var o=r("./DataReader");function c(u){o.call(this,u);for(var d=0;d<this.data.length;d++)u[d]=255&u[d]}r("../utils").inherits(c,o),c.prototype.byteAt=function(u){return this.data[this.zero+u]},c.prototype.lastIndexOfSignature=function(u){for(var d=u.charCodeAt(0),h=u.charCodeAt(1),m=u.charCodeAt(2),x=u.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===d&&this.data[y+1]===h&&this.data[y+2]===m&&this.data[y+3]===x)return y-this.zero;return-1},c.prototype.readAndCheckSignature=function(u){var d=u.charCodeAt(0),h=u.charCodeAt(1),m=u.charCodeAt(2),x=u.charCodeAt(3),y=this.readData(4);return d===y[0]&&h===y[1]&&m===y[2]&&x===y[3]},c.prototype.readData=function(u){if(this.checkOffset(u),u===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},s.exports=c},{"../utils":32,"./DataReader":18}],18:[function(r,s,a){var o=r("../utils");function c(u){this.data=u,this.length=u.length,this.index=0,this.zero=0}c.prototype={checkOffset:function(u){this.checkIndex(this.index+u)},checkIndex:function(u){if(this.length<this.zero+u||u<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+u+"). Corrupted zip ?")},setIndex:function(u){this.checkIndex(u),this.index=u},skip:function(u){this.setIndex(this.index+u)},byteAt:function(){},readInt:function(u){var d,h=0;for(this.checkOffset(u),d=this.index+u-1;d>=this.index;d--)h=(h<<8)+this.byteAt(d);return this.index+=u,h},readString:function(u){return o.transformTo("string",this.readData(u))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var u=this.readInt(4);return new Date(Date.UTC(1980+(u>>25&127),(u>>21&15)-1,u>>16&31,u>>11&31,u>>5&63,(31&u)<<1))}},s.exports=c},{"../utils":32}],19:[function(r,s,a){var o=r("./Uint8ArrayReader");function c(u){o.call(this,u)}r("../utils").inherits(c,o),c.prototype.readData=function(u){this.checkOffset(u);var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},s.exports=c},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,s,a){var o=r("./DataReader");function c(u){o.call(this,u)}r("../utils").inherits(c,o),c.prototype.byteAt=function(u){return this.data.charCodeAt(this.zero+u)},c.prototype.lastIndexOfSignature=function(u){return this.data.lastIndexOf(u)-this.zero},c.prototype.readAndCheckSignature=function(u){return u===this.readData(4)},c.prototype.readData=function(u){this.checkOffset(u);var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},s.exports=c},{"../utils":32,"./DataReader":18}],21:[function(r,s,a){var o=r("./ArrayReader");function c(u){o.call(this,u)}r("../utils").inherits(c,o),c.prototype.readData=function(u){if(this.checkOffset(u),u===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},s.exports=c},{"../utils":32,"./ArrayReader":17}],22:[function(r,s,a){var o=r("../utils"),c=r("../support"),u=r("./ArrayReader"),d=r("./StringReader"),h=r("./NodeBufferReader"),m=r("./Uint8ArrayReader");s.exports=function(x){var y=o.getTypeOf(x);return o.checkSupport(y),y!=="string"||c.uint8array?y==="nodebuffer"?new h(x):c.uint8array?new m(o.transformTo("uint8array",x)):new u(o.transformTo("array",x)):new d(x)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,s,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,s,a){var o=r("./GenericWorker"),c=r("../utils");function u(d){o.call(this,"ConvertWorker to "+d),this.destType=d}c.inherits(u,o),u.prototype.processChunk=function(d){this.push({data:c.transformTo(this.destType,d.data),meta:d.meta})},s.exports=u},{"../utils":32,"./GenericWorker":28}],25:[function(r,s,a){var o=r("./GenericWorker"),c=r("../crc32");function u(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(u,o),u.prototype.processChunk=function(d){this.streamInfo.crc32=c(d.data,this.streamInfo.crc32||0),this.push(d)},s.exports=u},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,s,a){var o=r("../utils"),c=r("./GenericWorker");function u(d){c.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}o.inherits(u,c),u.prototype.processChunk=function(d){if(d){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+d.data.length}c.prototype.processChunk.call(this,d)},s.exports=u},{"../utils":32,"./GenericWorker":28}],27:[function(r,s,a){var o=r("../utils"),c=r("./GenericWorker");function u(d){c.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(m){h.dataIsReady=!0,h.data=m,h.max=m&&m.length||0,h.type=o.getTypeOf(m),h.isPaused||h._tickAndRepeat()},function(m){h.error(m)})}o.inherits(u,c),u.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this.data=null},u.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},u.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},u.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,h);break;case"uint8array":d=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":d=this.data.slice(this.index,h)}return this.index=h,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=u},{"../utils":32,"./GenericWorker":28}],28:[function(r,s,a){function o(c){this.name=c||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(c){this.emit("data",c)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(c){this.emit("error",c)}return!0},error:function(c){return!this.isFinished&&(this.isPaused?this.generatedError=c:(this.isFinished=!0,this.emit("error",c),this.previous&&this.previous.error(c),this.cleanUp()),!0)},on:function(c,u){return this._listeners[c].push(u),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(c,u){if(this._listeners[c])for(var d=0;d<this._listeners[c].length;d++)this._listeners[c][d].call(this,u)},pipe:function(c){return c.registerPrevious(this)},registerPrevious:function(c){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=c.streamInfo,this.mergeStreamInfo(),this.previous=c;var u=this;return c.on("data",function(d){u.processChunk(d)}),c.on("end",function(){u.end()}),c.on("error",function(d){u.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var c=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),c=!0),this.previous&&this.previous.resume(),!c},flush:function(){},processChunk:function(c){this.push(c)},withStreamInfo:function(c,u){return this.extraStreamInfo[c]=u,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var c in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,c)&&(this.streamInfo[c]=this.extraStreamInfo[c])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var c="Worker "+this.name;return this.previous?this.previous+" -> "+c:c}},s.exports=o},{}],29:[function(r,s,a){var o=r("../utils"),c=r("./ConvertWorker"),u=r("./GenericWorker"),d=r("../base64"),h=r("../support"),m=r("../external"),x=null;if(h.nodestream)try{x=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(w,g){return new m.Promise(function(_,b){var N=[],S=w._internalType,E=w._outputType,R=w._mimeType;w.on("data",function(L,O){N.push(L),g&&g(O)}).on("error",function(L){N=[],b(L)}).on("end",function(){try{var L=(function(O,P,F){switch(O){case"blob":return o.newBlob(o.transformTo("arraybuffer",P),F);case"base64":return d.encode(P);default:return o.transformTo(O,P)}})(E,(function(O,P){var F,V=0,oe=null,D=0;for(F=0;F<P.length;F++)D+=P[F].length;switch(O){case"string":return P.join("");case"array":return Array.prototype.concat.apply([],P);case"uint8array":for(oe=new Uint8Array(D),F=0;F<P.length;F++)oe.set(P[F],V),V+=P[F].length;return oe;case"nodebuffer":return Buffer.concat(P);default:throw new Error("concat : unsupported type '"+O+"'")}})(S,N),R);_(L)}catch(O){b(O)}N=[]}).resume()})}function v(w,g,_){var b=g;switch(g){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=g,this._mimeType=_,o.checkSupport(b),this._worker=w.pipe(new c(b)),w.lock()}catch(N){this._worker=new u("error"),this._worker.error(N)}}v.prototype={accumulate:function(w){return y(this,w)},on:function(w,g){var _=this;return w==="data"?this._worker.on(w,function(b){g.call(_,b.data,b.meta)}):this._worker.on(w,function(){o.delay(g,arguments,_)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new x(this,{objectMode:this._outputType!=="nodebuffer"},w)}},s.exports=v},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,s,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var o=new ArrayBuffer(0);try{a.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);c.append(o),a.blob=c.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!r("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(r,s,a){for(var o=r("./utils"),c=r("./support"),u=r("./nodejsUtils"),d=r("./stream/GenericWorker"),h=new Array(256),m=0;m<256;m++)h[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;h[254]=h[254]=1;function x(){d.call(this,"utf-8 decode"),this.leftOver=null}function y(){d.call(this,"utf-8 encode")}a.utf8encode=function(v){return c.nodebuffer?u.newBufferFrom(v,"utf-8"):(function(w){var g,_,b,N,S,E=w.length,R=0;for(N=0;N<E;N++)(64512&(_=w.charCodeAt(N)))==55296&&N+1<E&&(64512&(b=w.charCodeAt(N+1)))==56320&&(_=65536+(_-55296<<10)+(b-56320),N++),R+=_<128?1:_<2048?2:_<65536?3:4;for(g=c.uint8array?new Uint8Array(R):new Array(R),N=S=0;S<R;N++)(64512&(_=w.charCodeAt(N)))==55296&&N+1<E&&(64512&(b=w.charCodeAt(N+1)))==56320&&(_=65536+(_-55296<<10)+(b-56320),N++),_<128?g[S++]=_:(_<2048?g[S++]=192|_>>>6:(_<65536?g[S++]=224|_>>>12:(g[S++]=240|_>>>18,g[S++]=128|_>>>12&63),g[S++]=128|_>>>6&63),g[S++]=128|63&_);return g})(v)},a.utf8decode=function(v){return c.nodebuffer?o.transformTo("nodebuffer",v).toString("utf-8"):(function(w){var g,_,b,N,S=w.length,E=new Array(2*S);for(g=_=0;g<S;)if((b=w[g++])<128)E[_++]=b;else if(4<(N=h[b]))E[_++]=65533,g+=N-1;else{for(b&=N===2?31:N===3?15:7;1<N&&g<S;)b=b<<6|63&w[g++],N--;1<N?E[_++]=65533:b<65536?E[_++]=b:(b-=65536,E[_++]=55296|b>>10&1023,E[_++]=56320|1023&b)}return E.length!==_&&(E.subarray?E=E.subarray(0,_):E.length=_),o.applyFromCharCode(E)})(v=o.transformTo(c.uint8array?"uint8array":"array",v))},o.inherits(x,d),x.prototype.processChunk=function(v){var w=o.transformTo(c.uint8array?"uint8array":"array",v.data);if(this.leftOver&&this.leftOver.length){if(c.uint8array){var g=w;(w=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),w.set(g,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var _=(function(N,S){var E;for((S=S||N.length)>N.length&&(S=N.length),E=S-1;0<=E&&(192&N[E])==128;)E--;return E<0||E===0?S:E+h[N[E]]>S?E:S})(w),b=w;_!==w.length&&(c.uint8array?(b=w.subarray(0,_),this.leftOver=w.subarray(_,w.length)):(b=w.slice(0,_),this.leftOver=w.slice(_,w.length))),this.push({data:a.utf8decode(b),meta:v.meta})},x.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=x,o.inherits(y,d),y.prototype.processChunk=function(v){this.push({data:a.utf8encode(v.data),meta:v.meta})},a.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,s,a){var o=r("./support"),c=r("./base64"),u=r("./nodejsUtils"),d=r("./external");function h(g){return g}function m(g,_){for(var b=0;b<g.length;++b)_[b]=255&g.charCodeAt(b);return _}r("setimmediate"),a.newBlob=function(g,_){a.checkSupport("blob");try{return new Blob([g],{type:_})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(g),b.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};var x={stringifyByChunk:function(g,_,b){var N=[],S=0,E=g.length;if(E<=b)return String.fromCharCode.apply(null,g);for(;S<E;)_==="array"||_==="nodebuffer"?N.push(String.fromCharCode.apply(null,g.slice(S,Math.min(S+b,E)))):N.push(String.fromCharCode.apply(null,g.subarray(S,Math.min(S+b,E)))),S+=b;return N.join("")},stringifyByChar:function(g){for(var _="",b=0;b<g.length;b++)_+=String.fromCharCode(g[b]);return _},applyCanBeUsed:{uint8array:(function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,u.allocBuffer(1)).length===1}catch{return!1}})()}};function y(g){var _=65536,b=a.getTypeOf(g),N=!0;if(b==="uint8array"?N=x.applyCanBeUsed.uint8array:b==="nodebuffer"&&(N=x.applyCanBeUsed.nodebuffer),N)for(;1<_;)try{return x.stringifyByChunk(g,b,_)}catch{_=Math.floor(_/2)}return x.stringifyByChar(g)}function v(g,_){for(var b=0;b<g.length;b++)_[b]=g[b];return _}a.applyFromCharCode=y;var w={};w.string={string:h,array:function(g){return m(g,new Array(g.length))},arraybuffer:function(g){return w.string.uint8array(g).buffer},uint8array:function(g){return m(g,new Uint8Array(g.length))},nodebuffer:function(g){return m(g,u.allocBuffer(g.length))}},w.array={string:y,array:h,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return u.newBufferFrom(g)}},w.arraybuffer={string:function(g){return y(new Uint8Array(g))},array:function(g){return v(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:h,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return u.newBufferFrom(new Uint8Array(g))}},w.uint8array={string:y,array:function(g){return v(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:h,nodebuffer:function(g){return u.newBufferFrom(g)}},w.nodebuffer={string:y,array:function(g){return v(g,new Array(g.length))},arraybuffer:function(g){return w.nodebuffer.uint8array(g).buffer},uint8array:function(g){return v(g,new Uint8Array(g.length))},nodebuffer:h},a.transformTo=function(g,_){if(_=_||"",!g)return _;a.checkSupport(g);var b=a.getTypeOf(_);return w[b][g](_)},a.resolve=function(g){for(var _=g.split("/"),b=[],N=0;N<_.length;N++){var S=_[N];S==="."||S===""&&N!==0&&N!==_.length-1||(S===".."?b.pop():b.push(S))}return b.join("/")},a.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":o.nodebuffer&&u.isBuffer(g)?"nodebuffer":o.uint8array&&g instanceof Uint8Array?"uint8array":o.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(g){if(!o[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(g){var _,b,N="";for(b=0;b<(g||"").length;b++)N+="\\x"+((_=g.charCodeAt(b))<16?"0":"")+_.toString(16).toUpperCase();return N},a.delay=function(g,_,b){setImmediate(function(){g.apply(b||null,_||[])})},a.inherits=function(g,_){function b(){}b.prototype=_.prototype,g.prototype=new b},a.extend=function(){var g,_,b={};for(g=0;g<arguments.length;g++)for(_ in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],_)&&b[_]===void 0&&(b[_]=arguments[g][_]);return b},a.prepareContent=function(g,_,b,N,S){return d.Promise.resolve(_).then(function(E){return o.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new d.Promise(function(R,L){var O=new FileReader;O.onload=function(P){R(P.target.result)},O.onerror=function(P){L(P.target.error)},O.readAsArrayBuffer(E)}):E}).then(function(E){var R=a.getTypeOf(E);return R?(R==="arraybuffer"?E=a.transformTo("uint8array",E):R==="string"&&(S?E=c.decode(E):b&&N!==!0&&(E=(function(L){return m(L,o.uint8array?new Uint8Array(L.length):new Array(L.length))})(E))),E):d.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,s,a){var o=r("./reader/readerFor"),c=r("./utils"),u=r("./signature"),d=r("./zipEntry"),h=r("./support");function m(x){this.files=[],this.loadOptions=x}m.prototype={checkSignature:function(x){if(!this.reader.readAndCheckSignature(x)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+c.pretty(y)+", expected "+c.pretty(x)+")")}},isSignature:function(x,y){var v=this.reader.index;this.reader.setIndex(x);var w=this.reader.readString(4)===y;return this.reader.setIndex(v),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var x=this.reader.readData(this.zipCommentLength),y=h.uint8array?"uint8array":"array",v=c.transformTo(y,x);this.zipComment=this.loadOptions.decodeFileName(v)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var x,y,v,w=this.zip64EndOfCentralSize-44;0<w;)x=this.reader.readInt(2),y=this.reader.readInt(4),v=this.reader.readData(y),this.zip64ExtensibleData[x]={id:x,length:y,value:v}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var x,y;for(x=0;x<this.files.length;x++)y=this.files[x],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var x;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(u.CENTRAL_FILE_HEADER);)(x=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(x);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var x=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if(x<0)throw this.isSignature(0,u.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(x);var y=x;if(this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===c.MAX_VALUE_16BITS||this.diskWithCentralDirStart===c.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===c.MAX_VALUE_16BITS||this.centralDirRecords===c.MAX_VALUE_16BITS||this.centralDirSize===c.MAX_VALUE_32BITS||this.centralDirOffset===c.MAX_VALUE_32BITS){if(this.zip64=!0,(x=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(x),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,u.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var w=y-v;if(0<w)this.isSignature(y,u.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(x){this.reader=o(x)},load:function(x){this.prepareReader(x),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=m},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,s,a){var o=r("./reader/readerFor"),c=r("./utils"),u=r("./compressedObject"),d=r("./crc32"),h=r("./utf8"),m=r("./compressions"),x=r("./support");function y(v,w){this.options=v,this.loadOptions=w}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(v){var w,g;if(v.skip(22),this.fileNameLength=v.readInt(2),g=v.readInt(2),this.fileName=v.readData(this.fileNameLength),v.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=(function(_){for(var b in m)if(Object.prototype.hasOwnProperty.call(m,b)&&m[b].magic===_)return m[b];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+c.pretty(this.compressionMethod)+" unknown (inner file : "+c.transformTo("string",this.fileName)+")");this.decompressed=new u(this.compressedSize,this.uncompressedSize,this.crc32,w,v.readData(this.compressedSize))},readCentralPart:function(v){this.versionMadeBy=v.readInt(2),v.skip(2),this.bitFlag=v.readInt(2),this.compressionMethod=v.readString(2),this.date=v.readDate(),this.crc32=v.readInt(4),this.compressedSize=v.readInt(4),this.uncompressedSize=v.readInt(4);var w=v.readInt(2);if(this.extraFieldsLength=v.readInt(2),this.fileCommentLength=v.readInt(2),this.diskNumberStart=v.readInt(2),this.internalFileAttributes=v.readInt(2),this.externalFileAttributes=v.readInt(4),this.localHeaderOffset=v.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");v.skip(w),this.readExtraFields(v),this.parseZIP64ExtraField(v),this.fileComment=v.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var v=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),v==0&&(this.dosPermissions=63&this.externalFileAttributes),v==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var v=o(this.extraFields[1].value);this.uncompressedSize===c.MAX_VALUE_32BITS&&(this.uncompressedSize=v.readInt(8)),this.compressedSize===c.MAX_VALUE_32BITS&&(this.compressedSize=v.readInt(8)),this.localHeaderOffset===c.MAX_VALUE_32BITS&&(this.localHeaderOffset=v.readInt(8)),this.diskNumberStart===c.MAX_VALUE_32BITS&&(this.diskNumberStart=v.readInt(4))}},readExtraFields:function(v){var w,g,_,b=v.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});v.index+4<b;)w=v.readInt(2),g=v.readInt(2),_=v.readData(g),this.extraFields[w]={id:w,length:g,value:_};v.setIndex(b)},handleUTF8:function(){var v=x.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var g=c.transformTo(v,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var _=this.findExtraFieldUnicodeComment();if(_!==null)this.fileCommentStr=_;else{var b=c.transformTo(v,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var v=this.extraFields[28789];if(v){var w=o(v.value);return w.readInt(1)!==1||d(this.fileName)!==w.readInt(4)?null:h.utf8decode(w.readData(v.length-5))}return null},findExtraFieldUnicodeComment:function(){var v=this.extraFields[25461];if(v){var w=o(v.value);return w.readInt(1)!==1||d(this.fileComment)!==w.readInt(4)?null:h.utf8decode(w.readData(v.length-5))}return null}},s.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,s,a){function o(w,g,_){this.name=w,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=g,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}}var c=r("./stream/StreamHelper"),u=r("./stream/DataWorker"),d=r("./utf8"),h=r("./compressedObject"),m=r("./stream/GenericWorker");o.prototype={internalStream:function(w){var g=null,_="string";try{if(!w)throw new Error("No output type specified.");var b=(_=w.toLowerCase())==="string"||_==="text";_!=="binarystring"&&_!=="text"||(_="string"),g=this._decompressWorker();var N=!this._dataBinary;N&&!b&&(g=g.pipe(new d.Utf8EncodeWorker)),!N&&b&&(g=g.pipe(new d.Utf8DecodeWorker))}catch(S){(g=new m("error")).error(S)}return new c(g,_,"")},async:function(w,g){return this.internalStream(w).accumulate(g)},nodeStream:function(w,g){return this.internalStream(w||"nodebuffer").toNodejsStream(g)},_compressWorker:function(w,g){if(this._data instanceof h&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new d.Utf8EncodeWorker)),h.createWorkerFrom(_,w,g)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof m?this._data:new u(this._data)}};for(var x=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},v=0;v<x.length;v++)o.prototype[x[v]]=y;s.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,s,a){(function(o){var c,u,d=o.MutationObserver||o.WebKitMutationObserver;if(d){var h=0,m=new d(w),x=o.document.createTextNode("");m.observe(x,{characterData:!0}),c=function(){x.data=h=++h%2}}else if(o.setImmediate||o.MessageChannel===void 0)c="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var g=o.document.createElement("script");g.onreadystatechange=function(){w(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},o.document.documentElement.appendChild(g)}:function(){setTimeout(w,0)};else{var y=new o.MessageChannel;y.port1.onmessage=w,c=function(){y.port2.postMessage(0)}}var v=[];function w(){var g,_;u=!0;for(var b=v.length;b;){for(_=v,v=[],g=-1;++g<b;)_[g]();b=v.length}u=!1}s.exports=function(g){v.push(g)!==1||u||c()}}).call(this,typeof Mn<"u"?Mn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,s,a){var o=r("immediate");function c(){}var u={},d=["REJECTED"],h=["FULFILLED"],m=["PENDING"];function x(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,b!==c&&g(this,b)}function y(b,N,S){this.promise=b,typeof N=="function"&&(this.onFulfilled=N,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function v(b,N,S){o(function(){var E;try{E=N(S)}catch(R){return u.reject(b,R)}E===b?u.reject(b,new TypeError("Cannot resolve promise with itself")):u.resolve(b,E)})}function w(b){var N=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof N=="function")return function(){N.apply(b,arguments)}}function g(b,N){var S=!1;function E(O){S||(S=!0,u.reject(b,O))}function R(O){S||(S=!0,u.resolve(b,O))}var L=_(function(){N(R,E)});L.status==="error"&&E(L.value)}function _(b,N){var S={};try{S.value=b(N),S.status="success"}catch(E){S.status="error",S.value=E}return S}(s.exports=x).prototype.finally=function(b){if(typeof b!="function")return this;var N=this.constructor;return this.then(function(S){return N.resolve(b()).then(function(){return S})},function(S){return N.resolve(b()).then(function(){throw S})})},x.prototype.catch=function(b){return this.then(null,b)},x.prototype.then=function(b,N){if(typeof b!="function"&&this.state===h||typeof N!="function"&&this.state===d)return this;var S=new this.constructor(c);return this.state!==m?v(S,this.state===h?b:N,this.outcome):this.queue.push(new y(S,b,N)),S},y.prototype.callFulfilled=function(b){u.resolve(this.promise,b)},y.prototype.otherCallFulfilled=function(b){v(this.promise,this.onFulfilled,b)},y.prototype.callRejected=function(b){u.reject(this.promise,b)},y.prototype.otherCallRejected=function(b){v(this.promise,this.onRejected,b)},u.resolve=function(b,N){var S=_(w,N);if(S.status==="error")return u.reject(b,S.value);var E=S.value;if(E)g(b,E);else{b.state=h,b.outcome=N;for(var R=-1,L=b.queue.length;++R<L;)b.queue[R].callFulfilled(N)}return b},u.reject=function(b,N){b.state=d,b.outcome=N;for(var S=-1,E=b.queue.length;++S<E;)b.queue[S].callRejected(N);return b},x.resolve=function(b){return b instanceof this?b:u.resolve(new this(c),b)},x.reject=function(b){var N=new this(c);return u.reject(N,b)},x.all=function(b){var N=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=b.length,E=!1;if(!S)return this.resolve([]);for(var R=new Array(S),L=0,O=-1,P=new this(c);++O<S;)F(b[O],O);return P;function F(V,oe){N.resolve(V).then(function(D){R[oe]=D,++L!==S||E||(E=!0,u.resolve(P,R))},function(D){E||(E=!0,u.reject(P,D))})}},x.race=function(b){var N=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=b.length,E=!1;if(!S)return this.resolve([]);for(var R=-1,L=new this(c);++R<S;)O=b[R],N.resolve(O).then(function(P){E||(E=!0,u.resolve(L,P))},function(P){E||(E=!0,u.reject(L,P))});var O;return L}},{immediate:36}],38:[function(r,s,a){var o={};(0,r("./lib/utils/common").assign)(o,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),s.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,s,a){var o=r("./zlib/deflate"),c=r("./utils/common"),u=r("./utils/strings"),d=r("./zlib/messages"),h=r("./zlib/zstream"),m=Object.prototype.toString,x=0,y=-1,v=0,w=8;function g(b){if(!(this instanceof g))return new g(b);this.options=c.assign({level:y,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},b||{});var N=this.options;N.raw&&0<N.windowBits?N.windowBits=-N.windowBits:N.gzip&&0<N.windowBits&&N.windowBits<16&&(N.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var S=o.deflateInit2(this.strm,N.level,N.method,N.windowBits,N.memLevel,N.strategy);if(S!==x)throw new Error(d[S]);if(N.header&&o.deflateSetHeader(this.strm,N.header),N.dictionary){var E;if(E=typeof N.dictionary=="string"?u.string2buf(N.dictionary):m.call(N.dictionary)==="[object ArrayBuffer]"?new Uint8Array(N.dictionary):N.dictionary,(S=o.deflateSetDictionary(this.strm,E))!==x)throw new Error(d[S]);this._dict_set=!0}}function _(b,N){var S=new g(N);if(S.push(b,!0),S.err)throw S.msg||d[S.err];return S.result}g.prototype.push=function(b,N){var S,E,R=this.strm,L=this.options.chunkSize;if(this.ended)return!1;E=N===~~N?N:N===!0?4:0,typeof b=="string"?R.input=u.string2buf(b):m.call(b)==="[object ArrayBuffer]"?R.input=new Uint8Array(b):R.input=b,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new c.Buf8(L),R.next_out=0,R.avail_out=L),(S=o.deflate(R,E))!==1&&S!==x)return this.onEnd(S),!(this.ended=!0);R.avail_out!==0&&(R.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(u.buf2binstring(c.shrinkBuf(R.output,R.next_out))):this.onData(c.shrinkBuf(R.output,R.next_out)))}while((0<R.avail_in||R.avail_out===0)&&S!==1);return E===4?(S=o.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===x):E!==2||(this.onEnd(x),!(R.avail_out=0))},g.prototype.onData=function(b){this.chunks.push(b)},g.prototype.onEnd=function(b){b===x&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},a.Deflate=g,a.deflate=_,a.deflateRaw=function(b,N){return(N=N||{}).raw=!0,_(b,N)},a.gzip=function(b,N){return(N=N||{}).gzip=!0,_(b,N)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,s,a){var o=r("./zlib/inflate"),c=r("./utils/common"),u=r("./utils/strings"),d=r("./zlib/constants"),h=r("./zlib/messages"),m=r("./zlib/zstream"),x=r("./zlib/gzheader"),y=Object.prototype.toString;function v(g){if(!(this instanceof v))return new v(g);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},g||{});var _=this.options;_.raw&&0<=_.windowBits&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),!(0<=_.windowBits&&_.windowBits<16)||g&&g.windowBits||(_.windowBits+=32),15<_.windowBits&&_.windowBits<48&&(15&_.windowBits)==0&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var b=o.inflateInit2(this.strm,_.windowBits);if(b!==d.Z_OK)throw new Error(h[b]);this.header=new x,o.inflateGetHeader(this.strm,this.header)}function w(g,_){var b=new v(_);if(b.push(g,!0),b.err)throw b.msg||h[b.err];return b.result}v.prototype.push=function(g,_){var b,N,S,E,R,L,O=this.strm,P=this.options.chunkSize,F=this.options.dictionary,V=!1;if(this.ended)return!1;N=_===~~_?_:_===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof g=="string"?O.input=u.binstring2buf(g):y.call(g)==="[object ArrayBuffer]"?O.input=new Uint8Array(g):O.input=g,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new c.Buf8(P),O.next_out=0,O.avail_out=P),(b=o.inflate(O,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&F&&(L=typeof F=="string"?u.string2buf(F):y.call(F)==="[object ArrayBuffer]"?new Uint8Array(F):F,b=o.inflateSetDictionary(this.strm,L)),b===d.Z_BUF_ERROR&&V===!0&&(b=d.Z_OK,V=!1),b!==d.Z_STREAM_END&&b!==d.Z_OK)return this.onEnd(b),!(this.ended=!0);O.next_out&&(O.avail_out!==0&&b!==d.Z_STREAM_END&&(O.avail_in!==0||N!==d.Z_FINISH&&N!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=u.utf8border(O.output,O.next_out),E=O.next_out-S,R=u.buf2string(O.output,S),O.next_out=E,O.avail_out=P-E,E&&c.arraySet(O.output,O.output,S,E,0),this.onData(R)):this.onData(c.shrinkBuf(O.output,O.next_out)))),O.avail_in===0&&O.avail_out===0&&(V=!0)}while((0<O.avail_in||O.avail_out===0)&&b!==d.Z_STREAM_END);return b===d.Z_STREAM_END&&(N=d.Z_FINISH),N===d.Z_FINISH?(b=o.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===d.Z_OK):N!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(O.avail_out=0))},v.prototype.onData=function(g){this.chunks.push(g)},v.prototype.onEnd=function(g){g===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},a.Inflate=v,a.inflate=w,a.inflateRaw=function(g,_){return(_=_||{}).raw=!0,w(g,_)},a.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,s,a){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(d){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var m=h.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var x in m)m.hasOwnProperty(x)&&(d[x]=m[x])}}return d},a.shrinkBuf=function(d,h){return d.length===h?d:d.subarray?d.subarray(0,h):(d.length=h,d)};var c={arraySet:function(d,h,m,x,y){if(h.subarray&&d.subarray)d.set(h.subarray(m,m+x),y);else for(var v=0;v<x;v++)d[y+v]=h[m+v]},flattenChunks:function(d){var h,m,x,y,v,w;for(h=x=0,m=d.length;h<m;h++)x+=d[h].length;for(w=new Uint8Array(x),h=y=0,m=d.length;h<m;h++)v=d[h],w.set(v,y),y+=v.length;return w}},u={arraySet:function(d,h,m,x,y){for(var v=0;v<x;v++)d[y+v]=h[m+v]},flattenChunks:function(d){return[].concat.apply([],d)}};a.setTyped=function(d){d?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,c)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,u))},a.setTyped(o)},{}],42:[function(r,s,a){var o=r("./common"),c=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{c=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var d=new o.Buf8(256),h=0;h<256;h++)d[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function m(x,y){if(y<65537&&(x.subarray&&u||!x.subarray&&c))return String.fromCharCode.apply(null,o.shrinkBuf(x,y));for(var v="",w=0;w<y;w++)v+=String.fromCharCode(x[w]);return v}d[254]=d[254]=1,a.string2buf=function(x){var y,v,w,g,_,b=x.length,N=0;for(g=0;g<b;g++)(64512&(v=x.charCodeAt(g)))==55296&&g+1<b&&(64512&(w=x.charCodeAt(g+1)))==56320&&(v=65536+(v-55296<<10)+(w-56320),g++),N+=v<128?1:v<2048?2:v<65536?3:4;for(y=new o.Buf8(N),g=_=0;_<N;g++)(64512&(v=x.charCodeAt(g)))==55296&&g+1<b&&(64512&(w=x.charCodeAt(g+1)))==56320&&(v=65536+(v-55296<<10)+(w-56320),g++),v<128?y[_++]=v:(v<2048?y[_++]=192|v>>>6:(v<65536?y[_++]=224|v>>>12:(y[_++]=240|v>>>18,y[_++]=128|v>>>12&63),y[_++]=128|v>>>6&63),y[_++]=128|63&v);return y},a.buf2binstring=function(x){return m(x,x.length)},a.binstring2buf=function(x){for(var y=new o.Buf8(x.length),v=0,w=y.length;v<w;v++)y[v]=x.charCodeAt(v);return y},a.buf2string=function(x,y){var v,w,g,_,b=y||x.length,N=new Array(2*b);for(v=w=0;v<b;)if((g=x[v++])<128)N[w++]=g;else if(4<(_=d[g]))N[w++]=65533,v+=_-1;else{for(g&=_===2?31:_===3?15:7;1<_&&v<b;)g=g<<6|63&x[v++],_--;1<_?N[w++]=65533:g<65536?N[w++]=g:(g-=65536,N[w++]=55296|g>>10&1023,N[w++]=56320|1023&g)}return m(N,w)},a.utf8border=function(x,y){var v;for((y=y||x.length)>x.length&&(y=x.length),v=y-1;0<=v&&(192&x[v])==128;)v--;return v<0||v===0?y:v+d[x[v]]>y?v:y}},{"./common":41}],43:[function(r,s,a){s.exports=function(o,c,u,d){for(var h=65535&o|0,m=o>>>16&65535|0,x=0;u!==0;){for(u-=x=2e3<u?2e3:u;m=m+(h=h+c[d++]|0)|0,--x;);h%=65521,m%=65521}return h|m<<16|0}},{}],44:[function(r,s,a){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,s,a){var o=(function(){for(var c,u=[],d=0;d<256;d++){c=d;for(var h=0;h<8;h++)c=1&c?3988292384^c>>>1:c>>>1;u[d]=c}return u})();s.exports=function(c,u,d,h){var m=o,x=h+d;c^=-1;for(var y=h;y<x;y++)c=c>>>8^m[255&(c^u[y])];return-1^c}},{}],46:[function(r,s,a){var o,c=r("../utils/common"),u=r("./trees"),d=r("./adler32"),h=r("./crc32"),m=r("./messages"),x=0,y=4,v=0,w=-2,g=-1,_=4,b=2,N=8,S=9,E=286,R=30,L=19,O=2*E+1,P=15,F=3,V=258,oe=V+F+1,D=42,K=113,M=1,ae=2,te=3,Z=4;function we(k,de){return k.msg=m[de],de}function ee(k){return(k<<1)-(4<k?9:0)}function Ne(k){for(var de=k.length;0<=--de;)k[de]=0}function q(k){var de=k.state,U=de.pending;U>k.avail_out&&(U=k.avail_out),U!==0&&(c.arraySet(k.output,de.pending_buf,de.pending_out,U,k.next_out),k.next_out+=U,de.pending_out+=U,k.total_out+=U,k.avail_out-=U,de.pending-=U,de.pending===0&&(de.pending_out=0))}function I(k,de){u._tr_flush_block(k,0<=k.block_start?k.block_start:-1,k.strstart-k.block_start,de),k.block_start=k.strstart,q(k.strm)}function X(k,de){k.pending_buf[k.pending++]=de}function H(k,de){k.pending_buf[k.pending++]=de>>>8&255,k.pending_buf[k.pending++]=255&de}function Q(k,de){var U,T,A=k.max_chain_length,G=k.strstart,xe=k.prev_length,be=k.nice_match,ne=k.strstart>k.w_size-oe?k.strstart-(k.w_size-oe):0,je=k.window,Me=k.w_mask,De=k.prev,Ce=k.strstart+V,st=je[G+xe-1],We=je[G+xe];k.prev_length>=k.good_match&&(A>>=2),be>k.lookahead&&(be=k.lookahead);do if(je[(U=de)+xe]===We&&je[U+xe-1]===st&&je[U]===je[G]&&je[++U]===je[G+1]){G+=2,U++;do;while(je[++G]===je[++U]&&je[++G]===je[++U]&&je[++G]===je[++U]&&je[++G]===je[++U]&&je[++G]===je[++U]&&je[++G]===je[++U]&&je[++G]===je[++U]&&je[++G]===je[++U]&&G<Ce);if(T=V-(Ce-G),G=Ce-V,xe<T){if(k.match_start=de,be<=(xe=T))break;st=je[G+xe-1],We=je[G+xe]}}while((de=De[de&Me])>ne&&--A!=0);return xe<=k.lookahead?xe:k.lookahead}function ie(k){var de,U,T,A,G,xe,be,ne,je,Me,De=k.w_size;do{if(A=k.window_size-k.lookahead-k.strstart,k.strstart>=De+(De-oe)){for(c.arraySet(k.window,k.window,De,De,0),k.match_start-=De,k.strstart-=De,k.block_start-=De,de=U=k.hash_size;T=k.head[--de],k.head[de]=De<=T?T-De:0,--U;);for(de=U=De;T=k.prev[--de],k.prev[de]=De<=T?T-De:0,--U;);A+=De}if(k.strm.avail_in===0)break;if(xe=k.strm,be=k.window,ne=k.strstart+k.lookahead,je=A,Me=void 0,Me=xe.avail_in,je<Me&&(Me=je),U=Me===0?0:(xe.avail_in-=Me,c.arraySet(be,xe.input,xe.next_in,Me,ne),xe.state.wrap===1?xe.adler=d(xe.adler,be,Me,ne):xe.state.wrap===2&&(xe.adler=h(xe.adler,be,Me,ne)),xe.next_in+=Me,xe.total_in+=Me,Me),k.lookahead+=U,k.lookahead+k.insert>=F)for(G=k.strstart-k.insert,k.ins_h=k.window[G],k.ins_h=(k.ins_h<<k.hash_shift^k.window[G+1])&k.hash_mask;k.insert&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[G+F-1])&k.hash_mask,k.prev[G&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=G,G++,k.insert--,!(k.lookahead+k.insert<F)););}while(k.lookahead<oe&&k.strm.avail_in!==0)}function B(k,de){for(var U,T;;){if(k.lookahead<oe){if(ie(k),k.lookahead<oe&&de===x)return M;if(k.lookahead===0)break}if(U=0,k.lookahead>=F&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,U=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),U!==0&&k.strstart-U<=k.w_size-oe&&(k.match_length=Q(k,U)),k.match_length>=F)if(T=u._tr_tally(k,k.strstart-k.match_start,k.match_length-F),k.lookahead-=k.match_length,k.match_length<=k.max_lazy_match&&k.lookahead>=F){for(k.match_length--;k.strstart++,k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,U=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart,--k.match_length!=0;);k.strstart++}else k.strstart+=k.match_length,k.match_length=0,k.ins_h=k.window[k.strstart],k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+1])&k.hash_mask;else T=u._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++;if(T&&(I(k,!1),k.strm.avail_out===0))return M}return k.insert=k.strstart<F-1?k.strstart:F-1,de===y?(I(k,!0),k.strm.avail_out===0?te:Z):k.last_lit&&(I(k,!1),k.strm.avail_out===0)?M:ae}function z(k,de){for(var U,T,A;;){if(k.lookahead<oe){if(ie(k),k.lookahead<oe&&de===x)return M;if(k.lookahead===0)break}if(U=0,k.lookahead>=F&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,U=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),k.prev_length=k.match_length,k.prev_match=k.match_start,k.match_length=F-1,U!==0&&k.prev_length<k.max_lazy_match&&k.strstart-U<=k.w_size-oe&&(k.match_length=Q(k,U),k.match_length<=5&&(k.strategy===1||k.match_length===F&&4096<k.strstart-k.match_start)&&(k.match_length=F-1)),k.prev_length>=F&&k.match_length<=k.prev_length){for(A=k.strstart+k.lookahead-F,T=u._tr_tally(k,k.strstart-1-k.prev_match,k.prev_length-F),k.lookahead-=k.prev_length-1,k.prev_length-=2;++k.strstart<=A&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,U=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),--k.prev_length!=0;);if(k.match_available=0,k.match_length=F-1,k.strstart++,T&&(I(k,!1),k.strm.avail_out===0))return M}else if(k.match_available){if((T=u._tr_tally(k,0,k.window[k.strstart-1]))&&I(k,!1),k.strstart++,k.lookahead--,k.strm.avail_out===0)return M}else k.match_available=1,k.strstart++,k.lookahead--}return k.match_available&&(T=u._tr_tally(k,0,k.window[k.strstart-1]),k.match_available=0),k.insert=k.strstart<F-1?k.strstart:F-1,de===y?(I(k,!0),k.strm.avail_out===0?te:Z):k.last_lit&&(I(k,!1),k.strm.avail_out===0)?M:ae}function ue(k,de,U,T,A){this.good_length=k,this.max_lazy=de,this.nice_length=U,this.max_chain=T,this.func=A}function se(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=N,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new c.Buf16(2*O),this.dyn_dtree=new c.Buf16(2*(2*R+1)),this.bl_tree=new c.Buf16(2*(2*L+1)),Ne(this.dyn_ltree),Ne(this.dyn_dtree),Ne(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new c.Buf16(P+1),this.heap=new c.Buf16(2*E+1),Ne(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new c.Buf16(2*E+1),Ne(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function re(k){var de;return k&&k.state?(k.total_in=k.total_out=0,k.data_type=b,(de=k.state).pending=0,de.pending_out=0,de.wrap<0&&(de.wrap=-de.wrap),de.status=de.wrap?D:K,k.adler=de.wrap===2?0:1,de.last_flush=x,u._tr_init(de),v):we(k,w)}function W(k){var de=re(k);return de===v&&(function(U){U.window_size=2*U.w_size,Ne(U.head),U.max_lazy_match=o[U.level].max_lazy,U.good_match=o[U.level].good_length,U.nice_match=o[U.level].nice_length,U.max_chain_length=o[U.level].max_chain,U.strstart=0,U.block_start=0,U.lookahead=0,U.insert=0,U.match_length=U.prev_length=F-1,U.match_available=0,U.ins_h=0})(k.state),de}function ce(k,de,U,T,A,G){if(!k)return w;var xe=1;if(de===g&&(de=6),T<0?(xe=0,T=-T):15<T&&(xe=2,T-=16),A<1||S<A||U!==N||T<8||15<T||de<0||9<de||G<0||_<G)return we(k,w);T===8&&(T=9);var be=new se;return(k.state=be).strm=k,be.wrap=xe,be.gzhead=null,be.w_bits=T,be.w_size=1<<be.w_bits,be.w_mask=be.w_size-1,be.hash_bits=A+7,be.hash_size=1<<be.hash_bits,be.hash_mask=be.hash_size-1,be.hash_shift=~~((be.hash_bits+F-1)/F),be.window=new c.Buf8(2*be.w_size),be.head=new c.Buf16(be.hash_size),be.prev=new c.Buf16(be.w_size),be.lit_bufsize=1<<A+6,be.pending_buf_size=4*be.lit_bufsize,be.pending_buf=new c.Buf8(be.pending_buf_size),be.d_buf=1*be.lit_bufsize,be.l_buf=3*be.lit_bufsize,be.level=de,be.strategy=G,be.method=U,W(k)}o=[new ue(0,0,0,0,function(k,de){var U=65535;for(U>k.pending_buf_size-5&&(U=k.pending_buf_size-5);;){if(k.lookahead<=1){if(ie(k),k.lookahead===0&&de===x)return M;if(k.lookahead===0)break}k.strstart+=k.lookahead,k.lookahead=0;var T=k.block_start+U;if((k.strstart===0||k.strstart>=T)&&(k.lookahead=k.strstart-T,k.strstart=T,I(k,!1),k.strm.avail_out===0)||k.strstart-k.block_start>=k.w_size-oe&&(I(k,!1),k.strm.avail_out===0))return M}return k.insert=0,de===y?(I(k,!0),k.strm.avail_out===0?te:Z):(k.strstart>k.block_start&&(I(k,!1),k.strm.avail_out),M)}),new ue(4,4,8,4,B),new ue(4,5,16,8,B),new ue(4,6,32,32,B),new ue(4,4,16,16,z),new ue(8,16,32,32,z),new ue(8,16,128,128,z),new ue(8,32,128,256,z),new ue(32,128,258,1024,z),new ue(32,258,258,4096,z)],a.deflateInit=function(k,de){return ce(k,de,N,15,8,0)},a.deflateInit2=ce,a.deflateReset=W,a.deflateResetKeep=re,a.deflateSetHeader=function(k,de){return k&&k.state?k.state.wrap!==2?w:(k.state.gzhead=de,v):w},a.deflate=function(k,de){var U,T,A,G;if(!k||!k.state||5<de||de<0)return k?we(k,w):w;if(T=k.state,!k.output||!k.input&&k.avail_in!==0||T.status===666&&de!==y)return we(k,k.avail_out===0?-5:w);if(T.strm=k,U=T.last_flush,T.last_flush=de,T.status===D)if(T.wrap===2)k.adler=0,X(T,31),X(T,139),X(T,8),T.gzhead?(X(T,(T.gzhead.text?1:0)+(T.gzhead.hcrc?2:0)+(T.gzhead.extra?4:0)+(T.gzhead.name?8:0)+(T.gzhead.comment?16:0)),X(T,255&T.gzhead.time),X(T,T.gzhead.time>>8&255),X(T,T.gzhead.time>>16&255),X(T,T.gzhead.time>>24&255),X(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),X(T,255&T.gzhead.os),T.gzhead.extra&&T.gzhead.extra.length&&(X(T,255&T.gzhead.extra.length),X(T,T.gzhead.extra.length>>8&255)),T.gzhead.hcrc&&(k.adler=h(k.adler,T.pending_buf,T.pending,0)),T.gzindex=0,T.status=69):(X(T,0),X(T,0),X(T,0),X(T,0),X(T,0),X(T,T.level===9?2:2<=T.strategy||T.level<2?4:0),X(T,3),T.status=K);else{var xe=N+(T.w_bits-8<<4)<<8;xe|=(2<=T.strategy||T.level<2?0:T.level<6?1:T.level===6?2:3)<<6,T.strstart!==0&&(xe|=32),xe+=31-xe%31,T.status=K,H(T,xe),T.strstart!==0&&(H(T,k.adler>>>16),H(T,65535&k.adler)),k.adler=1}if(T.status===69)if(T.gzhead.extra){for(A=T.pending;T.gzindex<(65535&T.gzhead.extra.length)&&(T.pending!==T.pending_buf_size||(T.gzhead.hcrc&&T.pending>A&&(k.adler=h(k.adler,T.pending_buf,T.pending-A,A)),q(k),A=T.pending,T.pending!==T.pending_buf_size));)X(T,255&T.gzhead.extra[T.gzindex]),T.gzindex++;T.gzhead.hcrc&&T.pending>A&&(k.adler=h(k.adler,T.pending_buf,T.pending-A,A)),T.gzindex===T.gzhead.extra.length&&(T.gzindex=0,T.status=73)}else T.status=73;if(T.status===73)if(T.gzhead.name){A=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>A&&(k.adler=h(k.adler,T.pending_buf,T.pending-A,A)),q(k),A=T.pending,T.pending===T.pending_buf_size)){G=1;break}G=T.gzindex<T.gzhead.name.length?255&T.gzhead.name.charCodeAt(T.gzindex++):0,X(T,G)}while(G!==0);T.gzhead.hcrc&&T.pending>A&&(k.adler=h(k.adler,T.pending_buf,T.pending-A,A)),G===0&&(T.gzindex=0,T.status=91)}else T.status=91;if(T.status===91)if(T.gzhead.comment){A=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>A&&(k.adler=h(k.adler,T.pending_buf,T.pending-A,A)),q(k),A=T.pending,T.pending===T.pending_buf_size)){G=1;break}G=T.gzindex<T.gzhead.comment.length?255&T.gzhead.comment.charCodeAt(T.gzindex++):0,X(T,G)}while(G!==0);T.gzhead.hcrc&&T.pending>A&&(k.adler=h(k.adler,T.pending_buf,T.pending-A,A)),G===0&&(T.status=103)}else T.status=103;if(T.status===103&&(T.gzhead.hcrc?(T.pending+2>T.pending_buf_size&&q(k),T.pending+2<=T.pending_buf_size&&(X(T,255&k.adler),X(T,k.adler>>8&255),k.adler=0,T.status=K)):T.status=K),T.pending!==0){if(q(k),k.avail_out===0)return T.last_flush=-1,v}else if(k.avail_in===0&&ee(de)<=ee(U)&&de!==y)return we(k,-5);if(T.status===666&&k.avail_in!==0)return we(k,-5);if(k.avail_in!==0||T.lookahead!==0||de!==x&&T.status!==666){var be=T.strategy===2?(function(ne,je){for(var Me;;){if(ne.lookahead===0&&(ie(ne),ne.lookahead===0)){if(je===x)return M;break}if(ne.match_length=0,Me=u._tr_tally(ne,0,ne.window[ne.strstart]),ne.lookahead--,ne.strstart++,Me&&(I(ne,!1),ne.strm.avail_out===0))return M}return ne.insert=0,je===y?(I(ne,!0),ne.strm.avail_out===0?te:Z):ne.last_lit&&(I(ne,!1),ne.strm.avail_out===0)?M:ae})(T,de):T.strategy===3?(function(ne,je){for(var Me,De,Ce,st,We=ne.window;;){if(ne.lookahead<=V){if(ie(ne),ne.lookahead<=V&&je===x)return M;if(ne.lookahead===0)break}if(ne.match_length=0,ne.lookahead>=F&&0<ne.strstart&&(De=We[Ce=ne.strstart-1])===We[++Ce]&&De===We[++Ce]&&De===We[++Ce]){st=ne.strstart+V;do;while(De===We[++Ce]&&De===We[++Ce]&&De===We[++Ce]&&De===We[++Ce]&&De===We[++Ce]&&De===We[++Ce]&&De===We[++Ce]&&De===We[++Ce]&&Ce<st);ne.match_length=V-(st-Ce),ne.match_length>ne.lookahead&&(ne.match_length=ne.lookahead)}if(ne.match_length>=F?(Me=u._tr_tally(ne,1,ne.match_length-F),ne.lookahead-=ne.match_length,ne.strstart+=ne.match_length,ne.match_length=0):(Me=u._tr_tally(ne,0,ne.window[ne.strstart]),ne.lookahead--,ne.strstart++),Me&&(I(ne,!1),ne.strm.avail_out===0))return M}return ne.insert=0,je===y?(I(ne,!0),ne.strm.avail_out===0?te:Z):ne.last_lit&&(I(ne,!1),ne.strm.avail_out===0)?M:ae})(T,de):o[T.level].func(T,de);if(be!==te&&be!==Z||(T.status=666),be===M||be===te)return k.avail_out===0&&(T.last_flush=-1),v;if(be===ae&&(de===1?u._tr_align(T):de!==5&&(u._tr_stored_block(T,0,0,!1),de===3&&(Ne(T.head),T.lookahead===0&&(T.strstart=0,T.block_start=0,T.insert=0))),q(k),k.avail_out===0))return T.last_flush=-1,v}return de!==y?v:T.wrap<=0?1:(T.wrap===2?(X(T,255&k.adler),X(T,k.adler>>8&255),X(T,k.adler>>16&255),X(T,k.adler>>24&255),X(T,255&k.total_in),X(T,k.total_in>>8&255),X(T,k.total_in>>16&255),X(T,k.total_in>>24&255)):(H(T,k.adler>>>16),H(T,65535&k.adler)),q(k),0<T.wrap&&(T.wrap=-T.wrap),T.pending!==0?v:1)},a.deflateEnd=function(k){var de;return k&&k.state?(de=k.state.status)!==D&&de!==69&&de!==73&&de!==91&&de!==103&&de!==K&&de!==666?we(k,w):(k.state=null,de===K?we(k,-3):v):w},a.deflateSetDictionary=function(k,de){var U,T,A,G,xe,be,ne,je,Me=de.length;if(!k||!k.state||(G=(U=k.state).wrap)===2||G===1&&U.status!==D||U.lookahead)return w;for(G===1&&(k.adler=d(k.adler,de,Me,0)),U.wrap=0,Me>=U.w_size&&(G===0&&(Ne(U.head),U.strstart=0,U.block_start=0,U.insert=0),je=new c.Buf8(U.w_size),c.arraySet(je,de,Me-U.w_size,U.w_size,0),de=je,Me=U.w_size),xe=k.avail_in,be=k.next_in,ne=k.input,k.avail_in=Me,k.next_in=0,k.input=de,ie(U);U.lookahead>=F;){for(T=U.strstart,A=U.lookahead-(F-1);U.ins_h=(U.ins_h<<U.hash_shift^U.window[T+F-1])&U.hash_mask,U.prev[T&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=T,T++,--A;);U.strstart=T,U.lookahead=F-1,ie(U)}return U.strstart+=U.lookahead,U.block_start=U.strstart,U.insert=U.lookahead,U.lookahead=0,U.match_length=U.prev_length=F-1,U.match_available=0,k.next_in=be,k.input=ne,k.avail_in=xe,U.wrap=G,v},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,s,a){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,s,a){s.exports=function(o,c){var u,d,h,m,x,y,v,w,g,_,b,N,S,E,R,L,O,P,F,V,oe,D,K,M,ae;u=o.state,d=o.next_in,M=o.input,h=d+(o.avail_in-5),m=o.next_out,ae=o.output,x=m-(c-o.avail_out),y=m+(o.avail_out-257),v=u.dmax,w=u.wsize,g=u.whave,_=u.wnext,b=u.window,N=u.hold,S=u.bits,E=u.lencode,R=u.distcode,L=(1<<u.lenbits)-1,O=(1<<u.distbits)-1;e:do{S<15&&(N+=M[d++]<<S,S+=8,N+=M[d++]<<S,S+=8),P=E[N&L];t:for(;;){if(N>>>=F=P>>>24,S-=F,(F=P>>>16&255)===0)ae[m++]=65535&P;else{if(!(16&F)){if((64&F)==0){P=E[(65535&P)+(N&(1<<F)-1)];continue t}if(32&F){u.mode=12;break e}o.msg="invalid literal/length code",u.mode=30;break e}V=65535&P,(F&=15)&&(S<F&&(N+=M[d++]<<S,S+=8),V+=N&(1<<F)-1,N>>>=F,S-=F),S<15&&(N+=M[d++]<<S,S+=8,N+=M[d++]<<S,S+=8),P=R[N&O];r:for(;;){if(N>>>=F=P>>>24,S-=F,!(16&(F=P>>>16&255))){if((64&F)==0){P=R[(65535&P)+(N&(1<<F)-1)];continue r}o.msg="invalid distance code",u.mode=30;break e}if(oe=65535&P,S<(F&=15)&&(N+=M[d++]<<S,(S+=8)<F&&(N+=M[d++]<<S,S+=8)),v<(oe+=N&(1<<F)-1)){o.msg="invalid distance too far back",u.mode=30;break e}if(N>>>=F,S-=F,(F=m-x)<oe){if(g<(F=oe-F)&&u.sane){o.msg="invalid distance too far back",u.mode=30;break e}if(K=b,(D=0)===_){if(D+=w-F,F<V){for(V-=F;ae[m++]=b[D++],--F;);D=m-oe,K=ae}}else if(_<F){if(D+=w+_-F,(F-=_)<V){for(V-=F;ae[m++]=b[D++],--F;);if(D=0,_<V){for(V-=F=_;ae[m++]=b[D++],--F;);D=m-oe,K=ae}}}else if(D+=_-F,F<V){for(V-=F;ae[m++]=b[D++],--F;);D=m-oe,K=ae}for(;2<V;)ae[m++]=K[D++],ae[m++]=K[D++],ae[m++]=K[D++],V-=3;V&&(ae[m++]=K[D++],1<V&&(ae[m++]=K[D++]))}else{for(D=m-oe;ae[m++]=ae[D++],ae[m++]=ae[D++],ae[m++]=ae[D++],2<(V-=3););V&&(ae[m++]=ae[D++],1<V&&(ae[m++]=ae[D++]))}break}}break}}while(d<h&&m<y);d-=V=S>>3,N&=(1<<(S-=V<<3))-1,o.next_in=d,o.next_out=m,o.avail_in=d<h?h-d+5:5-(d-h),o.avail_out=m<y?y-m+257:257-(m-y),u.hold=N,u.bits=S}},{}],49:[function(r,s,a){var o=r("../utils/common"),c=r("./adler32"),u=r("./crc32"),d=r("./inffast"),h=r("./inftrees"),m=1,x=2,y=0,v=-2,w=1,g=852,_=592;function b(D){return(D>>>24&255)+(D>>>8&65280)+((65280&D)<<8)+((255&D)<<24)}function N(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(D){var K;return D&&D.state?(K=D.state,D.total_in=D.total_out=K.total=0,D.msg="",K.wrap&&(D.adler=1&K.wrap),K.mode=w,K.last=0,K.havedict=0,K.dmax=32768,K.head=null,K.hold=0,K.bits=0,K.lencode=K.lendyn=new o.Buf32(g),K.distcode=K.distdyn=new o.Buf32(_),K.sane=1,K.back=-1,y):v}function E(D){var K;return D&&D.state?((K=D.state).wsize=0,K.whave=0,K.wnext=0,S(D)):v}function R(D,K){var M,ae;return D&&D.state?(ae=D.state,K<0?(M=0,K=-K):(M=1+(K>>4),K<48&&(K&=15)),K&&(K<8||15<K)?v:(ae.window!==null&&ae.wbits!==K&&(ae.window=null),ae.wrap=M,ae.wbits=K,E(D))):v}function L(D,K){var M,ae;return D?(ae=new N,(D.state=ae).window=null,(M=R(D,K))!==y&&(D.state=null),M):v}var O,P,F=!0;function V(D){if(F){var K;for(O=new o.Buf32(512),P=new o.Buf32(32),K=0;K<144;)D.lens[K++]=8;for(;K<256;)D.lens[K++]=9;for(;K<280;)D.lens[K++]=7;for(;K<288;)D.lens[K++]=8;for(h(m,D.lens,0,288,O,0,D.work,{bits:9}),K=0;K<32;)D.lens[K++]=5;h(x,D.lens,0,32,P,0,D.work,{bits:5}),F=!1}D.lencode=O,D.lenbits=9,D.distcode=P,D.distbits=5}function oe(D,K,M,ae){var te,Z=D.state;return Z.window===null&&(Z.wsize=1<<Z.wbits,Z.wnext=0,Z.whave=0,Z.window=new o.Buf8(Z.wsize)),ae>=Z.wsize?(o.arraySet(Z.window,K,M-Z.wsize,Z.wsize,0),Z.wnext=0,Z.whave=Z.wsize):(ae<(te=Z.wsize-Z.wnext)&&(te=ae),o.arraySet(Z.window,K,M-ae,te,Z.wnext),(ae-=te)?(o.arraySet(Z.window,K,M-ae,ae,0),Z.wnext=ae,Z.whave=Z.wsize):(Z.wnext+=te,Z.wnext===Z.wsize&&(Z.wnext=0),Z.whave<Z.wsize&&(Z.whave+=te))),0}a.inflateReset=E,a.inflateReset2=R,a.inflateResetKeep=S,a.inflateInit=function(D){return L(D,15)},a.inflateInit2=L,a.inflate=function(D,K){var M,ae,te,Z,we,ee,Ne,q,I,X,H,Q,ie,B,z,ue,se,re,W,ce,k,de,U,T,A=0,G=new o.Buf8(4),xe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!D||!D.state||!D.output||!D.input&&D.avail_in!==0)return v;(M=D.state).mode===12&&(M.mode=13),we=D.next_out,te=D.output,Ne=D.avail_out,Z=D.next_in,ae=D.input,ee=D.avail_in,q=M.hold,I=M.bits,X=ee,H=Ne,de=y;e:for(;;)switch(M.mode){case w:if(M.wrap===0){M.mode=13;break}for(;I<16;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}if(2&M.wrap&&q===35615){G[M.check=0]=255&q,G[1]=q>>>8&255,M.check=u(M.check,G,2,0),I=q=0,M.mode=2;break}if(M.flags=0,M.head&&(M.head.done=!1),!(1&M.wrap)||(((255&q)<<8)+(q>>8))%31){D.msg="incorrect header check",M.mode=30;break}if((15&q)!=8){D.msg="unknown compression method",M.mode=30;break}if(I-=4,k=8+(15&(q>>>=4)),M.wbits===0)M.wbits=k;else if(k>M.wbits){D.msg="invalid window size",M.mode=30;break}M.dmax=1<<k,D.adler=M.check=1,M.mode=512&q?10:12,I=q=0;break;case 2:for(;I<16;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}if(M.flags=q,(255&M.flags)!=8){D.msg="unknown compression method",M.mode=30;break}if(57344&M.flags){D.msg="unknown header flags set",M.mode=30;break}M.head&&(M.head.text=q>>8&1),512&M.flags&&(G[0]=255&q,G[1]=q>>>8&255,M.check=u(M.check,G,2,0)),I=q=0,M.mode=3;case 3:for(;I<32;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}M.head&&(M.head.time=q),512&M.flags&&(G[0]=255&q,G[1]=q>>>8&255,G[2]=q>>>16&255,G[3]=q>>>24&255,M.check=u(M.check,G,4,0)),I=q=0,M.mode=4;case 4:for(;I<16;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}M.head&&(M.head.xflags=255&q,M.head.os=q>>8),512&M.flags&&(G[0]=255&q,G[1]=q>>>8&255,M.check=u(M.check,G,2,0)),I=q=0,M.mode=5;case 5:if(1024&M.flags){for(;I<16;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}M.length=q,M.head&&(M.head.extra_len=q),512&M.flags&&(G[0]=255&q,G[1]=q>>>8&255,M.check=u(M.check,G,2,0)),I=q=0}else M.head&&(M.head.extra=null);M.mode=6;case 6:if(1024&M.flags&&(ee<(Q=M.length)&&(Q=ee),Q&&(M.head&&(k=M.head.extra_len-M.length,M.head.extra||(M.head.extra=new Array(M.head.extra_len)),o.arraySet(M.head.extra,ae,Z,Q,k)),512&M.flags&&(M.check=u(M.check,ae,Q,Z)),ee-=Q,Z+=Q,M.length-=Q),M.length))break e;M.length=0,M.mode=7;case 7:if(2048&M.flags){if(ee===0)break e;for(Q=0;k=ae[Z+Q++],M.head&&k&&M.length<65536&&(M.head.name+=String.fromCharCode(k)),k&&Q<ee;);if(512&M.flags&&(M.check=u(M.check,ae,Q,Z)),ee-=Q,Z+=Q,k)break e}else M.head&&(M.head.name=null);M.length=0,M.mode=8;case 8:if(4096&M.flags){if(ee===0)break e;for(Q=0;k=ae[Z+Q++],M.head&&k&&M.length<65536&&(M.head.comment+=String.fromCharCode(k)),k&&Q<ee;);if(512&M.flags&&(M.check=u(M.check,ae,Q,Z)),ee-=Q,Z+=Q,k)break e}else M.head&&(M.head.comment=null);M.mode=9;case 9:if(512&M.flags){for(;I<16;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}if(q!==(65535&M.check)){D.msg="header crc mismatch",M.mode=30;break}I=q=0}M.head&&(M.head.hcrc=M.flags>>9&1,M.head.done=!0),D.adler=M.check=0,M.mode=12;break;case 10:for(;I<32;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}D.adler=M.check=b(q),I=q=0,M.mode=11;case 11:if(M.havedict===0)return D.next_out=we,D.avail_out=Ne,D.next_in=Z,D.avail_in=ee,M.hold=q,M.bits=I,2;D.adler=M.check=1,M.mode=12;case 12:if(K===5||K===6)break e;case 13:if(M.last){q>>>=7&I,I-=7&I,M.mode=27;break}for(;I<3;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}switch(M.last=1&q,I-=1,3&(q>>>=1)){case 0:M.mode=14;break;case 1:if(V(M),M.mode=20,K!==6)break;q>>>=2,I-=2;break e;case 2:M.mode=17;break;case 3:D.msg="invalid block type",M.mode=30}q>>>=2,I-=2;break;case 14:for(q>>>=7&I,I-=7&I;I<32;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}if((65535&q)!=(q>>>16^65535)){D.msg="invalid stored block lengths",M.mode=30;break}if(M.length=65535&q,I=q=0,M.mode=15,K===6)break e;case 15:M.mode=16;case 16:if(Q=M.length){if(ee<Q&&(Q=ee),Ne<Q&&(Q=Ne),Q===0)break e;o.arraySet(te,ae,Z,Q,we),ee-=Q,Z+=Q,Ne-=Q,we+=Q,M.length-=Q;break}M.mode=12;break;case 17:for(;I<14;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}if(M.nlen=257+(31&q),q>>>=5,I-=5,M.ndist=1+(31&q),q>>>=5,I-=5,M.ncode=4+(15&q),q>>>=4,I-=4,286<M.nlen||30<M.ndist){D.msg="too many length or distance symbols",M.mode=30;break}M.have=0,M.mode=18;case 18:for(;M.have<M.ncode;){for(;I<3;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}M.lens[xe[M.have++]]=7&q,q>>>=3,I-=3}for(;M.have<19;)M.lens[xe[M.have++]]=0;if(M.lencode=M.lendyn,M.lenbits=7,U={bits:M.lenbits},de=h(0,M.lens,0,19,M.lencode,0,M.work,U),M.lenbits=U.bits,de){D.msg="invalid code lengths set",M.mode=30;break}M.have=0,M.mode=19;case 19:for(;M.have<M.nlen+M.ndist;){for(;ue=(A=M.lencode[q&(1<<M.lenbits)-1])>>>16&255,se=65535&A,!((z=A>>>24)<=I);){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}if(se<16)q>>>=z,I-=z,M.lens[M.have++]=se;else{if(se===16){for(T=z+2;I<T;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}if(q>>>=z,I-=z,M.have===0){D.msg="invalid bit length repeat",M.mode=30;break}k=M.lens[M.have-1],Q=3+(3&q),q>>>=2,I-=2}else if(se===17){for(T=z+3;I<T;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}I-=z,k=0,Q=3+(7&(q>>>=z)),q>>>=3,I-=3}else{for(T=z+7;I<T;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}I-=z,k=0,Q=11+(127&(q>>>=z)),q>>>=7,I-=7}if(M.have+Q>M.nlen+M.ndist){D.msg="invalid bit length repeat",M.mode=30;break}for(;Q--;)M.lens[M.have++]=k}}if(M.mode===30)break;if(M.lens[256]===0){D.msg="invalid code -- missing end-of-block",M.mode=30;break}if(M.lenbits=9,U={bits:M.lenbits},de=h(m,M.lens,0,M.nlen,M.lencode,0,M.work,U),M.lenbits=U.bits,de){D.msg="invalid literal/lengths set",M.mode=30;break}if(M.distbits=6,M.distcode=M.distdyn,U={bits:M.distbits},de=h(x,M.lens,M.nlen,M.ndist,M.distcode,0,M.work,U),M.distbits=U.bits,de){D.msg="invalid distances set",M.mode=30;break}if(M.mode=20,K===6)break e;case 20:M.mode=21;case 21:if(6<=ee&&258<=Ne){D.next_out=we,D.avail_out=Ne,D.next_in=Z,D.avail_in=ee,M.hold=q,M.bits=I,d(D,H),we=D.next_out,te=D.output,Ne=D.avail_out,Z=D.next_in,ae=D.input,ee=D.avail_in,q=M.hold,I=M.bits,M.mode===12&&(M.back=-1);break}for(M.back=0;ue=(A=M.lencode[q&(1<<M.lenbits)-1])>>>16&255,se=65535&A,!((z=A>>>24)<=I);){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}if(ue&&(240&ue)==0){for(re=z,W=ue,ce=se;ue=(A=M.lencode[ce+((q&(1<<re+W)-1)>>re)])>>>16&255,se=65535&A,!(re+(z=A>>>24)<=I);){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}q>>>=re,I-=re,M.back+=re}if(q>>>=z,I-=z,M.back+=z,M.length=se,ue===0){M.mode=26;break}if(32&ue){M.back=-1,M.mode=12;break}if(64&ue){D.msg="invalid literal/length code",M.mode=30;break}M.extra=15&ue,M.mode=22;case 22:if(M.extra){for(T=M.extra;I<T;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}M.length+=q&(1<<M.extra)-1,q>>>=M.extra,I-=M.extra,M.back+=M.extra}M.was=M.length,M.mode=23;case 23:for(;ue=(A=M.distcode[q&(1<<M.distbits)-1])>>>16&255,se=65535&A,!((z=A>>>24)<=I);){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}if((240&ue)==0){for(re=z,W=ue,ce=se;ue=(A=M.distcode[ce+((q&(1<<re+W)-1)>>re)])>>>16&255,se=65535&A,!(re+(z=A>>>24)<=I);){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}q>>>=re,I-=re,M.back+=re}if(q>>>=z,I-=z,M.back+=z,64&ue){D.msg="invalid distance code",M.mode=30;break}M.offset=se,M.extra=15&ue,M.mode=24;case 24:if(M.extra){for(T=M.extra;I<T;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}M.offset+=q&(1<<M.extra)-1,q>>>=M.extra,I-=M.extra,M.back+=M.extra}if(M.offset>M.dmax){D.msg="invalid distance too far back",M.mode=30;break}M.mode=25;case 25:if(Ne===0)break e;if(Q=H-Ne,M.offset>Q){if((Q=M.offset-Q)>M.whave&&M.sane){D.msg="invalid distance too far back",M.mode=30;break}ie=Q>M.wnext?(Q-=M.wnext,M.wsize-Q):M.wnext-Q,Q>M.length&&(Q=M.length),B=M.window}else B=te,ie=we-M.offset,Q=M.length;for(Ne<Q&&(Q=Ne),Ne-=Q,M.length-=Q;te[we++]=B[ie++],--Q;);M.length===0&&(M.mode=21);break;case 26:if(Ne===0)break e;te[we++]=M.length,Ne--,M.mode=21;break;case 27:if(M.wrap){for(;I<32;){if(ee===0)break e;ee--,q|=ae[Z++]<<I,I+=8}if(H-=Ne,D.total_out+=H,M.total+=H,H&&(D.adler=M.check=M.flags?u(M.check,te,H,we-H):c(M.check,te,H,we-H)),H=Ne,(M.flags?q:b(q))!==M.check){D.msg="incorrect data check",M.mode=30;break}I=q=0}M.mode=28;case 28:if(M.wrap&&M.flags){for(;I<32;){if(ee===0)break e;ee--,q+=ae[Z++]<<I,I+=8}if(q!==(4294967295&M.total)){D.msg="incorrect length check",M.mode=30;break}I=q=0}M.mode=29;case 29:de=1;break e;case 30:de=-3;break e;case 31:return-4;default:return v}return D.next_out=we,D.avail_out=Ne,D.next_in=Z,D.avail_in=ee,M.hold=q,M.bits=I,(M.wsize||H!==D.avail_out&&M.mode<30&&(M.mode<27||K!==4))&&oe(D,D.output,D.next_out,H-D.avail_out)?(M.mode=31,-4):(X-=D.avail_in,H-=D.avail_out,D.total_in+=X,D.total_out+=H,M.total+=H,M.wrap&&H&&(D.adler=M.check=M.flags?u(M.check,te,H,D.next_out-H):c(M.check,te,H,D.next_out-H)),D.data_type=M.bits+(M.last?64:0)+(M.mode===12?128:0)+(M.mode===20||M.mode===15?256:0),(X==0&&H===0||K===4)&&de===y&&(de=-5),de)},a.inflateEnd=function(D){if(!D||!D.state)return v;var K=D.state;return K.window&&(K.window=null),D.state=null,y},a.inflateGetHeader=function(D,K){var M;return D&&D.state?(2&(M=D.state).wrap)==0?v:((M.head=K).done=!1,y):v},a.inflateSetDictionary=function(D,K){var M,ae=K.length;return D&&D.state?(M=D.state).wrap!==0&&M.mode!==11?v:M.mode===11&&c(1,K,ae,0)!==M.check?-3:oe(D,K,ae,ae)?(M.mode=31,-4):(M.havedict=1,y):v},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,s,a){var o=r("../utils/common"),c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(m,x,y,v,w,g,_,b){var N,S,E,R,L,O,P,F,V,oe=b.bits,D=0,K=0,M=0,ae=0,te=0,Z=0,we=0,ee=0,Ne=0,q=0,I=null,X=0,H=new o.Buf16(16),Q=new o.Buf16(16),ie=null,B=0;for(D=0;D<=15;D++)H[D]=0;for(K=0;K<v;K++)H[x[y+K]]++;for(te=oe,ae=15;1<=ae&&H[ae]===0;ae--);if(ae<te&&(te=ae),ae===0)return w[g++]=20971520,w[g++]=20971520,b.bits=1,0;for(M=1;M<ae&&H[M]===0;M++);for(te<M&&(te=M),D=ee=1;D<=15;D++)if(ee<<=1,(ee-=H[D])<0)return-1;if(0<ee&&(m===0||ae!==1))return-1;for(Q[1]=0,D=1;D<15;D++)Q[D+1]=Q[D]+H[D];for(K=0;K<v;K++)x[y+K]!==0&&(_[Q[x[y+K]]++]=K);if(O=m===0?(I=ie=_,19):m===1?(I=c,X-=257,ie=u,B-=257,256):(I=d,ie=h,-1),D=M,L=g,we=K=q=0,E=-1,R=(Ne=1<<(Z=te))-1,m===1&&852<Ne||m===2&&592<Ne)return 1;for(;;){for(P=D-we,V=_[K]<O?(F=0,_[K]):_[K]>O?(F=ie[B+_[K]],I[X+_[K]]):(F=96,0),N=1<<D-we,M=S=1<<Z;w[L+(q>>we)+(S-=N)]=P<<24|F<<16|V|0,S!==0;);for(N=1<<D-1;q&N;)N>>=1;if(N!==0?(q&=N-1,q+=N):q=0,K++,--H[D]==0){if(D===ae)break;D=x[y+_[K]]}if(te<D&&(q&R)!==E){for(we===0&&(we=te),L+=M,ee=1<<(Z=D-we);Z+we<ae&&!((ee-=H[Z+we])<=0);)Z++,ee<<=1;if(Ne+=1<<Z,m===1&&852<Ne||m===2&&592<Ne)return 1;w[E=q&R]=te<<24|Z<<16|L-g|0}}return q!==0&&(w[L+q]=D-we<<24|64<<16|0),b.bits=te,0}},{"../utils/common":41}],51:[function(r,s,a){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,s,a){var o=r("../utils/common"),c=0,u=1;function d(A){for(var G=A.length;0<=--G;)A[G]=0}var h=0,m=29,x=256,y=x+1+m,v=30,w=19,g=2*y+1,_=15,b=16,N=7,S=256,E=16,R=17,L=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],P=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=new Array(2*(y+2));d(oe);var D=new Array(2*v);d(D);var K=new Array(512);d(K);var M=new Array(256);d(M);var ae=new Array(m);d(ae);var te,Z,we,ee=new Array(v);function Ne(A,G,xe,be,ne){this.static_tree=A,this.extra_bits=G,this.extra_base=xe,this.elems=be,this.max_length=ne,this.has_stree=A&&A.length}function q(A,G){this.dyn_tree=A,this.max_code=0,this.stat_desc=G}function I(A){return A<256?K[A]:K[256+(A>>>7)]}function X(A,G){A.pending_buf[A.pending++]=255&G,A.pending_buf[A.pending++]=G>>>8&255}function H(A,G,xe){A.bi_valid>b-xe?(A.bi_buf|=G<<A.bi_valid&65535,X(A,A.bi_buf),A.bi_buf=G>>b-A.bi_valid,A.bi_valid+=xe-b):(A.bi_buf|=G<<A.bi_valid&65535,A.bi_valid+=xe)}function Q(A,G,xe){H(A,xe[2*G],xe[2*G+1])}function ie(A,G){for(var xe=0;xe|=1&A,A>>>=1,xe<<=1,0<--G;);return xe>>>1}function B(A,G,xe){var be,ne,je=new Array(_+1),Me=0;for(be=1;be<=_;be++)je[be]=Me=Me+xe[be-1]<<1;for(ne=0;ne<=G;ne++){var De=A[2*ne+1];De!==0&&(A[2*ne]=ie(je[De]++,De))}}function z(A){var G;for(G=0;G<y;G++)A.dyn_ltree[2*G]=0;for(G=0;G<v;G++)A.dyn_dtree[2*G]=0;for(G=0;G<w;G++)A.bl_tree[2*G]=0;A.dyn_ltree[2*S]=1,A.opt_len=A.static_len=0,A.last_lit=A.matches=0}function ue(A){8<A.bi_valid?X(A,A.bi_buf):0<A.bi_valid&&(A.pending_buf[A.pending++]=A.bi_buf),A.bi_buf=0,A.bi_valid=0}function se(A,G,xe,be){var ne=2*G,je=2*xe;return A[ne]<A[je]||A[ne]===A[je]&&be[G]<=be[xe]}function re(A,G,xe){for(var be=A.heap[xe],ne=xe<<1;ne<=A.heap_len&&(ne<A.heap_len&&se(G,A.heap[ne+1],A.heap[ne],A.depth)&&ne++,!se(G,be,A.heap[ne],A.depth));)A.heap[xe]=A.heap[ne],xe=ne,ne<<=1;A.heap[xe]=be}function W(A,G,xe){var be,ne,je,Me,De=0;if(A.last_lit!==0)for(;be=A.pending_buf[A.d_buf+2*De]<<8|A.pending_buf[A.d_buf+2*De+1],ne=A.pending_buf[A.l_buf+De],De++,be===0?Q(A,ne,G):(Q(A,(je=M[ne])+x+1,G),(Me=O[je])!==0&&H(A,ne-=ae[je],Me),Q(A,je=I(--be),xe),(Me=P[je])!==0&&H(A,be-=ee[je],Me)),De<A.last_lit;);Q(A,S,G)}function ce(A,G){var xe,be,ne,je=G.dyn_tree,Me=G.stat_desc.static_tree,De=G.stat_desc.has_stree,Ce=G.stat_desc.elems,st=-1;for(A.heap_len=0,A.heap_max=g,xe=0;xe<Ce;xe++)je[2*xe]!==0?(A.heap[++A.heap_len]=st=xe,A.depth[xe]=0):je[2*xe+1]=0;for(;A.heap_len<2;)je[2*(ne=A.heap[++A.heap_len]=st<2?++st:0)]=1,A.depth[ne]=0,A.opt_len--,De&&(A.static_len-=Me[2*ne+1]);for(G.max_code=st,xe=A.heap_len>>1;1<=xe;xe--)re(A,je,xe);for(ne=Ce;xe=A.heap[1],A.heap[1]=A.heap[A.heap_len--],re(A,je,1),be=A.heap[1],A.heap[--A.heap_max]=xe,A.heap[--A.heap_max]=be,je[2*ne]=je[2*xe]+je[2*be],A.depth[ne]=(A.depth[xe]>=A.depth[be]?A.depth[xe]:A.depth[be])+1,je[2*xe+1]=je[2*be+1]=ne,A.heap[1]=ne++,re(A,je,1),2<=A.heap_len;);A.heap[--A.heap_max]=A.heap[1],(function(We,Ze){var Re,pt,Tt,wt,jt,Pt,Le=Ze.dyn_tree,nt=Ze.max_code,dt=Ze.stat_desc.static_tree,Ae=Ze.stat_desc.has_stree,Je=Ze.stat_desc.extra_bits,Ee=Ze.stat_desc.extra_base,Pe=Ze.stat_desc.max_length,he=0;for(wt=0;wt<=_;wt++)We.bl_count[wt]=0;for(Le[2*We.heap[We.heap_max]+1]=0,Re=We.heap_max+1;Re<g;Re++)Pe<(wt=Le[2*Le[2*(pt=We.heap[Re])+1]+1]+1)&&(wt=Pe,he++),Le[2*pt+1]=wt,nt<pt||(We.bl_count[wt]++,jt=0,Ee<=pt&&(jt=Je[pt-Ee]),Pt=Le[2*pt],We.opt_len+=Pt*(wt+jt),Ae&&(We.static_len+=Pt*(dt[2*pt+1]+jt)));if(he!==0){do{for(wt=Pe-1;We.bl_count[wt]===0;)wt--;We.bl_count[wt]--,We.bl_count[wt+1]+=2,We.bl_count[Pe]--,he-=2}while(0<he);for(wt=Pe;wt!==0;wt--)for(pt=We.bl_count[wt];pt!==0;)nt<(Tt=We.heap[--Re])||(Le[2*Tt+1]!==wt&&(We.opt_len+=(wt-Le[2*Tt+1])*Le[2*Tt],Le[2*Tt+1]=wt),pt--)}})(A,G),B(je,st,A.bl_count)}function k(A,G,xe){var be,ne,je=-1,Me=G[1],De=0,Ce=7,st=4;for(Me===0&&(Ce=138,st=3),G[2*(xe+1)+1]=65535,be=0;be<=xe;be++)ne=Me,Me=G[2*(be+1)+1],++De<Ce&&ne===Me||(De<st?A.bl_tree[2*ne]+=De:ne!==0?(ne!==je&&A.bl_tree[2*ne]++,A.bl_tree[2*E]++):De<=10?A.bl_tree[2*R]++:A.bl_tree[2*L]++,je=ne,st=(De=0)===Me?(Ce=138,3):ne===Me?(Ce=6,3):(Ce=7,4))}function de(A,G,xe){var be,ne,je=-1,Me=G[1],De=0,Ce=7,st=4;for(Me===0&&(Ce=138,st=3),be=0;be<=xe;be++)if(ne=Me,Me=G[2*(be+1)+1],!(++De<Ce&&ne===Me)){if(De<st)for(;Q(A,ne,A.bl_tree),--De!=0;);else ne!==0?(ne!==je&&(Q(A,ne,A.bl_tree),De--),Q(A,E,A.bl_tree),H(A,De-3,2)):De<=10?(Q(A,R,A.bl_tree),H(A,De-3,3)):(Q(A,L,A.bl_tree),H(A,De-11,7));je=ne,st=(De=0)===Me?(Ce=138,3):ne===Me?(Ce=6,3):(Ce=7,4)}}d(ee);var U=!1;function T(A,G,xe,be){H(A,(h<<1)+(be?1:0),3),(function(ne,je,Me,De){ue(ne),X(ne,Me),X(ne,~Me),o.arraySet(ne.pending_buf,ne.window,je,Me,ne.pending),ne.pending+=Me})(A,G,xe)}a._tr_init=function(A){U||((function(){var G,xe,be,ne,je,Me=new Array(_+1);for(ne=be=0;ne<m-1;ne++)for(ae[ne]=be,G=0;G<1<<O[ne];G++)M[be++]=ne;for(M[be-1]=ne,ne=je=0;ne<16;ne++)for(ee[ne]=je,G=0;G<1<<P[ne];G++)K[je++]=ne;for(je>>=7;ne<v;ne++)for(ee[ne]=je<<7,G=0;G<1<<P[ne]-7;G++)K[256+je++]=ne;for(xe=0;xe<=_;xe++)Me[xe]=0;for(G=0;G<=143;)oe[2*G+1]=8,G++,Me[8]++;for(;G<=255;)oe[2*G+1]=9,G++,Me[9]++;for(;G<=279;)oe[2*G+1]=7,G++,Me[7]++;for(;G<=287;)oe[2*G+1]=8,G++,Me[8]++;for(B(oe,y+1,Me),G=0;G<v;G++)D[2*G+1]=5,D[2*G]=ie(G,5);te=new Ne(oe,O,x+1,y,_),Z=new Ne(D,P,0,v,_),we=new Ne(new Array(0),F,0,w,N)})(),U=!0),A.l_desc=new q(A.dyn_ltree,te),A.d_desc=new q(A.dyn_dtree,Z),A.bl_desc=new q(A.bl_tree,we),A.bi_buf=0,A.bi_valid=0,z(A)},a._tr_stored_block=T,a._tr_flush_block=function(A,G,xe,be){var ne,je,Me=0;0<A.level?(A.strm.data_type===2&&(A.strm.data_type=(function(De){var Ce,st=4093624447;for(Ce=0;Ce<=31;Ce++,st>>>=1)if(1&st&&De.dyn_ltree[2*Ce]!==0)return c;if(De.dyn_ltree[18]!==0||De.dyn_ltree[20]!==0||De.dyn_ltree[26]!==0)return u;for(Ce=32;Ce<x;Ce++)if(De.dyn_ltree[2*Ce]!==0)return u;return c})(A)),ce(A,A.l_desc),ce(A,A.d_desc),Me=(function(De){var Ce;for(k(De,De.dyn_ltree,De.l_desc.max_code),k(De,De.dyn_dtree,De.d_desc.max_code),ce(De,De.bl_desc),Ce=w-1;3<=Ce&&De.bl_tree[2*V[Ce]+1]===0;Ce--);return De.opt_len+=3*(Ce+1)+5+5+4,Ce})(A),ne=A.opt_len+3+7>>>3,(je=A.static_len+3+7>>>3)<=ne&&(ne=je)):ne=je=xe+5,xe+4<=ne&&G!==-1?T(A,G,xe,be):A.strategy===4||je===ne?(H(A,2+(be?1:0),3),W(A,oe,D)):(H(A,4+(be?1:0),3),(function(De,Ce,st,We){var Ze;for(H(De,Ce-257,5),H(De,st-1,5),H(De,We-4,4),Ze=0;Ze<We;Ze++)H(De,De.bl_tree[2*V[Ze]+1],3);de(De,De.dyn_ltree,Ce-1),de(De,De.dyn_dtree,st-1)})(A,A.l_desc.max_code+1,A.d_desc.max_code+1,Me+1),W(A,A.dyn_ltree,A.dyn_dtree)),z(A),be&&ue(A)},a._tr_tally=function(A,G,xe){return A.pending_buf[A.d_buf+2*A.last_lit]=G>>>8&255,A.pending_buf[A.d_buf+2*A.last_lit+1]=255&G,A.pending_buf[A.l_buf+A.last_lit]=255&xe,A.last_lit++,G===0?A.dyn_ltree[2*xe]++:(A.matches++,G--,A.dyn_ltree[2*(M[xe]+x+1)]++,A.dyn_dtree[2*I(G)]++),A.last_lit===A.lit_bufsize-1},a._tr_align=function(A){H(A,2,3),Q(A,S,oe),(function(G){G.bi_valid===16?(X(G,G.bi_buf),G.bi_buf=0,G.bi_valid=0):8<=G.bi_valid&&(G.pending_buf[G.pending++]=255&G.bi_buf,G.bi_buf>>=8,G.bi_valid-=8)})(A)}},{"../utils/common":41}],53:[function(r,s,a){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,s,a){(function(o){(function(c,u){if(!c.setImmediate){var d,h,m,x,y=1,v={},w=!1,g=c.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(c);_=_&&_.setTimeout?_:c,d={}.toString.call(c.process)==="[object process]"?function(E){nr.nextTick(function(){N(E)})}:(function(){if(c.postMessage&&!c.importScripts){var E=!0,R=c.onmessage;return c.onmessage=function(){E=!1},c.postMessage("","*"),c.onmessage=R,E}})()?(x="setImmediate$"+Math.random()+"$",c.addEventListener?c.addEventListener("message",S,!1):c.attachEvent("onmessage",S),function(E){c.postMessage(x+E,"*")}):c.MessageChannel?((m=new MessageChannel).port1.onmessage=function(E){N(E.data)},function(E){m.port2.postMessage(E)}):g&&"onreadystatechange"in g.createElement("script")?(h=g.documentElement,function(E){var R=g.createElement("script");R.onreadystatechange=function(){N(E),R.onreadystatechange=null,h.removeChild(R),R=null},h.appendChild(R)}):function(E){setTimeout(N,0,E)},_.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var R=new Array(arguments.length-1),L=0;L<R.length;L++)R[L]=arguments[L+1];var O={callback:E,args:R};return v[y]=O,d(y),y++},_.clearImmediate=b}function b(E){delete v[E]}function N(E){if(w)setTimeout(N,0,E);else{var R=v[E];if(R){w=!0;try{(function(L){var O=L.callback,P=L.args;switch(P.length){case 0:O();break;case 1:O(P[0]);break;case 2:O(P[0],P[1]);break;case 3:O(P[0],P[1],P[2]);break;default:O.apply(u,P)}})(R)}finally{b(E),w=!1}}}}function S(E){E.source===c&&typeof E.data=="string"&&E.data.indexOf(x)===0&&N(+E.data.slice(x.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof Mn<"u"?Mn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(C1)),C1.exports}var gB=xB();const yB=Zy(gB);var Wu={exports:{}},R1,XN;function vB(){if(XN)return R1;XN=1;var e={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function t(r){return r&&r.replace?r.replace(/([&"<>'])/g,function(s,a){return e[a]}):r}return R1=t,R1}var YN;function wB(){if(YN)return Wu.exports;YN=1;var e=vB(),t=av().Stream,r="    ";function s(h,m){typeof m!="object"&&(m={indent:m});var x=m.stream?new t:null,y="",v=!1,w=m.indent?m.indent===!0?r:m.indent:"",g=!0;function _(R){g?nr.nextTick(R):R()}function b(R,L){if(L!==void 0&&(y+=L),R&&!v&&(x=x||new t,v=!0),R&&v){var O=y;_(function(){x.emit("data",O)}),y=""}}function N(R,L){u(b,c(R,w,w?1:0),L)}function S(){if(x){var R=y;_(function(){x.emit("data",R),x.emit("end"),x.readable=!1,x.emit("close")})}}function E(R){var L=R.encoding||"UTF-8",O={version:"1.0",encoding:L};R.standalone&&(O.standalone=R.standalone),N({"?xml":{_attr:O}}),y=y.replace("/>","?>")}return _(function(){g=!1}),m.declaration&&E(m.declaration),h&&h.forEach?h.forEach(function(R,L){var O;L+1===h.length&&(O=S),N(R,O)}):N(h,S),x?(x.readable=!0,x):y}function a(){var h=Array.prototype.slice.call(arguments),m={_elem:c(h)};return m.push=function(x){if(!this.append)throw new Error("not assigned to a parent!");var y=this,v=this._elem.indent;u(this.append,c(x,v,this._elem.icount+(v?1:0)),function(){y.append(!0)})},m.close=function(x){x!==void 0&&this.push(x),this.end&&this.end()},m}function o(h,m){return new Array(m||0).join(h||"")}function c(h,m,x){x=x||0;var y=o(m,x),v,w=h,g=!1;if(typeof h=="object"){var _=Object.keys(h);if(v=_[0],w=h[v],w&&w._elem)return w._elem.name=v,w._elem.icount=x,w._elem.indent=m,w._elem.indents=y,w._elem.interrupt=w,w._elem}var b=[],N=[],S;function E(R){var L=Object.keys(R);L.forEach(function(O){b.push(d(O,R[O]))})}switch(typeof w){case"object":if(w===null)break;w._attr&&E(w._attr),w._cdata&&N.push(("<![CDATA["+w._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),w.forEach&&(S=!1,N.push(""),w.forEach(function(R){if(typeof R=="object"){var L=Object.keys(R)[0];L=="_attr"?E(R._attr):N.push(c(R,m,x+1))}else N.pop(),S=!0,N.push(e(R))}),S||N.push(""));break;default:N.push(e(w))}return{name:v,interrupt:g,attributes:b,content:N,icount:x,indents:y,indent:m}}function u(h,m,x){if(typeof m!="object")return h(!1,m);var y=m.interrupt?1:m.content.length;function v(){for(;m.content.length;){var g=m.content.shift();if(g!==void 0){if(w(g))return;u(h,g)}}h(!1,(y>1?m.indents:"")+(m.name?"</"+m.name+">":"")+(m.indent&&!x?`
`:"")),x&&x()}function w(g){return g.interrupt?(g.interrupt.append=h,g.interrupt.end=v,g.interrupt=!1,h(!0),!0):!1}if(h(!1,m.indents+(m.name?"<"+m.name:"")+(m.attributes.length?" "+m.attributes.join(" "):"")+(y?m.name?">":"":m.name?"/>":"")+(m.indent&&y>1?`
`:"")),!y)return h(!1,m.indent?`
`:"");w(m)||v()}function d(h,m){return h+'="'+e(m)+'"'}return Wu.exports=s,Wu.exports.element=Wu.exports.Element=a,Wu.exports}var bB=wB();const rs=Zy(bB),Gu=0,D1=32,_B=32,SB=(e,t)=>{const r=t.replace(/-/g,"");if(r.length!==_B)throw new Error(`Error: Cannot extract GUID from font filename: ${t}`);const a=r.replace(/(..)/g,"$1 ").trim().split(" ").map(d=>parseInt(d,16));a.reverse();const c=e.slice(Gu,D1).map((d,h)=>d^a[h%a.length]),u=new Uint8Array(Gu+c.length+Math.max(0,e.length-D1));return u.set(e.slice(0,Gu)),u.set(c,Gu),u.set(e.slice(D1),Gu+c.length),u};class kB{format(t,r={stack:[]}){const s=t.prepForXml(r);if(s)return s;throw Error("XMLComponent did not format correctly")}}class NB{replace(t,r,s){let a=t;return r.forEach((o,c)=>{a=a.replace(new RegExp(`{${o.fileName}}`,"g"),(s+c).toString())}),a}getMediaData(t,r){return r.Array.filter(s=>t.search(`{${s.fileName}}`)>0)}}class EB{replace(t,r){let s=t;for(const a of r)s=s.replace(new RegExp(`{${a.reference}-${a.instance}}`,"g"),a.numId.toString());return s}}class jB{constructor(){Qe(this,"formatter"),Qe(this,"imageReplacer"),Qe(this,"numberingReplacer"),this.formatter=new kB,this.imageReplacer=new NB,this.numberingReplacer=new EB}compile(t,r,s=[]){const a=new yB,o=this.xmlifyFile(t,r),c=new Map(Object.entries(o));for(const[,u]of c)if(Array.isArray(u))for(const d of u)a.file(d.path,d.data);else a.file(u.path,u.data);for(const u of s)a.file(u.path,u.data);for(const u of t.Media.Array)u.type!=="svg"?a.file(`word/media/${u.fileName}`,u.data):(a.file(`word/media/${u.fileName}`,u.data),a.file(`word/media/${u.fallback.fileName}`,u.fallback.data));for(const{data:u,name:d,fontKey:h}of t.FontTable.fontOptionsWithKey){const[m]=d.split(".");a.file(`word/fonts/${m}.odttf`,SB(u,h))}return a}xmlifyFile(t,r){const s=t.Document.Relationships.RelationshipCount+1,a=rs(this.formatter.format(t.Document.View,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),o=t.Comments.Relationships.RelationshipCount+1,c=rs(this.formatter.format(t.Comments,{viewWrapper:{View:t.Comments,Relationships:t.Comments.Relationships},file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),u=this.imageReplacer.getMediaData(a,t.Media),d=this.imageReplacer.getMediaData(c,t.Media);return{Relationships:{data:(u.forEach((h,m)=>{t.Document.Relationships.createRelationship(s+m,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${h.fileName}`)}),t.Document.Relationships.createRelationship(t.Document.Relationships.RelationshipCount+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable","fontTable.xml"),rs(this.formatter.format(t.Document.Relationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const h=this.imageReplacer.replace(a,u,s);return this.numberingReplacer.replace(h,t.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const h=rs(this.formatter.format(t.Styles,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(h,t.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:rs(this.formatter.format(t.CoreProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:rs(this.formatter.format(t.Numbering,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:rs(this.formatter.format(t.FileRelationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:t.Headers.map((h,m)=>{const x=rs(this.formatter.format(h.View,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(x,t.Media).forEach((v,w)=>{h.Relationships.createRelationship(w,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${v.fileName}`)}),{data:rs(this.formatter.format(h.Relationships,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${m+1}.xml.rels`}}),FooterRelationships:t.Footers.map((h,m)=>{const x=rs(this.formatter.format(h.View,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(x,t.Media).forEach((v,w)=>{h.Relationships.createRelationship(w,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${v.fileName}`)}),{data:rs(this.formatter.format(h.Relationships,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${m+1}.xml.rels`}}),Headers:t.Headers.map((h,m)=>{const x=rs(this.formatter.format(h.View,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),y=this.imageReplacer.getMediaData(x,t.Media),v=this.imageReplacer.replace(x,y,0);return{data:this.numberingReplacer.replace(v,t.Numbering.ConcreteNumbering),path:`word/header${m+1}.xml`}}),Footers:t.Footers.map((h,m)=>{const x=rs(this.formatter.format(h.View,{viewWrapper:h,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),y=this.imageReplacer.getMediaData(x,t.Media),v=this.imageReplacer.replace(x,y,0);return{data:this.numberingReplacer.replace(v,t.Numbering.ConcreteNumbering),path:`word/footer${m+1}.xml`}}),ContentTypes:{data:rs(this.formatter.format(t.ContentTypes,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:rs(this.formatter.format(t.CustomProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:rs(this.formatter.format(t.AppProperties,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:rs(this.formatter.format(t.FootNotes.View,{viewWrapper:t.FootNotes,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:rs(this.formatter.format(t.FootNotes.Relationships,{viewWrapper:t.FootNotes,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:rs(this.formatter.format(t.Settings,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:(()=>{const h=this.imageReplacer.replace(c,d,o);return this.numberingReplacer.replace(h,t.Numbering.ConcreteNumbering)})(),path:"word/comments.xml"},CommentsRelationships:{data:(d.forEach((h,m)=>{t.Comments.Relationships.createRelationship(o+m,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${h.fileName}`)}),rs(this.formatter.format(t.Comments.Relationships,{viewWrapper:{View:t.Comments,Relationships:t.Comments.Relationships},file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/comments.xml.rels"},FontTable:{data:rs(this.formatter.format(t.FontTable.View,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:rs(this.formatter.format(t.FontTable.Relationships,{viewWrapper:t.Document,file:t,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}}const TB={WITH_2_BLANKS:"  "},JN=e=>e===!0?TB.WITH_2_BLANKS:e===!1?void 0:e,xT=class gc{static pack(t,r,s){return qL(this,arguments,function*(a,o,c,u=[]){return this.compiler.compile(a,JN(c),u).generateAsync({type:o,mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toString(t,r,s=[]){return gc.pack(t,"string",r,s)}static toBuffer(t,r,s=[]){return gc.pack(t,"nodebuffer",r,s)}static toBase64String(t,r,s=[]){return gc.pack(t,"base64",r,s)}static toBlob(t,r,s=[]){return gc.pack(t,"blob",r,s)}static toArrayBuffer(t,r,s=[]){return gc.pack(t,"arraybuffer",r,s)}static toStream(t,r,s=[]){const a=new pB.Stream;return this.compiler.compile(t,JN(r),s).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(c=>{a.emit("data",c),a.emit("end")}),a}};Qe(xT,"compiler",new jB);let Q0=xT;var c0={exports:{}},AB=c0.exports,ZN;function CB(){return ZN||(ZN=1,(function(e,t){(function(r,s){s()})(AB,function(){function r(h,m){return typeof m>"u"?m={autoBom:!1}:typeof m!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),m={autoBom:!m}),m.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function s(h,m,x){var y=new XMLHttpRequest;y.open("GET",h),y.responseType="blob",y.onload=function(){d(y.response,m,x)},y.onerror=function(){console.error("could not download file")},y.send()}function a(h){var m=new XMLHttpRequest;m.open("HEAD",h,!1);try{m.send()}catch{}return 200<=m.status&&299>=m.status}function o(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var m=document.createEvent("MouseEvents");m.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(m)}}var c=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof yh=="object"&&yh.global===yh?yh:void 0,u=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=c.saveAs||(typeof window!="object"||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(h,m,x){var y=c.URL||c.webkitURL,v=document.createElement("a");m=m||h.name||"download",v.download=m,v.rel="noopener",typeof h=="string"?(v.href=h,v.origin===location.origin?o(v):a(v.href)?s(h,m,x):o(v,v.target="_blank")):(v.href=y.createObjectURL(h),setTimeout(function(){y.revokeObjectURL(v.href)},4e4),setTimeout(function(){o(v)},0))}:"msSaveOrOpenBlob"in navigator?function(h,m,x){if(m=m||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(r(h,x),m);else if(a(h))s(h,m,x);else{var y=document.createElement("a");y.href=h,y.target="_blank",setTimeout(function(){o(y)})}}:function(h,m,x,y){if(y=y||open("","_blank"),y&&(y.document.title=y.document.body.innerText="downloading..."),typeof h=="string")return s(h,m,x);var v=h.type==="application/octet-stream",w=/constructor/i.test(c.HTMLElement)||c.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||v&&w||u)&&typeof FileReader<"u"){var _=new FileReader;_.onloadend=function(){var S=_.result;S=g?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),y?y.location.href=S:location=S,y=null},_.readAsDataURL(h)}else{var b=c.URL||c.webkitURL,N=b.createObjectURL(h);y?y.location=N:location.href=N,y=null,setTimeout(function(){b.revokeObjectURL(N)},4e4)}});c.saveAs=d.saveAs=d,e.exports=d})})(c0)),c0.exports}var em=CB();const fv=e=>{const t=new Date(e),r=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${r}${s}${a}`},RB=(e,t,r)=>{const s=m=>m?m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>"):"",a=m=>m?m.split(`
`).map(x=>`<p style="margin: 0 0 8px 0; line-height: 1.8;">${x.replace(/</g,"&lt;").replace(/>/g,"&gt;")||"&nbsp;"}</p>`).join(""):'<p style="color: #666;">-</p>',u=(m=>{if(!m)return[{title:"",details:[{content:"-",progress:"",remark:""}]}];try{const x=JSON.parse(m);if(Array.isArray(x)&&x.length>0&&typeof x[0]=="object"){if("details"in x[0])return x;if("content"in x[0])return x.map(y=>({title:y.title||"",details:[{content:y.content||"",progress:y.progress||"",remark:y.remark||""}]}))}}catch{}return[{title:"",details:[{content:m,progress:"",remark:""}]}]})(e.morning_work).map((m,x)=>{const y=(m.title?1:0)+m.details.length,v=[];return m.title&&v.push(`
            <tr>
                <td style="text-align:center; vertical-align:top; padding: 8px; border: 1px solid #333; border-bottom: 1px solid #ccc; font-size: 13px; width: 40px;" rowspan="${y}">${x+1}</td>
                <td style="padding: 8px 10px; border: 1px solid #333; border-bottom: 1px solid #ccc; font-size: 13px; font-weight: bold;">[${s(m.title)}]</td>
                <td style="border: 1px solid #333; border-bottom: 1px solid #ccc;"></td>
                <td style="border: 1px solid #333; border-bottom: 1px solid #ccc;"></td>
            </tr>`),m.details.forEach((w,g)=>{const _=(w.content||"-").split(`
`).map(E=>E.trim()?`- ${s(E)}`:"").filter(Boolean).join("<br/>"),N=g===m.details.length-1?"border-bottom: 1px solid #333;":"border-bottom: 1px solid #ccc;",S=!m.title&&g===0?`<td style="text-align:center; vertical-align:top; padding: 8px; border: 1px solid #333; font-size: 13px; width: 40px;" rowspan="${y}">${x+1}</td>`:"";v.push(`
            <tr>
                ${S}
                <td style="padding: 8px 10px; border-left: 1px solid #333; border-right: 1px solid #333; ${N} font-size: 13px; white-space: pre-wrap;">${_}</td>
                <td style="text-align:center; vertical-align:top; padding: 8px; border-left: 1px solid #333; border-right: 1px solid #333; ${N} font-size: 13px;">${w.progress?w.progress+"%":"-"}</td>
                <td style="vertical-align:top; padding: 8px 10px; border-left: 1px solid #333; border-right: 1px solid #333; ${N} font-size: 13px;">${s(w.remark||"")||"-"}</td>
            </tr>`)}),v.join("")}).join(""),d=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>  - ${t(e.work_date)}</title>
    <style>
        @page {
            size: A4;
            margin: 20mm 25mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', 'Apple SD Gothic Neo', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #000;
            background: #fff;
        }

        .date-header {
            text-align: right;
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
        }

        .title-section {
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #333;
        }
        .main-title {
            font-size: 26px;
            font-weight: bold;
            letter-spacing: 12px;
            color: #1a1a1a;
        }

        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 8px;
        }
        .info-table td {
            border: 1px solid #333;
            padding: 10px 15px;
            font-size: 14px;
        }
        .info-table .label {
            background-color: #f8f9fa;
            font-weight: 600;
            text-align: center;
            width: 15%;
        }
        .info-table .value {
            width: 35%;
        }

        .content-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .content-table td {
            border: 1px solid #333;
            padding: 0;
            font-size: 14px;
            vertical-align: top;
        }
        .content-table .section-title {
            background-color: #f8f9fa;
            font-weight: 600;
            padding: 12px 15px;
        }
        .content-table .section-body {
            padding: 20px;
            min-height: 50px;
        }

        .task-table {
            width: 100%;
            border-collapse: collapse;
        }
        .task-table td, .task-table th {
            border: 1px solid #333;
            font-size: 13px;
        }
        .task-table th {
            background-color: #f0f0f0;
            font-weight: 600;
            padding: 8px;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            thead {
                display: table-header-group;
            }
            p {
                orphans: 2;
                widows: 2;
            }
        }
    </style>
</head>
<body>
    <div class="date-header">
        : ${fv(e.work_date)}
    </div>

    <div class="title-section">
        <h1 class="main-title">      </h1>
    </div>

    <table class="task-table">
        <colgroup><col style="width:5%"/><col style="width:65%"/><col style="width:10%"/><col style="width:20%"/></colgroup>
        <tbody>
            <tr>
                <td colspan="2" style="border:1px solid #333; padding:10px 15px; font-size:14px;"><span style="background:#f8f9fa; font-weight:600; padding:2px 8px;"></span>&nbsp;&nbsp;${t(e.work_date)}</td>
                <td colspan="2" style="border:1px solid #333; padding:10px 15px; font-size:14px;"><span style="background:#f8f9fa; font-weight:600; padding:2px 8px;"></span>&nbsp;&nbsp;${e.user?.team||"-"}</td>
            </tr>
            <tr>
                <td colspan="2" style="border:1px solid #333; padding:10px 15px; font-size:14px;"><span style="background:#f8f9fa; font-weight:600; padding:2px 8px;"></span>&nbsp;&nbsp;${e.user?.rank||"-"}</td>
                <td colspan="2" style="border:1px solid #333; padding:10px 15px; font-size:14px;"><span style="background:#f8f9fa; font-weight:600; padding:2px 8px;"></span>&nbsp;&nbsp;${e.user?.name||"-"}</td>
            </tr>
            <tr>
                <th colspan="4" style="background-color: #f8f9fa; text-align: left; padding: 12px 15px; font-size: 14px;">.    </th>
            </tr>
            <tr>
                <th>No</th>
                <th></th>
                <th></th>
                <th></th>
            </tr>
            ${u}
        </tbody>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.  </td>
        </tr>
        <tr>
            <td class="section-body">
                ${a(e.this_week_work)}
            </td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.   </td>
        </tr>
        <tr>
            <td class="section-body">
                ${a(e.special_notes)}
            </td>
        </tr>
    </table>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,h=window.open("","_blank","width=900,height=700");h.document.write(d),h.document.close()},DB=(e,t,r)=>{const s=m=>m?m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>"):"",a=m=>m?m.split(`
`).map(x=>`<p style="margin: 0 0 8px 0; line-height: 1.8;">${x.replace(/</g,"&lt;").replace(/>/g,"&gt;")||"&nbsp;"}</p>`).join(""):'<p style="color: #666;">-</p>',u=(m=>{if(!m)return[{title:"",details:[{content:"-",progress:"",remark:""}]}];try{const x=JSON.parse(m);if(Array.isArray(x)&&x.length>0&&typeof x[0]=="object"){if("details"in x[0])return x;if("content"in x[0])return x.map(y=>({title:y.title||"",details:[{content:y.content||"",progress:y.progress||"",remark:y.remark||""}]}))}}catch{}return[{title:"",details:[{content:m,progress:"",remark:""}]}]})(e.morning_work).map((m,x)=>{const y=(m.title?1:0)+m.details.length,v=[];return m.title&&v.push(`
            <tr>
                <td style="text-align:center; vertical-align:top; padding: 8px; border: 1px solid #333; border-bottom: 1px solid #ccc; font-size: 13px; width: 40px;" rowspan="${y}">${x+1}</td>
                <td style="padding: 8px 10px; border: 1px solid #333; border-bottom: 1px solid #ccc; font-size: 13px; font-weight: bold;">[${s(m.title)}]</td>
                <td style="border: 1px solid #333; border-bottom: 1px solid #ccc;"></td>
                <td style="border: 1px solid #333; border-bottom: 1px solid #ccc;"></td>
            </tr>`),m.details.forEach((w,g)=>{const _=(w.content||"-").split(`
`).map(E=>E.trim()?`- ${s(E)}`:"").filter(Boolean).join("<br/>"),N=g===m.details.length-1?"border-bottom: 1px solid #333;":"border-bottom: 1px solid #ccc;",S=!m.title&&g===0?`<td style="text-align:center; vertical-align:top; padding: 8px; border: 1px solid #333; font-size: 13px; width: 40px;" rowspan="${y}">${x+1}</td>`:"";v.push(`
            <tr>
                ${S}
                <td style="padding: 8px 10px; border-left: 1px solid #333; border-right: 1px solid #333; ${N} font-size: 13px; white-space: pre-wrap;">${_}</td>
                <td style="text-align:center; vertical-align:top; padding: 8px; border-left: 1px solid #333; border-right: 1px solid #333; ${N} font-size: 13px;">${w.progress?w.progress+"%":"-"}</td>
                <td style="vertical-align:top; padding: 8px 10px; border-left: 1px solid #333; border-right: 1px solid #333; ${N} font-size: 13px;">${s(w.remark||"")||"-"}</td>
            </tr>`)}),v.join("")}).join(""),d=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>  - ${t(e.work_date)}</title>
    <style>
        @page {
            size: A4;
            margin: 20mm 25mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', 'Apple SD Gothic Neo', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #000;
            background: #fff;
        }

        .date-header {
            text-align: right;
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
        }

        .title-section {
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #333;
        }
        .main-title {
            font-size: 26px;
            font-weight: bold;
            letter-spacing: 12px;
            color: #1a1a1a;
        }

        .content-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 8px;
        }
        .content-table td {
            border: 1px solid #333;
            padding: 0;
            font-size: 14px;
            vertical-align: top;
        }
        .content-table .section-title {
            background-color: #f8f9fa;
            font-weight: 600;
            padding: 12px 15px;
        }
        .content-table .section-body {
            padding: 20px;
            min-height: 50px;
        }

        .task-table {
            width: 100%;
            border-collapse: collapse;
        }
        .task-table td, .task-table th {
            border: 1px solid #333;
            font-size: 13px;
        }
        .task-table th {
            background-color: #f0f0f0;
            font-weight: 600;
            padding: 8px;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            thead {
                display: table-header-group;
            }
            p {
                orphans: 2;
                widows: 2;
            }
        }
    </style>
</head>
<body>
    <div class="date-header">
        : ${fv(e.work_date)}
    </div>

    <div class="title-section">
        <h1 class="main-title">      </h1>
    </div>

    <table class="task-table">
        <colgroup><col style="width:5%"/><col style="width:65%"/><col style="width:10%"/><col style="width:20%"/></colgroup>
        <tbody>
            <tr>
                <td colspan="2" style="border:1px solid #333; padding:10px 15px; font-size:14px;"><span style="background:#f8f9fa; font-weight:600; padding:2px 8px;"></span>&nbsp;&nbsp;${t(e.work_date)}</td>
                <td colspan="2" style="border:1px solid #333; padding:10px 15px; font-size:14px;"><span style="background:#f8f9fa; font-weight:600; padding:2px 8px;"></span>&nbsp;&nbsp;${e.user?.team||"-"}</td>
            </tr>
            <tr>
                <td colspan="2" style="border:1px solid #333; padding:10px 15px; font-size:14px;"><span style="background:#f8f9fa; font-weight:600; padding:2px 8px;"></span>&nbsp;&nbsp;${e.user?.rank||"-"}</td>
                <td colspan="2" style="border:1px solid #333; padding:10px 15px; font-size:14px;"><span style="background:#f8f9fa; font-weight:600; padding:2px 8px;"></span>&nbsp;&nbsp;${e.user?.name||"-"}</td>
            </tr>
            <tr>
                <th colspan="4" style="background-color: #f8f9fa; text-align: left; padding: 12px 15px; font-size: 14px;">.    </th>
            </tr>
            <tr>
                <th>No</th>
                <th></th>
                <th></th>
                <th></th>
            </tr>
            ${u}
        </tbody>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title">.   </td>
        </tr>
        <tr>
            <td class="section-body">
                ${a(e.special_notes)}
            </td>
        </tr>
    </table>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,h=window.open("","_blank","width=900,height=700");h.document.write(d),h.document.close()},OB=(e,t)=>{const r=`
---TASK---
`,s=u=>{if(!u)return'<tr><td colspan="3" style="text-align: center; color: #666; padding: 15px;">-</td></tr>';const h=u.includes("---TASK---")?u.split(r).filter(m=>m.trim()):u.split(`
`).filter(m=>m.trim());return h.length===0?'<tr><td colspan="3" style="text-align: center; color: #666; padding: 15px;">-</td></tr>':h.map((m,x)=>{const y=m.trim().split(`
`),w=y[y.length-1].match(/^(.+?)\s*\((\d+)%\)$/);let g=m.trim(),_="-";w&&y.length===1?(g=w[1].trim(),_=w[2]+"%"):w&&y.length>1&&(y[y.length-1]=w[1].trim(),g=y.join(`
`),_=w[2]+"%");const b=g.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>");return`
                <tr>
                    <td style="width: 40px; text-align: center; padding: 8px; border: 1px solid #333;">${x+1}</td>
                    <td style="padding: 8px 10px; border: 1px solid #333;">${b}</td>
                    <td style="width: 60px; text-align: center; padding: 8px; border: 1px solid #333;">${_}</td>
                </tr>
            `}).join("")},a=u=>u?u.split(`
`).map(d=>`<p style="margin: 0 0 8px 0; line-height: 1.8;">${d.replace(/</g,"&lt;").replace(/>/g,"&gt;")||"&nbsp;"}</p>`).join(""):'<p style="color: #666;">-</p>',o=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>  - ${t(e.work_date)}</title>
    <style>
        @page {
            size: A4;
            margin: 25mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', 'Apple SD Gothic Neo', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #000;
            background: #fff;
        }

        .date-header {
            text-align: right;
            font-size: 13px;
            color: #666;
            margin-bottom: 10px;
        }

        .title-section {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #333;
        }
        .main-title {
            font-size: 26px;
            font-weight: bold;
            letter-spacing: 12px;
            color: #1a1a1a;
        }

        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .info-table td {
            border: 1px solid #333;
            padding: 10px 15px;
            font-size: 14px;
        }
        .info-table .label {
            background-color: #f8f9fa;
            font-weight: 600;
            text-align: center;
            width: 15%;
        }
        .info-table .value {
            width: 35%;
        }

        .content-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .content-table td, .content-table th {
            border: 1px solid #333;
            padding: 0;
            font-size: 13px;
            vertical-align: top;
        }
        .content-table .section-title {
            background-color: #f8f9fa;
            font-weight: 600;
            padding: 12px 15px;
            text-align: left;
        }
        .content-table .section-body {
            padding: 15px;
            min-height: 30px;
        }
        .content-table .subheader {
            background-color: #fafafa;
            font-weight: 600;
            padding: 8px;
            text-align: center;
        }

        .task-table {
            width: 100%;
            border-collapse: collapse;
        }
        .task-table td, .task-table th {
            border: 1px solid #333;
            font-size: 13px;
        }
        .task-table th {
            background-color: #fafafa;
            font-weight: 600;
            padding: 8px;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            font-size: 15px;
            font-weight: 600;
            color: #333;
        }

        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            tr {
                page-break-inside: avoid;
            }
            p {
                page-break-inside: avoid;
                orphans: 2;
                widows: 2;
            }
        }
    </style>
</head>
<body>
    <div class="date-header">
        : ${fv(e.work_date)}
    </div>

    <div class="title-section">
        <h1 class="main-title">      </h1>
    </div>

    <table class="info-table">
        <tr>
            <td class="label"></td>
            <td class="value">${t(e.work_date)}</td>
            <td class="label"></td>
            <td class="value">${e.user?.team||"-"}</td>
        </tr>
        <tr>
            <td class="label"></td>
            <td class="value">${e.user?.rank||"-"}</td>
            <td class="label"></td>
            <td class="value">${e.user?.name||"-"}</td>
        </tr>
    </table>

    <table class="content-table">
        <tr>
            <td class="section-title" colspan="3">.  </td>
        </tr>
    </table>
    <table class="task-table">
        <thead>
            <tr>
                <th style="width: 40px;">No</th>
                <th> </th>
                <th style="width: 60px;"></th>
            </tr>
        </thead>
        <tbody>
            ${s(e.morning_work)}
        </tbody>
    </table>

    <table class="content-table" style="margin-top: 15px;">
        <tr>
            <td class="section-title" colspan="3">.  </td>
        </tr>
    </table>
    <table class="task-table">
        <thead>
            <tr>
                <th style="width: 40px;">No</th>
                <th> </th>
                <th style="width: 60px;"></th>
            </tr>
        </thead>
        <tbody>
            ${s(e.afternoon_work)}
        </tbody>
    </table>

    <table class="content-table" style="margin-top: 15px;">
        <tr>
            <td class="section-title">.  </td>
        </tr>
        <tr>
            <td class="section-body">
                ${a(e.next_day_work)}
            </td>
        </tr>
    </table>

    <table class="content-table" style="margin-top: 15px;">
        <tr>
            <td class="section-title">.   </td>
        </tr>
        <tr>
            <td class="section-body">
                ${a(e.special_notes)}
            </td>
        </tr>
    </table>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,c=window.open("","_blank","width=900,height=700");c.document.write(o),c.document.close()};function il({title:e,date:t,content:r}){const s=t||new Date().toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}),a=`
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>${e}</title>
  <style>
    @page {
      size: A4;
      margin: 15mm 15mm 20mm 15mm;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      color: #1a1a1a;
      line-height: 1.5;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }
    .report-header {
      text-align: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 3px solid #2c6eb6;
    }
    .report-header h1 {
      font-size: 24px;
      font-weight: 800;
      color: #1a1a1a;
      margin-bottom: 8px;
    }
    .report-header .org-name {
      font-size: 14px;
      color: #2c6eb6;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .report-header .date {
      font-size: 13px;
      color: #666;
    }
    .stats-grid {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
    }
    .stat-box {
      flex: 1;
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 10px;
      text-align: center;
    }
    .stat-box .label {
      font-size: 11px;
      color: #888;
      margin-bottom: 2px;
    }
    .stat-box .value {
      font-size: 22px;
      font-weight: 700;
      color: #1a1a1a;
    }
    .stat-box .unit {
      font-size: 12px;
      font-weight: 400;
      color: #888;
    }
    .stat-box.highlight {
      border-color: #2c6eb6;
      background: #f0f6ff;
    }
    .stat-box.highlight .value {
      color: #2c6eb6;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 16px;
      font-size: 12px;
    }
    table th {
      background: #2c6eb6;
      color: white;
      font-weight: 600;
      padding: 8px 10px;
      text-align: center;
      font-size: 12px;
    }
    table td {
      padding: 7px 10px;
      border-bottom: 1px solid #e5e5e5;
      font-size: 12px;
    }
    table tr:nth-child(even) {
      background: #f8f9fa;
    }
    .section-title {
      font-size: 15px;
      font-weight: 700;
      color: #333;
      margin: 16px 0 8px;
      padding-left: 8px;
      border-left: 3px solid #2c6eb6;
    }
  </style>
</head>
<body>
  <div class="report-header">
    <div class="org-name"></div>
    <h1>${e}</h1>
    <div class="date">: ${s}</div>
  </div>
  ${r}
</body>
</html>`,o=document.getElementById("print-report-frame");o&&o.remove();const c=document.createElement("iframe");c.id="print-report-frame",c.style.position="fixed",c.style.top="-10000px",c.style.left="-10000px",c.style.width="0",c.style.height="0",c.style.border="none",document.body.appendChild(c);const u=c.contentDocument||c.contentWindow?.document;u&&(u.open(),u.write(a),u.close(),c.onload=()=>{c.contentWindow?.focus(),c.contentWindow?.print()})}const FB=e=>e?e.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0","").replace("?dl=1","").replace("&dl=1",""):"",Ec=e=>{let t="";return typeof e=="string"?t=e:e&&e.url&&(t=e.url),FB(t)},by=e=>{const t=Ec(e);if(!t)return!1;const r=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],s=t.toLowerCase();return r.some(a=>s.includes(a))},LB=({urls:e})=>{const t=Y.useRef(null),[r,s]=Y.useState(!1),[a,o]=Y.useState(!1),[c,u]=Y.useState(null),[d,h]=Y.useState(!1),[m,x]=Y.useState(0),[y,v]=Y.useState(0),w=e.filter(by),g=e.filter(D=>!by(D)),_=()=>{if(t.current){const{scrollLeft:D,scrollWidth:K,clientWidth:M}=t.current;s(D>0),o(D<K-M-10)}};Y.useEffect(()=>(_(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)),[e]),Y.useEffect(()=>{const D=K=>{c!==null&&(K.key==="ArrowLeft"&&E(),K.key==="ArrowRight"&&R(),K.key==="Escape"&&S())};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[c,w.length]);const b=D=>{t.current&&(t.current.scrollBy({left:D==="left"?-200:200,behavior:"smooth"}),setTimeout(_,300))},N=D=>{u(D),v(0)},S=()=>{u(null),v(0)},E=()=>{v(0),u(D=>D>0?D-1:w.length-1)},R=()=>{v(0),u(D=>D<w.length-1?D+1:0)},L=D=>{w.length<=1||(h(!0),x(D.clientX))},O=D=>{w.length<=1||(h(!0),x(D.touches[0].clientX))},P=D=>{if(!d)return;const K=D-m;v(K)},F=D=>{P(D.clientX)},V=D=>{P(D.touches[0].clientX)},oe=()=>{if(!d)return;h(!1);const D=100;y>D?E():y<-D?R():v(0)};return w.length===0&&g.length===0?null:n.jsxs("div",{className:"space-y-3",children:[w.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:[" (",w.length,")"]}),n.jsxs("div",{className:"relative",children:[r&&n.jsx("button",{onClick:()=>b("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx(za,{size:20})}),n.jsx("div",{ref:t,onScroll:_,className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:w.map((D,K)=>{const M=Ec(D);return n.jsx("div",{className:"flex-shrink-0 cursor-pointer w-24 h-24 sm:w-32 sm:h-32 rounded-xl overflow-hidden bg-toss-gray-100",onClick:()=>N(K),children:n.jsx("img",{src:M,alt:`  ${K+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:ae=>{ae.target.style.display="none"}})},K)})}),a&&n.jsx("button",{onClick:()=>b("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx(pa,{size:20})})]})]}),g.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:["  (",g.length,")"]}),n.jsx("div",{className:"space-y-2",children:g.map((D,K)=>{const M=Ec(D),ae=typeof D=="string"?M.split("/").pop():D.name||M.split("/").pop();return n.jsxs("a",{href:M,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-blue hover:underline flex-1 truncate",children:ae}),n.jsx(ns,{size:16,className:"text-toss-gray-500"})]},K)})})]}),c!==null&&n.jsxs("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center select-none",style:{zIndex:9999},onClick:S,onMouseUp:oe,onMouseLeave:oe,onTouchEnd:oe,children:[n.jsx("button",{className:"absolute top-4 right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors",onClick:S,children:n.jsx(pr,{size:24})}),n.jsxs("div",{className:"absolute top-4 left-4 z-10 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm font-medium",children:[c+1," / ",w.length]}),n.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[w.length>1&&n.jsx("button",{onClick:D=>{D.stopPropagation(),E()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:n.jsx(za,{size:36,strokeWidth:3})}),n.jsx("div",{onClick:D=>D.stopPropagation(),onMouseDown:L,onMouseMove:F,onTouchStart:O,onTouchMove:V,className:"max-w-[70vw] sm:max-w-[80vw] max-h-[90vh] relative cursor-grab active:cursor-grabbing",style:{transform:`translateX(${y}px)`,transition:d?"none":"transform 0.3s ease-out"},children:n.jsx("img",{src:Ec(w[c]),alt:`  ${c+1}`,className:"max-w-full max-h-[90vh] object-contain rounded-lg pointer-events-none",draggable:!1})}),w.length>1&&n.jsx("button",{onClick:D=>{D.stopPropagation(),R()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:n.jsx(pa,{size:36,strokeWidth:3})})]}),w.length>1&&n.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2",children:w.map((D,K)=>n.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${K===c?"bg-white":"bg-white/30"}`},K))})]})]})},IB=()=>{const{profile:e,isAdmin:t}=Yr(),[r,s]=Y.useState([]),[a,o]=Y.useState([]),[c,u]=Y.useState(!1),[d,h]=Y.useState(!1),[m,x]=Y.useState(!0),[y,v]=Y.useState(!1),[w,g]=Y.useState(null),[_,b]=Y.useState(new Date().getFullYear()),[N,S]=Y.useState(new Date().getMonth()+1),[E,R]=Y.useState("all"),[L,O]=Y.useState(1),P=15,F=Y.useRef(null),[V,oe]=Y.useState(new Set),D=le=>{oe(ve=>{const Oe=new Set(ve);return Oe.has(le)?Oe.delete(le):Oe.add(le),Oe})},K=()=>{Ee.length>0&&Ee.every(le=>V.has(le.id))?oe(le=>{const ve=new Set(le);return Ee.forEach(Oe=>ve.delete(Oe.id)),ve}):oe(le=>{const ve=new Set(le);return Ee.forEach(Oe=>ve.add(Oe.id)),ve})},M=()=>{const le=V.size>0?a.filter(qe=>V.has(qe.id)):a,Oe=`
            <div class="section-title">  - ${V.size>0?`  (${le.length})`:` (${le.length})`}</div>
            <table>
                <colgroup><col style="width:5%"/><col style="width:12%"/><col style="width:10%"/><col style="width:8%"/><col style="width:30%"/><col style="width:30%"/></colgroup>
                <thead><tr><th>No</th><th></th><th></th><th></th><th> </th><th> </th></tr></thead>
                <tbody>
                    ${le.map((qe,ct)=>`
                        <tr>
                            <td style="text-align:center">${ct+1}</td>
                            <td style="text-align:center">${new Date(qe.work_date).toLocaleDateString("ko-KR")}</td>
                            <td style="text-align:center">${qe.user?.name||"-"}</td>
                            <td style="text-align:center">${qe.user?.team||"-"}</td>
                            <td style="text-align:left;white-space:pre-line">${(qe.morning_work||"-").replace(/\n---TASK---\n/g,`
`).replace(/\s*\(\d+%\)/g,"")}</td>
                            <td style="text-align:left;white-space:pre-line">${(qe.afternoon_work||"-").replace(/\n---TASK---\n/g,`
`).replace(/\s*\(\d+%\)/g,"")}</td>
                        </tr>
                    `).join("")}
                </tbody>
            </table>
        `;il({title:" ",content:Oe})},[ae,te]=Y.useState({isOpen:!1,message:"",type:"info"}),Z=(le,ve="info")=>{te({isOpen:!0,message:le,type:ve})},[we,ee]=Y.useState({isOpen:!1,worklog:null}),Ne=()=>{const le=new Date,ve=le.getFullYear(),Oe=String(le.getMonth()+1).padStart(2,"0"),qe=String(le.getDate()).padStart(2,"0");return`${ve}-${Oe}-${qe}`},[q,I]=Y.useState({work_date:Ne(),morning_tasks:[{content:"",progress:""}],afternoon_tasks:[{content:"",progress:""}],next_day_work:"",special_notes:"",files:[],existingFileUrls:[]}),X=e?.name==="",[H,Q]=Y.useState({work_date:Ne(),morning_work:"",afternoon_work:"",next_day_work:"",special_notes:"",files:[],existingFileUrls:[]}),ie=le=>{I(ve=>({...ve,[le]:[...ve[le],{content:"",progress:""}]}))},B=(le,ve)=>{I(Oe=>({...Oe,[le]:Oe[le].filter((qe,ct)=>ct!==ve)}))},z=(le,ve,Oe,qe)=>{I(ct=>({...ct,[le]:ct[le].map((Et,Xt)=>Xt===ve?{...Et,[Oe]:qe}:Et)}))},ue=`
---TASK---
`,se=le=>le.filter(ve=>ve.content.trim()).map(ve=>ve.progress?`${ve.content} (${ve.progress}%)`:ve.content).join(ue),re=le=>{if(!le)return[{content:"",progress:""}];const ve=le.includes("---TASK---");let Oe;return ve?Oe=le.split(ue).filter(qe=>qe.trim()):/^\d+\.\s*/m.test(le)?(Oe=le.split(/\n(?=\d+\.\s*)/).filter(ct=>ct.trim()),Oe=Oe.map(ct=>ct.replace(/^\d+\.\s*/,"").trim())):Oe=[le],Oe.length===0||Oe.length===1&&!Oe[0].trim()?[{content:"",progress:""}]:Oe.map(qe=>{const ct=qe.trim().split(`
`),Xt=ct[ct.length-1].match(/^(.+?)\s*\((\d+)%\)$/);return Xt&&ct.length===1?{content:Xt[1].trim(),progress:Xt[2]}:Xt&&ct.length>1?(ct[ct.length-1]=Xt[1].trim(),{content:ct.join(`
`),progress:Xt[2]}):{content:qe.trim(),progress:""}})},W=le=>le?le.replace(/\n---TASK---\n/g,", ").replace(/\n/g," "):"-",ce=2026,k=new Date().getFullYear(),de=Array.from({length:k-ce+1},(le,ve)=>ce+ve),U=Array.from({length:12},(le,ve)=>ve+1);Y.useEffect(()=>{G()},[]),Y.useEffect(()=>{T()},[r,_,N,E]);const T=()=>{const le=r.filter(ve=>{const Oe=new Date(ve.work_date),qe=Oe.getFullYear()===_&&Oe.getMonth()+1===N,ct=E==="all"||ve.user_id===E;return qe&&ct});o(le),O(1)},A=Array.from(new Set(r.map(le=>le.user_id))).map(le=>{const ve=r.find(Oe=>Oe.user_id===le);return{user_id:le,name:ve?.user?.name||"  "}}).sort((le,ve)=>le.name.localeCompare(ve.name)),G=async()=>{try{let le=Ue.from("work_logs").select("*").not("type","in",'("weekly","monthly","rescue")').order("work_date",{ascending:!1});!t&&e&&(le=le.eq("user_id",e.user_id));const{data:ve,error:Oe}=await le;if(Oe)throw Oe;const{data:qe,error:ct}=await Ue.from("users").select("user_id, name, team, rank");if(ct)throw ct;const Et=ve.map(Xt=>{const er=qe.find(Lt=>Lt.user_id===Xt.user_id);return{...Xt,user:er||{name:"  ",team:"-",rank:"-"}}});s(Et||[])}catch(le){console.error("Error fetching worklogs:",le)}finally{x(!1)}},xe=le=>{const Oe=Array.from(le.target.files).map(qe=>({file:qe,name:qe.name,size:(qe.size/1024).toFixed(0)+"KB"}));X?Q(qe=>({...qe,files:[...qe.files,...Oe]})):I(qe=>({...qe,files:[...qe.files,...Oe]}))},be=le=>{X?Q(ve=>({...ve,files:ve.files.filter((Oe,qe)=>qe!==le)})):I(ve=>({...ve,files:ve.files.filter((Oe,qe)=>qe!==le)}))},ne=le=>{I(ve=>({...ve,existingFileUrls:ve.existingFileUrls.filter((Oe,qe)=>qe!==le)}))},je=async le=>{const ve=`/intranet/worklogs/${e.user_id}`;return(await Gd(le.map(qe=>qe.file),ve)).map(qe=>qe.url)},Me=async()=>{if(X){const ct=H.morning_work.trim(),Et=H.afternoon_work.trim();if(!ct&&!Et){Z("      .","error");return}try{v(!0);let Xt=[];H.files.length>0&&(Xt=await je(H.files));const{error:er}=await Ue.from("work_logs").insert({work_date:H.work_date,morning_work:ct,afternoon_work:Et,next_day_work:H.next_day_work,special_notes:H.special_notes,file_urls:Xt,user_id:e.user_id,type:"daily",is_read:!1});if(er)throw er;u(!1),Ce(),G(),Z(" .","success")}catch(Xt){console.error("Error creating worklog:",Xt),Z("  : "+Xt.message,"error")}finally{v(!1)}return}const le=se(q.morning_tasks),ve=se(q.afternoon_tasks);if(!le&&!ve){Z("      .","error");return}const Oe=q.morning_tasks.filter(ct=>ct.content.trim()),qe=q.afternoon_tasks.filter(ct=>ct.content.trim());if(Oe.some(ct=>!ct.progress)||qe.some(ct=>!ct.progress)){Z("   (%) .","error");return}try{v(!0);let ct=[];q.files.length>0&&(ct=await je(q.files));const{error:Et}=await Ue.from("work_logs").insert({work_date:q.work_date,morning_work:le,afternoon_work:ve,next_day_work:q.next_day_work,special_notes:q.special_notes,file_urls:ct,user_id:e.user_id,type:"daily",is_read:!1});if(Et)throw Et;u(!1),Ce(),G(),Z(" .","success")}catch(ct){console.error("Error creating worklog:",ct),Z("  : "+ct.message,"error")}finally{v(!1)}},De=async()=>{if(!w?.id){Z("    .  .","error");return}const le=w.id;if(X){const Et=H.morning_work.trim(),Xt=H.afternoon_work.trim();if(!Et&&!Xt){Z("      .","error");return}try{v(!0);let er=[];H.files.length>0&&(er=await je(H.files));const Lt=[...H.existingFileUrls,...er],{error:Yt}=await Ue.from("work_logs").update({work_date:H.work_date,morning_work:Et,afternoon_work:Xt,next_day_work:H.next_day_work,special_notes:H.special_notes,file_urls:Lt}).eq("id",le);if(Yt)throw Yt;u(!1),Ce(),G(),Z(" .","success")}catch(er){console.error("Error updating worklog:",er),Z("  : "+er.message,"error")}finally{v(!1)}return}const ve=se(q.morning_tasks),Oe=se(q.afternoon_tasks);if(!ve&&!Oe){Z("      .","error");return}const qe=q.morning_tasks.filter(Et=>Et.content.trim()),ct=q.afternoon_tasks.filter(Et=>Et.content.trim());if(qe.some(Et=>!Et.progress)||ct.some(Et=>!Et.progress)){Z("   (%) .","error");return}try{v(!0);let Et=[];q.files.length>0&&(Et=await je(q.files));const Xt=[...q.existingFileUrls,...Et],{error:er}=await Ue.from("work_logs").update({work_date:q.work_date,morning_work:ve,afternoon_work:Oe,next_day_work:q.next_day_work,special_notes:q.special_notes,file_urls:Xt}).eq("id",le);if(er)throw er;u(!1),Ce(),G(),Z(" .","success")}catch(Et){console.error("Error updating worklog:",Et),Z("  : "+Et.message,"error")}finally{v(!1)}},Ce=()=>{I({work_date:Ne(),morning_tasks:[{content:"",progress:""}],afternoon_tasks:[{content:"",progress:""}],next_day_work:"",special_notes:"",files:[],existingFileUrls:[]}),Q({work_date:Ne(),morning_work:"",afternoon_work:"",next_day_work:"",special_notes:"",files:[],existingFileUrls:[]}),h(!1),g(null)},st=le=>{Q({work_date:le.work_date,morning_work:le.morning_work||"",afternoon_work:le.afternoon_work||"",next_day_work:le.next_day_work||"",special_notes:le.special_notes||"",files:[],existingFileUrls:le.file_urls||[]}),I({work_date:le.work_date,morning_tasks:re(le.morning_work),afternoon_tasks:re(le.afternoon_work),next_day_work:le.next_day_work||"",special_notes:le.special_notes||"",files:[],existingFileUrls:le.file_urls||[]}),g(le),h(!0),u(!0)},We=()=>{Ce(),u(!0)},Ze=()=>{const le=r.filter(Oe=>Oe.user_id===e?.user_id);if(le.length===0){Z("   .","info");return}const ve=le[0];X?Q(Oe=>({...Oe,morning_work:ve.morning_work||"",afternoon_work:ve.afternoon_work||"",next_day_work:ve.next_day_work||"",special_notes:""})):I(Oe=>({...Oe,morning_tasks:re(ve.morning_work),afternoon_tasks:re(ve.afternoon_work),next_day_work:ve.next_day_work||"",special_notes:""})),Z("  .","success")},Re=(le,ve,Oe)=>{const qe=q[ve],ct=Oe===qe.length-1;le.key==="Tab"&&!le.shiftKey&&ct&&(le.preventDefault(),ie(ve),setTimeout(()=>{const Et=ve==="morning_tasks"?`[data-morning-task="${Oe+1}"]`:`[data-afternoon-task="${Oe+1}"]`;document.querySelector(Et)?.focus()},0))},pt=le=>{ee({isOpen:!0,worklog:le})},Tt=async()=>{const le=we.worklog;if(le){ee({isOpen:!1,worklog:null});try{le.file_urls&&le.file_urls.length>0&&await $0(le.file_urls);const{error:ve}=await Ue.from("work_logs").delete().eq("id",le.id);if(ve)throw ve;G(),Z(".","success")}catch(ve){console.error("Error deleting worklog:",ve),Z(" .","error")}}},wt=async le=>{g(le),t&&!le.is_read&&(await Ue.from("work_logs").update({is_read:!0}).eq("id",le.id),G())},jt=le=>{OB(le,dt)},Pt=async le=>{const ve=`https://khwzdwewgadvpglptvua.supabase.co/functions/v1/image-proxy?url=${encodeURIComponent(le)}`,Oe=await fetch(ve);if(!Oe.ok)throw new Error(`  : ${Oe.status}`);return await Oe.arrayBuffer()},Le=async le=>{const ve={top:{style:or.SINGLE,size:1,color:"000000"},bottom:{style:or.SINGLE,size:1,color:"000000"},left:{style:or.SINGLE,size:1,color:"000000"},right:{style:or.SINGLE,size:1,color:"000000"}},Oe=Lt=>{if(!Lt)return[new xr({children:[new yt({children:[new lt({text:"-",alignment:Ot.CENTER})],width:{size:600,type:Ut.DXA},borders:ve}),new yt({children:[new lt({text:""})],borders:ve}),new yt({children:[new lt({text:"-",alignment:Ot.CENTER})],width:{size:1e3,type:Ut.DXA},borders:ve})]})];const Rr=Lt.includes("---TASK---")?Lt.split(ue).filter(Dr=>Dr.trim()):Lt.split(`
`).filter(Dr=>Dr.trim());return Rr.length===0?[new xr({children:[new yt({children:[new lt({text:"-",alignment:Ot.CENTER})],width:{size:600,type:Ut.DXA},borders:ve}),new yt({children:[new lt({text:""})],borders:ve}),new yt({children:[new lt({text:"-",alignment:Ot.CENTER})],width:{size:1e3,type:Ut.DXA},borders:ve})]})]:Rr.map((Dr,fe)=>{const _e=Dr.trim().split(`
`),ye=_e[_e.length-1].match(/^(.+?)\s*\((\d+)%\)$/);let Se=Dr.trim(),ke="-";ye&&_e.length===1?(Se=ye[1].trim(),ke=ye[2]+"%"):ye&&_e.length>1&&(_e[_e.length-1]=ye[1].trim(),Se=_e.join(`
`),ke=ye[2]+"%");const $e=Se.split(`
`).map(at=>new lt({text:at}));return new xr({children:[new yt({children:[new lt({text:String(fe+1),alignment:Ot.CENTER})],width:{size:600,type:Ut.DXA},borders:ve}),new yt({children:$e,borders:ve}),new yt({children:[new lt({text:ke,alignment:Ot.CENTER})],width:{size:1e3,type:Ut.DXA},borders:ve})]})})},qe=[],ct=[];if(le.file_urls&&le.file_urls.length>0){const Lt=le.file_urls.filter(Yt=>{const Rr=Ec(Yt);return by({url:Rr})});for(const Yt of Lt)try{const Rr=Ec(Yt),Dr=await Pt(Rr),fe=new Blob([Dr]),_e=URL.createObjectURL(fe),ge=new Image;ge.src=_e,await new Promise((gt,me)=>{ge.onload=gt,ge.onerror=me});const ye=240,Se=320;let ke=ge.width,$e=ge.height;const at=Math.min(ye/ke,Se/$e,1);ke=Math.round(ke*at),$e=Math.round($e*at);const He=document.createElement("canvas"),Ge=He.getContext("2d");He.width=ke,He.height=$e,Ge.drawImage(ge,0,0,ke,$e);let Ve=.7,ht=await new Promise(gt=>{He.toBlob(gt,"image/jpeg",Ve)});const vt=300*1024;for(;ht.size>vt&&Ve>.3;)Ve-=.1,ht=await new Promise(gt=>{He.toBlob(gt,"image/jpeg",Ve)});const Nt=await ht.arrayBuffer();URL.revokeObjectURL(_e),qe.push({data:Nt,width:ke,height:$e})}catch(Rr){console.error("  :",Rr);const Dr=typeof Yt=="string"?Yt.split("/").pop():Yt.name||"";ct.push(Dr)}}const Et=[];for(let Lt=0;Lt<qe.length;Lt+=2){const Yt=[];Yt.push(new yt({children:[new lt({children:[new MN({data:qe[Lt].data,transformation:{width:qe[Lt].width,height:qe[Lt].height},type:"jpg"})],alignment:Ot.CENTER})],width:{size:50,type:Ut.PERCENTAGE},borders:{top:{style:or.NONE},bottom:{style:or.NONE},left:{style:or.NONE},right:{style:or.NONE}}})),Lt+1<qe.length?Yt.push(new yt({children:[new lt({children:[new MN({data:qe[Lt+1].data,transformation:{width:qe[Lt+1].width,height:qe[Lt+1].height},type:"jpg"})],alignment:Ot.CENTER})],width:{size:50,type:Ut.PERCENTAGE},borders:{top:{style:or.NONE},bottom:{style:or.NONE},left:{style:or.NONE},right:{style:or.NONE}}})):Yt.push(new yt({children:[new lt({text:""})],width:{size:50,type:Ut.PERCENTAGE},borders:{top:{style:or.NONE},bottom:{style:or.NONE},left:{style:or.NONE},right:{style:or.NONE}}})),Et.push(new xr({children:Yt}))}const Xt=new Z0({sections:[{properties:{},children:[new lt({children:[new Rt({text:"      ",bold:!0,size:48})],alignment:Ot.CENTER,spacing:{after:400},border:{bottom:{style:or.SINGLE,size:12,color:"333333"}}}),new lt({text:"",spacing:{after:200}}),new Sa({rows:[new xr({children:[new yt({children:[new lt({text:"",alignment:Ot.CENTER})],width:{size:1500,type:Ut.DXA},shading:{fill:"F8F9FA"},borders:ve}),new yt({children:[new lt({text:dt(le.work_date)})],width:{size:3e3,type:Ut.DXA},borders:ve}),new yt({children:[new lt({text:"",alignment:Ot.CENTER})],width:{size:1500,type:Ut.DXA},shading:{fill:"F8F9FA"},borders:ve}),new yt({children:[new lt({text:le.user?.team||"-"})],width:{size:3e3,type:Ut.DXA},borders:ve})]}),new xr({children:[new yt({children:[new lt({text:"",alignment:Ot.CENTER})],shading:{fill:"F8F9FA"},borders:ve}),new yt({children:[new lt({text:le.user?.rank||"-"})],borders:ve}),new yt({children:[new lt({text:"",alignment:Ot.CENTER})],shading:{fill:"F8F9FA"},borders:ve}),new yt({children:[new lt({text:le.user?.name||"-"})],borders:ve})]})],width:{size:100,type:Ut.PERCENTAGE}}),new lt({text:"",spacing:{after:300}}),new Sa({rows:[new xr({children:[new yt({children:[new lt({children:[new Rt({text:".  ",bold:!0})]})],columnSpan:3,shading:{fill:"F8F9FA"},borders:ve})]}),new xr({children:[new yt({children:[new lt({text:"No",alignment:Ot.CENTER})],width:{size:600,type:Ut.DXA},shading:{fill:"F8F9FA"},borders:ve}),new yt({children:[new lt({text:" ",alignment:Ot.CENTER})],shading:{fill:"F8F9FA"},borders:ve}),new yt({children:[new lt({text:"",alignment:Ot.CENTER})],width:{size:1e3,type:Ut.DXA},shading:{fill:"F8F9FA"},borders:ve})]}),...Oe(le.morning_work)],width:{size:100,type:Ut.PERCENTAGE}}),new lt({text:"",spacing:{after:200}}),new Sa({rows:[new xr({children:[new yt({children:[new lt({children:[new Rt({text:".  ",bold:!0})]})],columnSpan:3,shading:{fill:"F8F9FA"},borders:ve})]}),new xr({children:[new yt({children:[new lt({text:"No",alignment:Ot.CENTER})],width:{size:600,type:Ut.DXA},shading:{fill:"F8F9FA"},borders:ve}),new yt({children:[new lt({text:" ",alignment:Ot.CENTER})],shading:{fill:"F8F9FA"},borders:ve}),new yt({children:[new lt({text:"",alignment:Ot.CENTER})],width:{size:1e3,type:Ut.DXA},shading:{fill:"F8F9FA"},borders:ve})]}),...Oe(le.afternoon_work)],width:{size:100,type:Ut.PERCENTAGE}}),new lt({text:"",spacing:{after:200}}),new Sa({rows:[new xr({children:[new yt({children:[new lt({children:[new Rt({text:".  ",bold:!0})]})],shading:{fill:"F8F9FA"},borders:ve})]}),new xr({children:[new yt({children:[new lt({text:le.next_day_work||"-"})],borders:ve})]})],width:{size:100,type:Ut.PERCENTAGE}}),new lt({text:"",spacing:{after:200}}),new Sa({rows:[new xr({children:[new yt({children:[new lt({children:[new Rt({text:".   ",bold:!0})]})],shading:{fill:"F8F9FA"},borders:ve})]}),new xr({children:[new yt({children:[new lt({text:le.special_notes||"-"})],borders:ve})]})],width:{size:100,type:Ut.PERCENTAGE}}),new lt({text:"",spacing:{after:400}}),new lt({children:[new Rt({text:"",bold:!0,size:28})],alignment:Ot.CENTER}),...qe.length>0?[new lt({text:"",spacing:{after:300}}),new lt({children:[new Rt({text:" ",bold:!0,size:24})]}),new Sa({rows:Et,width:{size:100,type:Ut.PERCENTAGE}})]:[],...ct.length>0?[new lt({text:""}),new lt({children:[new Rt({text:"(   )",italics:!0,color:"666666"})]}),...ct.map((Lt,Yt)=>new lt({children:[new Rt({text:`${Yt+1}. ${Lt}`,color:"0066CC"})]}))]:[]]}]}),er=await Q0.toBlob(Xt);em.saveAs(er,`_${le.work_date}_${le.user?.name||""}.docx`)},nt=le=>{const ve=["","","","","","",""],Oe=new Date(le);return ve[Oe.getDay()]},dt=le=>new Date(le).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})+` (${nt(le)})`,Ae=L*P,Je=Ae-P,Ee=a.slice(Je,Ae),Pe=Math.ceil(a.length/P),he=le=>{O(le)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(At,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(Ws,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:t?"  ":`${e?.name||""}  `}),n.jsx("p",{className:"text-white/90",children:t?"        ":`${e?.team?`${e.team}  `:""}${e?.rank||" "}`})]})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),n.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[n.jsx("select",{value:_,onChange:le=>b(Number(le.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:de.map(le=>n.jsxs("option",{value:le,children:[le,""]},le))}),n.jsx("select",{value:N,onChange:le=>S(Number(le.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:U.map(le=>n.jsxs("option",{value:le,children:[le,""]},le))}),t&&A.length>0&&n.jsxs("select",{value:E,onChange:le=>R(le.target.value),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:[n.jsx("option",{value:"all",children:" "}),A.map(le=>n.jsx("option",{value:le.user_id,children:le.name},le.user_id))]}),n.jsxs(rt,{variant:"secondary",onClick:M,children:[n.jsx(na,{size:18})," ",V.size>0&&`(${V.size})`]}),n.jsxs(rt,{onClick:We,children:[n.jsx(Ns,{size:18}),"  "]})]})]}),n.jsx(At,{padding:"p-0 sm:p-6",children:m?n.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:" ..."}):Ee.length>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full min-w-[800px]",children:[n.jsx("thead",{className:"bg-toss-gray-100 border-b-2 border-toss-gray-300",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 w-10",children:n.jsx("input",{type:"checkbox",checked:Ee.length>0&&Ee.every(le=>V.has(le.id)),onChange:K,className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),t&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700",children:" "}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700",children:" "}),n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:Ee.map((le,ve)=>n.jsxs("tr",{className:`hover:bg-toss-gray-50 transition-colors ${t&&!le.is_read?"bg-blue-50":""}`,children:[n.jsx("td",{className:"px-3 py-3 text-center w-10",onClick:Oe=>Oe.stopPropagation(),children:n.jsx("input",{type:"checkbox",checked:V.has(le.id),onChange:()=>D(le.id),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("td",{className:"px-3 py-3 text-sm text-center text-toss-gray-600 whitespace-nowrap",children:Je+ve+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 cursor-pointer hover:text-toss-blue whitespace-nowrap",onClick:()=>wt(le),children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ha,{size:14,className:"text-toss-gray-400 flex-shrink-0"}),n.jsx("span",{children:new Date(le.work_date).toLocaleDateString("ko-KR")}),t&&!le.is_read&&n.jsx("span",{className:"inline-block bg-red-500 text-white px-1.5 py-0.5 rounded-full text-xs font-medium flex-shrink-0",children:"N"})]})}),t&&n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 cursor-pointer hover:text-toss-blue hover:underline whitespace-nowrap",onClick:Oe=>{Oe.stopPropagation(),R(le.user_id)},children:le.user?.name||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-600 whitespace-nowrap",children:le.user?.team||"-"})]}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 cursor-pointer max-w-[200px] truncate",onClick:()=>wt(le),children:W(le.morning_work)}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 cursor-pointer max-w-[200px] truncate",onClick:()=>wt(le),children:W(le.afternoon_work)}),n.jsx("td",{className:"px-3 py-3 text-center whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:Oe=>{Oe.stopPropagation(),jt(le)},className:"p-2 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"PDF ",children:n.jsx(na,{size:16})}),n.jsx("button",{onClick:Oe=>{Oe.stopPropagation(),Le(le)},className:"p-2 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"Word ",children:n.jsx(ns,{size:16})}),(e?.user_id===le.user_id||t)&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>st(le),className:"p-2 text-blue-500 hover:bg-blue-100 rounded-lg transition-colors",title:"",children:n.jsx(aa,{size:16})}),n.jsx("button",{onClick:()=>pt(le),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(cr,{size:16})})]})]})})]},le.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:Ee.map((le,ve)=>n.jsxs("div",{className:`p-4 ${t&&!le.is_read?"bg-blue-50":""}`,onClick:()=>wt(le),children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",checked:V.has(le.id),onChange:()=>D(le.id),onClick:Oe=>Oe.stopPropagation(),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["#",Je+ve+1]}),n.jsx(ha,{size:14,className:"text-toss-gray-400"}),n.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:new Date(le.work_date).toLocaleDateString("ko-KR")}),t&&!le.is_read&&n.jsx("span",{className:"bg-red-500 text-white px-2 py-0.5 rounded-full text-xs font-medium",children:"NEW"})]}),n.jsxs("div",{className:"flex items-center gap-1",onClick:Oe=>Oe.stopPropagation(),children:[n.jsx("button",{onClick:()=>jt(le),className:"p-1.5 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg",title:"PDF ",children:n.jsx(na,{size:14})}),n.jsx("button",{onClick:()=>Le(le),className:"p-1.5 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg",title:"Word ",children:n.jsx(ns,{size:14})}),(e?.user_id===le.user_id||t)&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>st(le),className:"p-1.5 text-blue-500 hover:bg-blue-100 rounded-lg",children:n.jsx(aa,{size:14})}),n.jsx("button",{onClick:()=>pt(le),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:n.jsx(cr,{size:14})})]})]})]}),t&&n.jsxs("div",{className:"text-xs text-toss-gray-600 mb-2",children:[n.jsx("span",{className:"font-medium",children:le.user?.name||"-"}),n.jsx("span",{className:"mx-1",children:""}),n.jsx("span",{children:le.user?.team||"-"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("p",{className:"text-sm text-toss-gray-700 line-clamp-1",children:[n.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),W(le.morning_work)]}),n.jsxs("p",{className:"text-sm text-toss-gray-700 line-clamp-1",children:[n.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),W(le.afternoon_work)]})]})]},le.id))}),Pe>1&&n.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-toss-gray-200",children:[n.jsx("button",{onClick:()=>he(L-1),disabled:L===1,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),[...Array(Pe)].map((le,ve)=>n.jsx("button",{onClick:()=>he(ve+1),className:`px-3 py-1 rounded-lg text-sm font-medium ${L===ve+1?"bg-toss-blue text-white":"text-toss-gray-700 hover:bg-toss-gray-100"}`,children:ve+1},ve+1)),n.jsx("button",{onClick:()=>he(L+1),disabled:L===Pe,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]}):n.jsxs("div",{className:"text-center text-toss-gray-500 py-8",children:[_," ",N,"   "]})}),n.jsx(yr,{isOpen:c,onClose:()=>{u(!1),Ce()},title:d?"  ":"   ",children:n.jsxs("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto pr-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),n.jsx("input",{type:"date",value:X?H.work_date:q.work_date,onChange:le=>X?Q({...H,work_date:le.target.value}):I({...q,work_date:le.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all"}),n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:dt(X?H.work_date:q.work_date)})]}),!d&&n.jsxs("button",{type:"button",onClick:Ze,className:"flex items-center gap-2 px-4 py-2.5 bg-toss-gray-100 text-toss-gray-700 rounded-xl hover:bg-toss-gray-200 transition-colors text-sm font-medium w-full justify-center",children:[n.jsx(u4,{size:16}),"  "]}),X?n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:H.morning_work,onChange:le=>Q({...H,morning_work:le.target.value}),rows:4,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"    "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:H.afternoon_work,onChange:le=>Q({...H,afternoon_work:le.target.value}),rows:4,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"    "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:H.next_day_work,onChange:le=>Q({...H,next_day_work:le.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"   "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"()"}),n.jsx("textarea",{value:H.special_notes,onChange:le=>Q({...H,special_notes:le.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),d&&H.existingFileUrls.length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("div",{className:"space-y-2",children:H.existingFileUrls.map((le,ve)=>{const Oe=le.split("/").pop();return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:Oe})]}),n.jsx("button",{onClick:()=>{Q(qe=>({...qe,existingFileUrls:qe.existingFileUrls.filter((ct,Et)=>Et!==ve)}))},className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(pr,{size:16})})]},ve)})})]})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsxs("div",{className:"space-y-2",children:[q.morning_tasks.map((le,ve)=>n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"w-6 text-center text-sm font-medium text-toss-gray-500 pt-3",children:ve+1}),n.jsx("textarea",{value:le.content,onChange:Oe=>z("morning_tasks",ve,"content",Oe.target.value),onKeyDown:Oe=>Re(Oe,"morning_tasks",ve),"data-morning-task":ve,rows:2,className:"flex-1 px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all resize-none leading-relaxed",placeholder:"   (Enter , Tab  )"}),n.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:le.progress,onChange:Oe=>{const qe=Oe.target.value.replace(/[^0-9]/g,"");(qe===""||parseInt(qe)>=0&&parseInt(qe)<=100)&&z("morning_tasks",ve,"progress",qe)},className:"w-16 px-2 self-stretch bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all text-center",placeholder:"%"}),q.morning_tasks.length>1&&n.jsx("button",{type:"button",onClick:()=>B("morning_tasks",ve),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:n.jsx(cr,{size:18})})]},ve)),n.jsxs("button",{type:"button",onClick:()=>ie("morning_tasks"),className:"flex items-center gap-2 px-4 py-2 text-toss-blue hover:bg-toss-blue/10 rounded-xl transition-colors text-sm font-medium",children:[n.jsx(v0,{size:16})," "]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsxs("div",{className:"space-y-2",children:[q.afternoon_tasks.map((le,ve)=>n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"w-6 text-center text-sm font-medium text-toss-gray-500 pt-3",children:ve+1}),n.jsx("textarea",{value:le.content,onChange:Oe=>z("afternoon_tasks",ve,"content",Oe.target.value),onKeyDown:Oe=>Re(Oe,"afternoon_tasks",ve),"data-afternoon-task":ve,rows:2,className:"flex-1 px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all resize-none leading-relaxed",placeholder:"   (Enter , Tab  )"}),n.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:le.progress,onChange:Oe=>{const qe=Oe.target.value.replace(/[^0-9]/g,"");(qe===""||parseInt(qe)>=0&&parseInt(qe)<=100)&&z("afternoon_tasks",ve,"progress",qe)},className:"w-16 px-2 self-stretch bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all text-center",placeholder:"%"}),q.afternoon_tasks.length>1&&n.jsx("button",{type:"button",onClick:()=>B("afternoon_tasks",ve),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:n.jsx(cr,{size:18})})]},ve)),n.jsxs("button",{type:"button",onClick:()=>ie("afternoon_tasks"),className:"flex items-center gap-2 px-4 py-2 text-toss-blue hover:bg-toss-blue/10 rounded-xl transition-colors text-sm font-medium",children:[n.jsx(v0,{size:16})," "]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:q.next_day_work,onChange:le=>I({...q,next_day_work:le.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"   "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"()"}),n.jsx("textarea",{value:q.special_notes,onChange:le=>I({...q,special_notes:le.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),d&&q.existingFileUrls.length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("div",{className:"space-y-2",children:q.existingFileUrls.map((le,ve)=>{const Oe=le.split("/").pop();return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:Oe})]}),n.jsx("button",{onClick:()=>ne(ve),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(pr,{size:16})})]},ve)})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  (  )"}),n.jsx("input",{type:"file",ref:F,multiple:!0,onChange:xe,className:"hidden"}),n.jsx("button",{type:"button",onClick:()=>F.current?.click(),className:"w-full p-6 border-2 border-dashed border-toss-gray-300 rounded-2xl hover:border-toss-blue hover:bg-toss-blue/5 transition-all",children:n.jsxs("div",{className:"flex flex-col items-center gap-2 text-toss-gray-600",children:[n.jsx(uo,{size:28}),n.jsx("span",{className:"font-medium",children:" "}),n.jsx("span",{className:"text-xs text-toss-gray-500",children:"   "})]})}),(X?H.files:q.files).length>0&&n.jsx("div",{className:"mt-4 space-y-2",children:(X?H.files:q.files).map((le,ve)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:le.name}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["(",le.size,")"]})]}),n.jsx("button",{onClick:()=>be(ve),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(pr,{size:16})})]},ve))})]}),n.jsxs("div",{className:"flex gap-3 pt-4 sticky bottom-0 bg-white",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{u(!1),Ce()},className:"flex-1",children:""}),n.jsx(rt,{onClick:d?De:Me,className:"flex-1",loading:y,disabled:y,children:y?" ...":d?"":""})]})]})}),n.jsx(yr,{isOpen:!!w&&!c,onClose:()=>g(null),title:"  ",children:w&&n.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto -mx-2 px-2",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900",children:dt(w.work_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 font-medium",children:w.user?`${w.user.name}  ${w.user.team||" "}`:"-"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[80px]",children:w.morning_work?n.jsx("div",{className:"space-y-2",children:re(w.morning_work).map((le,ve)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("span",{className:"w-6 text-center text-sm font-medium text-toss-gray-500 flex-shrink-0",children:ve+1}),n.jsx("span",{className:"flex-1 text-toss-gray-900 whitespace-pre-wrap",children:le.content}),le.progress&&n.jsxs("span",{className:"text-sm font-medium text-toss-blue flex-shrink-0",children:[le.progress,"%"]})]},ve))}):n.jsx("span",{className:"text-toss-gray-500",children:"-"})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[80px]",children:w.afternoon_work?n.jsx("div",{className:"space-y-2",children:re(w.afternoon_work).map((le,ve)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("span",{className:"w-6 text-center text-sm font-medium text-toss-gray-500 flex-shrink-0",children:ve+1}),n.jsx("span",{className:"flex-1 text-toss-gray-900 whitespace-pre-wrap",children:le.content}),le.progress&&n.jsxs("span",{className:"text-sm font-medium text-toss-blue flex-shrink-0",children:[le.progress,"%"]})]},ve))}):n.jsx("span",{className:"text-toss-gray-500",children:"-"})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[80px] whitespace-pre-wrap text-toss-gray-900",children:w.next_day_work||"-"})]}),w.special_notes&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:"()"}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 whitespace-pre-wrap text-toss-gray-900",children:w.special_notes})]}),w.file_urls&&w.file_urls.length>0&&n.jsx(LB,{urls:w.file_urls}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[n.jsxs("button",{onClick:()=>jt(w),className:"flex items-center gap-2 px-4 py-2 bg-toss-gray-100 text-toss-gray-700 rounded-xl hover:bg-toss-gray-200 transition-colors text-sm font-medium",children:[n.jsx(na,{size:16}),"PDF "]}),n.jsxs("button",{onClick:()=>Le(w),className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 rounded-xl hover:bg-blue-100 transition-colors text-sm font-medium",children:[n.jsx(JO,{size:16}),"Word "]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>g(null),className:"flex-1",children:""}),n.jsx(rt,{onClick:()=>st(w),className:"flex-1",children:""})]})]})}),ae.isOpen&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:1e4},onClick:()=>te({...ae,isOpen:!1}),children:n.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl animate-in fade-in zoom-in duration-200",onClick:le=>le.stopPropagation(),children:n.jsxs("div",{className:"flex flex-col items-center text-center",children:[n.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center mb-4 ${ae.type==="success"?"bg-green-100":ae.type==="error"?"bg-red-100":"bg-blue-100"}`,children:ae.type==="success"?n.jsx(Hs,{className:"w-7 h-7 text-green-600"}):ae.type==="error"?n.jsx(_n,{className:"w-7 h-7 text-red-600"}):n.jsx(_n,{className:"w-7 h-7 text-blue-600"})}),n.jsx("p",{className:"text-toss-gray-900 font-medium mb-6 leading-relaxed",children:ae.message}),n.jsx("button",{onClick:()=>te({...ae,isOpen:!1}),className:`w-full py-3 rounded-xl font-medium transition-colors ${ae.type==="success"?"bg-green-500 hover:bg-green-600 text-white":ae.type==="error"?"bg-red-500 hover:bg-red-600 text-white":"bg-toss-blue hover:bg-blue-600 text-white"}`,children:""})]})})}),we.isOpen&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:1e4},onClick:()=>ee({isOpen:!1,worklog:null}),children:n.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl animate-in fade-in zoom-in duration-200",onClick:le=>le.stopPropagation(),children:n.jsxs("div",{className:"flex flex-col items-center text-center",children:[n.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center mb-4 bg-red-100",children:n.jsx(cr,{className:"w-7 h-7 text-red-600"})}),n.jsx("p",{className:"text-toss-gray-900 font-medium mb-6 leading-relaxed",children:" ?"}),n.jsxs("div",{className:"flex gap-3 w-full",children:[n.jsx("button",{onClick:()=>ee({isOpen:!1,worklog:null}),className:"flex-1 py-3 rounded-xl font-medium transition-colors bg-gray-100 hover:bg-gray-200 text-toss-gray-700",children:""}),n.jsx("button",{onClick:Tt,className:"flex-1 py-3 rounded-xl font-medium transition-colors bg-red-500 hover:bg-red-600 text-white",children:""})]})]})})})]})},hv=()=>({content:"",progress:"",remark:""}),Zo=()=>({title:"",details:[hv()]}),S0=e=>{const t=e.filter(r=>r.title.trim()||r.details.some(s=>s.content.trim()));return t.length>0?JSON.stringify(t):""},ci=e=>{if(!e)return[Zo()];try{const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0&&typeof t[0]=="object"){if("details"in t[0])return t;if("content"in t[0])return t.map(r=>({title:r.title||"",details:[{content:r.content||"",progress:r.progress||"",remark:r.remark||""}]}))}}catch{}return[{title:"",details:[{content:e,progress:"",remark:""}]}]},k0=e=>{if(!e)return"-";try{const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0){const r=t[0],s=t.length>1?`  ${t.length-1}`:"";if("details"in r)return((r.title||r.details?.[0]?.content||"-")+s).substring(0,80);if("content"in r)return((r.title||r.content)+s).substring(0,80)}}catch{}return e.substring(0,80)},MB=e=>e?e.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0","").replace("?dl=1","").replace("&dl=1",""):"",u0=e=>{let t="";return typeof e=="string"?t=e:e&&e.url&&(t=e.url),MB(t)},QN=e=>{const t=u0(e);if(!t)return!1;const r=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],s=t.toLowerCase();return r.some(a=>s.includes(a))},PB=({urls:e})=>{const t=Y.useRef(null),[r,s]=Y.useState(!1),[a,o]=Y.useState(!1),[c,u]=Y.useState(null),[d,h]=Y.useState(!1),[m,x]=Y.useState(0),[y,v]=Y.useState(0),w=e.filter(QN),g=e.filter(D=>!QN(D)),_=()=>{if(t.current){const{scrollLeft:D,scrollWidth:K,clientWidth:M}=t.current;s(D>0),o(D<K-M-10)}};Y.useEffect(()=>(_(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)),[e]),Y.useEffect(()=>{const D=K=>{c!==null&&(K.key==="ArrowLeft"&&E(),K.key==="ArrowRight"&&R(),K.key==="Escape"&&S())};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[c,w.length]);const b=D=>{t.current&&(t.current.scrollBy({left:D==="left"?-200:200,behavior:"smooth"}),setTimeout(_,300))},N=D=>{u(D),v(0)},S=()=>{u(null),v(0)},E=()=>{v(0),u(D=>D!==null&&D>0?D-1:w.length-1)},R=()=>{v(0),u(D=>D!==null&&D<w.length-1?D+1:0)},L=D=>{w.length<=1||(h(!0),x(D.clientX))},O=D=>{w.length<=1||(h(!0),x(D.touches[0].clientX))},P=D=>{if(!d)return;const K=D-m;v(K)},F=D=>{P(D.clientX)},V=D=>{P(D.touches[0].clientX)},oe=()=>{if(!d)return;h(!1);const D=100;y>D?E():y<-D?R():v(0)};return w.length===0&&g.length===0?null:n.jsxs("div",{className:"space-y-3",children:[w.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:[" (",w.length,")"]}),n.jsxs("div",{className:"relative",children:[r&&n.jsx("button",{onClick:()=>b("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx(za,{size:20})}),n.jsx("div",{ref:t,onScroll:_,className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:w.map((D,K)=>{const M=u0(D);return n.jsx("div",{className:"flex-shrink-0 cursor-pointer w-24 h-24 sm:w-32 sm:h-32 rounded-xl overflow-hidden bg-toss-gray-100",onClick:()=>N(K),children:n.jsx("img",{src:M,alt:`  ${K+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:ae=>{ae.target.style.display="none"}})},K)})}),a&&n.jsx("button",{onClick:()=>b("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx(pa,{size:20})})]})]}),g.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:["  (",g.length,")"]}),n.jsx("div",{className:"space-y-2",children:g.map((D,K)=>{const M=u0(D),ae=typeof D=="string"?M.split("/").pop():D.name||M.split("/").pop();return n.jsxs("a",{href:M,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-blue hover:underline flex-1 truncate",children:ae}),n.jsx(ns,{size:16,className:"text-toss-gray-500"})]},K)})})]}),c!==null&&n.jsxs("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center select-none",style:{zIndex:9999},onClick:S,onMouseUp:oe,onMouseLeave:oe,onTouchEnd:oe,children:[n.jsx("button",{className:"absolute top-4 right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors",onClick:S,children:n.jsx(pr,{size:24})}),n.jsxs("div",{className:"absolute top-4 left-4 z-10 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm font-medium",children:[c+1," / ",w.length]}),n.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[w.length>1&&n.jsx("button",{onClick:D=>{D.stopPropagation(),E()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:n.jsx(za,{size:36,strokeWidth:3})}),n.jsx("div",{onClick:D=>D.stopPropagation(),onMouseDown:L,onMouseMove:F,onTouchStart:O,onTouchMove:V,className:"max-w-[70vw] sm:max-w-[80vw] max-h-[90vh] relative cursor-grab active:cursor-grabbing",style:{transform:`translateX(${y}px)`,transition:d?"none":"transform 0.3s ease-out"},children:n.jsx("img",{src:u0(w[c]),alt:`  ${c+1}`,className:"max-w-full max-h-[90vh] object-contain rounded-lg pointer-events-none",draggable:!1})}),w.length>1&&n.jsx("button",{onClick:D=>{D.stopPropagation(),R()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:n.jsx(pa,{size:36,strokeWidth:3})})]}),w.length>1&&n.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2",children:w.map((D,K)=>n.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${K===c?"bg-white":"bg-white/30"}`},K))})]})]})},BB=()=>{const{profile:e,isAdmin:t}=Yr(),[r,s]=Y.useState([]),[a,o]=Y.useState([]),[c,u]=Y.useState(!1),[d,h]=Y.useState(!1),[m,x]=Y.useState(!0),[y,v]=Y.useState(!1),[w,g]=Y.useState(null),[_,b]=Y.useState(new Date().getFullYear()),[N,S]=Y.useState(new Date().getMonth()+1),[E,R]=Y.useState("all"),[L,O]=Y.useState(1),P=15,F=Y.useRef(null),[V,oe]=Y.useState(new Set),[D,K]=Y.useState(!1),[M,ae]=Y.useState(!1),[te,Z]=Y.useState(""),we=()=>{const Ee=new Date;return Ee.getDay()===1&&Ee.setDate(Ee.getDate()-3),Ee.toISOString().split("T")[0]},[ee,Ne]=Y.useState({work_date:we(),weekly_tasks:[Zo()],this_week_work:"",special_notes:"",files:[],existingFileUrls:[]}),q=2026,I=new Date().getFullYear(),X=Array.from({length:I-q+1},(Ee,Pe)=>q+Pe),H=Array.from({length:12},(Ee,Pe)=>Pe+1);Y.useEffect(()=>{B()},[]),Y.useEffect(()=>{Q()},[r,_,N,E]);const Q=()=>{const Ee=r.filter(Pe=>{const he=new Date(Pe.work_date),le=he.getFullYear()===_&&he.getMonth()+1===N,ve=E==="all"||Pe.user_id===E;return le&&ve});o(Ee),O(1)},ie=Array.from(new Set(r.map(Ee=>Ee.user_id))).map(Ee=>{const Pe=r.find(he=>he.user_id===Ee);return{user_id:Ee,name:Pe?.user?.name||"  "}}).sort((Ee,Pe)=>Ee.name.localeCompare(Pe.name)),B=async()=>{try{let Ee=Ue.from("work_logs").select("*").eq("type","weekly").order("work_date",{ascending:!1});!t&&e&&(Ee=Ee.eq("user_id",e.user_id));const{data:Pe,error:he}=await Ee;if(he)throw he;const{data:le,error:ve}=await Ue.from("users").select("user_id, name, team, rank");if(ve)throw ve;const Oe=(Pe||[]).map(qe=>{const ct=(le||[]).find(Et=>Et.user_id===qe.user_id);return{...qe,user:ct||{name:"  ",team:"-",rank:"-"}}});s(Oe)}catch(Ee){console.error("Error fetching worklogs:",Ee)}finally{x(!1)}},z=()=>{Ne(Ee=>({...Ee,weekly_tasks:[...Ee.weekly_tasks,Zo()]}))},ue=Ee=>{Ne(Pe=>({...Pe,weekly_tasks:Pe.weekly_tasks.filter((he,le)=>le!==Ee)}))},se=(Ee,Pe)=>{Ne(he=>({...he,weekly_tasks:he.weekly_tasks.map((le,ve)=>ve===Ee?{...le,title:Pe}:le)}))},re=Ee=>{Ne(Pe=>({...Pe,weekly_tasks:Pe.weekly_tasks.map((he,le)=>le===Ee?{...he,details:[...he.details,hv()]}:he)}))},W=(Ee,Pe)=>{Ne(he=>({...he,weekly_tasks:he.weekly_tasks.map((le,ve)=>ve===Ee?{...le,details:le.details.filter((Oe,qe)=>qe!==Pe)}:le)}))},ce=(Ee,Pe,he,le)=>{Ne(ve=>({...ve,weekly_tasks:ve.weekly_tasks.map((Oe,qe)=>qe===Ee?{...Oe,details:Oe.details.map((ct,Et)=>Et===Pe?{...ct,[he]:le}:ct)}:Oe)}))},k=Ee=>{const he=Array.from(Ee.target.files||[]).map(le=>({file:le,name:le.name,size:(le.size/1024).toFixed(0)+"KB"}));Ne(le=>({...le,files:[...le.files,...he]}))},de=Ee=>{Ne(Pe=>({...Pe,files:Pe.files.filter((he,le)=>le!==Ee)}))},U=Ee=>{Ne(Pe=>({...Pe,existingFileUrls:Pe.existingFileUrls.filter((he,le)=>le!==Ee)}))},T=async Ee=>{const Pe=`/intranet/worklogs/weekly/${e.user_id}`;return(await Gd(Ee.map(le=>le.file),Pe)).map(le=>le.url)},A=async()=>{const Ee=S0(ee.weekly_tasks);if(!Ee){alert("    .");return}try{v(!0);let Pe=[];ee.files.length>0&&(Pe=await T(ee.files));const{error:he}=await Ue.from("work_logs").insert({work_date:ee.work_date,morning_work:Ee,this_week_work:ee.this_week_work,special_notes:ee.special_notes,file_urls:Pe,user_id:e.user_id,type:"weekly",is_read:!1});if(he)throw he;u(!1),je(),B(),alert("  .")}catch(Pe){console.error("Error creating worklog:",Pe),alert("   : "+Pe.message)}finally{v(!1)}},G=async()=>{const Ee=S0(ee.weekly_tasks);if(!Ee){alert("    .");return}if(!w?.id){alert("    .");return}const Pe=w.id;try{v(!0);let he=[];ee.files.length>0&&(he=await T(ee.files));const le=[...ee.existingFileUrls,...he],{error:ve}=await Ue.from("work_logs").update({work_date:ee.work_date,morning_work:Ee,this_week_work:ee.this_week_work,special_notes:ee.special_notes,file_urls:le}).eq("id",Pe);if(ve)throw ve;u(!1),je(),B(),alert("  .")}catch(he){console.error("Error updating worklog:",he),alert("   : "+he.message)}finally{v(!1)}},xe=Ee=>{const Pe=new Date(Ee),he=Pe.getDay(),le=new Date(Pe),ve=he===0?-6:1-he;le.setDate(Pe.getDate()+ve);const Oe=new Date(le);return Oe.setDate(le.getDate()+4),{start:le.toISOString().split("T")[0],end:Oe.toISOString().split("T")[0]}},be=Ee=>{if(!Ee)return"";let Pe=Ee.replace(/\n---TASK---\n/g,`
`);return Pe=Pe.replace(/\s*\(\d+%\)/g,""),Pe.trim()},ne=async()=>{if(e?.user_id){K(!0);try{const{start:Ee,end:Pe}=xe(ee.work_date),{data:he,error:le}=await Ue.from("work_logs").select("work_date, morning_work, afternoon_work").eq("user_id",e.user_id).eq("type","daily").gte("work_date",Ee).lte("work_date",Pe).order("work_date",{ascending:!0});if(le)throw le;if(!he||he.length===0){alert("     .");return}const ve=["","","","","","",""],Oe=[];he.forEach(ct=>{const Et=new Date(ct.work_date),Xt=ve[Et.getDay()],er=`${Et.getMonth()+1}/${Et.getDate()}`,Lt=be(ct.morning_work),Yt=be(ct.afternoon_work);(Lt||Yt)&&(Oe.push(`[${Xt}(${er})]`),Lt&&Lt.split(`
`).forEach(Rr=>{Rr.trim()&&Oe.push(`- ${Rr.trim()}`)}),Yt&&Yt.split(`
`).forEach(Rr=>{Rr.trim()&&Oe.push(`- ${Rr.trim()}`)}),Oe.push(""))});const qe=Oe.join(`
`).trim();if(!qe){alert("      .");return}Z(qe),ae(!0)}catch(Ee){console.error("Error fetching daily worklogs:",Ee),alert("   .")}finally{K(!1)}}},je=()=>{Ne({work_date:we(),weekly_tasks:[Zo()],this_week_work:"",special_notes:"",files:[],existingFileUrls:[]}),h(!1),g(null)},Me=Ee=>{Ne({work_date:Ee.work_date,weekly_tasks:ci(Ee.morning_work||""),this_week_work:Ee.this_week_work||"",special_notes:Ee.special_notes||"",files:[],existingFileUrls:Ee.file_urls||[]}),g(Ee),h(!0),u(!0)},De=()=>{je(),u(!0)},Ce=async Ee=>{if(confirm(" ?"))try{Ee.file_urls&&Ee.file_urls.length>0&&await $0(Ee.file_urls);const{error:Pe}=await Ue.from("work_logs").delete().eq("id",Ee.id);if(Pe)throw Pe;B(),alert(".")}catch(Pe){console.error("Error deleting worklog:",Pe),alert(" .")}},st=async Ee=>{g(Ee),t&&!Ee.is_read&&(await Ue.from("work_logs").update({is_read:!0}).eq("id",Ee.id),B())},We=Ee=>{const Pe=new Date(Ee),he=new Date(Pe.getFullYear(),Pe.getMonth(),1),le=Math.ceil((Pe.getDate()+he.getDay())/7);return`${Pe.getMonth()+1} ${le}`},Ze=Ee=>new Date(Ee).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}),Re=async Ee=>{const Pe={top:{style:or.SINGLE,size:1,color:"333333"},bottom:{style:or.SINGLE,size:1,color:"333333"},left:{style:or.SINGLE,size:1,color:"333333"},right:{style:or.SINGLE,size:1,color:"333333"}},he={shading:{fill:"F8F9FA"},borders:Pe,verticalAlign:"center"},le=Lt=>Lt?Lt.split(`
`).map(Yt=>new lt({children:[new Rt({text:Yt||" ",size:24})],spacing:{line:360}})):[new lt({text:""})],ve=new Sa({width:{size:100,type:Ut.PERCENTAGE},rows:[new xr({children:[new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:24})],alignment:Ot.CENTER})],width:{size:15,type:Ut.PERCENTAGE},...he}),new yt({children:[new lt({children:[new Rt({text:We(Ee.work_date),size:24})]})],width:{size:35,type:Ut.PERCENTAGE},borders:Pe}),new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:24})],alignment:Ot.CENTER})],width:{size:15,type:Ut.PERCENTAGE},...he}),new yt({children:[new lt({children:[new Rt({text:Ee.user?.team||"-",size:24})]})],width:{size:35,type:Ut.PERCENTAGE},borders:Pe})]}),new xr({children:[new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:24})],alignment:Ot.CENTER})],...he}),new yt({children:[new lt({children:[new Rt({text:Ee.user?.rank||"-",size:24})]})],borders:Pe}),new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:24})],alignment:Ot.CENTER})],...he}),new yt({children:[new lt({children:[new Rt({text:Ee.user?.name||"-",size:24})]})],borders:Pe})]})]}),Oe=ci(Ee.morning_work),qe=new Sa({width:{size:100,type:Ut.PERCENTAGE},rows:[new xr({children:[new yt({children:[new lt({children:[new Rt({text:".    ",bold:!0,size:24})]})],columnSpan:4,...he})]}),new xr({children:[new yt({children:[new lt({children:[new Rt({text:"No",bold:!0,size:22})],alignment:Ot.CENTER})],width:{size:7,type:Ut.PERCENTAGE},shading:{fill:"F0F0F0"},borders:Pe}),new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:22})],alignment:Ot.CENTER})],width:{size:58,type:Ut.PERCENTAGE},shading:{fill:"F0F0F0"},borders:Pe}),new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:22})],alignment:Ot.CENTER})],width:{size:12,type:Ut.PERCENTAGE},shading:{fill:"F0F0F0"},borders:Pe}),new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:22})],alignment:Ot.CENTER})],width:{size:23,type:Ut.PERCENTAGE},shading:{fill:"F0F0F0"},borders:Pe})]}),...Oe.flatMap((Lt,Yt)=>{const Rr=(Lt.title?1:0)+Lt.details.length,Dr={top:{style:or.SINGLE,size:1,color:"CCCCCC"},bottom:{style:or.SINGLE,size:1,color:"CCCCCC"},left:{style:or.SINGLE,size:1,color:"333333"},right:{style:or.SINGLE,size:1,color:"333333"}},fe=[];return Lt.title&&fe.push(new xr({children:[new yt({children:[new lt({children:[new Rt({text:String(Yt+1),size:22})],alignment:Ot.CENTER})],borders:Pe,verticalAlign:"top",rowSpan:Rr}),new yt({children:[new lt({children:[new Rt({text:`[${Lt.title}]`,bold:!0,size:22})]})],borders:Dr,margins:{top:100,bottom:100,left:100,right:100}}),new yt({children:[new lt({text:""})],borders:Dr}),new yt({children:[new lt({text:""})],borders:Dr})]})),Lt.details.forEach((_e,ge)=>{const ye=[];_e.content.split(`
`).forEach($e=>{$e.trim()&&ye.push(new lt({children:[new Rt({text:`- ${$e}`,size:22})]}))});const ke=ge===Lt.details.length-1?Pe:Dr;fe.push(new xr({children:[...!Lt.title&&ge===0?[new yt({children:[new lt({children:[new Rt({text:String(Yt+1),size:22})],alignment:Ot.CENTER})],borders:Pe,verticalAlign:"top",rowSpan:Rr})]:[],new yt({children:ye,borders:ke,margins:{top:100,bottom:100,left:100,right:100}}),new yt({children:[new lt({children:[new Rt({text:_e.progress?_e.progress+"%":"-",size:22})],alignment:Ot.CENTER})],borders:ke,verticalAlign:"top"}),new yt({children:[new lt({children:[new Rt({text:_e.remark||"-",size:22})]})],borders:ke,margins:{left:100,right:100},verticalAlign:"top"})]}))}),fe})]}),ct=new Sa({width:{size:100,type:Ut.PERCENTAGE},rows:[new xr({children:[new yt({children:[new lt({children:[new Rt({text:".  ",bold:!0,size:24})]})],...he})]}),new xr({children:[new yt({children:le(Ee.this_week_work||" "),borders:Pe,margins:{top:kr(.15),bottom:kr(.15),left:kr(.15),right:kr(.15)}})]})]}),Et=new Sa({width:{size:100,type:Ut.PERCENTAGE},rows:[new xr({children:[new yt({children:[new lt({children:[new Rt({text:".   ",bold:!0,size:24})]})],...he})]}),new xr({children:[new yt({children:le(Ee.special_notes||" "),borders:Pe,margins:{top:kr(.15),bottom:kr(.15),left:kr(.15),right:kr(.15)}})]})]}),Xt=new Z0({sections:[{properties:{page:{margin:{top:kr(.6),bottom:kr(.8),left:kr(.8),right:kr(.8)}}},children:[new lt({children:[new Rt({text:`: ${Ze(Ee.work_date)}`,size:22,color:"666666"})],alignment:Ot.RIGHT,spacing:{after:200}}),new lt({children:[new Rt({text:"      ",bold:!0,size:44})],alignment:Ot.CENTER,spacing:{after:200},border:{bottom:{style:or.SINGLE,size:12,color:"333333"}}}),new lt({text:"",spacing:{after:300}}),ve,new lt({text:"",spacing:{after:300}}),qe,new lt({text:"",spacing:{after:300}}),ct,new lt({text:"",spacing:{after:300}}),Et,new lt({text:"",spacing:{after:400}}),new lt({children:[new Rt({text:"",bold:!0,size:26})],alignment:Ot.CENTER})]}]}),er=await Q0.toBlob(Xt);em.saveAs(er,`_${We(Ee.work_date)}_${Ee.user?.name||""}.docx`)},pt=Ee=>{RB(Ee,We)},Tt=L*P,wt=Tt-P,jt=a.slice(wt,Tt),Pt=Math.ceil(a.length/P),Le=Ee=>{O(Ee)},nt=Ee=>{oe(Pe=>{const he=new Set(Pe);return he.has(Ee)?he.delete(Ee):he.add(Ee),he})},dt=()=>{jt.length>0&&jt.every(Ee=>V.has(Ee.id))?oe(Ee=>{const Pe=new Set(Ee);return jt.forEach(he=>Pe.delete(he.id)),Pe}):oe(Ee=>{const Pe=new Set(Ee);return jt.forEach(he=>Pe.add(he.id)),Pe})},Ae=()=>{const Ee=V.size>0?a.filter(ve=>V.has(ve.id)):a,Pe=V.size>0?`  (${Ee.length})`:` (${Ee.length})`,he=ve=>ve.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>"),le=`
            <div class="section-title">  - ${Pe}</div>
            ${Ee.map((ve,Oe)=>{const qe=ci(ve.morning_work);return`
                    <div style="margin-bottom: 24px; page-break-inside: avoid;">
                        <div style="font-weight: bold; font-size: 13px; margin-bottom: 6px; color: #333;">
                            ${Oe+1}. ${We(ve.work_date)} - ${ve.user?.name||"-"} (${ve.user?.team||"-"})
                        </div>
                        <table>
                            <colgroup><col style="width:5%"/><col style="width:58%"/><col style="width:10%"/><col style="width:27%"/></colgroup>
                            <thead><tr><th>No</th><th></th><th></th><th></th></tr></thead>
                            <tbody>
                                ${qe.map((ct,Et)=>{const Xt=(ct.title?1:0)+ct.details.length,er=[];return ct.title&&er.push(`<tr>
                                            <td style="text-align:center;vertical-align:top" rowspan="${Xt}">${Et+1}</td>
                                            <td style="text-align:left;font-weight:bold;border-bottom:1px solid #ccc">[${he(ct.title)}]</td>
                                            <td style="border-bottom:1px solid #ccc"></td>
                                            <td style="border-bottom:1px solid #ccc"></td>
                                        </tr>`),ct.details.forEach((Lt,Yt)=>{const Rr=(Lt.content||"-").split(`
`).map(ge=>ge.trim()?`- ${he(ge)}`:"").filter(Boolean).join("<br/>"),fe=Yt===ct.details.length-1?"":"border-bottom:1px solid #ccc",_e=!ct.title&&Yt===0?`<td style="text-align:center;vertical-align:top" rowspan="${Xt}">${Et+1}</td>`:"";er.push(`<tr>
                                            ${_e}
                                            <td style="text-align:left;white-space:pre-line;${fe}">${Rr}</td>
                                            <td style="text-align:center;vertical-align:top;${fe}">${Lt.progress?Lt.progress+"%":"-"}</td>
                                            <td style="text-align:left;vertical-align:top;${fe}">${he(Lt.remark||"")||"-"}</td>
                                        </tr>`)}),er.join("")}).join("")}
                            </tbody>
                        </table>
                    </div>
                `}).join("")}
        `;il({title:" ",content:le})},Je=Ee=>{const Pe=ci(Ee);return n.jsx("div",{className:"bg-toss-gray-50 rounded-xl overflow-hidden",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-toss-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-center font-semibold text-toss-gray-700 whitespace-nowrap w-10",children:"No"}),n.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700",children:""}),n.jsx("th",{className:"px-3 py-2 text-center font-semibold text-toss-gray-700 whitespace-nowrap w-16",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:Pe.map((he,le)=>he.details.map((ve,Oe)=>n.jsxs("tr",{children:[Oe===0&&n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-2 text-center text-toss-gray-500",rowSpan:he.details.length,children:le+1}),n.jsx("td",{className:"px-3 py-2 text-toss-gray-900 font-medium whitespace-nowrap",rowSpan:he.details.length,children:he.title||"-"})]}),n.jsx("td",{className:"px-3 py-2 text-toss-gray-900 whitespace-pre-wrap",children:ve.content}),n.jsx("td",{className:"px-3 py-2 text-center",children:ve.progress?n.jsxs("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium ${Number(ve.progress)>=100?"bg-green-100 text-green-700":Number(ve.progress)>=50?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:[ve.progress,"%"]}):"-"}),n.jsx("td",{className:"px-3 py-2 text-toss-gray-600",children:ve.remark||"-"})]},`${le}-${Oe}`)))})]})})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(At,{className:"bg-gradient-to-r from-green-500 to-green-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(Ws,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:t?"  ":`${e?.name||""}  `}),n.jsx("p",{className:"text-white/90",children:t?"        ":`${e?.team?`${e.team}  `:""}${e?.rank||" "}`})]})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),n.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[n.jsx("select",{value:_,onChange:Ee=>b(Number(Ee.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:X.map(Ee=>n.jsxs("option",{value:Ee,children:[Ee,""]},Ee))}),n.jsx("select",{value:N,onChange:Ee=>S(Number(Ee.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:H.map(Ee=>n.jsxs("option",{value:Ee,children:[Ee,""]},Ee))}),t&&ie.length>0&&n.jsxs("select",{value:E,onChange:Ee=>R(Ee.target.value),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:[n.jsx("option",{value:"all",children:" "}),ie.map(Ee=>n.jsx("option",{value:Ee.user_id,children:Ee.name},Ee.user_id))]}),n.jsxs(rt,{variant:"secondary",onClick:Ae,children:[n.jsx(na,{size:18})," ",V.size>0&&`(${V.size})`]}),n.jsxs(rt,{onClick:De,className:"bg-green-500 hover:bg-green-600",children:[n.jsx(Ns,{size:18}),"  "]})]})]}),n.jsx(At,{padding:"p-0 sm:p-6",children:m?n.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:" ..."}):jt.length>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full min-w-[700px]",children:[n.jsx("thead",{className:"bg-toss-gray-100 border-b-2 border-toss-gray-300",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 w-10",children:n.jsx("input",{type:"checkbox",checked:jt.length>0&&jt.every(Ee=>V.has(Ee.id)),onChange:dt,className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),t&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700",children:" "}),n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:jt.map((Ee,Pe)=>n.jsxs("tr",{className:`hover:bg-toss-gray-50 transition-colors ${t&&!Ee.is_read?"bg-green-50":""}`,children:[n.jsx("td",{className:"px-3 py-3 text-center w-10",onClick:he=>he.stopPropagation(),children:n.jsx("input",{type:"checkbox",checked:V.has(Ee.id),onChange:()=>nt(Ee.id),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("td",{className:"px-3 py-3 text-sm text-center text-toss-gray-600 whitespace-nowrap",children:wt+Pe+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 cursor-pointer hover:text-green-600 whitespace-nowrap",onClick:()=>st(Ee),children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ha,{size:14,className:"text-toss-gray-400 flex-shrink-0"}),n.jsx("span",{children:We(Ee.work_date)}),t&&!Ee.is_read&&n.jsx("span",{className:"inline-block bg-green-500 text-white px-1.5 py-0.5 rounded-full text-xs font-medium flex-shrink-0",children:"N"})]})}),t&&n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 whitespace-nowrap",children:Ee.user?.name||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-600 whitespace-nowrap",children:Ee.user?.team||"-"})]}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 cursor-pointer max-w-xs truncate",onClick:()=>st(Ee),children:k0(Ee.morning_work)}),n.jsx("td",{className:"px-3 py-3 text-center whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:he=>{he.stopPropagation(),pt(Ee)},className:"p-2 text-green-600 hover:bg-green-100 rounded-lg transition-colors",title:"",children:n.jsx(na,{size:16})}),n.jsx("button",{onClick:he=>{he.stopPropagation(),Re(Ee)},className:"p-2 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"Word ",children:n.jsx(ns,{size:16})}),(e?.user_id===Ee.user_id||t)&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>Me(Ee),className:"p-2 text-green-500 hover:bg-green-100 rounded-lg transition-colors",title:"",children:n.jsx(aa,{size:16})}),n.jsx("button",{onClick:()=>Ce(Ee),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(cr,{size:16})})]})]})})]},Ee.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:jt.map((Ee,Pe)=>n.jsxs("div",{className:`p-4 ${t&&!Ee.is_read?"bg-green-50":""}`,onClick:()=>st(Ee),children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",checked:V.has(Ee.id),onChange:()=>nt(Ee.id),onClick:he=>he.stopPropagation(),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["#",wt+Pe+1]}),n.jsx(ha,{size:14,className:"text-toss-gray-400"}),n.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:We(Ee.work_date)}),t&&!Ee.is_read&&n.jsx("span",{className:"bg-green-500 text-white px-2 py-0.5 rounded-full text-xs font-medium",children:"NEW"})]}),n.jsxs("div",{className:"flex items-center gap-1",onClick:he=>he.stopPropagation(),children:[n.jsx("button",{onClick:()=>Re(Ee),className:"p-1.5 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg",children:n.jsx(ns,{size:14})}),(e?.user_id===Ee.user_id||t)&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>Me(Ee),className:"p-1.5 text-green-500 hover:bg-green-100 rounded-lg",children:n.jsx(aa,{size:14})}),n.jsx("button",{onClick:()=>Ce(Ee),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:n.jsx(cr,{size:14})})]})]})]}),t&&n.jsxs("div",{className:"text-xs text-toss-gray-600 mb-2",children:[n.jsx("span",{className:"font-medium",children:Ee.user?.name||"-"}),n.jsx("span",{className:"mx-1",children:""}),n.jsx("span",{children:Ee.user?.team||"-"})]}),n.jsx("p",{className:"text-sm text-toss-gray-700 line-clamp-2",children:k0(Ee.morning_work)})]},Ee.id))}),Pt>1&&n.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-toss-gray-200",children:[n.jsx("button",{onClick:()=>Le(L-1),disabled:L===1,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),[...Array(Pt)].map((Ee,Pe)=>n.jsx("button",{onClick:()=>Le(Pe+1),className:`px-3 py-1 rounded-lg text-sm font-medium ${L===Pe+1?"bg-green-500 text-white":"text-toss-gray-700 hover:bg-toss-gray-100"}`,children:Pe+1},Pe+1)),n.jsx("button",{onClick:()=>Le(L+1),disabled:L===Pt,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]}):n.jsxs("div",{className:"text-center text-toss-gray-500 py-8",children:[_," ",N,"    "]})}),n.jsx(yr,{isOpen:c,onClose:()=>{u(!1),je(),ae(!1),Z("")},title:d?"  ":"   ",size:M?"xl":"default",children:n.jsxs("div",{className:"flex gap-6 ",children:[n.jsxs("div",{className:`space-y-6 max-h-[70vh] overflow-y-auto pr-2 ${M?"flex-1 min-w-0":"w-full"}`,children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),n.jsx("input",{type:"date",value:ee.work_date,onChange:Ee=>Ne({...ee,work_date:Ee.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"}),n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:We(ee.work_date)})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700",children:"  *"}),n.jsxs("button",{type:"button",onClick:ne,disabled:D,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors disabled:opacity-50",children:[n.jsx(Sc,{size:14,className:D?"animate-spin":""}),D?" ...":"  "]})]}),n.jsxs("div",{className:"space-y-3",children:[ee.weekly_tasks.map((Ee,Pe)=>n.jsxs("div",{className:"bg-toss-gray-50 rounded-xl p-3 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"text",value:Ee.title,onChange:he=>se(Pe,he.target.value),className:"flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm font-medium focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:""}),ee.weekly_tasks.length>1&&n.jsx("button",{type:"button",onClick:()=>ue(Pe),className:"p-1.5 text-red-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors flex-shrink-0 w-[28px] flex items-center justify-center",title:" ",children:n.jsx(cr,{size:14})}),ee.weekly_tasks.length<=1&&n.jsx("div",{className:"w-[28px] flex-shrink-0"})]}),n.jsxs("div",{className:"hidden sm:grid sm:grid-cols-[1fr_50px_100px_28px] gap-2 px-1",children:[n.jsx("span",{className:"text-xs font-medium text-toss-gray-500",children:""}),n.jsx("span",{className:"text-xs font-medium text-toss-gray-500 text-center",children:""}),n.jsx("span",{className:"text-xs font-medium text-toss-gray-500",children:""}),n.jsx("span",{})]}),Ee.details.map((he,le)=>n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_50px_100px_28px] gap-2 items-stretch",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:""}),n.jsx("textarea",{value:he.content,onChange:ve=>ce(Pe,le,"content",ve.target.value),rows:2,className:"w-full flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all resize-none leading-relaxed",placeholder:"  "})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:"(%)"}),n.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:he.progress,onChange:ve=>{const Oe=ve.target.value.replace(/[^0-9]/g,"");(Oe===""||parseInt(Oe)>=0&&parseInt(Oe)<=100)&&ce(Pe,le,"progress",Oe)},className:"w-full flex-1 px-2 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm text-center focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"%"})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:""}),n.jsx("input",{type:"text",value:he.remark,onChange:ve=>ce(Pe,le,"remark",ve.target.value),className:"w-full flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:""})]}),n.jsx("div",{className:"flex items-center justify-center",children:Ee.details.length>1&&n.jsx("button",{type:"button",onClick:()=>W(Pe,le),className:"p-1 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:" ",children:n.jsx(pr,{size:14})})})]},le)),n.jsxs("button",{type:"button",onClick:()=>re(Pe),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[n.jsx(Ns,{size:14})," "]})]},Pe)),n.jsxs("button",{type:"button",onClick:z,className:"flex items-center gap-2 px-4 py-2 text-green-600 hover:bg-green-50 rounded-xl transition-colors text-sm font-medium",children:[n.jsx(v0,{size:16})," "]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:ee.this_week_work,onChange:Ee=>Ne({...ee,this_week_work:Ee.target.value}),rows:5,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"   "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"()"}),n.jsx("textarea",{value:ee.special_notes,onChange:Ee=>Ne({...ee,special_notes:Ee.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),d&&ee.existingFileUrls.length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("div",{className:"space-y-2",children:ee.existingFileUrls.map((Ee,Pe)=>{const he=Ee.split("/").pop();return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:he})]}),n.jsx("button",{onClick:()=>U(Pe),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(pr,{size:16})})]},Pe)})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"file",ref:F,multiple:!0,onChange:k,className:"hidden"}),n.jsx("button",{type:"button",onClick:()=>F.current?.click(),className:"w-full p-6 border-2 border-dashed border-toss-gray-300 rounded-2xl hover:border-green-500 hover:bg-green-50/50 transition-all",children:n.jsxs("div",{className:"flex flex-col items-center gap-2 text-toss-gray-600",children:[n.jsx(uo,{size:28}),n.jsx("span",{className:"font-medium",children:" "}),n.jsx("span",{className:"text-xs text-toss-gray-500",children:"   "})]})}),ee.files.length>0&&n.jsx("div",{className:"mt-4 space-y-2",children:ee.files.map((Ee,Pe)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:Ee.name}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["(",Ee.size,")"]})]}),n.jsx("button",{onClick:()=>de(Pe),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(pr,{size:16})})]},Pe))})]}),n.jsxs("div",{className:"flex gap-3 pt-4 sticky bottom-0 bg-white",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{u(!1),je()},className:"flex-1",children:""}),n.jsx(rt,{onClick:d?G:A,className:"flex-1 bg-green-500 hover:bg-green-600",loading:y,disabled:y,children:y?" ...":d?"":""})]})]}),M&&n.jsxs("div",{className:"flex-1 min-w-0 flex flex-col max-h-[70vh]",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-green-50 border border-green-200 rounded-t-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ha,{size:16,className:"text-green-600"}),n.jsx("span",{className:"text-sm font-semibold text-green-800",children:"  "})]}),n.jsx("button",{type:"button",onClick:()=>{ae(!1),Z("")},className:"p-1.5 text-green-600 hover:bg-green-100 rounded-lg transition-colors",children:n.jsx(pr,{size:16})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto border-x border-b border-green-200 rounded-b-xl bg-white px-4 py-3",children:te?n.jsx("pre",{className:"text-sm text-toss-gray-800 whitespace-pre-wrap font-sans leading-relaxed",children:te}):n.jsx("div",{className:"flex items-center justify-center h-full text-toss-gray-400 text-sm",children:" ..."})})]})]})}),n.jsx(yr,{isOpen:!!w&&!c,onClose:()=>g(null),title:"  ",children:w&&n.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto -mx-2 px-2",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900",children:We(w.work_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 font-medium",children:w.user?`${w.user.name}  ${w.user.team||" "}`:"-"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),Je(w.morning_work)]}),w.this_week_work&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 whitespace-pre-wrap text-toss-gray-900",children:w.this_week_work})]}),w.special_notes&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:"()"}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 whitespace-pre-wrap text-toss-gray-900",children:w.special_notes})]}),w.file_urls&&w.file_urls.length>0&&n.jsx(PB,{urls:w.file_urls}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[n.jsxs("button",{onClick:()=>pt(w),className:"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-600 rounded-xl hover:bg-green-100 transition-colors text-sm font-medium",children:[n.jsx(na,{size:16}),""]}),n.jsxs("button",{onClick:()=>Re(w),className:"flex items-center gap-2 px-4 py-2 bg-toss-gray-100 text-toss-gray-700 rounded-xl hover:bg-toss-gray-200 transition-colors text-sm font-medium",children:[n.jsx(ns,{size:16}),"Word "]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>g(null),className:"flex-1",children:""}),n.jsx(rt,{onClick:()=>Me(w),className:"flex-1 bg-green-500 hover:bg-green-600",children:""})]})]})})]})},UB=e=>e?e.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0","").replace("?dl=1","").replace("&dl=1",""):"",d0=e=>{let t="";return typeof e=="string"?t=e:e&&e.url&&(t=e.url),UB(t)},eE=e=>{const t=d0(e);if(!t)return!1;const r=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],s=t.toLowerCase();return r.some(a=>s.includes(a))},zB=({urls:e})=>{const t=Y.useRef(null),[r,s]=Y.useState(!1),[a,o]=Y.useState(!1),[c,u]=Y.useState(null),[d,h]=Y.useState(!1),[m,x]=Y.useState(0),[y,v]=Y.useState(0),w=e.filter(eE),g=e.filter(D=>!eE(D)),_=()=>{if(t.current){const{scrollLeft:D,scrollWidth:K,clientWidth:M}=t.current;s(D>0),o(D<K-M-10)}};Y.useEffect(()=>(_(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)),[e]),Y.useEffect(()=>{const D=K=>{c!==null&&(K.key==="ArrowLeft"&&E(),K.key==="ArrowRight"&&R(),K.key==="Escape"&&S())};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[c,w.length]);const b=D=>{t.current&&(t.current.scrollBy({left:D==="left"?-200:200,behavior:"smooth"}),setTimeout(_,300))},N=D=>{u(D),v(0)},S=()=>{u(null),v(0)},E=()=>{v(0),u(D=>D!==null&&D>0?D-1:w.length-1)},R=()=>{v(0),u(D=>D!==null&&D<w.length-1?D+1:0)},L=D=>{w.length<=1||(h(!0),x(D.clientX))},O=D=>{w.length<=1||(h(!0),x(D.touches[0].clientX))},P=D=>{if(!d)return;const K=D-m;v(K)},F=D=>{P(D.clientX)},V=D=>{P(D.touches[0].clientX)},oe=()=>{if(!d)return;h(!1);const D=100;y>D?E():y<-D?R():v(0)};return w.length===0&&g.length===0?null:n.jsxs("div",{className:"space-y-3",children:[w.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:[" (",w.length,")"]}),n.jsxs("div",{className:"relative",children:[r&&n.jsx("button",{onClick:()=>b("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx(za,{size:20})}),n.jsx("div",{ref:t,onScroll:_,className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:w.map((D,K)=>{const M=d0(D);return n.jsx("div",{className:"flex-shrink-0 cursor-pointer w-24 h-24 sm:w-32 sm:h-32 rounded-xl overflow-hidden bg-toss-gray-100",onClick:()=>N(K),children:n.jsx("img",{src:M,alt:`  ${K+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:ae=>{ae.target.style.display="none"}})},K)})}),a&&n.jsx("button",{onClick:()=>b("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx(pa,{size:20})})]})]}),g.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:["  (",g.length,")"]}),n.jsx("div",{className:"space-y-2",children:g.map((D,K)=>{const M=d0(D),ae=typeof D=="string"?M.split("/").pop():D.name||M.split("/").pop();return n.jsxs("a",{href:M,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-blue hover:underline flex-1 truncate",children:ae}),n.jsx(ns,{size:16,className:"text-toss-gray-500"})]},K)})})]}),c!==null&&n.jsxs("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center select-none",style:{zIndex:9999},onClick:S,onMouseUp:oe,onMouseLeave:oe,onTouchEnd:oe,children:[n.jsx("button",{className:"absolute top-4 right-4 z-10 p-3 bg-white/10 hover:bg-white/20 rounded-full text-white transition-colors",onClick:S,children:n.jsx(pr,{size:24})}),n.jsxs("div",{className:"absolute top-4 left-4 z-10 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm font-medium",children:[c+1," / ",w.length]}),n.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[w.length>1&&n.jsx("button",{onClick:D=>{D.stopPropagation(),E()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:n.jsx(za,{size:36,strokeWidth:3})}),n.jsx("div",{onClick:D=>D.stopPropagation(),onMouseDown:L,onMouseMove:F,onTouchStart:O,onTouchMove:V,className:"max-w-[70vw] sm:max-w-[80vw] max-h-[90vh] relative cursor-grab active:cursor-grabbing",style:{transform:`translateX(${y}px)`,transition:d?"none":"transform 0.3s ease-out"},children:n.jsx("img",{src:d0(w[c]),alt:`  ${c+1}`,className:"max-w-full max-h-[90vh] object-contain rounded-lg pointer-events-none",draggable:!1})}),w.length>1&&n.jsx("button",{onClick:D=>{D.stopPropagation(),R()},className:"flex-shrink-0 p-2 sm:p-3 text-white/80 hover:text-white transition-colors",children:n.jsx(pa,{size:36,strokeWidth:3})})]}),w.length>1&&n.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-2",children:w.map((D,K)=>n.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${K===c?"bg-white":"bg-white/30"}`},K))})]})]})},qB=()=>{const{profile:e,isAdmin:t}=Yr(),[r,s]=Y.useState([]),[a,o]=Y.useState([]),[c,u]=Y.useState(!1),[d,h]=Y.useState(!1),[m,x]=Y.useState(!0),[y,v]=Y.useState(!1),[w,g]=Y.useState(null),[_,b]=Y.useState(new Date().getFullYear()),[N,S]=Y.useState("all"),[E,R]=Y.useState(1),L=15,O=Y.useRef(null),[P,F]=Y.useState(new Set),[V,oe]=Y.useState(!1),[D,K]=Y.useState(!1),[M,ae]=Y.useState([]),[te,Z]=Y.useState({work_date:new Date().toISOString().split("T")[0],monthly_tasks:[Zo()],special_notes:"",files:[],existingFileUrls:[]}),we=2026,ee=new Date().getFullYear(),Ne=Array.from({length:ee-we+1},(Le,nt)=>we+nt);Y.useEffect(()=>{X()},[]),Y.useEffect(()=>{q()},[r,_,N]);const q=()=>{const Le=r.filter(nt=>{const Ae=new Date(nt.work_date).getFullYear()===_,Je=N==="all"||nt.user_id===N;return Ae&&Je});o(Le),R(1)},I=Array.from(new Set(r.map(Le=>Le.user_id))).map(Le=>{const nt=r.find(dt=>dt.user_id===Le);return{user_id:Le,name:nt?.user?.name||"  "}}).sort((Le,nt)=>Le.name.localeCompare(nt.name)),X=async()=>{try{let Le=Ue.from("work_logs").select("*").eq("type","monthly").order("work_date",{ascending:!1});!t&&e&&(Le=Le.eq("user_id",e.user_id));const{data:nt,error:dt}=await Le;if(dt)throw dt;const{data:Ae,error:Je}=await Ue.from("users").select("user_id, name, team, rank");if(Je)throw Je;const Ee=(nt||[]).map(Pe=>{const he=(Ae||[]).find(le=>le.user_id===Pe.user_id);return{...Pe,user:he||{name:"  ",team:"-",rank:"-"}}});s(Ee)}catch(Le){console.error("Error fetching worklogs:",Le)}finally{x(!1)}},H=()=>{Z(Le=>({...Le,monthly_tasks:[...Le.monthly_tasks,Zo()]}))},Q=Le=>{Z(nt=>({...nt,monthly_tasks:nt.monthly_tasks.filter((dt,Ae)=>Ae!==Le)}))},ie=(Le,nt)=>{Z(dt=>({...dt,monthly_tasks:dt.monthly_tasks.map((Ae,Je)=>Je===Le?{...Ae,title:nt}:Ae)}))},B=Le=>{Z(nt=>({...nt,monthly_tasks:nt.monthly_tasks.map((dt,Ae)=>Ae===Le?{...dt,details:[...dt.details,hv()]}:dt)}))},z=(Le,nt)=>{Z(dt=>({...dt,monthly_tasks:dt.monthly_tasks.map((Ae,Je)=>Je===Le?{...Ae,details:Ae.details.filter((Ee,Pe)=>Pe!==nt)}:Ae)}))},ue=(Le,nt,dt,Ae)=>{Z(Je=>({...Je,monthly_tasks:Je.monthly_tasks.map((Ee,Pe)=>Pe===Le?{...Ee,details:Ee.details.map((he,le)=>le===nt?{...he,[dt]:Ae}:he)}:Ee)}))},se=Le=>{const dt=Array.from(Le.target.files||[]).map(Ae=>({file:Ae,name:Ae.name,size:(Ae.size/1024).toFixed(0)+"KB"}));Z(Ae=>({...Ae,files:[...Ae.files,...dt]}))},re=Le=>{Z(nt=>({...nt,files:nt.files.filter((dt,Ae)=>Ae!==Le)}))},W=Le=>{Z(nt=>({...nt,existingFileUrls:nt.existingFileUrls.filter((dt,Ae)=>Ae!==Le)}))},ce=async Le=>{const nt=`/intranet/worklogs/monthly/${e.user_id}`;return(await Gd(Le.map(Ae=>Ae.file),nt)).map(Ae=>Ae.url)},k=async()=>{const Le=S0(te.monthly_tasks);if(!Le){alert("    .");return}try{v(!0);let nt=[];te.files.length>0&&(nt=await ce(te.files));const{error:dt}=await Ue.from("work_logs").insert({work_date:te.work_date,morning_work:Le,special_notes:te.special_notes,file_urls:nt,user_id:e.user_id,type:"monthly",is_read:!1});if(dt)throw dt;u(!1),A(),X(),alert("  .")}catch(nt){console.error("Error creating worklog:",nt),alert("   : "+nt.message)}finally{v(!1)}},de=async()=>{const Le=S0(te.monthly_tasks);if(!Le){alert("    .");return}if(!w?.id){alert("    .");return}const nt=w.id;try{v(!0);let dt=[];te.files.length>0&&(dt=await ce(te.files));const Ae=[...te.existingFileUrls,...dt],{error:Je}=await Ue.from("work_logs").update({work_date:te.work_date,morning_work:Le,special_notes:te.special_notes,file_urls:Ae}).eq("id",nt);if(Je)throw Je;u(!1),A(),X(),alert("  .")}catch(dt){console.error("Error updating worklog:",dt),alert("   : "+dt.message)}finally{v(!1)}},U=Le=>{const nt=new Date(Le),dt=nt.getFullYear(),Ae=nt.getMonth(),Je=new Date(dt,Ae,1).toISOString().split("T")[0],Ee=new Date(dt,Ae+1,0).toISOString().split("T")[0];return{start:Je,end:Ee}},T=async()=>{if(e?.user_id){oe(!0);try{const{start:Le,end:nt}=U(te.work_date),{data:dt,error:Ae}=await Ue.from("work_logs").select("work_date, morning_work").eq("user_id",e.user_id).eq("type","weekly").gte("work_date",Le).lte("work_date",nt).order("work_date",{ascending:!0});if(Ae)throw Ae;if(!dt||dt.length===0){alert("     .");return}const Je=[];if(dt.forEach(Ee=>{const Pe=new Date(Ee.work_date),he=new Date(Pe.getFullYear(),Pe.getMonth(),1),ve=`${Math.ceil((Pe.getDate()+he.getDay())/7)}`;ci(Ee.morning_work).forEach(qe=>{Je.push({title:qe.title?`[${ve}] ${qe.title}`:`[${ve}]`,details:qe.details})})}),Je.length===0){alert("      .");return}ae(Je),K(!0)}catch(Le){console.error("Error fetching weekly worklogs:",Le),alert("   .")}finally{oe(!1)}}},A=()=>{Z({work_date:new Date().toISOString().split("T")[0],monthly_tasks:[Zo()],special_notes:"",files:[],existingFileUrls:[]}),h(!1),g(null),K(!1),ae([])},G=Le=>{Z({work_date:Le.work_date,monthly_tasks:ci(Le.morning_work||""),special_notes:Le.special_notes||"",files:[],existingFileUrls:Le.file_urls||[]}),g(Le),h(!0),u(!0)},xe=()=>{A(),u(!0)},be=async Le=>{if(confirm(" ?"))try{Le.file_urls&&Le.file_urls.length>0&&await $0(Le.file_urls);const{error:nt}=await Ue.from("work_logs").delete().eq("id",Le.id);if(nt)throw nt;X(),alert(".")}catch(nt){console.error("Error deleting worklog:",nt),alert(" .")}},ne=async Le=>{g(Le),t&&!Le.is_read&&(await Ue.from("work_logs").update({is_read:!0}).eq("id",Le.id),X())},je=Le=>{const nt=new Date(Le);return`${nt.getFullYear()} ${nt.getMonth()+1}`},Me=Le=>new Date(Le).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}),De=async Le=>{const nt={top:{style:or.SINGLE,size:1,color:"333333"},bottom:{style:or.SINGLE,size:1,color:"333333"},left:{style:or.SINGLE,size:1,color:"333333"},right:{style:or.SINGLE,size:1,color:"333333"}},dt={shading:{fill:"F8F9FA"},borders:nt,verticalAlign:"center"},Ae=Oe=>Oe.split(`
`).map(qe=>new lt({children:[new Rt({text:qe||" ",size:24})],spacing:{line:360}})),Je=new Sa({width:{size:100,type:Ut.PERCENTAGE},rows:[new xr({children:[new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:24})],alignment:Ot.CENTER})],width:{size:15,type:Ut.PERCENTAGE},...dt}),new yt({children:[new lt({children:[new Rt({text:je(Le.work_date),size:24})]})],width:{size:35,type:Ut.PERCENTAGE},borders:nt}),new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:24})],alignment:Ot.CENTER})],width:{size:15,type:Ut.PERCENTAGE},...dt}),new yt({children:[new lt({children:[new Rt({text:Le.user?.team||"-",size:24})]})],width:{size:35,type:Ut.PERCENTAGE},borders:nt})]}),new xr({children:[new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:24})],alignment:Ot.CENTER})],...dt}),new yt({children:[new lt({children:[new Rt({text:Le.user?.rank||"-",size:24})]})],borders:nt}),new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:24})],alignment:Ot.CENTER})],...dt}),new yt({children:[new lt({children:[new Rt({text:Le.user?.name||"-",size:24})]})],borders:nt})]})]}),Ee=ci(Le.morning_work),Pe=new Sa({width:{size:100,type:Ut.PERCENTAGE},rows:[new xr({children:[new yt({children:[new lt({children:[new Rt({text:".    ",bold:!0,size:24})]})],columnSpan:4,...dt})]}),new xr({children:[new yt({children:[new lt({children:[new Rt({text:"No",bold:!0,size:22})],alignment:Ot.CENTER})],width:{size:7,type:Ut.PERCENTAGE},shading:{fill:"F0F0F0"},borders:nt}),new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:22})],alignment:Ot.CENTER})],width:{size:58,type:Ut.PERCENTAGE},shading:{fill:"F0F0F0"},borders:nt}),new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:22})],alignment:Ot.CENTER})],width:{size:12,type:Ut.PERCENTAGE},shading:{fill:"F0F0F0"},borders:nt}),new yt({children:[new lt({children:[new Rt({text:"",bold:!0,size:22})],alignment:Ot.CENTER})],width:{size:23,type:Ut.PERCENTAGE},shading:{fill:"F0F0F0"},borders:nt})]}),...Ee.flatMap((Oe,qe)=>{const ct=(Oe.title?1:0)+Oe.details.length,Et={top:{style:or.SINGLE,size:1,color:"CCCCCC"},bottom:{style:or.SINGLE,size:1,color:"CCCCCC"},left:{style:or.SINGLE,size:1,color:"333333"},right:{style:or.SINGLE,size:1,color:"333333"}},Xt=[];return Oe.title&&Xt.push(new xr({children:[new yt({children:[new lt({children:[new Rt({text:String(qe+1),size:22})],alignment:Ot.CENTER})],borders:nt,verticalAlign:"top",rowSpan:ct}),new yt({children:[new lt({children:[new Rt({text:`[${Oe.title}]`,bold:!0,size:22})]})],borders:Et,margins:{top:100,bottom:100,left:100,right:100}}),new yt({children:[new lt({text:""})],borders:Et}),new yt({children:[new lt({text:""})],borders:Et})]})),Oe.details.forEach((er,Lt)=>{const Yt=[];er.content.split(`
`).forEach(fe=>{fe.trim()&&Yt.push(new lt({children:[new Rt({text:`- ${fe}`,size:22})]}))});const Dr=Lt===Oe.details.length-1?nt:Et;Xt.push(new xr({children:[...!Oe.title&&Lt===0?[new yt({children:[new lt({children:[new Rt({text:String(qe+1),size:22})],alignment:Ot.CENTER})],borders:nt,verticalAlign:"top",rowSpan:ct})]:[],new yt({children:Yt,borders:Dr,margins:{top:100,bottom:100,left:100,right:100}}),new yt({children:[new lt({children:[new Rt({text:er.progress?er.progress+"%":"-",size:22})],alignment:Ot.CENTER})],borders:Dr,verticalAlign:"top"}),new yt({children:[new lt({children:[new Rt({text:er.remark||"-",size:22})]})],borders:Dr,margins:{left:100,right:100},verticalAlign:"top"})]}))}),Xt})]}),he=new Sa({width:{size:100,type:Ut.PERCENTAGE},rows:[new xr({children:[new yt({children:[new lt({children:[new Rt({text:".   ",bold:!0,size:24})]})],...dt})]}),new xr({children:[new yt({children:Ae(Le.special_notes||" "),borders:nt,margins:{top:kr(.15),bottom:kr(.15),left:kr(.15),right:kr(.15)}})]})]}),le=new Z0({sections:[{properties:{page:{margin:{top:kr(.6),bottom:kr(.8),left:kr(.8),right:kr(.8)}}},children:[new lt({children:[new Rt({text:`: ${Me(Le.work_date)}`,size:22,color:"666666"})],alignment:Ot.RIGHT,spacing:{after:200}}),new lt({children:[new Rt({text:"      ",bold:!0,size:44})],alignment:Ot.CENTER,spacing:{after:200},border:{bottom:{style:or.SINGLE,size:12,color:"333333"}}}),new lt({text:"",spacing:{after:300}}),Je,new lt({text:"",spacing:{after:300}}),Pe,new lt({text:"",spacing:{after:300}}),he,new lt({text:"",spacing:{after:400}}),new lt({children:[new Rt({text:"",bold:!0,size:26})],alignment:Ot.CENTER})]}]}),ve=await Q0.toBlob(le);em.saveAs(ve,`_${je(Le.work_date)}_${Le.user?.name||""}.docx`)},Ce=Le=>{DB(Le,je)},st=E*L,We=st-L,Ze=a.slice(We,st),Re=Math.ceil(a.length/L),pt=Le=>{R(Le)},Tt=Le=>{F(nt=>{const dt=new Set(nt);return dt.has(Le)?dt.delete(Le):dt.add(Le),dt})},wt=()=>{Ze.length>0&&Ze.every(Le=>P.has(Le.id))?F(Le=>{const nt=new Set(Le);return Ze.forEach(dt=>nt.delete(dt.id)),nt}):F(Le=>{const nt=new Set(Le);return Ze.forEach(dt=>nt.add(dt.id)),nt})},jt=()=>{const Le=P.size>0?a.filter(Je=>P.has(Je.id)):a,nt=P.size>0?`  (${Le.length})`:` (${Le.length})`,dt=Je=>Je.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>"),Ae=`
            <div class="section-title">  - ${nt}</div>
            ${Le.map((Je,Ee)=>{const Pe=ci(Je.morning_work);return`
                    <div style="margin-bottom: 24px; page-break-inside: avoid;">
                        <div style="font-weight: bold; font-size: 13px; margin-bottom: 6px; color: #333;">
                            ${Ee+1}. ${je(Je.work_date)} - ${Je.user?.name||"-"} (${Je.user?.team||"-"})
                        </div>
                        <table>
                            <colgroup><col style="width:5%"/><col style="width:58%"/><col style="width:10%"/><col style="width:27%"/></colgroup>
                            <thead><tr><th>No</th><th></th><th></th><th></th></tr></thead>
                            <tbody>
                                ${Pe.map((he,le)=>{const ve=(he.title?1:0)+he.details.length,Oe=[];return he.title&&Oe.push(`<tr>
                                            <td style="text-align:center;vertical-align:top" rowspan="${ve}">${le+1}</td>
                                            <td style="text-align:left;font-weight:bold;border-bottom:1px solid #ccc">[${dt(he.title)}]</td>
                                            <td style="border-bottom:1px solid #ccc"></td>
                                            <td style="border-bottom:1px solid #ccc"></td>
                                        </tr>`),he.details.forEach((qe,ct)=>{const Et=(qe.content||"-").split(`
`).map(Yt=>Yt.trim()?`- ${dt(Yt)}`:"").filter(Boolean).join("<br/>"),er=ct===he.details.length-1?"":"border-bottom:1px solid #ccc",Lt=!he.title&&ct===0?`<td style="text-align:center;vertical-align:top" rowspan="${ve}">${le+1}</td>`:"";Oe.push(`<tr>
                                            ${Lt}
                                            <td style="text-align:left;white-space:pre-line;${er}">${Et}</td>
                                            <td style="text-align:center;vertical-align:top;${er}">${qe.progress?qe.progress+"%":"-"}</td>
                                            <td style="text-align:left;vertical-align:top;${er}">${dt(qe.remark||"")||"-"}</td>
                                        </tr>`)}),Oe.join("")}).join("")}
                            </tbody>
                        </table>
                    </div>
                `}).join("")}
        `;il({title:" ",content:Ae})},Pt=Le=>{const nt=ci(Le);return n.jsx("div",{className:"bg-toss-gray-50 rounded-xl overflow-hidden",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-toss-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-center font-semibold text-toss-gray-700 whitespace-nowrap w-10",children:"No"}),n.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700",children:""}),n.jsx("th",{className:"px-3 py-2 text-center font-semibold text-toss-gray-700 whitespace-nowrap w-16",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:nt.map((dt,Ae)=>dt.details.map((Je,Ee)=>n.jsxs("tr",{children:[Ee===0&&n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-2 text-center text-toss-gray-500",rowSpan:dt.details.length,children:Ae+1}),n.jsx("td",{className:"px-3 py-2 text-toss-gray-900 font-medium whitespace-nowrap",rowSpan:dt.details.length,children:dt.title||"-"})]}),n.jsx("td",{className:"px-3 py-2 text-toss-gray-900 whitespace-pre-wrap",children:Je.content}),n.jsx("td",{className:"px-3 py-2 text-center",children:Je.progress?n.jsxs("span",{className:`inline-block px-2 py-0.5 rounded-full text-xs font-medium ${Number(Je.progress)>=100?"bg-green-100 text-green-700":Number(Je.progress)>=50?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:[Je.progress,"%"]}):"-"}),n.jsx("td",{className:"px-3 py-2 text-toss-gray-600",children:Je.remark||"-"})]},`${Ae}-${Ee}`)))})]})})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(At,{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(Ws,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:t?"  ":`${e?.name||""}  `}),n.jsx("p",{className:"text-white/90",children:t?"        ":`${e?.team?`${e.team}  `:""}${e?.rank||" "}`})]})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),n.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[n.jsx("select",{value:_,onChange:Le=>b(Number(Le.target.value)),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:Ne.map(Le=>n.jsxs("option",{value:Le,children:[Le,""]},Le))}),t&&I.length>0&&n.jsxs("select",{value:N,onChange:Le=>S(Le.target.value),className:"px-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",children:[n.jsx("option",{value:"all",children:" "}),I.map(Le=>n.jsx("option",{value:Le.user_id,children:Le.name},Le.user_id))]}),n.jsxs(rt,{variant:"secondary",onClick:jt,children:[n.jsx(na,{size:18})," ",P.size>0&&`(${P.size})`]}),n.jsxs(rt,{onClick:xe,className:"bg-purple-500 hover:bg-purple-600",children:[n.jsx(Ns,{size:18}),"  "]})]})]}),n.jsx(At,{padding:"p-0 sm:p-6",children:m?n.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:" ..."}):Ze.length>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full min-w-[700px]",children:[n.jsx("thead",{className:"bg-toss-gray-100 border-b-2 border-toss-gray-300",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 w-10",children:n.jsx("input",{type:"checkbox",checked:Ze.length>0&&Ze.every(Le=>P.has(Le.id)),onChange:wt,className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:" "}),t&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]}),n.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-toss-gray-700",children:" "}),n.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-toss-gray-700 whitespace-nowrap",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-200",children:Ze.map((Le,nt)=>n.jsxs("tr",{className:`hover:bg-toss-gray-50 transition-colors ${t&&!Le.is_read?"bg-purple-50":""}`,children:[n.jsx("td",{className:"px-3 py-3 text-center w-10",onClick:dt=>dt.stopPropagation(),children:n.jsx("input",{type:"checkbox",checked:P.has(Le.id),onChange:()=>Tt(Le.id),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("td",{className:"px-3 py-3 text-sm text-center text-toss-gray-600 whitespace-nowrap",children:We+nt+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 cursor-pointer hover:text-purple-600 whitespace-nowrap",onClick:()=>ne(Le),children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ha,{size:14,className:"text-toss-gray-400 flex-shrink-0"}),n.jsx("span",{children:je(Le.work_date)}),t&&!Le.is_read&&n.jsx("span",{className:"inline-block bg-purple-500 text-white px-1.5 py-0.5 rounded-full text-xs font-medium flex-shrink-0",children:"N"})]})}),t&&n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-900 whitespace-nowrap",children:Le.user?.name||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-600 whitespace-nowrap",children:Le.user?.team||"-"})]}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 cursor-pointer max-w-xs truncate",onClick:()=>ne(Le),children:k0(Le.morning_work)}),n.jsx("td",{className:"px-3 py-3 text-center whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:dt=>{dt.stopPropagation(),Ce(Le)},className:"p-2 text-purple-500 hover:bg-purple-100 rounded-lg transition-colors",title:"",children:n.jsx(na,{size:16})}),n.jsx("button",{onClick:dt=>{dt.stopPropagation(),De(Le)},className:"p-2 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"Word ",children:n.jsx(ns,{size:16})}),(e?.user_id===Le.user_id||t)&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>G(Le),className:"p-2 text-purple-500 hover:bg-purple-100 rounded-lg transition-colors",title:"",children:n.jsx(aa,{size:16})}),n.jsx("button",{onClick:()=>be(Le),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(cr,{size:16})})]})]})})]},Le.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:Ze.map((Le,nt)=>n.jsxs("div",{className:`p-4 ${t&&!Le.is_read?"bg-purple-50":""}`,onClick:()=>ne(Le),children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",checked:P.has(Le.id),onChange:()=>Tt(Le.id),onClick:dt=>dt.stopPropagation(),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["#",We+nt+1]}),n.jsx(ha,{size:14,className:"text-toss-gray-400"}),n.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:je(Le.work_date)}),t&&!Le.is_read&&n.jsx("span",{className:"bg-purple-500 text-white px-2 py-0.5 rounded-full text-xs font-medium",children:"NEW"})]}),n.jsxs("div",{className:"flex items-center gap-1",onClick:dt=>dt.stopPropagation(),children:[n.jsx("button",{onClick:()=>Ce(Le),className:"p-1.5 text-purple-500 hover:bg-purple-100 rounded-lg",children:n.jsx(na,{size:14})}),n.jsx("button",{onClick:()=>De(Le),className:"p-1.5 text-toss-gray-600 hover:bg-toss-gray-100 rounded-lg",children:n.jsx(ns,{size:14})}),(e?.user_id===Le.user_id||t)&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>G(Le),className:"p-1.5 text-purple-500 hover:bg-purple-100 rounded-lg",children:n.jsx(aa,{size:14})}),n.jsx("button",{onClick:()=>be(Le),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:n.jsx(cr,{size:14})})]})]})]}),t&&n.jsxs("div",{className:"text-xs text-toss-gray-600 mb-2",children:[n.jsx("span",{className:"font-medium",children:Le.user?.name||"-"}),n.jsx("span",{className:"mx-1",children:""}),n.jsx("span",{children:Le.user?.team||"-"})]}),n.jsx("p",{className:"text-sm text-toss-gray-700 line-clamp-2",children:k0(Le.morning_work)})]},Le.id))}),Re>1&&n.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-toss-gray-200",children:[n.jsx("button",{onClick:()=>pt(E-1),disabled:E===1,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),[...Array(Re)].map((Le,nt)=>n.jsx("button",{onClick:()=>pt(nt+1),className:`px-3 py-1 rounded-lg text-sm font-medium ${E===nt+1?"bg-purple-500 text-white":"text-toss-gray-700 hover:bg-toss-gray-100"}`,children:nt+1},nt+1)),n.jsx("button",{onClick:()=>pt(E+1),disabled:E===Re,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]}):n.jsxs("div",{className:"text-center text-toss-gray-500 py-8",children:[_,"    "]})}),n.jsx(yr,{isOpen:c,onClose:()=>{u(!1),A()},title:d?"  ":"   ",size:D?"xl":"default",children:n.jsxs("div",{className:"flex gap-6",children:[n.jsxs("div",{className:`space-y-6 max-h-[70vh] overflow-y-auto pr-2 ${D?"flex-1 min-w-0":"w-full"}`,children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),n.jsx("input",{type:"date",value:te.work_date,onChange:Le=>Z({...te,work_date:Le.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"}),n.jsxs("p",{className:"text-sm text-toss-gray-500 mt-1",children:[je(te.work_date)," "]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700",children:"  *"}),n.jsxs("button",{type:"button",onClick:T,disabled:V,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-purple-600 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors disabled:opacity-50",children:[n.jsx(Sc,{size:14,className:V?"animate-spin":""}),V?" ...":"  "]})]}),n.jsxs("div",{className:"space-y-3",children:[te.monthly_tasks.map((Le,nt)=>n.jsxs("div",{className:"bg-toss-gray-50 rounded-xl p-3 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"text",value:Le.title,onChange:dt=>ie(nt,dt.target.value),className:"flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm font-medium focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:""}),te.monthly_tasks.length>1&&n.jsx("button",{type:"button",onClick:()=>Q(nt),className:"p-1.5 text-red-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors flex-shrink-0 w-[28px] flex items-center justify-center",title:" ",children:n.jsx(cr,{size:14})}),te.monthly_tasks.length<=1&&n.jsx("div",{className:"w-[28px] flex-shrink-0"})]}),n.jsxs("div",{className:"hidden sm:grid sm:grid-cols-[1fr_50px_100px_28px] gap-2 px-1",children:[n.jsx("span",{className:"text-xs font-medium text-toss-gray-500",children:""}),n.jsx("span",{className:"text-xs font-medium text-toss-gray-500 text-center",children:""}),n.jsx("span",{className:"text-xs font-medium text-toss-gray-500",children:""}),n.jsx("span",{})]}),Le.details.map((dt,Ae)=>n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-[1fr_50px_100px_28px] gap-2 items-stretch",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:""}),n.jsx("textarea",{value:dt.content,onChange:Je=>ue(nt,Ae,"content",Je.target.value),rows:2,className:"w-full flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all resize-none leading-relaxed",placeholder:"  "})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:"(%)"}),n.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:dt.progress,onChange:Je=>{const Ee=Je.target.value.replace(/[^0-9]/g,"");(Ee===""||parseInt(Ee)>=0&&parseInt(Ee)<=100)&&ue(nt,Ae,"progress",Ee)},className:"w-full flex-1 px-2 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm text-center focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"%"})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("label",{className:"sm:hidden text-xs text-toss-gray-500 mb-1 block",children:""}),n.jsx("input",{type:"text",value:dt.remark,onChange:Je=>ue(nt,Ae,"remark",Je.target.value),className:"w-full flex-1 px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:""})]}),n.jsx("div",{className:"flex items-center justify-center",children:Le.details.length>1&&n.jsx("button",{type:"button",onClick:()=>z(nt,Ae),className:"p-1 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:" ",children:n.jsx(pr,{size:14})})})]},Ae)),n.jsxs("button",{type:"button",onClick:()=>B(nt),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-purple-600 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[n.jsx(Ns,{size:14}),"  "]})]},nt)),n.jsxs("button",{type:"button",onClick:H,className:"flex items-center gap-2 px-4 py-2 text-purple-600 hover:bg-purple-50 rounded-xl transition-colors text-sm font-medium",children:[n.jsx(v0,{size:16}),"  "]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"()"}),n.jsx("textarea",{value:te.special_notes,onChange:Le=>Z({...te,special_notes:Le.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),d&&te.existingFileUrls.length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("div",{className:"space-y-2",children:te.existingFileUrls.map((Le,nt)=>{const dt=Le.split("/").pop();return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:dt})]}),n.jsx("button",{onClick:()=>W(nt),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(pr,{size:16})})]},nt)})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"file",ref:O,multiple:!0,onChange:se,className:"hidden"}),n.jsx("button",{type:"button",onClick:()=>O.current?.click(),className:"w-full p-6 border-2 border-dashed border-toss-gray-300 rounded-2xl hover:border-purple-500 hover:bg-purple-50/50 transition-all",children:n.jsxs("div",{className:"flex flex-col items-center gap-2 text-toss-gray-600",children:[n.jsx(uo,{size:28}),n.jsx("span",{className:"font-medium",children:" "}),n.jsx("span",{className:"text-xs text-toss-gray-500",children:"   "})]})}),te.files.length>0&&n.jsx("div",{className:"mt-4 space-y-2",children:te.files.map((Le,nt)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:Le.name}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["(",Le.size,")"]})]}),n.jsx("button",{onClick:()=>re(nt),className:"text-red-500 hover:bg-red-50 p-1 rounded transition-colors",children:n.jsx(pr,{size:16})})]},nt))})]}),n.jsxs("div",{className:"flex gap-3 pt-4 sticky bottom-0 bg-white",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{u(!1),A()},className:"flex-1",children:""}),n.jsx(rt,{onClick:d?de:k,className:"flex-1 bg-purple-500 hover:bg-purple-600",loading:y,disabled:y,children:y?" ...":d?"":""})]})]}),D&&n.jsxs("div",{className:"flex-1 min-w-0 flex flex-col max-h-[70vh]",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-50 border border-purple-200 rounded-t-xl",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ha,{size:16,className:"text-purple-600"}),n.jsx("span",{className:"text-sm font-semibold text-purple-800",children:"  "})]}),n.jsx("button",{type:"button",onClick:()=>{K(!1),ae([])},className:"p-1.5 text-purple-600 hover:bg-purple-100 rounded-lg transition-colors",children:n.jsx(pr,{size:16})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto border-x border-b border-purple-200 rounded-b-xl bg-white px-4 py-3",children:M.length>0?n.jsx("div",{className:"space-y-3",children:M.map((Le,nt)=>{const dt=(Le.title||"").match(/^\[(\d+)\]\s*(.*)$/),Ae=dt?dt[1]:"",Je=dt?dt[2]:Le.title||"";return n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-3",children:[Ae&&n.jsxs("div",{className:"text-sm font-semibold text-purple-600 mb-0.5",children:["[",Ae,"]"]}),Je&&n.jsxs("div",{className:"text-sm font-semibold text-purple-800 mb-1",children:["[",Je,"]"]}),!Ae&&!Je&&n.jsx("div",{className:"text-sm font-semibold text-purple-800 mb-1",children:"[-]"}),Le.details.map((Ee,Pe)=>n.jsx("div",{className:"text-sm text-toss-gray-700 ml-2 mb-1",children:(Ee.content||"-").split(`
`).map((he,le)=>n.jsx("div",{children:he.trim()?`- ${he.trim()}`:""},le))},Pe))]},nt)})}):n.jsx("div",{className:"flex items-center justify-center h-full text-toss-gray-400 text-sm",children:" ..."})})]})]})}),n.jsx(yr,{isOpen:!!w&&!c,onClose:()=>g(null),title:"  ",children:w&&n.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto -mx-2 px-2",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),n.jsx("p",{className:"text-toss-gray-900",children:je(w.work_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 font-medium",children:w.user?`${w.user.name}  ${w.user.team||" "}`:"-"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),Pt(w.morning_work)]}),w.special_notes&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:"()"}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 whitespace-pre-wrap text-toss-gray-900",children:w.special_notes})]}),w.file_urls&&w.file_urls.length>0&&n.jsx(zB,{urls:w.file_urls}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[n.jsxs("button",{onClick:()=>Ce(w),className:"flex items-center gap-2 px-4 py-2 bg-purple-50 text-purple-600 rounded-xl hover:bg-purple-100 transition-colors text-sm font-medium",children:[n.jsx(na,{size:16}),""]}),n.jsxs("button",{onClick:()=>De(w),className:"flex items-center gap-2 px-4 py-2 bg-toss-gray-100 text-toss-gray-700 rounded-xl hover:bg-toss-gray-200 transition-colors text-sm font-medium",children:[n.jsx(ns,{size:16}),"Word "]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>g(null),className:"flex-1",children:""}),n.jsx(rt,{onClick:()=>G(w),className:"flex-1 bg-purple-500 hover:bg-purple-600",children:""})]})]})})]})},tE={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""},rE={PH:"",KH:"",VN:"",GT:"",US:"",BR:"",CL:"",NL:"",CN:"",TH:"",AU:"",SG:"",JP:"",MY:"",ID:"",IN:"",MX:"",PE:"",CO:"",EC:"",MM:"",LA:"",BD:"",NP:"",PK:"",AE:"",SA:"",QA:"",KW:"",RU:"",UA:"",PL:"",DE:"",FR:"",GB:"",IT:"",ES:"",CA:"",NZ:"",ZA:"",KE:"",NG:"",EG:"",MA:"",TR:""},sr={statsTop:245,statsHeight:114,statsBoxes:[{left:330,width:310},{left:647,width:310},{left:964,width:315},{left:1282,width:310}],tableDataTop:457,rowHeight:57,leftTable:{left:330},rightTable:{left:965},columnWidth:313};function $B({isOpen:e,onClose:t,summaryStats:r,countryStats:s}){const a=Y.useRef(null),o=Y.useRef(null),[c,u]=Y.useState(!1),[d,h]=Y.useState(!0),[m,x]=Y.useState(null);Y.useEffect(()=>{const g=()=>{u(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",g),()=>document.removeEventListener("fullscreenchange",g)},[]),Y.useEffect(()=>{const g=_=>{_.key==="Escape"&&!c&&t()};return e&&document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[e,c,t]);const y=Y.useCallback(async()=>{const g=a.current;if(!g)return;h(!0);const _=2;g.width=1920*_,g.height=1080*_;const b=g.getContext("2d");b.imageSmoothingEnabled=!0,b.imageSmoothingQuality="high",b.scale(_,_);const N="/company-intranet/",S=new Image;S.crossOrigin="anonymous",S.src=`${N}back.jpg`,await new Promise(P=>{S.onload=P,S.onerror=P}),b.drawImage(S,0,0,1920,1080);const E=new Image;E.crossOrigin="anonymous",E.src=`${N}template.png`,await new Promise(P=>{E.onload=P,E.onerror=P}),b.drawImage(E,0,0,1920,1080),b.textBaseline="middle";const R=sr.statsTop+sr.statsHeight/2;b.font="bold 48px Pretendard, -apple-system, sans-serif",b.fillStyle="#1f2937",b.textAlign="center",b.fillText(`${r?.this_week||0}`,sr.statsBoxes[0].left+sr.statsBoxes[0].width/2-15,R),b.font="24px Pretendard, -apple-system, sans-serif",b.fillText("",sr.statsBoxes[0].left+sr.statsBoxes[0].width/2+35,R),b.font="bold 48px Pretendard, -apple-system, sans-serif",b.fillText(`${r?.this_month||0}`,sr.statsBoxes[1].left+sr.statsBoxes[1].width/2-15,R),b.font="24px Pretendard, -apple-system, sans-serif",b.fillText("",sr.statsBoxes[1].left+sr.statsBoxes[1].width/2+35,R),b.font="bold 48px Pretendard, -apple-system, sans-serif",b.fillText(`${r?.this_year||0}`,sr.statsBoxes[2].left+sr.statsBoxes[2].width/2-15,R),b.font="24px Pretendard, -apple-system, sans-serif",b.fillText("",sr.statsBoxes[2].left+sr.statsBoxes[2].width/2+35,R),b.font="bold 48px Pretendard, -apple-system, sans-serif",b.fillStyle="#2c6eb6",b.fillText(`${r?.total||0}`,sr.statsBoxes[3].left+sr.statsBoxes[3].width/2-20,R),b.font="24px Pretendard, -apple-system, sans-serif",b.fillText("",sr.statsBoxes[3].left+sr.statsBoxes[3].width/2+45,R),(s?.in_progress||[]).forEach((P,F)=>{const V=sr.tableDataTop+F*sr.rowHeight+sr.rowHeight/2,oe=P.country_name||rE[P.country_code]||P.country_code,D=tE[oe]||"";b.font="32px Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji, sans-serif",b.textAlign="left",b.fillText(D,sr.leftTable.left+25,V),b.font="600 24px Pretendard, -apple-system, sans-serif",b.fillStyle="#374151",b.fillText(oe,sr.leftTable.left+70,V),b.font="bold 28px Pretendard, -apple-system, sans-serif",b.fillStyle="#1f2937",b.textAlign="center",b.fillText(`${P.rescue_count||0}`,sr.leftTable.left+sr.columnWidth+sr.columnWidth/2-20,V),b.font="24px Pretendard, -apple-system, sans-serif",b.fillStyle="#374151",b.fillText("",sr.leftTable.left+sr.columnWidth+sr.columnWidth/2+25,V)}),(s?.completed||[]).forEach((P,F)=>{const V=sr.tableDataTop+F*sr.rowHeight+sr.rowHeight/2,oe=P.country_name||rE[P.country_code]||P.country_code,D=tE[oe]||"";b.font="32px Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji, sans-serif",b.textAlign="left",b.fillText(D,sr.rightTable.left+25,V),b.font="600 24px Pretendard, -apple-system, sans-serif",b.fillStyle="#374151",b.fillText(oe,sr.rightTable.left+70,V),b.font="bold 28px Pretendard, -apple-system, sans-serif",b.fillStyle="#1f2937",b.textAlign="center",b.fillText(`${P.rescue_count||0}`,sr.rightTable.left+sr.columnWidth+sr.columnWidth/2-20,V),b.font="24px Pretendard, -apple-system, sans-serif",b.fillStyle="#374151",b.fillText("",sr.rightTable.left+sr.columnWidth+sr.columnWidth/2+25,V)}),x(g.toDataURL("image/png")),h(!1)},[r,s]);Y.useEffect(()=>{if(e){const g=setTimeout(()=>{y()},100);return()=>clearTimeout(g)}},[e,y]);const v=Y.useCallback(()=>{document.fullscreenElement?document.exitFullscreen():o.current?.requestFullscreen()},[]),w=Y.useCallback(()=>{const g=a.current;g&&g.toBlob(_=>{if(_){const b=URL.createObjectURL(_),N=document.createElement("a");N.download=`_${new Date().toISOString().split("T")[0]}.png`,N.href=b,N.click(),URL.revokeObjectURL(b)}},"image/png")},[]);return e?n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90",children:[n.jsx("canvas",{ref:a,width:1920,height:1080,style:{display:"none"}}),!c&&n.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-[60] p-3 bg-white rounded-full shadow-lg hover:bg-gray-100 transition-colors",title:" (ESC)",children:n.jsx(pr,{size:28})}),n.jsx("div",{ref:o,className:"relative flex items-center justify-center w-full h-full",children:d?n.jsx("div",{className:"text-white text-xl",children:" ..."}):m?n.jsxs(n.Fragment,{children:[n.jsx("img",{src:m,alt:"",className:`max-w-full max-h-full object-contain ${c?"w-full h-full":""}`,style:{maxWidth:c?"100%":"90vw",maxHeight:c?"100%":"90vh"}}),!c&&n.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-3 z-50",children:[n.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-white/90 hover:bg-white rounded-lg shadow-lg transition-all text-gray-800",title:" ",children:[n.jsx(ns,{size:20}),n.jsx("span",{className:"font-medium",children:""})]}),n.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-white/90 hover:bg-white rounded-lg shadow-lg transition-all text-gray-800",title:"",children:[n.jsx(h4,{size:20}),n.jsx("span",{className:"font-medium",children:""})]})]})]}):n.jsx("div",{className:"text-white text-xl",children:"   ."})})]}):null}const Ji={KR:"",KP:"",JP:"",CN:"",TW:"",HK:"",MO:"",MN:"",VN:"",TH:"",PH:"",KH:"",LA:"",MM:"",MY:"",SG:"",ID:"",BN:"",TL:"",IN:"",PK:"",BD:"",LK:"",NP:"",BT:"",MV:"",AF:"",KZ:"",UZ:"",KG:"",TJ:"",TM:"",IR:"",IQ:"",SY:"",LB:"",JO:"",IL:"",PS:"",SA:"",AE:"",QA:"",KW:"",BH:"",OM:"",YE:"",TR:"",GB:"",FR:"",DE:"",IT:"",ES:"",PT:"",NL:"",BE:"",LU:"",CH:"",AT:"",PL:"",CZ:"",SK:"",HU:"",RO:"",BG:"",GR:"",HR:"",RS:"",SI:"",BA:"",ME:"",MK:"",AL:"",XK:"",UA:"",BY:"",MD:"",RU:"",EE:"",LV:"",LT:"",FI:"",SE:"",NO:"",DK:"",IS:"",IE:"",MT:"",CY:"",GE:"",AM:"",AZ:"",MC:"",AD:"",SM:"",VA:"",US:"",CA:"",MX:"",GT:"",BZ:"",SV:"",HN:"",NI:"",CR:"",PA:"",CU:"",JM:"",HT:"",DO:"",PR:"",BS:"",TT:"",BB:"",BR:"",AR:"",CL:"",PE:"",CO:"",VE:"",EC:"",BO:"",PY:"",UY:"",GY:"",SR:"",AU:"",NZ:"",PG:"",FJ:"",WS:"",TO:"",VU:"",SB:"",GU:"",EG:"",LY:"",TN:"",DZ:"",MA:"",ZA:"",NG:"",KE:"",ET:"",GH:"",TZ:"",UG:"",ZW:"",MZ:"",AO:"",CM:"",CI:"",SN:"",CD:"",CG:"",SD:"",SS:"",SO:"",RW:"",MG:"",MU:"",NA:"",BW:"",ZM:"",MW:"",MR:"",ML:"",NE:"",TD:"",BF:"",TG:"",BJ:"",LR:"",SL:"",GN:"",GM:"",CV:"",DJ:"",ER:""},sE=[{code:"KR",name:""},{code:"KP",name:""},{code:"JP",name:""},{code:"CN",name:""},{code:"TW",name:""},{code:"HK",name:""},{code:"MO",name:""},{code:"MN",name:""},{code:"VN",name:""},{code:"TH",name:""},{code:"PH",name:""},{code:"KH",name:""},{code:"LA",name:""},{code:"MM",name:""},{code:"MY",name:""},{code:"SG",name:""},{code:"ID",name:""},{code:"BN",name:""},{code:"TL",name:""},{code:"IN",name:""},{code:"PK",name:""},{code:"BD",name:""},{code:"LK",name:""},{code:"NP",name:""},{code:"BT",name:""},{code:"MV",name:""},{code:"AF",name:""},{code:"KZ",name:""},{code:"UZ",name:""},{code:"KG",name:""},{code:"TJ",name:""},{code:"TM",name:""},{code:"IR",name:""},{code:"IQ",name:""},{code:"SY",name:""},{code:"LB",name:""},{code:"JO",name:""},{code:"IL",name:""},{code:"PS",name:""},{code:"SA",name:""},{code:"AE",name:""},{code:"QA",name:""},{code:"KW",name:""},{code:"BH",name:""},{code:"OM",name:""},{code:"YE",name:""},{code:"TR",name:""},{code:"GB",name:""},{code:"FR",name:""},{code:"DE",name:""},{code:"IT",name:""},{code:"ES",name:""},{code:"PT",name:""},{code:"NL",name:""},{code:"BE",name:""},{code:"LU",name:""},{code:"CH",name:""},{code:"AT",name:""},{code:"PL",name:""},{code:"CZ",name:""},{code:"SK",name:""},{code:"HU",name:""},{code:"RO",name:""},{code:"BG",name:""},{code:"GR",name:""},{code:"HR",name:""},{code:"RS",name:""},{code:"SI",name:""},{code:"BA",name:""},{code:"ME",name:""},{code:"MK",name:""},{code:"AL",name:""},{code:"XK",name:""},{code:"UA",name:""},{code:"BY",name:""},{code:"MD",name:""},{code:"RU",name:""},{code:"EE",name:""},{code:"LV",name:""},{code:"LT",name:""},{code:"FI",name:""},{code:"SE",name:""},{code:"NO",name:""},{code:"DK",name:""},{code:"IS",name:""},{code:"IE",name:""},{code:"MT",name:""},{code:"CY",name:""},{code:"GE",name:""},{code:"AM",name:""},{code:"AZ",name:""},{code:"MC",name:""},{code:"AD",name:""},{code:"SM",name:""},{code:"VA",name:""},{code:"US",name:""},{code:"CA",name:""},{code:"MX",name:""},{code:"GT",name:""},{code:"BZ",name:""},{code:"SV",name:""},{code:"HN",name:""},{code:"NI",name:""},{code:"CR",name:""},{code:"PA",name:""},{code:"CU",name:""},{code:"JM",name:""},{code:"HT",name:""},{code:"DO",name:""},{code:"PR",name:""},{code:"BS",name:""},{code:"TT",name:""},{code:"BB",name:""},{code:"BR",name:""},{code:"AR",name:""},{code:"CL",name:""},{code:"PE",name:""},{code:"CO",name:""},{code:"VE",name:""},{code:"EC",name:""},{code:"BO",name:""},{code:"PY",name:""},{code:"UY",name:""},{code:"GY",name:""},{code:"SR",name:""},{code:"AU",name:""},{code:"NZ",name:""},{code:"PG",name:""},{code:"FJ",name:""},{code:"WS",name:""},{code:"TO",name:""},{code:"VU",name:""},{code:"SB",name:""},{code:"GU",name:""},{code:"EG",name:""},{code:"LY",name:""},{code:"TN",name:""},{code:"DZ",name:""},{code:"MA",name:""},{code:"ZA",name:""},{code:"NG",name:""},{code:"KE",name:""},{code:"ET",name:""},{code:"GH",name:""},{code:"TZ",name:""},{code:"UG",name:""},{code:"ZW",name:""},{code:"MZ",name:""},{code:"AO",name:""},{code:"CM",name:""},{code:"CI",name:""},{code:"SN",name:""},{code:"CD",name:""},{code:"CG",name:""},{code:"SD",name:""},{code:"SS",name:""},{code:"SO",name:""},{code:"RW",name:""},{code:"MG",name:""},{code:"MU",name:""},{code:"NA",name:""},{code:"BW",name:""},{code:"ZM",name:""},{code:"MW",name:""},{code:"MR",name:""},{code:"ML",name:""},{code:"NE",name:""},{code:"TD",name:""},{code:"BF",name:""},{code:"TG",name:""},{code:"BJ",name:""},{code:"LR",name:""},{code:"SL",name:""},{code:"GN",name:""},{code:"GM",name:""},{code:"CV",name:""},{code:"DJ",name:""},{code:"ER",name:""}].sort((e,t)=>e.name.localeCompare(t.name,"ko")),HB=()=>{const{profile:e,isAdmin:t}=Yr(),[r,s]=Y.useState([]),[a,o]=Y.useState(!1),[c,u]=Y.useState(!1),[d,h]=Y.useState(!1),[m,x]=Y.useState(null),[y,v]=Y.useState(!0),[w,g]=Y.useState(1),_=15,[b,N]=Y.useState(new Set),[S,E]=Y.useState(!1),R=Y.useRef(null),[L,O]=Y.useState({in_progress:[],completed:[]}),[P,F]=Y.useState({this_week:0,this_month:0,this_year:0,total:0}),[V,oe]=Y.useState(null),[D,K]=Y.useState(!1),[M,ae]=Y.useState(!1),[te,Z]=Y.useState(!0),we=Y.useRef(null),[ee,Ne]=Y.useState(!1),[q,I]=Y.useState({this_week:0,this_month:0,this_year:0,total:0,in_progress:[],completed:[]}),[X,H]=Y.useState({location:"",name:"",request_date:"",status:"",details:"",is_completed:!1,photo_url:"",photo_file:null});Y.useEffect(()=>{Q(),ie(),B()},[]);const Q=async()=>{try{const{data:he,error:le}=await Ue.from("rescue_situations").select("*").order("created_at",{ascending:!1});if(le)throw le;s(he||[])}catch(he){console.error("Error fetching rescue situations:",he),alert("  : "+he.message)}finally{v(!1)}},ie=async()=>{try{const{data:he,error:le}=await Ue.from("rescue_summary_stats").select("*");if(!le&&he&&he.length>0){const qe={};he.forEach(ct=>{qe[ct.stat_key]=ct.stat_value}),F(qe)}const{data:ve,error:Oe}=await Ue.from("rescue_country_stats").select("*").order("display_order",{ascending:!0});if(!Oe&&ve){const qe=ve.filter(Et=>Et.stat_type==="in_progress"),ct=ve.filter(Et=>Et.stat_type==="completed");O({in_progress:qe,completed:ct})}}catch(he){console.error("Error fetching rescue stats:",he)}},B=async()=>{try{const{data:he}=await Ue.from("rescue_reference_images").select("*").order("created_at",{ascending:!1}).limit(1).single();he&&oe(he)}catch{}},z=()=>{H({location:"",name:"",request_date:"",status:"",details:"",is_completed:!1,photo_url:"",photo_file:null}),h(!1),x(null)},ue=he=>{const le=he.target.files[0];if(le){if(!le.type.startsWith("image/")){alert("   .");return}H({...X,photo_file:le})}},se=()=>{H({...X,photo_file:null,photo_url:""}),R.current&&(R.current.value="")},re=async()=>{if(!X.name||!X.location){alert("    .");return}try{E(!0);let he="";X.photo_file&&(he=(await i0(X.photo_file,"/rescue")).url);const{error:le}=await Ue.from("rescue_situations").insert({location:X.location,name:X.name,request_date:X.request_date,status:X.status,details:X.details,is_completed:X.is_completed,photo_url:he,user_id:e.user_id});if(le)throw le;o(!1),z(),Q(),alert(" .")}catch(he){console.error("Error creating rescue situation:",he),alert("  : "+he.message)}finally{E(!1)}},W=async()=>{if(!X.name||!X.location){alert("    .");return}try{E(!0);let he=X.photo_url;X.photo_file&&(he=(await i0(X.photo_file,"/rescue")).url);const{error:le}=await Ue.from("rescue_situations").update({location:X.location,name:X.name,request_date:X.request_date,status:X.status,details:X.details,is_completed:X.is_completed,photo_url:he}).eq("id",m.id);if(le)throw le;o(!1),z(),Q(),alert(" .")}catch(he){console.error("Error updating rescue situation:",he),alert("  : "+he.message)}finally{E(!1)}},ce=async he=>{if(confirm(" ?"))try{he.photo_url&&await o0(he.photo_url);const{error:le}=await Ue.from("rescue_situations").delete().eq("id",he.id);if(le)throw le;Q(),alert(".")}catch(le){console.error("Error deleting rescue situation:",le),alert(" .")}},k=async he=>{try{const{error:le}=await Ue.from("rescue_situations").update({is_completed:!he.is_completed}).eq("id",he.id);if(le)throw le;Q()}catch(le){console.error("Error toggling complete:",le),alert("  .")}},de=he=>{H({location:he.location||"",name:he.name||"",request_date:he.request_date||"",status:he.status||"",details:he.details||"",is_completed:he.is_completed||!1,photo_url:he.photo_url||"",photo_file:null}),x(he),h(!0),o(!0)},U=()=>{z(),o(!0)},T=he=>{x(he),u(!0)},A=[...r].sort((he,le)=>he.is_completed!==le.is_completed?he.is_completed?1:-1:new Date(le.created_at)-new Date(he.created_at)),G=w*_,xe=G-_,be=A.slice(xe,G),ne=Math.ceil(A.length/_),je=he=>{g(he)},Me=he=>{N(le=>{const ve=new Set(le);return ve.has(he)?ve.delete(he):ve.add(he),ve})},De=()=>{const he=be.map(ve=>ve.id),le=he.every(ve=>b.has(ve));N(ve=>{const Oe=new Set(ve);return le?he.forEach(qe=>Oe.delete(qe)):he.forEach(qe=>Oe.add(qe)),Oe})},Ce=async()=>{if(b.size===0){alert("  .");return}const he=r.filter(ct=>b.has(ct.id)),le=[new xr({tableHeader:!0,children:[new yt({width:{size:800,type:Ut.DXA},shading:{fill:"E8F0FE"},children:[new lt({children:[new Rt({text:"No",bold:!0})],alignment:Ot.CENTER})]}),new yt({width:{size:2e3,type:Ut.DXA},shading:{fill:"E8F0FE"},children:[new lt({children:[new Rt({text:"",bold:!0})],alignment:Ot.CENTER})]}),new yt({width:{size:1500,type:Ut.DXA},shading:{fill:"E8F0FE"},children:[new lt({children:[new Rt({text:"",bold:!0})],alignment:Ot.CENTER})]}),new yt({width:{size:1500,type:Ut.DXA},shading:{fill:"E8F0FE"},children:[new lt({children:[new Rt({text:"",bold:!0})],alignment:Ot.CENTER})]}),new yt({width:{size:4200,type:Ut.DXA},shading:{fill:"E8F0FE"},children:[new lt({children:[new Rt({text:" ",bold:!0})],alignment:Ot.CENTER})]})]}),...he.map((ct,Et)=>new xr({children:[new yt({children:[new lt({text:String(Et+1),alignment:Ot.CENTER})]}),new yt({children:[new lt({text:ct.location||"-"})]}),new yt({children:[new lt({text:ct.name||"-"})]}),new yt({children:[new lt({text:ct.request_date||"-"})]}),new yt({children:[new lt({text:ct.details||"-"})]})]}))],ve=new Z0({sections:[{properties:{},children:[new lt({children:[new Rt({text:"",bold:!0,size:32})],alignment:Ot.CENTER}),new lt({text:""}),new Sa({width:{size:100,type:Ut.PERCENTAGE},rows:le})]}]}),Oe=await Q0.toBlob(ve),qe=new Date().toISOString().split("T")[0];em.saveAs(Oe,`_${qe}.docx`),N(new Set)},st=()=>{I({this_week:P.this_week||0,this_month:P.this_month||0,this_year:P.this_year||0,total:P.total||0,in_progress:L.in_progress.map(he=>({...he})),completed:L.completed.map(he=>({...he}))}),K(!0)},[We,Ze]=Y.useState({in_progress:"",completed:""}),[Re,pt]=Y.useState({in_progress:null,completed:null}),Tt=he=>{if(!he)return sE;const le=he.toLowerCase();return sE.filter(ve=>ve.name.toLowerCase().includes(le)||ve.code.toLowerCase().includes(le))},wt=(he,le)=>{I(ve=>({...ve,[he]:[...ve[he],{country_code:le.code,country_name:le.name,rescue_count:0,stat_type:he}]})),Ze(ve=>({...ve,[he]:""}))},jt=(he,le)=>{I(ve=>({...ve,[he]:ve[he].filter((Oe,qe)=>qe!==le)}))},Pt=(he,le,ve,Oe)=>{I(qe=>{const ct=[...qe[he]];return ct[le]={...ct[le],[ve]:parseInt(Oe)||0},{...qe,[he]:ct}})},Le=(he,le,ve)=>{I(Oe=>{const qe=[...Oe[he]],ct=ve==="up"?le-1:le+1;if(ct<0||ct>=qe.length)return Oe;const Et=qe[le];return qe[le]=qe[ct],qe[ct]=Et,{...Oe,[he]:qe}})},nt=(he,le)=>{if(he.key==="Enter"){if(he.preventDefault(),he.stopPropagation(),he.nativeEvent?.isComposing||he.isComposing)return;const ve=We[le];if(!ve)return;const Oe=Tt(ve);Oe.length>0&&wt(le,Oe[0])}},dt=async()=>{try{E(!0);for(const ve of["this_week","this_month","this_year","total"]){const{error:Oe}=await Ue.from("rescue_summary_stats").upsert({stat_key:ve,stat_value:q[ve]||0,updated_at:new Date().toISOString()},{onConflict:"stat_key"});if(Oe)throw Oe}const{error:he}=await Ue.from("rescue_country_stats").delete().in("stat_type",["in_progress","completed"]);if(he)throw he;const le=[...q.in_progress.map((ve,Oe)=>({...ve,stat_type:"in_progress",display_order:Oe})),...q.completed.map((ve,Oe)=>({...ve,stat_type:"completed",display_order:Oe}))];if(le.length>0){const{error:ve}=await Ue.from("rescue_country_stats").insert(le.map(Oe=>({country_code:Oe.country_code,country_name:Oe.country_name,rescue_count:Oe.rescue_count,stat_type:Oe.stat_type,display_order:Oe.display_order})));if(ve)throw ve}K(!1),await ie(),alert(" .")}catch(he){console.error("Error saving stats:",he),alert("  : "+he.message)}finally{E(!1)}},Ae=async he=>{const le=he.target.files[0];if(le)try{E(!0);const ve=await i0(le,"/rescue/reference");V?.image_url&&(await o0(V.image_url),await Ue.from("rescue_reference_images").delete().eq("id",V.id));const{data:Oe,error:qe}=await Ue.from("rescue_reference_images").insert({image_url:ve.url,title:"  "}).select().single();if(qe)throw qe;oe(Oe),ae(!1),alert(" .")}catch(ve){console.error("Error uploading reference image:",ve),alert("  : "+ve.message)}finally{E(!1)}},Je=async()=>{if(V&&confirm("  ?"))try{await o0(V.image_url),await Ue.from("rescue_reference_images").delete().eq("id",V.id),oe(null),alert(" .")}catch(he){console.error("Error deleting reference image:",he),alert("  .")}},Ee=()=>{const he=[...L.in_progress.map(ve=>({name:ve.country_name,flag:Ji[ve.country_code]||"",count:ve.rescue_count,type:" "})),...L.completed.map(ve=>({name:ve.country_name,flag:Ji[ve.country_code]||"",count:ve.rescue_count,type:" "}))],le=`
            <div class="stats-grid">
                <div class="stat-box"><div class="label"> </div><div class="value">${P.this_week||0}<span class="unit"> </span></div></div>
                <div class="stat-box"><div class="label"> </div><div class="value">${P.this_month||0}<span class="unit"> </span></div></div>
                <div class="stat-box"><div class="label">2026</div><div class="value">${P.this_year||0}<span class="unit"> </span></div></div>
                <div class="stat-box highlight"><div class="label"> </div><div class="value">${P.total||0}<span class="unit"> </span></div></div>
            </div>
            ${he.length>0?`
            <div class="section-title">  </div>
            <table>
                <thead><tr><th></th><th></th><th></th></tr></thead>
                <tbody>
                    ${he.map(ve=>`<tr><td style="text-align:center">${ve.type}</td><td style="text-align:center">${ve.flag} ${ve.name}</td><td style="text-align:center">${ve.count}</td></tr>`).join("")}
                </tbody>
            </table>`:""}
        `;il({title:"  ",content:le})},Pe=()=>{const he=b.size>0?r.filter(Oe=>b.has(Oe.id)):r,ve=`
            <div class="section-title">  - ${b.size>0?`  (${he.length})`:` (${he.length})`}</div>
            <table>
                <colgroup>
                    <col style="width:5%"/>
                    <col style="width:12%"/>
                    <col style="width:8%"/>
                    <col style="width:10%"/>
                    <col style="width:55%"/>
                    <col style="width:10%"/>
                </colgroup>
                <thead><tr><th>No</th><th></th><th></th><th></th><th> </th><th></th></tr></thead>
                <tbody>
                    ${he.map((Oe,qe)=>`
                        <tr>
                            <td>${qe+1}</td>
                            <td>${Oe.location||"-"}</td>
                            <td>${Oe.name||"-"}</td>
                            <td>${Oe.request_date||"-"}</td>
                            <td class="left" style="word-break:keep-all">${Oe.status||"-"}</td>
                            <td>${Oe.is_completed?"":""}</td>
                        </tr>
                    `).join("")}
                </tbody>
            </table>
        `;il({title:" ",content:ve})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(At,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(Gc,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:" "}),n.jsx("p",{className:"text-white/90",children:t?"    ":"  "})]})]})}),n.jsxs(At,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-amber-50 border-b border-amber-100 cursor-pointer",onClick:()=>Z(!te),children:[n.jsx("div",{className:"flex items-center gap-3",children:n.jsx("div",{children:n.jsx("h3",{className:"font-bold text-toss-gray-900",children:"26   "})})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:he=>{he.stopPropagation(),Ne(!0)},className:"p-2 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:n.jsx(Xy,{size:18})}),n.jsx("button",{onClick:he=>{he.stopPropagation(),Ee()},className:"p-2 text-toss-gray-600 hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:n.jsx(na,{size:18})}),n.jsx("button",{onClick:he=>{he.stopPropagation(),st()},className:"p-2 text-toss-gray-600 hover:bg-amber-100 rounded-lg transition-colors",title:" ",children:n.jsx(hl,{size:18})}),n.jsx("button",{onClick:he=>{he.stopPropagation(),ae(!0)},className:"p-2 text-toss-gray-600 hover:bg-amber-100 rounded-lg transition-colors",title:" ",children:n.jsx(f4,{size:18})}),te?n.jsx(sl,{size:20,className:"text-toss-gray-500"}):n.jsx(no,{size:20,className:"text-toss-gray-500"})]})]}),te&&n.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[P.this_week||0,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[P.this_month||0,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:"2026"}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[P.this_year||0,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-amber-50 border-2 border-amber-300 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-amber-600 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-amber-600",children:[P.total||0,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]})]}),(L.in_progress.length>0||L.completed.length>0)&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[L.in_progress.length>0&&n.jsxs("div",{className:"border rounded-xl overflow-hidden",children:[n.jsxs("div",{className:"bg-blue-50 px-4 py-2 border-b",children:[n.jsx("span",{className:"font-semibold text-blue-700",children:" "}),n.jsx("span",{className:"text-sm text-blue-500 ml-2",children:" "})]}),n.jsx("div",{className:"divide-y",children:L.in_progress.map((he,le)=>n.jsxs("div",{className:"flex items-center justify-between px-4 py-2 hover:bg-toss-gray-50",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-lg",children:Ji[he.country_code]||""}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:he.country_name})]}),n.jsxs("span",{className:"font-semibold text-toss-gray-900",children:[he.rescue_count," "]})]},le))})]}),L.completed.length>0&&n.jsxs("div",{className:"border rounded-xl overflow-hidden",children:[n.jsxs("div",{className:"bg-orange-50 px-4 py-2 border-b",children:[n.jsx("span",{className:"font-semibold text-orange-700",children:" "}),n.jsx("span",{className:"text-sm text-orange-500 ml-2",children:" "})]}),n.jsx("div",{className:"divide-y",children:L.completed.map((he,le)=>n.jsxs("div",{className:"flex items-center justify-between px-4 py-2 hover:bg-toss-gray-50",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-lg",children:Ji[he.country_code]||""}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:he.country_name})]}),n.jsxs("span",{className:"font-semibold text-toss-gray-900",children:[he.rescue_count," "]})]},le))})]})]}),V&&n.jsxs("div",{className:"mt-4",children:[n.jsx("p",{className:"text-sm font-medium text-toss-gray-500 mb-2",children:" ()"}),n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:V.image_url,alt:"  ",className:"w-full max-h-96 object-contain rounded-xl border bg-toss-gray-50 cursor-pointer",onClick:()=>window.open(V.image_url,"_blank")}),t&&n.jsx("button",{onClick:Je,className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",title:" ",children:n.jsx(pr,{size:14})})]})]}),L.in_progress.length===0&&L.completed.length===0&&!V&&n.jsx("div",{className:"text-center text-toss-gray-500 py-4",children:t?"      .":"   ."})]})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:""}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(rt,{variant:"secondary",onClick:Pe,children:[n.jsx(na,{size:18}),""]}),n.jsxs(rt,{variant:"secondary",onClick:Ce,disabled:b.size===0,children:[n.jsx(ns,{size:18}),"Word  ",b.size>0&&`(${b.size})`]}),n.jsxs(rt,{onClick:U,children:[n.jsx(Ns,{size:18}),"  "]})]})]}),n.jsx(At,{padding:"p-0 sm:p-6",children:y?n.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:" ..."}):be.length>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full table-fixed",children:[n.jsx("thead",{className:"bg-toss-blue/10 border-b-2 border-toss-blue/20",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-toss-gray-900 w-10",children:n.jsx("input",{type:"checkbox",checked:be.length>0&&be.every(he=>b.has(he.id)),onChange:De,className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-toss-gray-900 w-14",children:"No"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-toss-gray-900 w-28",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-toss-gray-900 w-20",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-toss-gray-900 w-24",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-toss-gray-900",children:" "}),n.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-toss-gray-900 w-20",children:""}),n.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-toss-gray-900 w-24",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-100",children:be.map((he,le)=>n.jsxs("tr",{className:`transition-colors cursor-pointer ${he.is_completed?"bg-toss-gray-50 hover:bg-toss-gray-100":"bg-orange-50/50 hover:bg-orange-100/50"} ${b.has(he.id)?"!bg-blue-50":""}`,onClick:()=>T(he),children:[n.jsx("td",{className:"px-4 py-3 text-center w-10",onClick:ve=>ve.stopPropagation(),children:n.jsx("input",{type:"checkbox",checked:b.has(he.id),onChange:()=>Me(he.id),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"})}),n.jsx("td",{className:"px-4 py-3 text-sm text-center text-toss-gray-600 w-14",children:xe+le+1}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-900 w-28 truncate",children:he.location||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-900 font-medium w-20 truncate",children:he.name||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-700 w-24 truncate",children:he.request_date||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-toss-gray-700 truncate",children:he.status||"-"}),n.jsx("td",{className:"px-4 py-3 text-center w-20",onClick:ve=>ve.stopPropagation(),children:n.jsx("button",{onClick:()=>k(he),className:`px-3 py-1 text-xs font-medium rounded-full transition-colors whitespace-nowrap ${he.is_completed?"bg-green-100 text-green-600 hover:bg-green-200":"bg-orange-100 text-orange-600 hover:bg-orange-200"}`,children:he.is_completed?"":""})}),n.jsx("td",{className:"px-4 py-3 text-center w-24",onClick:ve=>ve.stopPropagation(),children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:()=>de(he),className:"p-2 text-blue-500 hover:bg-blue-100 rounded-lg transition-colors",title:"",children:n.jsx(aa,{size:16})}),n.jsx("button",{onClick:()=>ce(he),className:"p-2 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(cr,{size:16})})]})})]},he.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:be.map((he,le)=>n.jsxs("div",{className:`p-4 ${he.is_completed?"bg-toss-gray-50":"bg-orange-50/50"} ${b.has(he.id)?"!bg-blue-50":""}`,onClick:()=>T(he),children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",checked:b.has(he.id),onChange:()=>Me(he.id),onClick:ve=>ve.stopPropagation(),className:"w-4 h-4 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["#",xe+le+1]}),n.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:he.name||"-"})]}),n.jsxs("div",{className:"flex items-center gap-1",onClick:ve=>ve.stopPropagation(),children:[n.jsx("button",{onClick:()=>k(he),className:`px-2 py-0.5 text-xs font-medium rounded-full transition-colors whitespace-nowrap ${he.is_completed?"bg-green-100 text-green-600 hover:bg-green-200":"bg-orange-100 text-orange-600 hover:bg-orange-200"}`,children:he.is_completed?"":""}),n.jsx("button",{onClick:()=>de(he),className:"p-1.5 text-blue-500 hover:bg-blue-100 rounded-lg",children:n.jsx(aa,{size:14})}),n.jsx("button",{onClick:()=>ce(he),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg",children:n.jsx(cr,{size:14})})]})]}),n.jsxs("div",{className:"space-y-1 text-sm",children:[n.jsxs("p",{className:"text-toss-gray-700",children:[n.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),he.location||"-"]}),n.jsxs("p",{className:"text-toss-gray-700",children:[n.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),he.request_date||"-"]}),n.jsxs("p",{className:"text-toss-gray-700 line-clamp-1",children:[n.jsx("span",{className:"text-toss-gray-500 mr-1",children:":"}),he.status||"-"]})]})]},he.id))}),ne>1&&n.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-toss-gray-200",children:[n.jsx("button",{onClick:()=>je(w-1),disabled:w===1,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""}),[...Array(ne)].map((he,le)=>n.jsx("button",{onClick:()=>je(le+1),className:`px-3 py-1 rounded-lg text-sm font-medium ${w===le+1?"bg-toss-blue text-white":"text-toss-gray-700 hover:bg-toss-gray-100"}`,children:le+1},le+1)),n.jsx("button",{onClick:()=>je(w+1),disabled:w===ne,className:"px-3 py-1 rounded-lg text-sm font-medium text-toss-gray-700 hover:bg-toss-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]}):n.jsx("div",{className:"text-center text-toss-gray-500 py-8",children:"  "})}),n.jsx(yr,{isOpen:a,onClose:()=>{o(!1),z()},title:d?" ":"  ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),n.jsx("input",{type:"text",value:X.location,onChange:he=>H({...X,location:he.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:" "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),n.jsx("input",{type:"text",value:X.name,onChange:he=>H({...X,name:he.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:" "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"text",value:X.request_date,onChange:he=>H({...X,request_date:he.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:": 25.01.13"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  ()"}),n.jsx("input",{type:"text",value:X.status,onChange:he=>H({...X,status:he.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"   "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:X.details,onChange:he=>H({...X,details:he.target.value}),rows:8,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none transition-all leading-relaxed",placeholder:"  "})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",id:"is_completed",checked:X.is_completed||!1,onChange:he=>H({...X,is_completed:he.target.checked}),className:"w-5 h-5 text-toss-blue border-gray-300 rounded focus:ring-toss-blue cursor-pointer"}),n.jsx("label",{htmlFor:"is_completed",className:"text-sm font-medium text-toss-gray-700 cursor-pointer",children:" "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  (1)"}),n.jsx("input",{type:"file",ref:R,accept:"image/*",onChange:ue,className:"hidden"}),X.photo_file||X.photo_url?n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:X.photo_file?URL.createObjectURL(X.photo_file):X.photo_url,alt:" ",className:"w-full max-h-48 object-contain rounded-xl bg-toss-gray-50"}),n.jsx("button",{type:"button",onClick:se,className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",children:n.jsx(pr,{size:16})})]}):n.jsxs("button",{type:"button",onClick:()=>R.current?.click(),className:"w-full py-8 border-2 border-dashed border-toss-gray-300 rounded-xl text-toss-gray-500 hover:border-toss-blue hover:text-toss-blue transition-colors flex flex-col items-center justify-center gap-2",children:[n.jsx(FO,{size:24}),n.jsx("span",{className:"text-sm",children:"  "})]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{o(!1),z()},className:"flex-1",disabled:S,children:""}),n.jsx(rt,{onClick:d?W:re,className:"flex-1",disabled:S,children:S?" ...":d?"":""})]})]})}),n.jsx(yr,{isOpen:c,onClose:()=>{u(!1),x(null)},title:" ",children:m&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("div",{className:"flex-1 space-y-3",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900",children:m.location||"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 font-medium",children:m.name||"-"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),n.jsx("p",{className:"text-toss-gray-900",children:m.request_date||"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),n.jsx("p",{className:`font-medium ${m.is_completed?"text-green-600":"text-orange-500"}`,children:m.is_completed?"":""})]})]})]}),m.photo_url&&n.jsx("div",{className:"w-32 h-32 flex-shrink-0",children:n.jsx("img",{src:m.photo_url,alt:" ",className:"w-full h-full object-cover rounded-xl cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(m.photo_url,"_blank")})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:"  ()"}),n.jsx("p",{className:"text-toss-gray-900",children:m.status||"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[150px] whitespace-pre-wrap text-toss-gray-900",children:m.details||"  ."})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{u(!1),x(null)},className:"flex-1",children:""}),n.jsx(rt,{onClick:()=>{u(!1),de(m)},className:"flex-1",children:""})]})]})}),n.jsx(yr,{isOpen:D,onClose:()=>K(!1),title:"  ",children:n.jsxs("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-toss-gray-700 mb-3",children:" "}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:" "}),n.jsx("input",{type:"number",value:q.this_week,onChange:he=>I({...q,this_week:parseInt(he.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:" "}),n.jsx("input",{type:"number",value:q.this_month,onChange:he=>I({...q,this_month:parseInt(he.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:"2026"}),n.jsx("input",{type:"number",value:q.this_year,onChange:he=>I({...q,this_year:parseInt(he.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:" "}),n.jsx("input",{type:"number",value:q.total,onChange:he=>I({...q,total:parseInt(he.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-blue-700 mb-3",children:" "}),n.jsxs("div",{className:"relative mb-3",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("div",{className:"relative flex-1",children:[n.jsx(ao,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),n.jsx("input",{type:"text",value:We.in_progress,onChange:he=>Ze(le=>({...le,in_progress:he.target.value})),onKeyDown:he=>nt(he,"in_progress"),onFocus:()=>pt(he=>({...he,in_progress:!0})),onBlur:()=>setTimeout(()=>pt(he=>({...he,in_progress:!1})),200),className:"w-full pl-9 pr-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-blue-300",placeholder:" "})]})}),Re.in_progress&&We.in_progress&&n.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-40 overflow-y-auto",children:[Tt(We.in_progress).slice(0,8).map(he=>n.jsxs("button",{onClick:()=>wt("in_progress",he),className:"w-full px-3 py-2 text-left hover:bg-blue-50 flex items-center gap-2 text-sm",children:[n.jsx("span",{children:Ji[he.code]}),n.jsx("span",{children:he.name})]},he.code)),Tt(We.in_progress).length===0&&n.jsx("div",{className:"px-3 py-2 text-sm text-toss-gray-400",children:"  "})]})]}),n.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[q.in_progress.map((he,le)=>n.jsxs("div",{className:"flex items-center gap-1 bg-blue-50 rounded-lg px-2 py-1.5",children:[n.jsxs("div",{className:"flex flex-col gap-0.5",children:[n.jsx("button",{onClick:()=>Le("in_progress",le,"up"),disabled:le===0,className:"p-0.5 text-toss-gray-400 hover:text-toss-gray-700 disabled:opacity-30",children:n.jsx(OS,{size:10})}),n.jsx("button",{onClick:()=>Le("in_progress",le,"down"),disabled:le===q.in_progress.length-1,className:"p-0.5 text-toss-gray-400 hover:text-toss-gray-700 disabled:opacity-30",children:n.jsx(DS,{size:10})})]}),n.jsx("span",{className:"text-base",children:Ji[he.country_code]}),n.jsx("span",{className:"flex-1 text-xs font-medium truncate",children:he.country_name}),n.jsx("input",{type:"number",value:he.rescue_count,onChange:ve=>Pt("in_progress",le,"rescue_count",ve.target.value),className:"w-12 px-1 py-0.5 border rounded text-xs text-center",placeholder:"0"}),n.jsx("button",{onClick:()=>jt("in_progress",le),className:"p-0.5 text-red-500 hover:bg-red-100 rounded",children:n.jsx(cr,{size:12})})]},le)),q.in_progress.length===0&&n.jsx("p",{className:"text-xs text-toss-gray-400 text-center py-3 bg-toss-gray-50 rounded-lg",children:"  "})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-orange-700 mb-3",children:" "}),n.jsxs("div",{className:"relative mb-3",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("div",{className:"relative flex-1",children:[n.jsx(ao,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),n.jsx("input",{type:"text",value:We.completed,onChange:he=>Ze(le=>({...le,completed:he.target.value})),onKeyDown:he=>nt(he,"completed"),onFocus:()=>pt(he=>({...he,completed:!0})),onBlur:()=>setTimeout(()=>pt(he=>({...he,completed:!1})),200),className:"w-full pl-9 pr-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-orange-300",placeholder:" "})]})}),Re.completed&&We.completed&&n.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-40 overflow-y-auto",children:[Tt(We.completed).slice(0,8).map(he=>n.jsxs("button",{onClick:()=>wt("completed",he),className:"w-full px-3 py-2 text-left hover:bg-orange-50 flex items-center gap-2 text-sm",children:[n.jsx("span",{children:Ji[he.code]}),n.jsx("span",{children:he.name})]},he.code)),Tt(We.completed).length===0&&n.jsx("div",{className:"px-3 py-2 text-sm text-toss-gray-400",children:"  "})]})]}),n.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[q.completed.map((he,le)=>n.jsxs("div",{className:"flex items-center gap-1 bg-orange-50 rounded-lg px-2 py-1.5",children:[n.jsxs("div",{className:"flex flex-col gap-0.5",children:[n.jsx("button",{onClick:()=>Le("completed",le,"up"),disabled:le===0,className:"p-0.5 text-toss-gray-400 hover:text-toss-gray-700 disabled:opacity-30",children:n.jsx(OS,{size:10})}),n.jsx("button",{onClick:()=>Le("completed",le,"down"),disabled:le===q.completed.length-1,className:"p-0.5 text-toss-gray-400 hover:text-toss-gray-700 disabled:opacity-30",children:n.jsx(DS,{size:10})})]}),n.jsx("span",{className:"text-base",children:Ji[he.country_code]}),n.jsx("span",{className:"flex-1 text-xs font-medium truncate",children:he.country_name}),n.jsx("input",{type:"number",value:he.rescue_count,onChange:ve=>Pt("completed",le,"rescue_count",ve.target.value),className:"w-12 px-1 py-0.5 border rounded text-xs text-center",placeholder:"0"}),n.jsx("button",{onClick:()=>jt("completed",le),className:"p-0.5 text-red-500 hover:bg-red-100 rounded",children:n.jsx(cr,{size:12})})]},le)),q.completed.length===0&&n.jsx("p",{className:"text-xs text-toss-gray-400 text-center py-3 bg-toss-gray-50 rounded-lg",children:"  "})]})]})]}),n.jsxs("div",{className:"flex gap-3 pt-4 sticky bottom-0 bg-white",children:[n.jsx(rt,{variant:"secondary",onClick:()=>K(!1),className:"flex-1",children:""}),n.jsx(rt,{onClick:dt,className:"flex-1",disabled:S,children:S?" ...":""})]})]})}),n.jsx(yr,{isOpen:M,onClose:()=>ae(!1),title:"  ",children:n.jsxs("div",{className:"space-y-4",children:[V?n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-2",children:" "}),n.jsx("img",{src:V.image_url,alt:" ",className:"w-full max-h-64 object-contain rounded-xl border bg-toss-gray-50"})]}):n.jsx("div",{className:"text-center text-toss-gray-500 py-8 bg-toss-gray-50 rounded-xl",children:"  ."}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  "}),n.jsx("input",{type:"file",accept:"image/*",onChange:Ae,ref:we,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),n.jsx("div",{className:"flex gap-3",children:n.jsx(rt,{variant:"secondary",onClick:()=>ae(!1),className:"flex-1",children:""})})]})}),n.jsx($B,{isOpen:ee,onClose:()=>Ne(!1),summaryStats:P,countryStats:L})]})},aE=e=>e?e.replace("www.dropbox.com","dl.dropboxusercontent.com").replace("?dl=0","").replace("&dl=0","").replace("?dl=1","").replace("&dl=1",""):"",nE=e=>{const t=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],r=e.toLowerCase();return t.some(s=>r.includes(s))},WB=({files:e})=>{const t=Y.useRef(null),[r,s]=Y.useState(!1),[a,o]=Y.useState(!1),[c,u]=Y.useState(null),d=e.filter(y=>nE(y.url)).map(y=>({...y,url:aE(y.url)})),h=e.filter(y=>!nE(y.url)).map(y=>({...y,url:aE(y.url)})),m=()=>{if(t.current){const{scrollLeft:y,scrollWidth:v,clientWidth:w}=t.current;s(y>0),o(y<v-w-10)}};Y.useEffect(()=>(m(),window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)),[e]);const x=y=>{t.current&&(t.current.scrollBy({left:y==="left"?-200:200,behavior:"smooth"}),setTimeout(m,300))};return d.length===0&&h.length===0?null:n.jsxs("div",{className:"space-y-3",children:[d.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:[" (",d.length,")"]}),n.jsxs("div",{className:"relative",children:[r&&n.jsx("button",{onClick:()=>x("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx(za,{size:20})}),n.jsx("div",{ref:t,onScroll:m,className:"flex gap-3 overflow-x-auto scrollbar-hide pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:d.map((y,v)=>n.jsx("div",{className:"flex-shrink-0 cursor-pointer w-24 h-24 sm:w-32 sm:h-32 rounded-xl overflow-hidden bg-toss-gray-100",onClick:()=>u(y.url),children:n.jsx("img",{src:y.url,alt:y.name||`  ${v+1}`,className:"w-full h-full object-cover hover:opacity-90 transition-opacity",loading:"lazy",onError:w=>{w.target.style.display="none"}})},v))}),a&&n.jsx("button",{onClick:()=>x("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white/90 shadow-lg rounded-full p-1.5 hover:bg-white",children:n.jsx(pa,{size:20})})]})]}),h.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:["  (",h.length,")"]}),n.jsx("div",{className:"space-y-2",children:h.map((y,v)=>n.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors",children:[n.jsx(ka,{size:16,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-blue hover:underline flex-1 truncate",children:y.name||""}),n.jsx(ns,{size:16,className:"text-toss-gray-500"})]},v))})]}),c&&n.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4",style:{zIndex:9999},onClick:()=>u(null),children:[n.jsx("button",{className:"absolute top-4 right-4 text-white hover:text-gray-300",style:{zIndex:1e4},onClick:()=>u(null),children:n.jsx(pr,{size:32})}),n.jsx("img",{src:c,alt:" ",className:"max-h-[85vh] max-w-[95vw] object-contain rounded-lg",onClick:y=>y.stopPropagation()})]})]})},GB=()=>{const{profile:e}=Yr(),[t,r]=Y.useState(new Date),[s,a]=Y.useState(null),[o,c]=Y.useState(null),[u,d]=Y.useState(!1),[h,m]=Y.useState(!1),[x,y]=Y.useState([]),[v,w]=Y.useState([]),[g,_]=Y.useState(!1),[b,N]=Y.useState({title:"",content:"",participants:"",files:[],existingFileUrls:[]}),[S,E]=Y.useState(!1),R=Y.useRef(null);Y.useEffect(()=>{L(),O()},[t]);const L=async()=>{try{const H=t.getFullYear(),Q=t.getMonth(),ie=new Date(H,Q,1).toISOString().split("T")[0],B=new Date(H,Q+1,0).toISOString().split("T")[0],{data:z}=await Ue.from("meetings").select("*").gte("meeting_date",ie).lte("meeting_date",B).order("meeting_date",{ascending:!0});y(z||[])}catch(H){console.error("Error fetching meetings:",H)}},O=async()=>{try{const{data:H}=await Ue.from("meetings").select("*").order("meeting_date",{ascending:!1}).limit(10);w(H||[])}catch(H){console.error("Error fetching recent meetings:",H)}},P=H=>{a(H);const Q=x.find(ie=>ie.meeting_date===H);Q?(c(Q),m(!0)):(N({title:"",content:"",participants:"",files:[],existingFileUrls:[]}),d(!0))},F=H=>{const ie=Array.from(H.target.files).map(B=>({file:B,name:B.name,size:(B.size/1024).toFixed(0)+"KB"}));N(B=>({...B,files:[...B.files,...ie]}))},V=H=>{N(Q=>({...Q,files:Q.files.filter((ie,B)=>B!==H)}))},oe=H=>{N(Q=>({...Q,existingFileUrls:Q.existingFileUrls.filter((ie,B)=>B!==H)}))},D=H=>{c(H),m(!0)},K=async()=>{if(!b.content.trim()){alert("  .");return}_(!0),E(!0);try{let H=[];if(b.files.length>0){const B=`/intranet/meetings/${s}`;H=(await Gd(b.files.map(ue=>ue.file),B)).map(ue=>({url:ue.url,name:ue.name,size:ue.size}))}const Q=[...b.existingFileUrls,...H],ie=x.find(B=>B.meeting_date===s);if(ie){const{error:B}=await Ue.from("meetings").update({title:b.title,content:b.content,participants:b.participants,file_urls:Q,updated_at:new Date().toISOString()}).eq("id",ie.id);if(B)throw B}else{const{error:B}=await Ue.from("meetings").insert([{meeting_date:s,title:b.title,content:b.content,participants:b.participants,file_urls:Q}]).select();if(B)throw B}await L(),await O(),d(!1)}catch(H){console.error("Error saving meeting:",H),alert("   : "+(H.message||JSON.stringify(H)))}finally{_(!1),E(!1)}},M=async()=>{if(confirm("  ?")){_(!0);try{const H=x.find(Q=>Q.meeting_date===s);H&&(H.file_urls&&H.file_urls.length>0&&await $0(H.file_urls),await Ue.from("meetings").delete().eq("id",H.id),await L(),await O()),d(!1)}catch(H){console.error("Error deleting meeting:",H),alert("   .")}finally{_(!1)}}},ae=H=>{const Q=H.getFullYear(),ie=H.getMonth(),B=new Date(Q,ie,1),ue=new Date(Q,ie+1,0).getDate(),se=B.getDay(),re=[];for(let ce=0;ce<se;ce++){const k=new Date(Q,ie,-se+ce+1);re.push({date:k,isCurrentMonth:!1})}for(let ce=1;ce<=ue;ce++)re.push({date:new Date(Q,ie,ce),isCurrentMonth:!0});const W=42-re.length;for(let ce=1;ce<=W;ce++)re.push({date:new Date(Q,ie+1,ce),isCurrentMonth:!1});return re},te=H=>H.toISOString().split("T")[0],Z=H=>{const Q=new Date(H);return`${Q.getFullYear()}. ${Q.getMonth()+1}. ${Q.getDate()}.`},we=H=>{const Q=te(H);return x.some(ie=>ie.meeting_date===Q)},ee=H=>{const Q=new Date;return H.toDateString()===Q.toDateString()},Ne=()=>{r(new Date(t.getFullYear(),t.getMonth()-1,1))},q=()=>{r(new Date(t.getFullYear(),t.getMonth()+1,1))},I=ae(t),X=["","","","","","",""];return n.jsxs("div",{className:"space-y-6",children:[n.jsx(At,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(Ws,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:""}),n.jsx("p",{className:"text-white/90",children:"    "})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs(At,{className:"lg:col-span-2",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("button",{onClick:Ne,className:"p-1.5 hover:bg-toss-gray-100 rounded-lg transition-colors",children:n.jsx(za,{size:20,className:"text-toss-gray-600"})}),n.jsxs("h3",{className:"text-lg font-bold text-toss-gray-900",children:[t.getFullYear()," ",t.getMonth()+1,""]}),n.jsx("button",{onClick:q,className:"p-1.5 hover:bg-toss-gray-100 rounded-lg transition-colors",children:n.jsx(pa,{size:20,className:"text-toss-gray-600"})})]}),n.jsx("div",{className:"grid grid-cols-7 mb-1",children:X.map((H,Q)=>n.jsx("div",{className:`text-center py-1 text-xs font-semibold ${Q===0?"text-red-500":Q===6?"text-blue-500":"text-toss-gray-600"}`,children:H},H))}),n.jsx("div",{className:"grid grid-cols-7",children:I.map((H,Q)=>{const ie=te(H.date),B=we(H.date),z=ee(H.date),ue=H.date.getDay();return n.jsxs("button",{onClick:()=>H.isCurrentMonth&&P(ie),disabled:!H.isCurrentMonth,className:`
                                        py-2 rounded transition-all relative
                                        ${H.isCurrentMonth?"hover:bg-toss-gray-100 cursor-pointer":"opacity-30 cursor-default"}
                                        ${z?"bg-toss-blue/10 ring-1 ring-toss-blue":""}
                                    `,children:[n.jsx("span",{className:`
                                        text-sm font-medium
                                        ${H.isCurrentMonth?"":"text-toss-gray-300"}
                                        ${ue===0?"text-red-500":ue===6?"text-blue-500":"text-toss-gray-900"}
                                        ${B&&H.isCurrentMonth?"text-red-600 font-bold":""}
                                    `,children:H.date.getDate()}),B&&H.isCurrentMonth&&n.jsx("div",{className:"absolute bottom-0.5 left-1/2 transform -translate-x-1/2",children:n.jsx("div",{className:"w-1 h-1 bg-red-500 rounded-full"})})]},Q)})}),n.jsxs("div",{className:"mt-3 pt-3 border-t border-toss-gray-100 flex items-center gap-4 text-xs text-toss-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),n.jsx("span",{children:" "})]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("div",{className:"w-2 h-2 bg-toss-blue/30 rounded-full ring-1 ring-toss-blue"}),n.jsx("span",{children:""})]})]})]}),n.jsxs(At,{className:"lg:col-span-1",children:[n.jsx("h3",{className:"text-base font-bold text-toss-gray-900 mb-4",children:" "}),v.length>0?n.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:v.map(H=>n.jsxs("button",{onClick:()=>D(H),className:"block w-full text-left p-3 rounded-lg hover:bg-toss-gray-50 transition-colors border border-toss-gray-100",children:[n.jsx("p",{className:"font-medium text-toss-gray-900 text-sm truncate",children:H.title||" "}),n.jsx("p",{className:"text-xs text-toss-gray-400 mt-1",children:Z(H.meeting_date)})]},H.id))}):n.jsx("p",{className:"text-center text-toss-gray-500 py-8 text-sm",children:"  "})]})]}),n.jsx(yr,{isOpen:u,onClose:()=>d(!1),title:` - ${s}`,children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"text",value:b.title,onChange:H=>N({...b,title:H.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"  "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",value:b.participants,onChange:H=>N({...b,participants:H.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"  (: , )"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  *"}),n.jsx("textarea",{value:b.content,onChange:H=>N({...b,content:H.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all min-h-[200px] resize-none leading-relaxed",placeholder:"  "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"file",ref:R,onChange:F,multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx",className:"hidden"}),n.jsxs("button",{type:"button",onClick:()=>R.current?.click(),className:"w-full px-4 py-3 bg-toss-gray-50 border border-dashed border-toss-gray-300 rounded-xl hover:bg-toss-gray-100 transition-colors flex items-center justify-center gap-2 text-toss-gray-600",children:[n.jsx(uo,{size:18}),n.jsx("span",{children:"  (, )"})]}),b.existingFileUrls.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-xs text-toss-gray-500",children:" "}),b.existingFileUrls.map((H,Q)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-toss-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-toss-gray-400"}),n.jsx("span",{className:"text-sm text-toss-gray-700 truncate max-w-[200px]",children:H.name||""})]}),n.jsx("button",{type:"button",onClick:()=>oe(Q),className:"p-1 hover:bg-toss-gray-200 rounded",children:n.jsx(pr,{size:14,className:"text-toss-gray-500"})})]},Q))]}),b.files.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsx("p",{className:"text-xs text-toss-gray-500",children:" "}),b.files.map((H,Q)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-blue-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ka,{size:16,className:"text-blue-400"}),n.jsx("span",{className:"text-sm text-toss-gray-700 truncate max-w-[180px]",children:H.name}),n.jsx("span",{className:"text-xs text-toss-gray-400",children:H.size})]}),n.jsx("button",{type:"button",onClick:()=>V(Q),className:"p-1 hover:bg-blue-100 rounded",children:n.jsx(pr,{size:14,className:"text-toss-gray-500"})})]},Q))]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[x.find(H=>H.meeting_date===s)&&n.jsx(rt,{variant:"secondary",onClick:M,disabled:g,className:"text-red-500 hover:bg-red-50",children:""}),n.jsx(rt,{variant:"secondary",onClick:()=>d(!1),className:"flex-1",children:""}),n.jsx(rt,{onClick:K,disabled:g||S,className:"flex-1",children:S?" ...":g?" ...":""})]})]})}),n.jsx(yr,{isOpen:h,onClose:()=>{m(!1),c(null)},title:" ",children:o&&n.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto -mx-2 px-2",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),n.jsx("p",{className:"text-toss-gray-900",children:Z(o.meeting_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900",children:o.participants||"-"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),n.jsx("p",{className:"text-toss-gray-900 font-medium",children:o.title||" "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:" "}),n.jsx("div",{className:"bg-toss-gray-50 rounded-xl p-4 min-h-[150px] whitespace-pre-wrap text-toss-gray-900",children:o.content||"-"})]}),o.file_urls&&o.file_urls.length>0&&n.jsx(WB,{files:o.file_urls}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{m(!1),c(null)},className:"flex-1",children:""}),n.jsx(rt,{onClick:()=>{m(!1),a(o.meeting_date),N({title:o.title||"",content:o.content||"",participants:o.participants||"",files:[],existingFileUrls:o.file_urls||[]}),d(!0),c(null)},className:"flex-1",children:""})]})]})})]})},Bh=[{key:"blue",bg:"bg-blue-100",text:"text-blue-700",dot:"bg-blue-500"},{key:"purple",bg:"bg-purple-100",text:"text-purple-700",dot:"bg-purple-500"},{key:"green",bg:"bg-green-100",text:"text-green-700",dot:"bg-green-500"},{key:"amber",bg:"bg-amber-100",text:"text-amber-700",dot:"bg-amber-500"},{key:"red",bg:"bg-red-100",text:"text-red-700",dot:"bg-red-500"},{key:"orange",bg:"bg-orange-100",text:"text-orange-700",dot:"bg-orange-500"},{key:"gray",bg:"bg-gray-100",text:"text-gray-700",dot:"bg-gray-500"},{key:"pink",bg:"bg-pink-100",text:"text-pink-700",dot:"bg-pink-500"},{key:"teal",bg:"bg-teal-100",text:"text-teal-700",dot:"bg-teal-500"},{key:"indigo",bg:"bg-indigo-100",text:"text-indigo-700",dot:"bg-indigo-500"}],VB={general:{bg:"bg-blue-100",text:"text-blue-700",dot:"bg-blue-500",label:""},meeting:{bg:"bg-purple-100",text:"text-purple-700",dot:"bg-purple-500",label:""},training:{bg:"bg-green-100",text:"text-green-700",dot:"bg-green-500",label:""},rescue:{bg:"bg-amber-100",text:"text-amber-700",dot:"bg-amber-500",label:""},holiday:{bg:"bg-red-100",text:"text-red-700",dot:"bg-red-500",label:""},event:{bg:"bg-orange-100",text:"text-orange-700",dot:"bg-orange-500",label:""},leave:{bg:"bg-pink-100",text:"text-pink-700",dot:"bg-pink-500",label:""},other:{bg:"bg-gray-100",text:"text-gray-700",dot:"bg-gray-500",label:""}},KB=()=>{const{user:e,isAdmin:t}=Yr(),[r,s]=Y.useState(new Date),[a,o]=Y.useState(null),[c,u]=Y.useState(null),[d,h]=Y.useState(!1),[m,x]=Y.useState(!1),[y,v]=Y.useState(!1),[w,g]=Y.useState([]),[_,b]=Y.useState([]),[N,S]=Y.useState({}),[E,R]=Y.useState(!1),[L,O]=Y.useState({title:"",location:"",description:"",event_type:"general",start_time:"",end_time:""}),[P,F]=Y.useState(VB),[V,oe]=Y.useState(!1),[D,K]=Y.useState({key:"",label:"",color:"blue"}),[M,ae]=Y.useState(null),[te,Z]=Y.useState({isOpen:!1,message:"",type:"info"}),we=(ne,je="info")=>{Z({isOpen:!0,message:ne,type:je})},ee=async()=>{try{const{data:ne}=await Ue.from("event_types").select("*").order("created_at");if(ne&&ne.length>0){const je={};ne.forEach(Me=>{const De=Bh.find(Ce=>Ce.key===Me.color)||Bh[0];je[Me.key]={bg:De.bg,text:De.text,dot:De.dot,label:Me.label}}),F(je)}}catch(ne){console.error("Error fetching event types:",ne)}},Ne=async()=>{if(!D.key.trim()||!D.label.trim()){we("   .","error");return}try{M?await Ue.from("event_types").update({label:D.label,color:D.color,updated_at:new Date().toISOString()}).eq("key",M):await Ue.from("event_types").insert({key:D.key.toLowerCase().replace(/\s/g,"_"),label:D.label,color:D.color}),await ee(),oe(!1),K({key:"",label:"",color:"blue"}),ae(null),we(M?"  .":"  .","success")}catch(ne){console.error("Error saving event type:",ne),we(" .","error")}},q=async ne=>{if(confirm("   ?"))try{await Ue.from("event_types").delete().eq("key",ne),await ee(),we("  .","success")}catch(je){console.error("Error deleting event type:",je),we(" .","error")}},I=ne=>{const je=P[ne],Me=Bh.find(De=>De.bg===je.bg)?.key||"blue";K({key:ne,label:je.label,color:Me}),ae(ne),oe(!0)};Y.useEffect(()=>{(async()=>{try{const Me=await(await fetch("https://holidays.hyunbin.page/basic.json")).json();S(Me)}catch(je){console.error("Error fetching holidays:",je)}})()},[]),Y.useEffect(()=>{ee(),X(),H()},[r]);const X=async()=>{try{const ne=r.getFullYear(),je=r.getMonth(),Me=new Date(ne,je,1).toISOString().split("T")[0],De=new Date(ne,je+1,0).toISOString().split("T")[0],{data:Ce}=await Ue.from("events").select("*").gte("event_date",Me).lte("event_date",De).neq("event_type","leave").order("event_date",{ascending:!0});g(Ce||[])}catch(ne){console.error("Error fetching events:",ne)}},H=async()=>{try{const ne=new Date().toISOString().split("T")[0],{data:je}=await Ue.from("events").select("*").gte("event_date",ne).neq("event_type","leave").order("event_date",{ascending:!0}).limit(10);b(je||[])}catch(ne){console.error("Error fetching recent events:",ne)}},Q=ne=>{o(ne);const je=w.filter(Me=>Me.event_date===ne);je.length>0?(u(je[0]),x(!0)):(z(),v(!1),h(!0))},ie=()=>{a||o(new Date().toISOString().split("T")[0]),z(),v(!1),h(!0)},B=()=>{c&&(O({title:c.title||"",location:c.location||"",description:c.description||"",event_type:c.event_type||"general",start_time:c.start_time||"",end_time:c.end_time||""}),o(c.event_date),v(!0),x(!1),h(!0))},z=()=>{O({title:"",location:"",description:"",event_type:"general",start_time:"",end_time:""})},ue=async()=>{if(!L.title.trim()){alert(" .");return}R(!0);try{if(y&&c){const{error:ne}=await Ue.from("events").update({title:L.title,location:L.location||null,description:L.description||null,event_type:L.event_type,start_time:L.start_time||null,end_time:L.end_time||null,updated_at:new Date().toISOString()}).eq("id",c.id);if(ne)throw ne}else{const{error:ne}=await Ue.from("events").insert([{event_date:a,title:L.title,location:L.location||null,description:L.description||null,event_type:L.event_type,start_time:L.start_time||null,end_time:L.end_time||null,created_by:e?.user_id}]);if(ne)throw ne}await X(),await H(),h(!1),u(null)}catch(ne){console.error("Error saving event:",ne),alert("   : "+(ne.message||JSON.stringify(ne)))}finally{R(!1)}},se=async()=>{if(confirm("  ?")){R(!0);try{c&&(await Ue.from("events").delete().eq("id",c.id),await X(),await H()),x(!1),u(null)}catch(ne){console.error("Error deleting event:",ne),alert("   .")}finally{R(!1)}}},re=ne=>{const je=ne.getFullYear(),Me=ne.getMonth(),De=new Date(je,Me,1),st=new Date(je,Me+1,0).getDate(),We=De.getDay(),Ze=[];for(let pt=0;pt<We;pt++){const Tt=new Date(je,Me,-We+pt+1);Ze.push({date:Tt,isCurrentMonth:!1})}for(let pt=1;pt<=st;pt++)Ze.push({date:new Date(je,Me,pt),isCurrentMonth:!0});const Re=42-Ze.length;for(let pt=1;pt<=Re;pt++)Ze.push({date:new Date(je,Me+1,pt),isCurrentMonth:!1});return Ze},W=ne=>{const je=ne.getFullYear(),Me=String(ne.getMonth()+1).padStart(2,"0"),De=String(ne.getDate()).padStart(2,"0");return`${je}-${Me}-${De}`},ce=ne=>{const je=new Date(ne);return`${je.getFullYear()}. ${je.getMonth()+1}. ${je.getDate()}.`},k=ne=>{const je=W(ne);return w.filter(Me=>Me.event_date===je)},de=ne=>{const je=ne.getFullYear().toString(),Me=W(ne);return N[je]&&N[je][Me]?N[je][Me]:null},U=ne=>{const je=new Date;return ne.toDateString()===je.toDateString()},T=()=>{s(new Date(r.getFullYear(),r.getMonth()-1,1))},A=()=>{s(new Date(r.getFullYear(),r.getMonth()+1,1))},G=re(r),xe=["","","","","","",""],be=(ne,je)=>{je.stopPropagation(),u(ne),o(ne.event_date),x(!0)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(At,{className:"bg-gradient-to-r from-orange-500 to-amber-500 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(c4,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:""}),n.jsx("p",{className:"text-white/90",children:"   "})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[n.jsxs(At,{className:"lg:col-span-2",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("button",{onClick:T,className:"p-2 hover:bg-toss-gray-100 rounded-full transition-colors",children:n.jsx(za,{size:20})}),n.jsxs("h3",{className:"text-lg font-bold",children:[r.getFullYear()," ",r.getMonth()+1,""]}),n.jsx("button",{onClick:A,className:"p-2 hover:bg-toss-gray-100 rounded-full transition-colors",children:n.jsx(pa,{size:20})})]}),n.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[xe.map((ne,je)=>n.jsx("div",{className:`text-center text-sm font-medium py-2 ${je===0?"text-red-500":je===6?"text-blue-500":"text-toss-gray-500"}`,children:ne},ne)),G.map((ne,je)=>{const Me=W(ne.date),De=k(ne.date);De.length>0;const Ce=ne.date.getDay(),st=de(ne.date),We=st!==null;return n.jsxs("div",{onClick:()=>ne.isCurrentMonth&&Q(Me),className:`
                                        min-h-[80px] p-1 border border-toss-gray-100 rounded-lg cursor-pointer
                                        transition-all hover:bg-toss-gray-50
                                        ${!ne.isCurrentMonth&&"opacity-40"}
                                        ${U(ne.date)&&"ring-2 ring-toss-blue ring-inset"}
                                        ${We&&ne.isCurrentMonth&&"bg-red-50"}
                                    `,children:[n.jsx("div",{className:`text-sm font-medium mb-1 ${We||Ce===0?"text-red-500":Ce===6?"text-blue-500":""}`,children:ne.date.getDate()}),We&&n.jsx("div",{className:"text-xs px-1 py-0.5 rounded truncate bg-red-100 text-red-600 mb-0.5",children:st.join(", ")}),n.jsxs("div",{className:"space-y-0.5",children:[De.slice(0,We?1:2).map((Ze,Re)=>{const pt=P[Ze.event_type]||P.general;return n.jsx("div",{onClick:Tt=>be(Ze,Tt),className:`text-xs px-1 py-0.5 rounded truncate ${pt.bg} ${pt.text}`,children:Ze.title},Re)}),De.length>(We?1:2)&&n.jsxs("div",{className:"text-xs text-toss-gray-500 pl-1",children:["+",De.length-(We?1:2)," "]})]})]},je)})]}),n.jsx("div",{className:"mt-4 pt-4 border-t border-toss-gray-100",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex flex-wrap gap-3 text-xs",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),n.jsx("span",{className:"text-toss-gray-600",children:""})]}),Object.entries(P).map(([ne,je])=>n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${je.dot}`}),n.jsx("span",{className:"text-toss-gray-600",children:je.label})]},ne))]}),t&&n.jsxs("button",{onClick:()=>{K({key:"",label:"",color:"blue"}),ae(null),oe(!0)},className:"flex items-center gap-1 text-xs text-toss-gray-500 hover:text-toss-blue transition-colors",children:[n.jsx(hl,{size:14})," "]})]})})]}),n.jsxs(At,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-bold",children:" "}),n.jsxs(rt,{variant:"secondary",size:"sm",onClick:ie,className:"flex items-center gap-1",children:[n.jsx(Ns,{size:16})," "]})]}),n.jsx("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:_.length===0?n.jsx("p",{className:"text-toss-gray-500 text-center py-8",children:"  ."}):_.map(ne=>{const je=P[ne.event_type]||P.general;return n.jsx("div",{onClick:()=>{u(ne),o(ne.event_date),x(!0)},className:"p-3 bg-toss-gray-50 rounded-xl hover:bg-toss-gray-100 transition-colors cursor-pointer",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:`w-1 h-full min-h-[40px] rounded-full ${je.dot}`}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${je.bg} ${je.text}`,children:je.label}),n.jsx("span",{className:"text-xs text-toss-gray-500",children:ce(ne.event_date)})]}),n.jsx("h4",{className:"font-medium text-toss-gray-900 truncate",children:ne.title}),ne.location&&n.jsxs("p",{className:"text-sm text-toss-gray-500 flex items-center gap-1 mt-1",children:[n.jsx(uy,{size:12}),ne.location]}),ne.start_time&&n.jsxs("p",{className:"text-sm text-toss-gray-500 flex items-center gap-1 mt-1",children:[n.jsx(ea,{size:12}),ne.start_time,ne.end_time&&` ~ ${ne.end_time}`]})]})]})},ne.id)})})]})]}),n.jsx(yr,{isOpen:d,onClose:()=>h(!1),title:y?" ":"  ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"date",value:a||"",onChange:ne=>o(ne.target.value),className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" *"}),n.jsx("input",{type:"text",value:L.title,onChange:ne=>O({...L,title:ne.target.value}),placeholder:" ",className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("select",{value:L.event_type,onChange:ne=>O({...L,event_type:ne.target.value}),className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue",children:Object.entries(P).map(([ne,je])=>n.jsx("option",{value:ne,children:je.label},ne))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",value:L.location,onChange:ne=>O({...L,location:ne.target.value}),placeholder:" ",className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"time",value:L.start_time,onChange:ne=>O({...L,start_time:ne.target.value}),className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"time",value:L.end_time,onChange:ne=>O({...L,end_time:ne.target.value}),className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:L.description,onChange:ne=>O({...L,description:ne.target.value}),placeholder:"  ",rows:4,className:"w-full px-4 py-3 border border-toss-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-toss-blue resize-none"})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",className:"flex-1",onClick:()=>h(!1),children:""}),n.jsx(rt,{className:"flex-1",onClick:ue,disabled:E,children:E?" ...":y?"":""})]})]})}),n.jsx(yr,{isOpen:m,onClose:()=>{x(!1),u(null)},title:" ",children:c&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{children:n.jsx("span",{className:`inline-block text-xs px-2 py-1 rounded ${P[c.event_type]?.bg||"bg-gray-100"} ${P[c.event_type]?.text||"text-gray-700"}`,children:P[c.event_type]?.label||""})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900",children:ce(c.event_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-lg font-bold text-toss-gray-900",children:c.title})]}),c.location&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-toss-gray-900 flex items-center gap-2",children:[n.jsx(uy,{size:16,className:"text-toss-gray-400"}),c.location]})]}),(c.start_time||c.end_time)&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-toss-gray-900 flex items-center gap-2",children:[n.jsx(ea,{size:16,className:"text-toss-gray-400"}),c.start_time,c.end_time&&` ~ ${c.end_time}`]})]}),c.description&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-1",children:" "}),n.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap bg-toss-gray-50 p-3 rounded-xl",children:c.description})]}),a&&w.filter(ne=>ne.event_date===a&&ne.id!==c.id).length>0&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-500 mb-2",children:"   "}),n.jsx("div",{className:"space-y-2",children:w.filter(ne=>ne.event_date===a&&ne.id!==c.id).map(ne=>{const je=P[ne.event_type]||P.general;return n.jsx("div",{onClick:()=>u(ne),className:"p-2 bg-toss-gray-50 rounded-lg cursor-pointer hover:bg-toss-gray-100 transition-colors",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${je.dot}`}),n.jsx("span",{className:"text-sm font-medium",children:ne.title})]})},ne.id)})})]}),n.jsxs("div",{className:"flex gap-3 pt-4 border-t border-toss-gray-100",children:[n.jsxs(rt,{variant:"secondary",className:"flex-1 flex items-center justify-center gap-2",onClick:B,children:[n.jsx(Oc,{size:16}),""]}),n.jsxs(rt,{variant:"secondary",className:"flex-1 flex items-center justify-center gap-2 text-red-500 hover:bg-red-50",onClick:se,disabled:E,children:[n.jsx(cr,{size:16}),""]})]})]})}),n.jsx(yr,{isOpen:V,onClose:()=>{oe(!1),ae(null),K({key:"",label:"",color:"blue"})},title:"  ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:Object.entries(P).map(([ne,je])=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-toss-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${je.dot}`}),n.jsx("span",{className:"text-sm font-medium",children:je.label}),n.jsxs("span",{className:"text-xs text-toss-gray-500",children:["(",ne,")"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>I(ne),className:"p-1 text-toss-gray-500 hover:text-toss-blue transition-colors",children:n.jsx(Oc,{size:14})}),n.jsx("button",{onClick:()=>q(ne),className:"p-1 text-toss-gray-500 hover:text-red-500 transition-colors",children:n.jsx(cr,{size:14})})]})]},ne))})]}),n.jsxs("div",{className:"border-t border-toss-gray-100 pt-4",children:[n.jsx("h4",{className:"text-sm font-medium text-toss-gray-700 mb-3",children:M?" ":"  "}),!M&&n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:"  ()"}),n.jsx("input",{type:"text",value:D.key,onChange:ne=>K({...D,key:ne.target.value}),placeholder:": workshop",className:"w-full px-3 py-2 border border-toss-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue text-sm"})]}),n.jsxs("div",{className:"mb-3",children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:" "}),n.jsx("input",{type:"text",value:D.label,onChange:ne=>K({...D,label:ne.target.value}),placeholder:": ",className:"w-full px-3 py-2 border border-toss-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue text-sm"})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-xs text-toss-gray-500 mb-1",children:""}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Bh.map(ne=>n.jsx("button",{onClick:()=>K({...D,color:ne.key}),className:`w-8 h-8 rounded-full ${ne.dot} ${D.color===ne.key?"ring-2 ring-offset-2 ring-toss-blue":""}`},ne.key))})]}),n.jsxs("div",{className:"flex gap-2",children:[M&&n.jsx(rt,{variant:"secondary",size:"sm",onClick:()=>{ae(null),K({key:"",label:"",color:"blue"})},className:"flex-1",children:""}),n.jsx(rt,{size:"sm",onClick:Ne,className:"flex-1",children:M?"":""})]})]})]})}),te.isOpen&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:1e4},onClick:()=>Z({...te,isOpen:!1}),children:n.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl animate-in fade-in zoom-in duration-200",onClick:ne=>ne.stopPropagation(),children:n.jsxs("div",{className:"flex flex-col items-center text-center",children:[n.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center mb-4 ${te.type==="success"?"bg-green-100":te.type==="error"?"bg-red-100":"bg-blue-100"}`,children:te.type==="success"?n.jsx(Hs,{className:"w-7 h-7 text-green-600"}):te.type==="error"?n.jsx(_n,{className:"w-7 h-7 text-red-600"}):n.jsx(_n,{className:"w-7 h-7 text-blue-600"})}),n.jsx("p",{className:"text-toss-gray-900 font-medium mb-6 leading-relaxed",children:te.message}),n.jsx("button",{onClick:()=>Z({...te,isOpen:!1}),className:`w-full py-3 rounded-xl font-medium transition-colors ${te.type==="success"?"bg-green-500 hover:bg-green-600 text-white":te.type==="error"?"bg-red-500 hover:bg-red-600 text-white":"bg-toss-blue hover:bg-blue-600 text-white"}`,children:""})]})})})]})},_y={full:1,half_am:.5,half_pm:.5,out_1h:.125,out_2h:.25,out_3h:.375,comp:1},f0=15,nd=4,mv=()=>{const{user:e,isAdmin:t,isSubAdmin:r}=Yr(),s=t||r,[a,o]=Y.useState(null),[c,u]=Y.useState(null),[d,h]=Y.useState([]),[m,x]=Y.useState([]),[y,v]=Y.useState(!0),w=new Date().getFullYear(),g=Y.useCallback(async()=>{if(!e?.user_id)return;let{data:V,error:oe}=await Ue.from("annual_leaves").select("*").eq("user_id",e.user_id).eq("year",w).single();if(oe&&oe.code!=="PGRST116"&&console.error("Error fetching annual leave:",oe),!V){const{data:te,error:Z}=await Ue.from("annual_leaves").insert([{user_id:e.user_id,year:w,total_days:f0,used_days:0}]).select().single();Z||(V=te)}const D=`${w}-01-01`,K=`${w}-12-31`,{data:M}=await Ue.from("document_labels").select("id").eq("code",nd).single();let ae=0;if(M){const{data:te}=await Ue.from("documents").select("leave_days, leave_type").eq("drafter_id",e.user_id).eq("label_id",M.id).eq("attendance_type","leave").eq("status","approved").gte("leave_start_date",D).lte("leave_start_date",K).not("leave_type","is",null).neq("leave_type","comp");ae=(te||[]).reduce((Z,we)=>Z+(we.leave_days||0),0)}V&&o({...V,used_days:ae})},[e?.user_id,w]),_=Y.useCallback(async()=>{if(!e?.user_id)return;const{data:V,error:oe}=await Ue.from("comp_leaves").select("*").eq("user_id",e.user_id).eq("year",w).single();oe&&oe.code!=="PGRST116"&&console.error("Error fetching comp leave:",oe),u(V||null)},[e?.user_id,w]),b=Y.useCallback(async()=>{if(!e?.user_id)return;const{data:V,error:oe}=await Ue.from("leave_requests").select("*").eq("user_id",e.user_id).order("created_at",{ascending:!1});oe?console.error("Error fetching leave requests:",oe):h(V||[])},[e?.user_id]),N=Y.useCallback(async()=>{if(!s)return;const{data:V,error:oe}=await Ue.from("leave_requests").select("*").eq("status","pending").order("created_at",{ascending:!0});oe?console.error("Error fetching pending requests:",oe):x(V||[])},[s]),S=async({startDate:V,endDate:oe,leaveType:D,reason:K})=>{if(!e?.user_id)return{error:{message:" ."}};let M=0;if(D==="full"||D==="comp"){const Z=new Date(V),we=new Date(oe);M=Math.ceil((we-Z)/(1e3*60*60*24))+1}else M=_y[D]||.5;if(D!=="comp"&&a){const Z=a.total_days-a.used_days;if(M>Z)return{error:{message:`  . (: ${Z})`}}}const{data:ae,error:te}=await Ue.from("leave_requests").insert([{user_id:e.user_id,start_date:V,end_date:oe,leave_type:D,days:M,reason:K,status:"pending"}]).select().single();return te?console.error("Submit leave request error:",te):await b(),{data:ae,error:te}},E=async V=>{const{error:oe}=await Ue.from("leave_requests").delete().eq("id",V).eq("user_id",e.user_id).eq("status","pending");return oe||await b(),{error:oe}},R=async(V,{startDate:oe,endDate:D,leaveType:K,reason:M})=>{if(!e?.user_id)return{error:{message:" ."}};let ae=0;if(K==="full"||K==="comp"){const we=new Date(oe),ee=new Date(D);ae=Math.ceil((ee-we)/(1e3*60*60*24))+1}else ae=_y[K]||.5;if(K!=="comp"&&a){const we=a.total_days-a.used_days;if(ae>we)return{error:{message:`  . (: ${we})`}}}const{data:te,error:Z}=await Ue.from("leave_requests").update({start_date:oe,end_date:D,leave_type:K,days:ae,reason:M,updated_at:new Date().toISOString()}).eq("id",V).eq("user_id",e.user_id).eq("status","pending").select().single();return Z?console.error("Update leave request error:",Z):await b(),{data:te,error:Z}},L=async V=>{if(!s)return{error:{message:" ."}};const{data:oe}=await Ue.from("leave_requests").select("*").eq("id",V).single();if(!oe)return{error:{message:"    ."}};const{error:D}=await Ue.from("leave_requests").update({status:"approved",approved_by:e.user_id,updated_at:new Date().toISOString()}).eq("id",V);if(D)return{error:D};if(oe.leave_type==="comp"){const K=oe.days*8,{data:M}=await Ue.from("comp_leaves").select("*").eq("user_id",oe.user_id).eq("year",w).single();M&&await Ue.from("comp_leaves").update({used_hours:M.used_hours+K,updated_at:new Date().toISOString()}).eq("id",M.id)}else{const{data:K}=await Ue.from("annual_leaves").select("*").eq("user_id",oe.user_id).eq("year",w).single();K&&await Ue.from("annual_leaves").update({used_days:K.used_days+oe.days,updated_at:new Date().toISOString()}).eq("id",K.id)}return await N(),{error:null}},O=async(V,oe)=>{if(!s)return{error:{message:" ."}};const{error:D}=await Ue.from("leave_requests").update({status:"rejected",rejected_reason:oe,approved_by:e.user_id,updated_at:new Date().toISOString()}).eq("id",V);return D||await N(),{error:D}},P=async()=>{if(!s)return{data:null,error:{message:" ."}};const{data:V,error:oe}=await Ue.from("annual_leaves").select("*").eq("year",w).order("user_id");return{data:V,error:oe}},F=async(V,oe)=>{if(!s)return{error:{message:" ."}};const{data:D,error:K}=await Ue.from("annual_leaves").upsert({user_id:V,year:w,total_days:oe,updated_at:new Date().toISOString()},{onConflict:"user_id,year"}).select().single();return{data:D,error:K}};return Y.useEffect(()=>{const V=async()=>{v(!0),await Promise.all([g(),_(),b(),N()]),v(!1)};e?.user_id?V():v(!1)},[e?.user_id,g,_,b,N]),{annualLeave:a,compLeave:c,leaveRequests:d,pendingRequests:m,loading:y,canManage:s,submitLeaveRequest:S,cancelLeaveRequest:E,updateLeaveRequest:R,approveLeaveRequest:L,rejectLeaveRequest:O,fetchAllAnnualLeaves:P,updateUserAnnualLeave:F,refresh:()=>{g(),_(),b(),N()}}},XB=()=>{const{profile:e,updateProfile:t}=Yr(),{annualLeave:r,compLeave:s,loading:a}=mv(),[o,c]=Y.useState(!1),[u,d]=Y.useState(!1),[h,m]=Y.useState({name:"",rank:"",team:""});Y.useEffect(()=>{e&&m({name:e.name||"",rank:e.rank||"",team:e.team||""})},[e]);const x=async y=>{if(y.preventDefault(),!h.name.trim()){alert(" .");return}c(!0),d(!1);try{const{error:v}=await t(h);v?alert("  ."):(d(!0),setTimeout(()=>d(!1),3e3))}catch(v){console.error("Profile update error:",v),alert("    .")}finally{c(!1)}};return n.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[n.jsxs(Gs,{to:"/",className:"inline-flex items-center gap-2 text-toss-gray-500 hover:text-toss-gray-700 transition-colors",children:[n.jsx(Wd,{size:20})," "]}),n.jsx(At,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsx("div",{className:"w-20 h-20 bg-white/20 rounded-full flex items-center justify-center flex-shrink-0",children:n.jsx("span",{className:"text-3xl font-bold",children:h.name?.charAt(0)||e?.name?.charAt(0)||"U"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-2xl font-bold mb-1",children:""}),n.jsxs("p",{className:"text-white/90 flex items-center gap-2",children:[n.jsx(pF,{size:16}),e?.team?`${e.team}  ${e.rank||""}`:e?.user_id||" ..."]})]})]})}),n.jsxs(At,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:n.jsx(ha,{className:"text-emerald-600",size:20})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-bold text-toss-gray-900",children:" "}),n.jsxs("p",{className:"text-sm text-toss-gray-500",children:[new Date().getFullYear(),""]})]})]}),n.jsxs(Gs,{to:"/leave",className:"flex items-center gap-1 text-sm text-toss-blue hover:text-blue-700 transition-colors",children:[" ",n.jsx(pa,{size:16})]})]}),a?n.jsx("div",{className:"h-20 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-toss-blue border-t-transparent"})}):r?n.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[n.jsxs("div",{className:"text-center p-4 bg-toss-gray-50 rounded-xl",children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[r.total_days,n.jsx("span",{className:"text-sm font-normal text-toss-gray-500",children:""})]})]}),n.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-xl",children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold text-toss-blue",children:[r.used_days,n.jsx("span",{className:"text-sm font-normal text-toss-gray-500",children:""})]})]}),n.jsxs("div",{className:"text-center p-4 bg-emerald-50 rounded-xl",children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:[r.total_days-r.used_days,n.jsx("span",{className:"text-sm font-normal text-toss-gray-500",children:""})]})]}),n.jsxs("div",{className:"text-center p-4 bg-amber-50 rounded-xl",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold text-amber-600",children:[s?Math.floor((s.total_hours-s.used_hours)/8):0,n.jsx("span",{className:"text-sm font-normal text-toss-gray-500",children:""})]})]})]}):n.jsx("div",{className:"text-center py-6 text-toss-gray-500",children:"    "}),r&&n.jsxs("div",{className:"mt-4",children:[n.jsxs("div",{className:"flex justify-between text-xs text-toss-gray-500 mb-2",children:[n.jsx("span",{children:""}),n.jsxs("span",{children:[Math.round(r.used_days/r.total_days*100),"%"]})]}),n.jsx("div",{className:"h-2 bg-toss-gray-100 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-gradient-to-r from-toss-blue to-emerald-500 rounded-full transition-all duration-500",style:{width:`${r.used_days/r.total_days*100}%`}})})]})]}),n.jsxs(At,{children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:" "}),n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:"       "})]}),n.jsxs("form",{onSubmit:x,className:"space-y-5",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-toss-gray-700 mb-2",children:[n.jsx(nl,{size:16})," *"]}),n.jsx("input",{type:"text",value:h.name,onChange:y=>m({...h,name:y.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl text-toss-gray-900 focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:" ",required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-toss-gray-700 mb-2",children:[n.jsx(Sd,{size:16}),""]}),n.jsx("input",{type:"text",value:h.team,onChange:y=>m({...h,team:y.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl text-toss-gray-900 focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"  (: , )"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-toss-gray-700 mb-2",children:[n.jsx(l4,{size:16}),""]}),n.jsx("input",{type:"text",value:h.rank,onChange:y=>m({...h,rank:y.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl text-toss-gray-900 focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all",placeholder:"  (: , , )"})]}),u&&n.jsxs("div",{className:"flex items-center gap-2 text-emerald-700 bg-emerald-50 p-4 rounded-xl border border-emerald-100",children:[n.jsx(y0,{size:20}),n.jsx("span",{className:"font-medium",children:"  "})]}),n.jsx(rt,{type:"submit",className:"w-full",loading:o,disabled:o||!h.name.trim(),children:o?" ...":""})]})]}),n.jsx(At,{className:"bg-toss-gray-50",children:n.jsxs("div",{className:"space-y-2",children:[n.jsx("h3",{className:"font-bold text-toss-gray-900 mb-3",children:""}),n.jsx("p",{className:"text-sm text-toss-gray-600 leading-relaxed",children:"   "}),n.jsx("p",{className:"text-sm text-toss-gray-600 leading-relaxed",children:"    ,    "})]})})]})},gT=()=>{const{user:e,isAdmin:t,isSubAdmin:r}=Yr(),[s,a]=Y.useState([]),[o,c]=Y.useState([]),[u,d]=Y.useState([]),[h,m]=Y.useState([]),[x,y]=Y.useState([]),[v,w]=Y.useState(!0),[g,_]=Y.useState(null),b=t||r,N=Y.useCallback(async()=>{try{const{data:K,error:M}=await Ue.from("document_labels").select("*").order("code");if(M)throw M;m(K||[])}catch{_("   .")}},[]),S=Y.useCallback(async()=>{try{const{data:K,error:M}=await Ue.from("users").select("user_id, name, rank, team").order("name");if(M)throw M;y(K||[])}catch{_("   .")}},[]),E=Y.useCallback(async()=>{if(e){w(!0),_(null);try{const{data:K,error:M}=await Ue.from("documents").select("*, document_labels(*)").eq("drafter_id",e.user_id).order("created_at",{ascending:!1});if(M)throw M;a(K||[]);const{data:ae,error:te}=await Ue.from("documents").select("*, document_labels(*)").order("created_at",{ascending:!1});if(te)throw te;if(c(ae||[]),b){const{data:Z,error:we}=await Ue.from("documents").select("*, document_labels(*)").in("status",["pending","chairman_approved"]).order("created_at",{ascending:!1});if(we)throw we;d(Z||[])}}catch{_("   .")}finally{w(!1)}}},[e,b]);return Y.useEffect(()=>{N(),E(),S()},[N,E,S]),{documents:s,allDocuments:o,pendingDocuments:u,labels:h,users:x,loading:v,error:g,canManage:b,createDocument:async K=>{if(!e)return{error:" ."};const M=new Date,ae=`${M.getFullYear()}/${String(M.getMonth()+1).padStart(2,"0")}/${String(M.getDate()).padStart(2,"0")}`,te=new Date(M.setHours(0,0,0,0)).toISOString(),{count:Z}=await Ue.from("documents").select("*",{count:"exact",head:!0}).gte("created_at",te),we=`${ae}-${(Z||0)+1}`,{data:ee,error:Ne}=await Ue.from("documents").insert({label_id:K.label_id,title:K.title,content:K.content,extra_work_hours:K.extra_work_hours||0,doc_number:we,drafter_id:e.user_id,status:"pending",execution_date:K.execution_date||null,payment_method:K.payment_method||null,expense_items:K.expense_items||null,attachments:K.attachments||null,attendance_type:K.attendance_type||null,leave_type:K.leave_type||null,leave_start_date:K.leave_start_date||null,leave_end_date:K.leave_end_date||null,leave_days:K.leave_days||null,is_private:K.is_private||!1}).select().single();return Ne?console.error("Create document error:",Ne):E(),{data:ee,error:Ne}},updateDocument:async(K,M)=>{if(!e)return{error:" ."};const{data:ae,error:te}=await Ue.from("documents").update({label_id:M.label_id,title:M.title,content:M.content,extra_work_hours:M.extra_work_hours||0,execution_date:M.execution_date||null,payment_method:M.payment_method||null,expense_items:M.expense_items||null,attachments:M.attachments||null,attendance_type:M.attendance_type||null,leave_type:M.leave_type||null,leave_start_date:M.leave_start_date||null,leave_end_date:M.leave_end_date||null,leave_days:M.leave_days||null,is_private:M.is_private||!1,updated_at:new Date().toISOString()}).eq("id",K).eq("drafter_id",e.user_id).eq("status","pending").select().single();return te?console.error("Update document error:",te):E(),{data:ae,error:te}},approveDocument:async(K,M="chairman")=>{if(!b)return{error:" ."};const{data:ae}=await Ue.from("documents").select("*").eq("id",K).single();if(!ae)return{error:"   ."};if((ae.expense_items||[]).reduce((Ne,q)=>Ne+(Number(q.amount)||0),0)>=1e6&&M==="chairman"){const{error:Ne}=await Ue.from("documents").update({status:"chairman_approved",approver_id:e.user_id,updated_at:new Date().toISOString()}).eq("id",K);return Ne?{error:Ne}:(E(),{error:null})}const we={status:"approved",approver_id:e.user_id,approved_at:new Date().toISOString(),updated_at:new Date().toISOString()},{error:ee}=await Ue.from("documents").update(we).eq("id",K);if(ee)return{error:ee};if(ae.label_id){const{data:Ne}=await Ue.from("document_labels").select("code").eq("id",ae.label_id).single();if(Ne?.code===4){const q=new Date().getFullYear();if(ae.attendance_type==="overtime"&&ae.extra_work_hours>0){const{data:I}=await Ue.from("comp_leaves").select("*").eq("user_id",ae.drafter_id).eq("year",q).single();I?await Ue.from("comp_leaves").update({total_hours:I.total_hours+ae.extra_work_hours,updated_at:new Date().toISOString()}).eq("id",I.id):await Ue.from("comp_leaves").insert({user_id:ae.drafter_id,document_id:K,total_hours:ae.extra_work_hours,used_hours:0,year:q,description:ae.title})}if(ae.attendance_type==="leave"&&ae.leave_type){if(ae.leave_days>0)if(ae.leave_type==="comp"){const X=ae.leave_days*8,{data:H}=await Ue.from("comp_leaves").select("*").eq("user_id",ae.drafter_id).eq("year",q).single();H&&await Ue.from("comp_leaves").update({used_hours:H.used_hours+X,updated_at:new Date().toISOString()}).eq("id",H.id)}else{const{data:X}=await Ue.from("annual_leaves").select("*").eq("user_id",ae.drafter_id).eq("year",q).single();X&&await Ue.from("annual_leaves").update({used_days:X.used_days+ae.leave_days,updated_at:new Date().toISOString()}).eq("id",X.id)}const{data:I}=await Ue.from("users").select("name, rank").eq("user_id",ae.drafter_id).single();if(I){const X={full:"",half_am:"",half_pm:"",out_1h:"",out_2h:"",out_3h:"",comp:""};let H="";ae.title?ae.title.includes("")?H="":ae.title.includes("")?H="":ae.title.includes("")?H="":ae.title.includes("")?H="":ae.title.includes("")?H="":ae.title.includes("")?H="":ae.title.includes("")?H="":ae.title.includes("")?H="":ae.leave_type&&(H=X[ae.leave_type]||""):ae.leave_type&&(H=X[ae.leave_type]||"");const Q=`[${H}] ${I.name}${I.rank?" "+I.rank:""}`;let ie=[];if(ae.leave_start_date){const B=ae.leave_start_date,z=ae.leave_end_date||ae.leave_start_date,ue=new Date(B+"T00:00:00"),se=new Date(z+"T00:00:00");for(let re=new Date(ue);re<=se;re.setDate(re.getDate()+1)){const W=re.getFullYear(),ce=String(re.getMonth()+1).padStart(2,"0"),k=String(re.getDate()).padStart(2,"0");ie.push(`${W}-${ce}-${k}`)}}else{const B=new Date(ae.created_at).getFullYear(),z=/(\d{4})/g,ue=ae.title.match(z);if(ue)for(const se of ue){const re=se.substring(0,2),W=se.substring(2,4);parseInt(re)>=1&&parseInt(re)<=12&&parseInt(W)>=1&&parseInt(W)<=31&&ie.push(`${B}-${re}-${W}`)}}for(const B of ie)await Ue.from("events").insert({event_date:B,title:Q,event_type:"leave",description:ae.title,created_by:ae.drafter_id})}}}}return E(),{error:null}},rejectDocument:async(K,M)=>{if(!b)return{error:" ."};const{error:ae}=await Ue.from("documents").update({status:"rejected",approver_id:e.user_id,rejected_reason:M,updated_at:new Date().toISOString()}).eq("id",K);return ae||E(),{error:ae}},deleteDocument:async(K,M=!1)=>{if(M){const{error:te}=await Ue.from("documents").delete().eq("id",K).eq("drafter_id",e.user_id).eq("status","pending");return te?console.error("Delete document error:",te):E(),{error:te}}if(!b)return{error:" ."};await Ue.from("comp_leaves").delete().eq("document_id",K);const{error:ae}=await Ue.from("documents").delete().eq("id",K);return ae?console.error("Delete document error:",ae):E(),{error:ae}},addLabel:async(K,M)=>{if(!b)return{error:" ."};const{data:ae}=await Ue.from("document_labels").select("code").order("code",{ascending:!1}).limit(1).single(),te=(ae?.code||0)+1,{error:Z}=await Ue.from("document_labels").insert({code:te,name:K,color:M});return Z||N(),{error:Z}},updateLabel:async(K,M,ae)=>{if(!b)return{error:" ."};const{error:te}=await Ue.from("document_labels").update({name:M,color:ae}).eq("id",K);return te||N(),{error:te}},deleteLabel:async K=>{if(!b)return{error:" ."};const{error:M}=await Ue.from("document_labels").delete().eq("id",K);return M||N(),{error:M}},refresh:E}},YB=({formData:e,setFormData:t,editingDoc:r,onSubmit:s,onClose:a,submitting:o,attachments:c,setAttachments:u,expenseItems:d,setExpenseItems:h,isAttendanceLabel:m=!0,isExpenseLabel:x=!1,leaveTypes:y,remainingAnnualDays:v,compLeaveDays:w})=>{const[g,_]=Y.useState(!1),b=()=>{h([...d,{item:"",category:"",vendor:"",amount:"",note:""}])},N=O=>{d.length!==1&&h(d.filter((P,F)=>F!==O))},S=(O,P,F)=>{const V=[...d];V[O][P]=F,h(V)},E=d.reduce((O,P)=>O+(Number(P.amount)||0),0),R=async O=>{const P=Array.from(O.target.files);if(P.length!==0){_(!0);try{const F=await Gd(P,"/intranet/documents");u(V=>[...V,...F])}catch(F){alert("  : "+F.message)}finally{_(!1),O.target.value=""}}},L=O=>{u(P=>P.filter((F,V)=>V!==O))};return n.jsxs(At,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-lg font-bold text-toss-gray-900",children:r?" ":"  "}),n.jsx("button",{onClick:a,className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",children:n.jsx(pr,{size:20,className:"text-toss-gray-500"})})]}),n.jsxs("form",{onSubmit:s,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:e.title,onChange:O=>t({...e,title:O.target.value}),placeholder:" ",className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("button",{type:"button",onClick:()=>t({...e,is_private:!e.is_private}),className:`flex items-center gap-2 px-4 py-2 rounded-xl border-2 transition-all ${e.is_private?"border-red-400 bg-red-50 text-red-700":"border-toss-gray-200 bg-white text-toss-gray-600 hover:border-toss-gray-300"}`,children:[e.is_private?n.jsx(al,{size:16}):n.jsx(dF,{size:16}),n.jsx("span",{className:"text-sm font-medium",children:e.is_private?"":""})]}),n.jsx("span",{className:"text-xs text-toss-gray-500",children:e.is_private?"   ":"   "})]}),m&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("button",{type:"button",onClick:()=>t({...e,attendance_type:"overtime",leave_type:"",leave_start_date:"",leave_end_date:""}),className:`p-4 rounded-xl border-2 transition-all text-left ${e.attendance_type==="overtime"?"border-toss-blue bg-blue-50":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(ea,{size:18,className:e.attendance_type==="overtime"?"text-toss-blue":"text-toss-gray-500"}),n.jsx("span",{className:`font-medium ${e.attendance_type==="overtime"?"text-toss-blue":"text-toss-gray-700"}`,children:" "})]}),n.jsx("p",{className:"text-xs text-toss-gray-500",children:",  "})]}),n.jsxs("button",{type:"button",onClick:()=>t({...e,attendance_type:"leave",extra_work_hours:0}),className:`p-4 rounded-xl border-2 transition-all text-left ${e.attendance_type==="leave"?"border-toss-blue bg-blue-50":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(ha,{size:18,className:e.attendance_type==="leave"?"text-toss-blue":"text-toss-gray-500"}),n.jsx("span",{className:`font-medium ${e.attendance_type==="leave"?"text-toss-blue":"text-toss-gray-700"}`,children:" "})]}),n.jsx("p",{className:"text-xs text-toss-gray-500",children:", , "})]})]})]}),e.attendance_type==="overtime"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" ()"}),n.jsx("input",{type:"number",value:e.extra_work_hours,onChange:O=>t({...e,extra_work_hours:O.target.value}),placeholder:"0",step:"0.5",min:"0",className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"}),n.jsx("p",{className:"mt-1 text-xs text-toss-gray-500",children:"* 8 =  1"})]}),e.attendance_type==="leave"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"p-3 bg-toss-gray-50 rounded-xl",children:n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsxs("span",{className:"text-toss-gray-600",children:[" : ",n.jsxs("strong",{className:"text-toss-blue",children:[v,""]})]}),n.jsxs("span",{className:"text-toss-gray-600",children:[" : ",n.jsxs("strong",{className:"text-amber-600",children:[w,""]})]})]})}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:y.map(O=>n.jsxs("button",{type:"button",disabled:O.disabled,onClick:()=>t({...e,leave_type:O.value}),className:`p-3 rounded-xl border transition-all text-left ${O.disabled?"border-toss-gray-100 bg-toss-gray-50 text-toss-gray-400 cursor-not-allowed":e.leave_type===O.value?"border-toss-blue bg-blue-50":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[n.jsx("p",{className:`font-medium text-sm ${O.disabled?"text-toss-gray-400":e.leave_type===O.value?"text-toss-blue":"text-toss-gray-700"}`,children:O.label}),n.jsx("p",{className:"text-xs text-toss-gray-500",children:O.description})]},O.value))})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:e.leave_start_date,onChange:O=>t({...e,leave_start_date:O.target.value,leave_end_date:e.leave_end_date||O.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"date",value:e.leave_end_date,min:e.leave_start_date,onChange:O=>t({...e,leave_end_date:O.target.value}),className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]})]})]})]}),x&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",value:e.execution_date,onChange:O=>t({...e,execution_date:O.target.value}),placeholder:": 2025 1",className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"text",value:e.payment_method,onChange:O=>t({...e,payment_method:O.target.value}),placeholder:": ",className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700",children:""}),n.jsxs("button",{type:"button",onClick:b,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-toss-blue text-white rounded-lg hover:bg-toss-blue-dark transition-colors",children:[n.jsx(Ns,{size:14})," "]})]}),n.jsx("div",{className:"overflow-x-auto border border-toss-gray-200 rounded-xl",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-toss-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/4",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/6",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/6",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/6",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700 w-1/6",children:""}),n.jsx("th",{className:"px-3 py-2 w-10"})]})}),n.jsxs("tbody",{children:[d.map((O,P)=>n.jsxs("tr",{className:"border-t border-toss-gray-100",children:[n.jsx("td",{className:"p-2",children:n.jsx("input",{type:"text",value:O.item,onChange:F=>S(P,"item",F.target.value),placeholder:"",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm"})}),n.jsx("td",{className:"p-2",children:n.jsx("input",{type:"text",value:O.category,onChange:F=>S(P,"category",F.target.value),placeholder:"",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm"})}),n.jsx("td",{className:"p-2",children:n.jsx("input",{type:"text",value:O.vendor,onChange:F=>S(P,"vendor",F.target.value),placeholder:"",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm"})}),n.jsx("td",{className:"p-2",children:n.jsx("input",{type:"number",value:O.amount,onChange:F=>S(P,"amount",F.target.value),placeholder:"0",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm text-right"})}),n.jsx("td",{className:"p-2",children:n.jsx("input",{type:"text",value:O.note,onChange:F=>S(P,"note",F.target.value),placeholder:"",className:"w-full px-2 py-1.5 bg-white border border-toss-gray-200 rounded-lg text-sm"})}),n.jsx("td",{className:"p-2",children:n.jsx("button",{type:"button",onClick:()=>N(P),disabled:d.length===1,className:`p-1.5 rounded-lg transition-colors ${d.length===1?"text-toss-gray-300 cursor-not-allowed":"text-red-500 hover:bg-red-50"}`,children:n.jsx(cr,{size:16})})})]},P)),n.jsxs("tr",{className:"border-t-2 border-toss-gray-300 bg-toss-gray-50",children:[n.jsx("td",{colSpan:3,className:"px-3 py-2 text-right font-medium text-toss-gray-700",children:" "}),n.jsxs("td",{className:"px-3 py-2 text-right font-bold text-toss-blue",children:[E.toLocaleString(),""]}),n.jsx("td",{colSpan:2})]})]})]})})]})]}),!x&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("textarea",{value:e.content,onChange:O=>t({...e,content:O.target.value}),placeholder:"  ",rows:4,className:"w-full px-4 py-3 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent resize-none"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 px-4 py-3 bg-toss-gray-50 border border-dashed border-toss-gray-300 rounded-xl cursor-pointer hover:bg-toss-gray-100 transition-colors ${g?"opacity-50 cursor-not-allowed":""}`,children:[g?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-5 h-5 border-2 border-toss-blue border-t-transparent rounded-full animate-spin"}),n.jsx("span",{className:"text-toss-gray-500",children:" ..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(uo,{size:20,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-toss-gray-500",children:" "})]}),n.jsx("input",{type:"file",multiple:!0,onChange:R,disabled:g,className:"hidden"})]}),c.length>0&&n.jsx("div",{className:"space-y-2",children:c.map((O,P)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n.jsx(Dc,{size:16,className:"text-toss-blue flex-shrink-0"}),n.jsx("span",{className:"text-sm text-toss-gray-700 truncate",children:O.name}),n.jsxs("span",{className:"text-xs text-toss-gray-500 flex-shrink-0",children:["(",(O.size/1024).toFixed(1)," KB)"]})]}),n.jsx("button",{type:"button",onClick:()=>L(P),className:"p-1 hover:bg-blue-100 rounded transition-colors flex-shrink-0",children:n.jsx(pr,{size:16,className:"text-toss-gray-500"})})]},P))})]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(rt,{type:"submit",loading:o,disabled:o,className:"flex-1",children:o?r?" ...":" ...":r?"":" "}),n.jsx(rt,{type:"button",variant:"secondary",onClick:a,className:"flex-1",children:""})]})]})]})},JB=({documents:e,users:t,labels:r,loading:s,searchTerm:a,setSearchTerm:o,searchFilters:c,setSearchFilters:u,showAdvancedSearch:d,setShowAdvancedSearch:h,onDocClick:m,canManage:x,currentUserId:y})=>{const v=Y.useMemo(()=>{const R=new Date().getFullYear();return Array.from({length:5},(L,O)=>R-O)},[]),w=Array.from({length:12},(R,L)=>L+1),g=Y.useMemo(()=>e.filter(R=>!(a&&!R.title.toLowerCase().includes(a.toLowerCase())||c.year&&new Date(R.created_at).getFullYear()!==parseInt(c.year)||c.month&&new Date(R.created_at).getMonth()+1!==parseInt(c.month)||c.label_id&&R.label_id!==parseInt(c.label_id)||c.drafter_id&&R.drafter_id!==c.drafter_id||c.status&&R.status!==c.status)),[e,a,c]),_=R=>t.find(O=>O.user_id===R)||{name:"  "},b=R=>{switch(R){case"approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[n.jsx(Hs,{size:12}),""]});case"rejected":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[n.jsx(to,{size:12}),""]});case"chairman_approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium",children:[n.jsx(ea,{size:12})," "]});default:return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[n.jsx(_n,{size:12}),""]})}},N=R=>new Date(R).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"/").replace(".",""),S=()=>{o(""),u({year:new Date().getFullYear().toString(),month:"",label_id:"",drafter_id:"",status:""})},E=R=>{R.is_private&&!x&&R.drafter_id!==y||m(R)};return n.jsxs(At,{children:[n.jsxs("div",{className:"flex gap-3 mb-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ao,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),n.jsx("input",{type:"text",value:a,onChange:R=>o(R.target.value),placeholder:" ...",className:"w-full pl-10 pr-4 py-2.5 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>h(!d),className:`flex items-center gap-2 px-4 py-2.5 rounded-xl border transition-colors ${d?"bg-toss-blue text-white border-toss-blue":"bg-white border-toss-gray-200 text-toss-gray-700 hover:bg-toss-gray-50"}`,children:[n.jsx(iF,{size:16}),"",d?n.jsx(sl,{size:16}):n.jsx(no,{size:16})]})]}),d&&n.jsxs("div",{className:"p-4 bg-toss-gray-50 rounded-xl mb-4 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),n.jsxs("select",{value:c.year,onChange:R=>u({...c,year:R.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:""}),v.map(R=>n.jsxs("option",{value:R,children:[R,""]},R))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),n.jsxs("select",{value:c.month,onChange:R=>u({...c,month:R.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:""}),w.map(R=>n.jsxs("option",{value:R,children:[R,""]},R))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),n.jsxs("select",{value:c.label_id,onChange:R=>u({...c,label_id:R.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:""}),r.map(R=>n.jsx("option",{value:R.id,children:R.name},R.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),n.jsxs("select",{value:c.drafter_id,onChange:R=>u({...c,drafter_id:R.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:""}),t.map(R=>n.jsx("option",{value:R.user_id,children:R.name},R.user_id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-toss-gray-600 mb-1",children:""}),n.jsxs("select",{value:c.status,onChange:R=>u({...c,status:R.target.value}),className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"pending",children:""}),n.jsx("option",{value:"chairman_approved",children:" "}),n.jsx("option",{value:"approved",children:""}),n.jsx("option",{value:"rejected",children:""})]})]})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{onClick:S,className:"text-sm text-toss-gray-500 hover:text-toss-gray-700",children:" "})})]}),n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-lg font-bold text-toss-gray-900",children:" "}),n.jsxs("span",{className:"text-sm text-toss-gray-500",children:[" ",g.length,""]})]}),s?n.jsx("div",{className:"py-12 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-toss-blue border-t-transparent"})}):g.length===0?n.jsxs("div",{className:"py-12 text-center text-toss-gray-500",children:[n.jsx(Ws,{className:"mx-auto mb-3 text-toss-gray-300",size:48}),n.jsx("p",{children:"  "})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),n.jsx("tbody",{children:g.map(R=>{const L=R.is_private&&!x&&R.drafter_id!==y,O=_(R.drafter_id);return n.jsxs("tr",{onClick:()=>E(R),className:`border-b border-toss-gray-100 ${L?"bg-toss-gray-50 cursor-not-allowed":"hover:bg-toss-gray-50 cursor-pointer"}`,children:[n.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:N(R.created_at)}),n.jsx("td",{className:"py-3 px-4",children:R.document_labels&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:R.document_labels.color+"20",color:R.document_labels.color},children:R.document_labels.name})}),n.jsxs("td",{className:"py-3 px-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[R.is_private&&n.jsx(al,{size:14,className:L?"text-red-400":"text-toss-gray-400"}),n.jsx("p",{className:`font-medium truncate max-w-xs ${L?"text-toss-gray-400":"text-toss-gray-900"}`,children:L?" ":R.title})]}),!L&&R.attachments&&R.attachments.length>0&&n.jsxs("p",{className:"text-xs text-toss-gray-500 flex items-center gap-1",children:[n.jsx(Dc,{size:12})," ",R.attachments.length,""]})]}),n.jsxs("td",{className:"py-3 px-4",children:[n.jsx("span",{className:"text-sm text-toss-gray-700",children:O.name}),O.rank&&n.jsx("span",{className:"text-xs text-toss-gray-500 ml-1",children:O.rank})]}),n.jsx("td",{className:"py-3 px-4 text-center",children:b(R.status)})]},R.id)})})]})}),n.jsx("div",{className:"md:hidden space-y-3",children:g.map(R=>{const L=R.is_private&&!x&&R.drafter_id!==y,O=_(R.drafter_id);return n.jsxs("div",{onClick:()=>E(R),className:`p-4 rounded-xl ${L?"bg-toss-gray-100 cursor-not-allowed":"bg-toss-gray-50 cursor-pointer active:bg-toss-gray-100"}`,children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[R.document_labels&&n.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium",style:{backgroundColor:R.document_labels.color+"20",color:R.document_labels.color},children:R.document_labels.name}),b(R.status)]}),n.jsx("span",{className:"text-xs text-toss-gray-400",children:N(R.created_at)})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[R.is_private&&n.jsx(al,{size:14,className:L?"text-red-400":"text-toss-gray-400"}),n.jsx("p",{className:`font-medium ${L?"text-toss-gray-400":"text-toss-gray-900"}`,children:L?" ":R.title})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm text-toss-gray-600",children:[O.name,O.rank&&n.jsx("span",{className:"text-toss-gray-400 ml-1",children:O.rank})]}),!L&&R.attachments&&R.attachments.length>0&&n.jsxs("span",{className:"text-xs text-toss-gray-500 flex items-center gap-1",children:[n.jsx(Dc,{size:12}),R.attachments.length]})]})]},R.id)})})]})]})},ZB=({doc:e,onClose:t,onApprove:r,onReject:s,onEdit:a,onDelete:o,canManage:c,currentUserId:u,processing:d,showRejectModal:h,setShowRejectModal:m,rejectReason:x,setRejectReason:y,showDeleteModal:v,setShowDeleteModal:w,users:g,leaveTypes:_})=>{if(!e)return null;const b=E=>g.find(L=>L.user_id===E)||{name:"  "},N=E=>{const R=_.find(L=>L.value===E);return R?R.label:E},S=E=>{switch(E){case"approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[n.jsx(Hs,{size:12}),""]});case"rejected":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[n.jsx(to,{size:12}),""]});case"chairman_approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium",children:[n.jsx(ea,{size:12})," "]});default:return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[n.jsx(_n,{size:12}),""]})}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:t,children:n.jsx("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:E=>E.stopPropagation(),children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:" "}),n.jsx("button",{onClick:t,className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",children:n.jsx(pr,{size:20,className:"text-toss-gray-500"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[S(e.status),e.document_labels&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:e.document_labels.color+"20",color:e.document_labels.color},children:e.document_labels.name}),e.is_private&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[n.jsx(al,{size:12}),""]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.doc_number&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:e.doc_number})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"font-medium text-toss-gray-900",children:[b(e.drafter_id).name,b(e.drafter_id).rank&&n.jsx("span",{className:"text-toss-gray-500 font-normal ml-1",children:b(e.drafter_id).rank})]})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"font-bold text-toss-gray-900 text-lg",children:e.title})]}),e.content&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:e.content})]}),e.extra_work_hours>0&&n.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:n.jsxs("p",{className:"text-sm text-toss-blue font-medium",children:[": ",e.extra_work_hours," ( ",(e.extra_work_hours/8).toFixed(1),")"]})}),e.attendance_type==="leave"&&e.leave_type&&n.jsxs("div",{className:"p-3 bg-emerald-50 rounded-lg",children:[n.jsxs("p",{className:"text-sm text-emerald-700 font-medium mb-1",children:[N(e.leave_type)," "]}),n.jsxs("p",{className:"text-sm text-emerald-600",children:[e.leave_start_date===e.leave_end_date?new Date(e.leave_start_date).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}):`${new Date(e.leave_start_date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})} ~ ${new Date(e.leave_end_date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})}`,e.leave_days&&` (${e.leave_days})`]})]}),e.attachments&&e.attachments.length>0&&n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-toss-gray-500 mb-2",children:[" (",e.attachments.length,")"]}),n.jsx("div",{className:"space-y-2",children:e.attachments.map((E,R)=>n.jsxs("a",{href:E.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 bg-toss-gray-50 rounded-lg hover:bg-toss-gray-100 transition-colors",children:[n.jsx(Dc,{size:16,className:"text-toss-blue"}),n.jsx("span",{className:"text-sm text-toss-gray-700 flex-1",children:E.name}),n.jsx(wc,{size:14,className:"text-toss-gray-400"})]},R))})]}),e.status==="rejected"&&e.rejected_reason&&n.jsxs("div",{className:"p-3 bg-red-50 rounded-lg",children:[n.jsx("p",{className:"text-sm text-red-600 font-medium mb-1",children:" "}),n.jsx("p",{className:"text-red-700",children:e.rejected_reason})]}),n.jsxs("div",{className:"pt-4 border-t border-toss-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500",children:[n.jsx(ea,{size:14}),new Date(e.created_at).toLocaleString("ko-KR")," "]}),e.approved_at&&n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500 mt-1",children:[n.jsx(ea,{size:14}),new Date(e.approved_at).toLocaleString("ko-KR")," "]})]})]}),n.jsxs("div",{className:"mt-6 space-y-3",children:[e.status==="pending"&&c&&!h&&n.jsxs("div",{className:"flex gap-3",children:[n.jsxs(rt,{onClick:r,className:"flex-1 bg-emerald-500 hover:bg-emerald-600",disabled:d,children:[d?n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-1"}):n.jsx(Hs,{size:16,className:"mr-1"}),""]}),n.jsxs(rt,{onClick:()=>m(!0),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",disabled:d,children:[n.jsx(to,{size:16,className:"mr-1"}),""]})]}),h&&n.jsxs("div",{className:"p-4 bg-red-50 rounded-lg space-y-3",children:[n.jsx("p",{className:"text-sm font-medium text-red-700",children:"  "}),n.jsx("textarea",{value:x,onChange:E=>y(E.target.value),placeholder:"  ",rows:2,className:"w-full px-3 py-2 bg-white border border-red-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(rt,{onClick:s,className:"flex-1 bg-red-500 hover:bg-red-600",disabled:d||!x.trim(),children:d?" ...":" "}),n.jsx(rt,{onClick:()=>{m(!1),y("")},variant:"secondary",className:"flex-1",disabled:d,children:""})]})]}),e.status==="pending"&&e.drafter_id===u&&!h&&!v&&n.jsxs("div",{className:"flex gap-3",children:[n.jsxs(rt,{onClick:()=>a(e),variant:"secondary",className:"flex-1",children:[n.jsx(Oc,{size:16,className:"mr-1"}),""]}),n.jsxs(rt,{onClick:()=>w(!0),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",children:[n.jsx(cr,{size:16,className:"mr-1"}),""]})]}),e.status!=="pending"&&c&&!h&&!v&&n.jsxs(rt,{onClick:()=>w(!0),variant:"secondary",className:"w-full text-red-500 border-red-200 hover:bg-red-50",children:[n.jsx(cr,{size:16,className:"mr-1"}),""]}),v&&n.jsxs("div",{className:"p-4 bg-red-50 rounded-lg space-y-3",children:[n.jsx("p",{className:"text-sm font-medium text-red-700",children:e.status==="pending"?"  ?":`  ?
    .`}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(rt,{onClick:o,className:"flex-1 bg-red-500 hover:bg-red-600",disabled:d,children:d?" ...":""}),n.jsx(rt,{onClick:()=>w(!1),variant:"secondary",className:"flex-1",disabled:d,children:""})]})]}),!h&&!v&&n.jsx(rt,{onClick:t,variant:"secondary",className:"w-full",children:""})]})]})})})},QB=({users:e,allLeaves:t,onSaveTotalDays:r})=>{const[s,a]=Y.useState(""),[o,c]=Y.useState(null),[u,d]=Y.useState(""),[h,m]=Y.useState(null),x=g=>t.find(_=>_.user_id===g),y=Y.useMemo(()=>s?e.filter(g=>g.name?.toLowerCase().includes(s.toLowerCase())||g.team?.toLowerCase().includes(s.toLowerCase())):e,[e,s]),v=(g,_)=>{c(g),d(_.toString())},w=async g=>{const _=parseFloat(u);if(isNaN(_)||_<0){alert("   ");return}m(g);try{await r(g,_),c(null)}catch{alert("   ")}finally{m(null)}};return n.jsxs(At,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 flex items-center gap-2",children:[n.jsx(Sd,{className:"text-toss-blue",size:20}),"  "]}),n.jsxs("div",{className:"relative",children:[n.jsx(ao,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400",size:16}),n.jsx("input",{type:"text",value:s,onChange:g=>a(g.target.value),placeholder:"   ",className:"pl-9 pr-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-toss-blue focus:border-transparent"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:" "}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),n.jsx("tbody",{children:y.map(g=>{const _=x(g.user_id),b=_?.total_days||15,N=_?.used_days||0,S=b-N,E=o===g.user_id,R=h===g.user_id;return n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50",children:[n.jsxs("td",{className:"py-3 px-4",children:[n.jsx("p",{className:"font-medium text-toss-gray-900",children:g.name}),g.rank&&n.jsx("p",{className:"text-xs text-toss-gray-500",children:g.rank})]}),n.jsx("td",{className:"py-3 px-4 text-toss-gray-600",children:g.team||"-"}),n.jsx("td",{className:"py-3 px-4 text-center",children:E?n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("input",{type:"number",value:u,onChange:L=>d(L.target.value),step:"0.5",min:"0",className:"w-16 px-2 py-1 text-center bg-white border border-toss-gray-300 rounded-lg text-sm",autoFocus:!0}),n.jsx("button",{onClick:()=>w(g.user_id),disabled:R,className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded",children:R?n.jsx("div",{className:"w-4 h-4 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin"}):n.jsx(dy,{size:16})}),n.jsx("button",{onClick:()=>c(null),disabled:R,className:"p-1 text-toss-gray-500 hover:bg-toss-gray-100 rounded",children:n.jsx(pr,{size:16})})]}):n.jsxs("button",{onClick:()=>v(g.user_id,b),className:"inline-flex items-center gap-1 text-toss-gray-900 hover:text-toss-blue transition-colors group",children:[b,"",n.jsx(Oc,{size:14,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})}),n.jsxs("td",{className:"py-3 px-4 text-center text-toss-blue font-medium",children:[N,""]}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("span",{className:`font-bold ${S<=3?"text-red-500":"text-emerald-600"}`,children:[S,""]})})]},g.user_id)})})]})}),y.length===0&&n.jsx("div",{className:"py-12 text-center text-toss-gray-500",children:"  "})]})},eU=()=>{const{user:e,isAdmin:t,isSubAdmin:r}=Yr(),s=t||r,{allDocuments:a,labels:o,users:c,loading:u,createDocument:d,updateDocument:h,deleteDocument:m,approveDocument:x,rejectDocument:y,refresh:v}=gT(),{annualLeave:w,compLeave:g}=mv(),[_,b]=Y.useState(!1),[N,S]=Y.useState(!1),[E,R]=Y.useState([]),[L,O]=Y.useState(null),[P,F]=Y.useState(null),[V,oe]=Y.useState({label_id:"",title:"",content:"",extra_work_hours:0,execution_date:"",payment_method:"",attendance_type:"",leave_type:"",leave_start_date:"",leave_end_date:"",is_private:!1}),[D,K]=Y.useState([{item:"",category:"",vendor:"",amount:"",note:""}]),[M,ae]=Y.useState(""),[te,Z]=Y.useState(!1),[we,ee]=Y.useState({year:new Date().getFullYear().toString(),month:"",label_id:"",drafter_id:"",status:""}),[Ne,q]=Y.useState("list"),[I,X]=Y.useState([]),[H,Q]=Y.useState(!1),[ie,B]=Y.useState(!1),[z,ue]=Y.useState(""),[se,re]=Y.useState(!1),W=o.find(De=>De.code===4),ce=g&&g.total_hours-g.used_hours>=8,k=g?Math.floor((g.total_hours-g.used_hours)/8):0,de=w?w.total_days-w.used_days:0,U=[{value:"full",label:"",description:"1 ",days:1},{value:"half_am",label:" ",description:"0.5 ",days:.5},{value:"half_pm",label:" ",description:"0.5 ",days:.5},{value:"out_1h",label:"/ 1",description:"0.125 ",days:.125},{value:"out_2h",label:"/ 2",description:"0.25 ",days:.25},{value:"out_3h",label:"/ 3",description:"0.375 ",days:.375},{value:"comp",label:"",description:ce?`${k} `:" ",days:1,disabled:!ce}],T=Y.useCallback(async()=>{if(s)try{const De=new Date().getFullYear(),Ce=`${De}-01-01`,st=`${De}-12-31`,{data:We,error:Ze}=await Ue.from("annual_leaves").select("*").eq("year",De);if(Ze)throw Ze;const{data:Re}=await Ue.from("document_labels").select("id").eq("code",nd).single();let pt=[];if(Re){const{data:jt}=await Ue.from("documents").select("drafter_id, leave_days, leave_type").eq("label_id",Re.id).eq("attendance_type","leave").eq("status","approved").gte("leave_start_date",Ce).lte("leave_start_date",st).not("leave_type","is",null).neq("leave_type","comp");pt=jt||[]}const Tt={};pt.forEach(jt=>{Tt[jt.drafter_id]=(Tt[jt.drafter_id]||0)+(jt.leave_days||0)});const wt=(We||[]).map(jt=>({...jt,used_days:Tt[jt.user_id]||0}));X(wt)}catch(De){console.error("   :",De)}},[s]);Y.useEffect(()=>{Ne==="leaveSettings"&&s&&T()},[Ne,s,T]);const A=async(De,Ce)=>{const st=new Date().getFullYear(),We=I.find(Ze=>Ze.user_id===De);We?await Ue.from("annual_leaves").update({total_days:Ce,updated_at:new Date().toISOString()}).eq("id",We.id):await Ue.from("annual_leaves").insert({user_id:De,year:st,total_days:Ce,used_days:0}),await T()},G=async()=>{if(!(!L||!s)){Q(!0);try{const{error:De}=await x(L.id);De?alert(" : "+De):(alert("."),O(null),v())}catch(De){console.error(" :",De),alert("   ")}finally{Q(!1)}}},xe=async()=>{if(!L||!s||!z.trim()){alert("  ");return}Q(!0);try{const{error:De}=await y(L.id,z);De?alert(" : "+De):(alert("."),O(null),B(!1),ue(""),v())}catch(De){console.error(" :",De),alert("   ")}finally{Q(!1)}},be=async()=>{if(L){Q(!0);try{const{error:De}=await m(L.id,!0);De?alert(" ."):(O(null),re(!1))}catch(De){console.error(" :",De),alert("   ")}finally{Q(!1)}}},ne=async De=>{if(De.preventDefault(),!W){alert("    .");return}if(!V.title.trim()){alert(" .");return}if(!V.attendance_type){alert("  .");return}if(V.attendance_type==="leave"){if(!V.leave_type){alert("  .");return}if(!V.leave_start_date){alert(" .");return}}S(!0);let Ce=0;if(V.attendance_type==="leave"){const Ze=U.find(Re=>Re.value===V.leave_type);if(V.leave_type==="full"||V.leave_type==="comp"){const Re=new Date(V.leave_start_date),pt=new Date(V.leave_end_date||V.leave_start_date);Ce=Math.ceil((pt-Re)/(1e3*60*60*24))+1}else Ce=Ze?.days||.5}const st={label_id:W.id,title:V.title.trim(),content:V.content.trim(),extra_work_hours:V.attendance_type==="overtime"&&parseFloat(V.extra_work_hours)||0,attachments:E.length>0?E:null,execution_date:null,payment_method:null,expense_items:null,attendance_type:V.attendance_type,leave_type:V.attendance_type==="leave"?V.leave_type:null,leave_start_date:V.attendance_type==="leave"?V.leave_start_date:null,leave_end_date:V.attendance_type==="leave"?V.leave_end_date||V.leave_start_date:null,leave_days:V.attendance_type==="leave"?Ce:null,is_private:V.is_private};let We;if(P?We=(await h(P.id,st)).error:We=(await d(st)).error,S(!1),We){console.error("Document error:",We);const Ze=typeof We=="string"?We:We.message||JSON.stringify(We);alert((P?" : ":"  : ")+Ze)}else Me()},je=De=>{F(De),oe({label_id:De.label_id||"",title:De.title||"",content:De.content||"",extra_work_hours:De.extra_work_hours||0,execution_date:De.execution_date||"",payment_method:De.payment_method||"",attendance_type:De.attendance_type||"",leave_type:De.leave_type||"",leave_start_date:De.leave_start_date||"",leave_end_date:De.leave_end_date||"",is_private:De.is_private||!1}),R(De.attachments||[]),K(De.expense_items?.length>0?De.expense_items:[{item:"",category:"",vendor:"",amount:"",note:""}]),b(!0),O(null)},Me=()=>{b(!1),F(null),oe({label_id:"",title:"",content:"",extra_work_hours:0,execution_date:"",payment_method:"",attendance_type:"",leave_type:"",leave_start_date:"",leave_end_date:"",is_private:!1}),R([]),K([{item:"",category:"",vendor:"",amount:"",note:""}])};return n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[n.jsxs(Gs,{to:"/",className:"inline-flex items-center gap-2 text-toss-gray-500 hover:text-toss-gray-700 transition-colors",children:[n.jsx(Wd,{size:20})," "]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-700 rounded-2xl flex items-center justify-center",children:n.jsx(Ws,{className:"text-white",size:28})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),n.jsx("p",{className:"text-toss-gray-500",children:" "})]})]}),Ne==="list"&&n.jsxs(rt,{onClick:()=>b(!_),children:[n.jsx(Ns,{size:18,className:"mr-1"}),""]})]}),s&&n.jsxs("div",{className:"flex gap-2 border-b border-toss-gray-200",children:[n.jsx("button",{onClick:()=>q("list"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${Ne==="list"?"border-toss-blue text-toss-blue":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "}),n.jsxs("button",{onClick:()=>q("leaveSettings"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${Ne==="leaveSettings"?"border-toss-blue text-toss-blue":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:[n.jsx(hl,{size:16,className:"inline mr-1"})," "]})]}),Ne==="list"&&n.jsxs(n.Fragment,{children:[_&&n.jsx(YB,{formData:V,setFormData:oe,editingDoc:P,onSubmit:ne,onClose:Me,submitting:N,attachments:E,setAttachments:R,expenseItems:D,setExpenseItems:K,isAttendanceLabel:!0,isExpenseLabel:!1,leaveTypes:U,remainingAnnualDays:de,compLeaveDays:k}),n.jsx(JB,{documents:a,users:c,labels:o,loading:u,searchTerm:M,setSearchTerm:ae,searchFilters:we,setSearchFilters:ee,showAdvancedSearch:te,setShowAdvancedSearch:Z,onDocClick:O,canManage:s,currentUserId:e?.user_id})]}),Ne==="leaveSettings"&&s&&n.jsx(QB,{users:c,allLeaves:I,onSaveTotalDays:A}),n.jsx(ZB,{doc:L,onClose:()=>O(null),onApprove:G,onReject:xe,onEdit:je,onDelete:be,canManage:s,currentUserId:e?.user_id,processing:H,showRejectModal:ie,setShowRejectModal:B,rejectReason:z,setRejectReason:ue,showDeleteModal:se,setShowDeleteModal:re,users:c,leaveTypes:U})]})},tU={full:"",half_am:" ",half_pm:" ",out_1h:"/ 1",out_2h:"/ 2",out_3h:"/ 3"},iE=(e,t,r="",s=1)=>{const a=new Date(e.start_date),o=new Date(e.end_date),c=new Date(e.created_at),u=g=>`${g.getFullYear()} ${g.getMonth()+1} ${g.getDate()}`,d=g=>{const _=g.getFullYear(),b=String(g.getMonth()+1).padStart(2,"0"),N=String(g.getDate()).padStart(2,"0");return`${_}/${b}/${N}`},h=g=>{const _=String(g.getMonth()+1).padStart(2,"0"),b=String(g.getDate()).padStart(2,"0");return`${_}${b}`},x=`${d(c)} -${s} `,y=tU[e.leave_type]||"",v=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title> - ${t.name}</title>
    <style>
        @page {
            size: A4;
            margin: 20mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', sans-serif;
            font-size: 14px;
            line-height: 1.5;
            color: #000;
            background: #fff;
        }
        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 15mm 20mm;
            margin: 0 auto;
            background: #fff;
        }

        /*   */
        .header {
            position: relative;
            margin-bottom: 15px;
            padding-top: 10px;
        }
        .title {
            text-align: center;
            font-size: 22px;
            font-weight: bold;
            text-decoration: underline;
            padding-bottom: 15px;
        }

        /*  -   */
        .approval-box {
            position: absolute;
            top: 0;
            right: 0;
        }
        .approval-table {
            border-collapse: collapse;
            font-size: 11px;
        }
        .approval-table td {
            border: 1px solid #000;
            text-align: center;
            padding: 4px 12px;
            height: 22px;
        }
        .approval-table .label-cell {
            width: 30px;
            padding: 4px 6px;
        }
        .approval-table .name-cell {
            width: 55px;
        }

        /*  */
        .doc-number {
            font-size: 12px;
            margin-bottom: 10px;
        }

        /*   */
        .main-box {
            border: 1px solid #000;
            padding: 20px 25px;
            min-height: 200mm;
            position: relative;
        }

        /* // */
        .info-line {
            font-size: 14px;
            margin-bottom: 12px;
        }

        /*  */
        .statement {
            font-size: 14px;
            margin: 25px 0;
        }

        /*   */
        .inner-box {
            border: 1px solid #000;
            width: 65%;
            margin: 30px auto;
            padding: 15px 20px;
        }
        .inner-line {
            font-size: 13px;
            margin-bottom: 10px;
        }
        .date-line {
            font-size: 13px;
            margin-bottom: 5px;
        }
        .date-line span {
            margin-left: 20px;
        }
        .date-sub {
            font-size: 13px;
            margin-left: 65px;
            margin-bottom: 5px;
        }
        .total-days {
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            margin-top: 20px;
        }

        /*  / */
        .footer-area {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            text-align: center;
        }
        .footer-date {
            font-size: 14px;
            margin-bottom: 15px;
        }
        .org-name {
            font-size: 20px;
            font-weight: bold;
            color: #1a4ed8;
        }

        /*   */
        .page-num {
            position: absolute;
            bottom: 10px;
            left: 20px;
            font-size: 12px;
        }

        @media print {
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .page { margin: 0; padding: 15mm 20mm; }
        }
    </style>
</head>
<body>
    <div class="page">
        <div class="header">
            <div class="title">(${h(c)})</div>

            <div class="approval-box">
                <table class="approval-table">
                    <tr>
                        <td rowspan="3" class="label-cell"><br></td>
                        <td class="name-cell"></td>
                        <td class="name-cell"></td>
                    </tr>
                    <tr>
                        <td class="name-cell">${t.name||""}</td>
                        <td class="name-cell">${r}</td>
                    </tr>
                    <tr>
                        <td class="name-cell">${d(c)}</td>
                        <td class="name-cell">${d(c)}</td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="doc-number"> : ${x}</div>

        <div class="main-box">
            <div class="info-line"> : ${t.team||"-"}</div>
            <div class="info-line"> : ${t.rank||"-"}</div>
            <div class="info-line"> : ${t.name||"-"}</div>

            <div class="statement">
                     (${y}) .
            </div>

            <div class="inner-box">
                <div class="inner-line"> : ${e.reason||""}</div>
                <div class="inner-line"> :</div>
                <div class="date-line"> :<span>1. ${u(a)}</span></div>
                <div class="date-sub">${u(o)}</div>
                <div class="total-days">( ${e.days})</div>
            </div>

            <div class="footer-area">
                <div class="footer-date">${u(c)}</div>
                <div class="org-name"> </div>
            </div>
        </div>

        <div class="page-num">7</div>
    </div>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,w=window.open("","_blank","width=900,height=700");w.document.write(v),w.document.close()},O1=(e,t,r="",s="")=>{const a=new Date(e.created_at),o=e.approved_at?new Date(e.approved_at):a,c=w=>`${w.getFullYear()} ${String(w.getMonth()+1).padStart(2,"0")} ${String(w.getDate()).padStart(2,"0")}`,u=w=>{const g=w.getFullYear(),_=String(w.getMonth()+1).padStart(2,"0"),b=String(w.getDate()).padStart(2,"0");return`${g}/${_}/${b}`},d=()=>{const w=e.expense_items||[];return w.length===0?`
                <tr>
                    <td colspan="5" style="padding: 20px; text-align: center; color: #666;"> </td>
                </tr>
            `:w.map(g=>`
            <tr>
                <td style="padding: 10px 8px; text-align: center; border: 1px solid #000; vertical-align: middle;">${g.item||""}</td>
                <td style="padding: 10px 8px; text-align: center; border: 1px solid #000; vertical-align: middle;">${g.category||""}</td>
                <td style="padding: 10px 8px; text-align: center; border: 1px solid #000; vertical-align: middle;">${g.vendor||""}</td>
                <td style="padding: 10px 8px; text-align: right; border: 1px solid #000; vertical-align: middle;">${g.amount?Number(g.amount).toLocaleString():""}</td>
                <td style="padding: 10px 8px; text-align: center; border: 1px solid #000; vertical-align: middle;">${g.note||""}</td>
            </tr>
        `).join("")},h=(e.expense_items||[]).reduce((w,g)=>w+(Number(g.amount)||0),0),m=w=>{const g=["","","",""],_=["","","",""],b=["","","","","","","","","",""];if(w===0)return"";let N="",S=0;for(;w>0;){const E=w%1e4;if(E>0){let R="",L=E,O=0;for(;L>0;){const P=L%10;P>0&&(O===0?R=b[P]+R:R=(P===1?"":b[P])+_[O]+R),L=Math.floor(L/10),O++}N=R+g[S]+N}w=Math.floor(w/1e4),S++}return" "+N+""},x=h>=1e6,y=`
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title> - ${e.title}</title>
    <style>
        @page {
            size: A4;
            margin: 15mm;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Malgun Gothic', ' ', sans-serif;
            font-size: 13px;
            line-height: 1.4;
            color: #000;
            background: #fff;
        }
        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 10mm 15mm;
            margin: 0 auto;
            background: #fff;
        }

        /*   */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        /*  */
        .main-title {
            font-size: 22px;
            font-weight: bold;
            text-decoration: underline;
            padding-top: 10px;
        }

        /*  */
        .approval-box {
            border-collapse: collapse;
        }
        .approval-box td {
            border: 1px solid #000;
            text-align: center;
            font-size: 11px;
        }
        .approval-box .header-row td {
            padding: 4px 8px;
            background: #fff;
        }
        .approval-box .label-cell {
            width: 30px;
            writing-mode: vertical-lr;
            text-orientation: upright;
            letter-spacing: 2px;
            padding: 8px 4px;
            font-weight: normal;
        }
        .approval-box .position-cell {
            width: 55px;
            padding: 3px 5px;
        }
        .approval-box .name-cell {
            width: 55px;
            padding: 3px 5px;
        }
        .approval-box .date-cell {
            width: 55px;
            padding: 3px 5px;
            font-size: 10px;
        }

        /*  */
        .doc-number {
            font-size: 11px;
            margin-bottom: 8px;
        }

        /*   */
        .main-box {
            border: 1px solid #000;
        }

        /*    */
        .info-table {
            width: 100%;
            border-collapse: collapse;
        }
        .info-table td {
            border: 1px solid #000;
            padding: 6px 12px;
            font-size: 13px;
        }
        .info-table .label {
            width: 80px;
            text-align: center;
            font-weight: normal;
        }

        /*   */
        .content-area {
            padding: 20px;
            min-height: 50mm;
            border-top: 1px solid #000;
        }
        .content-statement {
            text-align: center;
            font-size: 14px;
            margin-bottom: 25px;
            line-height: 1.8;
        }
        .content-list {
            font-size: 13px;
        }
        .content-list p {
            margin-bottom: 6px;
        }

        /*  */
        .expense-section {
            margin-top: 15px;
        }
        .expense-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }
        .expense-table th {
            background: #f0f0f0;
            border: 1px solid #000;
            padding: 10px 8px;
            font-weight: bold;
            text-align: center;
        }
        .expense-table td {
            border: 1px solid #000;
            padding: 10px 8px;
        }
        .expense-table .total-row td {
            font-weight: bold;
            background: #fff;
        }

        /*  */
        .attachment {
            margin-top: 20px;
            font-size: 12px;
        }

        @media print {
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .page { margin: 0; padding: 10mm 15mm; }
        }
    </style>
</head>
<body>
    <div class="page">
        <div class="header">
            <div class="main-title">(${e.title})</div>
            <table class="approval-box">
                <tr class="header-row">
                    <td rowspan="3" class="label-cell"><br></td>
                    <td class="position-cell"></td>
                    <td class="position-cell"></td>
                    ${x?'<td class="position-cell"></td>':""}
                </tr>
                <tr>
                    <td class="name-cell">${t.name||""}</td>
                    <td class="name-cell">${r}</td>
                    ${x?`<td class="name-cell">${s}</td>`:""}
                </tr>
                <tr>
                    <td class="date-cell">${u(a)}</td>
                    <td class="date-cell">${u(o)}</td>
                    ${x?`<td class="date-cell">${e.approved_at?u(o):""}</td>`:""}
                </tr>
            </table>
        </div>

        <div class="doc-number"> : ${e.doc_number||""}</div>

        <div class="main-box">
            <table class="info-table">
                <tr>
                    <td class="label">  </td>
                    <td>${c(a).replace(" ","-").replace(" ","-").replace("","")}</td>
                </tr>
                <tr>
                    <td class="label">  </td>
                    <td>${t.name||""}</td>
                </tr>
                <tr>
                    <td class="label"></td>
                    <td>${t.team||""}</td>
                </tr>
                <tr>
                    <td class="label"> </td>
                    <td>${t.rank||""}</td>
                </tr>
                <tr>
                    <td class="label"> </td>
                    <td>${e.document_labels?.name||""} (${e.title})</td>
                </tr>
            </table>

            <div class="content-area">
                <p class="content-statement">      .</p>

                <p style="text-align: center; margin: 20px 0;">-</p>

                <div class="content-list">
                    ${e.execution_date?`<p>1. : ${e.execution_date}</p>`:""}
                    ${h>0?`<p>${e.execution_date?"2":"1"}. : ${h.toLocaleString()}  (${m(h)})</p>`:""}
                    ${e.payment_method?`<p>${e.execution_date?"3":"2"}. : ${e.payment_method}</p>`:""}
                    ${(e.expense_items||[]).length>0?`<p>${e.execution_date?"4":"3"}. </p>`:""}
                </div>

                ${(e.expense_items||[]).length>0?`
                <div class="expense-section">
                    <table class="expense-table">
                        <thead>
                            <tr>
                                <th style="width: 25%;"> </th>
                                <th style="width: 15%;"></th>
                                <th style="width: 15%;"></th>
                                <th style="width: 18%;"></th>
                                <th style="width: 12%;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            ${d()}
                            <tr class="total-row">
                                <td colspan="3" style="text-align: center; border: 1px solid #000;"> </td>
                                <td style="text-align: right; border: 1px solid #000;">${h.toLocaleString()}</td>
                                <td style="border: 1px solid #000;"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                `:`
                <div style="margin-top: 20px;">
                    <p style="white-space: pre-wrap;">${e.content||""}</p>
                </div>
                `}

                ${(e.expense_items||[]).length>0?`
                <div class="attachment">
                    <p>. 1.  ${(e.expense_items||[]).length} .</p>
                </div>
                `:""}
            </div>
        </div>
    </div>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 300);
        }
    <\/script>
</body>
</html>
`,v=window.open("","_blank","width=900,height=700");v.document.write(y),v.document.close()},Uo={full:{label:"",days:1},half_am:{label:" ",days:.5},half_pm:{label:" ",days:.5},out_1h:{label:"/ 1",days:.125},out_2h:{label:"/ 2",days:.25},out_3h:{label:"/ 3",days:.375},comp:{label:"",days:1}},rU=()=>{const{isAdmin:e,isSubAdmin:t,user:r}=Yr(),s=r?.user_id==="admin"||(e||t)&&r?.user_id!=="admin2",a=r?.user_id==="admin2",{pendingRequests:o,loading:c,approveLeaveRequest:u,rejectLeaveRequest:d,refresh:h}=mv(),{pendingDocuments:m,labels:x,loading:y,approveDocument:v,rejectDocument:w,deleteDocument:g,addLabel:_,updateLabel:b,deleteLabel:N}=gT(),[S,E]=Y.useState([]),[R,L]=Y.useState("document"),[O,P]=Y.useState("pending"),[F,V]=Y.useState([]),[oe,D]=Y.useState(""),[K,M]=Y.useState(null),[ae,te]=Y.useState(""),[Z,we]=Y.useState(null),[ee,Ne]=Y.useState(null),[q,I]=Y.useState(""),[X,H]=Y.useState("#3B82F6"),[Q,ie]=Y.useState(null),[B,z]=Y.useState(""),[ue,se]=Y.useState(""),[re,W]=Y.useState("pending"),[ce,k]=Y.useState([]),[de,U]=Y.useState([]),[T,A]=Y.useState([]),[G,xe]=Y.useState(""),[be,ne]=Y.useState(""),[je,Me]=Y.useState(null),[De,Ce]=Y.useState(""),[st,We]=Y.useState(null),[Ze,Re]=Y.useState(null),[pt,Tt]=Y.useState(null),[wt,jt]=Y.useState(""),[Pt,Le]=Y.useState(null),[nt,dt]=Y.useState(!1),[Ae,Je]=Y.useState([]),[Ee,Pe]=Y.useState(0);if(!e&&!t)return n.jsx(Go,{to:"/",replace:!0});Y.useEffect(()=>{(async()=>{const{data:Ie}=await Ue.from("users").select("user_id, name, team, rank").order("name");Ie&&E(Ie);const{data:_t}=await Ue.from("documents").select("*, document_labels(*)").order("created_at",{ascending:!1});_t&&V(_t);const{data:bt}=await Ue.from("annual_leaves").select("*").eq("year",new Date().getFullYear());bt&&k(bt);const{data:qt}=await Ue.from("leave_requests").select("*").in("status",["approved","rejected"]).order("updated_at",{ascending:!1});qt&&U(qt);const{data:Br}=await Ue.from("documents").select("*, document_labels(*)").eq("document_labels.code",4).in("status",["approved","rejected"]).order("updated_at",{ascending:!1});Br&&A(Br.filter(cs=>cs.document_labels?.code===4))})()},[m,o]);const he=me=>S.find(Ie=>Ie.user_id===me)||{name:me,team:"",rank:""},le=me=>ce.find(Ie=>Ie.user_id===me),ve=async(me,Ie="chairman")=>{we(me);const{error:_t}=await v(me,Ie);we(null),_t&&alert(" .")},Oe=me=>(me.expense_items||[]).reduce((Ie,_t)=>Ie+(Number(_t.amount)||0),0),qe=async me=>{if(!ae.trim()){alert("  .");return}we(me);const{error:Ie}=await w(me,ae);we(null),M(null),te(""),Ie&&alert(" .")},ct=async me=>{if(!confirm(" ?"))return;we(me);const{error:Ie}=await g(me);if(we(null),Ie){console.error("Delete document error:",Ie);const _t=typeof Ie=="string"?Ie:Ie.message||JSON.stringify(Ie);alert(" : "+_t)}else V(_t=>_t.filter(bt=>bt.id!==me))},Et=async()=>{if(!q.trim()){alert("  .");return}const{error:me}=await _(q.trim(),X);me?alert("  ."):(I(""),H("#3B82F6"))},Xt=async me=>{if(!B.trim()){alert("  .");return}const{error:Ie}=await b(me,B.trim(),ue);Ie?alert("  ."):ie(null)},er=async me=>{if(!confirm(" ?"))return;const{error:Ie}=await N(me);Ie&&alert("  .")},Lt=async me=>{We(me);const{error:Ie}=await u(me);We(null),Ie&&alert(" .")},Yt=async me=>{if(!De.trim()){alert("  .");return}We(me);const{error:Ie}=await d(me,De);We(null),Me(null),Ce(""),Ie&&alert(" .")},Rr=async me=>{if(!confirm(`${he(me.user_id).name}   ?${me.status==="approved"?`
(  )`:""}`))return;if(We(me.id),me.status==="approved"){const{data:_t}=await Ue.from("annual_leaves").select("*").eq("user_id",me.user_id).eq("year",new Date().getFullYear()).single();_t&&await Ue.from("annual_leaves").update({used_days:Math.max(0,_t.used_days-me.days),updated_at:new Date().toISOString()}).eq("id",_t.id)}const{error:Ie}=await Ue.from("leave_requests").delete().eq("id",me.id);if(We(null),Ie){console.error("Delete leave request error:",Ie);const _t=typeof Ie=="string"?Ie:Ie.message||JSON.stringify(Ie);alert(" : "+_t)}else U(_t=>_t.filter(bt=>bt.id!==me.id)),h()},Dr=(me,Ie)=>{Tt(me),jt(Ie.toString())},fe=async me=>{const Ie=parseFloat(wt);if(isNaN(Ie)||Ie<0){alert("   .");return}Le(me);const _t=ce.find(bt=>bt.user_id===me);if(_t){const{error:bt}=await Ue.from("annual_leaves").update({total_days:Ie,updated_at:new Date().toISOString()}).eq("id",_t.id);if(bt){alert(" ."),Le(null);return}}else{const{error:bt}=await Ue.from("annual_leaves").insert({user_id:me,year:new Date().getFullYear(),total_days:Ie,used_days:0});if(bt){alert(" ."),Le(null);return}}k(_t?bt=>bt.map(qt=>qt.user_id===me?{...qt,total_days:Ie}:qt):bt=>[...bt,{user_id:me,year:new Date().getFullYear(),total_days:Ie,used_days:0}]),Le(null),Tt(null)},_e=me=>new Date(me).toLocaleDateString("ko-KR",{month:"short",day:"numeric",weekday:"short"}),ge=me=>new Date(me).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"/").replace(".",""),ye=me=>{switch(me){case"approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[n.jsx(Hs,{size:12}),""]});case"chairman_approved":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium",children:[n.jsx(Hs,{size:12}),""]});case"rejected":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[n.jsx(to,{size:12}),""]});default:return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[n.jsx(_n,{size:12}),""]})}},Se=me=>me==="approved"?n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-emerald-50 text-emerald-700 rounded-full text-xs font-medium",children:[n.jsx(Hs,{size:12}),""]}):me==="rejected"?n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-red-50 text-red-700 rounded-full text-xs font-medium",children:[n.jsx(to,{size:12}),""]}):n.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-amber-50 text-amber-700 rounded-full text-xs font-medium",children:[n.jsx(_n,{size:12}),""]}),ke=F.filter(me=>me.document_labels?.code===4?!1:he(me.drafter_id).name?.toLowerCase().includes(oe.toLowerCase())||me.title?.toLowerCase().includes(oe.toLowerCase())),$e=S.filter(me=>me.name?.toLowerCase().includes(G.toLowerCase())||me.team?.toLowerCase().includes(G.toLowerCase())),at=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899","#06B6D4","#6B7280"],He=m.filter(me=>me.document_labels?.code===4),Ge=m.filter(me=>me.document_labels?.code!==4),Ve=Ge.length+o.length+He.length,ht=me=>{const Ie=me.split(".").pop().toLowerCase();return["jpg","jpeg","png","gif","webp","bmp"].includes(Ie)},vt=(me,Ie=0)=>{const _t=me.filter(bt=>ht(bt.name));_t.length>0&&(Je(_t),Pe(Ie),dt(!0))},Nt=async me=>{try{const _t=await(await fetch(me.url)).blob(),bt=window.URL.createObjectURL(_t),qt=document.createElement("a");qt.href=bt,qt.download=me.name,document.body.appendChild(qt),qt.click(),window.URL.revokeObjectURL(bt),document.body.removeChild(qt)}catch(Ie){console.error("Download failed:",Ie),window.open(me.url,"_blank")}},gt=async me=>{for(const Ie of me)await Nt(Ie),await new Promise(_t=>setTimeout(_t,500))};return n.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[n.jsxs(Gs,{to:"/",className:"inline-flex items-center gap-2 text-toss-gray-500 hover:text-toss-gray-700 transition-colors",children:[n.jsx(Wd,{size:20})," "]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl flex items-center justify-center",children:n.jsx(hl,{className:"text-white",size:28})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:""}),n.jsxs("p",{className:"text-toss-gray-500",children:["  ",Ve>0&&n.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:[Ve," "]})]})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>L("document"),className:`flex-1 py-4 rounded-xl font-medium transition-all ${R==="document"?"bg-indigo-500 text-white":"bg-toss-gray-100 text-toss-gray-600 hover:bg-toss-gray-200"}`,children:[n.jsx(Ws,{size:20,className:"inline mr-2"})," ",Ge.length>0&&n.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${R==="document"?"bg-white/20":"bg-red-500 text-white"}`,children:Ge.length})]}),n.jsxs("button",{onClick:()=>L("leave"),className:`flex-1 py-4 rounded-xl font-medium transition-all ${R==="leave"?"bg-purple-500 text-white":"bg-toss-gray-100 text-toss-gray-600 hover:bg-toss-gray-200"}`,children:[n.jsx(ha,{size:20,className:"inline mr-2"})," ",o.length+He.length>0&&n.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${R==="leave"?"bg-white/20":"bg-red-500 text-white"}`,children:o.length+He.length})]})]}),R==="document"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex gap-2 border-b border-toss-gray-200",children:[n.jsxs("button",{onClick:()=>P("pending"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${O==="pending"?"border-indigo-500 text-indigo-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:[" ",Ge.length>0&&n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:Ge.length})]}),n.jsx("button",{onClick:()=>P("all"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${O==="all"?"border-indigo-500 text-indigo-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "}),n.jsx("button",{onClick:()=>P("labels"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${O==="labels"?"border-indigo-500 text-indigo-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "})]}),O==="pending"&&n.jsxs(At,{children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 mb-4 flex items-center gap-2",children:[n.jsx(_n,{className:"text-amber-500",size:20}),"  "]}),y?n.jsx("div",{className:"py-12 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-indigo-500 border-t-transparent"})}):Ge.length===0?n.jsxs("div",{className:"py-12 text-center text-toss-gray-500",children:[n.jsx(Hs,{className:"mx-auto mb-3 text-emerald-400",size:48}),n.jsx("p",{children:"  "})]}):n.jsx("div",{className:"space-y-4",children:Ge.map(me=>{const Ie=he(me.drafter_id),_t=K===me.id,bt=Z===me.id,qt=Oe(me),Br=qt>=1e6,cs=me.status==="chairman_approved";return n.jsxs("div",{className:"p-5 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{onClick:()=>Ne({...me,userInfo:Ie}),className:"cursor-pointer hover:bg-toss-gray-100 -mx-5 -mt-5 px-5 pt-5 pb-3 rounded-t-xl transition-colors",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[me.document_labels&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:me.document_labels.color+"20",color:me.document_labels.color},children:me.document_labels.name}),cs&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:""}),n.jsx("span",{className:"text-sm text-toss-gray-500",children:me.doc_number})]}),n.jsx("p",{className:"font-bold text-toss-gray-900",children:me.title})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-base font-semibold text-toss-gray-900",children:[Ie.name," ",n.jsx("span",{className:"font-normal text-toss-gray-600",children:Ie.rank})]}),n.jsx("p",{className:"text-sm text-toss-gray-500",children:Ie.team})]})]}),me.content&&n.jsx("p",{className:"text-sm text-toss-gray-600 mb-3 line-clamp-2",children:me.content}),qt>0&&n.jsxs("p",{className:`text-sm font-medium mb-2 ${Br?"text-orange-600":"text-indigo-600"}`,children:[": ",qt.toLocaleString(),"",Br&&" (  )"]}),me.extra_work_hours>0&&n.jsxs("p",{className:"text-sm text-toss-blue mb-3",children:[": ",me.extra_work_hours," ( ",(me.extra_work_hours/8).toFixed(1),")"]}),me.attendance_type==="leave"&&me.leave_type&&n.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg mb-3",children:n.jsxs("p",{className:"text-sm text-emerald-700 font-medium",children:[Uo[me.leave_type]?.label||me.leave_type," ",n.jsxs("span",{className:"ml-2",children:[me.leave_start_date===me.leave_end_date?_e(me.leave_start_date):`${_e(me.leave_start_date)} ~ ${_e(me.leave_end_date)}`,me.leave_days&&` (${me.leave_days})`]})]})}),me.attachments&&me.attachments.length>0&&n.jsxs("div",{className:"mb-3",children:[n.jsxs("p",{className:"text-xs text-toss-gray-500 mb-2 flex items-center gap-1",children:[n.jsx(Dc,{size:12})," (",me.attachments.length,")"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:me.attachments.map((us,Ha)=>{const go=ht(us.name),Ys=me.attachments.filter(Wa=>ht(Wa.name)).findIndex(Wa=>Wa.name===us.name);return n.jsx("div",{className:"relative group",children:go?n.jsx("button",{onClick:Wa=>{Wa.stopPropagation(),vt(me.attachments,Ys)},className:"w-16 h-16 rounded-lg overflow-hidden border border-toss-gray-200 hover:border-toss-blue transition-colors",children:n.jsx("img",{src:us.url,alt:us.name,className:"w-full h-full object-cover"})}):n.jsxs("a",{href:us.url,target:"_blank",rel:"noopener noreferrer",onClick:Wa=>Wa.stopPropagation(),className:"flex items-center gap-1 px-2 py-1 bg-toss-gray-100 rounded-lg text-xs text-toss-gray-700 hover:bg-toss-gray-200 transition-colors",children:[n.jsx(Ws,{size:12}),n.jsx("span",{className:"max-w-[100px] truncate",children:us.name})]})},Ha)})})]}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-toss-gray-400",children:[n.jsx(ea,{size:12}),new Date(me.created_at).toLocaleString("ko-KR")," "]})]}),n.jsx("div",{className:"mt-4 pt-4 border-t border-toss-gray-200",children:_t?n.jsxs("div",{className:"space-y-3",children:[n.jsx("textarea",{value:ae,onChange:us=>te(us.target.value),placeholder:"  ",rows:2,className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(rt,{onClick:()=>qe(me.id),className:"flex-1 bg-red-500 hover:bg-red-600",loading:bt,disabled:bt,children:" "}),n.jsx(rt,{onClick:()=>{M(null),te("")},variant:"secondary",className:"flex-1",disabled:bt,children:""})]})]}):n.jsxs("div",{className:"flex gap-2",children:[Br?n.jsxs(n.Fragment,{children:[!cs&&n.jsxs(rt,{onClick:()=>ve(me.id,"chairman"),className:"flex-1 bg-blue-500 hover:bg-blue-600",loading:bt,disabled:bt,children:[n.jsx(Hs,{size:16,className:"mr-1"})," "]}),cs&&n.jsxs(rt,{onClick:()=>ve(me.id,"director"),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:bt,disabled:bt,children:[n.jsx(Hs,{size:16,className:"mr-1"})," "]})]}):n.jsxs(rt,{onClick:()=>ve(me.id,"chairman"),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:bt,disabled:bt,children:[n.jsx(Hs,{size:16,className:"mr-1"}),""]}),n.jsxs(rt,{onClick:()=>M(me.id),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",disabled:bt,children:[n.jsx(to,{size:16,className:"mr-1"}),""]})]})})]},me.id)})})]}),O==="all"&&n.jsxs(At,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-lg font-bold text-toss-gray-900",children:" "}),n.jsxs("div",{className:"relative",children:[n.jsx(ao,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400",size:16}),n.jsx("input",{type:"text",value:oe,onChange:me=>D(me.target.value),placeholder:"   ",className:"pl-9 pr-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),n.jsx("tbody",{children:ke.map(me=>{const Ie=he(me.drafter_id),_t=Z===me.id;return n.jsxs("tr",{onClick:()=>Ne({...me,userInfo:Ie}),className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 cursor-pointer",children:[n.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:ge(me.created_at)}),n.jsx("td",{className:"py-3 px-4",children:me.document_labels&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:me.document_labels.color+"20",color:me.document_labels.color},children:me.document_labels.name})}),n.jsx("td",{className:"py-3 px-4",children:n.jsx("p",{className:"font-medium text-toss-gray-900 truncate max-w-xs",children:me.title})}),n.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:Ie.name}),n.jsx("td",{className:"py-3 px-4 text-center",children:ye(me.status)}),n.jsx("td",{className:"py-3 px-4 text-center",onClick:bt=>bt.stopPropagation(),children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[me.status==="approved"&&n.jsx("button",{onClick:()=>{const qt=Oe(me)>=1e6?"":"";O1(me,Ie,"",qt)},className:"p-1.5 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:" PDF ",children:n.jsx(Ws,{size:18})}),n.jsx("button",{onClick:()=>ct(me.id),disabled:_t,className:"p-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"",children:_t?n.jsx("div",{className:"w-4 h-4 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}):n.jsx(cr,{size:18})})]})})]},me.id)})})]})})]}),O==="labels"&&n.jsxs(At,{children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 mb-4 flex items-center gap-2",children:[n.jsx(_d,{className:"text-purple-500",size:20})," "]}),n.jsxs("div",{className:"p-4 bg-toss-gray-50 rounded-xl mb-6",children:[n.jsx("h3",{className:"font-medium text-toss-gray-900 mb-3",children:"  "}),n.jsxs("div",{className:"flex gap-3 items-end flex-wrap",children:[n.jsxs("div",{className:"flex-1 min-w-[200px]",children:[n.jsx("label",{className:"block text-sm text-toss-gray-500 mb-1",children:" "}),n.jsx("input",{type:"text",value:q,onChange:me=>I(me.target.value),placeholder:" ",className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("div",{className:"flex gap-1",children:at.map(me=>n.jsx("button",{onClick:()=>H(me),className:`w-8 h-8 rounded-lg transition-all ${X===me?"ring-2 ring-offset-2 ring-gray-400":""}`,style:{backgroundColor:me}},me))})]}),n.jsxs(rt,{onClick:Et,children:[n.jsx(Ns,{size:16,className:"mr-1"}),""]})]})]}),n.jsx("div",{className:"space-y-3",children:x.map(me=>{const Ie=Q===me.id;return n.jsx("div",{className:"flex items-center justify-between p-4 bg-toss-gray-50 rounded-xl",children:Ie?n.jsxs("div",{className:"flex gap-3 items-center flex-1 flex-wrap",children:[n.jsx("input",{type:"text",value:B,onChange:_t=>z(_t.target.value),className:"flex-1 min-w-[150px] px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}),n.jsx("div",{className:"flex gap-1",children:at.map(_t=>n.jsx("button",{onClick:()=>se(_t),className:`w-6 h-6 rounded transition-all ${ue===_t?"ring-2 ring-offset-1 ring-gray-400":""}`,style:{backgroundColor:_t}},_t))}),n.jsx("button",{onClick:()=>Xt(me.id),className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-lg",children:n.jsx(dy,{size:18})}),n.jsx("button",{onClick:()=>ie(null),className:"p-2 text-toss-gray-500 hover:bg-toss-gray-100 rounded-lg",children:n.jsx(pr,{size:18})})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-sm text-toss-gray-500",children:me.code}),n.jsx("span",{className:"px-3 py-1.5 rounded-full text-sm font-medium",style:{backgroundColor:me.color+"20",color:me.color},children:me.name})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>{ie(me.id),z(me.name),se(me.color)},className:"p-2 text-toss-gray-500 hover:bg-toss-gray-100 rounded-lg",children:n.jsx(Oc,{size:18})}),n.jsx("button",{onClick:()=>er(me.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg",children:n.jsx(cr,{size:18})})]})]})},me.id)})})]})]}),R==="leave"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex gap-2 border-b border-toss-gray-200",children:[n.jsxs("button",{onClick:()=>W("pending"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${re==="pending"?"border-purple-500 text-purple-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:[" ",o.length+He.length>0&&n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:o.length+He.length})]}),n.jsx("button",{onClick:()=>W("history"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${re==="history"?"border-purple-500 text-purple-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "}),n.jsx("button",{onClick:()=>W("overview"),className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${re==="overview"?"border-purple-500 text-purple-600":"border-transparent text-toss-gray-500 hover:text-toss-gray-700"}`,children:" "})]}),re==="pending"&&n.jsxs("div",{className:"space-y-6",children:[He.length>0&&n.jsxs(At,{children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 mb-4 flex items-center gap-2",children:[n.jsx(Ws,{className:"text-purple-500",size:20}),"   ",n.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 text-xs rounded-full",children:He.length})]}),n.jsx("div",{className:"space-y-4",children:He.map(me=>{const Ie=he(me.drafter_id),_t=K===me.id,bt=Z===me.id,Br=Oe(me)>=1e6,cs=me.status==="chairman_approved";return n.jsxs("div",{className:"p-5 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{onClick:()=>Ne({...me,userInfo:Ie}),className:"cursor-pointer hover:bg-toss-gray-100 -mx-5 -mt-5 px-5 pt-5 pb-3 rounded-t-xl transition-colors",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[me.document_labels&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:me.document_labels.color+"20",color:me.document_labels.color},children:me.document_labels.name}),me.attendance_type&&n.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium ${me.attendance_type==="overtime"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:me.attendance_type==="overtime"?"":""}),cs&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:""}),n.jsx("span",{className:"text-sm text-toss-gray-500",children:me.doc_number})]}),n.jsx("p",{className:"font-bold text-toss-gray-900",children:me.title})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"text-base font-semibold text-toss-gray-900",children:[Ie.name," ",n.jsx("span",{className:"font-normal text-toss-gray-600",children:Ie.rank})]}),n.jsx("p",{className:"text-sm text-toss-gray-500",children:Ie.team})]})]}),me.leave_type&&n.jsxs("div",{className:"mb-3 p-3 bg-green-50 rounded-lg",children:[n.jsxs("p",{className:"text-sm text-green-800",children:[n.jsx("span",{className:"font-medium",children:" :"})," ",Uo[me.leave_type]?.label||me.leave_type]}),me.leave_start_date&&n.jsxs("p",{className:"text-sm text-green-800",children:[n.jsx("span",{className:"font-medium",children:":"})," ",_e(me.leave_start_date),me.leave_end_date&&me.leave_start_date!==me.leave_end_date&&n.jsxs(n.Fragment,{children:[" ~ ",_e(me.leave_end_date)]})]}),me.leave_days&&n.jsxs("p",{className:"text-sm text-green-800",children:[n.jsx("span",{className:"font-medium",children:":"})," ",me.leave_days,""]})]}),me.content&&n.jsx("p",{className:"text-sm text-toss-gray-600 mb-3 line-clamp-2",children:me.content}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-toss-gray-400",children:[n.jsx(ea,{size:12}),new Date(me.created_at).toLocaleString("ko-KR")," "]})]}),_t?n.jsxs("div",{className:"space-y-3 mt-4",children:[n.jsx("textarea",{value:ae,onChange:us=>te(us.target.value),placeholder:"  ",rows:2,className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(rt,{onClick:()=>qe(me.id),className:"flex-1 bg-red-500 hover:bg-red-600",loading:bt,disabled:bt,children:" "}),n.jsx(rt,{onClick:()=>{M(null),te("")},variant:"secondary",className:"flex-1",disabled:bt,children:""})]})]}):n.jsxs("div",{className:"flex gap-2 mt-4",children:[Br&&!cs&&s&&n.jsxs(rt,{onClick:()=>ve(me.id,"chairman"),className:"flex-1 bg-blue-500 hover:bg-blue-600",loading:bt,disabled:bt,children:[n.jsx(Hs,{size:16,className:"mr-1"})," "]}),Br&&cs&&a&&n.jsxs(rt,{onClick:()=>ve(me.id,"director"),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:bt,disabled:bt,children:[n.jsx(Hs,{size:16,className:"mr-1"})," "]}),!Br&&n.jsxs(rt,{onClick:()=>ve(me.id,"chairman"),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:bt,disabled:bt,children:[n.jsx(Hs,{size:16,className:"mr-1"}),""]}),n.jsxs(rt,{onClick:()=>M(me.id),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",disabled:bt,children:[n.jsx(to,{size:16,className:"mr-1"}),""]})]})]},me.id)})})]}),n.jsxs(At,{children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 mb-4 flex items-center gap-2",children:[n.jsx(_n,{className:"text-amber-500",size:20}),"   ",o.length>0&&n.jsx("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 text-xs rounded-full",children:o.length})]}),c?n.jsx("div",{className:"py-12 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-purple-500 border-t-transparent"})}):o.length===0?n.jsxs("div",{className:"py-12 text-center text-toss-gray-500",children:[n.jsx(Hs,{className:"mx-auto mb-3 text-emerald-400",size:48}),n.jsx("p",{children:"   "})]}):n.jsx("div",{className:"space-y-4",children:o.map(me=>{const Ie=he(me.user_id),_t=je===me.id,bt=st===me.id;return n.jsxs("div",{className:"p-5 bg-toss-gray-50 rounded-xl",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"text-lg font-bold text-toss-gray-900",children:[Ie.name,Ie.rank&&n.jsx("span",{className:"text-base font-normal text-toss-gray-600 ml-1",children:Ie.rank})]}),Ie.team&&n.jsx("p",{className:"text-sm text-toss-gray-500",children:Ie.team})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("span",{className:"px-3 py-1 bg-amber-100 text-amber-700 rounded-full text-sm font-medium",children:[me.days,""]}),n.jsx("p",{className:"text-xs text-toss-gray-500 mt-1",children:Uo[me.leave_type]?.label||me.leave_type})]})]}),n.jsxs("div",{className:"mb-3",children:[n.jsxs("p",{className:"text-toss-gray-900",children:[_e(me.start_date),me.start_date!==me.end_date&&n.jsxs(n.Fragment,{children:[" ~ ",_e(me.end_date)]})]}),me.reason&&n.jsxs("p",{className:"text-sm text-toss-gray-500 mt-1",children:[": ",me.reason]})]}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-toss-gray-400 mb-4",children:[n.jsx(ea,{size:12}),new Date(me.created_at).toLocaleString("ko-KR")," "]}),_t?n.jsxs("div",{className:"space-y-3",children:[n.jsx("textarea",{value:De,onChange:qt=>Ce(qt.target.value),placeholder:"  ",rows:2,className:"w-full px-3 py-2 bg-white border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-transparent",autoFocus:!0}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(rt,{onClick:()=>Yt(me.id),className:"flex-1 bg-red-500 hover:bg-red-600",loading:bt,disabled:bt,children:" "}),n.jsx(rt,{onClick:()=>{Me(null),Ce("")},variant:"secondary",className:"flex-1",disabled:bt,children:""})]})]}):n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(rt,{onClick:()=>Lt(me.id),className:"flex-1 bg-emerald-500 hover:bg-emerald-600",loading:bt,disabled:bt,children:[n.jsx(Hs,{size:16,className:"mr-1"}),""]}),n.jsxs(rt,{onClick:()=>Me(me.id),variant:"secondary",className:"flex-1 text-red-500 border-red-200 hover:bg-red-50",disabled:bt,children:[n.jsx(to,{size:16,className:"mr-1"}),""]})]})]},me.id)})})]})]}),re==="history"&&n.jsxs(At,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 flex items-center gap-2",children:[n.jsx(FS,{className:"text-purple-500",size:20})," "]}),n.jsxs("div",{className:"relative",children:[n.jsx(ao,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400",size:16}),n.jsx("input",{type:"text",value:be,onChange:me=>ne(me.target.value),placeholder:" ",className:"pl-9 pr-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),de.length===0&&T.length===0?n.jsxs("div",{className:"py-12 text-center text-toss-gray-500",children:[n.jsx(FS,{className:"mx-auto mb-3 text-toss-gray-300",size:48}),n.jsx("p",{children:"  "})]}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:"/"}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),n.jsx("tbody",{children:[...de.map(me=>({...me,_type:"leave",_sortDate:new Date(me.updated_at)})),...T.map(me=>({...me,_type:"document",_sortDate:new Date(me.updated_at||me.approved_at||me.created_at)}))].sort((me,Ie)=>Ie._sortDate-me._sortDate).filter(me=>{const Ie=me._type==="leave"?me.user_id:me.drafter_id;return he(Ie).name?.toLowerCase().includes(be.toLowerCase())}).map(me=>{if(me._type==="leave"){const Ie=me,_t=he(Ie.user_id),bt=st===Ie.id;return n.jsxs("tr",{onClick:()=>Re({...Ie,userInfo:_t}),className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 cursor-pointer",children:[n.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:ge(Ie.updated_at)}),n.jsxs("td",{className:"py-3 px-4",children:[n.jsx("p",{className:"text-sm font-medium text-toss-gray-900",children:_t.name}),_t.rank&&n.jsx("p",{className:"text-xs text-toss-gray-500",children:_t.rank})]}),n.jsx("td",{className:"py-3 px-4",children:n.jsx("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full text-xs font-medium",children:""})}),n.jsxs("td",{className:"py-3 px-4 text-sm text-toss-gray-900",children:[Uo[Ie.leave_type]?.label,Ie.days&&n.jsxs("span",{className:"text-purple-600 ml-1",children:["(",Ie.days,")"]})]}),n.jsx("td",{className:"py-3 px-4",children:n.jsxs("p",{className:"text-sm text-toss-gray-900",children:[ge(Ie.start_date),Ie.start_date!==Ie.end_date&&n.jsxs(n.Fragment,{children:[" ~ ",ge(Ie.end_date)]})]})}),n.jsx("td",{className:"py-3 px-4 text-center",children:Se(Ie.status)}),n.jsx("td",{className:"py-3 px-4 text-center",onClick:qt=>qt.stopPropagation(),children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[Ie.status==="approved"&&n.jsx("button",{onClick:()=>iE(Ie,_t),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",title:" PDF ",children:n.jsx(Ws,{size:18})}),n.jsx("button",{onClick:()=>Rr(Ie),disabled:bt,className:"p-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"",children:bt?n.jsx("div",{className:"w-4 h-4 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}):n.jsx(cr,{size:18})})]})})]},`leave-${Ie.id}`)}else{const Ie=me,_t=he(Ie.drafter_id),bt=Z===Ie.id;return n.jsxs("tr",{onClick:()=>Ne({...Ie,userInfo:_t}),className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 cursor-pointer",children:[n.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-600",children:ge(Ie.updated_at||Ie.approved_at||Ie.created_at)}),n.jsxs("td",{className:"py-3 px-4",children:[n.jsx("p",{className:"text-sm font-medium text-toss-gray-900",children:_t.name}),_t.rank&&n.jsx("p",{className:"text-xs text-toss-gray-500",children:_t.rank})]}),n.jsx("td",{className:"py-3 px-4",children:n.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Ie.attendance_type==="overtime"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:Ie.attendance_type==="overtime"?"":""})}),n.jsx("td",{className:"py-3 px-4 text-sm text-toss-gray-900",children:Ie.attendance_type==="leave"?n.jsxs(n.Fragment,{children:[Uo[Ie.leave_type]?.label||Ie.leave_type,Ie.leave_days&&n.jsxs("span",{className:"text-purple-600 ml-1",children:["(",Ie.leave_days,")"]})]}):n.jsxs(n.Fragment,{children:[Ie.title,Ie.extra_work_hours>0&&n.jsxs("span",{className:"text-blue-600 ml-1",children:["(",Ie.extra_work_hours,")"]})]})}),n.jsx("td",{className:"py-3 px-4",children:Ie.leave_start_date?n.jsxs("p",{className:"text-sm text-toss-gray-900",children:[ge(Ie.leave_start_date),Ie.leave_start_date!==Ie.leave_end_date&&Ie.leave_end_date&&n.jsxs(n.Fragment,{children:[" ~ ",ge(Ie.leave_end_date)]})]}):n.jsx("span",{className:"text-sm text-toss-gray-400",children:"-"})}),n.jsx("td",{className:"py-3 px-4 text-center",children:ye(Ie.status)}),n.jsx("td",{className:"py-3 px-4 text-center",onClick:qt=>qt.stopPropagation(),children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[Ie.status==="approved"&&n.jsx("button",{onClick:()=>{const Br=Oe(Ie)>=1e6?"":"";O1(Ie,_t,"",Br)},className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",title:" PDF ",children:n.jsx(Ws,{size:18})}),n.jsx("button",{onClick:()=>ct(Ie.id),disabled:bt,className:"p-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"",children:bt?n.jsx("div",{className:"w-4 h-4 border-2 border-red-500 border-t-transparent rounded-full animate-spin"}):n.jsx(cr,{size:18})})]})})]},`doc-${Ie.id}`)}})})]})})]}),re==="overview"&&n.jsxs(At,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-bold text-toss-gray-900 flex items-center gap-2",children:[n.jsx(Sd,{className:"text-purple-600",size:20}),"  "]}),n.jsxs("div",{className:"relative",children:[n.jsx(ao,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400",size:16}),n.jsx("input",{type:"text",value:G,onChange:me=>xe(me.target.value),placeholder:"   ",className:"pl-9 pr-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-200",children:[n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:" "}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-toss-gray-500",children:""})]})}),n.jsx("tbody",{children:$e.map(me=>{const Ie=le(me.user_id),_t=Ie?.total_days||15,bt=Ie?.used_days||0,qt=_t-bt,Br=pt===me.user_id,cs=Pt===me.user_id;return n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50",children:[n.jsxs("td",{className:"py-3 px-4",children:[n.jsx("p",{className:"font-medium text-toss-gray-900",children:me.name}),me.rank&&n.jsx("p",{className:"text-xs text-toss-gray-500",children:me.rank})]}),n.jsx("td",{className:"py-3 px-4 text-toss-gray-600",children:me.team||"-"}),n.jsx("td",{className:"py-3 px-4 text-center",children:Br?n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("input",{type:"number",value:wt,onChange:us=>jt(us.target.value),step:"0.5",min:"0",className:"w-16 px-2 py-1 text-center bg-white border border-toss-gray-300 rounded-lg text-sm",autoFocus:!0}),n.jsx("button",{onClick:()=>fe(me.user_id),disabled:cs,className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded",children:cs?n.jsx("div",{className:"w-4 h-4 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin"}):n.jsx(dy,{size:16})}),n.jsx("button",{onClick:()=>Tt(null),disabled:cs,className:"p-1 text-toss-gray-500 hover:bg-toss-gray-100 rounded",children:n.jsx(pr,{size:16})})]}):n.jsxs("button",{onClick:()=>Dr(me.user_id,_t),className:"inline-flex items-center gap-1 text-toss-gray-900 hover:text-purple-600 transition-colors group",children:[_t,"",n.jsx(Oc,{size:14,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})}),n.jsxs("td",{className:"py-3 px-4 text-center text-purple-600 font-medium",children:[bt,""]}),n.jsx("td",{className:"py-3 px-4 text-center",children:n.jsxs("span",{className:`font-bold ${qt<=3?"text-red-500":"text-emerald-600"}`,children:[qt,""]})})]},me.user_id)})})]})}),$e.length===0&&n.jsx("div",{className:"py-12 text-center text-toss-gray-500",children:"  "})]})]}),ee&&n.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>Ne(null),children:n.jsx("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:me=>me.stopPropagation(),children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:" "}),n.jsx("button",{onClick:()=>Ne(null),className:"p-2 hover:bg-toss-gray-100 rounded-lg",children:n.jsx(pr,{size:20,className:"text-toss-gray-500"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[ye(ee.status),ee.document_labels&&n.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium",style:{backgroundColor:ee.document_labels.color+"20",color:ee.document_labels.color},children:ee.document_labels.name})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"font-bold text-toss-gray-900",children:[ee.userInfo?.name,ee.userInfo?.rank&&n.jsx("span",{className:"font-normal text-toss-gray-500 ml-1",children:ee.userInfo.rank})]}),ee.userInfo?.team&&n.jsx("p",{className:"text-sm text-toss-gray-500",children:ee.userInfo.team})]}),ee.doc_number&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:ee.doc_number})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"font-bold text-toss-gray-900 text-lg",children:ee.title})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:ee.content||"( )"})]}),ee.expense_items&&ee.expense_items.length>0&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-2",children:""}),n.jsx("div",{className:"overflow-x-auto border border-toss-gray-200 rounded-lg",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-toss-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700",children:""}),n.jsx("th",{className:"px-3 py-2 text-right font-medium text-toss-gray-700",children:""}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-toss-gray-700",children:""})]})}),n.jsxs("tbody",{children:[ee.expense_items.map((me,Ie)=>n.jsxs("tr",{className:"border-t border-toss-gray-100",children:[n.jsx("td",{className:"px-3 py-2",children:me.item}),n.jsx("td",{className:"px-3 py-2",children:me.category}),n.jsx("td",{className:"px-3 py-2",children:me.vendor}),n.jsxs("td",{className:"px-3 py-2 text-right",children:[Number(me.amount).toLocaleString(),""]}),n.jsx("td",{className:"px-3 py-2",children:me.note})]},Ie)),n.jsxs("tr",{className:"border-t-2 border-toss-gray-300 bg-toss-gray-50 font-medium",children:[n.jsx("td",{colSpan:3,className:"px-3 py-2 text-right",children:" "}),n.jsxs("td",{className:"px-3 py-2 text-right text-indigo-600",children:[ee.expense_items.reduce((me,Ie)=>me+(Number(Ie.amount)||0),0).toLocaleString(),""]}),n.jsx("td",{})]})]})]})})]}),ee.extra_work_hours>0&&n.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:n.jsxs("p",{className:"text-sm text-toss-blue font-medium",children:[": ",ee.extra_work_hours," ( ",(ee.extra_work_hours/8).toFixed(1),")"]})}),ee.attendance_type==="leave"&&ee.leave_type&&n.jsxs("div",{className:"p-3 bg-emerald-50 rounded-lg",children:[n.jsxs("p",{className:"text-sm text-emerald-700 font-medium mb-1",children:[Uo[ee.leave_type]?.label||ee.leave_type," "]}),n.jsxs("p",{className:"text-sm text-emerald-600",children:[ee.leave_start_date===ee.leave_end_date?new Date(ee.leave_start_date).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}):`${new Date(ee.leave_start_date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})} ~ ${new Date(ee.leave_end_date).toLocaleDateString("ko-KR",{month:"long",day:"numeric",weekday:"short"})}`,ee.leave_days&&` (${ee.leave_days})`]})]}),ee.attachments&&ee.attachments.length>0&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("p",{className:"text-sm text-toss-gray-500 flex items-center gap-1",children:[n.jsx(Dc,{size:14})," (",ee.attachments.length,")"]}),n.jsxs("button",{onClick:()=>gt(ee.attachments),className:"flex items-center gap-1 text-xs text-toss-blue hover:underline",children:[n.jsx(ns,{size:12})," "]})]}),n.jsxs("div",{className:"space-y-2",children:[ee.attachments.filter(me=>ht(me.name)).length>0&&n.jsx("div",{className:"grid grid-cols-4 gap-2 mb-2",children:ee.attachments.filter(me=>ht(me.name)).map((me,Ie)=>n.jsxs("button",{onClick:()=>vt(ee.attachments,Ie),className:"aspect-square rounded-lg overflow-hidden border border-toss-gray-200 hover:border-toss-blue transition-colors relative group",children:[n.jsx("img",{src:me.url,alt:me.name,className:"w-full h-full object-cover"}),n.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center",children:n.jsx(f4,{size:20,className:"text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]},Ie))}),ee.attachments.filter(me=>!ht(me.name)).map((me,Ie)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-toss-gray-50 rounded-lg",children:[n.jsxs("a",{href:me.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-toss-gray-700 hover:text-toss-blue transition-colors flex-1 min-w-0",children:[n.jsx(Ws,{size:16,className:"flex-shrink-0"}),n.jsx("span",{className:"truncate",children:me.name}),n.jsx(wc,{size:12,className:"flex-shrink-0"})]}),n.jsx("button",{onClick:()=>Nt(me),className:"p-1.5 text-toss-gray-500 hover:text-toss-blue hover:bg-toss-gray-100 rounded-lg transition-colors",children:n.jsx(ns,{size:14})})]},Ie))]})]}),ee.status==="rejected"&&ee.rejected_reason&&n.jsxs("div",{className:"p-3 bg-red-50 rounded-lg",children:[n.jsx("p",{className:"text-sm text-red-600 font-medium mb-1",children:" "}),n.jsx("p",{className:"text-red-700",children:ee.rejected_reason})]}),n.jsxs("div",{className:"pt-4 border-t border-toss-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500",children:[n.jsx(ea,{size:14}),new Date(ee.created_at).toLocaleString("ko-KR")," "]}),ee.approved_at&&n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500 mt-1",children:[n.jsx(ea,{size:14}),new Date(ee.approved_at).toLocaleString("ko-KR")," "]})]})]}),n.jsxs("div",{className:"mt-6 flex gap-2",children:[ee.status==="approved"&&n.jsxs(rt,{onClick:()=>{const Ie=Oe(ee)>=1e6?"":"";O1(ee,ee.userInfo,"",Ie)},className:"flex-1",children:[n.jsx(Ws,{size:16,className:"mr-1"}),"PDF "]}),n.jsx(rt,{onClick:()=>Ne(null),variant:"secondary",className:ee.status==="approved"?"flex-1":"w-full",children:""})]})]})})}),Ze&&n.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>Re(null),children:n.jsx("div",{className:"bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto",onClick:me=>me.stopPropagation(),children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"text-xl font-bold text-toss-gray-900",children:" "}),n.jsx("button",{onClick:()=>Re(null),className:"p-2 hover:bg-toss-gray-100 rounded-lg",children:n.jsx(pr,{size:20,className:"text-toss-gray-500"})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"flex items-center gap-2",children:Se(Ze.status)}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"font-bold text-toss-gray-900",children:[Ze.userInfo?.name,Ze.userInfo?.rank&&n.jsx("span",{className:"font-normal text-toss-gray-500 ml-1",children:Ze.userInfo.rank})]}),Ze.userInfo?.team&&n.jsx("p",{className:"text-sm text-toss-gray-500",children:Ze.userInfo.team})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"font-medium text-toss-gray-900",children:[Uo[Ze.leave_type]?.label||Ze.leave_type,n.jsxs("span",{className:"text-purple-600 ml-2",children:["(",Ze.days,")"]})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"font-medium text-toss-gray-900",children:[_e(Ze.start_date),Ze.start_date!==Ze.end_date&&n.jsxs(n.Fragment,{children:[" ~ ",_e(Ze.end_date)]})]})]}),Ze.reason&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsx("p",{className:"text-toss-gray-900 whitespace-pre-wrap",children:Ze.reason})]}),Ze.status==="rejected"&&Ze.rejected_reason&&n.jsxs("div",{className:"p-3 bg-red-50 rounded-lg",children:[n.jsx("p",{className:"text-sm text-red-600 font-medium mb-1",children:" "}),n.jsx("p",{className:"text-red-700",children:Ze.rejected_reason})]}),n.jsxs("div",{className:"pt-4 border-t border-toss-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500",children:[n.jsx(ea,{size:14}),new Date(Ze.created_at).toLocaleString("ko-KR")," "]}),Ze.updated_at&&Ze.status!=="pending"&&n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-500 mt-1",children:[n.jsx(ea,{size:14}),new Date(Ze.updated_at).toLocaleString("ko-KR")," "]})]})]}),n.jsxs("div",{className:"mt-6 flex gap-2",children:[Ze.status==="approved"&&n.jsxs(rt,{onClick:()=>iE(Ze,Ze.userInfo),className:"flex-1",children:[n.jsx(Ws,{size:16,className:"mr-1"}),"PDF "]}),n.jsx(rt,{onClick:()=>Re(null),variant:"secondary",className:"flex-1",children:""})]})]})})}),nt&&Ae.length>0&&n.jsxs("div",{className:"fixed inset-0 bg-black/90 z-[60] flex items-center justify-center",onClick:()=>dt(!1),children:[n.jsx("button",{onClick:()=>dt(!1),className:"absolute top-4 right-4 p-2 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors z-10",children:n.jsx(pr,{size:28})}),n.jsx("button",{onClick:me=>{me.stopPropagation(),Nt(Ae[Ee])},className:"absolute top-4 right-16 p-2 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors z-10",children:n.jsx(ns,{size:24})}),Ae.length>1&&n.jsx("button",{onClick:me=>{me.stopPropagation(),Pe(Ie=>Ie===0?Ae.length-1:Ie-1)},className:"absolute left-4 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors",children:n.jsx(za,{size:32})}),n.jsx("div",{className:"max-w-[90vw] max-h-[85vh]",onClick:me=>me.stopPropagation(),children:n.jsx("img",{src:Ae[Ee].url,alt:Ae[Ee].name,className:"max-w-full max-h-[85vh] object-contain"})}),Ae.length>1&&n.jsx("button",{onClick:me=>{me.stopPropagation(),Pe(Ie=>Ie===Ae.length-1?0:Ie+1)},className:"absolute right-4 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors",children:n.jsx(pa,{size:32})}),Ae.length>1&&n.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 px-4 py-2 bg-black/50 rounded-full text-white text-sm",children:[Ee+1," / ",Ae.length]}),n.jsx("div",{className:"absolute bottom-4 left-4 px-3 py-1.5 bg-black/50 rounded-lg text-white/80 text-sm",children:Ae[Ee].name})]})]})},sU=/([A-Z]{2,4}[-_]?\d{3,5})/gi,F1="archive_labels",oE={forms:["","","",""],rescue:["","","",""]},aU=()=>{const{type:e}=Oj(),[t,r]=Y.useState([]),[s,a]=Y.useState([]),[o,c]=Y.useState(!0),[u,d]=Y.useState(!1),[h,m]=Y.useState(""),[x,y]=Y.useState(""),[v,w]=Y.useState([]),[g,_]=Y.useState([]),b=Y.useRef(null),[N,S]=Y.useState([]),[E,R]=Y.useState(!1),[L,O]=Y.useState(!1),[P,F]=Y.useState(""),[V,oe]=Y.useState(""),[D,K]=Y.useState([]);Y.useEffect(()=>{const ce=localStorage.getItem(F1);if(ce){const k=JSON.parse(ce);S(k[e]||oE[e]||[])}else S(oE[e]||[])},[e]);const M=ce=>{const k=localStorage.getItem(F1),de=k?JSON.parse(k):{};de[e]=ce,localStorage.setItem(F1,JSON.stringify(de)),S(ce)},ae=async()=>{if(!P.trim())return;if(N.includes(P.trim())){alert("  .");return}const ce=P.trim(),k=[...N,ce];M(k);try{const de=Z();await qS(`${de}/${ce}`)}catch(de){console.error("  :",de)}F(""),ee(x)},te=ce=>{if(!confirm(`"${ce}"  ?
(Dropbox   )`))return;const k=N.filter(de=>de!==ce);M(k)},Z=()=>e==="forms"?"//":e==="rescue"?"//":"/",we=()=>e==="forms"?"":e==="rescue"?"":"";Y.useEffect(()=>{const ce=Z();y(ce),w([ce]),ee(ce)},[e]),Y.useEffect(()=>{q()},[h,t]);const ee=async ce=>{c(!0);try{const de=(await FL(ce)).sort((U,T)=>U.isFolder&&!T.isFolder?-1:!U.isFolder&&T.isFolder?1:U.name.localeCompare(T.name,"ko"));r(de),Ne(de)}catch(k){console.error("   :",k),r([])}finally{c(!1)}},Ne=ce=>{const k=[];ce.forEach(de=>{if(!de.isFolder){const U=de.name.match(sU);U&&U.forEach(T=>{k.push({documentNumber:T.toUpperCase(),fileName:de.name,path:de.path})})}}),_(k)},q=()=>{if(!h.trim()){a(t);return}const ce=h.toLowerCase().trim(),k=g.filter(de=>de.documentNumber.toLowerCase().includes(ce));if(k.length>0){const de=new Set(k.map(T=>T.path)),U=t.filter(T=>de.has(T.path));a(U)}else{const de=t.filter(U=>U.name.toLowerCase().includes(ce));a(de)}},I=ce=>{const k=ce.path;w(de=>[...de,k]),y(k),ee(k),m("")},X=()=>{if(v.length>1){const ce=[...v];ce.pop();const k=ce[ce.length-1];w(ce),y(k),ee(k),m("")}},H=async ce=>{try{const k=await LL(ce.path);window.open(k,"_blank")}catch(k){console.error(" :",k),alert("  .")}},Q=ce=>{const k=Array.from(ce.target.files);k.length!==0&&(K(k),oe(""),O(!0),b.current&&(b.current.value=""))},ie=async()=>{if(D.length===0)return;const ce=V?`${Z()}/${V}`:x;d(!0),O(!1);try{V&&await qS(ce);for(const k of D)await IL(k,ce);alert(`${D.length}  .`),V&&x!==ce&&(y(ce),w(k=>[...k,ce])),ee(ce)}catch(k){console.error(" :",k),alert("  : "+k.message)}finally{d(!1),K([])}},B=async ce=>{if(confirm(`"${ce.name}"() ?`))try{await OL(ce.path),alert("."),ee(x)}catch(k){console.error(" :",k),alert("  .")}},z=()=>{ee(x)},ue=ce=>{if(ce.isFolder)return n.jsx(aF,{size:20,className:"text-yellow-500"});const k=ce.name.split(".").pop().toLowerCase();return["xlsx","xls","csv"].includes(k)?n.jsx(Yy,{size:20,className:"text-green-600"}):n.jsx(ka,{size:20,className:"text-toss-gray-500"})},se=ce=>ce?ce<1024?ce+" B":ce<1024*1024?(ce/1024).toFixed(1)+" KB":(ce/(1024*1024)).toFixed(1)+" MB":"-",re=()=>x===Z()?we():x.split("/").pop()||we(),W=()=>{const ce=Z();if(x===ce)return[];const de=x.replace(ce,"").split("/").filter(Boolean);return de.map((U,T)=>{const A=ce+"/"+de.slice(0,T+1).join("/");return{name:U,path:A}})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(At,{className:"bg-gradient-to-r from-amber-500 to-orange-500 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(rF,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:we()}),n.jsx("p",{className:"text-white/90",children:"    "})]})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[v.length>1&&n.jsx("button",{onClick:X,className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",title:" ",children:n.jsx(Wd,{size:20})}),n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:re()})]}),n.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[n.jsxs("div",{className:"relative flex-1 sm:w-64",children:[n.jsx(ao,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-toss-gray-400"}),n.jsx("input",{type:"text",value:h,onChange:ce=>m(ce.target.value),placeholder:"...",className:"w-full pl-10 pr-4 py-2 bg-white border border-toss-gray-300 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent transition-all"})]}),n.jsx("input",{type:"file",ref:b,multiple:!0,onChange:Q,className:"hidden"}),n.jsxs(rt,{onClick:()=>b.current?.click(),disabled:u,className:"whitespace-nowrap",children:[u?n.jsx(Sc,{size:18,className:"animate-spin"}):n.jsx(Ns,{size:18}),u?" ...":" "]}),n.jsx("button",{onClick:()=>R(!0),className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",title:" ",children:n.jsx(hl,{size:20})}),n.jsx("button",{onClick:z,className:"p-2 hover:bg-toss-gray-100 rounded-lg transition-colors",title:"",children:n.jsx(Sc,{size:20,className:o?"animate-spin":""})})]})]}),W().length>0&&n.jsxs("div",{className:"flex items-center gap-1 text-sm text-toss-gray-600 overflow-x-auto",children:[n.jsx("button",{onClick:()=>{const ce=Z();y(ce),w([ce]),ee(ce)},className:"hover:text-toss-blue transition-colors whitespace-nowrap",children:we()}),W().map(ce=>n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(pa,{size:14,className:"text-toss-gray-400"}),n.jsx("button",{onClick:()=>{y(ce.path),w(k=>k.slice(0,k.indexOf(ce.path)+1)||[ce.path]),ee(ce.path)},className:"hover:text-toss-blue transition-colors whitespace-nowrap",children:ce.name})]},ce.path))]}),n.jsx(At,{padding:"p-0",children:o?n.jsxs("div",{className:"text-center text-toss-gray-500 py-12",children:[n.jsx(Sc,{size:24,className:"animate-spin mx-auto mb-2"})," ..."]}):s.length>0?n.jsx("div",{className:"divide-y divide-toss-gray-100",children:s.map(ce=>n.jsxs("div",{className:`flex items-center justify-between p-4 hover:bg-toss-gray-50 transition-colors ${ce.isFolder?"cursor-pointer":""}`,onClick:()=>ce.isFolder&&I(ce),children:[n.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[ue(ce),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-toss-gray-900 truncate",children:ce.name}),!ce.isFolder&&n.jsx("p",{className:"text-xs text-toss-gray-500",children:se(ce.size)})]})]}),ce.isFolder?n.jsx(pa,{size:20,className:"text-toss-gray-400"}):n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:k=>{k.stopPropagation(),H(ce)},className:"p-2 text-toss-blue hover:bg-toss-blue/10 rounded-lg transition-colors",title:"",children:n.jsx(ns,{size:18})}),n.jsx("button",{onClick:k=>{k.stopPropagation(),B(ce)},className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"",children:n.jsx(cr,{size:18})})]})]},ce.id||ce.path))}):n.jsx("div",{className:"text-center text-toss-gray-500 py-12",children:h?"  ":"   "})}),g.length>0&&!h&&n.jsxs("p",{className:"text-sm text-toss-gray-500 text-center",children:[g.length,"  "]}),n.jsx(yr,{isOpen:E,onClose:()=>R(!1),title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-sm text-toss-gray-600",children:"  Dropbox     ."}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:P,onChange:ce=>F(ce.target.value),placeholder:"  ",className:"flex-1 px-4 py-2 bg-toss-gray-50 border border-toss-gray-200 rounded-xl focus:ring-2 focus:ring-toss-blue focus:border-transparent",onKeyDown:ce=>ce.key==="Enter"&&ae()}),n.jsxs(rt,{onClick:ae,children:[n.jsx(Ns,{size:18}),""]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"text-sm font-medium text-toss-gray-700",children:" "}),N.length>0?n.jsx("div",{className:"flex flex-wrap gap-2",children:N.map(ce=>n.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-toss-gray-100 rounded-full",children:[n.jsx(_d,{size:14,className:"text-toss-gray-500"}),n.jsx("span",{className:"text-sm text-toss-gray-700",children:ce}),n.jsx("button",{onClick:()=>te(ce),className:"p-0.5 hover:bg-toss-gray-200 rounded-full transition-colors",children:n.jsx(pr,{size:14,className:"text-toss-gray-500"})})]},ce))}):n.jsx("p",{className:"text-sm text-toss-gray-500",children:"  ."})]}),n.jsx("div",{className:"flex justify-end pt-4",children:n.jsx(rt,{variant:"secondary",onClick:()=>R(!1),children:""})})]})}),n.jsx(yr,{isOpen:L,onClose:()=>{O(!1),K([])},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-toss-gray-600 mb-2",children:[" : ",n.jsxs("span",{className:"font-medium",children:[D.length,""]})]}),n.jsx("div",{className:"max-h-32 overflow-y-auto bg-toss-gray-50 rounded-xl p-3",children:D.map((ce,k)=>n.jsx("p",{className:"text-sm text-toss-gray-700 truncate",children:ce.name},k))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  ()"}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("button",{onClick:()=>oe(""),className:`px-4 py-2 rounded-xl text-sm font-medium transition-colors ${V===""?"bg-toss-blue text-white":"bg-toss-gray-100 text-toss-gray-700 hover:bg-toss-gray-200"}`,children:"  "}),N.map(ce=>n.jsxs("button",{onClick:()=>oe(ce),className:`flex items-center gap-1.5 px-4 py-2 rounded-xl text-sm font-medium transition-colors ${V===ce?"bg-toss-blue text-white":"bg-toss-gray-100 text-toss-gray-700 hover:bg-toss-gray-200"}`,children:[n.jsx(_d,{size:14}),ce]},ce))]}),V&&n.jsxs("p",{className:"mt-2 text-xs text-toss-gray-500",children:[' "',Z(),"/",V,'"  .']})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{O(!1),K([])},children:""}),n.jsx(rt,{onClick:ie,children:""})]})]})})]})};function nU(){const{profile:e,isAdmin:t,isSubAdmin:r}=Yr(),[s,a]=Y.useState([]),[o,c]=Y.useState([]),[u,d]=Y.useState(null),[h,m]=Y.useState(!1),[x,y]=Y.useState(null),v=Y.useCallback(async()=>{try{m(!0);const{data:L,error:O}=await Ue.from("document_ledger_labels").select("*").order("created_at",{ascending:!0});if(O)throw O;if(a(L||[]),L&&L.length>0&&!u){const P=L.find(F=>F.name===e?.team);d(P||L[0])}}catch(L){y(L.message),console.error("  :",L)}finally{m(!1)}},[u,e?.team]),w=async L=>{try{m(!0);const{data:O,error:P}=await Ue.from("document_ledger_labels").insert([{name:L}]).select().single();if(P)throw P;return a(F=>[...F,O]),{success:!0,data:O}}catch(O){return y(O.message),console.error("  :",O),{success:!1,error:O.message}}finally{m(!1)}},g=async(L,O)=>{try{m(!0);const{data:P,error:F}=await Ue.from("document_ledger_labels").update({name:O}).eq("id",L).select().single();if(F)throw F;return a(V=>V.map(oe=>oe.id===L?P:oe)),u?.id===L&&d(P),{success:!0,data:P}}catch(P){return y(P.message),console.error("  :",P),{success:!1,error:P.message}}finally{m(!1)}},_=async L=>{try{m(!0);const{error:O}=await Ue.from("document_ledger_labels").delete().eq("id",L);if(O)throw O;if(a(P=>P.filter(F=>F.id!==L)),u?.id===L){const P=s.filter(F=>F.id!==L);d(P.length>0?P[0]:null)}return{success:!0}}catch(O){return y(O.message),console.error("  :",O),{success:!1,error:O.message}}finally{m(!1)}},b=Y.useCallback(async L=>{if(L)try{m(!0);const{data:O,error:P}=await Ue.from("document_ledger").select("*").eq("label_id",L).order("row_number",{ascending:!0});if(P)throw P;c(O||[])}catch(O){y(O.message),console.error("   :",O)}finally{m(!1)}},[]),N=async L=>{try{m(!0);const{data:O,error:P}=await Ue.from("document_ledger").insert([L]).select().single();if(P)throw P;return c(F=>[...F,O].sort((V,oe)=>V.row_number-oe.row_number)),{success:!0,data:O}}catch(O){return y(O.message),console.error("  :",O),{success:!1,error:O.message}}finally{m(!1)}},S=async(L,O)=>{try{m(!0);const{data:P,error:F}=await Ue.from("document_ledger").update(O).eq("id",L).select().single();if(F)throw F;return c(V=>V.map(oe=>oe.id===L?P:oe)),{success:!0,data:P}}catch(P){return y(P.message),console.error("  :",P),{success:!1,error:P.message}}finally{m(!1)}},E=async L=>{try{m(!0);const{error:O}=await Ue.from("document_ledger").delete().eq("id",L);if(O)throw O;const P=o.filter(V=>V.id!==L).sort((V,oe)=>V.row_number-oe.row_number),F=P.map((V,oe)=>({id:V.id,row_number:oe+1}));for(const V of F)V.row_number!==P.find(oe=>oe.id===V.id)?.row_number&&await Ue.from("document_ledger").update({row_number:V.row_number}).eq("id",V.id);return c(P.map((V,oe)=>({...V,row_number:oe+1}))),{success:!0}}catch(O){return y(O.message),console.error("  :",O),{success:!1,error:O.message}}finally{m(!1)}},R=()=>o.length===0?1:Math.max(...o.map(L=>L.row_number))+1;return Y.useEffect(()=>{e&&v()},[e?.team,t,r]),Y.useEffect(()=>{u?.id&&b(u.id)},[u?.id,b]),{labels:s,ledgerData:o,selectedLabel:u,loading:h,error:x,setSelectedLabel:d,addLabel:w,updateLabel:g,deleteLabel:_,fetchLabels:v,fetchLedgerData:b,addLedgerItem:N,updateLedgerItem:S,deleteLedgerItem:E,getNextRowNumber:R}}var N0={};N0.version="0.18.5";var yT=1252,iU=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],pv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},xv=function(e){iU.indexOf(e)!=-1&&(yT=pv[0]=e)};function oU(){xv(1252)}var Sn=function(e){xv(e)};function gv(){Sn(1200),oU()}function lE(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function lU(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function vT(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Qu=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?lU(e.slice(2)):t==254&&r==255?vT(e.slice(2)):t==65279?e.slice(1):e},Uh=function(t){return String.fromCharCode(t)},cE=function(t){return String.fromCharCode(t)},Ed,ro="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function jd(e){for(var t="",r=0,s=0,a=0,o=0,c=0,u=0,d=0,h=0;h<e.length;)r=e.charCodeAt(h++),o=r>>2,s=e.charCodeAt(h++),c=(r&3)<<4|s>>4,a=e.charCodeAt(h++),u=(s&15)<<2|a>>6,d=a&63,isNaN(s)?u=d=64:isNaN(a)&&(d=64),t+=ro.charAt(o)+ro.charAt(c)+ro.charAt(u)+ro.charAt(d);return t}function qa(e){var t="",r=0,s=0,a=0,o=0,c=0,u=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=ro.indexOf(e.charAt(h++)),c=ro.indexOf(e.charAt(h++)),r=o<<2|c>>4,t+=String.fromCharCode(r),u=ro.indexOf(e.charAt(h++)),s=(c&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(s)),d=ro.indexOf(e.charAt(h++)),a=(u&3)<<6|d,d!==64&&(t+=String.fromCharCode(a));return t}var ir=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ni=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function io(e){return ir?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function uE(e){return ir?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ba=function(t){return ir?Ni(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function tm(e){if(typeof ArrayBuffer>"u")return Ba(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function mo(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function cU(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function yv(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return yv(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ls=ir?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ni(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function uU(e){for(var t=[],r=0,s=e.length+250,a=io(e.length+255),o=0;o<e.length;++o){var c=e.charCodeAt(o);if(c<128)a[r++]=c;else if(c<2048)a[r++]=192|c>>6&31,a[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++o)&1023;a[r++]=240|c>>8&7,a[r++]=128|c>>2&63,a[r++]=128|u>>6&15|(c&3)<<4,a[r++]=128|u&63}else a[r++]=224|c>>12&15,a[r++]=128|c>>6&63,a[r++]=128|c&63;r>s&&(t.push(a.slice(0,r)),r=0,a=io(65535),s=65530)}return t.push(a.slice(0,r)),Ls(t)}var ma=/\u0000/g,ed=/[\u0001-\u0006]/g;function jc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function kn(e,t){var r=""+e;return r.length>=t?r:as("0",t-r.length)+r}function vv(e,t){var r=""+e;return r.length>=t?r:as(" ",t-r.length)+r}function E0(e,t){var r=""+e;return r.length>=t?r:r+as(" ",t-r.length)}function dU(e,t){var r=""+Math.round(e);return r.length>=t?r:as("0",t-r.length)+r}function fU(e,t){var r=""+e;return r.length>=t?r:as("0",t-r.length)+r}var dE=Math.pow(2,32);function uc(e,t){if(e>dE||e<-dE)return dU(e,t);var r=Math.round(e);return fU(r,t)}function j0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var fE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],L1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function hU(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Gt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},hE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},mU={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function T0(e,t,r){for(var s=e<0?-1:1,a=e*s,o=0,c=1,u=0,d=1,h=0,m=0,x=Math.floor(a);h<t&&(x=Math.floor(a),u=x*c+o,m=x*h+d,!(a-x<5e-8));)a=1/(a-x),o=c,c=u,d=h,h=m;if(m>t&&(h>t?(m=d,u=o):(m=h,u=c)),!r)return[0,s*u,m];var y=Math.floor(s*u/m);return[y,s*u-y*m,m]}function Yo(e,t,r){if(e>2958465||e<0)return null;var s=e|0,a=Math.floor(86400*(e-s)),o=0,c=[],u={D:s,T:a,u:86400*(e-s)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(s+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++s,++u.D)),s===60)c=r?[1317,10,29]:[1900,2,29],o=3;else if(s===0)c=r?[1317,8,29]:[1900,1,0],o=6;else{s>60&&--s;var d=new Date(1900,0,1);d.setDate(d.getDate()+s-1),c=[d.getFullYear(),d.getMonth()+1,d.getDate()],o=d.getDay(),s<60&&(o=(o+6)%7),r&&(o=wU(d,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var wT=new Date(1899,11,31,0,0,0),pU=wT.getTime(),xU=new Date(1900,2,1,0,0,0);function bT(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=xU&&(r+=1440*60*1e3),(r-(pU+(e.getTimezoneOffset()-wT.getTimezoneOffset())*6e4))/(1440*60*1e3)}function wv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function gU(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yU(e){var t=e<0?12:11,r=wv(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function vU(e){var t=wv(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Td(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=yU(e):t===10?r=e.toFixed(10).substr(0,12):r=vU(e),wv(gU(r.toUpperCase()))}function ol(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Td(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return fn(14,bT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function wU(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function bU(e,t,r,s){var a="",o=0,c=0,u=r.y,d,h=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:d=u%100,h=2;break;default:d=u%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,h=t.length;break;case 3:return L1[r.m-1][1];case 5:return L1[r.m-1][0];default:return L1[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,h=t.length;break;case 3:return fE[r.q][0];default:return fE[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?kn(r.S,t.length):(s>=2?c=s===3?1e3:100:c=s===1?10:1,o=Math.round(c*(r.S+r.u)),o>=60*c&&(o=0),t==="s"?o===0?"0":""+o/c:(a=kn(o,2+s),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:d=u,h=1;break}var m=h>0?kn(d,h):"";return m}function so(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var _T=/%/g;function _U(e,t,r){var s=t.replace(_T,""),a=t.length-s.length;return mi(e,s,r*Math.pow(10,2*a))+as("%",a)}function SU(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return mi(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function ST(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ST(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(t/Math.pow(10,o)).toPrecision(s+1+(a+o)%a),r.indexOf("e")===-1){var c=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+o):r+="E+"+(c-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,h,m){return d+h+m.substr(0,(a+o)%a)+"."+m.substr(o)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var kT=/# (\?+)( ?)\/( ?)(\d+)/;function kU(e,t,r){var s=parseInt(e[4],10),a=Math.round(t*s),o=Math.floor(a/s),c=a-o*s,u=s;return r+(o===0?"":""+o)+" "+(c===0?as(" ",e[1].length+1+e[4].length):vv(c,e[1].length)+e[2]+"/"+e[3]+kn(u,e[4].length))}function NU(e,t,r){return r+(t===0?"":""+t)+as(" ",e[1].length+2+e[4].length)}var NT=/^#*0*\.([0#]+)/,ET=/\).*[0#]/,jT=/\(###\) ###\\?-####/;function da(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function mE(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function pE(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function EU(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function jU(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function an(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ET)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?an("n",s,r):"("+an("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return SU(e,t,r);if(t.indexOf("%")!==-1)return _U(e,t,r);if(t.indexOf("E")!==-1)return ST(t,r);if(t.charCodeAt(0)===36)return"$"+an(e,t.substr(t.charAt(1)==" "?2:1),r);var a,o,c,u,d=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+uc(d,t.length);if(t.match(/^[#?]+$/))return a=uc(r,0),a==="0"&&(a=""),a.length>t.length?a:da(t.substr(0,t.length-a.length))+a;if(o=t.match(kT))return kU(o,d,h);if(t.match(/^#+0+$/))return h+uc(d,t.length-t.indexOf("0"));if(o=t.match(NT))return a=mE(r,o[1].length).replace(/^([^\.]+)$/,"$1."+da(o[1])).replace(/\.$/,"."+da(o[1])).replace(/\.(\d*)$/,function(w,g){return"."+g+as("0",da(o[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return h+mE(d,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return h+so(uc(d,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+an(e,t,-r):so(""+(Math.floor(r)+EU(r,o[1].length)))+"."+kn(pE(r,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return an(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=jc(an(e,t.replace(/[\\-]/g,""),r)),c=0,jc(jc(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return c<a.length?a.charAt(c++):w==="0"?"0":""}));if(t.match(jT))return a=an(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=T0(d,Math.pow(10,c)-1,!1),a=""+h,m=mi("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+o[2]+"/"+o[3],m=E0(u[2],c),m.length<o[4].length&&(m=da(o[4].substr(o[4].length-m.length))+m),a+=m,a;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=T0(d,Math.pow(10,c)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?vv(u[1],c)+o[2]+"/"+o[3]+E0(u[2],c):as(" ",2*c+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return a=uc(r,0),t.length<=a.length?a:da(t.substr(0,t.length-a.length))+a;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var x=t.indexOf(".")-c,y=t.length-a.length-x;return da(t.substr(0,x)+a+t.substr(t.length-y))}if(o=t.match(/^00,000\.([#0]*0)$/))return c=pE(r,o[1].length),r<0?"-"+an(e,t,-r):so(jU(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?kn(0,3-w.length):"")+w})+"."+kn(c,o[1].length);switch(t){case"###,##0.00":return an(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=so(uc(d,0));return v!=="0"?h+v:"";case"###,###.00":return an(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return an(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function TU(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return mi(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function AU(e,t,r){var s=t.replace(_T,""),a=t.length-s.length;return mi(e,s,r*Math.pow(10,2*a))+as("%",a)}function TT(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+TT(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(t/Math.pow(10,o)).toPrecision(s+1+(a+o)%a),!r.match(/[Ee]/)){var c=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+o):r+="E+"+(c-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,h,m){return d+h+m.substr(0,(a+o)%a)+"."+m.substr(o)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function On(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ET)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?On("n",s,r):"("+On("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return TU(e,t,r);if(t.indexOf("%")!==-1)return AU(e,t,r);if(t.indexOf("E")!==-1)return TT(t,r);if(t.charCodeAt(0)===36)return"$"+On(e,t.substr(t.charAt(1)==" "?2:1),r);var a,o,c,u,d=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+kn(d,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:da(t.substr(0,t.length-a.length))+a;if(o=t.match(kT))return NU(o,d,h);if(t.match(/^#+0+$/))return h+kn(d,t.length-t.indexOf("0"));if(o=t.match(NT))return a=(""+r).replace(/^([^\.]+)$/,"$1."+da(o[1])).replace(/\.$/,"."+da(o[1])),a=a.replace(/\.(\d*)$/,function(w,g){return"."+g+as("0",da(o[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return h+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return h+so(""+d);if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+On(e,t,-r):so(""+r)+"."+as("0",o[1].length);if(o=t.match(/^#,#*,#0/))return On(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=jc(On(e,t.replace(/[\\-]/g,""),r)),c=0,jc(jc(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return c<a.length?a.charAt(c++):w==="0"?"0":""}));if(t.match(jT))return a=On(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=T0(d,Math.pow(10,c)-1,!1),a=""+h,m=mi("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+o[2]+"/"+o[3],m=E0(u[2],c),m.length<o[4].length&&(m=da(o[4].substr(o[4].length-m.length))+m),a+=m,a;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=T0(d,Math.pow(10,c)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?vv(u[1],c)+o[2]+"/"+o[3]+E0(u[2],c):as(" ",2*c+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:da(t.substr(0,t.length-a.length))+a;if(o=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var x=t.indexOf(".")-c,y=t.length-a.length-x;return da(t.substr(0,x)+a+t.substr(t.length-y))}if(o=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+On(e,t,-r):so(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?kn(0,3-w.length):"")+w})+"."+kn(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=so(""+d);return v!=="0"?h+v:"";default:if(t.match(/\.[0#?]*$/))return On(e,t.slice(0,t.lastIndexOf(".")),r)+da(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function mi(e,t,r){return(r|0)===r?On(e,t,r):an(e,t,r)}function CU(e){for(var t=[],r=!1,s=0,a=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(a,s-a),a=s+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var AT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Kc(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":j0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(AT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function RU(e,t,r,s){for(var a=[],o="",c=0,u="",d="t",h,m,x,y="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!j0(e,c))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";(x=e.charCodeAt(++c))!==34&&c<e.length;)o+=String.fromCharCode(x);a[a.length]={t:"t",v:o},++c;break;case"\\":var v=e.charAt(++c),w=v==="("||v===")"?v:"t";a[a.length]={t:w,v},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:t},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(h==null&&(h=Yo(t,r,e.charAt(c+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=Yo(t,r),h==null))return"";for(o=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)o+=u;u==="m"&&d.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),a[a.length]={t:u,v:o},d=u;break;case"A":case"a":case"":var g={t:u,v:u};if(h==null&&(h=Yo(t,r)),e.substr(c,3).toUpperCase()==="A/P"?(h!=null&&(g.v=h.H>=12?"P":"A"),g.t="T",y="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(h!=null&&(g.v=h.H>=12?"PM":"AM"),g.t="T",c+=5,y="h"):e.substr(c,5).toUpperCase()==="/"?(h!=null&&(g.v=h.H>=12?"":""),g.t="T",c+=5,y="h"):(g.t="t",++c),h==null&&g.t==="T")return"";a[a.length]=g,d=u;break;case"[":for(o=u;e.charAt(c++)!=="]"&&c<e.length;)o+=e.charAt(c);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(AT)){if(h==null&&(h=Yo(t,r),h==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},d=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Kc(e)||(a[a.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=u;++c<e.length&&(u=e.charAt(c))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;e.charAt(++c)===u;)o+=u;a[a.length]={t:u,v:o},d=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":a[a.length]={t:s===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)o+=e.charAt(c);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++c;break}var _=0,b=0,N;for(c=a.length-1,d="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=y,d="h",_<1&&(_=1);break;case"s":(N=a[c].v.match(/\.0+$/))&&(b=Math.max(b,N[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":d=a[c].t;break;case"m":d==="s"&&(a[c].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[c].v.match(/[Hh]/)&&(_=1),_<2&&a[c].v.match(/[Mm]/)&&(_=2),_<3&&a[c].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var S="",E;for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=bU(a[c].t.charCodeAt(0),a[c].v,h,b),a[c].t="t";break;case"n":case"?":for(E=c+1;a[E]!=null&&((u=a[E].t)==="?"||u==="D"||(u===" "||u==="t")&&a[E+1]!=null&&(a[E+1].t==="?"||a[E+1].t==="t"&&a[E+1].v==="/")||a[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[E].v==="/"||a[E].v===" "&&a[E+1]!=null&&a[E+1].t=="?"));)a[c].v+=a[E].v,a[E]={v:"",t:";"},++E;S+=a[c].v,c=E-1;break;case"G":a[c].t="t",a[c].v=ol(t,r);break}var R="",L,O;if(S.length>0){S.charCodeAt(0)==40?(L=t<0&&S.charCodeAt(0)===45?-t:t,O=mi("n",S,L)):(L=t<0&&s>1?-t:t,O=mi("n",S,L),L<0&&a[0]&&a[0].t=="t"&&(O=O.substr(1),a[0].v="-"+a[0].v)),E=O.length-1;var P=a.length;for(c=0;c<a.length;++c)if(a[c]!=null&&a[c].t!="t"&&a[c].v.indexOf(".")>-1){P=c;break}var F=a.length;if(P===a.length&&O.indexOf("E")===-1){for(c=a.length-1;c>=0;--c)a[c]==null||"n?".indexOf(a[c].t)===-1||(E>=a[c].v.length-1?(E-=a[c].v.length,a[c].v=O.substr(E+1,a[c].v.length)):E<0?a[c].v="":(a[c].v=O.substr(0,E+1),E=-1),a[c].t="t",F=c);E>=0&&F<a.length&&(a[F].v=O.substr(0,E+1)+a[F].v)}else if(P!==a.length&&O.indexOf("E")===-1){for(E=O.indexOf(".")-1,c=P;c>=0;--c)if(!(a[c]==null||"n?".indexOf(a[c].t)===-1)){for(m=a[c].v.indexOf(".")>-1&&c===P?a[c].v.indexOf(".")-1:a[c].v.length-1,R=a[c].v.substr(m+1);m>=0;--m)E>=0&&(a[c].v.charAt(m)==="0"||a[c].v.charAt(m)==="#")&&(R=O.charAt(E--)+R);a[c].v=R,a[c].t="t",F=c}for(E>=0&&F<a.length&&(a[F].v=O.substr(0,E+1)+a[F].v),E=O.indexOf(".")+1,c=P;c<a.length;++c)if(!(a[c]==null||"n?(".indexOf(a[c].t)===-1&&c!==P)){for(m=a[c].v.indexOf(".")>-1&&c===P?a[c].v.indexOf(".")+1:0,R=a[c].v.substr(0,m);m<a[c].v.length;++m)E<O.length&&(R+=O.charAt(E++));a[c].v=R,a[c].t="t",F=c}}}for(c=0;c<a.length;++c)a[c]!=null&&"n?".indexOf(a[c].t)>-1&&(L=s>1&&t<0&&c>0&&a[c-1].v==="-"?-t:t,a[c].v=mi(a[c].t,a[c].v,L),a[c].t="t");var V="";for(c=0;c!==a.length;++c)a[c]!=null&&(V+=a[c].v);return V}var xE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function gE(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function DU(e,t){var r=CU(e),s=r.length,a=r[s-1].indexOf("@");if(s<4&&a>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(xE),u=r[1].match(xE);return gE(t,c)?[s,r[0]]:gE(t,u)?[s,r[1]]:[s,r[c!=null&&u!=null?2:1]]}return[s,o]}function fn(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:Gt)[e],s==null&&(s=r.table&&r.table[hE[e]]||Gt[hE[e]]),s==null&&(s=mU[e]||"General");break}if(j0(s,0))return ol(t,r);t instanceof Date&&(t=bT(t,r.date1904));var a=DU(s,t);if(j0(a[1]))return ol(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return RU(a[1],t,r,a[0])}function pi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Gt[r]==null){t<0&&(t=r);continue}if(Gt[r]==e){t=r;break}}t<0&&(t=391)}return Gt[t]=e,t}function rm(e){for(var t=0;t!=392;++t)e[t]!==void 0&&pi(e[t],t)}function Xc(){Gt=hU()}var OU={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},CT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function FU(e){var t=typeof e=="number"?Gt[e]:e;return t=t.replace(CT,"(\\d+)"),new RegExp("^"+t+"$")}function LU(e,t,r){var s=-1,a=-1,o=-1,c=-1,u=-1,d=-1;(t.match(CT)||[]).forEach(function(x,y){var v=parseInt(r[y+1],10);switch(x.toLowerCase().charAt(0)){case"y":s=v;break;case"d":o=v;break;case"h":c=v;break;case"s":d=v;break;case"m":c>=0?u=v:a=v;break}}),d>=0&&u==-1&&a>=0&&(u=a,a=-1);var h=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var m=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return c==-1&&u==-1&&d==-1?h:s==-1&&a==-1&&o==-1?m:h+"T"+m}var IU=(function(){var e={};e.version="1.2.0";function t(){for(var O=0,P=new Array(256),F=0;F!=256;++F)O=F,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,P[F]=O;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function s(O){var P=0,F=0,V=0,oe=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)oe[V]=O[V];for(V=0;V!=256;++V)for(F=O[V],P=256+V;P<4096;P+=256)F=oe[P]=F>>>8^O[F&255];var D=[];for(V=1;V!=16;++V)D[V-1]=typeof Int32Array<"u"?oe.subarray(V*256,V*256+256):oe.slice(V*256,V*256+256);return D}var a=s(r),o=a[0],c=a[1],u=a[2],d=a[3],h=a[4],m=a[5],x=a[6],y=a[7],v=a[8],w=a[9],g=a[10],_=a[11],b=a[12],N=a[13],S=a[14];function E(O,P){for(var F=P^-1,V=0,oe=O.length;V<oe;)F=F>>>8^r[(F^O.charCodeAt(V++))&255];return~F}function R(O,P){for(var F=P^-1,V=O.length-15,oe=0;oe<V;)F=S[O[oe++]^F&255]^N[O[oe++]^F>>8&255]^b[O[oe++]^F>>16&255]^_[O[oe++]^F>>>24]^g[O[oe++]]^w[O[oe++]]^v[O[oe++]]^y[O[oe++]]^x[O[oe++]]^m[O[oe++]]^h[O[oe++]]^d[O[oe++]]^u[O[oe++]]^c[O[oe++]]^o[O[oe++]]^r[O[oe++]];for(V+=15;oe<V;)F=F>>>8^r[(F^O[oe++])&255];return~F}function L(O,P){for(var F=P^-1,V=0,oe=O.length,D=0,K=0;V<oe;)D=O.charCodeAt(V++),D<128?F=F>>>8^r[(F^D)&255]:D<2048?(F=F>>>8^r[(F^(192|D>>6&31))&255],F=F>>>8^r[(F^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,K=O.charCodeAt(V++)&1023,F=F>>>8^r[(F^(240|D>>8&7))&255],F=F>>>8^r[(F^(128|D>>2&63))&255],F=F>>>8^r[(F^(128|K>>6&15|(D&3)<<4))&255],F=F>>>8^r[(F^(128|K&63))&255]):(F=F>>>8^r[(F^(224|D>>12&15))&255],F=F>>>8^r[(F^(128|D>>6&63))&255],F=F>>>8^r[(F^(128|D&63))&255]);return~F}return e.table=r,e.bstr=E,e.buf=R,e.str=L,e})(),zt=(function(){var t={};t.version="1.2.1";function r(fe,_e){for(var ge=fe.split("/"),ye=_e.split("/"),Se=0,ke=0,$e=Math.min(ge.length,ye.length);Se<$e;++Se){if(ke=ge[Se].length-ye[Se].length)return ke;if(ge[Se]!=ye[Se])return ge[Se]<ye[Se]?-1:1}return ge.length-ye.length}function s(fe){if(fe.charAt(fe.length-1)=="/")return fe.slice(0,-1).indexOf("/")===-1?fe:s(fe.slice(0,-1));var _e=fe.lastIndexOf("/");return _e===-1?fe:fe.slice(0,_e+1)}function a(fe){if(fe.charAt(fe.length-1)=="/")return a(fe.slice(0,-1));var _e=fe.lastIndexOf("/");return _e===-1?fe:fe.slice(_e+1)}function o(fe,_e){typeof _e=="string"&&(_e=new Date(_e));var ge=_e.getHours();ge=ge<<6|_e.getMinutes(),ge=ge<<5|_e.getSeconds()>>>1,fe.write_shift(2,ge);var ye=_e.getFullYear()-1980;ye=ye<<4|_e.getMonth()+1,ye=ye<<5|_e.getDate(),fe.write_shift(2,ye)}function c(fe){var _e=fe.read_shift(2)&65535,ge=fe.read_shift(2)&65535,ye=new Date,Se=ge&31;ge>>>=5;var ke=ge&15;ge>>>=4,ye.setMilliseconds(0),ye.setFullYear(ge+1980),ye.setMonth(ke-1),ye.setDate(Se);var $e=_e&31;_e>>>=5;var at=_e&63;return _e>>>=6,ye.setHours(_e),ye.setMinutes(at),ye.setSeconds($e<<1),ye}function u(fe){Vs(fe,0);for(var _e={},ge=0;fe.l<=fe.length-4;){var ye=fe.read_shift(2),Se=fe.read_shift(2),ke=fe.l+Se,$e={};ye===21589&&(ge=fe.read_shift(1),ge&1&&($e.mtime=fe.read_shift(4)),Se>5&&(ge&2&&($e.atime=fe.read_shift(4)),ge&4&&($e.ctime=fe.read_shift(4))),$e.mtime&&($e.mt=new Date($e.mtime*1e3))),fe.l=ke,_e[ye]=$e}return _e}var d;function h(){return d||(d={})}function m(fe,_e){if(fe[0]==80&&fe[1]==75)return Je(fe,_e);if((fe[0]|32)==109&&(fe[1]|32)==105)return Et(fe,_e);if(fe.length<512)throw new Error("CFB file size "+fe.length+" < 512");var ge=3,ye=512,Se=0,ke=0,$e=0,at=0,He=0,Ge=[],Ve=fe.slice(0,512);Vs(Ve,0);var ht=x(Ve);switch(ge=ht[0],ge){case 3:ye=512;break;case 4:ye=4096;break;case 0:if(ht[1]==0)return Je(fe,_e);default:throw new Error("Major Version: Expected 3 or 4 saw "+ge)}ye!==512&&(Ve=fe.slice(0,ye),Vs(Ve,28));var vt=fe.slice(0,ye);y(Ve,ge);var Nt=Ve.read_shift(4,"i");if(ge===3&&Nt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Nt);Ve.l+=4,$e=Ve.read_shift(4,"i"),Ve.l+=4,Ve.chk("00100000","Mini Stream Cutoff Size: "),at=Ve.read_shift(4,"i"),Se=Ve.read_shift(4,"i"),He=Ve.read_shift(4,"i"),ke=Ve.read_shift(4,"i");for(var gt=-1,me=0;me<109&&(gt=Ve.read_shift(4,"i"),!(gt<0));++me)Ge[me]=gt;var Ie=v(fe,ye);_(He,ke,Ie,ye,Ge);var _t=N(Ie,$e,Ge,ye);_t[$e].name="!Directory",Se>0&&at!==K&&(_t[at].name="!MiniFAT"),_t[Ge[0]].name="!FAT",_t.fat_addrs=Ge,_t.ssz=ye;var bt={},qt=[],Br=[],cs=[];S($e,_t,Ie,qt,Se,bt,Br,at),w(Br,cs,qt),qt.shift();var us={FileIndex:Br,FullPaths:cs};return _e&&_e.raw&&(us.raw={header:vt,sectors:Ie}),us}function x(fe){if(fe[fe.l]==80&&fe[fe.l+1]==75)return[0,0];fe.chk(M,"Header Signature: "),fe.l+=16;var _e=fe.read_shift(2,"u");return[fe.read_shift(2,"u"),_e]}function y(fe,_e){var ge=9;switch(fe.l+=2,ge=fe.read_shift(2)){case 9:if(_e!=3)throw new Error("Sector Shift: Expected 9 saw "+ge);break;case 12:if(_e!=4)throw new Error("Sector Shift: Expected 12 saw "+ge);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ge)}fe.chk("0600","Mini Sector Shift: "),fe.chk("000000000000","Reserved: ")}function v(fe,_e){for(var ge=Math.ceil(fe.length/_e)-1,ye=[],Se=1;Se<ge;++Se)ye[Se-1]=fe.slice(Se*_e,(Se+1)*_e);return ye[ge-1]=fe.slice(ge*_e),ye}function w(fe,_e,ge){for(var ye=0,Se=0,ke=0,$e=0,at=0,He=ge.length,Ge=[],Ve=[];ye<He;++ye)Ge[ye]=Ve[ye]=ye,_e[ye]=ge[ye];for(;at<Ve.length;++at)ye=Ve[at],Se=fe[ye].L,ke=fe[ye].R,$e=fe[ye].C,Ge[ye]===ye&&(Se!==-1&&Ge[Se]!==Se&&(Ge[ye]=Ge[Se]),ke!==-1&&Ge[ke]!==ke&&(Ge[ye]=Ge[ke])),$e!==-1&&(Ge[$e]=ye),Se!==-1&&ye!=Ge[ye]&&(Ge[Se]=Ge[ye],Ve.lastIndexOf(Se)<at&&Ve.push(Se)),ke!==-1&&ye!=Ge[ye]&&(Ge[ke]=Ge[ye],Ve.lastIndexOf(ke)<at&&Ve.push(ke));for(ye=1;ye<He;++ye)Ge[ye]===ye&&(ke!==-1&&Ge[ke]!==ke?Ge[ye]=Ge[ke]:Se!==-1&&Ge[Se]!==Se&&(Ge[ye]=Ge[Se]));for(ye=1;ye<He;++ye)if(fe[ye].type!==0){if(at=ye,at!=Ge[at])do at=Ge[at],_e[ye]=_e[at]+"/"+_e[ye];while(at!==0&&Ge[at]!==-1&&at!=Ge[at]);Ge[ye]=-1}for(_e[0]+="/",ye=1;ye<He;++ye)fe[ye].type!==2&&(_e[ye]+="/")}function g(fe,_e,ge){for(var ye=fe.start,Se=fe.size,ke=[],$e=ye;ge&&Se>0&&$e>=0;)ke.push(_e.slice($e*D,$e*D+D)),Se-=D,$e=Wo(ge,$e*4);return ke.length===0?it(0):Ls(ke).slice(0,fe.size)}function _(fe,_e,ge,ye,Se){var ke=K;if(fe===K){if(_e!==0)throw new Error("DIFAT chain shorter than expected")}else if(fe!==-1){var $e=ge[fe],at=(ye>>>2)-1;if(!$e)return;for(var He=0;He<at&&(ke=Wo($e,He*4))!==K;++He)Se.push(ke);_(Wo($e,ye-4),_e-1,ge,ye,Se)}}function b(fe,_e,ge,ye,Se){var ke=[],$e=[];Se||(Se=[]);var at=ye-1,He=0,Ge=0;for(He=_e;He>=0;){Se[He]=!0,ke[ke.length]=He,$e.push(fe[He]);var Ve=ge[Math.floor(He*4/ye)];if(Ge=He*4&at,ye<4+Ge)throw new Error("FAT boundary crossed: "+He+" 4 "+ye);if(!fe[Ve])break;He=Wo(fe[Ve],Ge)}return{nodes:ke,data:AE([$e])}}function N(fe,_e,ge,ye){var Se=fe.length,ke=[],$e=[],at=[],He=[],Ge=ye-1,Ve=0,ht=0,vt=0,Nt=0;for(Ve=0;Ve<Se;++Ve)if(at=[],vt=Ve+_e,vt>=Se&&(vt-=Se),!$e[vt]){He=[];var gt=[];for(ht=vt;ht>=0;){gt[ht]=!0,$e[ht]=!0,at[at.length]=ht,He.push(fe[ht]);var me=ge[Math.floor(ht*4/ye)];if(Nt=ht*4&Ge,ye<4+Nt)throw new Error("FAT boundary crossed: "+ht+" 4 "+ye);if(!fe[me]||(ht=Wo(fe[me],Nt),gt[ht]))break}ke[vt]={nodes:at,data:AE([He])}}return ke}function S(fe,_e,ge,ye,Se,ke,$e,at){for(var He=0,Ge=ye.length?2:0,Ve=_e[fe].data,ht=0,vt=0,Nt;ht<Ve.length;ht+=128){var gt=Ve.slice(ht,ht+128);Vs(gt,64),vt=gt.read_shift(2),Nt=jv(gt,0,vt-Ge),ye.push(Nt);var me={name:Nt,type:gt.read_shift(1),color:gt.read_shift(1),L:gt.read_shift(4,"i"),R:gt.read_shift(4,"i"),C:gt.read_shift(4,"i"),clsid:gt.read_shift(16),state:gt.read_shift(4,"i"),start:0,size:0},Ie=gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2);Ie!==0&&(me.ct=E(gt,gt.l-8));var _t=gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2)+gt.read_shift(2);_t!==0&&(me.mt=E(gt,gt.l-8)),me.start=gt.read_shift(4,"i"),me.size=gt.read_shift(4,"i"),me.size<0&&me.start<0&&(me.size=me.type=0,me.start=K,me.name=""),me.type===5?(He=me.start,Se>0&&He!==K&&(_e[He].name="!StreamData")):me.size>=4096?(me.storage="fat",_e[me.start]===void 0&&(_e[me.start]=b(ge,me.start,_e.fat_addrs,_e.ssz)),_e[me.start].name=me.name,me.content=_e[me.start].data.slice(0,me.size)):(me.storage="minifat",me.size<0?me.size=0:He!==K&&me.start!==K&&_e[He]&&(me.content=g(me,_e[He].data,(_e[at]||{}).data))),me.content&&Vs(me.content,0),ke[Nt]=me,$e.push(me)}}function E(fe,_e){return new Date((Ia(fe,_e+4)/1e7*Math.pow(2,32)+Ia(fe,_e)/1e7-11644473600)*1e3)}function R(fe,_e){return h(),m(d.readFileSync(fe),_e)}function L(fe,_e){var ge=_e&&_e.type;switch(ge||ir&&Buffer.isBuffer(fe)&&(ge="buffer"),ge||"base64"){case"file":return R(fe,_e);case"base64":return m(Ba(qa(fe)),_e);case"binary":return m(Ba(fe),_e)}return m(fe,_e)}function O(fe,_e){var ge=_e||{},ye=ge.root||"Root Entry";if(fe.FullPaths||(fe.FullPaths=[]),fe.FileIndex||(fe.FileIndex=[]),fe.FullPaths.length!==fe.FileIndex.length)throw new Error("inconsistent CFB structure");fe.FullPaths.length===0&&(fe.FullPaths[0]=ye+"/",fe.FileIndex[0]={name:ye,type:5}),ge.CLSID&&(fe.FileIndex[0].clsid=ge.CLSID),P(fe)}function P(fe){var _e="Sh33tJ5";if(!zt.find(fe,"/"+_e)){var ge=it(4);ge[0]=55,ge[1]=ge[3]=50,ge[2]=54,fe.FileIndex.push({name:_e,type:2,content:ge,size:4,L:69,R:69,C:69}),fe.FullPaths.push(fe.FullPaths[0]+_e),F(fe)}}function F(fe,_e){O(fe);for(var ge=!1,ye=!1,Se=fe.FullPaths.length-1;Se>=0;--Se){var ke=fe.FileIndex[Se];switch(ke.type){case 0:ye?ge=!0:(fe.FileIndex.pop(),fe.FullPaths.pop());break;case 1:case 2:case 5:ye=!0,isNaN(ke.R*ke.L*ke.C)&&(ge=!0),ke.R>-1&&ke.L>-1&&ke.R==ke.L&&(ge=!0);break;default:ge=!0;break}}if(!(!ge&&!_e)){var $e=new Date(1987,1,19),at=0,He=Object.create?Object.create(null):{},Ge=[];for(Se=0;Se<fe.FullPaths.length;++Se)He[fe.FullPaths[Se]]=!0,fe.FileIndex[Se].type!==0&&Ge.push([fe.FullPaths[Se],fe.FileIndex[Se]]);for(Se=0;Se<Ge.length;++Se){var Ve=s(Ge[Se][0]);ye=He[Ve],ye||(Ge.push([Ve,{name:a(Ve).replace("/",""),type:1,clsid:te,ct:$e,mt:$e,content:null}]),He[Ve]=!0)}for(Ge.sort(function(Nt,gt){return r(Nt[0],gt[0])}),fe.FullPaths=[],fe.FileIndex=[],Se=0;Se<Ge.length;++Se)fe.FullPaths[Se]=Ge[Se][0],fe.FileIndex[Se]=Ge[Se][1];for(Se=0;Se<Ge.length;++Se){var ht=fe.FileIndex[Se],vt=fe.FullPaths[Se];if(ht.name=a(vt).replace("/",""),ht.L=ht.R=ht.C=-(ht.color=1),ht.size=ht.content?ht.content.length:0,ht.start=0,ht.clsid=ht.clsid||te,Se===0)ht.C=Ge.length>1?1:-1,ht.size=0,ht.type=5;else if(vt.slice(-1)=="/"){for(at=Se+1;at<Ge.length&&s(fe.FullPaths[at])!=vt;++at);for(ht.C=at>=Ge.length?-1:at,at=Se+1;at<Ge.length&&s(fe.FullPaths[at])!=s(vt);++at);ht.R=at>=Ge.length?-1:at,ht.type=1}else s(fe.FullPaths[Se+1]||"")==s(vt)&&(ht.R=Se+1),ht.type=2}}}function V(fe,_e){var ge=_e||{};if(ge.fileType=="mad")return Xt(fe,ge);if(F(fe),ge.fileType==="zip")return Pe(fe,ge);var ye=(function(Nt){for(var gt=0,me=0,Ie=0;Ie<Nt.FileIndex.length;++Ie){var _t=Nt.FileIndex[Ie];if(_t.content){var bt=_t.content.length;bt>0&&(bt<4096?gt+=bt+63>>6:me+=bt+511>>9)}}for(var qt=Nt.FullPaths.length+3>>2,Br=gt+7>>3,cs=gt+127>>7,us=Br+me+qt+cs,Ha=us+127>>7,go=Ha<=109?0:Math.ceil((Ha-109)/127);us+Ha+go+127>>7>Ha;)go=++Ha<=109?0:Math.ceil((Ha-109)/127);var Ys=[1,go,Ha,cs,qt,me,gt,0];return Nt.FileIndex[0].size=gt<<6,Ys[7]=(Nt.FileIndex[0].start=Ys[0]+Ys[1]+Ys[2]+Ys[3]+Ys[4]+Ys[5])+(Ys[6]+7>>3),Ys})(fe),Se=it(ye[7]<<9),ke=0,$e=0;{for(ke=0;ke<8;++ke)Se.write_shift(1,ae[ke]);for(ke=0;ke<8;++ke)Se.write_shift(2,0);for(Se.write_shift(2,62),Se.write_shift(2,3),Se.write_shift(2,65534),Se.write_shift(2,9),Se.write_shift(2,6),ke=0;ke<3;++ke)Se.write_shift(2,0);for(Se.write_shift(4,0),Se.write_shift(4,ye[2]),Se.write_shift(4,ye[0]+ye[1]+ye[2]+ye[3]-1),Se.write_shift(4,0),Se.write_shift(4,4096),Se.write_shift(4,ye[3]?ye[0]+ye[1]+ye[2]-1:K),Se.write_shift(4,ye[3]),Se.write_shift(-4,ye[1]?ye[0]-1:K),Se.write_shift(4,ye[1]),ke=0;ke<109;++ke)Se.write_shift(-4,ke<ye[2]?ye[1]+ke:-1)}if(ye[1])for($e=0;$e<ye[1];++$e){for(;ke<236+$e*127;++ke)Se.write_shift(-4,ke<ye[2]?ye[1]+ke:-1);Se.write_shift(-4,$e===ye[1]-1?K:$e+1)}var at=function(Nt){for($e+=Nt;ke<$e-1;++ke)Se.write_shift(-4,ke+1);Nt&&(++ke,Se.write_shift(-4,K))};for($e=ke=0,$e+=ye[1];ke<$e;++ke)Se.write_shift(-4,Z.DIFSECT);for($e+=ye[2];ke<$e;++ke)Se.write_shift(-4,Z.FATSECT);at(ye[3]),at(ye[4]);for(var He=0,Ge=0,Ve=fe.FileIndex[0];He<fe.FileIndex.length;++He)Ve=fe.FileIndex[He],Ve.content&&(Ge=Ve.content.length,!(Ge<4096)&&(Ve.start=$e,at(Ge+511>>9)));for(at(ye[6]+7>>3);Se.l&511;)Se.write_shift(-4,Z.ENDOFCHAIN);for($e=ke=0,He=0;He<fe.FileIndex.length;++He)Ve=fe.FileIndex[He],Ve.content&&(Ge=Ve.content.length,!(!Ge||Ge>=4096)&&(Ve.start=$e,at(Ge+63>>6)));for(;Se.l&511;)Se.write_shift(-4,Z.ENDOFCHAIN);for(ke=0;ke<ye[4]<<2;++ke){var ht=fe.FullPaths[ke];if(!ht||ht.length===0){for(He=0;He<17;++He)Se.write_shift(4,0);for(He=0;He<3;++He)Se.write_shift(4,-1);for(He=0;He<12;++He)Se.write_shift(4,0);continue}Ve=fe.FileIndex[ke],ke===0&&(Ve.start=Ve.size?Ve.start-1:K);var vt=ke===0&&ge.root||Ve.name;if(Ge=2*(vt.length+1),Se.write_shift(64,vt,"utf16le"),Se.write_shift(2,Ge),Se.write_shift(1,Ve.type),Se.write_shift(1,Ve.color),Se.write_shift(-4,Ve.L),Se.write_shift(-4,Ve.R),Se.write_shift(-4,Ve.C),Ve.clsid)Se.write_shift(16,Ve.clsid,"hex");else for(He=0;He<4;++He)Se.write_shift(4,0);Se.write_shift(4,Ve.state||0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,Ve.start),Se.write_shift(4,Ve.size),Se.write_shift(4,0)}for(ke=1;ke<fe.FileIndex.length;++ke)if(Ve=fe.FileIndex[ke],Ve.size>=4096)if(Se.l=Ve.start+1<<9,ir&&Buffer.isBuffer(Ve.content))Ve.content.copy(Se,Se.l,0,Ve.size),Se.l+=Ve.size+511&-512;else{for(He=0;He<Ve.size;++He)Se.write_shift(1,Ve.content[He]);for(;He&511;++He)Se.write_shift(1,0)}for(ke=1;ke<fe.FileIndex.length;++ke)if(Ve=fe.FileIndex[ke],Ve.size>0&&Ve.size<4096)if(ir&&Buffer.isBuffer(Ve.content))Ve.content.copy(Se,Se.l,0,Ve.size),Se.l+=Ve.size+63&-64;else{for(He=0;He<Ve.size;++He)Se.write_shift(1,Ve.content[He]);for(;He&63;++He)Se.write_shift(1,0)}if(ir)Se.l=Se.length;else for(;Se.l<Se.length;)Se.write_shift(1,0);return Se}function oe(fe,_e){var ge=fe.FullPaths.map(function(He){return He.toUpperCase()}),ye=ge.map(function(He){var Ge=He.split("/");return Ge[Ge.length-(He.slice(-1)=="/"?2:1)]}),Se=!1;_e.charCodeAt(0)===47?(Se=!0,_e=ge[0].slice(0,-1)+_e):Se=_e.indexOf("/")!==-1;var ke=_e.toUpperCase(),$e=Se===!0?ge.indexOf(ke):ye.indexOf(ke);if($e!==-1)return fe.FileIndex[$e];var at=!ke.match(ed);for(ke=ke.replace(ma,""),at&&(ke=ke.replace(ed,"!")),$e=0;$e<ge.length;++$e)if((at?ge[$e].replace(ed,"!"):ge[$e]).replace(ma,"")==ke||(at?ye[$e].replace(ed,"!"):ye[$e]).replace(ma,"")==ke)return fe.FileIndex[$e];return null}var D=64,K=-2,M="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],te="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:M,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function we(fe,_e,ge){h();var ye=V(fe,ge);d.writeFileSync(_e,ye)}function ee(fe){for(var _e=new Array(fe.length),ge=0;ge<fe.length;++ge)_e[ge]=String.fromCharCode(fe[ge]);return _e.join("")}function Ne(fe,_e){var ge=V(fe,_e);switch(_e&&_e.type||"buffer"){case"file":return h(),d.writeFileSync(_e.filename,ge),ge;case"binary":return typeof ge=="string"?ge:ee(ge);case"base64":return jd(typeof ge=="string"?ge:ee(ge));case"buffer":if(ir)return Buffer.isBuffer(ge)?ge:Ni(ge);case"array":return typeof ge=="string"?Ba(ge):ge}return ge}var q;function I(fe){try{var _e=fe.InflateRaw,ge=new _e;if(ge._processChunk(new Uint8Array([3,0]),ge._finishFlushFlag),ge.bytesRead)q=fe;else throw new Error("zlib does not expose bytesRead")}catch(ye){console.error("cannot use native zlib: "+(ye.message||ye))}}function X(fe,_e){if(!q)return dt(fe,_e);var ge=q.InflateRaw,ye=new ge,Se=ye._processChunk(fe.slice(fe.l),ye._finishFlushFlag);return fe.l+=ye.bytesRead,Se}function H(fe){return q?q.deflateRawSync(fe):Re(fe)}var Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],B=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function z(fe){var _e=(fe<<1|fe<<11)&139536|(fe<<5|fe<<15)&558144;return(_e>>16|_e>>8|_e)&255}for(var ue=typeof Uint8Array<"u",se=ue?new Uint8Array(256):[],re=0;re<256;++re)se[re]=z(re);function W(fe,_e){var ge=se[fe&255];return _e<=8?ge>>>8-_e:(ge=ge<<8|se[fe>>8&255],_e<=16?ge>>>16-_e:(ge=ge<<8|se[fe>>16&255],ge>>>24-_e))}function ce(fe,_e){var ge=_e&7,ye=_e>>>3;return(fe[ye]|(ge<=6?0:fe[ye+1]<<8))>>>ge&3}function k(fe,_e){var ge=_e&7,ye=_e>>>3;return(fe[ye]|(ge<=5?0:fe[ye+1]<<8))>>>ge&7}function de(fe,_e){var ge=_e&7,ye=_e>>>3;return(fe[ye]|(ge<=4?0:fe[ye+1]<<8))>>>ge&15}function U(fe,_e){var ge=_e&7,ye=_e>>>3;return(fe[ye]|(ge<=3?0:fe[ye+1]<<8))>>>ge&31}function T(fe,_e){var ge=_e&7,ye=_e>>>3;return(fe[ye]|(ge<=1?0:fe[ye+1]<<8))>>>ge&127}function A(fe,_e,ge){var ye=_e&7,Se=_e>>>3,ke=(1<<ge)-1,$e=fe[Se]>>>ye;return ge<8-ye||($e|=fe[Se+1]<<8-ye,ge<16-ye)||($e|=fe[Se+2]<<16-ye,ge<24-ye)||($e|=fe[Se+3]<<24-ye),$e&ke}function G(fe,_e,ge){var ye=_e&7,Se=_e>>>3;return ye<=5?fe[Se]|=(ge&7)<<ye:(fe[Se]|=ge<<ye&255,fe[Se+1]=(ge&7)>>8-ye),_e+3}function xe(fe,_e,ge){var ye=_e&7,Se=_e>>>3;return ge=(ge&1)<<ye,fe[Se]|=ge,_e+1}function be(fe,_e,ge){var ye=_e&7,Se=_e>>>3;return ge<<=ye,fe[Se]|=ge&255,ge>>>=8,fe[Se+1]=ge,_e+8}function ne(fe,_e,ge){var ye=_e&7,Se=_e>>>3;return ge<<=ye,fe[Se]|=ge&255,ge>>>=8,fe[Se+1]=ge&255,fe[Se+2]=ge>>>8,_e+16}function je(fe,_e){var ge=fe.length,ye=2*ge>_e?2*ge:_e+5,Se=0;if(ge>=_e)return fe;if(ir){var ke=uE(ye);if(fe.copy)fe.copy(ke);else for(;Se<fe.length;++Se)ke[Se]=fe[Se];return ke}else if(ue){var $e=new Uint8Array(ye);if($e.set)$e.set(fe);else for(;Se<ge;++Se)$e[Se]=fe[Se];return $e}return fe.length=ye,fe}function Me(fe){for(var _e=new Array(fe),ge=0;ge<fe;++ge)_e[ge]=0;return _e}function De(fe,_e,ge){var ye=1,Se=0,ke=0,$e=0,at=0,He=fe.length,Ge=ue?new Uint16Array(32):Me(32);for(ke=0;ke<32;++ke)Ge[ke]=0;for(ke=He;ke<ge;++ke)fe[ke]=0;He=fe.length;var Ve=ue?new Uint16Array(He):Me(He);for(ke=0;ke<He;++ke)Ge[Se=fe[ke]]++,ye<Se&&(ye=Se),Ve[ke]=0;for(Ge[0]=0,ke=1;ke<=ye;++ke)Ge[ke+16]=at=at+Ge[ke-1]<<1;for(ke=0;ke<He;++ke)at=fe[ke],at!=0&&(Ve[ke]=Ge[at+16]++);var ht=0;for(ke=0;ke<He;++ke)if(ht=fe[ke],ht!=0)for(at=W(Ve[ke],ye)>>ye-ht,$e=(1<<ye+4-ht)-1;$e>=0;--$e)_e[at|$e<<ht]=ht&15|ke<<4;return ye}var Ce=ue?new Uint16Array(512):Me(512),st=ue?new Uint16Array(32):Me(32);if(!ue){for(var We=0;We<512;++We)Ce[We]=0;for(We=0;We<32;++We)st[We]=0}(function(){for(var fe=[],_e=0;_e<32;_e++)fe.push(5);De(fe,st,32);var ge=[];for(_e=0;_e<=143;_e++)ge.push(8);for(;_e<=255;_e++)ge.push(9);for(;_e<=279;_e++)ge.push(7);for(;_e<=287;_e++)ge.push(8);De(ge,Ce,288)})();var Ze=(function(){for(var _e=ue?new Uint8Array(32768):[],ge=0,ye=0;ge<B.length-1;++ge)for(;ye<B[ge+1];++ye)_e[ye]=ge;for(;ye<32768;++ye)_e[ye]=29;var Se=ue?new Uint8Array(259):[];for(ge=0,ye=0;ge<ie.length-1;++ge)for(;ye<ie[ge+1];++ye)Se[ye]=ge;function ke(at,He){for(var Ge=0;Ge<at.length;){var Ve=Math.min(65535,at.length-Ge),ht=Ge+Ve==at.length;for(He.write_shift(1,+ht),He.write_shift(2,Ve),He.write_shift(2,~Ve&65535);Ve-- >0;)He[He.l++]=at[Ge++]}return He.l}function $e(at,He){for(var Ge=0,Ve=0,ht=ue?new Uint16Array(32768):[];Ve<at.length;){var vt=Math.min(65535,at.length-Ve);if(vt<10){for(Ge=G(He,Ge,+(Ve+vt==at.length)),Ge&7&&(Ge+=8-(Ge&7)),He.l=Ge/8|0,He.write_shift(2,vt),He.write_shift(2,~vt&65535);vt-- >0;)He[He.l++]=at[Ve++];Ge=He.l*8;continue}Ge=G(He,Ge,+(Ve+vt==at.length)+2);for(var Nt=0;vt-- >0;){var gt=at[Ve];Nt=(Nt<<5^gt)&32767;var me=-1,Ie=0;if((me=ht[Nt])&&(me|=Ve&-32768,me>Ve&&(me-=32768),me<Ve))for(;at[me+Ie]==at[Ve+Ie]&&Ie<250;)++Ie;if(Ie>2){gt=Se[Ie],gt<=22?Ge=be(He,Ge,se[gt+1]>>1)-1:(be(He,Ge,3),Ge+=5,be(He,Ge,se[gt-23]>>5),Ge+=3);var _t=gt<8?0:gt-4>>2;_t>0&&(ne(He,Ge,Ie-ie[gt]),Ge+=_t),gt=_e[Ve-me],Ge=be(He,Ge,se[gt]>>3),Ge-=3;var bt=gt<4?0:gt-2>>1;bt>0&&(ne(He,Ge,Ve-me-B[gt]),Ge+=bt);for(var qt=0;qt<Ie;++qt)ht[Nt]=Ve&32767,Nt=(Nt<<5^at[Ve])&32767,++Ve;vt-=Ie-1}else gt<=143?gt=gt+48:Ge=xe(He,Ge,1),Ge=be(He,Ge,se[gt]),ht[Nt]=Ve&32767,++Ve}Ge=be(He,Ge,0)-1}return He.l=(Ge+7)/8|0,He.l}return function(He,Ge){return He.length<8?ke(He,Ge):$e(He,Ge)}})();function Re(fe){var _e=it(50+Math.floor(fe.length*1.1)),ge=Ze(fe,_e);return _e.slice(0,ge)}var pt=ue?new Uint16Array(32768):Me(32768),Tt=ue?new Uint16Array(32768):Me(32768),wt=ue?new Uint16Array(128):Me(128),jt=1,Pt=1;function Le(fe,_e){var ge=U(fe,_e)+257;_e+=5;var ye=U(fe,_e)+1;_e+=5;var Se=de(fe,_e)+4;_e+=4;for(var ke=0,$e=ue?new Uint8Array(19):Me(19),at=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],He=1,Ge=ue?new Uint8Array(8):Me(8),Ve=ue?new Uint8Array(8):Me(8),ht=$e.length,vt=0;vt<Se;++vt)$e[Q[vt]]=ke=k(fe,_e),He<ke&&(He=ke),Ge[ke]++,_e+=3;var Nt=0;for(Ge[0]=0,vt=1;vt<=He;++vt)Ve[vt]=Nt=Nt+Ge[vt-1]<<1;for(vt=0;vt<ht;++vt)(Nt=$e[vt])!=0&&(at[vt]=Ve[Nt]++);var gt=0;for(vt=0;vt<ht;++vt)if(gt=$e[vt],gt!=0){Nt=se[at[vt]]>>8-gt;for(var me=(1<<7-gt)-1;me>=0;--me)wt[Nt|me<<gt]=gt&7|vt<<3}var Ie=[];for(He=1;Ie.length<ge+ye;)switch(Nt=wt[T(fe,_e)],_e+=Nt&7,Nt>>>=3){case 16:for(ke=3+ce(fe,_e),_e+=2,Nt=Ie[Ie.length-1];ke-- >0;)Ie.push(Nt);break;case 17:for(ke=3+k(fe,_e),_e+=3;ke-- >0;)Ie.push(0);break;case 18:for(ke=11+T(fe,_e),_e+=7;ke-- >0;)Ie.push(0);break;default:Ie.push(Nt),He<Nt&&(He=Nt);break}var _t=Ie.slice(0,ge),bt=Ie.slice(ge);for(vt=ge;vt<286;++vt)_t[vt]=0;for(vt=ye;vt<30;++vt)bt[vt]=0;return jt=De(_t,pt,286),Pt=De(bt,Tt,30),_e}function nt(fe,_e){if(fe[0]==3&&!(fe[1]&3))return[io(_e),2];for(var ge=0,ye=0,Se=uE(_e||1<<18),ke=0,$e=Se.length>>>0,at=0,He=0;(ye&1)==0;){if(ye=k(fe,ge),ge+=3,ye>>>1)ye>>1==1?(at=9,He=5):(ge=Le(fe,ge),at=jt,He=Pt);else{ge&7&&(ge+=8-(ge&7));var Ge=fe[ge>>>3]|fe[(ge>>>3)+1]<<8;if(ge+=32,Ge>0)for(!_e&&$e<ke+Ge&&(Se=je(Se,ke+Ge),$e=Se.length);Ge-- >0;)Se[ke++]=fe[ge>>>3],ge+=8;continue}for(;;){!_e&&$e<ke+32767&&(Se=je(Se,ke+32767),$e=Se.length);var Ve=A(fe,ge,at),ht=ye>>>1==1?Ce[Ve]:pt[Ve];if(ge+=ht&15,ht>>>=4,(ht>>>8&255)===0)Se[ke++]=ht;else{if(ht==256)break;ht-=257;var vt=ht<8?0:ht-4>>2;vt>5&&(vt=0);var Nt=ke+ie[ht];vt>0&&(Nt+=A(fe,ge,vt),ge+=vt),Ve=A(fe,ge,He),ht=ye>>>1==1?st[Ve]:Tt[Ve],ge+=ht&15,ht>>>=4;var gt=ht<4?0:ht-2>>1,me=B[ht];for(gt>0&&(me+=A(fe,ge,gt),ge+=gt),!_e&&$e<Nt&&(Se=je(Se,Nt+100),$e=Se.length);ke<Nt;)Se[ke]=Se[ke-me],++ke}}}return _e?[Se,ge+7>>>3]:[Se.slice(0,ke),ge+7>>>3]}function dt(fe,_e){var ge=fe.slice(fe.l||0),ye=nt(ge,_e);return fe.l+=ye[1],ye[0]}function Ae(fe,_e){if(fe)typeof console<"u"&&console.error(_e);else throw new Error(_e)}function Je(fe,_e){var ge=fe;Vs(ge,0);var ye=[],Se=[],ke={FileIndex:ye,FullPaths:Se};O(ke,{root:_e.root});for(var $e=ge.length-4;(ge[$e]!=80||ge[$e+1]!=75||ge[$e+2]!=5||ge[$e+3]!=6)&&$e>=0;)--$e;ge.l=$e+4,ge.l+=4;var at=ge.read_shift(2);ge.l+=6;var He=ge.read_shift(4);for(ge.l=He,$e=0;$e<at;++$e){ge.l+=20;var Ge=ge.read_shift(4),Ve=ge.read_shift(4),ht=ge.read_shift(2),vt=ge.read_shift(2),Nt=ge.read_shift(2);ge.l+=8;var gt=ge.read_shift(4),me=u(ge.slice(ge.l+ht,ge.l+ht+vt));ge.l+=ht+vt+Nt;var Ie=ge.l;ge.l=gt+4,Ee(ge,Ge,Ve,ke,me),ge.l=Ie}return ke}function Ee(fe,_e,ge,ye,Se){fe.l+=2;var ke=fe.read_shift(2),$e=fe.read_shift(2),at=c(fe);if(ke&8257)throw new Error("Unsupported ZIP encryption");for(var He=fe.read_shift(4),Ge=fe.read_shift(4),Ve=fe.read_shift(4),ht=fe.read_shift(2),vt=fe.read_shift(2),Nt="",gt=0;gt<ht;++gt)Nt+=String.fromCharCode(fe[fe.l++]);if(vt){var me=u(fe.slice(fe.l,fe.l+vt));(me[21589]||{}).mt&&(at=me[21589].mt),((Se||{})[21589]||{}).mt&&(at=Se[21589].mt)}fe.l+=vt;var Ie=fe.slice(fe.l,fe.l+Ge);switch($e){case 8:Ie=X(fe,Ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+$e)}var _t=!1;ke&8&&(He=fe.read_shift(4),He==134695760&&(He=fe.read_shift(4),_t=!0),Ge=fe.read_shift(4),Ve=fe.read_shift(4)),Ge!=_e&&Ae(_t,"Bad compressed size: "+_e+" != "+Ge),Ve!=ge&&Ae(_t,"Bad uncompressed size: "+ge+" != "+Ve),Lt(ye,Nt,Ie,{unsafe:!0,mt:at})}function Pe(fe,_e){var ge=_e||{},ye=[],Se=[],ke=it(1),$e=ge.compression?8:0,at=0,He=0,Ge=0,Ve=0,ht=0,vt=fe.FullPaths[0],Nt=vt,gt=fe.FileIndex[0],me=[],Ie=0;for(He=1;He<fe.FullPaths.length;++He)if(Nt=fe.FullPaths[He].slice(vt.length),gt=fe.FileIndex[He],!(!gt.size||!gt.content||Nt=="Sh33tJ5")){var _t=Ve,bt=it(Nt.length);for(Ge=0;Ge<Nt.length;++Ge)bt.write_shift(1,Nt.charCodeAt(Ge)&127);bt=bt.slice(0,bt.l),me[ht]=IU.buf(gt.content,0);var qt=gt.content;$e==8&&(qt=H(qt)),ke=it(30),ke.write_shift(4,67324752),ke.write_shift(2,20),ke.write_shift(2,at),ke.write_shift(2,$e),gt.mt?o(ke,gt.mt):ke.write_shift(4,0),ke.write_shift(-4,me[ht]),ke.write_shift(4,qt.length),ke.write_shift(4,gt.content.length),ke.write_shift(2,bt.length),ke.write_shift(2,0),Ve+=ke.length,ye.push(ke),Ve+=bt.length,ye.push(bt),Ve+=qt.length,ye.push(qt),ke=it(46),ke.write_shift(4,33639248),ke.write_shift(2,0),ke.write_shift(2,20),ke.write_shift(2,at),ke.write_shift(2,$e),ke.write_shift(4,0),ke.write_shift(-4,me[ht]),ke.write_shift(4,qt.length),ke.write_shift(4,gt.content.length),ke.write_shift(2,bt.length),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(4,0),ke.write_shift(4,_t),Ie+=ke.l,Se.push(ke),Ie+=bt.length,Se.push(bt),++ht}return ke=it(22),ke.write_shift(4,101010256),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,ht),ke.write_shift(2,ht),ke.write_shift(4,Ie),ke.write_shift(4,Ve),ke.write_shift(2,0),Ls([Ls(ye),Ls(Se),ke])}var he={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function le(fe,_e){if(fe.ctype)return fe.ctype;var ge=fe.name||"",ye=ge.match(/\.([^\.]+)$/);return ye&&he[ye[1]]||_e&&(ye=(ge=_e).match(/[\.\\]([^\.\\])+$/),ye&&he[ye[1]])?he[ye[1]]:"application/octet-stream"}function ve(fe){for(var _e=jd(fe),ge=[],ye=0;ye<_e.length;ye+=76)ge.push(_e.slice(ye,ye+76));return ge.join(`\r
`)+`\r
`}function Oe(fe){var _e=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ge){var Ve=Ge.charCodeAt(0).toString(16).toUpperCase();return"="+(Ve.length==1?"0"+Ve:Ve)});_e=_e.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),_e.charAt(0)==`
`&&(_e="=0D"+_e.slice(1)),_e=_e.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ge=[],ye=_e.split(`\r
`),Se=0;Se<ye.length;++Se){var ke=ye[Se];if(ke.length==0){ge.push("");continue}for(var $e=0;$e<ke.length;){var at=76,He=ke.slice($e,$e+at);He.charAt(at-1)=="="?at--:He.charAt(at-2)=="="?at-=2:He.charAt(at-3)=="="&&(at-=3),He=ke.slice($e,$e+at),$e+=at,$e<ke.length&&(He+="="),ge.push(He)}}return ge.join(`\r
`)}function qe(fe){for(var _e=[],ge=0;ge<fe.length;++ge){for(var ye=fe[ge];ge<=fe.length&&ye.charAt(ye.length-1)=="=";)ye=ye.slice(0,ye.length-1)+fe[++ge];_e.push(ye)}for(var Se=0;Se<_e.length;++Se)_e[Se]=_e[Se].replace(/[=][0-9A-Fa-f]{2}/g,function(ke){return String.fromCharCode(parseInt(ke.slice(1),16))});return Ba(_e.join(`\r
`))}function ct(fe,_e,ge){for(var ye="",Se="",ke="",$e,at=0;at<10;++at){var He=_e[at];if(!He||He.match(/^\s*$/))break;var Ge=He.match(/^(.*?):\s*([^\s].*)$/);if(Ge)switch(Ge[1].toLowerCase()){case"content-location":ye=Ge[2].trim();break;case"content-type":ke=Ge[2].trim();break;case"content-transfer-encoding":Se=Ge[2].trim();break}}switch(++at,Se.toLowerCase()){case"base64":$e=Ba(qa(_e.slice(at).join("")));break;case"quoted-printable":$e=qe(_e.slice(at));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Se)}var Ve=Lt(fe,ye.slice(ge.length),$e,{unsafe:!0});ke&&(Ve.ctype=ke)}function Et(fe,_e){if(ee(fe.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ge=_e&&_e.root||"",ye=(ir&&Buffer.isBuffer(fe)?fe.toString("binary"):ee(fe)).split(`\r
`),Se=0,ke="";for(Se=0;Se<ye.length;++Se)if(ke=ye[Se],!!/^Content-Location:/i.test(ke)&&(ke=ke.slice(ke.indexOf("file")),ge||(ge=ke.slice(0,ke.lastIndexOf("/")+1)),ke.slice(0,ge.length)!=ge))for(;ge.length>0&&(ge=ge.slice(0,ge.length-1),ge=ge.slice(0,ge.lastIndexOf("/")+1),ke.slice(0,ge.length)!=ge););var $e=(ye[1]||"").match(/boundary="(.*?)"/);if(!$e)throw new Error("MAD cannot find boundary");var at="--"+($e[1]||""),He=[],Ge=[],Ve={FileIndex:He,FullPaths:Ge};O(Ve);var ht,vt=0;for(Se=0;Se<ye.length;++Se){var Nt=ye[Se];Nt!==at&&Nt!==at+"--"||(vt++&&ct(Ve,ye.slice(ht,Se),ge),ht=Se)}return Ve}function Xt(fe,_e){var ge=_e||{},ye=ge.boundary||"SheetJS";ye="------="+ye;for(var Se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ye.slice(2)+'"',"","",""],ke=fe.FullPaths[0],$e=ke,at=fe.FileIndex[0],He=1;He<fe.FullPaths.length;++He)if($e=fe.FullPaths[He].slice(ke.length),at=fe.FileIndex[He],!(!at.size||!at.content||$e=="Sh33tJ5")){$e=$e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var Ge=at.content,Ve=ir&&Buffer.isBuffer(Ge)?Ge.toString("binary"):ee(Ge),ht=0,vt=Math.min(1024,Ve.length),Nt=0,gt=0;gt<=vt;++gt)(Nt=Ve.charCodeAt(gt))>=32&&Nt<128&&++ht;var me=ht>=vt*4/5;Se.push(ye),Se.push("Content-Location: "+(ge.root||"file:///C:/SheetJS/")+$e),Se.push("Content-Transfer-Encoding: "+(me?"quoted-printable":"base64")),Se.push("Content-Type: "+le(at,$e)),Se.push(""),Se.push(me?Oe(Ve):ve(Ve))}return Se.push(ye+`--\r
`),Se.join(`\r
`)}function er(fe){var _e={};return O(_e,fe),_e}function Lt(fe,_e,ge,ye){var Se=ye&&ye.unsafe;Se||O(fe);var ke=!Se&&zt.find(fe,_e);if(!ke){var $e=fe.FullPaths[0];_e.slice(0,$e.length)==$e?$e=_e:($e.slice(-1)!="/"&&($e+="/"),$e=($e+_e).replace("//","/")),ke={name:a(_e),type:2},fe.FileIndex.push(ke),fe.FullPaths.push($e),Se||zt.utils.cfb_gc(fe)}return ke.content=ge,ke.size=ge?ge.length:0,ye&&(ye.CLSID&&(ke.clsid=ye.CLSID),ye.mt&&(ke.mt=ye.mt),ye.ct&&(ke.ct=ye.ct)),ke}function Yt(fe,_e){O(fe);var ge=zt.find(fe,_e);if(ge){for(var ye=0;ye<fe.FileIndex.length;++ye)if(fe.FileIndex[ye]==ge)return fe.FileIndex.splice(ye,1),fe.FullPaths.splice(ye,1),!0}return!1}function Rr(fe,_e,ge){O(fe);var ye=zt.find(fe,_e);if(ye){for(var Se=0;Se<fe.FileIndex.length;++Se)if(fe.FileIndex[Se]==ye)return fe.FileIndex[Se].name=a(ge),fe.FullPaths[Se]=ge,!0}return!1}function Dr(fe){F(fe,!0)}return t.find=oe,t.read=L,t.parse=m,t.write=Ne,t.writeFile=we,t.utils={cfb_new:er,cfb_add:Lt,cfb_del:Yt,cfb_mov:Rr,cfb_gc:Dr,ReadShift:id,CheckField:ZT,prep_blob:Vs,bconcat:Ls,use_zlib:I,_deflateRaw:Re,_inflateRaw:dt,consts:Z},t})();function MU(e){return typeof e=="string"?tm(e):Array.isArray(e)?cU(e):e}function Qd(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=tm(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?Pn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var a=new Blob([MU(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=e,c.href=o,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=mo(t)),u.write(t),u.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function PU(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function os(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function yE(e,t){for(var r=[],s=os(e),a=0;a!==s.length;++a)r[e[s[a]][t]]==null&&(r[e[s[a]][t]]=s[a]);return r}function sm(e){for(var t=[],r=os(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function am(e){for(var t=[],r=os(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function BU(e){for(var t=[],r=os(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var A0=new Date(1899,11,30,0,0,0);function As(e,t){var r=e.getTime(),s=A0.getTime()+(e.getTimezoneOffset()-A0.getTimezoneOffset())*6e4;return(r-s)/(1440*60*1e3)}var RT=new Date,UU=A0.getTime()+(RT.getTimezoneOffset()-A0.getTimezoneOffset())*6e4,vE=RT.getTimezoneOffset();function nm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+UU),t.getTimezoneOffset()!==vE&&t.setTime(t.getTime()+(t.getTimezoneOffset()-vE)*6e4),t}function zU(e){var t=0,r=0,s=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(r=1,o>3&&(s=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[o],10)}return t}var wE=new Date("2017-02-19T19:06:09.000Z"),DT=isNaN(wE.getFullYear())?new Date("2/19/17"):wE,qU=DT.getFullYear()==2017;function Gr(e,t){var r=new Date(e);if(qU)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(DT.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function ll(e,t){if(ir&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Pn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Pn(vT(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Pn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Pn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var s=[],a=0;a!=e.length;++a)s.push(String.fromCharCode(e[a]));return s.join("")}function Vr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Vr(e[r]));return t}function as(e,t){for(var r="";r.length<t;)r+=e;return r}function Nn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(a,o){return r=-r,o}),!isNaN(t=Number(s)))?t/r:t}var $U=["january","february","march","april","may","june","july","august","september","october","november","december"];function Bc(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),a=t.getMonth(),o=t.getDate();if(isNaN(o))return r;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&$U.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return s<0||s>8099?r:(a>0||o>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var HU=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,a){if(e||typeof s=="string")return r.split(s);for(var o=r.split(s),c=[o[0]],u=1;u<o.length;++u)c.push(a),c.push(o[u]);return c}})();function OT(e){return e?e.content&&e.type?ll(e.content,!0):e.data?Qu(e.data):e.asNodeBuffer&&ir?Qu(e.asNodeBuffer().toString("binary")):e.asBinary?Qu(e.asBinary()):e._data&&e._data.getContent?Qu(ll(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function FT(e){if(!e)return null;if(e.data)return lE(e.data);if(e.asNodeBuffer&&ir)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?lE(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function WU(e){return e&&e.name.slice(-4)===".bin"?FT(e):OT(e)}function ln(e,t){for(var r=e.FullPaths||os(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),a=s.replace(/\\/g,"/"),o=0;o<r.length;++o){var c=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==c||a==c)return e.files?e.files[r[o]]:e.FileIndex[o]}return null}function bv(e,t){var r=ln(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function _s(e,t,r){if(!r)return WU(bv(e,t));if(!t)return null;try{return _s(e,t)}catch{return null}}function Ua(e,t,r){if(!r)return OT(bv(e,t));if(!t)return null;try{return Ua(e,t)}catch{return null}}function GU(e,t,r){return FT(bv(e,t))}function bE(e){for(var t=e.FullPaths||os(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function rr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return ir?s=Ni(r):s=uU(r),zt.utils.cfb_add(e,t,s)}zt.utils.cfb_add(e,t,r)}else e.file(t,r)}function _v(){return zt.utils.cfb_new()}function LT(e,t){switch(t.type){case"base64":return zt.read(e,{type:"base64"});case"binary":return zt.read(e,{type:"binary"});case"buffer":case"array":return zt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function td(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var a=s.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var xs=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,VU=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,_E=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,KU=/<[^>]*>/g,ca=xs.match(_E)?_E:KU,XU=/<\w*:/,YU=/<(\/?)\w+:/;function Kt(e,t,r){for(var s={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(t||(s[0]=e.slice(0,a)),a===e.length)return s;var c=e.match(VU),u=0,d="",h=0,m="",x="",y=1;if(c)for(h=0;h!=c.length;++h){for(x=c[h],o=0;o!=x.length&&x.charCodeAt(o)!==61;++o);for(m=x.slice(0,o).trim();x.charCodeAt(o+1)==32;)++o;for(y=(a=x.charCodeAt(o+1))==34||a==39?1:0,d=x.slice(o+1+y,x.length-y),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),s[m]=d,s[m.toLowerCase()]=d;else{var v=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(s[v]&&m.slice(u-3,u)=="ext")continue;s[v]=d,s[v.toLowerCase()]=d}}return s}function Un(e){return e.replace(YU,"<$1")}var IT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Sv=sm(IT),gr=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var a=s+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(u,d){return IT[u]||String.fromCharCode(parseInt(d,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,d){return String.fromCharCode(parseInt(d,16))});var c=a.indexOf("]]>");return r(a.slice(0,o))+a.slice(o+9,c)+r(a.slice(c+3))}})(),kv=/[&<>'"]/g,JU=/[\u0000-\u0008\u000b-\u001f]/g;function Ar(e){var t=e+"";return t.replace(kv,function(r){return Sv[r]}).replace(JU,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function SE(e){return Ar(e).replace(/ /g,"_x0020_")}var MT=/[\u0000-\u001f]/g;function Nv(e){var t=e+"";return t.replace(kv,function(r){return Sv[r]}).replace(/\n/g,"<br/>").replace(MT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function ZU(e){var t=e+"";return t.replace(kv,function(r){return Sv[r]}).replace(MT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var kE=(function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}})();function QU(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Wr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function I1(e){for(var t="",r=0,s=0,a=0,o=0,c=0,u=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(a=e.charCodeAt(r++),s>191&&s<224){c=(s&31)<<6,c|=a&63,t+=String.fromCharCode(c);continue}if(o=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(a&63)<<6|o&63);continue}c=e.charCodeAt(r++),u=((s&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function NE(e){var t=io(2*e.length),r,s,a=1,o=0,c=0,u;for(s=0;s<e.length;s+=a)a=1,(u=e.charCodeAt(s))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(s+1)&63),a=2):u<240?(r=(u&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),a=3):(a=4,r=(u&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(t[o++]=c&255,t[o++]=c>>>8,c=0),t[o++]=r%256,t[o++]=r>>>8;return t.slice(0,o).toString("ucs2")}function EE(e){return Ni(e,"binary").toString("utf8")}var zh="foo bar baz",Pr=ir&&(EE(zh)==I1(zh)&&EE||NE(zh)==I1(zh)&&NE)||I1,Pn=ir?function(e){return Ni(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,a=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,a=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},Ad=(function(){var e={};return function(r,s){var a=r+"|"+(s||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}})(),PT=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)s=s.replace(e[a][0],e[a][1]);return s}})(),ez=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),tz=/<\/?(?:vt:)?variant>/g,rz=/<(?:vt:)([^>]*)>([\s\S]*)</;function jE(e,t){var r=Kt(e),s=e.match(ez(r.baseType))||[],a=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return a}return s.forEach(function(o){var c=o.replace(tz,"").match(rz);c&&a.push({v:Pr(c[2]),t:c[1]})}),a}var BT=/(^\s|\s$|\n)/;function Xs(e,t){return"<"+e+(t.match(BT)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Cd(e){return os(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function St(e,t,r){return"<"+e+(r!=null?Cd(r):"")+(t!=null?(t.match(BT)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Sy(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function sz(e,t){switch(typeof e){case"string":var r=St("vt:lpwstr",Ar(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return St((e|0)==e?"vt:i4":"vt:r8",Ar(String(e)));case"boolean":return St("vt:bool",e?"true":"false")}if(e instanceof Date)return St("vt:filetime",Sy(e));throw new Error("Unable to serialize "+e)}function Ev(e){if(ir&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Pr(mo(yv(e)));throw new Error("Bad input format: expected Buffer or string")}var Rd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ts={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},gl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],La={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function az(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,o=5;o>=0;--o)a=a*256+e[t+o];return s==2047?a==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,a+=Math.pow(2,52)),r*Math.pow(2,s-52)*a)}function nz(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,a=0,o=0,c=s?-t:t;isFinite(c)?c==0?a=o=0:(a=Math.floor(Math.log(c)/Math.LN2),o=c*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(t)?26985:0);for(var u=0;u<=5;++u,o/=256)e[r+u]=o&255;e[r+6]=(a&15)<<4|o&15,e[r+7]=a>>4|s}var TE=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var a=0,o=e[0][s].length;a<o;a+=r)t.push.apply(t,e[0][s].slice(a,a+r));return t},AE=ir?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ni(t)})):TE(e)}:TE,CE=function(e,t,r){for(var s=[],a=t;a<r;a+=2)s.push(String.fromCharCode(fi(e,a)));return s.join("").replace(ma,"")},jv=ir?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ma,""):CE(e,t,r)}:CE,RE=function(e,t,r){for(var s=[],a=t;a<t+r;++a)s.push(("0"+e[a].toString(16)).slice(-2));return s.join("")},UT=ir?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):RE(e,t,r)}:RE,DE=function(e,t,r){for(var s=[],a=t;a<r;a++)s.push(String.fromCharCode(yc(e,a)));return s.join("")},ef=ir?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):DE(t,r,s)}:DE,zT=function(e,t){var r=Ia(e,t);return r>0?ef(e,t+4,t+4+r-1):""},qT=zT,$T=function(e,t){var r=Ia(e,t);return r>0?ef(e,t+4,t+4+r-1):""},HT=$T,WT=function(e,t){var r=2*Ia(e,t);return r>0?ef(e,t+4,t+4+r-1):""},GT=WT,VT=function(t,r){var s=Ia(t,r);return s>0?jv(t,r+4,r+4+s):""},KT=VT,XT=function(e,t){var r=Ia(e,t);return r>0?ef(e,t+4,t+4+r):""},YT=XT,JT=function(e,t){return az(e,t)},C0=JT,Tv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ir&&(qT=function(t,r){if(!Buffer.isBuffer(t))return zT(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},HT=function(t,r){if(!Buffer.isBuffer(t))return $T(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},GT=function(t,r){if(!Buffer.isBuffer(t))return WT(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},KT=function(t,r){if(!Buffer.isBuffer(t))return VT(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},YT=function(t,r){if(!Buffer.isBuffer(t))return XT(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},C0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):JT(t,r)},Tv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var yc=function(e,t){return e[t]},fi=function(e,t){return e[t+1]*256+e[t]},iz=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ia=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Wo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},oz=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function id(e,t){var r="",s,a,o=[],c,u,d,h;switch(t){case"dbcs":if(h=this.l,ir&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(fi(this,h)),h+=2;e*=2;break;case"utf8":r=ef(this,this.l,this.l+e);break;case"utf16le":e*=2,r=jv(this,this.l,this.l+e);break;case"wstr":return id.call(this,e,"dbcs");case"lpstr-ansi":r=qT(this,this.l),e=4+Ia(this,this.l);break;case"lpstr-cp":r=HT(this,this.l),e=4+Ia(this,this.l);break;case"lpwstr":r=GT(this,this.l),e=4+2*Ia(this,this.l);break;case"lpp4":e=4+Ia(this,this.l),r=KT(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ia(this,this.l),r=YT(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(c=yc(this,this.l+e++))!==0;)o.push(Uh(c));r=o.join("");break;case"_wstr":for(e=0,r="";(c=fi(this,this.l+e))!==0;)o.push(Uh(c)),e+=2;e+=2,r=o.join("");break;case"dbcs-cont":for(r="",h=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return c=yc(this,h),this.l=h+1,u=id.call(this,e-d,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Uh(fi(this,h))),h+=2}r=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return c=yc(this,h),this.l=h+1,u=id.call(this,e-d,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Uh(yc(this,h))),h+=1}r=o.join("");break;default:switch(e){case 1:return s=yc(this,this.l),this.l++,s;case 2:return s=(t==="i"?iz:fi)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(s=(e>0?Wo:oz)(this,this.l),this.l+=4,s):(a=Ia(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=C0(this,this.l):a=C0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=UT(this,this.l,e);break}}return this.l+=e,r}var lz=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},cz=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},uz=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function dz(e,t,r){var s=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)uz(this,t.charCodeAt(a),this.l+2*a);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;s=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var c=t.charCodeAt(a);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,lz(this,t,this.l);break;case 8:if(s=8,r==="f"){nz(this,t,this.l);break}case 16:break;case-4:s=4,cz(this,t,this.l);break}return this.l+=s,this}function ZT(e,t){var r=UT(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Vs(e,t){e.l=t,e.read_shift=id,e.chk=ZT,e.write_shift=dz}function la(e,t){e.l+=t}function it(e){var t=io(e);return Vs(t,0),t}function Ei(e,t,r){if(e){var s,a,o;Vs(e,e.l||0);for(var c=e.length,u=0,d=0;e.l<c;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var h=Md[u]||Md[65535];for(s=e.read_shift(1),o=s&127,a=1;a<4&&s&128;++a)o+=((s=e.read_shift(1))&127)<<7*a;d=e.l+o;var m=h.f&&h.f(e,o,r);if(e.l=d,t(m,h,u))return}}}function Na(){var e=[],t=ir?256:2048,r=function(h){var m=it(h);return Vs(m,0),m},s=r(t),a=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},o=function(h){return s&&h<s.length-s.l?s:(a(),s=r(Math.max(h+1,t)))},c=function(){return a(),Ls(e)},u=function(h){a(),s=h,s.l==null&&(s.l=s.length),o(t)};return{next:o,push:u,end:c,_bufs:e}}function mt(e,t,r,s){var a=+t,o;if(!isNaN(a)){s||(s=Md[a].p||(r||[]).length||0),o=1+(a>=128?1:0)+1,s>=128&&++o,s>=16384&&++o,s>=2097152&&++o;var c=e.next(o);a<=127?c.write_shift(1,a):(c.write_shift(1,(a&127)+128),c.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(s>=128)c.write_shift(1,(s&127)+128),s>>=7;else{c.write_shift(1,s);break}s>0&&Tv(r)&&e.push(r)}}function od(e,t,r){var s=Vr(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function OE(e,t,r){var s=Vr(e);return s.s=od(s.s,t.s,r),s.e=od(s.e,t.s,r),s}function ld(e,t){if(e.cRel&&e.c<0)for(e=Vr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Vr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Vt(e);return!e.cRel&&e.cRel!=null&&(r=mz(r)),!e.rRel&&e.rRel!=null&&(r=fz(r)),r}function M1(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Zr(e.s.c)+":"+(e.e.cRel?"":"$")+Zr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ms(e.s.r)+":"+(e.e.rRel?"":"$")+ms(e.e.r):ld(e.s,t.biff)+":"+ld(e.e,t.biff)}function Av(e){return parseInt(hz(e),10)-1}function ms(e){return""+(e+1)}function fz(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function hz(e){return e.replace(/\$(\d+)$/,"$1")}function Cv(e){for(var t=pz(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function Zr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function mz(e){return e.replace(/^([A-Z])/,"$$$1")}function pz(e){return e.replace(/^\$([A-Z])/,"$1")}function xz(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qr(e){for(var t=0,r=0,s=0;s<e.length;++s){var a=e.charCodeAt(s);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Vt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ea(e){var t=e.indexOf(":");return t==-1?{s:Qr(e),e:Qr(e)}:{s:Qr(e.slice(0,t)),e:Qr(e.slice(t+1))}}function Qt(e,t){return typeof t>"u"||typeof t=="number"?Qt(e.s,e.e):(typeof e!="string"&&(e=Vt(e)),typeof t!="string"&&(t=Vt(t)),e==t?e:e+":"+t)}function vr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,a=0,o=e.length;for(r=0;s<o&&!((a=e.charCodeAt(s)-64)<1||a>26);++s)r=26*r+a;for(t.s.c=--r,r=0;s<o&&!((a=e.charCodeAt(s)-48)<0||a>9);++s)r=10*r+a;if(t.s.r=--r,s===o||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=o&&!((a=e.charCodeAt(s)-64)<1||a>26);++s)r=26*r+a;for(t.e.c=--r,r=0;s!=o&&!((a=e.charCodeAt(s)-48)<0||a>9);++s)r=10*r+a;return t.e.r=--r,t}function FE(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=fn(e.z,r?As(t):t)}catch{}try{return e.w=fn((e.XF||{}).numFmtId||(r?14:0),r?As(t):t)}catch{return""+t}}function vi(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ji[e.v]||e.v:t==null?FE(e,e.v):FE(e,t))}function po(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function QT(e,t,r){var s=r||{},a=e?Array.isArray(e):s.dense,o=e||(a?[]:{}),c=0,u=0;if(o&&s.origin!=null){if(typeof s.origin=="number")c=s.origin;else{var d=typeof s.origin=="string"?Qr(s.origin):s.origin;c=d.r,u=d.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var m=vr(o["!ref"]);h.s.c=m.s.c,h.s.r=m.s.r,h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),c==-1&&(h.e.r=c=m.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=t[x].length;++y)if(!(typeof t[x][y]>"u")){var v={v:t[x][y]},w=c+x,g=u+y;if(h.s.r>w&&(h.s.r=w),h.s.c>g&&(h.s.c=g),h.e.r<w&&(h.e.r=w),h.e.c<g&&(h.e.c=g),t[x][y]&&typeof t[x][y]=="object"&&!Array.isArray(t[x][y])&&!(t[x][y]instanceof Date))v=t[x][y];else if(Array.isArray(v.v)&&(v.f=t[x][y][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(s.nullError)v.t="e",v.v=0;else if(s.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=s.dateNF||Gt[14],s.cellDates?(v.t="d",v.w=fn(v.z,As(v.v))):(v.t="n",v.v=As(v.v),v.w=fn(v.z,v.v))):v.t="s";if(a)o[w]||(o[w]=[]),o[w][g]&&o[w][g].z&&(v.z=o[w][g].z),o[w][g]=v;else{var _=Vt({c:g,r:w});o[_]&&o[_].z&&(v.z=o[_].z),o[_]=v}}}return h.s.c<1e7&&(o["!ref"]=Qt(h)),o}function Yc(e,t){return QT(null,e,t)}function gz(e){return e.read_shift(4,"i")}function En(e,t){return t||(t=it(4)),t.write_shift(4,e),t}function ia(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Is(e,t){var r=!1;return t==null&&(r=!0,t=it(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function yz(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function vz(e,t){return t||(t=it(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Rv(e,t){var r=e.l,s=e.read_shift(1),a=ia(e),o=[],c={t:a,h:a};if((s&1)!==0){for(var u=e.read_shift(4),d=0;d!=u;++d)o.push(yz(e));c.r=o}else c.r=[{ich:0,ifnt:0}];return e.l=r+t,c}function wz(e,t){var r=!1;return t==null&&(r=!0,t=it(15+4*e.t.length)),t.write_shift(1,0),Is(e.t,t),r?t.slice(0,t.l):t}var bz=Rv;function _z(e,t){var r=!1;return t==null&&(r=!0,t=it(23+4*e.t.length)),t.write_shift(1,1),Is(e.t,t),t.write_shift(4,1),vz({},t),r?t.slice(0,t.l):t}function mn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function yl(e,t){return t==null&&(t=it(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function vl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function wl(e,t){return t==null&&(t=it(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Sz=ia,e3=Is;function Dv(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function R0(e,t){var r=!1;return t==null&&(r=!0,t=it(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var kz=ia,ky=Dv,Ov=R0;function Fv(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var a=s===0?C0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Wo(t,0)>>2;return r?a/100:a}function t3(e,t){t==null&&(t=it(4));var r=0,s=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function r3(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Nz(e,t){return t||(t=it(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var bl=r3,Jc=Nz;function sa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function cl(e,t){return(t||it(8)).write_shift(8,e,"f")}function Ez(e){var t={},r=e.read_shift(1),s=r>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),d=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=a;var h=Qo[a];h&&(t.rgb=Od(h));break;case 2:t.rgb=Od([c,u,d]);break;case 3:t.theme=a;break}return o!=0&&(t.tint=o>0?o/32767:o/32768),t}function D0(e,t){if(t||(t=it(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function jz(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Tz(e,t){t||(t=it(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function s3(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Az(e){return s3(e,1)}function Cz(e){return s3(e,2)}var Lv=2,_a=3,qh=11,LE=12,O0=19,$h=64,Rz=65,Dz=71,Oz=4108,Fz=4126,Os=80,a3=81,Lz=[Os,a3],Ny={1:{n:"CodePage",t:Lv},2:{n:"Category",t:Os},3:{n:"PresentationFormat",t:Os},4:{n:"ByteCount",t:_a},5:{n:"LineCount",t:_a},6:{n:"ParagraphCount",t:_a},7:{n:"SlideCount",t:_a},8:{n:"NoteCount",t:_a},9:{n:"HiddenCount",t:_a},10:{n:"MultimediaClipCount",t:_a},11:{n:"ScaleCrop",t:qh},12:{n:"HeadingPairs",t:Oz},13:{n:"TitlesOfParts",t:Fz},14:{n:"Manager",t:Os},15:{n:"Company",t:Os},16:{n:"LinksUpToDate",t:qh},17:{n:"CharacterCount",t:_a},19:{n:"SharedDoc",t:qh},22:{n:"HyperlinksChanged",t:qh},23:{n:"AppVersion",t:_a,p:"version"},24:{n:"DigSig",t:Rz},26:{n:"ContentType",t:Os},27:{n:"ContentStatus",t:Os},28:{n:"Language",t:Os},29:{n:"Version",t:Os},255:{},2147483648:{n:"Locale",t:O0},2147483651:{n:"Behavior",t:O0},1919054434:{}},Ey={1:{n:"CodePage",t:Lv},2:{n:"Title",t:Os},3:{n:"Subject",t:Os},4:{n:"Author",t:Os},5:{n:"Keywords",t:Os},6:{n:"Comments",t:Os},7:{n:"Template",t:Os},8:{n:"LastAuthor",t:Os},9:{n:"RevNumber",t:Os},10:{n:"EditTime",t:$h},11:{n:"LastPrinted",t:$h},12:{n:"CreatedDate",t:$h},13:{n:"ModifiedDate",t:$h},14:{n:"PageCount",t:_a},15:{n:"WordCount",t:_a},16:{n:"CharCount",t:_a},17:{n:"Thumbnail",t:Dz},18:{n:"Application",t:Os},19:{n:"DocSecurity",t:_a},255:{},2147483648:{n:"Locale",t:O0},2147483651:{n:"Behavior",t:O0},1919054434:{}},IE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Iz=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Mz(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Pz=Mz([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Qo=Vr(Pz),ji={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},n3={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Hh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Iv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Bz(e){var t=Iv();if(!e||!e.match)return t;var r={};if((e.match(ca)||[]).forEach(function(s){var a=Kt(s);switch(a[0].replace(XU,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[jy[a.ContentType]]!==void 0&&t[jy[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Ts.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function i3(e,t){var r=BU(jy),s=[],a;s[s.length]=xs,s[s.length]=St("Types",null,{xmlns:Ts.CT,"xmlns:xsd":Ts.xsd,"xmlns:xsi":Ts.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return St("Default",null,{Extension:d[0],ContentType:d[1]})}));var o=function(d){e[d]&&e[d].length>0&&(a=e[d][0],s[s.length]=St("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Hh[d][t.bookType]||Hh[d].xlsx}))},c=function(d){(e[d]||[]).forEach(function(h){s[s.length]=St("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Hh[d][t.bookType]||Hh[d].xlsx})})},u=function(d){(e[d]||[]).forEach(function(h){s[s.length]=St("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[d][0]})})};return o("workbooks"),c("sheets"),c("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),c("metadata"),u("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var lr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Dd(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function cd(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(ca)||[]).forEach(function(a){var o=Kt(a);if(o[0]==="<Relationship"){var c={};c.Type=o.Type,c.Target=o.Target,c.Id=o.Id,o.TargetMode&&(c.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:td(o.Target,t);r[u]=c,s[o.Id]=c}}),r["!id"]=s,r}function Tc(e){var t=[xs,St("Relationships",null,{xmlns:Ts.RELS})];return os(e["!id"]).forEach(function(r){t[t.length]=St("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Tr(e,t,r,s,a,o){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=s,a.Target=r,[lr.HLINK,lr.XPATH,lr.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var Uz="application/vnd.oasis.opendocument.spreadsheet";function zz(e,t){for(var r=Ev(e),s,a;s=Rd.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(a=Kt(s[0],!1),a.path=="/"&&a.type!==Uz)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}function qz(e){var t=[xs];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function ME(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function $z(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Hz(e){var t=[xs];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(ME(e[r][0],e[r][1])),t.push($z("",e[r][0]));return t.push(ME("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function o3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+N0.version+"</meta:generator></office:meta></office:document-meta>"}var un=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Wz=(function(){for(var e=new Array(un.length),t=0;t<un.length;++t){var r=un[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e})();function l3(e){var t={};e=Pr(e);for(var r=0;r<un.length;++r){var s=un[r],a=e.match(Wz[r]);a!=null&&a.length>0&&(t[s[1]]=gr(a[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=Gr(t[s[1]]))}return t}function P1(e,t,r,s,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Ar(t),s[s.length]=r?St(e,t,r):Xs(e,t))}function c3(e,t){var r=t||{},s=[xs,St("cp:coreProperties",null,{"xmlns:cp":Ts.CORE_PROPS,"xmlns:dc":Ts.dc,"xmlns:dcterms":Ts.dcterms,"xmlns:dcmitype":Ts.dcmitype,"xmlns:xsi":Ts.xsi})],a={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&P1("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Sy(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,a),e.ModifiedDate!=null&&P1("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Sy(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,a));for(var o=0;o!=un.length;++o){var c=un[o],u=r.Props&&r.Props[c[1]]!=null?r.Props[c[1]]:e?e[c[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&P1(c[0],u,null,s,a)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var el=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],u3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function d3(e,t,r,s){var a=[];if(typeof e=="string")a=jE(e,s);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(m){return{v:m}}));var c=typeof t=="string"?jE(t,s).map(function(m){return m.v}):t,u=0,d=0;if(c.length>0)for(var h=0;h!==a.length;h+=2){switch(d=+a[h+1].v,a[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=d,r.SheetNames=c.slice(u,u+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=d,r.DefinedNames=c.slice(u,u+d);break;case"Charts":case"Diagramme":r.Chartsheets=d,r.ChartNames=c.slice(u,u+d);break}u+=d}}function Gz(e,t,r){var s={};return t||(t={}),e=Pr(e),el.forEach(function(a){var o=(e.match(Ad(a[0]))||[])[1];switch(a[2]){case"string":o&&(t[a[1]]=gr(o));break;case"bool":t[a[1]]=o==="true";break;case"raw":var c=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));c&&c.length>0&&(s[a[1]]=c[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&d3(s.HeadingPairs,s.TitlesOfParts,t,r),t}function f3(e){var t=[],r=St;return e||(e={}),e.Application="SheetJS",t[t.length]=xs,t[t.length]=St("Properties",null,{xmlns:Ts.EXT_PROPS,"xmlns:vt":Ts.vt}),el.forEach(function(s){if(e[s[1]]!==void 0){var a;switch(s[2]){case"string":a=Ar(String(e[s[1]]));break;case"bool":a=e[s[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(s[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+Ar(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Vz=/<[^>]+>[^<]*/g;function Kz(e,t){var r={},s="",a=e.match(Vz);if(a)for(var o=0;o!=a.length;++o){var c=a[o],u=Kt(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":s=gr(u.name);break;case"</property>":s=null;break;default:if(c.indexOf("<vt:")===0){var d=c.split(">"),h=d[0].slice(4),m=d[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[s]=gr(m);break;case"bool":r[s]=Wr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(m);break;case"filetime":case"date":r[s]=Gr(m);break;case"cy":case"error":r[s]=gr(m);break;default:if(h.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",c,h,d)}}else if(c.slice(0,2)!=="</"){if(t.WTF)throw new Error(c)}}}return r}function h3(e){var t=[xs,St("Properties",null,{xmlns:Ts.CUST_PROPS,"xmlns:vt":Ts.vt})];if(!e)return t.join("");var r=1;return os(e).forEach(function(a){++r,t[t.length]=St("property",sz(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ar(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Ty={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},B1;function Xz(e,t,r){B1||(B1=sm(Ty)),t=B1[t]||t,e[t]=r}function Yz(e,t){var r=[];return os(Ty).map(function(s){for(var a=0;a<un.length;++a)if(un[a][1]==s)return un[a];for(a=0;a<el.length;++a)if(el[a][1]==s)return el[a];throw s}).forEach(function(s){if(e[s[1]]!=null){var a=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];s[2]==="date"&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Xs(Ty[s[1]]||s[1],a))}}),St("DocumentProperties",r.join(""),{xmlns:La.o})}function Jz(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",a=[];return e&&os(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var c=0;c<un.length;++c)if(o==un[c][1])return;for(c=0;c<el.length;++c)if(o==el[c][1])return;for(c=0;c<r.length;++c)if(o==r[c])return;var u=e[o],d="string";typeof u=="number"?(d="float",u=String(u)):u===!0||u===!1?(d="boolean",u=u?"1":"0"):u=String(u),a.push(St(SE(o),u,{"dt:dt":d}))}}),t&&os(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var c=t[o],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c instanceof Date?(u="dateTime.tz",c=c.toISOString()):c=String(c),a.push(St(SE(o),c,{"dt:dt":u}))}}),"<"+s+' xmlns="'+La.o+'">'+a.join("")+"</"+s+">"}function Mv(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Zz(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),a=(r-s)/Math.pow(2,32);s*=1e7,a*=1e7;var o=s/Math.pow(2,32)|0;o>0&&(s=s%Math.pow(2,32),a+=o);var c=it(8);return c.write_shift(4,s),c.write_shift(4,a),c}function m3(e,t,r){var s=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return a}function p3(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function x3(e,t,r){return t===31?p3(e):m3(e,t,r)}function Ay(e,t,r){return x3(e,t,r===!1?0:4)}function Qz(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return x3(e,t,0)}function eq(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var a=e.l;r[s]=e.read_shift(0,"lpwstr").replace(ma,""),e.l-a&2&&(e.l+=2)}return r}function tq(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(ma,"");return r}function rq(e){var t=e.l,r=F0(e,a3);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=F0(e,_a);return[r,s]}function sq(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push(rq(e));return r}function PE(e,t){for(var r=e.read_shift(4),s={},a=0;a!=r;++a){var o=e.read_shift(4),c=e.read_shift(4);s[o]=e.read_shift(c,t===1200?"utf16le":"utf8").replace(ma,"").replace(ed,"!"),t===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function g3(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function aq(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function F0(e,t,r){var s=e.read_shift(2),a,o=r||{};if(e.l+=2,t!==LE&&s!==t&&Lz.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===LE?s:t){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return m3(e,s,4).replace(ma,"");case 31:return p3(e);case 64:return Mv(e);case 65:return g3(e);case 71:return aq(e);case 80:return Ay(e,s,!o.raw).replace(ma,"");case 81:return Qz(e,s).replace(ma,"");case 4108:return sq(e);case 4126:case 4127:return s==4127?eq(e):tq(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function BE(e,t){var r=it(4),s=it(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=it(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=Zz(t);break;case 31:case 80:for(s=it(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ls([r,s])}function UE(e,t){var r=e.l,s=e.read_shift(4),a=e.read_shift(4),o=[],c=0,u=0,d=-1,h={};for(c=0;c!=a;++c){var m=e.read_shift(4),x=e.read_shift(4);o[c]=[m,x+r]}o.sort(function(N,S){return N[1]-S[1]});var y={};for(c=0;c!=a;++c){if(e.l!==o[c][1]){var v=!0;if(c>0&&t)switch(t[o[c-1][0]].t){case 2:e.l+2===o[c][1]&&(e.l+=2,v=!1);break;case 80:e.l<=o[c][1]&&(e.l=o[c][1],v=!1);break;case 4108:e.l<=o[c][1]&&(e.l=o[c][1],v=!1);break}if((!t||c==0)&&e.l<=o[c][1]&&(v=!1,e.l=o[c][1]),v)throw new Error("Read Error: Expected address "+o[c][1]+" at "+e.l+" :"+c)}if(t){var w=t[o[c][0]];if(y[w.n]=F0(e,w.t,{raw:!0}),w.p==="version"&&(y[w.n]=String(y[w.n]>>16)+"."+("0000"+String(y[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(y[w.n]){case 0:y[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Sn(u=y[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[w.n])}}else if(o[c][0]===1){if(u=y.CodePage=F0(e,Lv),Sn(u),d!==-1){var g=e.l;e.l=o[d][1],h=PE(e,u),e.l=g}}else if(o[c][0]===0){if(u===0){d=c,e.l=o[c+1][1];continue}h=PE(e,u)}else{var _=h[o[c][0]],b;switch(e[e.l]){case 65:e.l+=4,b=g3(e);break;case 30:e.l+=4,b=Ay(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=Ay(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=hs(e,4);break;case 64:e.l+=4,b=Gr(Mv(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[_]=b}}return e.l=r+s,y}var y3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function nq(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function zE(e,t,r){var s=it(8),a=[],o=[],c=8,u=0,d=it(8),h=it(8);if(d.write_shift(4,2),d.write_shift(4,1200),h.write_shift(4,1),o.push(d),a.push(h),c+=8+d.length,!t){h=it(8),h.write_shift(4,0),a.unshift(h);var m=[it(4)];for(m[0].write_shift(4,e.length),u=0;u<e.length;++u){var x=e[u][0];for(d=it(8+2*(x.length+1)+(x.length%2?0:2)),d.write_shift(4,u+2),d.write_shift(4,x.length+1),d.write_shift(0,x,"dbcs");d.l!=d.length;)d.write_shift(1,0);m.push(d)}d=Ls(m),o.unshift(d),c+=8+d.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(y3.indexOf(e[u][0])>-1||u3.indexOf(e[u][0])>-1)&&e[u][1]!=null){var y=e[u][1],v=0;if(t){v=+t[e[u][0]];var w=r[v];if(w.p=="version"&&typeof y=="string"){var g=y.split(".");y=(+g[0]<<16)+(+g[1]||0)}d=BE(w.t,y)}else{var _=nq(y);_==-1&&(_=31,y=String(y)),d=BE(_,y)}o.push(d),h=it(8),h.write_shift(4,t?v:2+u),a.push(h),c+=8+d.length}var b=8*(o.length+1);for(u=0;u<o.length;++u)a[u].write_shift(4,b),b+=o[u].length;return s.write_shift(4,c),s.write_shift(4,o.length),Ls([s].concat(a).concat(o))}function qE(e,t,r){var s=e.content;if(!s)return{};Vs(s,0);var a,o,c,u,d=0;s.chk("feff","Byte Order: "),s.read_shift(2);var h=s.read_shift(4),m=s.read_shift(16);if(m!==zt.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(a=s.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=s.read_shift(16),u=s.read_shift(4),a===1&&u!==s.l)throw new Error("Length mismatch: "+u+" !== "+s.l);a===2&&(c=s.read_shift(16),d=s.read_shift(4));var x=UE(s,t),y={SystemIdentifier:h};for(var v in x)y[v]=x[v];if(y.FMTID=o,a===1)return y;if(d-s.l==2&&(s.l+=2),s.l!==d)throw new Error("Length mismatch 2: "+s.l+" !== "+d);var w;try{w=UE(s,null)}catch{}for(v in w)y[v]=w[v];return y.FMTID=[o,c],y}function $E(e,t,r,s,a,o){var c=it(a?68:48),u=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,zt.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,a?2:1),c.write_shift(16,t,"hex"),c.write_shift(4,a?68:48);var d=zE(e,r,s);if(u.push(d),a){var h=zE(a,null,null);c.write_shift(16,o,"hex"),c.write_shift(4,68+d.length),u.push(h)}return Ls(u)}function Zi(e,t){return e.read_shift(t),null}function iq(e,t){t||(t=it(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function oq(e,t,r){for(var s=[],a=e.l+t;e.l<a;)s.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return s}function hs(e,t){return e.read_shift(t)===1}function fa(e,t){return t||(t=it(2)),t.write_shift(2,+!!e),t}function Ss(e){return e.read_shift(2,"u")}function cn(e,t){return t||(t=it(2)),t.write_shift(2,e),t}function v3(e,t){return oq(e,t,Ss)}function lq(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function w3(e,t,r){return r||(r=it(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function tf(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var c=s?e.read_shift(s,a):"";return c}function cq(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,a=r&8,o=1+(r&1),c=0,u,d={};a&&(c=e.read_shift(2)),s&&(u=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",m=t===0?"":e.read_shift(t,h);return a&&(e.l+=4*c),s&&(e.l+=u),d.t=m,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function uq(e){var t=e.t||"",r=it(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=it(2*t.length);s.write_shift(2*t.length,t,"utf16le");var a=[r,s];return Ls(a)}function ul(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function rf(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):ul(e,s,r)}function _l(e,t,r){if(r.biff>5)return rf(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function b3(e,t,r){return r||(r=it(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function dq(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function fq(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var a=e.read_shift((s?t-24:t)>>1,"utf16le").replace(ma,"");return s&&(e.l+=24),a}function hq(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+s.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(o>>1,"utf16le").replace(ma,"");return r+c}function mq(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return fq(e);case"0303000000000000c000000000000046":return hq(e);default:throw new Error("Unsupported Moniker "+r)}}function Wh(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ma,""):"";return r}function HE(e,t){t||(t=it(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function pq(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var a=e.read_shift(2);e.l+=2;var o,c,u,d,h="",m,x;a&16&&(o=Wh(e,r-e.l)),a&128&&(c=Wh(e,r-e.l)),(a&257)===257&&(u=Wh(e,r-e.l)),(a&257)===1&&(d=mq(e,r-e.l)),a&8&&(h=Wh(e,r-e.l)),a&32&&(m=e.read_shift(16)),a&64&&(x=Mv(e)),e.l=r;var y=c||u||d||"";y&&h&&(y+="#"+h),y||(y="#"+h),a&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var v={Target:y};return m&&(v.guid=m),x&&(v.time=x),o&&(v.Tooltip=o),v}function xq(e){var t=it(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var a=s.indexOf("#"),o=a>-1?31:23;switch(s.charAt(0)){case"#":o=28;break;case".":o&=-3;break}t.write_shift(4,2),t.write_shift(4,o);var c=[8,6815827,6619237,4849780,83];for(r=0;r<c.length;++r)t.write_shift(4,c[r]);if(o==28)s=s.slice(1),HE(s,t);else if(o&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<c.length;++r)t.write_shift(1,parseInt(c[r],16));var u=a>-1?s.slice(0,a):s;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),o&8&&HE(a>-1?s.slice(a+1):"",t)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<c.length;++r)t.write_shift(1,parseInt(c[r],16));for(var d=0;s.slice(d*3,d*3+3)=="../"||s.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,s.length-3*d+1),r=0;r<s.length-3*d;++r)t.write_shift(1,s.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function _3(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),a=e.read_shift(1);return[t,r,s,a]}function S3(e,t){var r=_3(e);return r[3]=0,r}function zn(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function dl(e,t,r,s){return s||(s=it(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function gq(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function yq(e,t,r){return t===0?"":_l(e,t,r)}function vq(e,t,r){var s=r.biff>8?4:2,a=e.read_shift(s),o=e.read_shift(s,"i"),c=e.read_shift(s,"i");return[a,o,c]}function k3(e){var t=e.read_shift(2),r=Fv(e);return[t,r]}function wq(e,t,r){e.l+=4,t-=4;var s=e.l+t,a=tf(e,t,r),o=e.read_shift(2);if(s-=e.l,o!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+o);return e.l+=o,a}function im(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);return{s:{c:s,r:t},e:{c:a,r}}}function N3(e,t){return t||(t=it(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function E3(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),a=e.read_shift(1);return{s:{c:s,r:t},e:{c:a,r}}}var bq=E3;function j3(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function _q(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Sq(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Zs(e){e.l+=2,e.l+=e.read_shift(2)}var kq={0:Zs,4:Zs,5:Zs,6:Zs,7:Sq,8:Zs,9:Zs,10:Zs,11:Zs,12:Zs,13:_q,14:Zs,15:Zs,16:Zs,17:Zs,18:Zs,19:Zs,20:Zs,21:j3};function Nq(e,t){for(var r=e.l+t,s=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{s.push(kq[a](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function Gh(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Pv(e,t,r){var s=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,a=8;break;case"biff4":s=4,a=6;break;case"biff3":s=3,a=6;break;case"biff2":s=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=it(a);return o.write_shift(2,s),o.write_shift(2,t),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function Eq(e,t){return t===0||e.read_shift(2),1200}function jq(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,a=_l(e,0,r);return e.read_shift(t+s-e.l),a}function Tq(e,t){var r=!t||t.biff==8,s=it(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function Aq(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function Cq(e,t,r){var s=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var c=tf(e,0,r);return c.length===0&&(c="Sheet1"),{pos:s,hs:a,dt:o,name:c}}function Rq(e,t){var r=!t||t.biff>=8?2:1,s=it(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=s.slice(0,s.l);return a.l=s.l,a}function Dq(e,t){for(var r=e.l+t,s=e.read_shift(4),a=e.read_shift(4),o=[],c=0;c!=a&&e.l<r;++c)o.push(cq(e));return o.Count=s,o.Unique=a,o}function Oq(e,t){var r=it(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],a=0;a<e.length;++a)s[a]=uq(e[a]);var o=Ls([r].concat(s));return o.parts=[r.length].concat(s.map(function(c){return c.length})),o}function Fq(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Lq(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function Iq(e){var t=gq(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Mq(e){return e.read_shift(2),e.read_shift(4)}function WE(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(s=1-(a>>15),a&=32767);var o={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[o,a]}function Pq(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),h=e.read_shift(2);return{Pos:[t,r],Dim:[s,a],Flags:o,CurTab:c,FirstTab:u,Selected:d,TabRatio:h}}function Bq(){var e=it(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Uq(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function zq(e){var t=it(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function qq(){}function $q(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=tf(e,0,r),s}function Hq(e,t){var r=e.name||"Arial",s=t&&t.biff==5,a=s?15+r.length:16+2*r.length,o=it(a);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,r.length),s||o.write_shift(1,1),o.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),o}function Wq(e){var t=zn(e);return t.isst=e.read_shift(4),t}function Gq(e,t,r,s){var a=it(10);return dl(e,t,s,a),a.write_shift(4,r),a}function Vq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,a=zn(e);r.biff==2&&e.l++;var o=rf(e,s-e.l,r);return a.val=o,a}function Kq(e,t,r,s,a){var o=!a||a.biff==8,c=it(8+ +o+(1+o)*r.length);return dl(e,t,s,c),c.write_shift(2,r.length),o&&c.write_shift(1,1),c.write_shift((1+o)*r.length,r,o?"utf16le":"sbcs"),c}function Xq(e,t,r){var s=e.read_shift(2),a=_l(e,0,r);return[s,a]}function Yq(e,t,r,s){var a=r&&r.biff==5;s||(s=it(a?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(a?1:2,t.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var o=s.length>s.l?s.slice(0,s.l):s;return o.l==null&&(o.l=o.length),o}var Jq=_l;function GE(e,t,r){var s=e.l+t,a=r.biff==8||!r.biff?4:2,o=e.read_shift(a),c=e.read_shift(a),u=e.read_shift(2),d=e.read_shift(2);return e.l=s,{s:{r:o,c:u},e:{r:c,c:d}}}function Zq(e,t){var r=t.biff==8||!t.biff?4:2,s=it(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function Qq(e){var t=e.read_shift(2),r=e.read_shift(2),s=k3(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function e$(e,t){for(var r=e.l+t-2,s=e.read_shift(2),a=e.read_shift(2),o=[];e.l<r;)o.push(k3(e));if(e.l!==r)throw new Error("MulRK read error");var c=e.read_shift(2);if(o.length!=c-a+1)throw new Error("MulRK length mismatch");return{r:s,c:a,C:c,rkrec:o}}function t$(e,t){for(var r=e.l+t-2,s=e.read_shift(2),a=e.read_shift(2),o=[];e.l<r;)o.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var c=e.read_shift(2);if(o.length!=c-a+1)throw new Error("MulBlank length mismatch");return{r:s,c:a,C:c,ixfe:o}}function r$(e,t,r,s){var a={},o=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2);return a.patternType=Iz[u>>26],s.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=c&15,a.dgRight=c>>4&15,a.dgTop=c>>8&15,a.dgBottom=c>>12&15,a.icvLeft=c>>16&127,a.icvRight=c>>23&127,a.grbitDiag=c>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=d&127,a.icvBack=d>>7&127,a.fsxButton=d>>14&1),a}function s$(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=r$(e,t,s.fStyle,r),s}function VE(e,t,r,s){var a=r&&r.biff==5;s||(s=it(a?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var o=0;return e.numFmtId>0&&a&&(o|=1024),s.write_shift(4,o),s.write_shift(4,0),a||s.write_shift(4,0),s.write_shift(2,0),s}function a$(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function n$(e){var t=it(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function KE(e,t,r){var s=zn(e);(r.biff==2||t==9)&&++e.l;var a=lq(e);return s.val=a,s.t=a===!0||a===!1?"b":"e",s}function i$(e,t,r,s,a,o){var c=it(8);return dl(e,t,s,c),w3(r,o,c),c}function o$(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=zn(e),a=sa(e);return s.val=a,s}function l$(e,t,r,s){var a=it(14);return dl(e,t,s,a),cl(r,a),a}var XE=yq;function c$(e,t,r){var s=e.l+t,a=e.read_shift(2),o=e.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var c=ul(e,o),u=[];s>e.l;)u.push(rf(e));return[o,a,c,u]}function YE(e,t,r){var s=e.read_shift(2),a,o={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(a=wq(e,t-2,r)),o.body=a||e.read_shift(t-2),typeof a=="string"&&(o.Name=a),o}var u$=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function JE(e,t,r){var s=e.l+t,a=e.read_shift(2),o=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),d=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),d=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var h=ul(e,c,r);a&32&&(h=u$[h.charCodeAt(0)]);var m=s-e.l;r&&r.biff==2&&--m;var x=s==e.l||u===0||!(m>0)?[]:NV(e,m,r,u);return{chKey:o,Name:h,itab:d,rgce:x}}function T3(e,t,r){if(r.biff<8)return d$(e,t,r);for(var s=[],a=e.l+t,o=e.read_shift(r.biff>8?4:2);o--!==0;)s.push(vq(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return s}function d$(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=tf(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function f$(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),a=e.read_shift(2),o=ul(e,s,r),c=ul(e,a,r);return[o,c]}function h$(e,t,r){var s=E3(e);e.l++;var a=e.read_shift(1);return t-=8,[EV(e,t,r),a,s]}function ZE(e,t,r){var s=bq(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,SV(e,t,r)]}function m$(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function p$(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=_l(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:a},u,c,o]}}function x$(e,t,r){return p$(e,t,r)}function g$(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(im(e));return r}function y$(e){var t=it(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)N3(e[r],t);return t}function v$(e,t,r){if(r&&r.biff<8)return b$(e,t,r);var s=j3(e),a=Nq(e,t-22,s[1]);return{cmo:s,ft:a}}var w$={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:s}}};function b$(e,t,r){e.l+=4;var s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var c=[];return c.push((w$[s]||la)(e,t,r)),{cmo:[a,s,o],ft:c}}function _$(e,t,r){var s=e.l,a="";try{e.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:c=dq(e,6,r);var u=e.read_shift(2);e.read_shift(2),Ss(e,2);var d=e.read_shift(2);e.l+=d;for(var h=1;h<e.lens.length-1;++h){if(e.l-s!=e.lens[h])throw new Error("TxO: bad continue record");var m=e[e.l],x=ul(e,e.lens[h+1]-e.lens[h]-1);if(a+=x,a.length>=(m?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return e.l=s+t,{t:a}}catch{return e.l=s+t,{t:a}}}function S$(e,t){var r=im(e);e.l+=16;var s=pq(e,t-24);return[r,s]}function k$(e){var t=it(24),r=Qr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(s[a],16));return Ls([t,xq(e[1])])}function N$(e,t){e.read_shift(2);var r=im(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(ma,""),[r,s]}function E$(e){var t=e[1].Tooltip,r=it(10+2*(t.length+1));r.write_shift(2,2048);var s=Qr(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function j$(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=IE[r]||r,r=e.read_shift(2),t[1]=IE[r]||r,t}function T$(e){return e||(e=it(4)),e.write_shift(2,1),e.write_shift(2,1),e}function A$(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(S3(e));return r}function C$(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(S3(e));return r}function R$(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function A3(e,t,r){if(!r.cellStyles)return la(e,t);var s=r&&r.biff>=12?4:2,a=e.read_shift(s),o=e.read_shift(s),c=e.read_shift(s),u=e.read_shift(s),d=e.read_shift(2);s==2&&(e.l+=2);var h={s:a,e:o,w:c,ixfe:u,flags:d};return(r.biff>=5||!r.biff)&&(h.level=d>>8&7),h}function D$(e,t){var r=it(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function O$(e,t){var r={};return t<32||(e.l+=16,r.header=sa(e),r.footer=sa(e),e.l+=2),r}function F$(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var a=e.read_shift(1);return e.l+=3,a&16&&(s.area=!0),s}function L$(e){for(var t=it(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var I$=zn,M$=v3,P$=rf;function B$(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),a={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,a}function U$(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=zn(e);++e.l;var a=_l(e,t-7,r);return s.t="str",s.val=a,s}function z$(e){var t=zn(e);++e.l;var r=sa(e);return t.t="n",t.val=r,t}function q$(e,t,r){var s=it(15);return of(s,e,t),s.write_shift(8,r,"f"),s}function $$(e){var t=zn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function H$(e,t,r){var s=it(9);return of(s,e,t),s.write_shift(2,r),s}function W$(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function G$(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function V$(e,t,r){var s=e.l+t,a=zn(e),o=e.read_shift(2),c=ul(e,o,r);return e.l=s,a.t="str",a.val=c,a}var K$=[2,3,48,49,131,139,140,245],Cy=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=sm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,d){var h=[],m=io(1);switch(d.type){case"base64":m=Ba(qa(u));break;case"binary":m=Ba(u);break;case"buffer":case"array":m=u;break}Vs(m,0);var x=m.read_shift(1),y=!!(x&136),v=!1,w=!1;switch(x){case 2:break;case 3:break;case 48:v=!0,y=!0;break;case 49:v=!0,y=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var g=0,_=521;x==2&&(g=m.read_shift(2)),m.l+=3,x!=2&&(g=m.read_shift(4)),g>1048576&&(g=1e6),x!=2&&(_=m.read_shift(2));var b=m.read_shift(2),N=d.codepage||1252;x!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(N=e[m[m.l]]),m.l+=1,m.l+=2),w&&(m.l+=36);for(var S=[],E={},R=Math.min(m.length,x==2?521:_-10-(v?264:0)),L=w?32:11;m.l<R&&m[m.l]!=13;)switch(E={},E.name=Ed.utils.decode(N,m.slice(m.l,m.l+L)).replace(/[\u0000\r\n].*$/g,""),m.l+=L,E.type=String.fromCharCode(m.read_shift(1)),x!=2&&!w&&(E.offset=m.read_shift(4)),E.len=m.read_shift(1),x==2&&(E.offset=m.read_shift(2)),E.dec=m.read_shift(1),E.name.length&&S.push(E),x!=2&&(m.l+=w?13:14),E.type){case"B":(!v||E.len!=8)&&d.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(m[m.l]!==13&&(m.l=_-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=_;var O=0,P=0;for(h[0]=[],P=0;P!=S.length;++P)h[0][P]=S[P].name;for(;g-- >0;){if(m[m.l]===42){m.l+=b;continue}for(++m.l,h[++O]=[],P=0,P=0;P!=S.length;++P){var F=m.slice(m.l,m.l+S[P].len);m.l+=S[P].len,Vs(F,0);var V=Ed.utils.decode(N,F);switch(S[P].type){case"C":V.trim().length&&(h[O][P]=V.replace(/\s+$/,""));break;case"D":V.length===8?h[O][P]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):h[O][P]=V;break;case"F":h[O][P]=parseFloat(V.trim());break;case"+":case"I":h[O][P]=w?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":h[O][P]=!0;break;case"N":case"F":h[O][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));h[O][P]="##MEMO##"+(w?parseInt(V.trim(),10):F.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(h[O][P]=+V||0);break;case"@":h[O][P]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":h[O][P]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":h[O][P]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[O][P]=-F.read_shift(-8,"f");break;case"B":if(v&&S[P].len==8){h[O][P]=F.read_shift(8,"f");break}case"G":case"P":F.l+=S[P].len;break;case"0":if(S[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[P].type)}}}if(x!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return d&&d.sheetRows&&(h=h.slice(0,d.sheetRows)),d.DBF=S,h}function s(u,d){var h=d||{};h.dateNF||(h.dateNF="yyyymmdd");var m=Yc(r(u,h),h);return m["!cols"]=h.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete h.DBF,m}function a(u,d){try{return po(s(u,d),d)}catch(h){if(d&&d.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,d){var h=d||{};if(+h.codepage>=0&&Sn(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var m=Na(),x=M0(u,{header:1,raw:!0,cellDates:!0}),y=x[0],v=x.slice(1),w=u["!cols"]||[],g=0,_=0,b=0,N=1;for(g=0;g<y.length;++g){if(((w[g]||{}).DBF||{}).name){y[g]=w[g].DBF.name,++b;continue}if(y[g]!=null){if(++b,typeof y[g]=="number"&&(y[g]=y[g].toString(10)),typeof y[g]!="string")throw new Error("DBF Invalid column name "+y[g]+" |"+typeof y[g]+"|");if(y.indexOf(y[g])!==g){for(_=0;_<1024;++_)if(y.indexOf(y[g]+"_"+_)==-1){y[g]+="_"+_;break}}}}var S=vr(u["!ref"]),E=[],R=[],L=[];for(g=0;g<=S.e.c-S.s.c;++g){var O="",P="",F=0,V=[];for(_=0;_<v.length;++_)v[_][g]!=null&&V.push(v[_][g]);if(V.length==0||y[g]==null){E[g]="?";continue}for(_=0;_<V.length;++_){switch(typeof V[_]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=V[_]instanceof Date?"D":"C";break;default:P="C"}F=Math.max(F,String(V[_]).length),O=O&&O!=P?"C":P}F>250&&(F=250),P=((w[g]||{}).DBF||{}).type,P=="C"&&w[g].DBF.len>F&&(F=w[g].DBF.len),O=="B"&&P=="N"&&(O="N",L[g]=w[g].DBF.dec,F=w[g].DBF.len),R[g]=O=="C"||P=="N"?F:o[O]||0,N+=R[g],E[g]=O}var oe=m.next(32);for(oe.write_shift(4,318902576),oe.write_shift(4,v.length),oe.write_shift(2,296+32*b),oe.write_shift(2,N),g=0;g<4;++g)oe.write_shift(4,0);for(oe.write_shift(4,0|(+t[yT]||3)<<8),g=0,_=0;g<y.length;++g)if(y[g]!=null){var D=m.next(32),K=(y[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,K,"sbcs"),D.write_shift(1,E[g]=="?"?"C":E[g],"sbcs"),D.write_shift(4,_),D.write_shift(1,R[g]||o[E[g]]||0),D.write_shift(1,L[g]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),_+=R[g]||o[E[g]]||0}var M=m.next(264);for(M.write_shift(4,13),g=0;g<65;++g)M.write_shift(4,0);for(g=0;g<v.length;++g){var ae=m.next(N);for(ae.write_shift(1,0),_=0;_<y.length;++_)if(y[_]!=null)switch(E[_]){case"L":ae.write_shift(1,v[g][_]==null?63:v[g][_]?84:70);break;case"B":ae.write_shift(8,v[g][_]||0,"f");break;case"N":var te="0";for(typeof v[g][_]=="number"&&(te=v[g][_].toFixed(L[_]||0)),b=0;b<R[_]-te.length;++b)ae.write_shift(1,32);ae.write_shift(1,te,"sbcs");break;case"D":v[g][_]?(ae.write_shift(4,("0000"+v[g][_].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(v[g][_].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+v[g][_].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(v[g][_]!=null?v[g][_]:"").slice(0,R[_]);for(ae.write_shift(1,Z,"sbcs"),b=0;b<R[_]-Z.length;++b)ae.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:a,to_sheet:s,from_sheet:c}})(),C3=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+os(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,v){var w=e[v];return typeof w=="number"?cE(w):w},s=function(y,v,w){var g=v.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return g==59?y:cE(g)};e["|"]=254;function a(y,v){switch(v.type){case"base64":return o(qa(y),v);case"binary":return o(y,v);case"buffer":return o(ir&&Buffer.isBuffer(y)?y.toString("binary"):mo(y),v);case"array":return o(ll(y),v)}throw new Error("Unrecognized type "+v.type)}function o(y,v){var w=y.split(/[\n\r]+/),g=-1,_=-1,b=0,N=0,S=[],E=[],R=null,L={},O=[],P=[],F=[],V=0,oe;for(+v.codepage>=0&&Sn(+v.codepage);b!==w.length;++b){V=0;var D=w[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),K=D.replace(/;;/g,"\0").split(";").map(function(Q){return Q.replace(/\u0000/g,";")}),M=K[0],ae;if(D.length>0)switch(M){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":K[1].charAt(0)=="P"&&E.push(D.slice(3).replace(/;;/g,";"));break;case"C":var te=!1,Z=!1,we=!1,ee=!1,Ne=-1,q=-1;for(N=1;N<K.length;++N)switch(K[N].charAt(0)){case"A":break;case"X":_=parseInt(K[N].slice(1))-1,Z=!0;break;case"Y":for(g=parseInt(K[N].slice(1))-1,Z||(_=0),oe=S.length;oe<=g;++oe)S[oe]=[];break;case"K":ae=K[N].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(Nn(ae))?isNaN(Bc(ae).getDate())||(ae=Gr(ae)):(ae=Nn(ae),R!==null&&Kc(R)&&(ae=nm(ae))),te=!0;break;case"E":ee=!0;var I=Ac(K[N].slice(1),{r:g,c:_});S[g][_]=[S[g][_],I];break;case"S":we=!0,S[g][_]=[S[g][_],"S5S"];break;case"G":break;case"R":Ne=parseInt(K[N].slice(1))-1;break;case"C":q=parseInt(K[N].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+D)}if(te&&(S[g][_]&&S[g][_].length==2?S[g][_][0]=ae:S[g][_]=ae,R=null),we){if(ee)throw new Error("SYLK shared formula cannot have own formula");var X=Ne>-1&&S[Ne][q];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");S[g][_][1]=K3(X[1],{r:g-Ne,c:_-q})}break;case"F":var H=0;for(N=1;N<K.length;++N)switch(K[N].charAt(0)){case"X":_=parseInt(K[N].slice(1))-1,++H;break;case"Y":for(g=parseInt(K[N].slice(1))-1,oe=S.length;oe<=g;++oe)S[oe]=[];break;case"M":V=parseInt(K[N].slice(1))/20;break;case"F":break;case"G":break;case"P":R=E[parseInt(K[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=K[N].slice(1).split(" "),oe=parseInt(F[0],10);oe<=parseInt(F[1],10);++oe)V=parseInt(F[2],10),P[oe-1]=V===0?{hidden:!0}:{wch:V},oo(P[oe-1]);break;case"C":_=parseInt(K[N].slice(1))-1,P[_]||(P[_]={});break;case"R":g=parseInt(K[N].slice(1))-1,O[g]||(O[g]={}),V>0?(O[g].hpt=V,O[g].hpx=zc(V)):V===0&&(O[g].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+D)}H<1&&(R=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+D)}}return O.length>0&&(L["!rows"]=O),P.length>0&&(L["!cols"]=P),v&&v.sheetRows&&(S=S.slice(0,v.sheetRows)),[S,L]}function c(y,v){var w=a(y,v),g=w[0],_=w[1],b=Yc(g,v);return os(_).forEach(function(N){b[N]=_[N]}),b}function u(y,v){return po(c(y,v),v)}function d(y,v,w,g){var _="C;Y"+(w+1)+";X"+(g+1)+";K";switch(y.t){case"n":_+=y.v||0,y.f&&!y.F&&(_+=";E"+Hv(y.f,{r:w,c:g}));break;case"b":_+=y.v?"TRUE":"FALSE";break;case"e":_+=y.w||y.v;break;case"d":_+='"'+(y.w||y.v)+'"';break;case"s":_+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function h(y,v){v.forEach(function(w,g){var _="F;W"+(g+1)+" "+(g+1)+" ";w.hidden?_+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Fd(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Ld(w.wpx)),typeof w.wch=="number"&&(_+=Math.round(w.wch))),_.charAt(_.length-1)!=" "&&y.push(_)})}function m(y,v){v.forEach(function(w,g){var _="F;";w.hidden?_+="M0;":w.hpt?_+="M"+20*w.hpt+";":w.hpx&&(_+="M"+20*Id(w.hpx)+";"),_.length>2&&y.push(_+"R"+(g+1))})}function x(y,v){var w=["ID;PWXL;N;E"],g=[],_=vr(y["!ref"]),b,N=Array.isArray(y),S=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),y["!cols"]&&h(w,y["!cols"]),y["!rows"]&&m(w,y["!rows"]),w.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var E=_.s.r;E<=_.e.r;++E)for(var R=_.s.c;R<=_.e.c;++R){var L=Vt({r:E,c:R});b=N?(y[E]||[])[R]:y[L],!(!b||b.v==null&&(!b.f||b.F))&&g.push(d(b,y,E,R))}return w.join(S)+S+g.join(S)+S+"E"+S}return{to_workbook:u,to_sheet:c,from_sheet:x}})(),R3=(function(){function e(o,c){switch(c.type){case"base64":return t(qa(o),c);case"binary":return t(o,c);case"buffer":return t(ir&&Buffer.isBuffer(o)?o.toString("binary"):mo(o),c);case"array":return t(ll(o),c)}throw new Error("Unrecognized type "+c.type)}function t(o,c){for(var u=o.split(`
`),d=-1,h=-1,m=0,x=[];m!==u.length;++m){if(u[m].trim()==="BOT"){x[++d]=[],h=0;continue}if(!(d<0)){var y=u[m].trim().split(","),v=y[0],w=y[1];++m;for(var g=u[m]||"";(g.match(/["]/g)||[]).length&1&&m<u.length-1;)g+=`
`+u[++m];switch(g=g.trim(),+v){case-1:if(g==="BOT"){x[++d]=[],h=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?x[d][h]=!0:g==="FALSE"?x[d][h]=!1:isNaN(Nn(w))?isNaN(Bc(w).getDate())?x[d][h]=w:x[d][h]=Gr(w):x[d][h]=Nn(w),++h;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),x[d][h++]=g!==""?g:null;break}if(g==="EOD")break}}return c&&c.sheetRows&&(x=x.slice(0,c.sheetRows)),x}function r(o,c){return Yc(e(o,c),c)}function s(o,c){return po(r(o,c),c)}var a=(function(){var o=function(d,h,m,x,y){d.push(h),d.push(m+","+x),d.push('"'+y.replace(/"/g,'""')+'"')},c=function(d,h,m,x){d.push(h+","+m),d.push(h==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(d){var h=[],m=vr(d["!ref"]),x,y=Array.isArray(d);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,m.e.r-m.s.r+1,""),o(h,"TUPLES",0,m.e.c-m.s.c+1,""),o(h,"DATA",0,0,"");for(var v=m.s.r;v<=m.e.r;++v){c(h,-1,0,"BOT");for(var w=m.s.c;w<=m.e.c;++w){var g=Vt({r:v,c:w});if(x=y?(d[v]||[])[w]:d[g],!x){c(h,1,0,"");continue}switch(x.t){case"n":var _=x.w;!_&&x.v!=null&&(_=x.v),_==null?x.f&&!x.F?c(h,1,0,"="+x.f):c(h,1,0,""):c(h,0,_,"V");break;case"b":c(h,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":c(h,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=fn(x.z||Gt[14],As(Gr(x.v)))),c(h,0,x.w,"V");break;default:c(h,1,0,"")}}}c(h,-1,0,"EOD");var b=`\r
`,N=h.join(b);return N}})();return{to_workbook:s,to_sheet:r,from_sheet:a}})(),D3=(function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,y){for(var v=x.split(`
`),w=-1,g=-1,_=0,b=[];_!==v.length;++_){var N=v[_].trim().split(":");if(N[0]==="cell"){var S=Qr(N[1]);if(b.length<=S.r)for(w=b.length;w<=S.r;++w)b[w]||(b[w]=[]);switch(w=S.r,g=S.c,N[2]){case"t":b[w][g]=e(N[3]);break;case"v":b[w][g]=+N[3];break;case"vtf":var E=N[N.length-1];case"vtc":N[3]==="nl"?b[w][g]=!!+N[4]:b[w][g]=+N[4],N[2]=="vtf"&&(b[w][g]=[b[w][g],E])}}}return y&&y.sheetRows&&(b=b.slice(0,y.sheetRows)),b}function s(x,y){return Yc(r(x,y),y)}function a(x,y){return po(s(x,y),y)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function h(x){if(!x||!x["!ref"])return"";for(var y=[],v=[],w,g="",_=Ea(x["!ref"]),b=Array.isArray(x),N=_.s.r;N<=_.e.r;++N)for(var S=_.s.c;S<=_.e.c;++S)if(g=Vt({r:N,c:S}),w=b?(x[N]||[])[S]:x[g],!(!w||w.v==null||w.t==="z")){switch(v=["cell",g,"t"],w.t){case"s":case"str":v.push(t(w.v));break;case"n":w.f?(v[2]="vtf",v[3]="n",v[4]=w.v,v[5]=t(w.f)):(v[2]="v",v[3]=w.v);break;case"b":v[2]="vt"+(w.f?"f":"c"),v[3]="nl",v[4]=w.v?"1":"0",v[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var E=As(Gr(w.v));v[2]="vtc",v[3]="nd",v[4]=""+E,v[5]=w.w||fn(w.z||Gt[14],E);break;case"e":continue}y.push(v.join(":"))}return y.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function m(x){return[o,c,u,c,h(x),d].join(`
`)}return{to_workbook:a,to_sheet:s,from_sheet:m}})(),Uc=(function(){function e(m,x,y,v,w){w.raw?x[y][v]=m:m===""||(m==="TRUE"?x[y][v]=!0:m==="FALSE"?x[y][v]=!1:isNaN(Nn(m))?isNaN(Bc(m).getDate())?x[y][v]=m:x[y][v]=Gr(m):x[y][v]=Nn(m))}function t(m,x){var y=x||{},v=[];if(!m||m.length===0)return v;for(var w=m.split(/[\r\n]/),g=w.length-1;g>=0&&w[g].length===0;)--g;for(var _=10,b=0,N=0;N<=g;++N)b=w[N].indexOf(" "),b==-1?b=w[N].length:b++,_=Math.max(_,b);for(N=0;N<=g;++N){v[N]=[];var S=0;for(e(w[N].slice(0,_).trim(),v,N,S,y),S=1;S<=(w[N].length-_)/10+1;++S)e(w[N].slice(_+(S-1)*10,_+S*10).trim(),v,N,S,y)}return y.sheetRows&&(v=v.slice(0,y.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function a(m){for(var x={},y=!1,v=0,w=0;v<m.length;++v)(w=m.charCodeAt(v))==34?y=!y:!y&&w in r&&(x[w]=(x[w]||0)+1);w=[];for(v in x)Object.prototype.hasOwnProperty.call(x,v)&&w.push([x[v],v]);if(!w.length){x=s;for(v in x)Object.prototype.hasOwnProperty.call(x,v)&&w.push([x[v],v])}return w.sort(function(g,_){return g[0]-_[0]||s[g[1]]-s[_[1]]}),r[w.pop()[1]]||44}function o(m,x){var y=x||{},v="",w=y.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(v=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(v=m.charAt(4),m=m.slice(6)):v=a(m.slice(0,1024)):y&&y.FS?v=y.FS:v=a(m.slice(0,1024));var _=0,b=0,N=0,S=0,E=0,R=v.charCodeAt(0),L=!1,O=0,P=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var F=y.dateNF!=null?FU(y.dateNF):null;function V(){var oe=m.slice(S,E),D={};if(oe.charAt(0)=='"'&&oe.charAt(oe.length-1)=='"'&&(oe=oe.slice(1,-1).replace(/""/g,'"')),oe.length===0)D.t="z";else if(y.raw)D.t="s",D.v=oe;else if(oe.trim().length===0)D.t="s",D.v=oe;else if(oe.charCodeAt(0)==61)oe.charCodeAt(1)==34&&oe.charCodeAt(oe.length-1)==34?(D.t="s",D.v=oe.slice(2,-1).replace(/""/g,'"')):cG(oe)?(D.t="n",D.f=oe.slice(1)):(D.t="s",D.v=oe);else if(oe=="TRUE")D.t="b",D.v=!0;else if(oe=="FALSE")D.t="b",D.v=!1;else if(!isNaN(N=Nn(oe)))D.t="n",y.cellText!==!1&&(D.w=oe),D.v=N;else if(!isNaN(Bc(oe).getDate())||F&&oe.match(F)){D.z=y.dateNF||Gt[14];var K=0;F&&oe.match(F)&&(oe=LU(oe,y.dateNF,oe.match(F)||[]),K=1),y.cellDates?(D.t="d",D.v=Gr(oe,K)):(D.t="n",D.v=As(Gr(oe,K))),y.cellText!==!1&&(D.w=fn(D.z,D.v instanceof Date?As(D.v):D.v)),y.cellNF||delete D.z}else D.t="s",D.v=oe;if(D.t=="z"||(y.dense?(w[_]||(w[_]=[]),w[_][b]=D):w[Vt({c:b,r:_})]=D),S=E+1,P=m.charCodeAt(S),g.e.c<b&&(g.e.c=b),g.e.r<_&&(g.e.r=_),O==R)++b;else if(b=0,++_,y.sheetRows&&y.sheetRows<=_)return!0}e:for(;E<m.length;++E)switch(O=m.charCodeAt(E)){case 34:P===34&&(L=!L);break;case R:case 10:case 13:if(!L&&V())break e;break}return E-S>0&&V(),w["!ref"]=Qt(g),w}function c(m,x){return!(x&&x.PRN)||x.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?o(m,x):Yc(t(m,x),x)}function u(m,x){var y="",v=x.type=="string"?[0,0,0,0]:Zv(m,x);switch(x.type){case"base64":y=qa(m);break;case"binary":y=m;break;case"buffer":x.codepage==65001?y=m.toString("utf8"):x.codepage&&typeof Ed<"u"||(y=ir&&Buffer.isBuffer(m)?m.toString("binary"):mo(m));break;case"array":y=ll(m);break;case"string":y=m;break;default:throw new Error("Unrecognized type "+x.type)}return v[0]==239&&v[1]==187&&v[2]==191?y=Pr(y.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?y=Pr(y):x.type=="binary"&&typeof Ed<"u",y.slice(0,19)=="socialcalc:version:"?D3.to_sheet(x.type=="string"?y:Pr(y),x):c(y,x)}function d(m,x){return po(u(m,x),x)}function h(m){for(var x=[],y=vr(m["!ref"]),v,w=Array.isArray(m),g=y.s.r;g<=y.e.r;++g){for(var _=[],b=y.s.c;b<=y.e.c;++b){var N=Vt({r:g,c:b});if(v=w?(m[g]||[])[b]:m[N],!v||v.v==null){_.push("          ");continue}for(var S=(v.w||(vi(v),v.w)||"").slice(0,10);S.length<10;)S+=" ";_.push(S+(b===0?" ":""))}x.push(_.join(""))}return x.join(`
`)}return{to_workbook:d,to_sheet:u,from_sheet:h}})();function X$(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var a=C3.to_workbook(e,r);return r.WTF=s,a}catch(o){if(r.WTF=s,!o.message.match(/SYLK bad record ID/)&&s)throw o;return Uc.to_workbook(e,t)}}var tl=(function(){function e(I,X,H){if(I){Vs(I,I.l||0);for(var Q=H.Enum||Ne;I.l<I.length;){var ie=I.read_shift(2),B=Q[ie]||Q[65535],z=I.read_shift(2),ue=I.l+z,se=B.f&&B.f(I,z,H);if(I.l=ue,X(se,B,ie))return}}}function t(I,X){switch(X.type){case"base64":return r(Ba(qa(I)),X);case"binary":return r(Ba(I),X);case"buffer":case"array":return r(I,X)}throw"Unsupported type "+X.type}function r(I,X){if(!I)return I;var H=X||{},Q=H.dense?[]:{},ie="Sheet1",B="",z=0,ue={},se=[],re=[],W={s:{r:0,c:0},e:{r:0,c:0}},ce=H.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)H.Enum=Ne,e(I,function(T,A,G){switch(G){case 0:H.vers=T,T>=4096&&(H.qpro=!0);break;case 6:W=T;break;case 204:T&&(B=T);break;case 222:B=T;break;case 15:case 51:H.qpro||(T[1].v=T[1].v.slice(1));case 13:case 14:case 16:G==14&&(T[2]&112)==112&&(T[2]&15)>1&&(T[2]&15)<15&&(T[1].z=H.dateNF||Gt[14],H.cellDates&&(T[1].t="d",T[1].v=nm(T[1].v))),H.qpro&&T[3]>z&&(Q["!ref"]=Qt(W),ue[ie]=Q,se.push(ie),Q=H.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},z=T[3],ie=B||"Sheet"+(z+1),B="");var xe=H.dense?(Q[T[0].r]||[])[T[0].c]:Q[Vt(T[0])];if(xe){xe.t=T[1].t,xe.v=T[1].v,T[1].z!=null&&(xe.z=T[1].z),T[1].f!=null&&(xe.f=T[1].f);break}H.dense?(Q[T[0].r]||(Q[T[0].r]=[]),Q[T[0].r][T[0].c]=T[1]):Q[Vt(T[0])]=T[1];break}},H);else if(I[2]==26||I[2]==14)H.Enum=q,I[2]==14&&(H.qpro=!0,I.l=0),e(I,function(T,A,G){switch(G){case 204:ie=T;break;case 22:T[1].v=T[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(T[3]>z&&(Q["!ref"]=Qt(W),ue[ie]=Q,se.push(ie),Q=H.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},z=T[3],ie="Sheet"+(z+1)),ce>0&&T[0].r>=ce)break;H.dense?(Q[T[0].r]||(Q[T[0].r]=[]),Q[T[0].r][T[0].c]=T[1]):Q[Vt(T[0])]=T[1],W.e.c<T[0].c&&(W.e.c=T[0].c),W.e.r<T[0].r&&(W.e.r=T[0].r);break;case 27:T[14e3]&&(re[T[14e3][0]]=T[14e3][1]);break;case 1537:re[T[0]]=T[1],T[0]==z&&(ie=T[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(Q["!ref"]=Qt(W),ue[B||ie]=Q,se.push(B||ie),!re.length)return{SheetNames:se,Sheets:ue};for(var k={},de=[],U=0;U<re.length;++U)ue[se[U]]?(de.push(re[U]||se[U]),k[re[U]]=ue[re[U]]||ue[se[U]]):(de.push(re[U]),k[re[U]]={"!ref":"A1"});return{SheetNames:de,Sheets:k}}function s(I,X){var H=X||{};if(+H.codepage>=0&&Sn(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var Q=Na(),ie=vr(I["!ref"]),B=Array.isArray(I),z=[];kt(Q,0,o(1030)),kt(Q,6,d(ie));for(var ue=Math.min(ie.e.r,8191),se=ie.s.r;se<=ue;++se)for(var re=ms(se),W=ie.s.c;W<=ie.e.c;++W){se===ie.s.r&&(z[W]=Zr(W));var ce=z[W]+re,k=B?(I[se]||[])[W]:I[ce];if(!(!k||k.t=="z"))if(k.t=="n")(k.v|0)==k.v&&k.v>=-32768&&k.v<=32767?kt(Q,13,v(se,W,k.v)):kt(Q,14,g(se,W,k.v));else{var de=vi(k);kt(Q,15,x(se,W,de.slice(0,239)))}}return kt(Q,1),Q.end()}function a(I,X){var H=X||{};if(+H.codepage>=0&&Sn(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var Q=Na();kt(Q,0,c(I));for(var ie=0,B=0;ie<I.SheetNames.length;++ie)(I.Sheets[I.SheetNames[ie]]||{})["!ref"]&&kt(Q,27,ee(I.SheetNames[ie],B++));var z=0;for(ie=0;ie<I.SheetNames.length;++ie){var ue=I.Sheets[I.SheetNames[ie]];if(!(!ue||!ue["!ref"])){for(var se=vr(ue["!ref"]),re=Array.isArray(ue),W=[],ce=Math.min(se.e.r,8191),k=se.s.r;k<=ce;++k)for(var de=ms(k),U=se.s.c;U<=se.e.c;++U){k===se.s.r&&(W[U]=Zr(U));var T=W[U]+de,A=re?(ue[k]||[])[U]:ue[T];if(!(!A||A.t=="z"))if(A.t=="n")kt(Q,23,V(k,U,z,A.v));else{var G=vi(A);kt(Q,22,O(k,U,z,G.slice(0,239)))}}++z}}return kt(Q,1),Q.end()}function o(I){var X=it(2);return X.write_shift(2,I),X}function c(I){var X=it(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var H=0,Q=0,ie=0,B=0;B<I.SheetNames.length;++B){var z=I.SheetNames[B],ue=I.Sheets[z];if(!(!ue||!ue["!ref"])){++ie;var se=Ea(ue["!ref"]);H<se.e.r&&(H=se.e.r),Q<se.e.c&&(Q=se.e.c)}}return H>8191&&(H=8191),X.write_shift(2,H),X.write_shift(1,ie),X.write_shift(1,Q),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function u(I,X,H){var Q={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&H.qpro?(Q.s.c=I.read_shift(1),I.l++,Q.s.r=I.read_shift(2),Q.e.c=I.read_shift(1),I.l++,Q.e.r=I.read_shift(2),Q):(Q.s.c=I.read_shift(2),Q.s.r=I.read_shift(2),X==12&&H.qpro&&(I.l+=2),Q.e.c=I.read_shift(2),Q.e.r=I.read_shift(2),X==12&&H.qpro&&(I.l+=2),Q.s.c==65535&&(Q.s.c=Q.e.c=Q.s.r=Q.e.r=0),Q)}function d(I){var X=it(8);return X.write_shift(2,I.s.c),X.write_shift(2,I.s.r),X.write_shift(2,I.e.c),X.write_shift(2,I.e.r),X}function h(I,X,H){var Q=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(Q[0].c=I.read_shift(1),Q[3]=I.read_shift(1),Q[0].r=I.read_shift(2),I.l+=2):(Q[2]=I.read_shift(1),Q[0].c=I.read_shift(2),Q[0].r=I.read_shift(2)),Q}function m(I,X,H){var Q=I.l+X,ie=h(I,X,H);if(ie[1].t="s",H.vers==20768){I.l++;var B=I.read_shift(1);return ie[1].v=I.read_shift(B,"utf8"),ie}return H.qpro&&I.l++,ie[1].v=I.read_shift(Q-I.l,"cstr"),ie}function x(I,X,H){var Q=it(7+H.length);Q.write_shift(1,255),Q.write_shift(2,X),Q.write_shift(2,I),Q.write_shift(1,39);for(var ie=0;ie<Q.length;++ie){var B=H.charCodeAt(ie);Q.write_shift(1,B>=128?95:B)}return Q.write_shift(1,0),Q}function y(I,X,H){var Q=h(I,X,H);return Q[1].v=I.read_shift(2,"i"),Q}function v(I,X,H){var Q=it(7);return Q.write_shift(1,255),Q.write_shift(2,X),Q.write_shift(2,I),Q.write_shift(2,H,"i"),Q}function w(I,X,H){var Q=h(I,X,H);return Q[1].v=I.read_shift(8,"f"),Q}function g(I,X,H){var Q=it(13);return Q.write_shift(1,255),Q.write_shift(2,X),Q.write_shift(2,I),Q.write_shift(8,H,"f"),Q}function _(I,X,H){var Q=I.l+X,ie=h(I,X,H);if(ie[1].v=I.read_shift(8,"f"),H.qpro)I.l=Q;else{var B=I.read_shift(2);E(I.slice(I.l,I.l+B),ie),I.l+=B}return ie}function b(I,X,H){var Q=X&32768;return X&=-32769,X=(Q?I:0)+(X>=8192?X-16384:X),(Q?"":"$")+(H?Zr(X):ms(X))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(I,X){Vs(I,0);for(var H=[],Q=0,ie="",B="",z="",ue="";I.l<I.length;){var se=I[I.l++];switch(se){case 0:H.push(I.read_shift(8,"f"));break;case 1:B=b(X[0].c,I.read_shift(2),!0),ie=b(X[0].r,I.read_shift(2),!1),H.push(B+ie);break;case 2:{var re=b(X[0].c,I.read_shift(2),!0),W=b(X[0].r,I.read_shift(2),!1);B=b(X[0].c,I.read_shift(2),!0),ie=b(X[0].r,I.read_shift(2),!1),H.push(re+W+":"+B+ie)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(I.read_shift(2));break;case 6:{for(var ce="";se=I[I.l++];)ce+=String.fromCharCode(se);H.push('"'+ce.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:ue=H.pop(),z=H.pop(),H.push(["AND","OR"][se-20]+"("+z+","+ue+")");break;default:if(se<32&&S[se])ue=H.pop(),z=H.pop(),H.push(z+S[se]+ue);else if(N[se]){if(Q=N[se][1],Q==69&&(Q=I[I.l++]),Q>H.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+H.join("|")+"|");return}var k=H.slice(-Q);H.length-=Q,H.push(N[se][0]+"("+k.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}H.length==1?X[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function R(I){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=I.read_shift(2),X[3]=I[I.l++],X[0].c=I[I.l++],X}function L(I,X){var H=R(I);return H[1].t="s",H[1].v=I.read_shift(X-4,"cstr"),H}function O(I,X,H,Q){var ie=it(6+Q.length);ie.write_shift(2,I),ie.write_shift(1,H),ie.write_shift(1,X),ie.write_shift(1,39);for(var B=0;B<Q.length;++B){var z=Q.charCodeAt(B);ie.write_shift(1,z>=128?95:z)}return ie.write_shift(1,0),ie}function P(I,X){var H=R(I);H[1].v=I.read_shift(2);var Q=H[1].v>>1;if(H[1].v&1)switch(Q&7){case 0:Q=(Q>>3)*5e3;break;case 1:Q=(Q>>3)*500;break;case 2:Q=(Q>>3)/20;break;case 3:Q=(Q>>3)/200;break;case 4:Q=(Q>>3)/2e3;break;case 5:Q=(Q>>3)/2e4;break;case 6:Q=(Q>>3)/16;break;case 7:Q=(Q>>3)/64;break}return H[1].v=Q,H}function F(I,X){var H=R(I),Q=I.read_shift(4),ie=I.read_shift(4),B=I.read_shift(2);if(B==65535)return Q===0&&ie===3221225472?(H[1].t="e",H[1].v=15):Q===0&&ie===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var z=B&32768;return B=(B&32767)-16446,H[1].v=(1-z*2)*(ie*Math.pow(2,B+32)+Q*Math.pow(2,B)),H}function V(I,X,H,Q){var ie=it(14);if(ie.write_shift(2,I),ie.write_shift(1,H),ie.write_shift(1,X),Q==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var B=0,z=0,ue=0,se=0;return Q<0&&(B=1,Q=-Q),z=Math.log2(Q)|0,Q/=Math.pow(2,z-31),se=Q>>>0,(se&2147483648)==0&&(Q/=2,++z,se=Q>>>0),Q-=se,se|=2147483648,se>>>=0,Q*=Math.pow(2,32),ue=Q>>>0,ie.write_shift(4,ue),ie.write_shift(4,se),z+=16383+(B?32768:0),ie.write_shift(2,z),ie}function oe(I,X){var H=F(I);return I.l+=X-14,H}function D(I,X){var H=R(I),Q=I.read_shift(4);return H[1].v=Q>>6,H}function K(I,X){var H=R(I),Q=I.read_shift(8,"f");return H[1].v=Q,H}function M(I,X){var H=K(I);return I.l+=X-10,H}function ae(I,X){return I[I.l+X-1]==0?I.read_shift(X,"cstr"):""}function te(I,X){var H=I[I.l++];H>X-1&&(H=X-1);for(var Q="";Q.length<H;)Q+=String.fromCharCode(I[I.l++]);return Q}function Z(I,X,H){if(!(!H.qpro||X<21)){var Q=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var ie=I.read_shift(X-21,"cstr");return[Q,ie]}}function we(I,X){for(var H={},Q=I.l+X;I.l<Q;){var ie=I.read_shift(2);if(ie==14e3){for(H[ie]=[0,""],H[ie][0]=I.read_shift(2);I[I.l];)H[ie][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return H}function ee(I,X){var H=it(5+I.length);H.write_shift(2,14e3),H.write_shift(2,X);for(var Q=0;Q<I.length;++Q){var ie=I.charCodeAt(Q);H[H.l++]=ie>127?95:ie}return H[H.l++]=0,H}var Ne={0:{n:"BOF",f:Ss},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:te},65535:{n:""}},q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:oe},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:we},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:K},40:{n:"FORMULA28",f:M},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:a,to_workbook:t}})();function Y$(e){var t={},r=e.match(ca),s=0,a=!1;if(r)for(;s!=r.length;++s){var o=Kt(r[s]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;t.cp=pv[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return t}var J$=(function(){var e=Ad("t"),t=Ad("rPr");function r(o){var c=o.match(e);if(!c)return{t:"s",v:""};var u={t:"s",v:gr(c[1])},d=o.match(t);return d&&(u.s=Y$(d[1])),u}var s=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(c){return c.replace(s,"").split(a).map(r).filter(function(u){return u.v})}})(),Z$=(function(){var t=/(\r\n|\n)/g;function r(a,o,c){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),a.b&&(o.push("<b>"),c.push("</b>")),a.i&&(o.push("<i>"),c.push("</i>")),a.strike&&(o.push("<s>"),c.push("</s>"));var d=a.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(o.push("<"+d+">"),c.push("</"+d+">")),c.push("</span>"),a}function s(a){var o=[[],a.v,[]];return a.v?(a.s&&r(a.s,o[0],o[2]),o[0].join("")+o[1].replace(t,"<br/>")+o[2].join("")):""}return function(o){return o.map(s).join("")}})(),Q$=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,eH=/<(?:\w+:)?r>/,tH=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Bv(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=gr(Pr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=Pr(e),r&&(s.h=Nv(s.t))):e.match(eH)&&(s.r=Pr(e),s.t=gr(Pr((e.replace(tH,"").match(Q$)||[]).join("").replace(ca,""))),r&&(s.h=Z$(J$(s.r)))),s):{t:""}}var rH=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sH=/<(?:\w+:)?(?:si|sstItem)>/g,aH=/<\/(?:\w+:)?(?:si|sstItem)>/;function nH(e,t){var r=[],s="";if(!e)return r;var a=e.match(rH);if(a){s=a[2].replace(sH,"").split(aH);for(var o=0;o!=s.length;++o){var c=Bv(s[o].trim(),t);c!=null&&(r[r.length]=c)}a=Kt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var iH=/^\s|\s$|[\t\n\r]/;function O3(e,t){if(!t.bookSST)return"";var r=[xs];r[r.length]=St("sst",null,{xmlns:gl[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var a=e[s],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(iH)&&(o+=' xml:space="preserve"'),o+=">"+Ar(a.t)+"</t>"),o+="</si>",r[r.length]=o}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function oH(e){return[e.read_shift(4),e.read_shift(4)]}function lH(e,t){var r=[],s=!1;return Ei(e,function(o,c,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(c.T,!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function cH(e,t){return t||(t=it(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var uH=wz;function dH(e){var t=Na();mt(t,159,cH(e));for(var r=0;r<e.length;++r)mt(t,19,uH(e[r]));return mt(t,160),t.end()}function F3(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function xi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function fH(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=xi(e,4),t.U=xi(e,4),t.W=xi(e,4),t}function hH(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=o,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function mH(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(hH(e));return t}function pH(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function xH(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=xi(e,4),t.U=xi(e,4),t.W=xi(e,4),t}function gH(e){var t=xH(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function L3(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var a=!1;switch(s.AlgID){case 26126:case 26127:case 26128:a=s.Flags==36;break;case 26625:a=s.Flags==4;break;case 0:a=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function I3(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function yH(e){var t=xi(e);switch(t.Minor){case 2:return[t.Minor,vH(e)];case 3:return[t.Minor,wH()];case 4:return[t.Minor,bH(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function vH(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=L3(e,r),a=I3(e,e.length-e.l);return{t:"Std",h:s,v:a}}function wH(){throw new Error("File is password-protected: ECMA-376 Extensible")}function bH(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(ca,function(o){var c=Kt(o);switch(Un(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){s[u]=c[u]});break;case"<dataIntegrity":s.encryptedHmacKey=c.encryptedHmacKey,s.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(c);break;default:throw c[0]}}),s}function _H(e,t){var r={},s=r.EncryptionVersionInfo=xi(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=L3(e,a),t-=a,r.EncryptionVerifier=I3(e,t),r}function SH(e){var t={},r=t.EncryptionVersionInfo=xi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Uv(e){var t=0,r,s=F3(e),a=s.length+1,o,c,u,d,h;for(r=io(a),r[0]=s.length,o=1;o!=a;++o)r[o]=s[o-1];for(o=a-1;o>=0;--o)c=r[o],u=(t&16384)===0?0:1,d=t<<1&32767,h=u|d,t=h^c;return t^52811}var M3=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(c){return(c/2|c*128)&255},a=function(c,u){return s(c^u)},o=function(c){for(var u=t[c.length-1],d=104,h=c.length-1;h>=0;--h)for(var m=c[h],x=0;x!=7;++x)m&64&&(u^=r[d]),m*=2,--d;return u};return function(c){for(var u=F3(c),d=o(u),h=u.length,m=io(16),x=0;x!=16;++x)m[x]=0;var y,v,w;for((h&1)===1&&(y=d>>8,m[h]=a(e[0],y),--h,y=d&255,v=u[u.length-1],m[h]=a(v,y));h>0;)--h,y=d>>8,m[h]=a(u[h],y),--h,y=d&255,m[h]=a(u[h],y);for(h=15,w=15-u.length;w>0;)y=d>>8,m[h]=a(e[w],y),--h,--w,y=d&255,m[h]=a(u[h],y),--h,--w;return m}})(),kH=function(e,t,r,s,a){a||(a=t),s||(s=M3(e));var o,c;for(o=0;o!=t.length;++o)c=t[o],c^=s[r],c=(c>>5|c<<3)&255,a[o]=c,++r;return[a,r,s]},NH=function(e){var t=0,r=M3(e);return function(s){var a=kH("",s,t,r);return t=a[1],a[0]}};function EH(e,t,r,s){var a={key:Ss(e),verificationBytes:Ss(e)};return r.password&&(a.verifier=Uv(r.password)),s.valid=a.verificationBytes===a.verifier,s.valid&&(s.insitu=NH(r.password)),a}function jH(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=SH(e):s.Data=_H(e,t),s}function TH(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?jH(e,t-2,s):EH(e,r.biff>=8?t:t-2,r,s),s}var P3=(function(){function e(a,o){switch(o.type){case"base64":return t(qa(a),o);case"binary":return t(a,o);case"buffer":return t(ir&&Buffer.isBuffer(a)?a.toString("binary"):mo(a),o);case"array":return t(ll(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){var c=o||{},u=c.dense?[]:{},d=a.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(m,x){Array.isArray(u)&&(u[x]=[]);for(var y=/\\\w+\b/g,v=0,w,g=-1;w=y.exec(m);){switch(w[0]){case"\\cell":var _=m.slice(v,y.lastIndex-w[0].length);if(_[0]==" "&&(_=_.slice(1)),++g,_.length){var b={v:_,t:"s"};Array.isArray(u)?u[x][g]=b:u[Vt({r:x,c:g})]=b}break}v=y.lastIndex}g>h.e.c&&(h.e.c=g)}),u["!ref"]=Qt(h),u}function r(a,o){return po(e(a,o),o)}function s(a){for(var o=["{\\rtf1\\ansi"],c=vr(a["!ref"]),u,d=Array.isArray(a),h=c.s.r;h<=c.e.r;++h){o.push("\\trowd\\trautofit1");for(var m=c.s.c;m<=c.e.c;++m)o.push("\\cellx"+(m+1));for(o.push("\\pard\\intbl"),m=c.s.c;m<=c.e.c;++m){var x=Vt({r:h,c:m});u=d?(a[h]||[])[m]:a[x],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(vi(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}})();function AH(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Od(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function CH(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,a=Math.max(t,r,s),o=Math.min(t,r,s),c=a-o;if(c===0)return[0,0,t];var u=0,d=0,h=a+o;switch(d=c/(h>1?2-h:h),a){case t:u=((r-s)/c+6)%6;break;case r:u=(s-t)/c+2;break;case s:u=(t-r)/c+4;break}return[u/6,d,h/2]}function RH(e){var t=e[0],r=e[1],s=e[2],a=r*2*(s<.5?s:1-s),o=s-a/2,c=[o,o,o],u=6*t,d;if(r!==0)switch(u|0){case 0:case 6:d=a*u,c[0]+=a,c[1]+=d;break;case 1:d=a*(2-u),c[0]+=d,c[1]+=a;break;case 2:d=a*(u-2),c[1]+=a,c[2]+=d;break;case 3:d=a*(4-u),c[1]+=d,c[2]+=a;break;case 4:d=a*(u-4),c[2]+=a,c[0]+=d;break;case 5:d=a*(6-u),c[2]+=d,c[0]+=a;break}for(var h=0;h!=3;++h)c[h]=Math.round(c[h]*255);return c}function L0(e,t){if(t===0)return e;var r=CH(AH(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Od(RH(r))}var B3=6,DH=15,OH=1,ra=B3;function Fd(e){return Math.floor((e+Math.round(128/ra)/256)*ra)}function Ld(e){return Math.floor((e-5)/ra*100+.5)/100}function I0(e){return Math.round((e*ra+5)/ra*256)/256}function U1(e){return I0(Ld(Fd(e)))}function zv(e){var t=Math.abs(e-U1(e)),r=ra;if(t>.005)for(ra=OH;ra<DH;++ra)Math.abs(e-U1(e))<=t&&(t=Math.abs(e-U1(e)),r=ra);ra=r}function oo(e){e.width?(e.wpx=Fd(e.width),e.wch=Ld(e.wpx),e.MDW=ra):e.wpx?(e.wch=Ld(e.wpx),e.width=I0(e.wch),e.MDW=ra):typeof e.wch=="number"&&(e.width=I0(e.wch),e.wpx=Fd(e.width),e.MDW=ra),e.customWidth&&delete e.customWidth}var FH=96,U3=FH;function Id(e){return e*96/U3}function zc(e){return e*U3/96}var LH={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function IH(e,t,r,s){t.Borders=[];var a={},o=!1;(e[0].match(ca)||[]).forEach(function(c){var u=Kt(c);switch(Un(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=Wr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=Wr(u.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function MH(e,t,r,s){t.Fills=[];var a={},o=!1;(e[0].match(ca)||[]).forEach(function(c){var u=Kt(c);switch(Un(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function PH(e,t,r,s){t.Fonts=[];var a={},o=!1;(e[0].match(ca)||[]).forEach(function(c){var u=Kt(c);switch(Un(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=Pr(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?Wr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?Wr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?Wr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?Wr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?Wr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?Wr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?Wr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=pv[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=Wr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var d=Qo[a.color.index];a.color.index==81&&(d=Qo[1]),d||(d=Qo[1]),a.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=L0(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(s&&s.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function BH(e,t,r){t.NumberFmt=[];for(var s=os(Gt),a=0;a<s.length;++a)t.NumberFmt[s[a]]=Gt[s[a]];var o=e[0].match(ca);if(o)for(a=0;a<o.length;++a){var c=Kt(o[a]);switch(Un(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=gr(Pr(c.formatCode)),d=parseInt(c.numFmtId,10);if(t.NumberFmt[d]=u,d>0){if(d>392){for(d=392;d>60&&t.NumberFmt[d]!=null;--d);t.NumberFmt[d]=u}pi(u,d)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}function UH(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=St("numFmt",null,{numFmtId:s,formatCode:Ar(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=St("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Vh=["numFmtId","fillId","fontId","borderId","xfId"],Kh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function zH(e,t,r){t.CellXf=[];var s,a=!1;(e[0].match(ca)||[]).forEach(function(o){var c=Kt(o),u=0;switch(Un(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=c,delete s[0],u=0;u<Vh.length;++u)s[Vh[u]]&&(s[Vh[u]]=parseInt(s[Vh[u]],10));for(u=0;u<Kh.length;++u)s[Kh[u]]&&(s[Kh[u]]=Wr(s[Kh[u]]));if(t.NumberFmt&&s.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[u]){s.numFmtId=u;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};c.vertical&&(d.vertical=c.vertical),c.horizontal&&(d.horizontal=c.horizontal),c.textRotation!=null&&(d.textRotation=c.textRotation),c.indent&&(d.indent=c.indent),c.wrapText&&(d.wrapText=Wr(c.wrapText)),s.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}function qH(e){var t=[];return t[t.length]=St("cellXfs",null),e.forEach(function(r){t[t.length]=St("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=St("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var $H=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,d,h){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(t))&&BH(x,m,h),(x=u.match(a))&&PH(x,m,d,h),(x=u.match(s))&&MH(x,m,d,h),(x=u.match(o))&&IH(x,m,d,h),(x=u.match(r))&&zH(x,m,h),m}})();function z3(e,t){var r=[xs,St("styleSheet",null,{xmlns:gl[0],"xmlns:vt":Ts.vt})],s;return e.SSF&&(s=UH(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=qH(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function HH(e,t){var r=e.read_shift(2),s=ia(e);return[r,s]}function WH(e,t,r){r||(r=it(6+4*t.length)),r.write_shift(2,e),Is(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function GH(e,t,r){var s={};s.sz=e.read_shift(2)/20;var a=jz(e);a.fItalic&&(s.italic=1),a.fCondense&&(s.condense=1),a.fExtend&&(s.extend=1),a.fShadow&&(s.shadow=1),a.fOutline&&(s.outline=1),a.fStrikeout&&(s.strike=1);var o=e.read_shift(2);switch(o===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(s.underline=c);var u=e.read_shift(1);u>0&&(s.family=u);var d=e.read_shift(1);switch(d>0&&(s.charset=d),e.l++,s.color=Ez(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=ia(e),s}function VH(e,t){t||(t=it(153)),t.write_shift(2,e.sz*20),Tz(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),D0(e.color,t);var s=0;return s=2,t.write_shift(1,s),Is(e.name,t),t.length>t.l?t.slice(0,t.l):t}var KH=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],z1,XH=la;function QE(e,t){t||(t=it(84)),z1||(z1=sm(KH));var r=z1[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(D0({auto:1},t),D0({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function YH(e,t){var r=e.l+t,s=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:a}}function q3(e,t,r){r||(r=it(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Vu(e,t){return t||(t=it(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var JH=la;function ZH(e,t){return t||(t=it(51)),t.write_shift(1,0),Vu(null,t),Vu(null,t),Vu(null,t),Vu(null,t),Vu(null,t),t.length>t.l?t.slice(0,t.l):t}function QH(e,t){return t||(t=it(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),R0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function eW(e,t,r){var s=it(2052);return s.write_shift(4,e),R0(t,s),R0(r,s),s.length>s.l?s.slice(0,s.l):s}function tW(e,t,r){var s={};s.NumberFmt=[];for(var a in Gt)s.NumberFmt[a]=Gt[a];s.CellXf=[],s.Fonts=[];var o=[],c=!1;return Ei(e,function(d,h,m){switch(m){case 44:s.NumberFmt[d[0]]=d[1],pi(d[1],d[0]);break;case 43:s.Fonts.push(d),d.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(d.color.rgb=L0(t.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&s.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:o.push(m),c=!0;break;case 38:o.pop(),c=!1;break;default:if(h.T>0)o.push(m);else if(h.T<0)o.pop();else if(!c||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),s}function rW(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)t[a]!=null&&++r}),r!=0&&(mt(e,615,En(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)t[a]!=null&&mt(e,44,WH(a,t[a]))}),mt(e,616))}}function sW(e){var t=1;mt(e,611,En(t)),mt(e,43,VH({sz:12,color:{theme:1},name:"Calibri",family:2})),mt(e,612)}function aW(e){var t=2;mt(e,603,En(t)),mt(e,45,QE({patternType:"none"})),mt(e,45,QE({patternType:"gray125"})),mt(e,604)}function nW(e){var t=1;mt(e,613,En(t)),mt(e,46,ZH()),mt(e,614)}function iW(e){var t=1;mt(e,626,En(t)),mt(e,47,q3({numFmtId:0},65535)),mt(e,627)}function oW(e,t){mt(e,617,En(t.length)),t.forEach(function(r){mt(e,47,q3(r,0))}),mt(e,618)}function lW(e){var t=1;mt(e,619,En(t)),mt(e,48,QH({xfId:0,name:"Normal"})),mt(e,620)}function cW(e){var t=0;mt(e,505,En(t)),mt(e,506)}function uW(e){var t=0;mt(e,508,eW(t,"TableStyleMedium9","PivotStyleMedium4")),mt(e,509)}function dW(e,t){var r=Na();return mt(r,278),rW(r,e.SSF),sW(r),aW(r),nW(r),iW(r),oW(r,t.cellXfs),lW(r),cW(r),uW(r),mt(r,279),r.end()}var fW=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function hW(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(ca)||[]).forEach(function(a){var o=Kt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=o.val;break;case"<a:sysClr":s.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(t.themeElements.clrScheme[fW.indexOf(o[0])]=s,s={}):s.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function mW(){}function pW(){}var xW=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,gW=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,yW=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function vW(e,t,r){t.themeElements={};var s;[["clrScheme",xW,hW],["fontScheme",gW,mW],["fmtScheme",yW,pW]].forEach(function(a){if(!(s=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](s,t,r)})}var wW=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function $3(e,t){(!e||e.length===0)&&(e=qv());var r,s={};if(!(r=e.match(wW)))throw new Error("themeElements not found in theme");return vW(r[0],s,t),s.raw=e,s}function qv(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[xs];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function bW(e,t,r){var s=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=s;return}var o=e.slice(e.l);e.l=s;var c;try{c=LT(o,{type:"array"})}catch{return}var u=Ua(c,"theme/theme/theme1.xml",!0);if(u)return $3(u,r)}}function _W(e){return e.read_shift(4)}function SW(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=kW(e,4);break;case 2:t.xclrValue=_3(e);break;case 3:t.xclrValue=_W(e);break;case 4:e.l+=4;break}return e.l+=8,t}function kW(e,t){return la(e,t)}function NW(e,t){return la(e,t)}function EW(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=SW(e);break;case 6:s[1]=NW(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function jW(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(EW(e,r-e.l));return{ixfe:s,ext:o}}function TW(e,t){t.forEach(function(r){r[0]})}function AW(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ia(e)}}function CW(e){var t=it(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Is(e.name,t),t.slice(0,t.l)}function RW(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function DW(e){var t=it(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function OW(e,t){var r=it(8+2*t.length);return r.write_shift(4,e),Is(t,r),r.slice(0,r.l)}function FW(e){return e.l+=4,e.read_shift(4)!=0}function LW(e,t){var r=it(8);return r.write_shift(4,e),r.write_shift(4,1),r}function IW(e,t,r){var s={Types:[],Cell:[],Value:[]},a=r||{},o=[],c=!1,u=2;return Ei(e,function(d,h,m){switch(m){case 335:s.Types.push({name:d.name});break;case 51:d.forEach(function(x){u==1?s.Cell.push({type:s.Types[x[0]-1].name,index:x[1]}):u==0&&s.Value.push({type:s.Types[x[0]-1].name,index:x[1]})});break;case 337:u=d?1:0;break;case 338:u=2;break;case 35:o.push(m),c=!0;break;case 36:o.pop(),c=!1;break;default:if(!h.T){if(!c||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),s}function MW(){var e=Na();return mt(e,332),mt(e,334,En(1)),mt(e,335,CW({name:"XLDAPR",version:12e4,flags:3496657072})),mt(e,336),mt(e,339,OW(1,"XLDAPR")),mt(e,52),mt(e,35,En(514)),mt(e,4096,En(0)),mt(e,4097,cn(1)),mt(e,36),mt(e,53),mt(e,340),mt(e,337,LW(1)),mt(e,51,DW([[1,0]])),mt(e,338),mt(e,333),e.end()}function PW(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var a=!1,o=2,c;return e.replace(ca,function(u){var d=Kt(u);switch(Un(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<s.Types.length;++h)s.Types[h].name==d.name&&(c=s.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?s.Cell.push({type:s.Types[d.t-1].name,index:+d.v}):o==0&&s.Value.push({type:s.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+d.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return u}),s}function H3(){var e=[xs];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function BW(e){var t=[];if(!e)return t;var r=1;return(e.match(ca)||[]).forEach(function(s){var a=Kt(s);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function UW(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Vt(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function zW(e,t,r){var s=[];return Ei(e,function(o,c,u){switch(u){case 63:s.push(o);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),s}function qW(e,t,r,s){if(!e)return e;var a=s||{},o=!1;Ei(e,function(u,d,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!d.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},a)}function $W(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var bc=1024;function W3(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[St("xml",null,{"xmlns:v":La.v,"xmlns:o":La.o,"xmlns:x":La.x,"xmlns:mv":La.mv}).replace(/\/>/,">"),St("o:shapelayout",St("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),St("v:shapetype",[St("v:stroke",null,{joinstyle:"miter"}),St("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];bc<e*1e3;)bc+=1e3;return t.forEach(function(o){var c=Qr(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var d=u.type=="gradient"?St("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=St("v:fill",d,u),m={on:"t",obscured:"t"};++bc,a=a.concat(["<v:shape"+Cd({id:"_x0000_s"+bc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,St("v:shadow",null,m),St("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Xs("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),Xs("x:AutoFill","False"),Xs("x:Row",String(c.r)),Xs("x:Column",String(c.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function ej(e,t,r,s){var a=Array.isArray(e),o;t.forEach(function(c){var u=Qr(c.ref);if(a?(e[u.r]||(e[u.r]=[]),o=e[u.r][u.c]):o=e[c.ref],!o){o={t:"z"},a?e[u.r][u.c]=o:e[c.ref]=o;var d=vr(e["!ref"]||"BDWGO1000001:A1");d.s.r>u.r&&(d.s.r=u.r),d.e.r<u.r&&(d.e.r=u.r),d.s.c>u.c&&(d.s.c=u.c),d.e.c<u.c&&(d.e.c=u.c);var h=Qt(d);h!==e["!ref"]&&(e["!ref"]=h)}o.c||(o.c=[]);var m={a:c.author,t:c.t,r:c.r,T:r};c.h&&(m.h=c.h);for(var x=o.c.length-1;x>=0;--x){if(!r&&o.c[x].T)return;r&&!o.c[x].T&&o.c.splice(x,1)}if(r&&s){for(x=0;x<s.length;++x)if(m.a==s[x].id){m.a=s[x].name||m.a;break}}o.c.push(m)})}function HW(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var d=Kt(u[0]),h={author:d.authorId&&r[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},m=Qr(d.ref);if(!(t.sheetRows&&t.sheetRows<=m.r)){var x=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!x&&!!x[1]&&Bv(x[1])||{r:"",t:"",h:""};h.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),h.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(h.h=y.h),s.push(h)}}}}),s}function G3(e){var t=[xs,St("comments",null,{xmlns:gl[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(a){var o=Ar(a.a);r.indexOf(o)==-1&&(r.push(o),t.push("<author>"+o+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var a=0,o=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?a=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(d){d.a&&(a=r.indexOf(Ar(d.a))),o.push(d.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+a+'"><text>'),o.length<=1)t.push(Xs("t",Ar(o[0]||"")));else{for(var c=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)c+=`Reply:
    `+o[u]+`
`;t.push(Xs("t",Ar(c)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function WW(e,t){var r=[],s=!1,a={},o=0;return e.replace(ca,function(u,d){var h=Kt(u);switch(Un(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":o=d+u.length;break;case"</text>":a.t=e.slice(o,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return u}),r}function GW(e,t,r){var s=[xs,St("ThreadedComments",null,{xmlns:Ts.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var o="";(a[1]||[]).forEach(function(c,u){if(!c.T){delete c.ID;return}c.a&&t.indexOf(c.a)==-1&&t.push(c.a);var d={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?o=d.id:d.parentId=o,c.ID=d.id,c.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(c.a)).slice(-12)+"}"),s.push(St("threadedComment",Xs("text",c.t||""),d))})}),s.push("</ThreadedComments>"),s.join("")}function VW(e,t){var r=[],s=!1;return e.replace(ca,function(o){var c=Kt(o);switch(Un(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function KW(e){var t=[xs,St("personList",null,{xmlns:Ts.TCMNT,"xmlns:x":gl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(St("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function XW(e){var t={};t.iauthor=e.read_shift(4);var r=bl(e);return t.rfx=r.s,t.ref=Vt(r.s),e.l+=16,t}function YW(e,t){return t==null&&(t=it(36)),t.write_shift(4,e[1].iauthor),Jc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var JW=ia;function ZW(e){return Is(e.slice(0,54))}function QW(e,t){var r=[],s=[],a={},o=!1;return Ei(e,function(u,d,h){switch(h){case 632:s.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=s[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function eG(e){var t=Na(),r=[];return mt(t,628),mt(t,630),e.forEach(function(s){s[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),mt(t,632,ZW(a.a)))})}),mt(t,631),mt(t,633),e.forEach(function(s){s[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var o={s:Qr(s[0]),e:Qr(s[0])};mt(t,635,YW([o,a])),a.t&&a.t.length>0&&mt(t,637,_z(a)),mt(t,636),delete a.iauthor})}),mt(t,634),mt(t,629),t.end()}var tG="application/vnd.ms-office.vbaProject";function rG(e){var t=zt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");zt.utils.cfb_add(t,a,e.FileIndex[s].content)}}),zt.write(t)}function sG(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&zt.utils.cfb_add(e,a,t.FileIndex[s].content)}})}var V3=["xlsb","xlsm","xlam","biff8","xla"];function aG(){return{"!type":"dialog"}}function nG(){return{"!type":"dialog"}}function iG(){return{"!type":"macro"}}function oG(){return{"!type":"macro"}}var Ac=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,a,o,c){var u=!1,d=!1;o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,m=c.length>0?parseInt(c,10)|0:0;return u?m+=t.c:--m,d?h+=t.r:--h,a+(u?"":"$")+Zr(m)+(d?"":"$")+ms(h)}return function(a,o){return t=o,a.replace(e,r)}})(),$v=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Hv=(function(){return function(t,r){return t.replace($v,function(s,a,o,c,u,d){var h=Cv(c)-(o?0:r.c),m=Av(d)-(u?0:r.r),x=m==0?"":u?m+1:"["+m+"]",y=h==0?"":o?h+1:"["+h+"]";return a+"R"+x+"C"+y})}})();function K3(e,t){return e.replace($v,function(r,s,a,o,c,u){return s+(a=="$"?a+o:Zr(Cv(o)+t.c))+(c=="$"?c+u:ms(Av(u)+t.r))})}function lG(e,t,r){var s=Ea(t),a=s.s,o=Qr(r),c={r:o.r-a.r,c:o.c-a.c};return K3(e,c)}function cG(e){return e.length!=1}function tj(e){return e.replace(/_xlfn\./g,"")}function bs(e){e.l+=1}function lo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function X3(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return Y3(e);r.biff==12&&(s=4)}var a=e.read_shift(s),o=e.read_shift(s),c=lo(e),u=lo(e);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function Y3(e){var t=lo(e),r=lo(e),s=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function uG(e,t,r){if(r.biff<8)return Y3(e);var s=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),o=lo(e),c=lo(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function J3(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return dG(e);var s=e.read_shift(r&&r.biff==12?4:2),a=lo(e);return{r:s,c:a[0],cRel:a[1],rRel:a[2]}}function dG(e){var t=lo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function fG(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function hG(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return mG(e);var a=e.read_shift(s>=12?4:2),o=e.read_shift(2),c=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(c==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:c,rRel:u}}function mG(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:s}}function pG(e,t,r){var s=(e[e.l++]&96)>>5,a=X3(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,a]}function xG(e,t,r){var s=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var c=X3(e,o,r);return[s,a,c]}function gG(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function yG(e,t,r){var s=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[s,a]}function vG(e,t,r){var s=(e[e.l++]&96)>>5,a=uG(e,t-1,r);return[s,a]}function wG(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function rj(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function bG(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),a=[],o=0;o<=s;++o)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function _G(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function SG(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function kG(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function NG(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function Z3(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function EG(e){return e.read_shift(2),Z3(e)}function jG(e){return e.read_shift(2),Z3(e)}function TG(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var a=J3(e,0,r);return[s,a]}function AG(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var a=hG(e,0,r);return[s,a]}function CG(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var o=J3(e,0,r);return[s,a,o]}function RG(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[FV[a],t5[a],s]}function DG(e,t,r){var s=e[e.l++],a=e.read_shift(1),o=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:OG(e);return[a,(o[0]===0?t5:OV)[o[1]]]}function OG(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function FG(e,t,r){e.l+=r&&r.biff==2?3:4}function LG(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[s,a]}function IG(e){return e.l++,ji[e.read_shift(1)]}function MG(e){return e.l++,e.read_shift(2)}function PG(e){return e.l++,e.read_shift(1)!==0}function BG(e){return e.l++,sa(e)}function UG(e,t,r){return e.l++,tf(e,t-1,r)}function zG(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=hs(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ji[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=sa(e);break;case 2:r[1]=_l(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function qG(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),a=[],o=0;o!=s;++o)a.push((r.biff==12?bl:im)(e));return a}function $G(e,t,r){var s=0,a=0;r.biff==12?(s=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--a==0&&(a=256));for(var o=0,c=[];o!=s&&(c[o]=[]);++o)for(var u=0;u!=a;++u)c[o][u]=zG(e,r.biff);return c}function HG(e,t,r){var s=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,o=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,o]}function WG(e,t,r){if(r.biff==5)return GG(e);var s=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[s,a,o]}function GG(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function VG(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[s,a]}function KG(e,t,r){var s=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[s,a]}function XG(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function YG(e,t,r){var s=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[s,a]}var JG=la,ZG=la,QG=la;function sf(e,t,r){return e.l+=2,[fG(e)]}function Wv(e){return e.l+=6,[]}var eV=sf,tV=Wv,rV=Wv,sV=sf;function Q3(e){return e.l+=2,[Ss(e),e.read_shift(2)&1]}var aV=sf,nV=Q3,iV=Wv,oV=sf,lV=sf,cV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uV(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),c=cV[r>>2&31];return{ixti:t,coltype:r&3,rt:c,idx:s,c:a,C:o}}function dV(e){return e.l+=2,[e.read_shift(4)]}function fV(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function hV(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function mV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function pV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function xV(e){return e.l+=4,[0,0]}var sj={1:{n:"PtgExp",f:LG},2:{n:"PtgTbl",f:QG},3:{n:"PtgAdd",f:bs},4:{n:"PtgSub",f:bs},5:{n:"PtgMul",f:bs},6:{n:"PtgDiv",f:bs},7:{n:"PtgPower",f:bs},8:{n:"PtgConcat",f:bs},9:{n:"PtgLt",f:bs},10:{n:"PtgLe",f:bs},11:{n:"PtgEq",f:bs},12:{n:"PtgGe",f:bs},13:{n:"PtgGt",f:bs},14:{n:"PtgNe",f:bs},15:{n:"PtgIsect",f:bs},16:{n:"PtgUnion",f:bs},17:{n:"PtgRange",f:bs},18:{n:"PtgUplus",f:bs},19:{n:"PtgUminus",f:bs},20:{n:"PtgPercent",f:bs},21:{n:"PtgParen",f:bs},22:{n:"PtgMissArg",f:bs},23:{n:"PtgStr",f:UG},26:{n:"PtgSheet",f:fV},27:{n:"PtgEndSheet",f:hV},28:{n:"PtgErr",f:IG},29:{n:"PtgBool",f:PG},30:{n:"PtgInt",f:MG},31:{n:"PtgNum",f:BG},32:{n:"PtgArray",f:wG},33:{n:"PtgFunc",f:RG},34:{n:"PtgFuncVar",f:DG},35:{n:"PtgName",f:HG},36:{n:"PtgRef",f:TG},37:{n:"PtgArea",f:pG},38:{n:"PtgMemArea",f:VG},39:{n:"PtgMemErr",f:JG},40:{n:"PtgMemNoMem",f:ZG},41:{n:"PtgMemFunc",f:KG},42:{n:"PtgRefErr",f:XG},43:{n:"PtgAreaErr",f:gG},44:{n:"PtgRefN",f:AG},45:{n:"PtgAreaN",f:vG},46:{n:"PtgMemAreaN",f:mV},47:{n:"PtgMemNoMemN",f:pV},57:{n:"PtgNameX",f:WG},58:{n:"PtgRef3d",f:CG},59:{n:"PtgArea3d",f:xG},60:{n:"PtgRefErr3d",f:YG},61:{n:"PtgAreaErr3d",f:yG},255:{}},gV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yV={1:{n:"PtgElfLel",f:Q3},2:{n:"PtgElfRw",f:oV},3:{n:"PtgElfCol",f:eV},6:{n:"PtgElfRwV",f:lV},7:{n:"PtgElfColV",f:sV},10:{n:"PtgElfRadical",f:aV},11:{n:"PtgElfRadicalS",f:iV},13:{n:"PtgElfColS",f:tV},15:{n:"PtgElfColSV",f:rV},16:{n:"PtgElfRadicalLel",f:nV},25:{n:"PtgList",f:uV},29:{n:"PtgSxName",f:dV},255:{}},vV={0:{n:"PtgAttrNoop",f:xV},1:{n:"PtgAttrSemi",f:NG},2:{n:"PtgAttrIf",f:SG},4:{n:"PtgAttrChoose",f:bG},8:{n:"PtgAttrGoto",f:_G},16:{n:"PtgAttrSum",f:FG},32:{n:"PtgAttrBaxcel",f:rj},33:{n:"PtgAttrBaxcel",f:rj},64:{n:"PtgAttrSpace",f:EG},65:{n:"PtgAttrSpaceSemi",f:jG},128:{n:"PtgAttrIfError",f:kG},255:{}};function af(e,t,r,s){if(s.biff<8)return la(e,t);for(var a=e.l+t,o=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=$G(e,0,s),o.push(r[c][1]);break;case"PtgMemArea":r[c][2]=qG(e,r[c][1],s),o.push(r[c][2]);break;case"PtgExp":s&&s.biff==12&&(r[c][1][1]=e.read_shift(4),o.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return t=a-e.l,t!==0&&o.push(la(e,t)),o}function nf(e,t,r){for(var s=e.l+t,a,o,c=[];s!=e.l;)t=s-e.l,o=e[e.l],a=sj[o]||sj[gV[o]],(o===24||o===25)&&(a=(o===24?yV:vV)[e[e.l+1]]),!a||!a.f?la(e,t):c.push([a.n,a.f(e,t,r)]);return c}function wV(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],a=[],o=0;o<s.length;++o){var c=s[o];c?c[0]===2?a.push('"'+c[1].replace(/"/g,'""')+'"'):a.push(c[1]):a.push("")}t.push(a.join(","))}return t.join(";")}var bV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function _V(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function e5(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[s[0]][0]){case 357:return a=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?a:a+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return a=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?a:a+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[s[0]][0][3]?(a=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?a:a+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function aj(e,t,r){var s=e5(e,t,r);return s=="#REF"?s:_V(s,r)}function ta(e,t,r,s,a){var o=a&&a.biff||8,c={s:{c:0,r:0}},u=[],d,h,m,x=0,y=0,v,w="";if(!e[0]||!e[0][0])return"";for(var g=-1,_="",b=0,N=e[0].length;b<N;++b){var S=e[0][b];switch(S[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=u.pop(),h=u.pop(),g>=0){switch(e[0][g][1][0]){case 0:_=as(" ",e[0][g][1][1]);break;case 1:_=as("\r",e[0][g][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}h=h+_,g=-1}u.push(h+bV[S[0]]+d);break;case"PtgIsect":d=u.pop(),h=u.pop(),u.push(h+" "+d);break;case"PtgUnion":d=u.pop(),h=u.pop(),u.push(h+","+d);break;case"PtgRange":d=u.pop(),h=u.pop(),u.push(h+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=od(S[1][1],c,a),u.push(ld(m,o));break;case"PtgRefN":m=r?od(S[1][1],r,a):S[1][1],u.push(ld(m,o));break;case"PtgRef3d":x=S[1][1],m=od(S[1][2],c,a),w=aj(s,x,a),u.push(w+"!"+ld(m,o));break;case"PtgFunc":case"PtgFuncVar":var E=S[1][0],R=S[1][1];E||(E=0),E&=127;var L=E==0?[]:u.slice(-E);u.length-=E,R==="User"&&(R=L.shift()),u.push(R+"("+L.join(",")+")");break;case"PtgBool":u.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(S[1]);break;case"PtgNum":u.push(String(S[1]));break;case"PtgStr":u.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(S[1]);break;case"PtgAreaN":v=OE(S[1][1],r?{s:r}:c,a),u.push(M1(v,a));break;case"PtgArea":v=OE(S[1][1],c,a),u.push(M1(v,a));break;case"PtgArea3d":x=S[1][1],v=S[1][2],w=aj(s,x,a),u.push(w+"!"+M1(v,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=S[1][2];var O=(s.names||[])[y-1]||(s[0]||[])[y],P=O?O.Name:"SH33TJSNAME"+String(y);P&&P.slice(0,6)=="_xlfn."&&!a.xlfn&&(P=P.slice(6)),u.push(P);break;case"PtgNameX":var F=S[1][1];y=S[1][2];var V;if(a.biff<=5)F<0&&(F=-F),s[F]&&(V=s[F][y]);else{var oe="";if(((s[F]||[])[0]||[])[0]==14849||(((s[F]||[])[0]||[])[0]==1025?s[F][y]&&s[F][y].itab>0&&(oe=s.SheetNames[s[F][y].itab-1]+"!"):oe=s.SheetNames[y-1]+"!"),s[F]&&s[F][y])oe+=s[F][y].Name;else if(s[0]&&s[0][y])oe+=s[0][y].Name;else{var D=(e5(s,F,a)||"").split(";;");D[y-1]?oe=D[y-1]:oe+="SH33TJSERRX"}u.push(oe);break}V||(V={Name:"SH33TJSERRY"}),u.push(V.Name);break;case"PtgParen":var K="(",M=")";if(g>=0){switch(_="",e[0][g][1][0]){case 2:K=as(" ",e[0][g][1][1])+K;break;case 3:K=as("\r",e[0][g][1][1])+K;break;case 4:M=as(" ",e[0][g][1][1])+M;break;case 5:M=as("\r",e[0][g][1][1])+M;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}u.push(K+u.pop()+M);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:S[1][1],r:S[1][0]};var ae={c:r.c,r:r.r};if(s.sharedf[Vt(m)]){var te=s.sharedf[Vt(m)];u.push(ta(te,c,ae,s,a))}else{var Z=!1;for(d=0;d!=s.arrayf.length;++d)if(h=s.arrayf[d],!(m.c<h[0].s.c||m.c>h[0].e.c)&&!(m.r<h[0].s.r||m.r>h[0].e.r)){u.push(ta(h[1],c,ae,s,a)),Z=!0;break}Z||u.push(S[1])}break;case"PtgArray":u.push("{"+wV(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var we=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&we.indexOf(e[0][b][0])==-1){S=e[0][g];var ee=!0;switch(S[1][0]){case 4:ee=!1;case 0:_=as(" ",S[1][1]);break;case 5:ee=!1;case 1:_=as("\r",S[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}u.push((ee?_:"")+u.pop()+(ee?"":_)),g=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function SV(e,t,r){var s=e.l+t,a=r.biff==2?1:2,o,c=e.read_shift(a);if(c==65535)return[[],la(e,t-2)];var u=nf(e,c,r);return t!==c+a&&(o=af(e,t-c-a,u,r)),e.l=s,[u,o]}function kV(e,t,r){var s=e.l+t,a=r.biff==2?1:2,o,c=e.read_shift(a);if(c==65535)return[[],la(e,t-2)];var u=nf(e,c,r);return t!==c+a&&(o=af(e,t-c-a,u,r)),e.l=s,[u,o]}function NV(e,t,r,s){var a=e.l+t,o=nf(e,s,r),c;return a!==e.l&&(c=af(e,a-e.l,o,r)),[o,c]}function EV(e,t,r){var s=e.l+t,a,o=e.read_shift(2),c=nf(e,o,r);return o==65535?[[],la(e,t-2)]:(t!==o+2&&(a=af(e,s-o-2,c,r)),[c,a])}function jV(e){var t;if(fi(e,e.l+6)!==65535)return[sa(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function TV(e){if(e==null){var t=it(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return cl(e);return cl(0)}function q1(e,t,r){var s=e.l+t,a=zn(e);r.biff==2&&++e.l;var o=jV(e),c=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=kV(e,s-e.l,r);return{cell:a,val:o[0],formula:u,shared:c>>3&1,tt:o[1]}}function AV(e,t,r,s,a){var o=dl(t,r,a),c=TV(e.v),u=it(6),d=33;u.write_shift(2,d),u.write_shift(4,0);for(var h=it(e.bf.length),m=0;m<e.bf.length;++m)h[m]=e.bf[m];var x=Ls([o,c,u,h]);return x}function om(e,t,r){var s=e.read_shift(4),a=nf(e,s,r),o=e.read_shift(4),c=o>0?af(e,o,a,r):null;return[a,c]}var CV=om,lm=om,RV=om,DV=om,OV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},t5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function nj(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function LV(e){var t="of:="+e.replace($v,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function $1(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function IV(e){return e.replace(/\./,"!")}var ud={},Cc={},dd=typeof Map<"u";function Gv(e,t,r){var s=0,a=e.length;if(r){if(dd?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var o=dd?r.get(t):r[t];s<o.length;++s)if(e[o[s]].t===t)return e.Count++,o[s]}}else for(;s<a;++s)if(e[s].t===t)return e.Count++,s;return e[a]={t},e.Count++,e.Unique++,r&&(dd?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function cm(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(ra=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=Ld(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=I0(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function rl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function xo(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],a=60,o=e.length;if(s==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){pi(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=s=a;break}}for(a=0;a!=o;++a)if(e[a].numFmtId===s)return a;return e[o]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function r5(e,t,r,s,a,o){try{s.cellNF&&(e.z=Gt[t])}catch(u){if(s.WTF)throw u}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Gr(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(Gt[t]==null&&pi(OU[t]||"General",t),e.t==="e")e.w=e.w||ji[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Td(e.v);else if(e.t==="d"){var c=As(e.v);(c|0)===c?e.w=c.toString(10):e.w=Td(c)}else{if(e.v===void 0)return"";e.w=ol(e.v,Cc)}else e.t==="d"?e.w=fn(t,As(e.v),Cc):e.w=fn(t,e.v,Cc)}catch(u){if(s.WTF)throw u}if(s.cellStyles&&r!=null)try{e.s=o.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=L0(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=L0(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(s.WTF&&o.Fills)throw u}}}function MV(e,t,r){if(e&&e["!ref"]){var s=vr(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function PV(e,t){var r=vr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Qt(r))}var BV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,UV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,zV=/<(?:\w:)?hyperlink [^>]*>/mg,qV=/"(\w*:\w*)"/,$V=/<(?:\w:)?col\b[^>]*[\/]?>/g,HV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,WV=/<(?:\w:)?pageMargins[^>]*\/>/g,s5=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,GV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,VV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function KV(e,t,r,s,a,o,c){if(!e)return e;s||(s={"!id":{}});var u=t.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",m="",x=e.match(UV);x?(h=e.slice(0,x.index),m=e.slice(x.index+x[0].length)):h=m=e;var y=h.match(s5);y?Vv(y[0],u,a,r):(y=h.match(GV))&&YV(y[0],y[1]||"",u,a,r);var v=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var w=h.slice(v,v+50).match(qV);w&&PV(u,w[1])}var g=h.match(VV);g&&g[1]&&cK(g[1],a);var _=[];if(t.cellStyles){var b=h.match($V);b&&aK(_,b)}x&&fK(x[1],u,t,d,o,c);var N=m.match(HV);N&&(u["!autofilter"]=iK(N[0]));var S=[],E=m.match(BV);if(E)for(v=0;v!=E.length;++v)S[v]=vr(E[v].slice(E[v].indexOf('"')+1));var R=m.match(zV);R&&tK(u,R,s);var L=m.match(WV);if(L&&(u["!margins"]=rK(Kt(L[0]))),!u["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(u["!ref"]=Qt(d)),t.sheetRows>0&&u["!ref"]){var O=vr(u["!ref"]);t.sheetRows<=+O.e.r&&(O.e.r=t.sheetRows-1,O.e.r>d.e.r&&(O.e.r=d.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>d.e.c&&(O.e.c=d.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Qt(O))}return _.length>0&&(u["!cols"]=_),S.length>0&&(u["!merges"]=S),u}function XV(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Qt(e[r])+'"/>';return t+"</mergeCells>"}function Vv(e,t,r,s){var a=Kt(e);r.Sheets[s]||(r.Sheets[s]={}),a.codeName&&(r.Sheets[s].CodeName=gr(Pr(a.codeName)))}function YV(e,t,r,s,a){Vv(e.slice(0,e.indexOf(">")),r,s,a)}function JV(e,t,r,s,a){var o=!1,c={},u=null;if(s.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}o=!0,c.codeName=Pn(Ar(d))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),u=(u||"")+St("outlinePr",null,h)}!o&&!u||(a[a.length]=St("sheetPr",u,c))}var ZV=["objects","scenarios","selectLockedCells","selectUnlockedCells"],QV=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function eK(e){var t={sheet:1};return ZV.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),QV.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Uv(e.password).toString(16).toUpperCase()),St("sheetProtection",null,t)}function tK(e,t,r){for(var s=Array.isArray(e),a=0;a!=t.length;++a){var o=Kt(Pr(t[a]),!0);if(!o.ref)return;var c=((r||{})["!id"]||[])[o.id];c?(o.Target=c.Target,o.location&&(o.Target+="#"+gr(o.location))):(o.Target="#"+gr(o.location),c={Target:o.Target,TargetMode:"Internal"}),o.Rel=c,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=vr(o.ref),d=u.s.r;d<=u.e.r;++d)for(var h=u.s.c;h<=u.e.c;++h){var m=Vt({c:h,r:d});s?(e[d]||(e[d]=[]),e[d][h]||(e[d][h]={t:"z",v:void 0}),e[d][h].l=o):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=o)}}}function rK(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function sK(e){return rl(e),St("pageMargins",null,e)}function aK(e,t){for(var r=!1,s=0;s!=t.length;++s){var a=Kt(t[s],!0);a.hidden&&(a.hidden=Wr(a.hidden));var o=parseInt(a.min,10)-1,c=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,zv(a.width)),oo(a);o<=c;)e[o++]=Vr(a)}}function nK(e,t){for(var r=["<cols>"],s,a=0;a!=t.length;++a)(s=t[a])&&(r[r.length]=St("col",null,cm(a,s)));return r[r.length]="</cols>",r.join("")}function iK(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function oK(e,t,r,s){var a=typeof e.ref=="string"?e.ref:Qt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,c=Ea(a);c.s.r==c.e.r&&(c.e.r=Ea(t["!ref"]).e.r,a=Qt(c));for(var u=0;u<o.length;++u){var d=o[u];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+r.SheetNames[s]+"'!"+a;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+a}),St("autoFilter",null,{ref:a})}var lK=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function cK(e,t){t.Views||(t.Views=[{}]),(e.match(lK)||[]).forEach(function(r,s){var a=Kt(r);t.Views[s]||(t.Views[s]={}),+a.zoomScale&&(t.Views[s].zoom=+a.zoomScale),Wr(a.rightToLeft)&&(t.Views[s].RTL=!0)})}function uK(e,t,r,s){var a={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),St("sheetViews",St("sheetView",null,a),{})}function dK(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",o=e.t,c=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=ji[e.v];break;case"d":s&&s.cellDates?a=Gr(e.v,-1).toISOString():(e=Vr(e),e.t="n",a=""+(e.v=As(Gr(e.v)))),typeof e.z>"u"&&(e.z=Gt[14]);break;default:a=e.v;break}var u=Xs("v",Ar(a)),d={r:t},h=xo(s.cellXfs,e,s);switch(h!==0&&(d.s=h),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){u=Xs("v",""+Gv(s.Strings,e.v,s.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=o&&(e.t=o,e.v=c),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=St("f",Ar(e.f),m)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),St("c",u,d)}var fK=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=Ad("v"),c=Ad("f");return function(d,h,m,x,y,v){for(var w=0,g="",_=[],b=[],N=0,S=0,E=0,R="",L,O,P=0,F=0,V,oe,D=0,K=0,M=Array.isArray(v.CellXf),ae,te=[],Z=[],we=Array.isArray(h),ee=[],Ne={},q=!1,I=!!m.sheetStubs,X=d.split(t),H=0,Q=X.length;H!=Q;++H){g=X[H].trim();var ie=g.length;if(ie!==0){var B=0;e:for(w=0;w<ie;++w)switch(g[w]){case">":if(g[w-1]!="/"){++w;break e}if(m&&m.cellStyles){if(O=Kt(g.slice(B,w),!0),P=O.r!=null?parseInt(O.r,10):P+1,F=-1,m.sheetRows&&m.sheetRows<P)continue;Ne={},q=!1,O.ht&&(q=!0,Ne.hpt=parseFloat(O.ht),Ne.hpx=zc(Ne.hpt)),O.hidden=="1"&&(q=!0,Ne.hidden=!0),O.outlineLevel!=null&&(q=!0,Ne.level=+O.outlineLevel),q&&(ee[P-1]=Ne)}break;case"<":B=w;break}if(B>=w)break;if(O=Kt(g.slice(B,w),!0),P=O.r!=null?parseInt(O.r,10):P+1,F=-1,!(m.sheetRows&&m.sheetRows<P)){x.s.r>P-1&&(x.s.r=P-1),x.e.r<P-1&&(x.e.r=P-1),m&&m.cellStyles&&(Ne={},q=!1,O.ht&&(q=!0,Ne.hpt=parseFloat(O.ht),Ne.hpx=zc(Ne.hpt)),O.hidden=="1"&&(q=!0,Ne.hidden=!0),O.outlineLevel!=null&&(q=!0,Ne.level=+O.outlineLevel),q&&(ee[P-1]=Ne)),_=g.slice(w).split(e);for(var z=0;z!=_.length&&_[z].trim().charAt(0)=="<";++z);for(_=_.slice(z),w=0;w!=_.length;++w)if(g=_[w].trim(),g.length!==0){if(b=g.match(r),N=w,S=0,E=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,b!=null&&b.length===2){for(N=0,R=b[1],S=0;S!=R.length&&!((E=R.charCodeAt(S)-64)<1||E>26);++S)N=26*N+E;--N,F=N}else++F;for(S=0;S!=g.length&&g.charCodeAt(S)!==62;++S);if(++S,O=Kt(g.slice(0,S),!0),O.r||(O.r=Vt({r:P-1,c:F})),R=g.slice(S),L={t:""},(b=R.match(o))!=null&&b[1]!==""&&(L.v=gr(b[1])),m.cellFormula){if((b=R.match(c))!=null&&b[1]!==""){if(L.f=gr(Pr(b[1])).replace(/\r\n/g,`
`),m.xlfn||(L.f=tj(L.f)),b[0].indexOf('t="array"')>-1)L.F=(R.match(a)||[])[1],L.F.indexOf(":")>-1&&te.push([vr(L.F),L.F]);else if(b[0].indexOf('t="shared"')>-1){oe=Kt(b[0]);var ue=gr(Pr(b[1]));m.xlfn||(ue=tj(ue)),Z[parseInt(oe.si,10)]=[oe,ue,O.r]}}else(b=R.match(/<f[^>]*\/>/))&&(oe=Kt(b[0]),Z[oe.si]&&(L.f=lG(Z[oe.si][1],Z[oe.si][2],O.r)));var se=Qr(O.r);for(S=0;S<te.length;++S)se.r>=te[S][0].s.r&&se.r<=te[S][0].e.r&&se.c>=te[S][0].s.c&&se.c<=te[S][0].e.c&&(L.F=te[S][1])}if(O.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(I)L.t="z";else continue;else L.t=O.t||"n";switch(x.s.c>F&&(x.s.c=F),x.e.c<F&&(x.e.c=F),L.t){case"n":if(L.v==""||L.v==null){if(!I)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!I)continue;L.t="z"}else V=ud[parseInt(L.v,10)],L.v=V.t,L.r=V.r,m.cellHTML&&(L.h=V.h);break;case"str":L.t="s",L.v=L.v!=null?Pr(L.v):"",m.cellHTML&&(L.h=Nv(L.v));break;case"inlineStr":b=R.match(s),L.t="s",b!=null&&(V=Bv(b[1]))?(L.v=V.t,m.cellHTML&&(L.h=V.h)):L.v="";break;case"b":L.v=Wr(L.v);break;case"d":m.cellDates?L.v=Gr(L.v,1):(L.v=As(Gr(L.v,1)),L.t="n");break;case"e":(!m||m.cellText!==!1)&&(L.w=L.v),L.v=n3[L.v];break}if(D=K=0,ae=null,M&&O.s!==void 0&&(ae=v.CellXf[O.s],ae!=null&&(ae.numFmtId!=null&&(D=ae.numFmtId),m.cellStyles&&ae.fillId!=null&&(K=ae.fillId))),r5(L,D,K,m,y,v),m.cellDates&&M&&L.t=="n"&&Kc(Gt[D])&&(L.t="d",L.v=nm(L.v)),O.cm&&m.xlmeta){var re=(m.xlmeta.Cell||[])[+O.cm-1];re&&re.type=="XLDAPR"&&(L.D=!0)}if(we){var W=Qr(O.r);h[W.r]||(h[W.r]=[]),h[W.r][W.c]=L}else h[O.r]=L}}}}ee.length>0&&(h["!rows"]=ee)}})();function hK(e,t,r,s){var a=[],o=[],c=vr(e["!ref"]),u="",d,h="",m=[],x=0,y=0,v=e["!rows"],w=Array.isArray(e),g={r:h},_,b=-1;for(y=c.s.c;y<=c.e.c;++y)m[y]=Zr(y);for(x=c.s.r;x<=c.e.r;++x){for(o=[],h=ms(x),y=c.s.c;y<=c.e.c;++y){d=m[y]+h;var N=w?(e[x]||[])[y]:e[d];N!==void 0&&(u=dK(N,d,e,t))!=null&&o.push(u)}(o.length>0||v&&v[x])&&(g={r:h},v&&v[x]&&(_=v[x],_.hidden&&(g.hidden=1),b=-1,_.hpx?b=Id(_.hpx):_.hpt&&(b=_.hpt),b>-1&&(g.ht=b,g.customHeight=1),_.level&&(g.outlineLevel=_.level)),a[a.length]=St("row",o.join(""),g))}if(v)for(;x<v.length;++x)v&&v[x]&&(g={r:x+1},_=v[x],_.hidden&&(g.hidden=1),b=-1,_.hpx?b=Id(_.hpx):_.hpt&&(b=_.hpt),b>-1&&(g.ht=b,g.customHeight=1),_.level&&(g.outlineLevel=_.level),a[a.length]=St("row","",g));return a.join("")}function a5(e,t,r,s){var a=[xs,St("worksheet",null,{xmlns:gl[0],"xmlns:r":Ts.r})],o=r.SheetNames[e],c=0,u="",d=r.Sheets[o];d==null&&(d={});var h=d["!ref"]||"A1",m=vr(h);if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),h=Qt(m)}s||(s={}),d["!comments"]=[];var x=[];JV(d,r,e,t,a),a[a.length]=St("dimension",null,{ref:h}),a[a.length]=uK(d,t,e,r),t.sheetFormat&&(a[a.length]=St("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(a[a.length]=nK(d,d["!cols"])),a[c=a.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(u=hK(d,t),u.length>0&&(a[a.length]=u)),a.length>c+1&&(a[a.length]="</sheetData>",a[c]=a[c].replace("/>",">")),d["!protect"]&&(a[a.length]=eK(d["!protect"])),d["!autofilter"]!=null&&(a[a.length]=oK(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(a[a.length]=XV(d["!merges"]));var y=-1,v,w=-1;return d["!links"].length>0&&(a[a.length]="<hyperlinks>",d["!links"].forEach(function(g){g[1].Target&&(v={ref:g[0]},g[1].Target.charAt(0)!="#"&&(w=Tr(s,-1,Ar(g[1].Target).replace(/#.*$/,""),lr.HLINK),v["r:id"]="rId"+w),(y=g[1].Target.indexOf("#"))>-1&&(v.location=Ar(g[1].Target.slice(y+1))),g[1].Tooltip&&(v.tooltip=Ar(g[1].Tooltip)),a[a.length]=St("hyperlink",null,v))}),a[a.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(a[a.length]=sK(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Xs("ignoredErrors",St("ignoredError",null,{numberStoredAsText:1,sqref:h}))),x.length>0&&(w=Tr(s,-1,"../drawings/drawing"+(e+1)+".xml",lr.DRAW),a[a.length]=St("drawing",null,{"r:id":"rId"+w}),d["!drawing"]=x),d["!comments"].length>0&&(w=Tr(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",lr.VML),a[a.length]=St("legacyDrawing",null,{"r:id":"rId"+w}),d["!legacy"]=w),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function mK(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=s,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=a/20),r}function pK(e,t,r){var s=it(145),a=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var o=320;a.hpx?o=Id(a.hpx)*20:a.hpt&&(o=a.hpt*20),s.write_shift(2,o),s.write_shift(1,0);var c=0;a.level&&(c|=a.level),a.hidden&&(c|=16),(a.hpx||a.hpt)&&(c|=32),s.write_shift(1,c),s.write_shift(1,0);var u=0,d=s.l;s.l+=4;for(var h={r:e,c:0},m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var x=-1,y=-1,v=m<<10;v<m+1<<10;++v){h.c=v;var w=Array.isArray(r)?(r[h.r]||[])[h.c]:r[Vt(h)];w&&(x<0&&(x=v),y=v)}x<0||(++u,s.write_shift(4,x),s.write_shift(4,y))}var g=s.l;return s.l=d,s.write_shift(4,u),s.l=g,s.length>s.l?s.slice(0,s.l):s}function xK(e,t,r,s){var a=pK(s,r,t);(a.length>17||(t["!rows"]||[])[s])&&mt(e,0,a)}var gK=bl,yK=Jc;function vK(){}function wK(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=Sz(e),r}function bK(e,t,r){r==null&&(r=it(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var a=1;a<3;++a)r.write_shift(1,0);return D0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),e3(e,r),r.slice(0,r.l)}function _K(e){var t=mn(e);return[t]}function SK(e,t,r){return r==null&&(r=it(8)),yl(t,r)}function kK(e){var t=vl(e);return[t]}function NK(e,t,r){return r==null&&(r=it(4)),wl(t,r)}function EK(e){var t=mn(e),r=e.read_shift(1);return[t,r,"b"]}function jK(e,t,r){return r==null&&(r=it(9)),yl(t,r),r.write_shift(1,e.v?1:0),r}function TK(e){var t=vl(e),r=e.read_shift(1);return[t,r,"b"]}function AK(e,t,r){return r==null&&(r=it(5)),wl(t,r),r.write_shift(1,e.v?1:0),r}function CK(e){var t=mn(e),r=e.read_shift(1);return[t,r,"e"]}function RK(e,t,r){return r==null&&(r=it(9)),yl(t,r),r.write_shift(1,e.v),r}function DK(e){var t=vl(e),r=e.read_shift(1);return[t,r,"e"]}function OK(e,t,r){return r==null&&(r=it(8)),wl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function FK(e){var t=mn(e),r=e.read_shift(4);return[t,r,"s"]}function LK(e,t,r){return r==null&&(r=it(12)),yl(t,r),r.write_shift(4,t.v),r}function IK(e){var t=vl(e),r=e.read_shift(4);return[t,r,"s"]}function MK(e,t,r){return r==null&&(r=it(8)),wl(t,r),r.write_shift(4,t.v),r}function PK(e){var t=mn(e),r=sa(e);return[t,r,"n"]}function BK(e,t,r){return r==null&&(r=it(16)),yl(t,r),cl(e.v,r),r}function n5(e){var t=vl(e),r=sa(e);return[t,r,"n"]}function UK(e,t,r){return r==null&&(r=it(12)),wl(t,r),cl(e.v,r),r}function zK(e){var t=mn(e),r=Fv(e);return[t,r,"n"]}function qK(e,t,r){return r==null&&(r=it(12)),yl(t,r),t3(e.v,r),r}function $K(e){var t=vl(e),r=Fv(e);return[t,r,"n"]}function HK(e,t,r){return r==null&&(r=it(8)),wl(t,r),t3(e.v,r),r}function WK(e){var t=mn(e),r=Rv(e);return[t,r,"is"]}function GK(e){var t=mn(e),r=ia(e);return[t,r,"str"]}function VK(e,t,r){return r==null&&(r=it(12+4*e.v.length)),yl(t,r),Is(e.v,r),r.length>r.l?r.slice(0,r.l):r}function KK(e){var t=vl(e),r=ia(e);return[t,r,"str"]}function XK(e,t,r){return r==null&&(r=it(8+4*e.v.length)),wl(t,r),Is(e.v,r),r.length>r.l?r.slice(0,r.l):r}function YK(e,t,r){var s=e.l+t,a=mn(e);a.r=r["!row"];var o=e.read_shift(1),c=[a,o,"b"];if(r.cellFormula){e.l+=2;var u=lm(e,s-e.l,r);c[3]=ta(u,null,a,r.supbooks,r)}else e.l=s;return c}function JK(e,t,r){var s=e.l+t,a=mn(e);a.r=r["!row"];var o=e.read_shift(1),c=[a,o,"e"];if(r.cellFormula){e.l+=2;var u=lm(e,s-e.l,r);c[3]=ta(u,null,a,r.supbooks,r)}else e.l=s;return c}function ZK(e,t,r){var s=e.l+t,a=mn(e);a.r=r["!row"];var o=sa(e),c=[a,o,"n"];if(r.cellFormula){e.l+=2;var u=lm(e,s-e.l,r);c[3]=ta(u,null,a,r.supbooks,r)}else e.l=s;return c}function QK(e,t,r){var s=e.l+t,a=mn(e);a.r=r["!row"];var o=ia(e),c=[a,o,"str"];if(r.cellFormula){e.l+=2;var u=lm(e,s-e.l,r);c[3]=ta(u,null,a,r.supbooks,r)}else e.l=s;return c}var eX=bl,tX=Jc;function rX(e,t){return t==null&&(t=it(4)),t.write_shift(4,e),t}function sX(e,t){var r=e.l+t,s=bl(e),a=Dv(e),o=ia(e),c=ia(e),u=ia(e);e.l=r;var d={rfx:s,relId:a,loc:o,display:u};return c&&(d.Tooltip=c),d}function aX(e,t){var r=it(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Jc({s:Qr(e[0]),e:Qr(e[0])},r),Ov("rId"+t,r);var s=e[1].Target.indexOf("#"),a=s==-1?"":e[1].Target.slice(s+1);return Is(a||"",r),Is(e[1].Tooltip||"",r),Is("",r),r.slice(0,r.l)}function nX(){}function iX(e,t,r){var s=e.l+t,a=r3(e),o=e.read_shift(1),c=[a];if(c[2]=o,r.cellFormula){var u=CV(e,s-e.l,r);c[1]=u}else e.l=s;return c}function oX(e,t,r){var s=e.l+t,a=bl(e),o=[a];if(r.cellFormula){var c=DV(e,s-e.l,r);o[1]=c,e.l=s}else e.l=s;return o}function lX(e,t,r){r==null&&(r=it(18));var s=cm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof s.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var i5=["left","right","top","bottom","header","footer"];function cX(e){var t={};return i5.forEach(function(r){t[r]=sa(e)}),t}function uX(e,t){return t==null&&(t=it(48)),rl(e),i5.forEach(function(r){cl(e[r],t)}),t}function dX(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function fX(e,t,r){r==null&&(r=it(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function hX(e){var t=it(24);return t.write_shift(4,4),t.write_shift(4,1),Jc(e,t),t}function mX(e,t){return t==null&&(t=it(66)),t.write_shift(2,e.password?Uv(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function pX(){}function xX(){}function gX(e,t,r,s,a,o,c){if(!e)return e;var u=t||{};s||(s={"!id":{}});var d=u.dense?[]:{},h,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,y=!1,v,w,g,_,b,N,S,E,R,L=[];u.biff=12,u["!row"]=0;var O=0,P=!1,F=[],V={},oe=u.supbooks||a.supbooks||[[]];if(oe.sharedf=V,oe.arrayf=F,oe.SheetNames=a.SheetNames||a.Sheets.map(function(we){return we.name}),!u.supbooks&&(u.supbooks=oe,a.Names))for(var D=0;D<a.Names.length;++D)oe[0][D+1]=a.Names[D];var K=[],M=[],ae=!1;Md[16]={n:"BrtShortReal",f:n5};var te;if(Ei(e,function(ee,Ne,q){if(!y)switch(q){case 148:h=ee;break;case 0:v=ee,u.sheetRows&&u.sheetRows<=v.r&&(y=!0),E=ms(_=v.r),u["!row"]=v.r,(ee.hidden||ee.hpt||ee.level!=null)&&(ee.hpt&&(ee.hpx=zc(ee.hpt)),M[ee.r]=ee);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:ee[2]},ee[2]){case"n":w.v=ee[1];break;case"s":S=ud[ee[1]],w.v=S.t,w.r=S.r;break;case"b":w.v=!!ee[1];break;case"e":w.v=ee[1],u.cellText!==!1&&(w.w=ji[w.v]);break;case"str":w.t="s",w.v=ee[1];break;case"is":w.t="s",w.v=ee[1].t;break}if((g=c.CellXf[ee[0].iStyleRef])&&r5(w,g.numFmtId,null,u,o,c),b=ee[0].c==-1?b+1:ee[0].c,u.dense?(d[_]||(d[_]=[]),d[_][b]=w):d[Zr(b)+E]=w,u.cellFormula){for(P=!1,O=0;O<F.length;++O){var I=F[O];v.r>=I[0].s.r&&v.r<=I[0].e.r&&b>=I[0].s.c&&b<=I[0].e.c&&(w.F=Qt(I[0]),P=!0)}!P&&ee.length>3&&(w.f=ee[3])}if(m.s.r>v.r&&(m.s.r=v.r),m.s.c>b&&(m.s.c=b),m.e.r<v.r&&(m.e.r=v.r),m.e.c<b&&(m.e.c=b),u.cellDates&&g&&w.t=="n"&&Kc(Gt[g.numFmtId])){var X=Yo(w.v);X&&(w.t="d",w.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}te&&(te.type=="XLDAPR"&&(w.D=!0),te=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;w={t:"z",v:void 0},b=ee[0].c==-1?b+1:ee[0].c,u.dense?(d[_]||(d[_]=[]),d[_][b]=w):d[Zr(b)+E]=w,m.s.r>v.r&&(m.s.r=v.r),m.s.c>b&&(m.s.c=b),m.e.r<v.r&&(m.e.r=v.r),m.e.c<b&&(m.e.c=b),te&&(te.type=="XLDAPR"&&(w.D=!0),te=void 0);break;case 176:L.push(ee);break;case 49:te=((u.xlmeta||{}).Cell||[])[ee-1];break;case 494:var H=s["!id"][ee.relId];for(H?(ee.Target=H.Target,ee.loc&&(ee.Target+="#"+ee.loc),ee.Rel=H):ee.relId==""&&(ee.Target="#"+ee.loc),_=ee.rfx.s.r;_<=ee.rfx.e.r;++_)for(b=ee.rfx.s.c;b<=ee.rfx.e.c;++b)u.dense?(d[_]||(d[_]=[]),d[_][b]||(d[_][b]={t:"z",v:void 0}),d[_][b].l=ee):(N=Vt({c:b,r:_}),d[N]||(d[N]={t:"z",v:void 0}),d[N].l=ee);break;case 426:if(!u.cellFormula)break;F.push(ee),R=u.dense?d[_][b]:d[Zr(b)+E],R.f=ta(ee[1],m,{r:v.r,c:b},oe,u),R.F=Qt(ee[0]);break;case 427:if(!u.cellFormula)break;V[Vt(ee[0].s)]=ee[1],R=u.dense?d[_][b]:d[Zr(b)+E],R.f=ta(ee[1],m,{r:v.r,c:b},oe,u);break;case 60:if(!u.cellStyles)break;for(;ee.e>=ee.s;)K[ee.e--]={width:ee.w/256,hidden:!!(ee.flags&1),level:ee.level},ae||(ae=!0,zv(ee.w/256)),oo(K[ee.e+1]);break;case 161:d["!autofilter"]={ref:Qt(ee)};break;case 476:d["!margins"]=ee;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ee.name&&(a.Sheets[r].CodeName=ee.name),(ee.above||ee.left)&&(d["!outline"]={above:ee.above,left:ee.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ee.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!Ne.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+q.toString(16))}}},u),delete u.supbooks,delete u["!row"],!d["!ref"]&&(m.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(d["!ref"]=Qt(h||m)),u.sheetRows&&d["!ref"]){var Z=vr(d["!ref"]);u.sheetRows<=+Z.e.r&&(Z.e.r=u.sheetRows-1,Z.e.r>m.e.r&&(Z.e.r=m.e.r),Z.e.r<Z.s.r&&(Z.s.r=Z.e.r),Z.e.c>m.e.c&&(Z.e.c=m.e.c),Z.e.c<Z.s.c&&(Z.s.c=Z.e.c),d["!fullref"]=d["!ref"],d["!ref"]=Qt(Z))}return L.length>0&&(d["!merges"]=L),K.length>0&&(d["!cols"]=K),M.length>0&&(d["!rows"]=M),d}function yX(e,t,r,s,a,o,c){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Vr(t),t.z=t.z||Gt[14],t.v=As(Gr(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var d={r,c:s};switch(d.s=xo(a.cellXfs,t,a),t.l&&o["!links"].push([Vt(d),t.l]),t.c&&o["!comments"].push([Vt(d),t.c]),t.t){case"s":case"str":return a.bookSST?(u=Gv(a.Strings,t.v,a.revStrings),d.t="s",d.v=u,c?mt(e,18,MK(t,d)):mt(e,7,LK(t,d))):(d.t="str",c?mt(e,17,XK(t,d)):mt(e,6,VK(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?c?mt(e,13,HK(t,d)):mt(e,2,qK(t,d)):c?mt(e,16,UK(t,d)):mt(e,5,BK(t,d)),!0;case"b":return d.t="b",c?mt(e,15,AK(t,d)):mt(e,4,jK(t,d)),!0;case"e":return d.t="e",c?mt(e,14,OK(t,d)):mt(e,3,RK(t,d)),!0}return c?mt(e,12,NK(t,d)):mt(e,1,SK(t,d)),!0}function vX(e,t,r,s){var a=vr(t["!ref"]||"A1"),o,c="",u=[];mt(e,145);var d=Array.isArray(t),h=a.e.r;t["!rows"]&&(h=Math.max(a.e.r,t["!rows"].length-1));for(var m=a.s.r;m<=h;++m){c=ms(m),xK(e,t,a,m);var x=!1;if(m<=a.e.r)for(var y=a.s.c;y<=a.e.c;++y){m===a.s.r&&(u[y]=Zr(y)),o=u[y]+c;var v=d?(t[m]||[])[y]:t[o];if(!v){x=!1;continue}x=yX(e,v,m,y,s,t,x)}}mt(e,146)}function wX(e,t){!t||!t["!merges"]||(mt(e,177,rX(t["!merges"].length)),t["!merges"].forEach(function(r){mt(e,176,tX(r))}),mt(e,178))}function bX(e,t){!t||!t["!cols"]||(mt(e,390),t["!cols"].forEach(function(r,s){r&&mt(e,60,lX(s,r))}),mt(e,391))}function _X(e,t){!t||!t["!ref"]||(mt(e,648),mt(e,649,hX(vr(t["!ref"]))),mt(e,650))}function SX(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var a=Tr(r,-1,s[1].Target.replace(/#.*$/,""),lr.HLINK);mt(e,494,aX(s,a))}}),delete t["!links"]}function kX(e,t,r,s){if(t["!comments"].length>0){var a=Tr(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",lr.VML);mt(e,551,Ov("rId"+a)),t["!legacy"]=a}}function NX(e,t,r,s){if(t["!autofilter"]){var a=t["!autofilter"],o=typeof a.ref=="string"?a.ref:Qt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var c=r.Workbook.Names,u=Ea(o);u.s.r==u.e.r&&(u.e.r=Ea(t["!ref"]).e.r,o=Qt(u));for(var d=0;d<c.length;++d){var h=c[d];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==s){h.Ref="'"+r.SheetNames[s]+"'!"+o;break}}d==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+o}),mt(e,161,Jc(vr(o))),mt(e,162)}}function EX(e,t,r){mt(e,133),mt(e,137,fX(t,r)),mt(e,138),mt(e,134)}function jX(e,t){t["!protect"]&&mt(e,535,mX(t["!protect"]))}function TX(e,t,r,s){var a=Na(),o=r.SheetNames[e],c=r.Sheets[o]||{},u=o;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var d=vr(c["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],mt(a,129),(r.vbaraw||c["!outline"])&&mt(a,147,bK(u,c["!outline"])),mt(a,148,yK(d)),EX(a,c,r.Workbook),bX(a,c),vX(a,c,e,t),jX(a,c),NX(a,c,r,e),wX(a,c),SX(a,c,s),c["!margins"]&&mt(a,476,uX(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&_X(a,c),kX(a,c,e,s),mt(a,130),a.end()}function AX(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var c=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(t[+c[1]]=r?+c[2]:c[2])});var a=gr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){s=o.replace(/<.*?>/g,"")}),[t,a,s]}function CX(e,t,r,s,a,o){var c=o||{"!type":"chart"};if(!e)return o;var u=0,d=0,h="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var y=AX(x);m.s.r=m.s.c=0,m.e.c=u,h=Zr(u),y[0].forEach(function(v,w){c[h+ms(w)]={t:"n",v,z:y[1]},d=w}),m.e.r<d&&(m.e.r=d),++u}),u>0&&(c["!ref"]=Qt(m)),c}function RX(e,t,r,s,a){if(!e)return e;s||(s={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c,u=e.match(s5);return u&&Vv(u[0],o,a,r),(c=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=c[1]),s["!id"][o["!rel"]]&&(o["!drawel"]=s["!id"][o["!rel"]]),o}function DX(e,t){e.l+=10;var r=ia(e);return{name:r}}function OX(e,t,r,s,a){if(!e)return e;s||(s={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c=!1;return Ei(e,function(d,h,m){switch(m){case 550:o["!rel"]=d;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),d.name&&(a.Sheets[r].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!c||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},t),s["!id"][o["!rel"]]&&(o["!drawel"]=s["!id"][o["!rel"]]),o}var Kv=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],FX=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],LX=[],IX=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ij(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],a=0;a!=t.length;++a){var o=t[a];if(s[o[0]]==null)s[o[0]]=o[1];else switch(o[2]){case"bool":typeof s[o[0]]=="string"&&(s[o[0]]=Wr(s[o[0]]));break;case"int":typeof s[o[0]]=="string"&&(s[o[0]]=parseInt(s[o[0]],10));break}}}function oj(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=Wr(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function o5(e){oj(e.WBProps,Kv),oj(e.CalcPr,IX),ij(e.WBView,FX),ij(e.Sheets,LX),Cc.date1904=Wr(e.WBProps.date1904)}function MX(e){return!e.Workbook||!e.Workbook.WBProps?"false":Wr(e.Workbook.WBProps.date1904)?"true":"false"}var PX="][*?/\\".split("");function l5(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return PX.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function BX(e,t,r){e.forEach(function(s,a){l5(s);for(var o=0;o<a;++o)if(s==e[o])throw new Error("Duplicate Sheet Name: "+s);if(r){var c=t&&t[a]&&t[a].CodeName||s;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function UX(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];BX(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)MV(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var zX=/<\w+:workbook/;function qX(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,a="xmlns",o={},c=0;if(e.replace(ca,function(d,h){var m=Kt(d);switch(Un(m[0])){case"<?xml":break;case"<workbook":d.match(zX)&&(a="xmlns"+d.match(/<(\w+):/)[1]),r.xmlns=m[a];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Kv.forEach(function(x){if(m[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=Wr(m[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(m[x[0]],10);break;default:r.WBProps[x[0]]=m[x[0]]}}),m.codeName&&(r.WBProps.CodeName=Pr(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=gr(Pr(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":o={},o.Name=Pr(m.name),m.comment&&(o.Comment=m.comment),m.localSheetId&&(o.Sheet=+m.localSheetId),Wr(m.hidden||"0")&&(o.Hidden=!0),c=h+d.length;break;case"</definedName>":o.Ref=gr(Pr(e.slice(c,h))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return d}),gl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return o5(r),r}function c5(e){var t=[xs];t[t.length]=St("workbook",null,{xmlns:gl[0],"xmlns:r":Ts.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Kv.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(s[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=St("workbookPr",null,s);var a=e.Workbook&&e.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var c={name:Ar(e.SheetNames[o].slice(0,31))};if(c.sheetId=""+(o+1),c["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}t[t.length]=St("sheet",null,c)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var d={name:u.Name};u.Comment&&(d.comment=u.Comment),u.Sheet!=null&&(d.localSheetId=""+u.Sheet),u.Hidden&&(d.hidden="1"),u.Ref&&(t[t.length]=St("definedName",Ar(u.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function $X(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ky(e),r.name=ia(e),r}function HX(e,t){return t||(t=it(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Ov(e.strRelID,t),Is(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function WX(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?ia(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function GX(e,t){t||(t=it(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),e3(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function VX(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function KX(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),o=kz(e),c=RV(e,0,r),u=Dv(e);e.l=s;var d={Name:o,Ptg:c};return a<268435455&&(d.Sheet=a),u&&(d.Comment=u),d}function XX(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],a=!1;t||(t={}),t.biff=12;var o=[],c=[[]];return c.SheetNames=[],c.XTI=[],Md[16]={n:"BrtFRTArchID$",f:VX},Ei(e,function(d,h,m){switch(m){case 156:c.SheetNames.push(d.name),r.Sheets.push(d);break;case 153:r.WBProps=d;break;case 39:d.Sheet!=null&&(t.SID=d.Sheet),d.Ref=ta(d.Ptg,null,null,c,t),delete t.SID,delete d.Ptg,o.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([m,d]):c[0]=[m,d],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(d),c.XTI=c.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(m),a=!0;break;case 36:s.pop(),a=!1;break;case 37:s.push(m),a=!0;break;case 38:s.pop(),a=!1;break;case 16:break;default:if(!h.T){if(!a||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},t),o5(r),r.Names=o,r.supbooks=c,r}function YX(e,t){mt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};mt(e,156,HX(a))}mt(e,144)}function JX(e,t){t||(t=it(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Is("SheetJS",t),Is(N0.version,t),Is(N0.version,t),Is("7262",t),t.length>t.l?t.slice(0,t.l):t}function ZX(e,t){t||(t=it(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function QX(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,a=-1,o=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&a==-1?a=s:r[s].Hidden==1&&o==-1&&(o=s);o>a||(mt(e,135),mt(e,158,ZX(a)),mt(e,136))}}function eY(e,t){var r=Na();return mt(r,131),mt(r,128,JX()),mt(r,153,GX(e.Workbook&&e.Workbook.WBProps||null)),QX(r,e),YX(r,e),mt(r,132),r.end()}function tY(e,t,r){return t.slice(-4)===".bin"?XX(e,r):qX(e,r)}function rY(e,t,r,s,a,o,c,u){return t.slice(-4)===".bin"?gX(e,s,r,a,o,c,u):KV(e,s,r,a,o,c,u)}function sY(e,t,r,s,a,o,c,u){return t.slice(-4)===".bin"?OX(e,s,r,a,o):RX(e,s,r,a,o)}function aY(e,t,r,s,a,o,c,u){return t.slice(-4)===".bin"?iG():oG()}function nY(e,t,r,s,a,o,c,u){return t.slice(-4)===".bin"?aG():nG()}function iY(e,t,r,s){return t.slice(-4)===".bin"?tW(e,r,s):$H(e,r,s)}function oY(e,t,r){return $3(e,r)}function lY(e,t,r){return t.slice(-4)===".bin"?lH(e,r):nH(e,r)}function cY(e,t,r){return t.slice(-4)===".bin"?QW(e,r):HW(e,r)}function uY(e,t,r){return t.slice(-4)===".bin"?zW(e):BW(e)}function dY(e,t,r,s){return r.slice(-4)===".bin"?qW(e,t,r,s):void 0}function fY(e,t,r){return t.slice(-4)===".bin"?IW(e,t,r):PW(e,t,r)}function hY(e,t,r){return(t.slice(-4)===".bin"?eY:c5)(e)}function mY(e,t,r,s,a){return(t.slice(-4)===".bin"?TX:a5)(e,r,s,a)}function pY(e,t,r){return(t.slice(-4)===".bin"?dW:z3)(e,r)}function xY(e,t,r){return(t.slice(-4)===".bin"?dH:O3)(e,r)}function gY(e,t,r){return(t.slice(-4)===".bin"?eG:G3)(e)}function yY(e){return(e.slice(-4)===".bin"?MW:H3)()}var u5=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,d5=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function yn(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var a=e.match(u5),o,c,u,d;if(a)for(d=0;d!=a.length;++d)o=a[d].match(d5),(c=o[1].indexOf(":"))===-1?s[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(c+1),s[u]=o[2].slice(1,o[2].length-1));return s}function vY(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(u5),a,o,c,u;if(s)for(u=0;u!=s.length;++u)a=s[u].match(d5),(o=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?c="xmlns"+a[1].slice(6):c=a[1].slice(o+1),r[c]=a[2].slice(1,a[2].length-1));return r}var fd;function wY(e,t){var r=fd[e]||gr(e);return r==="General"?ol(t):fn(r,t)}function bY(e,t,r,s){var a=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Wr(s);break;case"i2":case"int":a=parseInt(s,10);break;case"r4":case"float":a=parseFloat(s);break;case"date":case"dateTime.tz":a=Gr(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[gr(t)]=a}function _Y(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ji[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Td(e.v):e.w=ol(e.v):e.w=wY(t||"General",e.v)}catch(o){if(r.WTF)throw o}try{var s=fd[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&Kc(s)){var a=Yo(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(r.WTF)throw o}}}function SY(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=LH[s.Pattern]||s.Pattern)}e[t.ID]=t}function kY(e,t,r,s,a,o,c,u,d,h){var m="General",x=s.StyleID,y={};h=h||{};var v=[],w=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&c&&(x=c.StyleID);o[x]!==void 0&&(o[x].nf&&(m=o[x].nf),o[x].Interior&&v.push(o[x].Interior),!!o[x].Parent);)x=o[x].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=Wr(e);break;case"String":s.t="s",s.r=kE(gr(e)),s.v=e.indexOf("<")>-1?gr(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(Gr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),s.v!==s.v?s.v=gr(e):s.v<60&&(s.v=s.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=n3[e],h.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=kE(t||e));break}if(_Y(s,m,h),h.cellFormula!==!1)if(s.Formula){var g=gr(s.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),s.f=Ac(g,a),delete s.Formula,s.ArrayRange=="RC"?s.F=Ac("RC:RC",a):s.ArrayRange&&(s.F=Ac(s.ArrayRange,a),d.push([vr(s.F),s.F]))}else for(w=0;w<d.length;++w)a.r>=d[w][0].s.r&&a.r<=d[w][0].e.r&&a.c>=d[w][0].s.c&&a.c<=d[w][0].e.c&&(s.F=d[w][1]);h.cellStyles&&(v.forEach(function(_){!y.patternType&&_.patternType&&(y.patternType=_.patternType)}),s.s=y),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function NY(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function H1(e,t){var r=t||{};Xc();var s=Qu(Ev(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=Pr(s));var a=s.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var c=Vr(r);return c.type="string",Uc.to_workbook(s,c)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(A){a.indexOf("<"+A)>=0&&(o=!0)}),o)return uJ(s,r);fd={"General Number":"General","General Date":Gt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Gt[15],"Short Date":Gt[14],"Long Time":Gt[19],"Medium Time":Gt[18],"Short Time":Gt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Gt[2],Standard:Gt[4],Percent:Gt[10],Scientific:Gt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,d=[],h,m={},x=[],y=r.dense?[]:{},v="",w={},g={},_=yn('<Data ss:Type="String">'),b=0,N=0,S=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},R={},L={},O="",P=0,F=[],V={},oe={},D=0,K=[],M=[],ae={},te=[],Z,we=!1,ee=[],Ne=[],q={},I=0,X=0,H={Sheets:[],WBProps:{date1904:!1}},Q={};Rd.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";u=Rd.exec(s);)switch(u[3]=(ie=u[3]).toLowerCase()){case"data":if(ie=="data"){if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break}if(d[d.length-1][1])break;u[1]==="/"?kY(s.slice(b,u.index),O,_,d[d.length-1][0]=="comment"?ae:w,{c:N,r:S},R,te[N],g,ee,r):(O="",_=yn(u[0]),b=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(M.length>0&&(w.c=M),(!r.sheetRows||r.sheetRows>S)&&w.v!==void 0&&(r.dense?(y[S]||(y[S]=[]),y[S][N]=w):y[Zr(N)+ms(S)]=w),w.HRef&&(w.l={Target:gr(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(I=N+(parseInt(w.MergeAcross,10)|0),X=S+(parseInt(w.MergeDown,10)|0),F.push({s:{c:N,r:S},e:{c:I,r:X}})),!r.sheetStubs)w.MergeAcross?N=I+1:++N;else if(w.MergeAcross||w.MergeDown){for(var B=N;B<=I;++B)for(var z=S;z<=X;++z)(B>N||z>S)&&(r.dense?(y[z]||(y[z]=[]),y[z][B]={t:"z"}):y[Zr(B)+ms(z)]={t:"z"});N=I+1}else++N;else w=vY(u[0]),w.Index&&(N=+w.Index-1),N<E.s.c&&(E.s.c=N),N>E.e.c&&(E.e.c=N),u[0].slice(-2)==="/>"&&++N,M=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(S<E.s.r&&(E.s.r=S),S>E.e.r&&(E.e.r=S),u[0].slice(-2)==="/>"&&(g=yn(u[0]),g.Index&&(S=+g.Index-1)),N=0,++S):(g=yn(u[0]),g.Index&&(S=+g.Index-1),q={},(g.AutoFitHeight=="0"||g.Height)&&(q.hpx=parseInt(g.Height,10),q.hpt=Id(q.hpx),Ne[S]=q),g.Hidden=="1"&&(q.hidden=!0,Ne[S]=q));break;case"worksheet":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));x.push(v),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(y["!ref"]=Qt(E),r.sheetRows&&r.sheetRows<=E.e.r&&(y["!fullref"]=y["!ref"],E.e.r=r.sheetRows-1,y["!ref"]=Qt(E))),F.length&&(y["!merges"]=F),te.length>0&&(y["!cols"]=te),Ne.length>0&&(y["!rows"]=Ne),m[v]=y}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=N=0,d.push([u[3],!1]),h=yn(u[0]),v=gr(h.Name),y=r.dense?[]:{},F=[],ee=[],Ne=[],Q={name:v,Hidden:0},H.Sheets.push(Q);break;case"table":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else{if(u[0].slice(-2)=="/>")break;d.push([u[3],!1]),te=[],we=!1}break;case"style":u[1]==="/"?SY(R,L,r):L=yn(u[0]);break;case"numberformat":L.nf=gr(yn(u[0]).Format||"General"),fd[L.nf]&&(L.nf=fd[L.nf]);for(var ue=0;ue!=392&&Gt[ue]!=L.nf;++ue);if(ue==392){for(ue=57;ue!=392;++ue)if(Gt[ue]==null){pi(L.nf,ue);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(Z=yn(u[0]),Z.Hidden&&(Z.hidden=!0,delete Z.Hidden),Z.Width&&(Z.wpx=parseInt(Z.Width,10)),!we&&Z.wpx>10){we=!0,ra=B3;for(var se=0;se<te.length;++se)te[se]&&oo(te[se])}we&&oo(Z),te[Z.Index-1||te.length]=Z;for(var re=0;re<+Z.Span;++re)te[te.length]=Vr(Z);break;case"namedrange":if(u[1]==="/")break;H.Names||(H.Names=[]);var W=Kt(u[0]),ce={Name:W.Name,Ref:Ac(W.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(ce.Sheet=H.Sheets.length-1),H.Names.push(ce);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?O+=s.slice(P,u.index):P=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;L.Interior=yn(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?Xz(V,ie,s.slice(D,u.index)):D=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else d.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));NY(ae),M.push(ae)}else d.push([u[3],!1]),h=yn(u[0]),ae={a:h.Author};break;case"autofilter":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var k=yn(u[0]);y["!autofilter"]={ref:Ac(k.Range).replace(/\$/g,"")},d.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"null":break;default:if(d.length==0&&u[3]=="document"||d.length==0&&u[3]=="uof")return fj(s,r);var de=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:de=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:de=!1}break;case"excelworkbook":switch(u[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:de=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:de=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(s.slice(D,u.index)){case"SheetHidden":Q.Hidden=1;break;case"SheetVeryHidden":Q.Hidden=2;break}else D=u.index+u[0].length;break;case"header":y["!margins"]||rl(y["!margins"]={},"xlml"),isNaN(+Kt(u[0]).Margin)||(y["!margins"].header=+Kt(u[0]).Margin);break;case"footer":y["!margins"]||rl(y["!margins"]={},"xlml"),isNaN(+Kt(u[0]).Margin)||(y["!margins"].footer=+Kt(u[0]).Margin);break;case"pagemargins":var U=Kt(u[0]);y["!margins"]||rl(y["!margins"]={},"xlml"),isNaN(+U.Top)||(y["!margins"].top=+U.Top),isNaN(+U.Left)||(y["!margins"].left=+U.Left),isNaN(+U.Right)||(y["!margins"].right=+U.Right),isNaN(+U.Bottom)||(y["!margins"].bottom=+U.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:de=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:de=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:de=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:de=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:de=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:de=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:de=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:de=!1}break;case"smarttags":break;default:de=!1;break}if(de||u[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?bY(oe,ie,K,s.slice(D,u.index)):(K=u,D=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+d.join("|")}var T={};return!r.bookSheets&&!r.bookProps&&(T.Sheets=m),T.SheetNames=x,T.Workbook=H,T.SSF=Vr(Gt),T.Props=V,T.Custprops=oe,T}function Ry(e,t){switch(Yv(t=t||{}),t.type||"base64"){case"base64":return H1(qa(e),t);case"binary":case"buffer":case"file":return H1(e,t);case"array":return H1(mo(e),t)}}function EY(e,t){var r=[];return e.Props&&r.push(Yz(e.Props,t)),e.Custprops&&r.push(Jz(e.Props,e.Custprops)),r.join("")}function jY(){return""}function TY(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,a){var o=[];o.push(St("NumberFormat",null,{"ss:Format":Ar(Gt[s.numFmtId])}));var c={"ss:ID":"s"+(21+a)};r.push(St("Style",o.join(""),c))}),St("Styles",r.join(""))}function f5(e){return St("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Hv(e.Ref,{r:0,c:0})})}function AY(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var a=t[s];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(f5(a)))}return St("Names",r.join(""))}function CY(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var a=s.Workbook.Names,o=[],c=0;c<a.length;++c){var u=a[c];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||o.push(f5(u)))}return o.join("")}function RY(e,t,r,s){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(St("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(St("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(St("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)a.push(St("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<r&&!(s.Workbook.Sheets[o]&&!s.Workbook.Sheets[o].Hidden);++o);o==r&&a.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Xs("ProtectContents","True")),e["!protect"].objects&&a.push(Xs("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Xs("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Xs("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Xs("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){e["!protect"][c[0]]&&a.push("<"+c[1]+"/>")})),a.length==0?"":St("WorksheetOptions",a.join(""),{xmlns:La.x})}function DY(e){return e.map(function(t){var r=QU(t.t||""),s=St("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return St("Comment",s,{"ss:Author":t.a})}).join("")}function OY(e,t,r,s,a,o,c){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+Ar(Hv(e.f,c))),e.F&&e.F.slice(0,t.length)==t){var d=Qr(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(d.r==c.r?"":"["+(d.r-c.r)+"]")+"C"+(d.c==c.c?"":"["+(d.c-c.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=Ar(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=Ar(e.l.Tooltip))),r["!merges"])for(var h=r["!merges"],m=0;m!=h.length;++m)h[m].s.c!=c.c||h[m].s.r!=c.r||(h[m].e.c>h[m].s.c&&(u["ss:MergeAcross"]=h[m].e.c-h[m].s.c),h[m].e.r>h[m].s.r&&(u["ss:MergeDown"]=h[m].e.r-h[m].s.r));var x="",y="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":x="Number",y=String(e.v);break;case"b":x="Boolean",y=e.v?"1":"0";break;case"e":x="Error",y=ji[e.v];break;case"d":x="DateTime",y=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Gt[14]);break;case"s":x="String",y=ZU(e.v||"");break}var v=xo(s.cellXfs,e,s);u["ss:StyleID"]="s"+(21+v),u["ss:Index"]=c.c+1;var w=e.v!=null?y:"",g=e.t=="z"?"":'<Data ss:Type="'+x+'">'+w+"</Data>";return(e.c||[]).length>0&&(g+=DY(e.c)),St("Cell",g,u)}function FY(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=zc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function LY(e,t,r,s){if(!e["!ref"])return"";var a=vr(e["!ref"]),o=e["!merges"]||[],c=0,u=[];e["!cols"]&&e["!cols"].forEach(function(_,b){oo(_);var N=!!_.width,S=cm(b,_),E={"ss:Index":b+1};N&&(E["ss:Width"]=Fd(S.width)),_.hidden&&(E["ss:Hidden"]="1"),u.push(St("Column",null,E))});for(var d=Array.isArray(e),h=a.s.r;h<=a.e.r;++h){for(var m=[FY(h,(e["!rows"]||[])[h])],x=a.s.c;x<=a.e.c;++x){var y=!1;for(c=0;c!=o.length;++c)if(!(o[c].s.c>x)&&!(o[c].s.r>h)&&!(o[c].e.c<x)&&!(o[c].e.r<h)){(o[c].s.c!=x||o[c].s.r!=h)&&(y=!0);break}if(!y){var v={r:h,c:x},w=Vt(v),g=d?(e[h]||[])[x]:e[w];m.push(OY(g,w,e,t,r,s,v))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function IY(e,t,r){var s=[],a=r.SheetNames[e],o=r.Sheets[a],c=o?CY(o,t,e,r):"";return c.length>0&&s.push("<Names>"+c+"</Names>"),c=o?LY(o,t,e,r):"",c.length>0&&s.push("<Table>"+c+"</Table>"),s.push(RY(o,t,e,r)),s.join("")}function MY(e,t){t||(t={}),e.SSF||(e.SSF=Vr(Gt)),e.SSF&&(Xc(),rm(e.SSF),t.revssf=am(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],xo(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(EY(e,t)),r.push(jY()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(St("Worksheet",IY(s,t,e),{"ss:Name":Ar(e.SheetNames[s])}));return r[2]=TY(e,t),r[3]=AY(e),xs+St("Workbook",r.join(""),{xmlns:La.ss,"xmlns:o":La.o,"xmlns:x":La.x,"xmlns:ss":La.ss,"xmlns:dt":La.dt,"xmlns:html":La.html})}function PY(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Az(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=Cz(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var BY=[60,1084,2066,2165,2175];function UY(e,t,r,s,a){var o=s,c=[],u=r.slice(r.l,r.l+o);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}c.push(u),r.l+=o;for(var d=fi(r,r.l),h=Dy[d],m=0;h!=null&&BY.indexOf(d)>-1;)o=fi(r,r.l+2),m=r.l+4,d==2066?m+=4:(d==2165||d==2175)&&(m+=12),u=r.slice(m,r.l+4+o),c.push(u),r.l+=4+o,h=Dy[d=fi(r,r.l)];var x=Ls(c);Vs(x,0);var y=0;x.lens=[];for(var v=0;v<c.length;++v)x.lens.push(y),y+=c[v].length;if(x.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+s;return t.f(x,x.length,a)}function Dn(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Gt[s])}catch(o){if(t.WTF)throw o}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ji[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Td(e.v):e.w=ol(e.v):e.w=fn(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(o){if(t.WTF)throw o}if(t.cellDates&&s&&e.t=="n"&&Kc(Gt[s]||String(s))){var a=Yo(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Xh(e,t,r){return{v:e,ixfe:t,t:r}}function zY(e,t){var r={opts:{}},s={},a=t.dense?[]:{},o={},c={},u=null,d=[],h="",m={},x,y="",v,w,g,_,b={},N=[],S,E,R=[],L=[],O={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},F=function(Re){return Re<8?Qo[Re]:Re<64&&L[Re-8]||Qo[Re]},V=function(Re,pt,Tt){var wt=pt.XF.data;if(!(!wt||!wt.patternType||!Tt||!Tt.cellStyles)){pt.s={},pt.s.patternType=wt.patternType;var jt;(jt=Od(F(wt.icvFore)))&&(pt.s.fgColor={rgb:jt}),(jt=Od(F(wt.icvBack)))&&(pt.s.bgColor={rgb:jt})}},oe=function(Re,pt,Tt){if(!(q>1)&&!(Tt.sheetRows&&Re.r>=Tt.sheetRows)){if(Tt.cellStyles&&pt.XF&&pt.XF.data&&V(Re,pt,Tt),delete pt.ixfe,delete pt.XF,x=Re,y=Vt(Re),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<c.s.r&&(c.s.r=Re.r),Re.c<c.s.c&&(c.s.c=Re.c),Re.r+1>c.e.r&&(c.e.r=Re.r+1),Re.c+1>c.e.c&&(c.e.c=Re.c+1),Tt.cellFormula&&pt.f){for(var wt=0;wt<N.length;++wt)if(!(N[wt][0].s.c>Re.c||N[wt][0].s.r>Re.r)&&!(N[wt][0].e.c<Re.c||N[wt][0].e.r<Re.r)){pt.F=Qt(N[wt][0]),(N[wt][0].s.c!=Re.c||N[wt][0].s.r!=Re.r)&&delete pt.f,pt.f&&(pt.f=""+ta(N[wt][1],c,Re,ee,D));break}}Tt.dense?(a[Re.r]||(a[Re.r]=[]),a[Re.r][Re.c]=pt):a[y]=pt}},D={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var K,M=[],ae=[],te=[],Z=[],we=!1,ee=[];ee.SheetNames=D.snames,ee.sharedf=D.sharedf,ee.arrayf=D.arrayf,ee.names=[],ee.XTI=[];var Ne=0,q=0,I=0,X=[],H=[],Q;D.codepage=1200,Sn(1200);for(var ie=!1;e.l<e.length-1;){var B=e.l,z=e.read_shift(2);if(z===0&&Ne===10)break;var ue=e.l===e.length?0:e.read_shift(2),se=Dy[z];if(se&&se.f){if(t.bookSheets&&Ne===133&&z!==133)break;if(Ne=z,se.r===2||se.r==12){var re=e.read_shift(2);if(ue-=2,!D.enc&&re!==z&&((re&255)<<8|re>>8)!==z)throw new Error("rt mismatch: "+re+"!="+z);se.r==12&&(e.l+=10,ue-=10)}var W={};if(z===10?W=se.f(e,ue,D):W=UY(z,se,e,ue,D),q==0&&[9,521,1033,2057].indexOf(Ne)===-1)continue;switch(z){case 34:r.opts.Date1904=O.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=W,!t.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=W;break;case 66:var ce=Number(W);switch(ce){case 21010:ce=1200;break;case 32768:ce=1e4;break;case 32769:ce=1252;break}Sn(D.codepage=ce),ie=!0;break;case 317:D.rrtabid=W;break;case 25:D.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:D.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(a["!type"]="dialog"),W.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),W.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:R.push(W);break;case 430:ee.push([W]),ee[ee.length-1].XTI=[];break;case 35:case 547:ee[ee.length-1].push(W);break;case 24:case 536:Q={Name:W.Name,Ref:ta(W.rgce,c,null,ee,D)},W.itab>0&&(Q.Sheet=W.itab-1),ee.names.push(Q),ee[0]||(ee[0]=[],ee[0].XTI=[]),ee[ee.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(H[W.itab-1]={ref:Qt(W.rgce[0][0][1][2])});break;case 22:D.ExternCount=W;break;case 23:ee.length==0&&(ee[0]=[],ee[0].XTI=[]),ee[ee.length-1].XTI=ee[ee.length-1].XTI.concat(W),ee.XTI=ee.XTI.concat(W);break;case 2196:if(D.biff<8)break;Q!=null&&(Q.Comment=W[1]);break;case 18:a["!protect"]=W;break;case 19:W!==0&&D.WTF&&console.error("Password verifier: "+W);break;case 133:o[W.pos]=W,D.snames.push(W.name);break;case 10:{if(--q)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,a["!ref"]=Qt(c),t.sheetRows&&t.sheetRows<=c.e.r){var k=c.e.r;c.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Qt(c),c.e.r=k}c.e.r++,c.e.c++}M.length>0&&(a["!merges"]=M),ae.length>0&&(a["!objects"]=ae),te.length>0&&(a["!cols"]=te),Z.length>0&&(a["!rows"]=Z),O.Sheets.push(P)}h===""?m=a:s[h]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[z]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),D.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(D.biff=5,ie=!0,Sn(D.codepage=28591)),D.biff==8&&W.BIFFVer==0&&W.dt==16&&(D.biff=2),q++)break;if(a=t.dense?[]:{},D.biff<8&&!ie&&(ie=!0,Sn(D.codepage=t.codepage||1252)),D.biff<5||W.BIFFVer==0&&W.dt==4096){h===""&&(h="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var de={pos:e.l-ue,name:h};o[de.pos]=de,D.snames.push(h)}else h=(o[B]||{name:""}).name;W.dt==32&&(a["!type"]="chart"),W.dt==64&&(a["!type"]="macro"),M=[],ae=[],D.arrayf=N=[],te=[],Z=[],we=!1,P={Hidden:(o[B]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[W.r]||[])[W.c]:a[Vt({c:W.c,r:W.r})])&&++W.c,S={ixfe:W.ixfe,XF:R[W.ixfe]||{},v:W.val,t:"n"},I>0&&(S.z=X[S.ixfe>>8&63]),Dn(S,t,r.opts.Date1904),oe({c:W.c,r:W.r},S,t);break;case 5:case 517:S={ixfe:W.ixfe,XF:R[W.ixfe],v:W.val,t:W.t},I>0&&(S.z=X[S.ixfe>>8&63]),Dn(S,t,r.opts.Date1904),oe({c:W.c,r:W.r},S,t);break;case 638:S={ixfe:W.ixfe,XF:R[W.ixfe],v:W.rknum,t:"n"},I>0&&(S.z=X[S.ixfe>>8&63]),Dn(S,t,r.opts.Date1904),oe({c:W.c,r:W.r},S,t);break;case 189:for(var U=W.c;U<=W.C;++U){var T=W.rkrec[U-W.c][0];S={ixfe:T,XF:R[T],v:W.rkrec[U-W.c][1],t:"n"},I>0&&(S.z=X[S.ixfe>>8&63]),Dn(S,t,r.opts.Date1904),oe({c:U,r:W.r},S,t)}break;case 6:case 518:case 1030:{if(W.val=="String"){u=W;break}if(S=Xh(W.val,W.cell.ixfe,W.tt),S.XF=R[S.ixfe],t.cellFormula){var A=W.formula;if(A&&A[0]&&A[0][0]&&A[0][0][0]=="PtgExp"){var G=A[0][0][1][0],xe=A[0][0][1][1],be=Vt({r:G,c:xe});b[be]?S.f=""+ta(W.formula,c,W.cell,ee,D):S.F=((t.dense?(a[G]||[])[xe]:a[be])||{}).F}else S.f=""+ta(W.formula,c,W.cell,ee,D)}I>0&&(S.z=X[S.ixfe>>8&63]),Dn(S,t,r.opts.Date1904),oe(W.cell,S,t),u=W}break;case 7:case 519:if(u)u.val=W,S=Xh(W,u.cell.ixfe,"s"),S.XF=R[S.ixfe],t.cellFormula&&(S.f=""+ta(u.formula,c,u.cell,ee,D)),I>0&&(S.z=X[S.ixfe>>8&63]),Dn(S,t,r.opts.Date1904),oe(u.cell,S,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(W);var ne=Vt(W[0].s);if(v=t.dense?(a[W[0].s.r]||[])[W[0].s.c]:a[ne],t.cellFormula&&v){if(!u||!ne||!v)break;v.f=""+ta(W[1],c,W[0],ee,D),v.F=Qt(W[0])}}break;case 1212:{if(!t.cellFormula)break;if(y){if(!u)break;b[Vt(u.cell)]=W[0],v=t.dense?(a[u.cell.r]||[])[u.cell.c]:a[Vt(u.cell)],(v||{}).f=""+ta(W[0],c,x,ee,D)}}break;case 253:S=Xh(d[W.isst].t,W.ixfe,"s"),d[W.isst].h&&(S.h=d[W.isst].h),S.XF=R[S.ixfe],I>0&&(S.z=X[S.ixfe>>8&63]),Dn(S,t,r.opts.Date1904),oe({c:W.c,r:W.r},S,t);break;case 513:t.sheetStubs&&(S={ixfe:W.ixfe,XF:R[W.ixfe],t:"z"},I>0&&(S.z=X[S.ixfe>>8&63]),Dn(S,t,r.opts.Date1904),oe({c:W.c,r:W.r},S,t));break;case 190:if(t.sheetStubs)for(var je=W.c;je<=W.C;++je){var Me=W.ixfe[je-W.c];S={ixfe:Me,XF:R[Me],t:"z"},I>0&&(S.z=X[S.ixfe>>8&63]),Dn(S,t,r.opts.Date1904),oe({c:je,r:W.r},S,t)}break;case 214:case 516:case 4:S=Xh(W.val,W.ixfe,"s"),S.XF=R[S.ixfe],I>0&&(S.z=X[S.ixfe>>8&63]),Dn(S,t,r.opts.Date1904),oe({c:W.c,r:W.r},S,t);break;case 0:case 512:q===1&&(c=W);break;case 252:d=W;break;case 1054:if(D.biff==4){X[I++]=W[1];for(var De=0;De<I+163&&Gt[De]!=W[1];++De);De>=163&&pi(W[1],I+163)}else pi(W[1],W[0]);break;case 30:{X[I++]=W;for(var Ce=0;Ce<I+163&&Gt[Ce]!=W;++Ce);Ce>=163&&pi(W,I+163)}break;case 229:M=M.concat(W);break;case 93:ae[W.cmo[0]]=D.lastobj=W;break;case 438:D.lastobj.TxO=W;break;case 127:D.lastobj.ImData=W;break;case 440:for(_=W[0].s.r;_<=W[0].e.r;++_)for(g=W[0].s.c;g<=W[0].e.c;++g)v=t.dense?(a[_]||[])[g]:a[Vt({c:g,r:_})],v&&(v.l=W[1]);break;case 2048:for(_=W[0].s.r;_<=W[0].e.r;++_)for(g=W[0].s.c;g<=W[0].e.c;++g)v=t.dense?(a[_]||[])[g]:a[Vt({c:g,r:_})],v&&v.l&&(v.l.Tooltip=W[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;v=t.dense?(a[W[0].r]||[])[W[0].c]:a[Vt(W[0])];var st=ae[W[2]];v||(t.dense?(a[W[0].r]||(a[W[0].r]=[]),v=a[W[0].r][W[0].c]={t:"z"}):v=a[Vt(W[0])]={t:"z"},c.e.r=Math.max(c.e.r,W[0].r),c.s.r=Math.min(c.s.r,W[0].r),c.e.c=Math.max(c.e.c,W[0].c),c.s.c=Math.min(c.s.c,W[0].c)),v.c||(v.c=[]),w={a:W[1],t:st.TxO.t},v.c.push(w)}break;case 2173:TW(R[W.ixfe],W.ext);break;case 125:{if(!D.cellStyles)break;for(;W.e>=W.s;)te[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},we||(we=!0,zv(W.w/256)),oo(te[W.e+1])}break;case 520:{var We={};W.level!=null&&(Z[W.r]=We,We.level=W.level),W.hidden&&(Z[W.r]=We,We.hidden=!0),W.hpt&&(Z[W.r]=We,We.hpt=W.hpt,We.hpx=zc(W.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||rl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[z]]=W;break;case 161:a["!margins"]||rl(a["!margins"]={}),a["!margins"].header=W.header,a["!margins"].footer=W.footer;break;case 574:W.RTL&&(O.Views[0].RTL=!0);break;case 146:L=W;break;case 2198:K=W;break;case 140:E=W;break;case 442:h?P.CodeName=W||P.name:O.WBProps.CodeName=W||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+z.toString(16)),e.l+=ue}return r.SheetNames=os(o).sort(function(Ze,Re){return Number(Ze)-Number(Re)}).map(function(Ze){return o[Ze].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&H.forEach(function(Ze,Re){r.Sheets[r.SheetNames[Re]]["!autofilter"]=Ze}),r.Strings=d,r.SSF=Vr(Gt),D.enc&&(r.Encryption=D.enc),K&&(r.Themes=K),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),ee.names.length>0&&(O.Names=ee.names),r.Workbook=O,r}var hd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function qY(e,t,r){var s=zt.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var a=qE(s,Ny,hd.DSI);for(var o in a)t[o]=a[o]}catch(h){if(r.WTF)throw h}var c=zt.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var u=qE(c,Ey,hd.SI);for(var d in u)t[d]==null&&(t[d]=u[d])}catch(h){if(r.WTF)throw h}t.HeadingPairs&&t.TitlesOfParts&&(d3(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function $Y(e,t){var r=[],s=[],a=[],o=0,c,u=yE(Ny,"n"),d=yE(Ey,"n");if(e.Props)for(c=os(e.Props),o=0;o<c.length;++o)(Object.prototype.hasOwnProperty.call(u,c[o])?r:Object.prototype.hasOwnProperty.call(d,c[o])?s:a).push([c[o],e.Props[c[o]]]);if(e.Custprops)for(c=os(e.Custprops),o=0;o<c.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},c[o])||(Object.prototype.hasOwnProperty.call(u,c[o])?r:Object.prototype.hasOwnProperty.call(d,c[o])?s:a).push([c[o],e.Custprops[c[o]]]);var h=[];for(o=0;o<a.length;++o)y3.indexOf(a[o][0])>-1||u3.indexOf(a[o][0])>-1||a[o][1]!=null&&h.push(a[o]);s.length&&zt.utils.cfb_add(t,"/SummaryInformation",$E(s,hd.SI,d,Ey)),(r.length||h.length)&&zt.utils.cfb_add(t,"/DocumentSummaryInformation",$E(r,hd.DSI,u,Ny,h.length?h:null,hd.UDI))}function h5(e,t){t||(t={}),Yv(t),gv(),t.codepage&&xv(t.codepage);var r,s;if(e.FullPaths){if(zt.find(e,"/encryption"))throw new Error("File is password-protected");r=zt.find(e,"!CompObj"),s=zt.find(e,"/Workbook")||zt.find(e,"/Book")}else{switch(t.type){case"base64":e=Ba(qa(e));break;case"binary":e=Ba(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Vs(e,0),s={content:e}}var a,o;if(r&&PY(r),t.bookProps&&!t.bookSheets)a={};else{var c=ir?"buffer":"array";if(s&&s.content)a=zY(s.content,t);else if((o=zt.find(e,"PerfectOffice_MAIN"))&&o.content)a=tl.to_workbook(o.content,(t.type=c,t));else if((o=zt.find(e,"NativeContent_MAIN"))&&o.content)a=tl.to_workbook(o.content,(t.type=c,t));else throw(o=zt.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&zt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=rG(e))}var u={};return e.FullPaths&&qY(e,u,t),a.Props=a.Custprops=u,t.bookFiles&&(a.cfb=e),a}function HY(e,t){var r=t||{},s=zt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return zt.utils.cfb_add(s,a,m5(e,r)),r.biff==8&&(e.Props||e.Custprops)&&$Y(e,s),r.biff==8&&e.vbaraw&&sG(s,zt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var Md={0:{f:mK},1:{f:_K},2:{f:zK},3:{f:CK},4:{f:EK},5:{f:PK},6:{f:GK},7:{f:FK},8:{f:QK},9:{f:ZK},10:{f:YK},11:{f:JK},12:{f:kK},13:{f:$K},14:{f:DK},15:{f:TK},16:{f:n5},17:{f:KK},18:{f:IK},19:{f:Rv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:KX},40:{},42:{},43:{f:GH},44:{f:HH},45:{f:XH},46:{f:JH},47:{f:YH},48:{},49:{f:gz},50:{},51:{f:RW},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:A3},62:{f:WK},63:{f:UW},64:{f:pX},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:la,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:dX},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:wK},148:{f:gK,p:16},151:{f:nX},152:{},153:{f:WX},154:{},155:{},156:{f:$X},157:{},158:{},159:{T:1,f:oH},160:{T:-1},161:{T:1,f:bl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:eX},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:AW},336:{T:-1},337:{f:FW,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ky},357:{},358:{},359:{},360:{T:1},361:{},362:{f:T3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:iX},427:{f:oX},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:cX},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:vK},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:sX},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ky},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:JW},633:{T:1},634:{T:-1},635:{T:1,f:XW},636:{T:-1},637:{f:bz},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:DX},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xX},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Dy={6:{f:q1},10:{f:Zi},12:{f:Ss},13:{f:Ss},14:{f:hs},15:{f:hs},16:{f:sa},17:{f:hs},18:{f:hs},19:{f:Ss},20:{f:XE},21:{f:XE},23:{f:T3},24:{f:JE},25:{f:hs},26:{},27:{},28:{f:x$},29:{},34:{f:hs},35:{f:YE},38:{f:sa},39:{f:sa},40:{f:sa},41:{f:sa},42:{f:hs},43:{f:hs},47:{f:TH},49:{f:$q},51:{f:Ss},60:{},61:{f:Pq},64:{f:hs},65:{f:qq},66:{f:Ss},77:{},80:{},81:{},82:{},85:{f:Ss},89:{},90:{},91:{},92:{f:jq},93:{f:v$},94:{},95:{f:hs},96:{},97:{},99:{f:hs},125:{f:A3},128:{f:a$},129:{f:Aq},130:{f:Ss},131:{f:hs},132:{f:hs},133:{f:Cq},134:{},140:{f:j$},141:{f:Ss},144:{},146:{f:C$},151:{},152:{},153:{},154:{},155:{},156:{f:Ss},157:{},158:{},160:{f:M$},161:{f:O$},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:e$},190:{f:t$},193:{f:Zi},197:{},198:{},199:{},200:{},201:{},202:{f:hs},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ss},220:{},221:{f:hs},222:{},224:{f:s$},225:{f:Eq},226:{f:Zi},227:{},229:{f:g$},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Dq},253:{f:Wq},255:{f:Fq},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:v3},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:hs},353:{f:Zi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:c$},431:{f:hs},432:{},433:{},434:{},437:{},438:{f:_$},439:{f:hs},440:{f:S$},441:{},442:{f:rf},443:{},444:{f:Ss},445:{},446:{},448:{f:Zi},449:{f:Mq,r:2},450:{f:Zi},512:{f:GE},513:{f:I$},515:{f:o$},516:{f:Vq},517:{f:KE},519:{f:P$},520:{f:Lq},523:{},545:{f:ZE},549:{f:WE},566:{},574:{f:Uq},638:{f:Qq},659:{},1048:{},1054:{f:Xq},1084:{},1212:{f:h$},2048:{f:N$},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Gh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Zi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:R$,r:12},2173:{f:jW,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:hs,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:f$,r:12},2197:{},2198:{f:bW,r:12},2199:{},2200:{},2201:{},2202:{f:m$,r:12},2203:{f:Zi},2204:{},2205:{},2206:{},2207:{},2211:{f:Iq},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ss},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:F$},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:A$},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:GE},1:{},2:{f:$$},3:{f:z$},4:{f:U$},5:{f:KE},7:{f:W$},8:{},9:{f:Gh},11:{},22:{f:Ss},30:{f:Jq},31:{},32:{},33:{f:ZE},36:{},37:{f:WE},50:{f:G$},62:{},52:{},67:{},68:{f:Ss},69:{},86:{},126:{},127:{f:B$},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:V$},223:{},234:{},354:{},421:{},518:{f:q1},521:{f:Gh},536:{f:JE},547:{f:YE},561:{},579:{},1030:{f:q1},1033:{f:Gh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function kt(e,t,r,s){var a=t;if(!isNaN(a)){var o=s||(r||[]).length||0,c=e.next(4);c.write_shift(2,a),c.write_shift(2,o),o>0&&Tv(r)&&e.push(r)}}function WY(e,t,r,s){var a=(r||[]).length||0;if(a<=8224)return kt(e,t,r,a);var o=t;if(!isNaN(o)){for(var c=r.parts||[],u=0,d=0,h=0;h+(c[u]||8224)<=8224;)h+=c[u]||8224,u++;var m=e.next(4);for(m.write_shift(2,o),m.write_shift(2,h),e.push(r.slice(d,d+h)),d+=h;d<a;){for(m=e.next(4),m.write_shift(2,60),h=0;h+(c[u]||8224)<=8224;)h+=c[u]||8224,u++;m.write_shift(2,h),e.push(r.slice(d,d+h)),d+=h}}}function of(e,t,r){return e||(e=it(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function GY(e,t,r,s){var a=it(9);return of(a,e,t),w3(r,s||"b",a),a}function VY(e,t,r){var s=it(8+2*r.length);return of(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function KY(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?As(Gr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?kt(e,2,H$(r,s,a)):kt(e,3,q$(r,s,a));return;case"b":case"e":kt(e,5,GY(r,s,t.v,t.t));return;case"s":case"str":kt(e,4,VY(r,s,(t.v||"").slice(0,255)));return}kt(e,1,of(null,r,s))}function XY(e,t,r,s){var a=Array.isArray(t),o=vr(t["!ref"]||"A1"),c,u="",d=[];if(o.e.c>255||o.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),c=Qt(o)}for(var h=o.s.r;h<=o.e.r;++h){u=ms(h);for(var m=o.s.c;m<=o.e.c;++m){h===o.s.r&&(d[m]=Zr(m)),c=d[m]+u;var x=a?(t[h]||[])[m]:t[c];x&&KY(e,x,h,m)}}}function YY(e,t){for(var r=t||{},s=Na(),a=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==r.sheet&&(a=o);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return kt(s,r.biff==4?1033:r.biff==3?521:9,Pv(e,16,r)),XY(s,e.Sheets[e.SheetNames[a]],a,r),kt(s,10),s.end()}function JY(e,t,r){kt(e,49,Hq({sz:12,name:"Arial"},r))}function ZY(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)t[a]!=null&&kt(e,1054,Yq(a,t[a],r))})}function QY(e,t){var r=it(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),kt(e,2151,r),r=it(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),N3(vr(t["!ref"]||"A1"),r),r.write_shift(4,4),kt(e,2152,r)}function eJ(e,t){for(var r=0;r<16;++r)kt(e,224,VE({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){kt(e,224,VE(s,0,t))})}function tJ(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];kt(e,440,k$(s)),s[1].Tooltip&&kt(e,2048,E$(s))}delete t["!links"]}function rJ(e,t){if(t){var r=0;t.forEach(function(s,a){++r<=256&&s&&kt(e,125,D$(cm(a,s),a))})}}function sJ(e,t,r,s,a){var o=16+xo(a.cellXfs,t,a);if(t.v==null&&!t.bf){kt(e,513,dl(r,s,o));return}if(t.bf)kt(e,6,AV(t,r,s,a,o));else switch(t.t){case"d":case"n":var c=t.t=="d"?As(Gr(t.v)):t.v;kt(e,515,l$(r,s,c,o));break;case"b":case"e":kt(e,517,i$(r,s,t.v,o,a,t.t));break;case"s":case"str":if(a.bookSST){var u=Gv(a.Strings,t.v,a.revStrings);kt(e,253,Gq(r,s,u,o))}else kt(e,516,Kq(r,s,(t.v||"").slice(0,255),o,a));break;default:kt(e,513,dl(r,s,o))}}function aJ(e,t,r){var s=Na(),a=r.SheetNames[e],o=r.Sheets[a]||{},c=(r||{}).Workbook||{},u=(c.Sheets||[])[e]||{},d=Array.isArray(o),h=t.biff==8,m,x="",y=[],v=vr(o["!ref"]||"A1"),w=h?65536:16384;if(v.e.c>255||v.e.r>=w){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,w-1)}kt(s,2057,Pv(r,16,t)),kt(s,13,cn(1)),kt(s,12,cn(100)),kt(s,15,fa(!0)),kt(s,17,fa(!1)),kt(s,16,cl(.001)),kt(s,95,fa(!0)),kt(s,42,fa(!1)),kt(s,43,fa(!1)),kt(s,130,cn(1)),kt(s,128,n$()),kt(s,131,fa(!1)),kt(s,132,fa(!1)),h&&rJ(s,o["!cols"]),kt(s,512,Zq(v,t)),h&&(o["!links"]=[]);for(var g=v.s.r;g<=v.e.r;++g){x=ms(g);for(var _=v.s.c;_<=v.e.c;++_){g===v.s.r&&(y[_]=Zr(_)),m=y[_]+x;var b=d?(o[g]||[])[_]:o[m];b&&(sJ(s,b,g,_,t),h&&b.l&&o["!links"].push([m,b.l]))}}var N=u.CodeName||u.name||a;return h&&kt(s,574,zq((c.Views||[])[0])),h&&(o["!merges"]||[]).length&&kt(s,229,y$(o["!merges"])),h&&tJ(s,o),kt(s,442,b3(N)),h&&QY(s,o),kt(s,10),s.end()}function nJ(e,t,r){var s=Na(),a=(e||{}).Workbook||{},o=a.Sheets||[],c=a.WBProps||{},u=r.biff==8,d=r.biff==5;if(kt(s,2057,Pv(e,5,r)),r.bookType=="xla"&&kt(s,135),kt(s,225,u?cn(1200):null),kt(s,193,iq(2)),d&&kt(s,191),d&&kt(s,192),kt(s,226),kt(s,92,Tq("SheetJS",r)),kt(s,66,cn(u?1200:1252)),u&&kt(s,353,cn(0)),u&&kt(s,448),kt(s,317,L$(e.SheetNames.length)),u&&e.vbaraw&&kt(s,211),u&&e.vbaraw){var h=c.CodeName||"ThisWorkbook";kt(s,442,b3(h))}kt(s,156,cn(17)),kt(s,25,fa(!1)),kt(s,18,fa(!1)),kt(s,19,cn(0)),u&&kt(s,431,fa(!1)),u&&kt(s,444,cn(0)),kt(s,61,Bq()),kt(s,64,fa(!1)),kt(s,141,cn(0)),kt(s,34,fa(MX(e)=="true")),kt(s,14,fa(!0)),u&&kt(s,439,fa(!1)),kt(s,218,cn(0)),JY(s,e,r),ZY(s,e.SSF,r),eJ(s,r),u&&kt(s,352,fa(!1));var m=s.end(),x=Na();u&&kt(x,140,T$()),u&&r.Strings&&WY(x,252,Oq(r.Strings)),kt(x,10);var y=x.end(),v=Na(),w=0,g=0;for(g=0;g<e.SheetNames.length;++g)w+=(u?12:11)+(u?2:1)*e.SheetNames[g].length;var _=m.length+w+y.length;for(g=0;g<e.SheetNames.length;++g){var b=o[g]||{};kt(v,133,Rq({pos:_,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),_+=t[g].length}var N=v.end();if(w!=N.length)throw new Error("BS8 "+w+" != "+N.length);var S=[];return m.length&&S.push(m),N.length&&S.push(N),y.length&&S.push(y),Ls(S)}function iJ(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=Vr(Gt)),e&&e.SSF&&(Xc(),rm(e.SSF),r.revssf=am(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Jv(r),r.cellXfs=[],xo(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)s[s.length]=aJ(a,r,e);return s.unshift(nJ(e,s,r)),Ls(s)}function m5(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var a=Ea(s["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var o=t||{};switch(o.biff||2){case 8:case 5:return iJ(e,t);case 4:case 3:case 2:return YY(e,t)}throw new Error("invalid type "+o.bookType+" for BIFF")}function lj(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),c=a.index,u=o&&o.index||e.length,d=HU(e.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,m=0,x=0,y=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(c=0;c<d.length;++c){var g=d[c].trim(),_=g.slice(0,3).toLowerCase();if(_=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}m=0;continue}if(!(_!="<td"&&_!="<th")){var b=g.split(/<\/t[dh]>/i);for(u=0;u<b.length;++u){var N=b[u].trim();if(N.match(/<t[dh]/i)){for(var S=N,E=0;S.charAt(0)=="<"&&(E=S.indexOf(">"))>-1;)S=S.slice(E+1);for(var R=0;R<w.length;++R){var L=w[R];L.s.c==m&&L.s.r<h&&h<=L.e.r&&(m=L.e.c+1,R=-1)}var O=Kt(N.slice(0,N.indexOf(">")));y=O.colspan?+O.colspan:1,((x=+O.rowspan)>1||y>1)&&w.push({s:{r:h,c:m},e:{r:h+(x||1)-1,c:m+y-1}});var P=O.t||O["data-t"]||"";if(!S.length){m+=y;continue}if(S=PT(S),v.s.r>h&&(v.s.r=h),v.e.r<h&&(v.e.r=h),v.s.c>m&&(v.s.c=m),v.e.c<m&&(v.e.c=m),!S.length){m+=y;continue}var F={t:"s",v:S};r.raw||!S.trim().length||P=="s"||(S==="TRUE"?F={t:"b",v:!0}:S==="FALSE"?F={t:"b",v:!1}:isNaN(Nn(S))?isNaN(Bc(S).getDate())||(F={t:"d",v:Gr(S)},r.cellDates||(F={t:"n",v:As(F.v)}),F.z=r.dateNF||Gt[14]):F={t:"n",v:Nn(S)}),r.dense?(s[h]||(s[h]=[]),s[h][m]=F):s[Vt({r:h,c:m})]=F,m+=y}}}}return s["!ref"]=Qt(v),w.length&&(s["!merges"]=w),s}function oJ(e,t,r,s){for(var a=e["!merges"]||[],o=[],c=t.s.c;c<=t.e.c;++c){for(var u=0,d=0,h=0;h<a.length;++h)if(!(a[h].s.r>r||a[h].s.c>c)&&!(a[h].e.r<r||a[h].e.c<c)){if(a[h].s.r<r||a[h].s.c<c){u=-1;break}u=a[h].e.r-a[h].s.r+1,d=a[h].e.c-a[h].s.c+1;break}if(!(u<0)){var m=Vt({r,c}),x=s.dense?(e[r]||[])[c]:e[m],y=x&&x.v!=null&&(x.h||Nv(x.w||(vi(x),x.w)||""))||"",v={};u>1&&(v.rowspan=u),d>1&&(v.colspan=d),s.editable?y='<span contenteditable="true">'+y+"</span>":x&&(v["data-t"]=x&&x.t||"z",x.v!=null&&(v["data-v"]=x.v),x.z!=null&&(v["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+x.l.Target+'">'+y+"</a>")),v.id=(s.id||"sjs")+"-"+m,o.push(St("td",y,v))}}var w="<tr>";return w+o.join("")+"</tr>"}var lJ='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',cJ="</body></html>";function uJ(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return po(lj(r[0],t),t);var s=ew();return r.forEach(function(a,o){tw(s,lj(a,t),"Sheet"+(o+1))}),s}function dJ(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function p5(e,t){var r=t||{},s=r.header!=null?r.header:lJ,a=r.footer!=null?r.footer:cJ,o=[s],c=Ea(e["!ref"]);r.dense=Array.isArray(e),o.push(dJ(e,c,r));for(var u=c.s.r;u<=c.e.r;++u)o.push(oJ(e,c,u,r));return o.push("</table>"+a),o.join("")}function x5(e,t,r){var s=r||{},a=0,o=0;if(s.origin!=null)if(typeof s.origin=="number")a=s.origin;else{var c=typeof s.origin=="string"?Qr(s.origin):s.origin;a=c.r,o=c.c}var u=t.getElementsByTagName("tr"),d=Math.min(s.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var m=Ea(e["!ref"]);h.s.r=Math.min(h.s.r,m.s.r),h.s.c=Math.min(h.s.c,m.s.c),h.e.r=Math.max(h.e.r,m.e.r),h.e.c=Math.max(h.e.c,m.e.c),a==-1&&(h.e.r=a=m.e.r+1)}var x=[],y=0,v=e["!rows"]||(e["!rows"]=[]),w=0,g=0,_=0,b=0,N=0,S=0;for(e["!cols"]||(e["!cols"]=[]);w<u.length&&g<d;++w){var E=u[w];if(cj(E)){if(s.display)continue;v[g]={hidden:!0}}var R=E.children;for(_=b=0;_<R.length;++_){var L=R[_];if(!(s.display&&cj(L))){var O=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):PT(L.innerHTML),P=L.getAttribute("data-z")||L.getAttribute("z");for(y=0;y<x.length;++y){var F=x[y];F.s.c==b+o&&F.s.r<g+a&&g+a<=F.e.r&&(b=F.e.c+1-o,y=-1)}S=+L.getAttribute("colspan")||1,((N=+L.getAttribute("rowspan")||1)>1||S>1)&&x.push({s:{r:g+a,c:b+o},e:{r:g+a+(N||1)-1,c:b+o+(S||1)-1}});var V={t:"s",v:O},oe=L.getAttribute("data-t")||L.getAttribute("t")||"";O!=null&&(O.length==0?V.t=oe||"z":s.raw||O.trim().length==0||oe=="s"||(O==="TRUE"?V={t:"b",v:!0}:O==="FALSE"?V={t:"b",v:!1}:isNaN(Nn(O))?isNaN(Bc(O).getDate())||(V={t:"d",v:Gr(O)},s.cellDates||(V={t:"n",v:As(V.v)}),V.z=s.dateNF||Gt[14]):V={t:"n",v:Nn(O)})),V.z===void 0&&P!=null&&(V.z=P);var D="",K=L.getElementsByTagName("A");if(K&&K.length)for(var M=0;M<K.length&&!(K[M].hasAttribute("href")&&(D=K[M].getAttribute("href"),D.charAt(0)!="#"));++M);D&&D.charAt(0)!="#"&&(V.l={Target:D}),s.dense?(e[g+a]||(e[g+a]=[]),e[g+a][b+o]=V):e[Vt({c:b+o,r:g+a})]=V,h.e.c<b+o&&(h.e.c=b+o),b+=S}}++g}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),h.e.r=Math.max(h.e.r,g-1+a),e["!ref"]=Qt(h),g>=d&&(e["!fullref"]=Qt((h.e.r=u.length-w+g-1+a,h))),e}function g5(e,t){var r=t||{},s=r.dense?[]:{};return x5(s,e,t)}function fJ(e,t){return po(g5(e,t),t)}function cj(e){var t="",r=hJ(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function hJ(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function mJ(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=gr(t.replace(/<[^>]*>/g,""));return[r]}var uj={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function y5(e,t){var r=t||{},s=Ev(e),a=[],o,c,u={name:""},d="",h=0,m,x,y={},v=[],w=r.dense?[]:{},g,_,b={value:""},N="",S=0,E=[],R=-1,L=-1,O={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,F={},V=[],oe={},D=0,K=0,M=[],ae=1,te=1,Z=[],we={Names:[]},ee={},Ne=["",""],q=[],I={},X="",H=0,Q=!1,ie=!1,B=0;for(Rd.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Rd.exec(s);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(O.e.c>=O.s.c&&O.e.r>=O.s.r?w["!ref"]=Qt(O):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=O.e.r&&(w["!fullref"]=w["!ref"],O.e.r=r.sheetRows-1,w["!ref"]=Qt(O)),V.length&&(w["!merges"]=V),M.length&&(w["!rows"]=M),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),v.push(m.name),y[m.name]=w,ie=!1):g[0].charAt(g[0].length-2)!=="/"&&(m=Kt(g[0],!1),R=L=-1,O.s.r=O.s.c=1e7,O.e.r=O.e.c=0,w=r.dense?[]:{},V=[],M=[],ie=!0);break;case"table-row-group":g[1]==="/"?--P:++P;break;case"table-row":case"":if(g[1]==="/"){R+=ae,ae=1;break}if(x=Kt(g[0],!1),x.?R=x.-1:R==-1&&(R=0),ae=+x["number-rows-repeated"]||1,ae<10)for(B=0;B<ae;++B)P>0&&(M[R+B]={level:P});L=-1;break;case"covered-table-cell":g[1]!=="/"&&++L,r.sheetStubs&&(r.dense?(w[R]||(w[R]=[]),w[R][L]={t:"z"}):w[Vt({r:R,c:L})]={t:"z"}),N="",E=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++L,b=Kt(g[0],!1),te=parseInt(b["number-columns-repeated"]||"1",10),_={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(_.f=nj(gr(b.formula))),(b.||b["value-type"])=="string"&&(_.t="s",_.v=gr(b["string-value"]||""),r.dense?(w[R]||(w[R]=[]),w[R][L]=_):w[Vt({r:R,c:L})]=_),L+=te-1;else if(g[1]!=="/"){++L,N="",S=0,E=[],te=1;var z=ae?R+ae-1:R;if(L>O.e.c&&(O.e.c=L),L<O.s.c&&(O.s.c=L),R<O.s.r&&(O.s.r=R),z>O.e.r&&(O.e.r=z),b=Kt(g[0],!1),q=[],I={},_={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=gr(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(D=parseInt(b["number-matrix-rows-spanned"],10)||0,K=parseInt(b["number-matrix-columns-spanned"],10)||0,oe={s:{r:R,c:L},e:{r:R+D-1,c:L+K-1}},_.F=Qt(oe),Z.push([oe,_.F])),b.formula)_.f=nj(b.formula);else for(B=0;B<Z.length;++B)R>=Z[B][0].s.r&&R<=Z[B][0].e.r&&L>=Z[B][0].s.c&&L<=Z[B][0].e.c&&(_.F=Z[B][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(D=parseInt(b["number-rows-spanned"],10)||0,K=parseInt(b["number-columns-spanned"],10)||0,oe={s:{r:R,c:L},e:{r:R+D-1,c:L+K-1}},V.push(oe)),b["number-columns-repeated"]&&(te=parseInt(b["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Wr(b["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(b.value);break;case"percentage":_.t="n",_.v=parseFloat(b.value);break;case"currency":_.t="n",_.v=parseFloat(b.value);break;case"date":_.t="d",_.v=Gr(b["date-value"]),r.cellDates||(_.t="n",_.v=As(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=zU(b["time-value"])/86400,r.cellDates&&(_.t="d",_.v=nm(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(b.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",b["string-value"]!=null&&(N=gr(b["string-value"]),E=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(Q=!1,_.t==="s"&&(_.v=N||"",E.length&&(_.R=E),Q=S==0),ee.Target&&(_.l=ee),q.length>0&&(_.c=q,q=[]),N&&r.cellText!==!1&&(_.w=N),Q&&(_.t="z",delete _.v),(!Q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=R))for(var ue=0;ue<ae;++ue){if(te=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(w[R+ue]||(w[R+ue]=[]),w[R+ue][L]=ue==0?_:Vr(_);--te>0;)w[R+ue][L+te]=Vr(_);else for(w[Vt({r:R+ue,c:L})]=_;--te>0;)w[Vt({r:R+ue,c:L+te})]=Vr(_);O.e.c<=L&&(O.e.c=L)}te=parseInt(b["number-columns-repeated"]||"1",10),L+=te-1,te=0,_={},N="",E=[]}ee={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((o=a.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((o=a.pop())[0]!==g[3])throw"Bad state: "+o;I.t=N,E.length&&(I.R=E),I.a=X,q.push(I)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);X="",H=0,N="",S=0,E=[];break;case"creator":g[1]==="/"?X=s.slice(H,g.index):H=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((o=a.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);N="",S=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(F[u.name]=d,(o=a.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&(d="",u=Kt(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":c=Kt(g[0],!1),d+=uj[g[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":c=Kt(g[0],!1),d+=uj[g[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":d+=s.slice(h,g.index);break}else h=g.index+g[0].length;break;case"named-range":c=Kt(g[0],!1),Ne=$1(c["cell-range-address"]);var se={Name:c.name,Ref:Ne[0]+"!"+Ne[1]};ie&&(se.Sheet=v.length),we.Names.push(se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!b||!b["string-value"])){var re=mJ(s.slice(S,g.index));N=(N.length>0?N+`
`:"")+re[0]}else Kt(g[0],!1),S=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{Ne=$1(Kt(g[0])["target-range-address"]),y[Ne[0]]["!autofilter"]={ref:Ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(ee=Kt(g[0],!1),!ee.href)break;ee.Target=gr(ee.href),delete ee.href,ee.Target.charAt(0)=="#"&&ee.Target.indexOf(".")>-1?(Ne=$1(ee.Target.slice(1)),ee.Target="#"+Ne[0]+"!"+Ne[1]):ee.Target.match(/^\.\.[\\\/]/)&&(ee.Target=ee.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var W={Sheets:y,SheetNames:v,Workbook:we};return r.bookSheets&&delete W.Sheets,W}function dj(e,t){t=t||{},ln(e,"META-INF/manifest.xml")&&zz(_s(e,"META-INF/manifest.xml"),t);var r=Ua(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=y5(Pr(r),t);return ln(e,"meta.xml")&&(s.Props=l3(_s(e,"meta.xml"))),s}function fj(e,t){return y5(e,t)}var pJ=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Cd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return xs+t}})(),hj=(function(){var e=function(o){return Ar(o).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(o,c,u){var d=[];d.push('      <table:table table:name="'+Ar(c.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,m=0,x=Ea(o["!ref"]||"A1"),y=o["!merges"]||[],v=0,w=Array.isArray(o);if(o["!cols"])for(m=0;m<=x.e.c;++m)d.push("        <table:table-column"+(o["!cols"][m]?' table:style-name="co'+o["!cols"][m].ods+'"':"")+`></table:table-column>
`);var g="",_=o["!rows"]||[];for(h=0;h<x.s.r;++h)g=_[h]?' table:style-name="ro'+_[h].ods+'"':"",d.push("        <table:table-row"+g+`></table:table-row>
`);for(;h<=x.e.r;++h){for(g=_[h]?' table:style-name="ro'+_[h].ods+'"':"",d.push("        <table:table-row"+g+`>
`),m=0;m<x.s.c;++m)d.push(t);for(;m<=x.e.c;++m){var b=!1,N={},S="";for(v=0;v!=y.length;++v)if(!(y[v].s.c>m)&&!(y[v].s.r>h)&&!(y[v].e.c<m)&&!(y[v].e.r<h)){(y[v].s.c!=m||y[v].s.r!=h)&&(b=!0),N["table:number-columns-spanned"]=y[v].e.c-y[v].s.c+1,N["table:number-rows-spanned"]=y[v].e.r-y[v].s.r+1;break}if(b){d.push(r);continue}var E=Vt({r:h,c:m}),R=w?(o[h]||[])[m]:o[E];if(R&&R.f&&(N["table:formula"]=Ar(LV(R.f)),R.F&&R.F.slice(0,E.length)==E)){var L=Ea(R.F);N["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,N["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!R){d.push(t);continue}switch(R.t){case"b":S=R.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=R.v?"true":"false";break;case"n":S=R.w||String(R.v||0),N["office:value-type"]="float",N["office:value"]=R.v||0;break;case"s":case"str":S=R.v==null?"":R.v,N["office:value-type"]="string";break;case"d":S=R.w||Gr(R.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=Gr(R.v).toISOString(),N["table:style-name"]="ce1";break;default:d.push(t);continue}var O=e(S);if(R.l&&R.l.Target){var P=R.l.Target;P=P.charAt(0)=="#"?"#"+IV(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),O=St("text:a",O,{"xlink:href":P.replace(/&/g,"&amp;")})}d.push("          "+St("table:table-cell",St("text:p",O,{}),N)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},a=function(o,c){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;c.SheetNames.map(function(h){return c.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var m=0;m<h["!cols"].length;++m)if(h["!cols"][m]){var x=h["!cols"][m];if(x.width==null&&x.wpx==null&&x.wch==null)continue;oo(x),x.ods=u;var y=h["!cols"][m].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),o.push(`  </style:style>
`),++u}}});var d=0;c.SheetNames.map(function(h){return c.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var m=0;m<h["!rows"].length;++m)if(h["!rows"][m]){h["!rows"][m].ods=d;var x=h["!rows"][m].hpx+"px";o.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),o.push(`  </style:style>
`),++d}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(c,u){var d=[xs],h=Cd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=Cd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(d.push("<office:document"+h+m+`>
`),d.push(o3().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+h+`>
`),a(d,c),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var x=0;x!=c.SheetNames.length;++x)d.push(s(c.Sheets[c.SheetNames[x]],c,x));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),u.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function v5(e,t){if(t.bookType=="fods")return hj(e,t);var r=_v(),s="",a=[],o=[];return s="mimetype",rr(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",rr(r,s,hj(e,t)),a.push([s,"text/xml"]),o.push([s,"ContentFile"]),s="styles.xml",rr(r,s,pJ(e,t)),a.push([s,"text/xml"]),o.push([s,"StylesFile"]),s="meta.xml",rr(r,s,xs+o3()),a.push([s,"text/xml"]),o.push([s,"MetadataFile"]),s="manifest.rdf",rr(r,s,Hz(o)),a.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",rr(r,s,qz(a)),r}function fl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Oy(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Pr(mo(e))}function xJ(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ba(Pn(e))}function gJ(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function co(e){var t=e.reduce(function(a,o){return a+o.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(a){r.set(a,s),s+=a.length}),r}function mj(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function yJ(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,a=t+13;a>=t;--a)s=s*256+e[a];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function vJ(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var o=0;a>=1;++o,a/=256)e[t+o]=a&255;e[t+15]|=r>=0?0:128}function Pd(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function jr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function is(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function _r(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],a=Pd(e,r),o=a&7;a=Math.floor(a/8);var c=0,u;if(a==0)break;switch(o){case 0:{for(var d=r[0];e[r[0]++]>=128;);u=e.slice(d,r[0])}break;case 5:c=4,u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=Pd(e,r),u=e.slice(r[0],r[0]+c),r[0]+=c;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(s))}var h={data:u,type:o};t[a]==null?t[a]=[h]:t[a].push(h)}return t}function $s(e){var t=[];return e.forEach(function(r,s){r.forEach(function(a){a.data&&(t.push(jr(s*8+a.type)),a.type==2&&t.push(jr(a.data.length)),t.push(a.data))})}),co(t)}function Xv(e,t){return e?.map(function(r){return t(r.data)})||[]}function nn(e){for(var t,r=[],s=[0];s[0]<e.length;){var a=Pd(e,s),o=_r(e.slice(s[0],s[0]+a));s[0]+=a;var c={id:is(o[1][0].data),messages:[]};o[2].forEach(function(u){var d=_r(u.data),h=is(d[3][0].data);c.messages.push({meta:d,data:e.slice(s[0],s[0]+h)}),s[0]+=h}),(t=o[3])!=null&&t[0]&&(c.merge=is(o[3][0].data)>>>0>0),r.push(c)}return r}function dc(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:jr(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:jr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(c){a.push(c.data),c.meta[3]=[{type:0,data:jr(c.data.length)}],s[2].push({data:$s(c.meta),type:2})});var o=$s(s);t.push(jr(o.length)),t.push(o),a.forEach(function(c){return t.push(c)})}),co(t)}function wJ(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=Pd(t,r),a=[];r[0]<t.length;){var o=t[r[0]]&3;if(o==0){var c=t[r[0]++]>>2;if(c<60)++c;else{var u=c-59;c=t[r[0]],u>1&&(c|=t[r[0]+1]<<8),u>2&&(c|=t[r[0]+2]<<16),u>3&&(c|=t[r[0]+3]<<24),c>>>=0,c++,r[0]+=u}a.push(t.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var d=0,h=0;if(o==1?(h=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(h=(t[r[0]++]>>2)+1,o==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[co(a)],d==0)throw new Error("Invalid offset 0");if(d>a[0].length)throw new Error("Invalid offset beyond length");if(h>=d)for(a.push(a[0].slice(-d)),h-=d;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-d,-d+h))}}var m=co(a);if(m.length!=s)throw new Error("Unexpected length: ".concat(m.length," != ").concat(s));return m}function on(e){for(var t=[],r=0;r<e.length;){var s=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(wJ(s,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return co(t)}function fc(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var o=jr(s),c=o.length;t.push(o),s<=60?(c++,t.push(new Uint8Array([s-1<<2]))):s<=256?(c+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(c+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(c+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(c+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),c+=s,a[0]=0,a[1]=c&255,a[2]=c>>8&255,a[3]=c>>16&255,r+=s}return co(t)}function bJ(e,t,r,s){var a=fl(e),o=a.getUint32(4,!0),c=(s>1?12:8)+mj(o&(s>1?3470:398))*4,u=-1,d=-1,h=NaN,m=new Date(2001,0,1);o&512&&(u=a.getUint32(c,!0),c+=4),c+=mj(o&(s>1?12288:4096))*4,o&16&&(d=a.getUint32(c,!0),c+=4),o&32&&(h=a.getFloat64(c,!0),c+=8),o&64&&(m.setTime(m.getTime()+a.getFloat64(c,!0)*1e3),c+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:t[d]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(d>-1)x={t:"s",v:t[d]};else if(!isNaN(h))x={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function _J(e,t,r){var s=fl(e),a=s.getUint32(8,!0),o=12,c=-1,u=-1,d=NaN,h=NaN,m=new Date(2001,0,1);a&1&&(d=yJ(e,o),o+=16),a&2&&(h=s.getFloat64(o,!0),o+=8),a&4&&(m.setTime(m.getTime()+s.getFloat64(o,!0)*1e3),o+=8),a&8&&(u=s.getUint32(o,!0),o+=4),a&16&&(c=s.getUint32(o,!0),o+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:t[u]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(c>-1)x={t:"s",v:r[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return x}function W1(e,t){var r=new Uint8Array(32),s=fl(r),a=12,o=0;switch(r[0]=5,e.t){case"n":r[1]=2,vJ(r,a,e.v),o|=1,a+=16;break;case"b":r[1]=6,s.setFloat64(a,e.v?1:0,!0),o|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(a,t.indexOf(e.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,o,!0),r.slice(0,a)}function G1(e,t){var r=new Uint8Array(32),s=fl(r),a=12,o=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(a,e.v,!0),o|=32,a+=8;break;case"b":r[2]=6,s.setFloat64(a,e.v?1:0,!0),o|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(a,t.indexOf(e.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,o,!0),r.slice(0,a)}function SJ(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return bJ(e,t,r,e[0]);case 5:return _J(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Qs(e){var t=_r(e);return Pd(t[1][0].data)}function pj(e,t){var r=_r(t.data),s=is(r[1][0].data),a=r[3],o=[];return(a||[]).forEach(function(c){var u=_r(c.data),d=is(u[1][0].data)>>>0;switch(s){case 1:o[d]=Oy(u[3][0].data);break;case 8:{var h=e[Qs(u[9][0].data)][0],m=_r(h.data),x=e[Qs(m[1][0].data)][0],y=is(x.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var v=_r(x.data);o[d]=v[3].map(function(w){return Oy(w.data)}).join("")}break}}),o}function kJ(e,t){var r,s,a,o,c,u,d,h,m,x,y,v,w,g,_=_r(e),b=is(_[1][0].data)>>>0,N=is(_[2][0].data)>>>0,S=((s=(r=_[8])==null?void 0:r[0])==null?void 0:s.data)&&is(_[8][0].data)>0||!1,E,R;if((o=(a=_[7])==null?void 0:a[0])!=null&&o.data&&t!=0)E=(u=(c=_[7])==null?void 0:c[0])==null?void 0:u.data,R=(h=(d=_[6])==null?void 0:d[0])==null?void 0:h.data;else if((x=(m=_[4])==null?void 0:m[0])!=null&&x.data&&t!=1)E=(v=(y=_[4])==null?void 0:y[0])==null?void 0:v.data,R=(g=(w=_[3])==null?void 0:w[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var L=S?4:1,O=fl(E),P=[],F=0;F<E.length/2;++F){var V=O.getUint16(F*2,!0);V<65535&&P.push([F,V])}if(P.length!=N)throw"Expected ".concat(N," cells, found ").concat(P.length);var oe=[];for(F=0;F<P.length-1;++F)oe[P[F][0]]=R.subarray(P[F][1]*L,P[F+1][1]*L);return P.length>=1&&(oe[P[P.length-1][0]]=R.subarray(P[P.length-1][1]*L)),{R:b,cells:oe}}function NJ(e,t){var r,s=_r(t.data),a=(r=s?.[7])!=null&&r[0]?is(s[7][0].data)>>>0>0?1:0:-1,o=Xv(s[5],function(c){return kJ(c,a)});return{nrows:is(s[4][0].data)>>>0,data:o.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(d,h){if(c[u.R][h])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(h));c[u.R][h]=d}),c},[])}}function EJ(e,t,r){var s,a=_r(t.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(is(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(is(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Qt(o);var c=_r(a[4][0].data),u=pj(e,e[Qs(c[4][0].data)][0]),d=(s=c[17])!=null&&s[0]?pj(e,e[Qs(c[17][0].data)][0]):[],h=_r(c[3][0].data),m=0;h[1].forEach(function(x){var y=_r(x.data),v=e[Qs(y[2][0].data)][0],w=is(v.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var g=NJ(e,v);g.data.forEach(function(_,b){_.forEach(function(N,S){var E=Vt({r:m+b,c:S}),R=SJ(N,u,d);R&&(r[E]=R)})}),m+=g.nrows})}function jJ(e,t){var r=_r(t.data),s={"!ref":"A1"},a=e[Qs(r[2][0].data)],o=is(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return EJ(e,a[0],s),s}function TJ(e,t){var r,s=_r(t.data),a={name:(r=s[1])!=null&&r[0]?Oy(s[1][0].data):"",sheets:[]},o=Xv(s[2],Qs);return o.forEach(function(c){e[c].forEach(function(u){var d=is(u.meta[1][0].data);d==6e3&&a.sheets.push(jJ(e,u))})}),a}function AJ(e,t){var r=ew(),s=_r(t.data),a=Xv(s[1],Qs);if(a.forEach(function(o){e[o].forEach(function(c){var u=is(c.meta[1][0].data);if(u==2){var d=TJ(e,c);d.sheets.forEach(function(h,m){tw(r,h,m==0?d.name:d.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function V1(e){var t,r,s,a,o={},c=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var h;try{h=on(d.content)}catch(x){return console.log("?? "+d.content.length+" "+(x.message||x))}var m;try{m=nn(h)}catch(x){return console.log("## "+(x.message||x))}m.forEach(function(x){o[x.id]=x.messages,c.push(x.id)})}}),!c.length)throw new Error("File has no messages");var u=((a=(s=(r=(t=o?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:a[0].data)&&is(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||c.forEach(function(d){o[d].forEach(function(h){var m=is(h.meta[1][0].data)>>>0;if(m==1)if(!u)u=h;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return AJ(o,u)}function CJ(e,t,r){var s,a,o,c;if(!((s=e[6])!=null&&s[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((c=(o=e[8])==null?void 0:o[0])==null?void 0:c.data)&&is(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var d=0,h=fl(e[7][0].data),m=0,x=[],y=fl(e[4][0].data),v=0,w=[],g=0;g<t.length;++g){if(t[g]==null){h.setUint16(g*2,65535,!0),y.setUint16(g*2,65535);continue}h.setUint16(g*2,m,!0),y.setUint16(g*2,v,!0);var _,b;switch(typeof t[g]){case"string":_=W1({t:"s",v:t[g]},r),b=G1({t:"s",v:t[g]},r);break;case"number":_=W1({t:"n",v:t[g]},r),b=G1({t:"n",v:t[g]},r);break;case"boolean":_=W1({t:"b",v:t[g]},r),b=G1({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}x.push(_),m+=_.length,w.push(b),v+=b.length,++d}for(e[2][0].data=jr(d);g<e[7][0].data.length/2;++g)h.setUint16(g*2,65535,!0),y.setUint16(g*2,65535,!0);return e[6][0].data=co(x),e[3][0].data=co(w),d}function RJ(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Ea(r["!ref"]);s.s.r=s.s.c=0;var a=!1;s.e.c>9&&(a=!0,s.e.c=9),s.e.r>49&&(a=!0,s.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Qt(s)));var o=M0(r,{range:s,header:1}),c=["~Sh33tJ5~"];o.forEach(function(X){return X.forEach(function(H){typeof H=="string"&&c.push(H)})});var u={},d=[],h=zt.read(t.numbers,{type:"base64"});h.FileIndex.map(function(X,H){return[X,h.FullPaths[H]]}).forEach(function(X){var H=X[0],Q=X[1];if(H.type==2&&H.name.match(/\.iwa/)){var ie=H.content,B=on(ie),z=nn(B);z.forEach(function(ue){d.push(ue.id),u[ue.id]={deps:[],location:Q,type:is(ue.messages[0].meta[1][0].data)}})}}),d.sort(function(X,H){return X-H});var m=d.filter(function(X){return X>1}).map(function(X){return[X,jr(X)]});h.FileIndex.map(function(X,H){return[X,h.FullPaths[H]]}).forEach(function(X){var H=X[0];if(X[1],!!H.name.match(/\.iwa/)){var Q=nn(on(H.content));Q.forEach(function(ie){ie.messages.forEach(function(B){m.forEach(function(z){ie.messages.some(function(ue){return is(ue.meta[1][0].data)!=11006&&gJ(ue.data,z[1])})&&u[z[0]].deps.push(ie.id)})})})}});for(var x=zt.find(h,u[1].location),y=nn(on(x.content)),v,w=0;w<y.length;++w){var g=y[w];g.id==1&&(v=g)}var _=Qs(_r(v.messages[0].data)[1][0].data);for(x=zt.find(h,u[_].location),y=nn(on(x.content)),w=0;w<y.length;++w)g=y[w],g.id==_&&(v=g);for(_=Qs(_r(v.messages[0].data)[2][0].data),x=zt.find(h,u[_].location),y=nn(on(x.content)),w=0;w<y.length;++w)g=y[w],g.id==_&&(v=g);for(_=Qs(_r(v.messages[0].data)[2][0].data),x=zt.find(h,u[_].location),y=nn(on(x.content)),w=0;w<y.length;++w)g=y[w],g.id==_&&(v=g);var b=_r(v.messages[0].data);{b[6][0].data=jr(s.e.r+1),b[7][0].data=jr(s.e.c+1);var N=Qs(b[46][0].data),S=zt.find(h,u[N].location),E=nn(on(S.content));{for(var R=0;R<E.length&&E[R].id!=N;++R);if(E[R].id!=N)throw"Bad ColumnRowUIDMapArchive";var L=_r(E[R].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var O=0;O<=s.e.c;++O){var P=[];P[1]=P[2]=[{type:0,data:jr(O+420690)}],L[1].push({type:2,data:$s(P)}),L[2].push({type:0,data:jr(O)}),L[3].push({type:0,data:jr(O)})}L[4]=[],L[5]=[],L[6]=[];for(var F=0;F<=s.e.r;++F)P=[],P[1]=P[2]=[{type:0,data:jr(F+726270)}],L[4].push({type:2,data:$s(P)}),L[5].push({type:0,data:jr(F)}),L[6].push({type:0,data:jr(F)});E[R].messages[0].data=$s(L)}S.content=fc(dc(E)),S.size=S.content.length,delete b[46];var V=_r(b[4][0].data);{V[7][0].data=jr(s.e.r+1);var oe=_r(V[1][0].data),D=Qs(oe[2][0].data);S=zt.find(h,u[D].location),E=nn(on(S.content));{if(E[0].id!=D)throw"Bad HeaderStorageBucket";var K=_r(E[0].messages[0].data);for(F=0;F<o.length;++F){var M=_r(K[2][0].data);M[1][0].data=jr(F),M[4][0].data=jr(o[F].length),K[2][F]={type:K[2][0].type,data:$s(M)}}E[0].messages[0].data=$s(K)}S.content=fc(dc(E)),S.size=S.content.length;var ae=Qs(V[2][0].data);S=zt.find(h,u[ae].location),E=nn(on(S.content));{if(E[0].id!=ae)throw"Bad HeaderStorageBucket";for(K=_r(E[0].messages[0].data),O=0;O<=s.e.c;++O)M=_r(K[2][0].data),M[1][0].data=jr(O),M[4][0].data=jr(s.e.r+1),K[2][O]={type:K[2][0].type,data:$s(M)};E[0].messages[0].data=$s(K)}S.content=fc(dc(E)),S.size=S.content.length;var te=Qs(V[4][0].data);(function(){for(var X=zt.find(h,u[te].location),H=nn(on(X.content)),Q,ie=0;ie<H.length;++ie){var B=H[ie];B.id==te&&(Q=B)}var z=_r(Q.messages[0].data);{z[3]=[];var ue=[];c.forEach(function(W,ce){ue[1]=[{type:0,data:jr(ce)}],ue[2]=[{type:0,data:jr(1)}],ue[3]=[{type:2,data:xJ(W)}],z[3].push({type:2,data:$s(ue)})})}Q.messages[0].data=$s(z);var se=dc(H),re=fc(se);X.content=re,X.size=X.content.length})();var Z=_r(V[3][0].data);{var we=Z[1][0];delete Z[2];var ee=_r(we.data);{var Ne=Qs(ee[2][0].data);(function(){for(var X=zt.find(h,u[Ne].location),H=nn(on(X.content)),Q,ie=0;ie<H.length;++ie){var B=H[ie];B.id==Ne&&(Q=B)}var z=_r(Q.messages[0].data);{delete z[6],delete Z[7];var ue=new Uint8Array(z[5][0].data);z[5]=[];for(var se=0,re=0;re<=s.e.r;++re){var W=_r(ue);se+=CJ(W,o[re],c),W[1][0].data=jr(re),z[5].push({data:$s(W),type:2})}z[1]=[{type:0,data:jr(s.e.c+1)}],z[2]=[{type:0,data:jr(s.e.r+1)}],z[3]=[{type:0,data:jr(se)}],z[4]=[{type:0,data:jr(s.e.r+1)}]}Q.messages[0].data=$s(z);var ce=dc(H),k=fc(ce);X.content=k,X.size=X.content.length})()}we.data=$s(ee)}V[3][0].data=$s(Z)}b[4][0].data=$s(V)}v.messages[0].data=$s(b);var q=dc(y),I=fc(q);return x.content=I,x.size=x.content.length,h}function w5(e){return function(r){for(var s=0;s!=e.length;++s){var a=e[s];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Yv(e){w5([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Jv(e){w5([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function DJ(e){return lr.WS.indexOf(e)>-1?"sheet":e==lr.CS?"chart":e==lr.DS?"dialog":e==lr.MS?"macro":e&&e.length?e:"sheet"}function OJ(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,DJ(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function FJ(e,t,r,s,a,o,c,u,d,h,m,x){try{o[s]=cd(Ua(e,r,!0),t);var y=_s(e,t),v;switch(u){case"sheet":v=rY(y,t,a,d,o[s],h,m,x);break;case"chart":if(v=sY(y,t,a,d,o[s],h,m,x),!v||!v["!drawel"])break;var w=td(v["!drawel"].Target,t),g=Dd(w),_=$W(Ua(e,w,!0),cd(Ua(e,g,!0),w)),b=td(_,w),N=Dd(b);v=CX(Ua(e,b,!0),b,d,cd(Ua(e,N,!0),b),h,v);break;case"macro":v=aY(y,t,a,d,o[s],h,m,x);break;case"dialog":v=nY(y,t,a,d,o[s],h,m,x);break;default:throw new Error("Unrecognized sheet type "+u)}c[s]=v;var S=[];o&&o[s]&&os(o[s]).forEach(function(E){var R="";if(o[s][E].Type==lr.CMNT){R=td(o[s][E].Target,t);var L=cY(_s(e,R,!0),R,d);if(!L||!L.length)return;ej(v,L,!1)}o[s][E].Type==lr.TCMNT&&(R=td(o[s][E].Target,t),S=S.concat(WW(_s(e,R,!0),d)))}),S&&S.length&&ej(v,S,!0,d.people||[])}catch(E){if(d.WTF)throw E}}function sn(e){return e.charAt(0)=="/"?e.slice(1):e}function LJ(e,t){if(Xc(),t=t||{},Yv(t),ln(e,"META-INF/manifest.xml")||ln(e,"objectdata.xml"))return dj(e,t);if(ln(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof V1<"u"){if(e.FileIndex)return V1(e);var r=zt.utils.cfb_new();return bE(e).forEach(function(M){rr(r,M,GU(e,M))}),V1(r)}throw new Error("Unsupported NUMBERS file")}if(!ln(e,"[Content_Types].xml"))throw ln(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ln(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=bE(e),a=Bz(Ua(e,"[Content_Types].xml")),o=!1,c,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",_s(e,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!_s(e,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var d={},h={};if(!t.bookSheets&&!t.bookProps){if(ud=[],a.sst)try{ud=lY(_s(e,sn(a.sst)),a.sst,t)}catch(M){if(t.WTF)throw M}t.cellStyles&&a.themes.length&&(d=oY(Ua(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(h=iY(_s(e,sn(a.style)),a.style,d,t))}a.links.map(function(M){try{var ae=cd(Ua(e,Dd(sn(M))),M);return dY(_s(e,sn(M)),ae,M,t)}catch{}});var m=tY(_s(e,sn(a.workbooks[0])),a.workbooks[0],t),x={},y="";a.coreprops.length&&(y=_s(e,sn(a.coreprops[0]),!0),y&&(x=l3(y)),a.extprops.length!==0&&(y=_s(e,sn(a.extprops[0]),!0),y&&Gz(y,x,t)));var v={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(y=Ua(e,sn(a.custprops[0]),!0),y&&(v=Kz(y,t)));var w={};if((t.bookSheets||t.bookProps)&&(m.Sheets?c=m.Sheets.map(function(ae){return ae.name}):x.Worksheets&&x.SheetNames.length>0&&(c=x.SheetNames),t.bookProps&&(w.Props=x,w.Custprops=v),t.bookSheets&&typeof c<"u"&&(w.SheetNames=c),t.bookSheets?w.SheetNames:t.bookProps))return w;c={};var g={};t.bookDeps&&a.calcchain&&(g=uY(_s(e,sn(a.calcchain)),a.calcchain));var _=0,b={},N,S;{var E=m.Sheets;x.Worksheets=E.length,x.SheetNames=[];for(var R=0;R!=E.length;++R)x.SheetNames[R]=E[R].name}var L=o?"bin":"xml",O=a.workbooks[0].lastIndexOf("/"),P=(a.workbooks[0].slice(0,O+1)+"_rels/"+a.workbooks[0].slice(O+1)+".rels").replace(/^\//,"");ln(e,P)||(P="xl/_rels/workbook."+L+".rels");var F=cd(Ua(e,P,!0),P.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=fY(_s(e,sn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=VW(_s(e,sn(a.people[0])),t)),F&&(F=OJ(F,m.Sheets));var V=_s(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=x.Worksheets;++_){var oe="sheet";if(F&&F[_]?(N="xl/"+F[_][1].replace(/[\/]?xl\//,""),ln(e,N)||(N=F[_][1]),ln(e,N)||(N=P.replace(/_rels\/.*$/,"")+F[_][1]),oe=F[_][2]):(N="xl/worksheets/sheet"+(_+1-V)+"."+L,N=N.replace(/sheet0\./,"sheet.")),S=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(x.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,K=0;K!=t.sheets.length;++K)typeof t.sheets[K]=="number"&&t.sheets[K]==_&&(D=1),typeof t.sheets[K]=="string"&&t.sheets[K].toLowerCase()==x.SheetNames[_].toLowerCase()&&(D=1);if(!D)continue e}}FJ(e,N,S,x.SheetNames[_],_,b,c,oe,t,m,d,h)}return w={Directory:a,Workbook:m,Props:x,Custprops:v,Deps:g,Sheets:c,SheetNames:x.SheetNames,Strings:ud,Styles:h,Themes:d,SSF:Vr(Gt)},t&&t.bookFiles&&(e.files?(w.keys=s,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(M,ae){M=M.replace(/^Root Entry[\/]/,""),w.keys.push(M),w.files[M]=e.FileIndex[ae]}))),t&&t.bookVBA&&(a.vba.length>0?w.vbaraw=_s(e,sn(a.vba[0]),!0):a.defaults&&a.defaults.bin===tG&&(w.vbaraw=_s(e,"xl/vbaProject.bin",!0))),w}function IJ(e,t){var r=t||{},s="Workbook",a=zt.find(e,s);try{if(s="/!DataSpaces/Version",a=zt.find(e,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(fH(a.content),s="/!DataSpaces/DataSpaceMap",a=zt.find(e,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=mH(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=zt.find(e,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);var c=pH(a.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=zt.find(e,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);gH(a.content)}catch{}if(s="/EncryptionInfo",a=zt.find(e,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);var u=yH(a.content);if(s="/EncryptedPackage",a=zt.find(e,s),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function MJ(e,t){return t.bookType=="ods"?v5(e,t):t.bookType=="numbers"?RJ(e,t):t.bookType=="xlsb"?PJ(e,t):BJ(e,t)}function PJ(e,t){bc=1024,e&&!e.SSF&&(e.SSF=Vr(Gt)),e&&e.SSF&&(Xc(),rm(e.SSF),t.revssf=am(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,dd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=V3.indexOf(t.bookType)>-1,a=Iv();Jv(t=t||{});var o=_v(),c="",u=0;if(t.cellXfs=[],xo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",rr(o,c,c3(e.Props,t)),a.coreprops.push(c),Tr(t.rels,2,c,lr.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,rr(o,c,f3(e.Props)),a.extprops.push(c),Tr(t.rels,3,c,lr.EXT_PROPS),e.Custprops!==e.Props&&os(e.Custprops||{}).length>0&&(c="docProps/custom.xml",rr(o,c,h3(e.Custprops)),a.custprops.push(c),Tr(t.rels,4,c,lr.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var m={"!id":{}},x=e.Sheets[e.SheetNames[u-1]],y=(x||{})["!type"]||"sheet";if(c="xl/worksheets/sheet"+u+"."+r,rr(o,c,mY(u-1,c,t,e,m)),a.sheets.push(c),Tr(t.wbrels,-1,"worksheets/sheet"+u+"."+r,lr.WS[0]),x){var v=x["!comments"],w=!1,g="";v&&v.length>0&&(g="xl/comments"+u+"."+r,rr(o,g,gY(v,g)),a.comments.push(g),Tr(m,-1,"../comments"+u+"."+r,lr.CMNT),w=!0),x["!legacy"]&&w&&rr(o,"xl/drawings/vmlDrawing"+u+".vml",W3(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&rr(o,Dd(c),Tc(m))}return t.Strings!=null&&t.Strings.length>0&&(c="xl/sharedStrings."+r,rr(o,c,xY(t.Strings,c,t)),a.strs.push(c),Tr(t.wbrels,-1,"sharedStrings."+r,lr.SST)),c="xl/workbook."+r,rr(o,c,hY(e,c)),a.workbooks.push(c),Tr(t.rels,1,c,lr.WB),c="xl/theme/theme1.xml",rr(o,c,qv(e.Themes,t)),a.themes.push(c),Tr(t.wbrels,-1,"theme/theme1.xml",lr.THEME),c="xl/styles."+r,rr(o,c,pY(e,c,t)),a.styles.push(c),Tr(t.wbrels,-1,"styles."+r,lr.STY),e.vbaraw&&s&&(c="xl/vbaProject.bin",rr(o,c,e.vbaraw),a.vba.push(c),Tr(t.wbrels,-1,"vbaProject.bin",lr.VBA)),c="xl/metadata."+r,rr(o,c,yY(c)),a.metadata.push(c),Tr(t.wbrels,-1,"metadata."+r,lr.XLMETA),rr(o,"[Content_Types].xml",i3(a,t)),rr(o,"_rels/.rels",Tc(t.rels)),rr(o,"xl/_rels/workbook."+r+".rels",Tc(t.wbrels)),delete t.revssf,delete t.ssf,o}function BJ(e,t){bc=1024,e&&!e.SSF&&(e.SSF=Vr(Gt)),e&&e.SSF&&(Xc(),rm(e.SSF),t.revssf=am(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,dd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=V3.indexOf(t.bookType)>-1,a=Iv();Jv(t=t||{});var o=_v(),c="",u=0;if(t.cellXfs=[],xo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",rr(o,c,c3(e.Props,t)),a.coreprops.push(c),Tr(t.rels,2,c,lr.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,rr(o,c,f3(e.Props)),a.extprops.push(c),Tr(t.rels,3,c,lr.EXT_PROPS),e.Custprops!==e.Props&&os(e.Custprops||{}).length>0&&(c="docProps/custom.xml",rr(o,c,h3(e.Custprops)),a.custprops.push(c),Tr(t.rels,4,c,lr.CUST_PROPS));var m=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var x={"!id":{}},y=e.Sheets[e.SheetNames[u-1]],v=(y||{})["!type"]||"sheet";if(c="xl/worksheets/sheet"+u+"."+r,rr(o,c,a5(u-1,t,e,x)),a.sheets.push(c),Tr(t.wbrels,-1,"worksheets/sheet"+u+"."+r,lr.WS[0]),y){var w=y["!comments"],g=!1,_="";if(w&&w.length>0){var b=!1;w.forEach(function(N){N[1].forEach(function(S){S.T==!0&&(b=!0)})}),b&&(_="xl/threadedComments/threadedComment"+u+"."+r,rr(o,_,GW(w,m,t)),a.threadedcomments.push(_),Tr(x,-1,"../threadedComments/threadedComment"+u+"."+r,lr.TCMNT)),_="xl/comments"+u+"."+r,rr(o,_,G3(w)),a.comments.push(_),Tr(x,-1,"../comments"+u+"."+r,lr.CMNT),g=!0}y["!legacy"]&&g&&rr(o,"xl/drawings/vmlDrawing"+u+".vml",W3(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}x["!id"].rId1&&rr(o,Dd(c),Tc(x))}return t.Strings!=null&&t.Strings.length>0&&(c="xl/sharedStrings."+r,rr(o,c,O3(t.Strings,t)),a.strs.push(c),Tr(t.wbrels,-1,"sharedStrings."+r,lr.SST)),c="xl/workbook."+r,rr(o,c,c5(e)),a.workbooks.push(c),Tr(t.rels,1,c,lr.WB),c="xl/theme/theme1.xml",rr(o,c,qv(e.Themes,t)),a.themes.push(c),Tr(t.wbrels,-1,"theme/theme1.xml",lr.THEME),c="xl/styles."+r,rr(o,c,z3(e,t)),a.styles.push(c),Tr(t.wbrels,-1,"styles."+r,lr.STY),e.vbaraw&&s&&(c="xl/vbaProject.bin",rr(o,c,e.vbaraw),a.vba.push(c),Tr(t.wbrels,-1,"vbaProject.bin",lr.VBA)),c="xl/metadata."+r,rr(o,c,H3()),a.metadata.push(c),Tr(t.wbrels,-1,"metadata."+r,lr.XLMETA),m.length>1&&(c="xl/persons/person.xml",rr(o,c,KW(m)),a.people.push(c),Tr(t.wbrels,-1,"persons/person.xml",lr.PEOPLE)),rr(o,"[Content_Types].xml",i3(a,t)),rr(o,"_rels/.rels",Tc(t.rels)),rr(o,"xl/_rels/workbook."+r+".rels",Tc(t.wbrels)),delete t.revssf,delete t.ssf,o}function Zv(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=qa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function UJ(e,t){return zt.find(e,"EncryptedPackage")?IJ(e,t):h5(e,t)}function zJ(e,t){var r,s=e,a=t||{};return a.type||(a.type=ir&&Buffer.isBuffer(e)?"buffer":"base64"),r=LT(s,a),LJ(r,a)}function b5(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ry(e.slice(r),t);default:break e}return Uc.to_workbook(e,t)}function qJ(e,t){var r="",s=Zv(e,t);switch(t.type){case"base64":r=qa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ll(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=Pr(r)),t.type="binary",b5(r,t)}function $J(e,t){var r=e;return t.type=="base64"&&(r=qa(r)),r=Ed.utils.decode(1200,r.slice(2),"str"),t.type="binary",b5(r,t)}function HJ(e){return e.match(/[^\x00-\x7F]/)?Pn(e):e}function K1(e,t,r,s){return s?(r.type="string",Uc.to_workbook(e,r)):Uc.to_workbook(t,r)}function Bd(e,t){gv();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Bd(new Uint8Array(e),(r=Vr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,a=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Cc={},r.dateNF&&(Cc.dateNF=r.dateNF),r.type||(r.type=ir&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ir?"buffer":"binary",s=PU(e),typeof Uint8Array<"u"&&!ir&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,s=HJ(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return r=Vr(r),r.type="array",Bd(yv(s),r)}switch((a=Zv(s,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return UJ(zt.read(s,r),r);break;case 9:if(a[1]<=8)return h5(s,r);break;case 60:return Ry(s,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return X$(s,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return R3.to_workbook(s,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?zJ(s,r):K1(e,s,r,o);case 239:return a[3]===60?Ry(s,r):K1(e,s,r,o);case 255:if(a[1]===254)return $J(s,r);if(a[1]===0&&a[2]===2&&a[3]===0)return tl.to_workbook(s,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return tl.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return Cy.to_workbook(s,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return P3.to_workbook(s,r);break;case 10:case 13:case 32:return qJ(s,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return K$.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Cy.to_workbook(s,r):K1(e,s,r,o)}function _5(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Qd(t.file,zt.write(e,{type:ir?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return zt.write(e,t)}function WJ(e,t){var r=Vr(t||{}),s=MJ(e,r);return GJ(s,r)}function GJ(e,t){var r={},s=ir?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?zt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(tm(a))}return t.password&&typeof encrypt_agile<"u"?_5(encrypt_agile(a,t.password),t):t.type==="file"?Qd(t.file,a):t.type=="string"?Pr(a):a}function VJ(e,t){var r=t||{},s=HY(e,r);return _5(s,r)}function Fn(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return jd(Pn(s));case"binary":return Pn(s);case"string":return e;case"file":return Qd(t.file,s,"utf8");case"buffer":return ir?Ni(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Fn(s,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function KJ(e,t){switch(t.type){case"base64":return jd(e);case"binary":return e;case"string":return e;case"file":return Qd(t.file,e,"binary");case"buffer":return ir?Ni(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Yh(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?jd(r):t.type=="string"?Pr(r):r;case"file":return Qd(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function S5(e,t){gv(),UX(e);var r=Vr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=S5(e,r);return r.type="array",tm(s)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Fn(MY(e,r),r);case"slk":case"sylk":return Fn(C3.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Fn(p5(e.Sheets[e.SheetNames[a]],r),r);case"txt":return KJ(k5(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Fn(Qv(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Fn(R3.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Yh(Cy.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Fn(Uc.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Fn(P3.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Fn(D3.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Fn(v5(e,r),r);case"wk1":return Yh(tl.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Yh(tl.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Yh(m5(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),VJ(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return WJ(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function XJ(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Ud(e,t,r){var s=r||{};return s.type="file",s.file=t,XJ(s),S5(e,s)}function YJ(e,t,r,s,a,o,c,u){var d=ms(r),h=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,y=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!c||e[r])for(var v=t.s.c;v<=t.e.c;++v){var w=c?e[r][v]:e[s[v]+d];if(w===void 0||w.t===void 0){if(h===void 0)continue;o[v]!=null&&(y[o[v]]=h);continue}var g=w.v;switch(w.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(o[v]!=null){if(g==null)if(w.t=="e"&&g===null)y[o[v]]=null;else if(h!==void 0)y[o[v]]=h;else if(m&&g===null)y[o[v]]=null;else continue;else y[o[v]]=m&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?g:vi(w,g,u);g!=null&&(x=!1)}}return{row:y,isempty:x}}function M0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,a=1,o=[],c=0,u="",d={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},m=h.range!=null?h.range:e["!ref"];switch(h.header===1?s=1:h.header==="A"?s=2:Array.isArray(h.header)?s=3:h.header==null&&(s=0),typeof m){case"string":d=vr(m);break;case"number":d=vr(e["!ref"]),d.s.r=m;break;default:d=m}s>0&&(a=0);var x=ms(d.s.r),y=[],v=[],w=0,g=0,_=Array.isArray(e),b=d.s.r,N=0,S={};_&&!e[b]&&(e[b]=[]);var E=h.skipHidden&&e["!cols"]||[],R=h.skipHidden&&e["!rows"]||[];for(N=d.s.c;N<=d.e.c;++N)if(!(E[N]||{}).hidden)switch(y[N]=Zr(N),r=_?e[b][N]:e[y[N]+x],s){case 1:o[N]=N-d.s.c;break;case 2:o[N]=y[N];break;case 3:o[N]=h.header[N-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=c=vi(r,null,h),g=S[c]||0,!g)S[c]=1;else{do u=c+"_"+g++;while(S[u]);S[c]=g,S[u]=1}o[N]=u}for(b=d.s.r+a;b<=d.e.r;++b)if(!(R[b]||{}).hidden){var L=YJ(e,d,b,y,s,o,_,h);(L.isempty===!1||(s===1?h.blankrows!==!1:h.blankrows))&&(v[w++]=L.row)}return v.length=w,v}var xj=/"/g;function JJ(e,t,r,s,a,o,c,u){for(var d=!0,h=[],m="",x=ms(r),y=t.s.c;y<=t.e.c;++y)if(s[y]){var v=u.dense?(e[r]||[])[y]:e[s[y]+x];if(v==null)m="";else if(v.v!=null){d=!1,m=""+(u.rawNumbers&&v.t=="n"?v.v:vi(v,null,u));for(var w=0,g=0;w!==m.length;++w)if((g=m.charCodeAt(w))===a||g===o||g===34||u.forceQuotes){m='"'+m.replace(xj,'""')+'"';break}m=="ID"&&(m='"ID"')}else v.f!=null&&!v.F?(d=!1,m="="+v.f,m.indexOf(",")>=0&&(m='"'+m.replace(xj,'""')+'"')):m="";h.push(m)}return u.blankrows===!1&&d?null:h.join(c)}function Qv(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var a=vr(e["!ref"]),o=s.FS!==void 0?s.FS:",",c=o.charCodeAt(0),u=s.RS!==void 0?s.RS:`
`,d=u.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),m="",x=[];s.dense=Array.isArray(e);for(var y=s.skipHidden&&e["!cols"]||[],v=s.skipHidden&&e["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(y[w]||{}).hidden||(x[w]=Zr(w));for(var g=0,_=a.s.r;_<=a.e.r;++_)(v[_]||{}).hidden||(m=JJ(e,a,_,x,c,d,o,s),m!=null&&(s.strip&&(m=m.replace(h,"")),(m||s.blankrows!==!1)&&r.push((g++?u:"")+m)));return delete s.dense,r.join("")}function k5(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Qv(e,t);return r}function ZJ(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var a=vr(e["!ref"]),o="",c=[],u,d=[],h=Array.isArray(e);for(u=a.s.c;u<=a.e.c;++u)c[u]=Zr(u);for(var m=a.s.r;m<=a.e.r;++m)for(o=ms(m),u=a.s.c;u<=a.e.c;++u)if(t=c[u]+o,r=h?(e[m]||[])[u]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}d[d.length]=t+"="+s}return d}function N5(e,t,r){var s=r||{},a=+!s.skipHeader,o=e||{},c=0,u=0;if(o&&s.origin!=null)if(typeof s.origin=="number")c=s.origin;else{var d=typeof s.origin=="string"?Qr(s.origin):s.origin;c=d.r,u=d.c}var h,m={s:{c:0,r:0},e:{c:u,r:c+t.length-1+a}};if(o["!ref"]){var x=vr(o["!ref"]);m.e.c=Math.max(m.e.c,x.e.c),m.e.r=Math.max(m.e.r,x.e.r),c==-1&&(c=x.e.r+1,m.e.r=c+t.length-1+a)}else c==-1&&(c=0,m.e.r=t.length-1+a);var y=s.header||[],v=0;t.forEach(function(g,_){os(g).forEach(function(b){(v=y.indexOf(b))==-1&&(y[v=y.length]=b);var N=g[b],S="z",E="",R=Vt({c:u+v,r:c+_+a});h=zd(o,R),N&&typeof N=="object"&&!(N instanceof Date)?o[R]=N:(typeof N=="number"?S="n":typeof N=="boolean"?S="b":typeof N=="string"?S="s":N instanceof Date?(S="d",s.cellDates||(S="n",N=As(N)),E=s.dateNF||Gt[14]):N===null&&s.nullError&&(S="e",N=0),h?(h.t=S,h.v=N,delete h.w,delete h.R,E&&(h.z=E)):o[R]=h={t:S,v:N},E&&(h.z=E))})}),m.e.c=Math.max(m.e.c,u+y.length-1);var w=ms(c);if(a)for(v=0;v<y.length;++v)o[Zr(v+u)+w]={t:"s",v:y[v]};return o["!ref"]=Qt(m),o}function QJ(e,t){return N5(null,e,t)}function zd(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=Qr(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?zd(e,Vt(t)):zd(e,Vt({r:t,c:r||0}))}function eZ(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function ew(){return{SheetNames:[],Sheets:{}}}function tw(e,t,r,s){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var c=o&&o[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=c+a)!=-1;++a);}if(l5(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function tZ(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=eZ(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function rZ(e,t){return e.z=t,e}function E5(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function sZ(e,t,r){return E5(e,"#"+t,r)}function aZ(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function nZ(e,t,r,s){for(var a=typeof t!="string"?t:vr(t),o=typeof t=="string"?t:Qt(t),c=a.s.r;c<=a.e.r;++c)for(var u=a.s.c;u<=a.e.c;++u){var d=zd(e,c,u);d.t="n",d.F=o,delete d.v,c==a.s.r&&u==a.s.c&&(d.f=r,s&&(d.D=!0))}return e}var Fs={encode_col:Zr,encode_row:ms,encode_cell:Vt,encode_range:Qt,decode_col:Cv,decode_row:Av,split_cell:xz,decode_cell:Qr,decode_range:Ea,format_cell:vi,sheet_add_aoa:QT,sheet_add_json:N5,sheet_add_dom:x5,aoa_to_sheet:Yc,json_to_sheet:QJ,table_to_sheet:g5,table_to_book:fJ,sheet_to_csv:Qv,sheet_to_txt:k5,sheet_to_json:M0,sheet_to_html:p5,sheet_to_formulae:ZJ,sheet_to_row_object_array:M0,sheet_get_cell:zd,book_new:ew,book_append_sheet:tw,book_set_sheet_visibility:tZ,cell_set_number_format:rZ,cell_set_hyperlink:E5,cell_set_internal_link:sZ,cell_add_comment:aZ,sheet_set_array_formula:nZ,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const iZ=()=>{const{isAdmin:e,isSubAdmin:t,profile:r}=Yr(),{labels:s,ledgerData:a,selectedLabel:o,loading:c,setSelectedLabel:u,addLabel:d,updateLabel:h,deleteLabel:m,addLedgerItem:x,updateLedgerItem:y,deleteLedgerItem:v,getNextRowNumber:w}=nU(),g=e||t||s.length===1||o?.name===r?.team,[_,b]=Y.useState(!1),[N,S]=Y.useState(!1),[E,R]=Y.useState(!1),[L,O]=Y.useState(null),[P,F]=Y.useState(null),[V,oe]=Y.useState("list"),[D,K]=Y.useState(null),[M,ae]=Y.useState(""),[te,Z]=Y.useState(null),[we,ee]=Y.useState(""),Ne=Y.useRef(null),q=Y.useRef(null),[I,X]=Y.useState(!1),[H,Q]=Y.useState(null),[ie,B]=Y.useState(!1),[z,ue]=Y.useState(!1),[se,re]=Y.useState({row_number:1,doc_number:"",content:"",receiver_org:"",receiver_date:"",sender_org:"",sender_date:"",note:""}),W=(Re,pt)=>{g&&(Z({id:Re.id,field:pt}),ee(Re[pt]||""))},ce=async()=>{if(!te)return;const{id:Re,field:pt}=te,Tt=a.find(wt=>wt.id===Re);Tt&&Tt[pt]!==we&&await y(Re,{[pt]:we}),Z(null),ee("")},k=()=>{Z(null),ee("")},de=Re=>{Re.key==="Enter"?ce():Re.key==="Escape"&&k()},U=async(Re=!1)=>{if(!o)return;if(!se.content.trim()&&!se.doc_number.trim()){Re||ue(!1);return}const pt={...se,row_number:w(),label_id:o.id,created_by:r?.id};(await x(pt)).success&&(re({row_number:w()+1,doc_number:"",content:"",receiver_org:"",receiver_date:"",sender_org:"",sender_date:"",note:""}),Re||ue(!1))},T=(Re,pt)=>{re(Tt=>({...Tt,[Re]:pt}))},A=(Re,pt)=>{Re.key==="Enter"?(Re.preventDefault(),U(!0)):Re.key==="Escape"&&(se.content.trim()||se.doc_number.trim()?U(!1):(ue(!1),re({row_number:1,doc_number:"",content:"",receiver_org:"",receiver_date:"",sender_org:"",sender_date:"",note:""})))},G=Re=>{O(Re),S(!0)},xe=async()=>{L&&(await v(L.id),S(!1),O(null))},be=async()=>{if(!M.trim()){alert("  .");return}(await d(M.trim())).success&&(ae(""),oe("list"))},ne=async()=>{if(!M.trim()||!D)return;(await h(D.id,M.trim())).success&&(ae(""),K(null),oe("list"))},je=Re=>{F(Re),R(!0)},Me=async()=>{P&&(await m(P.id),R(!1),F(null))},De=async Re=>{const pt=Re.target.files?.[0];if(pt)try{X(!0);const Tt=await pt.arrayBuffer(),wt=Bd(Tt),jt=wt.SheetNames[0],Pt=wt.Sheets[jt],Le=Fs.sheet_to_json(Pt,{header:1});let nt=-1;for(let Ae=0;Ae<Math.min(10,Le.length);Ae++){const Je=Le[Ae];if(Je&&Je.some(Ee=>Ee&&String(Ee).includes(""))){nt=Ae;break}}if(nt===-1){alert("   . , ,    .");return}const dt=[];for(let Ae=nt+2;Ae<Le.length;Ae++){const Je=Le[Ae];if(!Je||Je.length===0)continue;const Ee=Je[0];if(!Ee||isNaN(Number(Ee)))continue;const Pe=Je[2];!Pe||String(Pe).trim()===""||dt.push({row_number:Number(Ee),doc_number:Je[1]?String(Je[1]).trim():"",content:Je[2]?String(Je[2]).trim():"",receiver_org:Je[3]?String(Je[3]).trim():"",receiver_date:Je[4]?String(Je[4]).trim():"",sender_org:Je[5]?String(Je[5]).trim():"",sender_date:Je[6]?String(Je[6]).trim():"",note:Je[7]?String(Je[7]).trim():""})}if(dt.length===0){alert("  .");return}Q(dt),B(!0)}catch(Tt){console.error("  :",Tt),alert("     .")}finally{X(!1),q.current&&(q.current.value="")}},Ce=async()=>{if(!(!H||!o)){X(!0);try{for(const Re of H)await x({...Re,label_id:o.id,created_by:r?.id});B(!1),Q(null),alert(`${H.length}  .`)}catch(Re){console.error("  :",Re),alert("    .")}finally{X(!1)}}},st=()=>{if(!o)return;const Re=Fs.book_new(),pt=[...a].sort((Pt,Le)=>Pt.row_number-Le.row_number),Tt=[[`${We}  , `,null,null,null,null,null,null,null],[o.name,null,null,null,null,null,null,null],["","",""," ",null," ",null,""],[null,null,null,"","","","",null]];if(pt.length>0)pt.forEach(Pt=>{Tt.push([String(Pt.row_number),Pt.doc_number||"",Pt.content||"",Pt.receiver_org||"",Pt.receiver_date||"",Pt.sender_org||"",Pt.sender_date||"",Pt.note||""])});else for(let Pt=1;Pt<=23;Pt++)Tt.push([String(Pt),"","","","","","",""]);const wt=Fs.aoa_to_sheet(Tt);wt["!merges"]=[{s:{r:0,c:0},e:{r:0,c:7}},{s:{r:1,c:0},e:{r:1,c:7}},{s:{r:2,c:0},e:{r:3,c:0}},{s:{r:2,c:1},e:{r:3,c:1}},{s:{r:2,c:2},e:{r:3,c:2}},{s:{r:2,c:3},e:{r:2,c:4}},{s:{r:2,c:5},e:{r:2,c:6}},{s:{r:2,c:7},e:{r:3,c:7}}];const jt=Tt.length;wt["!rows"]=[],wt["!rows"][0]={hpt:42,hpx:42},wt["!rows"][1]={hpt:42,hpx:42};for(let Pt=2;Pt<jt;Pt++)wt["!rows"][Pt]={hpt:25.5,hpx:25.5};wt["!cols"]=[{wch:6},{wch:12},{wch:40},{wch:15},{wch:10},{wch:15},{wch:10},{wch:25}],Fs.book_append_sheet(Re,wt,`${We}`),Ud(Re,`${We}__${o.name}.xls`,{bookType:"xls"})};Y.useEffect(()=>{te&&Ne.current&&(Ne.current.focus(),Ne.current.select())},[te]);const We=new Date().getFullYear(),Ze=({item:Re,field:pt,className:Tt="",align:wt="left"})=>te?.id===Re.id&&te?.field===pt?n.jsx("input",{ref:Ne,type:"text",value:we,onChange:Pt=>ee(Pt.target.value),onBlur:ce,onKeyDown:de,className:`w-full px-2 py-1 bg-toss-blue/5 border border-toss-blue rounded text-sm focus:outline-none focus:ring-1 focus:ring-toss-blue ${wt==="center"?"text-center":""}`}):n.jsx("div",{onClick:()=>g&&W(Re,pt),className:`px-2 py-1 min-h-[28px] ${g?"cursor-text hover:bg-toss-gray-50 rounded":""} ${Tt} ${wt==="center"?"text-center":""}`,children:Re[pt]||n.jsx("span",{className:"text-toss-gray-300",children:"-"})});return n.jsxs("div",{className:"space-y-6",children:[n.jsx(At,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(o4,{size:24})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-xl font-bold mb-1",children:"  "}),n.jsxs("p",{className:"text-white/90",children:[We,""]})]})]}),n.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap",children:[g&&o&&n.jsxs(n.Fragment,{children:[n.jsx("input",{ref:q,type:"file",accept:".xlsx,.xls",onChange:De,className:"hidden"}),n.jsxs(rt,{onClick:()=>q.current?.click(),disabled:I,className:"flex-1 sm:flex-none text-sm bg-white/20 hover:bg-white/30 text-white border-0",children:[n.jsx(uo,{size:16}),n.jsx("span",{className:"hidden sm:inline",children:""})]}),n.jsxs(rt,{onClick:st,className:"flex-1 sm:flex-none text-sm bg-white/20 hover:bg-white/30 text-white border-0",children:[n.jsx(ns,{size:16}),n.jsx("span",{className:"hidden sm:inline",children:""})]})]}),(e||t)&&n.jsxs(rt,{onClick:()=>{oe("list"),ae(""),K(null),b(!0)},className:"flex-1 sm:flex-none text-sm bg-white/20 hover:bg-white/30 text-white border-0",children:[n.jsx(_d,{size:16}),n.jsx("span",{className:"hidden sm:inline",children:" "})]})]})]})}),n.jsxs("div",{className:"flex items-center gap-2 border-b border-toss-gray-200",children:[s.map(Re=>n.jsxs("button",{onClick:()=>u(Re),className:`px-4 py-3 font-medium text-sm transition-colors relative ${o?.id===Re.id?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[Re.name,o?.id===Re.id&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]},Re.id)),s.length===0&&n.jsx("div",{className:"px-4 py-3 text-sm text-toss-gray-400",children:" "})]}),n.jsxs(At,{padding:"p-0",className:"hidden lg:block",children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full min-w-[900px]",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-200 bg-toss-gray-50",children:[n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-14",children:""}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-24",children:""}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-left min-w-[200px]",children:""}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-28 bg-blue-50/50",children:" "}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-20 bg-blue-50/50",children:""}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-28 bg-green-50/50",children:" "}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-20 bg-green-50/50",children:""}),n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-left min-w-[120px]",children:""}),g&&n.jsx("th",{className:"px-3 py-3 text-xs font-semibold text-toss-gray-500 text-center w-12"})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-100",children:c?n.jsx("tr",{children:n.jsx("td",{colSpan:g?9:8,className:"px-4 py-12 text-center text-toss-gray-500",children:" ..."})}):n.jsxs(n.Fragment,{children:[z&&g&&n.jsxs("tr",{className:"bg-toss-blue/5",children:[n.jsx("td",{className:"px-3 py-2 text-sm text-center text-toss-gray-400",children:w()}),n.jsx("td",{className:"px-1 py-1",children:n.jsx("input",{type:"text",value:se.doc_number,onChange:Re=>T("doc_number",Re.target.value),onKeyDown:Re=>A(Re),placeholder:"",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),n.jsx("td",{className:"px-1 py-1",children:n.jsx("input",{type:"text",value:se.content,onChange:Re=>T("content",Re.target.value),onKeyDown:Re=>A(Re),placeholder:"",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue",autoFocus:!0})}),n.jsx("td",{className:"px-1 py-1 bg-blue-50/30",children:n.jsx("input",{type:"text",value:se.receiver_org,onChange:Re=>T("receiver_org",Re.target.value),onKeyDown:Re=>A(Re),placeholder:" ",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),n.jsx("td",{className:"px-1 py-1 bg-blue-50/30",children:n.jsx("input",{type:"text",value:se.receiver_date,onChange:Re=>T("receiver_date",Re.target.value),onKeyDown:Re=>A(Re),placeholder:"0122",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),n.jsx("td",{className:"px-1 py-1 bg-green-50/30",children:n.jsx("input",{type:"text",value:se.sender_org,onChange:Re=>T("sender_org",Re.target.value),onKeyDown:Re=>A(Re),placeholder:" ",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),n.jsx("td",{className:"px-1 py-1 bg-green-50/30",children:n.jsx("input",{type:"text",value:se.sender_date,onChange:Re=>T("sender_date",Re.target.value),onKeyDown:Re=>A(Re),placeholder:"0105",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded text-center focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),n.jsx("td",{className:"px-1 py-1",children:n.jsx("input",{type:"text",value:se.note,onChange:Re=>T("note",Re.target.value),onKeyDown:Re=>A(Re),placeholder:"",className:"w-full px-2 py-1 text-sm bg-white border border-toss-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-toss-blue focus:border-toss-blue"})}),n.jsx("td",{className:"px-2 py-1",children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>U(!0),className:"p-1 text-green-600 hover:bg-green-50 rounded-full transition-colors",title:"   (Enter)",children:n.jsx(y0,{size:14})}),n.jsx("button",{onClick:()=>{se.content.trim()||se.doc_number.trim()?U(!1):ue(!1)},className:"p-1 text-toss-gray-400 hover:bg-toss-gray-100 rounded-full transition-colors",title:" (Esc)",children:n.jsx(pr,{size:14})})]})})]}),[...a].sort((Re,pt)=>pt.row_number-Re.row_number).map(Re=>n.jsxs("tr",{className:"hover:bg-toss-gray-50/50 transition-colors",children:[n.jsx("td",{className:"px-3 py-2 text-sm text-center text-toss-gray-500 font-medium",children:Re.row_number}),n.jsx("td",{className:"px-1 py-1 text-sm",children:n.jsx(Ze,{item:Re,field:"doc_number",align:"center"})}),n.jsx("td",{className:"px-1 py-1 text-sm",children:n.jsx(Ze,{item:Re,field:"content"})}),n.jsx("td",{className:"px-1 py-1 text-sm bg-blue-50/30",children:n.jsx(Ze,{item:Re,field:"receiver_org",align:"center"})}),n.jsx("td",{className:"px-1 py-1 text-sm bg-blue-50/30",children:n.jsx(Ze,{item:Re,field:"receiver_date",align:"center"})}),n.jsx("td",{className:"px-1 py-1 text-sm bg-green-50/30",children:n.jsx(Ze,{item:Re,field:"sender_org",align:"center"})}),n.jsx("td",{className:"px-1 py-1 text-sm bg-green-50/30",children:n.jsx(Ze,{item:Re,field:"sender_date",align:"center"})}),n.jsx("td",{className:"px-1 py-1 text-sm",children:n.jsx(Ze,{item:Re,field:"note"})}),g&&n.jsx("td",{className:"px-2 py-1 text-center",children:n.jsx("button",{onClick:()=>G(Re),className:"p-1.5 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors",children:n.jsx(cr,{size:14})})})]},Re.id)),a.length===0&&!z&&n.jsx("tr",{children:n.jsx("td",{colSpan:g?9:8,className:"px-4 py-12 text-center text-toss-gray-400",children:o?"  ":" "})})]})})]})}),o&&g&&!z&&n.jsx("div",{className:"border-t border-toss-gray-100",children:n.jsxs("button",{onClick:()=>ue(!0),className:"w-full px-4 py-3 text-sm text-toss-gray-500 hover:text-toss-blue hover:bg-toss-gray-50 transition-colors flex items-center justify-center gap-2",children:[n.jsx(Ns,{size:16}),"  "]})})]}),n.jsx("div",{className:"lg:hidden space-y-3",children:c?n.jsx(At,{children:n.jsx("div",{className:"py-8 text-center text-toss-gray-500",children:" ..."})}):n.jsxs(n.Fragment,{children:[o&&g&&!z&&n.jsxs("button",{onClick:()=>ue(!0),className:"w-full p-4 bg-toss-gray-50 border-2 border-dashed border-toss-gray-200 rounded-xl text-toss-gray-500 hover:border-toss-blue hover:text-toss-blue transition-colors flex items-center justify-center gap-2",children:[n.jsx(Ns,{size:18}),"  "]}),z&&g&&n.jsx(At,{children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm font-medium text-toss-gray-500",children:["#",w()]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>U(!0),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",children:n.jsx(y0,{size:18})}),n.jsx("button",{onClick:()=>{se.content.trim()||se.doc_number.trim()?U(!1):ue(!1)},className:"p-2 text-toss-gray-400 hover:bg-toss-gray-100 rounded-lg transition-colors",children:n.jsx(pr,{size:18})})]})]}),n.jsx("input",{type:"text",value:se.content,onChange:Re=>T("content",Re.target.value),placeholder:"",className:"w-full px-3 py-2 text-sm bg-toss-gray-50 border-0 rounded-lg focus:ring-2 focus:ring-toss-blue",autoFocus:!0}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsx("input",{type:"text",value:se.doc_number,onChange:Re=>T("doc_number",Re.target.value),placeholder:"",className:"px-3 py-2 text-sm bg-toss-gray-50 border-0 rounded-lg focus:ring-2 focus:ring-toss-blue"}),n.jsx("input",{type:"text",value:se.note,onChange:Re=>T("note",Re.target.value),placeholder:"",className:"px-3 py-2 text-sm bg-toss-gray-50 border-0 rounded-lg focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-xs text-blue-600 font-medium",children:""}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("input",{type:"text",value:se.receiver_org,onChange:Re=>T("receiver_org",Re.target.value),placeholder:"",className:"flex-1 px-2 py-1.5 text-sm bg-blue-50 border-0 rounded-lg focus:ring-2 focus:ring-blue-400"}),n.jsx("input",{type:"text",value:se.receiver_date,onChange:Re=>T("receiver_date",Re.target.value),placeholder:"",className:"w-16 px-2 py-1.5 text-sm bg-blue-50 border-0 rounded-lg focus:ring-2 focus:ring-blue-400 text-center"})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-xs text-green-600 font-medium",children:""}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("input",{type:"text",value:se.sender_org,onChange:Re=>T("sender_org",Re.target.value),placeholder:"",className:"flex-1 px-2 py-1.5 text-sm bg-green-50 border-0 rounded-lg focus:ring-2 focus:ring-green-400"}),n.jsx("input",{type:"text",value:se.sender_date,onChange:Re=>T("sender_date",Re.target.value),placeholder:"",className:"w-16 px-2 py-1.5 text-sm bg-green-50 border-0 rounded-lg focus:ring-2 focus:ring-green-400 text-center"})]})]})]})]})}),[...a].sort((Re,pt)=>pt.row_number-Re.row_number).map(Re=>n.jsx(At,{className:"relative",children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs font-medium text-toss-gray-400",children:["#",Re.row_number]}),Re.doc_number&&n.jsx("span",{className:"text-xs px-2 py-0.5 bg-toss-gray-100 text-toss-gray-600 rounded-full",children:Re.doc_number})]}),g&&n.jsx("button",{onClick:()=>G(Re),className:"p-1.5 text-toss-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:n.jsx(cr,{size:16})})]}),n.jsx("p",{className:"text-sm font-medium text-toss-gray-900",children:Re.content||n.jsx("span",{className:"text-toss-gray-300",children:" "})}),n.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[(Re.receiver_org||Re.receiver_date)&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 rounded-lg",children:[n.jsx("span",{className:"font-medium",children:""}),Re.receiver_org,Re.receiver_date&&n.jsxs("span",{className:"text-blue-500",children:["(",Re.receiver_date,")"]})]}),(Re.sender_org||Re.sender_date)&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-50 text-green-700 rounded-lg",children:[n.jsx("span",{className:"font-medium",children:""}),Re.sender_org,Re.sender_date&&n.jsxs("span",{className:"text-green-500",children:["(",Re.sender_date,")"]})]})]}),Re.note&&n.jsx("p",{className:"text-xs text-toss-gray-500 pt-1 border-t border-toss-gray-100",children:Re.note})]})},Re.id)),a.length===0&&!z&&n.jsx(At,{children:n.jsx("div",{className:"py-8 text-center text-toss-gray-400",children:o?"  ":" "})})]})}),g&&n.jsx("p",{className:"text-xs text-toss-gray-400 text-center",children:"        Enter    , Esc "}),n.jsx(yr,{isOpen:_,onClose:()=>b(!1),title:" ",children:n.jsxs("div",{className:"space-y-4",children:[V==="list"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"space-y-2",children:s.length>0?s.map(Re=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-toss-gray-50 rounded-toss",children:[n.jsx("span",{className:"font-medium text-toss-gray-900",children:Re.name}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>{K(Re),ae(Re.name),oe("edit")},className:"p-1 text-toss-gray-500 hover:bg-toss-gray-200 rounded",children:n.jsx(m4,{size:16})}),n.jsx("button",{onClick:()=>je(Re),className:"p-1 text-red-500 hover:bg-red-50 rounded",children:n.jsx(cr,{size:16})})]})]},Re.id)):n.jsx("div",{className:"p-4 text-center text-toss-gray-500",children:"  "})}),n.jsxs(rt,{onClick:()=>{ae(""),oe("add")},className:"w-full",children:[n.jsx(Ns,{size:18}),"  "]})]}),V==="add"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"text",value:M,onChange:Re=>ae(Re.target.value),onKeyDown:Re=>Re.key==="Enter"&&be(),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue",placeholder:"  ",autoFocus:!0})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>oe("list"),className:"flex-1",children:""}),n.jsx(rt,{onClick:be,className:"flex-1",children:""})]})]}),V==="edit"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("input",{type:"text",value:M,onChange:Re=>ae(Re.target.value),onKeyDown:Re=>Re.key==="Enter"&&ne(),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue",placeholder:"  ",autoFocus:!0})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{K(null),oe("list")},className:"flex-1",children:""}),n.jsx(rt,{onClick:ne,className:"flex-1",children:""})]})]})]})}),n.jsx(yr,{isOpen:N,onClose:()=>{S(!1),O(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-toss-gray-700",children:"  ?"}),L&&n.jsxs("div",{className:"p-3 bg-toss-gray-50 rounded-toss text-sm",children:[n.jsx("p",{className:"font-medium text-toss-gray-900",children:L.content||"( )"}),L.doc_number&&n.jsxs("p",{className:"text-toss-gray-500 mt-1",children:[": ",L.doc_number]})]}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{S(!1),O(null)},className:"flex-1",children:""}),n.jsx(rt,{variant:"danger",onClick:xe,className:"flex-1",children:""})]})]})}),n.jsx(yr,{isOpen:E,onClose:()=>{R(!1),F(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("p",{className:"text-toss-gray-700",children:[n.jsxs("span",{className:"font-medium text-toss-gray-900",children:['"',P?.name,'"']}),"  ?"]}),n.jsx("p",{className:"text-sm text-red-500",children:"      ."}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{R(!1),F(null)},className:"flex-1",children:""}),n.jsx(rt,{variant:"danger",onClick:Me,className:"flex-1",children:""})]})]})}),n.jsx(yr,{isOpen:ie,onClose:()=>{B(!1),Q(null)},title:"  ",size:"xl",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("p",{className:"text-toss-gray-700",children:[n.jsxs("span",{className:"font-bold text-toss-blue",children:[H?.length||0,""]}),"  ."]}),n.jsx("div",{className:"max-h-[400px] overflow-auto border border-toss-gray-200 rounded-toss",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-toss-gray-50 sticky top-0",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""}),n.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-toss-gray-500",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-100",children:H?.map((Re,pt)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-2 py-2 text-toss-gray-500",children:Re.row_number}),n.jsx("td",{className:"px-2 py-2",children:Re.doc_number||"-"}),n.jsx("td",{className:"px-2 py-2 max-w-[200px] truncate",children:Re.content}),n.jsx("td",{className:"px-2 py-2 text-toss-gray-500",children:Re.receiver_org&&`${Re.receiver_org} (${Re.receiver_date||"-"})`}),n.jsx("td",{className:"px-2 py-2 text-toss-gray-500",children:Re.sender_org&&`${Re.sender_org} (${Re.sender_date||"-"})`})]},pt))})]})}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{B(!1),Q(null)},className:"flex-1",disabled:I,children:""}),n.jsx(rt,{onClick:Ce,className:"flex-1",disabled:I,children:I?" ...":""})]})]})})]})};function oZ(){const{user:e,profile:t,isAdmin:r,isSubAdmin:s}=Yr(),a=e?.user_id||t?.id,[o,c]=Y.useState(null),[u,d]=Y.useState(null),[h,m]=Y.useState([]),[x,y]=Y.useState([]),[v,w]=Y.useState([]),[g,_]=Y.useState([]),[b,N]=Y.useState([]),[S,E]=Y.useState([]),[R,L]=Y.useState([]),[O,P]=Y.useState(!1),[F,V]=Y.useState(null),oe=new Date().getFullYear(),D=r||s,K=Y.useCallback(async()=>{if(a)try{let{data:ce,error:k}=await Ue.from("annual_leaves").select("*").eq("user_id",a).eq("year",oe).single();if(k&&k.code==="PGRST116"){const{data:xe,error:be}=await Ue.from("annual_leaves").insert({user_id:a,year:oe,total_days:f0,used_days:0}).select().single();if(be)throw be;ce=xe}else if(k)throw k;const de=`${oe}-01-01`,U=`${oe}-12-31`,{data:T}=await Ue.from("leave_requests").select("days").eq("user_id",a).eq("status","approved").gte("start_date",de).lte("start_date",U).neq("leave_type","comp");let A=(T||[]).reduce((xe,be)=>xe+(be.days||0),0);const{data:G}=await Ue.from("document_labels").select("id").eq("code",nd).single();if(G){const{data:xe}=await Ue.from("documents").select("leave_days").eq("drafter_id",a).eq("label_id",G.id).eq("attendance_type","leave").eq("status","approved").gte("leave_start_date",de).lte("leave_start_date",U).not("leave_type","is",null).neq("leave_type","comp");A+=(xe||[]).reduce((be,ne)=>be+(ne.leave_days||0),0)}c({...ce,used_days:A})}catch(ce){console.error("   :",ce),V(ce.message)}},[a,oe]),M=Y.useCallback(async()=>{if(a)try{const{data:ce,error:k}=await Ue.from("comp_leaves").select("*").eq("user_id",a).eq("year",oe).single();if(k&&k.code!=="PGRST116")throw k;d(ce||null)}catch(ce){console.error("   :",ce)}},[a,oe]),ae=Y.useCallback(async()=>{if(a)try{const{data:ce,error:k}=await Ue.from("leave_requests").select("*").eq("user_id",a).order("created_at",{ascending:!1});if(k)throw k;m(ce||[])}catch(ce){console.error("    :",ce),V(ce.message)}},[a]),te=Y.useCallback(async()=>{if(a)try{const{data:ce,error:k}=await Ue.from("overtime_requests").select("*").eq("user_id",a).order("created_at",{ascending:!1});if(k)throw k;y(ce||[])}catch(ce){console.error("    :",ce),V(ce.message)}},[a]),Z=Y.useCallback(async(ce=null)=>{if(D)try{let k=Ue.from("leave_requests").select("*").order("created_at",{ascending:!1});ce&&(k=k.eq("status",ce));const{data:de,error:U}=await k;if(U)throw U;w(de||[])}catch(k){console.error("    :",k),V(k.message)}},[D]),we=Y.useCallback(async(ce=null)=>{if(D)try{let k=Ue.from("overtime_requests").select("*").order("created_at",{ascending:!1});ce&&(k=k.eq("status",ce));const{data:de,error:U}=await k;if(U)throw U;_(de||[])}catch(k){console.error("    :",k),V(k.message)}},[D]),ee=Y.useCallback(async()=>{if(D)try{const{data:ce,error:k}=await Ue.from("users").select("id, name, team").order("name");if(k)throw k;E(ce||[]);const{data:de,error:U}=await Ue.from("annual_leaves").select("*").eq("year",oe);if(U)throw U;const T=`${oe}-01-01`,A=`${oe}-12-31`,{data:G,error:xe}=await Ue.from("leave_requests").select("user_id, days, leave_type").eq("status","approved").gte("start_date",T).lte("start_date",A).neq("leave_type","comp");if(xe)throw xe;const{data:be}=await Ue.from("document_labels").select("id").eq("code",nd).single();let ne=[];if(be){const{data:Ce}=await Ue.from("documents").select("drafter_id, leave_days, leave_type").eq("label_id",be.id).eq("attendance_type","leave").eq("status","approved").gte("leave_start_date",T).lte("leave_start_date",A).not("leave_type","is",null).neq("leave_type","comp");ne=Ce||[]}const je={};(G||[]).forEach(Ce=>{je[Ce.user_id]=(je[Ce.user_id]||0)+(Ce.days||0)}),ne.forEach(Ce=>{je[Ce.drafter_id]=(je[Ce.drafter_id]||0)+(Ce.leave_days||0)});const Me=(de||[]).map(Ce=>({...Ce,used_days:je[Ce.user_id]||Ce.used_days||0})),De=new Set((de||[]).map(Ce=>Ce.user_id));(ce||[]).forEach(Ce=>{!De.has(Ce.id)&&je[Ce.id]&&Me.push({user_id:Ce.id,year:oe,total_days:f0,used_days:je[Ce.id]})}),N(Me)}catch(ce){console.error("    :",ce,ce?.message,ce?.code),V(ce.message)}},[D,oe]),Ne=async ce=>{if(!a)return{success:!1,error:" ."};try{P(!0);let k=0;const de=ce.leave_type;if(de==="full"||de==="comp"){const A=new Date(ce.start_date),G=new Date(ce.end_date);k=Math.ceil((G-A)/(1e3*60*60*24))+1}else k=_y[de]||.5;if(de!=="comp"&&o){const A=o.total_days-o.used_days;if(k>A)return{success:!1,error:`  . (: ${A})`}}const{data:U,error:T}=await Ue.from("leave_requests").insert({user_id:a,leave_type:de,start_date:ce.start_date,end_date:ce.end_date||ce.start_date,days:k,reason:ce.reason,status:"pending"}).select().single();if(T)throw T;return await ae(),{success:!0,data:U}}catch(k){return console.error("  :",k),{success:!1,error:k.message}}finally{P(!1)}},q=async ce=>{try{P(!0);const{error:k}=await Ue.from("leave_requests").delete().eq("id",ce).eq("user_id",a).eq("status","pending");if(k)throw k;return await ae(),{success:!0}}catch(k){return console.error("  :",k),{success:!1,error:k.message}}finally{P(!1)}},I=async ce=>{if(!a)return{success:!1,error:" ."};try{P(!0);const{data:k,error:de}=await Ue.from("overtime_requests").insert({user_id:a,start_datetime:ce.start_datetime,end_datetime:ce.end_datetime,reason:ce.reason,status:"pending"}).select().single();if(de)throw de;return await te(),{success:!0,data:k}}catch(k){return console.error("  :",k),{success:!1,error:k.message}}finally{P(!1)}},X=async ce=>{try{P(!0);const{error:k}=await Ue.from("overtime_requests").delete().eq("id",ce).eq("user_id",a).eq("status","pending");if(k)throw k;return await te(),{success:!0}}catch(k){return console.error("  :",k),{success:!1,error:k.message}}finally{P(!1)}},H=async ce=>{if(!D)return{success:!1,error:" ."};try{P(!0);const{data:k,error:de}=await Ue.from("leave_requests").select("*").eq("id",ce).single();if(de)throw de;const{error:U}=await Ue.from("leave_requests").update({status:"approved",approved_by:a,updated_at:new Date().toISOString()}).eq("id",ce);if(U)throw U;if(k.leave_type==="comp"){const T=k.days*8,{data:A}=await Ue.from("comp_leaves").select("*").eq("user_id",k.user_id).eq("year",oe).single();A&&await Ue.from("comp_leaves").update({used_hours:A.used_hours+T,updated_at:new Date().toISOString()}).eq("id",A.id)}else{const{data:T}=await Ue.from("annual_leaves").select("*").eq("user_id",k.user_id).eq("year",oe).single();T?await Ue.from("annual_leaves").update({used_days:T.used_days+k.days,updated_at:new Date().toISOString()}).eq("id",T.id):await Ue.from("annual_leaves").insert({user_id:k.user_id,year:oe,total_days:f0,used_days:k.days})}return await Z(),await ee(),{success:!0}}catch(k){return console.error("  :",k),{success:!1,error:k.message}}finally{P(!1)}},Q=async(ce,k)=>{if(!D)return{success:!1,error:" ."};try{P(!0);const{error:de}=await Ue.from("leave_requests").update({status:"rejected",rejected_reason:k,approved_by:a,updated_at:new Date().toISOString()}).eq("id",ce);if(de)throw de;return await Z(),{success:!0}}catch(de){return console.error("  :",de),{success:!1,error:de.message}}finally{P(!1)}},ie=async ce=>{if(!D)return{success:!1,error:" ."};try{P(!0);const{error:k}=await Ue.from("overtime_requests").update({status:"approved",approved_by:a,approved_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",ce);if(k)throw k;return await we(),{success:!0}}catch(k){return console.error("  :",k),{success:!1,error:k.message}}finally{P(!1)}},B=async(ce,k)=>{if(!D)return{success:!1,error:" ."};try{P(!0);const{error:de}=await Ue.from("overtime_requests").update({status:"rejected",rejected_reason:k,approved_by:a,updated_at:new Date().toISOString()}).eq("id",ce);if(de)throw de;return await we(),{success:!0}}catch(de){return console.error("  :",de),{success:!1,error:de.message}}finally{P(!1)}},z=async(ce,k)=>{if(!D)return{success:!1,error:" ."};try{P(!0);const{data:de,error:U}=await Ue.from("annual_leaves").upsert({user_id:ce,year:oe,total_days:k,updated_at:new Date().toISOString()},{onConflict:"user_id,year"}).select().single();if(U)throw U;return await ee(),{success:!0,data:de}}catch(de){return console.error("  :",de),{success:!1,error:de.message}}finally{P(!1)}},ue=Y.useCallback(async(ce,k)=>{try{const de=new Date(ce,k,1).toISOString().split("T")[0],U=new Date(ce,k+1,0).toISOString().split("T")[0],{data:T,error:A}=await Ue.from("leave_requests").select("*").eq("status","approved").or(`start_date.lte.${U},end_date.gte.${de}`);if(A)throw A;const G=[...new Set((T||[]).map(je=>je.user_id))],{data:xe}=await Ue.from("users").select("id, name, team").in("id",G),be={};return(xe||[]).forEach(je=>{be[je.id]=je}),(T||[]).map(je=>({...je,user:be[je.user_id]}))}catch(de){return console.error("   :",de),[]}},[]),se=Y.useCallback(async(ce=null)=>{if(D)try{const{data:k}=await Ue.from("document_labels").select("id").eq("code",nd).single();if(!k)return;let de=Ue.from("documents").select("*, drafter:drafter_id(name, team, position)").eq("label_id",k.id).eq("attendance_type","leave").not("leave_type","is",null).order("created_at",{ascending:!1});ce==="pending"?de=de.eq("status","pending"):ce==="approved"?de=de.eq("status","approved"):ce==="rejected"&&(de=de.eq("status","rejected"));const{data:U,error:T}=await de;if(T)throw T;L(U||[])}catch(k){console.error("   :",k),V(k.message)}},[D]),re=async ce=>{if(!D)return{success:!1,error:" ."};try{P(!0);const{error:k}=await Ue.from("documents").update({status:"approved",approved_by:a,approved_at:new Date().toISOString()}).eq("id",ce);if(k)throw k;return await se(),{success:!0}}catch(k){return console.error("   :",k),{success:!1,error:k.message}}finally{P(!1)}},W=async(ce,k)=>{if(!D)return{success:!1,error:" ."};try{P(!0);const{error:de}=await Ue.from("documents").update({status:"rejected",approved_by:a,approved_at:new Date().toISOString(),rejected_reason:k}).eq("id",ce);if(de)throw de;return await se(),{success:!0}}catch(de){return console.error("   :",de),{success:!1,error:de.message}}finally{P(!1)}};return Y.useEffect(()=>{a&&(K(),M(),ae(),te(),D&&(Z(),we(),ee(),se()))},[a,D,K,M,ae,te,Z,we,ee,se]),{annualLeave:o,compLeave:u,myRequests:h,myOvertimeRequests:x,allRequests:v,allOvertimeRequests:g,allAnnualLeaves:b,allUsers:S,documentLeaves:R,loading:O,error:F,canManage:D,currentYear:oe,fetchAnnualLeave:K,fetchMyRequests:ae,createRequest:Ne,cancelRequest:q,fetchMyOvertimeRequests:te,createOvertimeRequest:I,cancelOvertimeRequest:X,fetchAllRequests:Z,fetchAllOvertimeRequests:we,fetchAllAnnualLeaves:ee,approveRequest:H,rejectRequest:Q,approveOvertimeRequest:ie,rejectOvertimeRequest:B,updateUserLeave:z,fetchDocumentLeaves:se,approveDocumentLeave:re,rejectDocumentLeave:W,fetchApprovedLeaves:ue}}const Jh={full:{label:"",days:1},half_am:{label:" ",days:.5},half_pm:{label:" ",days:.5},out_1h:{label:"/ 1",days:.125},out_2h:{label:"/ 2",days:.25},out_3h:{label:"/ 3",days:.375},comp:{label:"",days:1}},lZ=()=>{const{annualLeave:e,compLeave:t,myRequests:r,myOvertimeRequests:s,allRequests:a,allOvertimeRequests:o,allAnnualLeaves:c,allUsers:u,documentLeaves:d,loading:h,canManage:m,currentYear:x,createRequest:y,cancelRequest:v,createOvertimeRequest:w,cancelOvertimeRequest:g,approveRequest:_,rejectRequest:b,approveOvertimeRequest:N,rejectOvertimeRequest:S,updateUserLeave:E,fetchApprovedLeaves:R,fetchAllRequests:L,fetchAllOvertimeRequests:O,fetchAllAnnualLeaves:P,fetchDocumentLeaves:F,approveDocumentLeave:V,rejectDocumentLeave:oe}=oZ(),[D,K]=Y.useState("my"),[M,ae]=Y.useState(!1),[te,Z]=Y.useState("leave"),[we,ee]=Y.useState({leave_type:"full",start_date:"",end_date:"",reason:""}),[Ne,q]=Y.useState({start_date:"",start_time:"",end_date:"",end_time:"",reason:""}),[I,X]=Y.useState(!1),[H,Q]=Y.useState(null),[ie,B]=Y.useState(""),[z,ue]=Y.useState(!1),[se,re]=Y.useState(null),[W,ce]=Y.useState(15),[k,de]=Y.useState(new Date),[U,T]=Y.useState([]),[A,G]=Y.useState("pending"),[xe,be]=Y.useState(""),ne=(e?.total_days||15)-(e?.used_days||0),je=t?Math.floor((t.total_hours-t.used_hours)/8):0,Me=Y.useMemo(()=>{const Ae={};return u.forEach(Je=>{Ae[Je.id]=Je}),Ae},[u]),De=(Ae,Je,Ee)=>{if(!Je)return 0;if(Jh[Ae]&&Ae!=="full"&&Ae!=="comp")return Jh[Ae].days;if(!Ee)return 1;const Pe=new Date(Je),he=new Date(Ee),le=Math.abs(he-Pe);return Math.ceil(le/(1e3*60*60*24))+1},Ce=async()=>{if(!we.start_date){alert(" .");return}const Ae=De(we.leave_type,we.start_date,["full","comp"].includes(we.leave_type)?we.end_date:we.start_date);if(we.leave_type!=="comp"&&Ae>ne){alert(`  . (: ${ne})`);return}const Je=await y({...we,end_date:["full","comp"].includes(we.leave_type)&&we.end_date||we.start_date,days:Ae});Je.success?(ae(!1),ee({leave_type:"full",start_date:"",end_date:"",reason:""}),Z("leave"),alert(" .")):alert(" : "+Je.error)},st=async()=>{if(!Ne.start_date||!Ne.start_time){alert("   .");return}if(!Ne.end_date||!Ne.end_time){alert("   .");return}if(!Ne.reason.trim()){alert(" .");return}const Ae=`${Ne.start_date}T${Ne.start_time}:00`,Je=`${Ne.end_date}T${Ne.end_time}:00`;if(new Date(Je)<=new Date(Ae)){alert("     .");return}const Ee=await w({start_datetime:Ae,end_datetime:Je,reason:Ne.reason});Ee.success?(ae(!1),q({start_date:"",start_time:"",end_date:"",end_time:"",reason:""}),Z("leave"),alert("  .")):alert(" : "+Ee.error)},We=async Ae=>{if(!confirm(" ?"))return;const Je=await g(Ae);Je.success||alert(" : "+Je.error)},Ze=async Ae=>{const Je=await N(Ae);Je.success||alert(" : "+Je.error)},Re=async Ae=>{if(!confirm(" ?"))return;const Je=await v(Ae);Je.success||alert(" : "+Je.error)},pt=async Ae=>{const Je=await _(Ae);Je.success||alert(" : "+Je.error)},Tt=async()=>{if(!H)return;let Ae;H.isDocument?Ae=await oe(H.id,ie):H.isOvertime?Ae=await S(H.id,ie):Ae=await b(H.id,ie),Ae.success?(X(!1),Q(null),B("")):alert(" : "+Ae.error)},wt=async Ae=>{const Je=await V(Ae);Je.success||alert(" : "+Je.error)},jt=async()=>{if(!se)return;const Ae=await E(se.id,parseFloat(W));Ae.success?re(null):alert(" : "+Ae.error)};Y.useEffect(()=>{(async()=>{const Je=await R(k.getFullYear(),k.getMonth());T(Je)})()},[k,R]),Y.useEffect(()=>{m&&D==="manage"&&(L(A==="all"?null:A),O(A==="all"?null:A),F(A==="all"?null:A))},[A,D,m,L,O,F]),Y.useEffect(()=>{m&&D==="settings"&&P()},[D,m,P]);const Pt=Ae=>{switch(Ae){case"pending":return{text:"",color:"bg-yellow-100 text-yellow-700"};case"approved":return{text:"",color:"bg-green-100 text-green-700"};case"rejected":return{text:"",color:"bg-red-100 text-red-700"};default:return{text:Ae,color:"bg-gray-100 text-gray-700"}}},Le=Ae=>Jh[Ae]?.label||Ae,nt=()=>{const Ae=k.getFullYear(),Je=k.getMonth(),Ee=new Date(Ae,Je,1).getDay(),Pe=new Date(Ae,Je+1,0).getDate(),he=[],le=[];for(let Oe=0;Oe<Ee;Oe++)he.push(null);for(let Oe=1;Oe<=Pe;Oe++)he.push(Oe);for(let Oe=0;Oe<he.length;Oe+=7)le.push(he.slice(Oe,Oe+7));const ve=Oe=>{if(!Oe)return[];const qe=`${Ae}-${String(Je+1).padStart(2,"0")}-${String(Oe).padStart(2,"0")}`;return U.filter(ct=>qe>=ct.start_date&&qe<=ct.end_date)};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("button",{onClick:()=>de(new Date(Ae,Je-1,1)),className:"p-2 hover:bg-toss-gray-100 rounded-full",children:n.jsx(za,{size:20})}),n.jsxs("h3",{className:"text-lg font-bold text-toss-gray-900",children:[Ae," ",Je+1,""]}),n.jsx("button",{onClick:()=>de(new Date(Ae,Je+1,1)),className:"p-2 hover:bg-toss-gray-100 rounded-full",children:n.jsx(pa,{size:20})})]}),n.jsxs("div",{className:"border border-toss-gray-200 rounded-toss overflow-hidden",children:[n.jsx("div",{className:"grid grid-cols-7 bg-toss-gray-50",children:["","","","","","",""].map((Oe,qe)=>n.jsx("div",{className:`p-2 text-center text-sm font-medium ${qe===0?"text-red-500":qe===6?"text-blue-500":"text-toss-gray-600"}`,children:Oe},Oe))}),n.jsx("div",{className:"divide-y divide-toss-gray-100",children:le.map((Oe,qe)=>n.jsx("div",{className:"grid grid-cols-7 divide-x divide-toss-gray-100",children:Oe.map((ct,Et)=>{const Xt=ve(ct),er=ct&&new Date().toDateString()===new Date(Ae,Je,ct).toDateString();return n.jsx("div",{className:`min-h-[80px] p-1 ${ct?"":"bg-toss-gray-50"}`,children:ct&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:`text-sm font-medium mb-1 ${Et===0?"text-red-500":Et===6?"text-blue-500":"text-toss-gray-700"} ${er?"bg-toss-blue text-white w-6 h-6 rounded-full flex items-center justify-center":""}`,children:ct}),n.jsxs("div",{className:"space-y-0.5",children:[Xt.slice(0,3).map((Lt,Yt)=>n.jsx("div",{className:`text-xs px-1 py-0.5 rounded truncate ${Lt.leave_type==="full"?"bg-toss-blue/10 text-toss-blue":Lt.leave_type==="half_am"||Lt.leave_type==="am"?"bg-orange-100 text-orange-700":"bg-purple-100 text-purple-700"}`,title:`${Lt.user?.name} ${Le(Lt.leave_type)}`,children:Lt.user?.name},Yt)),Xt.length>3&&n.jsxs("div",{className:"text-xs text-toss-gray-400",children:["+",Xt.length-3,""]})]})]})},Et)})},qe))})]})]})},dt=()=>{const Ae=a.map(Pe=>{const he=Me[Pe.user_id];return{...Pe,_source:"leave_requests",_type:"leave",_sortDate:new Date(Pe.created_at),_name:he?.name||"  ",_team:he?.team,_position:he?.position}}),Je=o.map(Pe=>{const he=Me[Pe.user_id],le=new Date(Pe.start_datetime),ve=new Date(Pe.end_datetime),Oe=(ve-le)/(1e3*60*60),qe=Math.floor(Oe),ct=Math.round((Oe-qe)*60);return{...Pe,_source:"overtime_requests",_type:"overtime",_sortDate:new Date(Pe.created_at),_name:he?.name||"  ",_team:he?.team,_position:he?.position,_overtimeHours:ct>0?`${qe} ${ct}`:`${qe}`,_startDt:le,_endDt:ve}}),Ee=d.map(Pe=>({...Pe,_source:"document",_type:"leave",_sortDate:new Date(Pe.created_at),_name:Pe.drafter?.name,_team:Pe.drafter?.team,_position:Pe.drafter?.position,leave_type:Pe.leave_type,days:Pe.leave_days,start_date:Pe.leave_start_date,end_date:Pe.leave_end_date,reason:Pe.content||Pe.title}));return[...Ae,...Je,...Ee].sort((Pe,he)=>he._sortDate-Pe._sortDate)};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-toss-gray-900",children:" "}),n.jsxs("p",{className:"text-toss-gray-500 mt-1",children:[x,""]})]}),D==="my"&&n.jsxs(rt,{onClick:()=>ae(!0),children:[n.jsx(Ns,{size:18}),""]})]}),D==="my"&&e&&n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs(At,{className:"text-center",children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[e.total_days,""]})]}),n.jsxs(At,{className:"text-center",children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold text-toss-blue",children:[e.used_days,""]})]}),n.jsxs(At,{className:"text-center",children:[n.jsx("p",{className:"text-sm text-toss-gray-500 mb-1",children:""}),n.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[e.total_days-e.used_days,""]})]})]}),n.jsxs("div",{className:"flex items-center gap-2 border-b border-toss-gray-200",children:[n.jsxs("button",{onClick:()=>K("my"),className:`px-4 py-3 font-medium text-sm transition-colors relative ${D==="my"?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[n.jsx(ea,{size:16,className:"inline mr-1"})," ",D==="my"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]}),n.jsxs("button",{onClick:()=>K("calendar"),className:`px-4 py-3 font-medium text-sm transition-colors relative ${D==="calendar"?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[n.jsx(ha,{size:16,className:"inline mr-1"}),"",D==="calendar"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]}),m&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>K("manage"),className:`px-4 py-3 font-medium text-sm transition-colors relative ${D==="manage"?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[n.jsx(Sd,{size:16,className:"inline mr-1"})," ",D==="manage"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]}),n.jsxs("button",{onClick:()=>K("settings"),className:`px-4 py-3 font-medium text-sm transition-colors relative ${D==="settings"?"text-toss-blue":"text-toss-gray-500 hover:text-toss-gray-700"}`,children:[n.jsx(hl,{size:16,className:"inline mr-1"})," ",D==="settings"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-toss-blue"})]})]})]}),D==="my"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs(At,{padding:"p-0",children:[n.jsx("div",{className:"p-4 border-b border-toss-gray-100",children:n.jsx("h3",{className:"font-medium text-toss-gray-900",children:"  "})}),r.length>0?n.jsx("div",{className:"divide-y divide-toss-gray-100",children:r.map(Ae=>{const Je=Pt(Ae.status);return n.jsx("div",{className:"p-4",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Je.color}`,children:Je.text}),n.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:Le(Ae.leave_type)}),n.jsxs("span",{className:"text-sm text-toss-gray-500",children:[Ae.days,""]})]}),n.jsx("p",{className:"text-sm text-toss-gray-700",children:Ae.start_date===Ae.end_date?Ae.start_date:`${Ae.start_date} ~ ${Ae.end_date}`}),Ae.reason&&n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:Ae.reason}),Ae.status==="rejected"&&Ae.rejected_reason&&n.jsxs("p",{className:"text-sm text-red-500 mt-1",children:[" : ",Ae.rejected_reason]})]}),Ae.status==="pending"&&n.jsx("button",{onClick:()=>Re(Ae.id),className:"text-sm text-red-500 hover:underline",children:""})]})},Ae.id)})}):n.jsx("div",{className:"p-8 text-center text-toss-gray-400",children:"   "})]}),n.jsxs(At,{padding:"p-0",children:[n.jsx("div",{className:"p-4 border-b border-toss-gray-100",children:n.jsx("h3",{className:"font-medium text-toss-gray-900",children:"  "})}),s.length>0?n.jsx("div",{className:"divide-y divide-toss-gray-100",children:s.map(Ae=>{const Je=Pt(Ae.status),Ee=new Date(Ae.start_datetime),Pe=new Date(Ae.end_datetime),he=(Pe-Ee)/(1e3*60*60),le=Math.floor(he),ve=Math.round((he-le)*60);return n.jsx("div",{className:"p-4",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Je.color}`,children:Je.text}),n.jsx("span",{className:"text-sm font-medium text-toss-gray-900",children:""}),n.jsx("span",{className:"text-sm text-toss-gray-500",children:ve>0?`${le} ${ve}`:`${le}`})]}),n.jsxs("p",{className:"text-sm text-toss-gray-700",children:[Ee.toLocaleDateString("ko-KR")," ",Ee.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})," ~"," ",Pe.toLocaleDateString("ko-KR")," ",Pe.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})]}),Ae.reason&&n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:Ae.reason}),Ae.status==="rejected"&&Ae.rejected_reason&&n.jsxs("p",{className:"text-sm text-red-500 mt-1",children:[" : ",Ae.rejected_reason]})]}),Ae.status==="pending"&&n.jsx("button",{onClick:()=>We(Ae.id),className:"text-sm text-red-500 hover:underline",children:""})]})},Ae.id)})}):n.jsx("div",{className:"p-8 text-center text-toss-gray-400",children:"   "})]})]}),D==="calendar"&&n.jsx(At,{children:nt()}),D==="manage"&&m&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"flex gap-2",children:["pending","approved","rejected","all"].map(Ae=>n.jsx("button",{onClick:()=>G(Ae),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${A===Ae?"bg-toss-blue text-white":"bg-toss-gray-100 text-toss-gray-600 hover:bg-toss-gray-200"}`,children:Ae==="pending"?"":Ae==="approved"?"":Ae==="rejected"?"":""},Ae))}),n.jsx(At,{padding:"p-0",children:dt().length>0?n.jsx("div",{className:"divide-y divide-toss-gray-100",children:dt().map(Ae=>{const Je=Pt(Ae.status),Ee=Ae._source==="document",Pe=Ae._source==="overtime_requests";return n.jsx("div",{className:"p-4",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"font-medium text-toss-gray-900",children:Ae._name}),n.jsxs("span",{className:"text-sm text-toss-gray-500",children:[Ae._team," ",Ae._position]}),n.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Je.color}`,children:Je.text}),Ee&&n.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-700",children:""}),Pe&&n.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-700",children:""})]}),Pe?n.jsx(n.Fragment,{children:n.jsxs("p",{className:"text-sm text-toss-gray-700",children:[" ",Ae._overtimeHours," "," ",Ae._startDt.toLocaleDateString("ko-KR")," ",Ae._startDt.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})," ~"," ",Ae._endDt.toLocaleDateString("ko-KR")," ",Ae._endDt.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})]})}):n.jsxs("p",{className:"text-sm text-toss-gray-700",children:[Le(Ae.leave_type)," ",Ae.days," "," ",Ae.start_date===Ae.end_date?Ae.start_date:`${Ae.start_date} ~ ${Ae.end_date}`]}),Ae.reason&&n.jsx("p",{className:"text-sm text-toss-gray-500 mt-1",children:Ae.reason}),Ae.status==="rejected"&&Ae.rejected_reason&&n.jsxs("p",{className:"text-sm text-red-500 mt-1",children:[" : ",Ae.rejected_reason]})]}),Ae.status==="pending"?n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>{Ee?wt(Ae.id):Pe?Ze(Ae.id):pt(Ae.id)},className:"p-2 text-green-600 hover:bg-green-50 rounded-full",children:n.jsx(y0,{size:18})}),n.jsx("button",{onClick:()=>{Q({...Ae,isDocument:Ee,isOvertime:Pe}),X(!0)},className:"p-2 text-red-500 hover:bg-red-50 rounded-full",children:n.jsx(pr,{size:18})})]}):n.jsxs("span",{className:"text-xs text-toss-gray-400",children:[Ae.approved_at&&new Date(Ae.approved_at).toLocaleDateString("ko-KR"),Ae.updated_at&&!Ae.approved_at&&new Date(Ae.updated_at).toLocaleDateString("ko-KR")]})]})},`${Ae._source}-${Ae.id}`)})}):n.jsx("div",{className:"p-8 text-center text-toss-gray-400",children:"  "})})]}),D==="settings"&&m&&n.jsxs(At,{padding:"p-0",children:[n.jsxs("div",{className:"p-4 border-b border-toss-gray-100 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Sd,{size:18,className:"text-toss-gray-500"}),n.jsx("h3",{className:"font-medium text-toss-gray-900",children:"  "})]}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",placeholder:"   ",value:xe,onChange:Ae=>be(Ae.target.value),className:"pl-9 pr-4 py-2 bg-toss-gray-100 border-0 rounded-toss text-sm focus:ring-2 focus:ring-toss-blue w-56"}),n.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-toss-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-toss-gray-100",children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:""}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:""}),n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:" "}),n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:""}),n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-toss-gray-500 uppercase tracking-wider",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-toss-gray-100",children:u.filter(Ae=>{if(!xe)return!0;const Je=xe.toLowerCase();return Ae.name?.toLowerCase().includes(Je)||Ae.team?.toLowerCase().includes(Je)}).map(Ae=>{const Je=c.find(ve=>ve.user_id===Ae.id),Ee=Je?.total_days??15,Pe=Je?.used_days??0,he=Ee-Pe,le=se?.id===Ae.id;return n.jsxs("tr",{className:"hover:bg-toss-gray-50",children:[n.jsx("td",{className:"px-6 py-4",children:n.jsx("p",{className:"font-medium text-toss-gray-900",children:Ae.name})}),n.jsx("td",{className:"px-6 py-3 text-sm text-toss-gray-700",children:Ae.team||"-"}),n.jsx("td",{className:"px-6 py-3 text-center",children:le?n.jsx("input",{type:"number",value:W,onChange:ve=>ce(ve.target.value),onBlur:async()=>{await jt()},onKeyDown:async ve=>{ve.key==="Enter"?await jt():ve.key==="Escape"&&re(null)},min:0,step:.5,className:"w-16 px-2 py-1 text-center bg-white border border-toss-blue rounded text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue",autoFocus:!0}):n.jsxs("span",{onClick:()=>{re(Ae),ce(Ee)},className:"cursor-pointer hover:text-toss-blue font-medium",children:[Ee,""]})}),n.jsxs("td",{className:"px-6 py-3 text-center text-sm text-toss-blue font-medium",children:[Pe,""]}),n.jsxs("td",{className:"px-6 py-3 text-center text-sm text-green-600 font-bold",children:[he,""]})]},Ae.id)})})]})})]}),n.jsx(yr,{isOpen:M,onClose:()=>{ae(!1),Z("leave"),ee({leave_type:"full",start_date:"",end_date:"",reason:""})},title:" ",size:"lg",children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("button",{onClick:()=>Z("overtime"),className:`p-4 rounded-toss border-2 text-left transition-all ${te==="overtime"?"border-toss-blue bg-toss-blue/5":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(ea,{size:20,className:te==="overtime"?"text-toss-blue":"text-toss-gray-400"}),n.jsx("span",{className:`font-medium ${te==="overtime"?"text-toss-blue":"text-toss-gray-700"}`,children:" "})]}),n.jsx("p",{className:"text-xs text-toss-gray-500",children:",  "})]}),n.jsxs("button",{onClick:()=>Z("leave"),className:`p-4 rounded-toss border-2 text-left transition-all ${te==="leave"?"border-toss-blue bg-toss-blue/5":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(ha,{size:20,className:te==="leave"?"text-toss-blue":"text-toss-gray-400"}),n.jsx("span",{className:`font-medium ${te==="leave"?"text-toss-blue":"text-toss-gray-700"}`,children:" "})]}),n.jsx("p",{className:"text-xs text-toss-gray-500",children:", , "})]})]})]}),te==="leave"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex gap-4 p-3 bg-toss-gray-50 rounded-toss",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-toss-gray-500",children:" : "}),n.jsxs("span",{className:"font-bold text-toss-blue",children:[ne,""]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-toss-gray-500",children:" : "}),n.jsxs("span",{className:"font-bold text-toss-gray-700",children:[je,""]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.entries(Jh).map(([Ae,Je])=>{const Ee=Ae==="comp"&&je===0;return n.jsxs("button",{onClick:()=>!Ee&&ee({...we,leave_type:Ae}),disabled:Ee,className:`p-3 rounded-toss border text-left transition-all ${we.leave_type===Ae?"border-toss-blue bg-toss-blue/5":Ee?"border-toss-gray-100 bg-toss-gray-50 cursor-not-allowed":"border-toss-gray-200 hover:border-toss-gray-300"}`,children:[n.jsx("p",{className:`font-medium text-sm ${we.leave_type===Ae?"text-toss-blue":Ee?"text-toss-gray-400":"text-toss-gray-700"}`,children:Je.label}),n.jsx("p",{className:`text-xs mt-0.5 ${Ee?"text-toss-gray-300":"text-toss-gray-500"}`,children:Ae==="comp"&&Ee?" ":`${Je.days} `})]},Ae)})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:[["full","comp"].includes(we.leave_type)?"":""," ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:we.start_date,onChange:Ae=>ee({...we,start_date:Ae.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]}),["full","comp"].includes(we.leave_type)&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:""}),n.jsx("input",{type:"date",value:we.end_date,onChange:Ae=>ee({...we,end_date:Ae.target.value}),min:we.start_date,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" ()"}),n.jsx("textarea",{value:we.reason,onChange:Ae=>ee({...we,reason:Ae.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:" "})]}),we.start_date&&n.jsx("div",{className:"p-3 bg-toss-blue/5 rounded-toss border border-toss-blue/20",children:n.jsxs("p",{className:"text-sm text-toss-gray-700",children:[" :"," ",n.jsxs("span",{className:"font-bold text-toss-blue",children:[De(we.leave_type,we.start_date,["full","comp"].includes(we.leave_type)?we.end_date:we.start_date),""]})]})})]}),te==="overtime"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx("input",{type:"date",value:Ne.start_date,onChange:Ae=>q({...Ne,start_date:Ae.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"}),n.jsx("input",{type:"time",value:Ne.start_time,onChange:Ae=>q({...Ne,start_time:Ae.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:["  ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx("input",{type:"date",value:Ne.end_date,onChange:Ae=>q({...Ne,end_date:Ae.target.value}),min:Ne.start_date,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"}),n.jsx("input",{type:"time",value:Ne.end_time,onChange:Ae=>q({...Ne,end_time:Ae.target.value}),className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:Ne.reason,onChange:Ae=>q({...Ne,reason:Ae.target.value}),rows:3,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:"  "})]}),Ne.start_date&&Ne.start_time&&Ne.end_date&&Ne.end_time&&n.jsx("div",{className:"p-3 bg-toss-blue/5 rounded-toss border border-toss-blue/20",children:n.jsxs("p",{className:"text-sm text-toss-gray-700",children:[" :"," ",n.jsx("span",{className:"font-bold text-toss-blue",children:(()=>{const Ae=new Date(`${Ne.start_date}T${Ne.start_time}`),Ee=(new Date(`${Ne.end_date}T${Ne.end_time}`)-Ae)/(1e3*60*60);if(Ee>0){const Pe=Math.floor(Ee),he=Math.round((Ee-Pe)*60);return he>0?`${Pe} ${he}`:`${Pe}`}return"0"})()})]})})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{ae(!1),Z("leave"),ee({leave_type:"full",start_date:"",end_date:"",reason:""}),q({start_date:"",start_time:"",end_date:"",end_time:"",reason:""})},className:"flex-1",children:""}),n.jsx(rt,{onClick:te==="overtime"?st:Ce,className:"flex-1",disabled:h,children:""})]})]})}),n.jsx(yr,{isOpen:I,onClose:()=>{X(!1),Q(null),B("")},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("p",{className:"text-toss-gray-700",children:[n.jsx("span",{className:"font-medium",children:H?.isDocument?H?.drafter?.name:H?._name}),"  ."]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:" "}),n.jsx("textarea",{value:ie,onChange:Ae=>B(Ae.target.value),rows:3,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue resize-none",placeholder:"  "})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{X(!1),Q(null),B("")},className:"flex-1",children:""}),n.jsx(rt,{variant:"danger",onClick:Tt,className:"flex-1",disabled:h,children:""})]})]})}),n.jsx(yr,{isOpen:z,onClose:()=>{ue(!1),re(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("p",{className:"text-toss-gray-700",children:[n.jsx("span",{className:"font-medium",children:se?.name})," ",x," "]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-2",children:"  "}),n.jsx("input",{type:"number",value:W,onChange:Ae=>ce(Ae.target.value),min:0,step:.5,className:"w-full px-4 py-3 bg-toss-gray-100 border-0 rounded-toss focus:ring-2 focus:ring-toss-blue"})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(rt,{variant:"secondary",onClick:()=>{ue(!1),re(null)},className:"flex-1",children:""}),n.jsx(rt,{onClick:jt,className:"flex-1",disabled:h,children:""})]})]})})]})},cZ=e=>{if(!e)return"";const t=new Date(e);return t.setMonth(t.getMonth()+4),t.toISOString().split("T")[0]},X1=e=>e?e.replace(/-/g,"."):"-",gj=e=>{if(!e)return!1;const t=new Date(e),r=new Date,s=new Date(r.getFullYear(),r.getMonth()+1,r.getDate());return t<=s&&t>=r},Zh=12;function j5({isOpen:e,onClose:t,records:r,stats:s,backgroundImage:a}){const o=Y.useRef(null),c=Y.useRef(null),[u,d]=Y.useState(!1),[h,m]=Y.useState(!0),[x,y]=Y.useState(null),[v,w]=Y.useState(0),[g,_]=Y.useState(1);Y.useEffect(()=>{const L=()=>{d(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",L),()=>document.removeEventListener("fullscreenchange",L)},[]),Y.useEffect(()=>{const L=O=>{O.key==="Escape"&&!u&&t(),O.key==="ArrowLeft"&&v>0&&w(P=>P-1),O.key==="ArrowRight"&&v<g-1&&w(P=>P+1)};return e&&document.addEventListener("keydown",L),()=>document.removeEventListener("keydown",L)},[e,u,t,v,g]);const b=Y.useCallback(async L=>{const O=o.current;if(!O)return;m(!0);const P=2,F=1920,V=155,oe=Math.max(1,Math.ceil(r.length/Zh));_(oe);const D=L===0,K=r.slice(L*Zh,(L+1)*Zh),M=26,ae=50,te=56,Z=be=>{const ne=(be.admin_status||"").split(`
`).filter(De=>De.trim()),je=(be.notes||"").split(`
`).filter(De=>De.trim()),Me=Math.max(ne.length,je.length);return Me<=1?ae:Math.max(ae,Me*M+16)},we=K.reduce((be,ne)=>be+Z(ne),0),Ne=Math.max(1080,V+(D?130:0)+te+we+60);O.width=F*P,O.height=Ne*P;const q=O.getContext("2d");if(!q)return;q.imageSmoothingEnabled=!0,q.imageSmoothingQuality="high",q.scale(P,P);const I="/company-intranet/",X=a||"back_2.jpg",H=new Image;H.crossOrigin="anonymous",H.src=`${I}${X}`,await new Promise(be=>{H.onload=()=>be(),H.onerror=()=>be()}),q.drawImage(H,0,0,F,Ne);const Q="#3b6cb5",ie="#ffffff",B="rgba(255, 255, 255, 0.95)",z="rgba(245, 247, 250, 0.95)",ue="#1a2332",se="#2d3748",re="#718096";let W=V;if(D){const De=(F-932)/2;[{label:" ",value:s.total},{label:"  ",value:s.active},{label:" ",value:s.discharged}].forEach((st,We)=>{const Ze=De+We*316;q.fillStyle=Q,q.fillRect(Ze,V,300,44),q.fillStyle=ie,q.font="bold 22px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.textBaseline="middle",q.fillText(st.label,Ze+300/2,V+22),q.fillStyle=B,q.fillRect(Ze,V+44,300,66),q.fillStyle=ue,q.font="bold 48px Pretendard, -apple-system, sans-serif";const Re=`${st.value}`,pt=q.measureText(Re).width;q.fillText(Re,Ze+300/2-10,V+44+66/2),q.fillStyle=re,q.font="24px Pretendard, -apple-system, sans-serif",q.fillText("",Ze+300/2-10+pt/2+10,V+44+66/2+2)}),W=V+110+20}const ce=40,k=F-80,de=56,U=[{label:"No",width:60},{label:"",width:130},{label:"",width:170},{label:"",width:160},{label:"",width:80},{label:"",width:100},{label:" ",width:170},{label:" ",width:170},{label:"",width:400},{label:"",width:0}],T=U.reduce((be,ne)=>be+ne.width,0);U[U.length-1].width=k-T,q.fillStyle=Q,q.fillRect(ce,W,k,de),q.fillStyle=ie,q.font="bold 20px Pretendard, -apple-system, sans-serif",q.textBaseline="middle";let A=ce;U.forEach(be=>{q.textAlign="center",q.fillText(be.label,A+be.width/2,W+de/2),A+=be.width});const G=K.map(be=>Z(be));let xe=0;if(K.forEach((be,ne)=>{const je=L*Zh+ne,Me=G[ne],De=W+de+xe,Ce=cZ(be.admission_date),st=be.discharge_date;q.fillStyle=ne%2===0?B:z,q.fillRect(ce,De,k,Me),q.textBaseline="middle";const We=De+Me/2;let Ze=ce;q.fillStyle=re,q.font="22px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText(`${je+1}`,Ze+U[0].width/2,We),Ze+=U[0].width,q.fillStyle=se,q.font="22px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText(be.location||"-",Ze+U[1].width/2,We),Ze+=U[1].width,q.fillStyle=ue,q.font="600 22px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText(X1(be.admission_date),Ze+U[2].width/2,We),Ze+=U[2].width,q.fillStyle=ue,q.font="bold 24px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText(be.ganghwa||"-",Ze+U[3].width/2,We),Ze+=U[3].width,q.fillStyle=se,q.font="22px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText(be.bupyeong||"-",Ze+U[4].width/2,We),Ze+=U[4].width,q.fillStyle=se,q.font="22px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText(be.room||"-",Ze+U[5].width/2,We),Ze+=U[5].width,Ce?(q.fillStyle=gj(Ce)?"#ef4444":"#2563eb",q.font="600 22px Pretendard, -apple-system, sans-serif"):(q.fillStyle=re,q.font="22px Pretendard, -apple-system, sans-serif"),q.textAlign="center",q.fillText(Ce?X1(Ce):"-",Ze+U[6].width/2,We),Ze+=U[6].width,st&&st!==Ce?(q.fillStyle=gj(st)?"#ef4444":"#ea580c",q.font="600 22px Pretendard, -apple-system, sans-serif",q.fillText(X1(st),Ze+U[7].width/2,We)):(q.fillStyle=re,q.font="22px Pretendard, -apple-system, sans-serif",q.fillText("-",Ze+U[7].width/2,We)),Ze+=U[7].width,q.fillStyle=se,q.font="20px Pretendard, -apple-system, sans-serif",q.textAlign="left";const pt=(be.admin_status||"-").split(`
`).map(Oe=>Oe.trim()).filter((Oe,qe,ct)=>qe<ct.length||ct[qe]!==""),Tt=U[8].width-16,wt=pt.map(Oe=>{let qe=Oe;for(;q.measureText(qe).width>Tt&&qe.length>1;)qe=qe.slice(0,-1);return qe!==Oe&&qe.length>0&&(qe+=".."),qe}),jt=Math.max(...wt.map(Oe=>q.measureText(Oe).width),0),Pt=Ze+(U[8].width-jt)/2,Le=wt.length*M,nt=De+(Me-Le)/2+M/2+2;wt.forEach((Oe,qe)=>{q.fillText(Oe,Pt,nt+qe*M)}),Ze+=U[8].width,q.fillStyle=se,q.font="20px Pretendard, -apple-system, sans-serif",q.textAlign="left";const Ae=(be.notes||"-").split(`
`).map(Oe=>Oe.trim()).filter((Oe,qe,ct)=>qe<ct.length||ct[qe]!==""),Je=U[9].width-16,Ee=Ae.map(Oe=>{let qe=Oe;for(;q.measureText(qe).width>Je&&qe.length>1;)qe=qe.slice(0,-1);return qe!==Oe&&qe.length>0&&(qe+=".."),qe}),Pe=Math.max(...Ee.map(Oe=>q.measureText(Oe).width),0),he=Ze+(U[9].width-Pe)/2,le=Ee.length*M,ve=De+(Me-le)/2+M/2+2;Ee.forEach((Oe,qe)=>{q.fillText(Oe,he,ve+qe*M)}),xe+=Me}),oe>1){const be=de+xe,ne=W+be+25;q.fillStyle=re,q.font="600 16px Pretendard, -apple-system, sans-serif",q.textAlign="center",q.fillText(`${L+1} / ${oe} `,F/2,ne)}y(O.toDataURL("image/png")),m(!1)},[r,s,a]);Y.useEffect(()=>{if(e){w(0);const L=setTimeout(()=>{b(0)},100);return()=>clearTimeout(L)}},[e,b]),Y.useEffect(()=>{e&&b(v)},[v,e,b]);const N=Y.useCallback(()=>{document.fullscreenElement?document.exitFullscreen():c.current?.requestFullscreen()},[]),S=Y.useCallback(()=>{const L=o.current;L&&L.toBlob(O=>{if(O){const P=URL.createObjectURL(O),F=document.createElement("a"),V=g>1?`_${v+1}`:"";F.download=`_${V}_${new Date().toISOString().split("T")[0]}.png`,F.href=P,F.click(),URL.revokeObjectURL(P)}},"image/png")},[v,g]),E=()=>{v>0&&w(L=>L-1)},R=()=>{v<g-1&&w(L=>L+1)};return e?n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90",children:[n.jsx("canvas",{ref:o,width:1920,height:1080,style:{display:"none"}}),!u&&n.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-[60] p-3 bg-white rounded-full shadow-lg hover:bg-gray-100 transition-colors",title:" (ESC)",children:n.jsx(pr,{size:28})}),n.jsx("div",{ref:c,className:"relative flex items-center justify-center w-full h-full",children:h?n.jsx("div",{className:"text-white text-xl",children:" ..."}):x?n.jsxs(n.Fragment,{children:[n.jsx("img",{src:x,alt:"",className:`max-w-full max-h-full object-contain ${u?"w-full h-full":""}`,style:{maxWidth:u?"100%":"90vw",maxHeight:u?"100%":"90vh"}}),!u&&n.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-3 z-50",children:[g>1&&n.jsxs("div",{className:"flex items-center gap-1 bg-white/90 rounded-lg shadow-lg px-2",children:[n.jsx("button",{onClick:E,disabled:v===0,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-30 disabled:cursor-not-allowed",title:" ",children:n.jsx(za,{size:20})}),n.jsxs("span",{className:"text-sm font-medium text-gray-700 px-2",children:[v+1," / ",g]}),n.jsx("button",{onClick:R,disabled:v===g-1,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-30 disabled:cursor-not-allowed",title:" ",children:n.jsx(pa,{size:20})})]}),n.jsxs("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 bg-white/90 hover:bg-white rounded-lg shadow-lg transition-all text-gray-800",title:" ",children:[n.jsx(ns,{size:20}),n.jsx("span",{className:"font-medium",children:""})]}),n.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-white/90 hover:bg-white rounded-lg shadow-lg transition-all text-gray-800",title:"",children:[n.jsx(h4,{size:20}),n.jsx("span",{className:"font-medium",children:""})]})]})]}):n.jsx("div",{className:"text-white text-xl",children:"   ."})})]}):null}const Ku=e=>{if(!e)return"";const t=new Date(e);return t.setMonth(t.getMonth()+4),t.toISOString().split("T")[0]},Rs=e=>e?e.replace(/-/g,"."):"-",Qh=e=>{if(!e)return!1;const t=new Date(e),r=new Date,s=new Date(r.getFullYear(),r.getMonth()+1,r.getDate());return t<=s&&t>=r},Xu={admission_date:"",bupyeong:"",ganghwa:"",room:"",discharge_date:"",location:"",admin_status:"",notes:""};function uZ(){const{profile:e,isAdmin:t}=Yr(),[r,s]=Y.useState([]),[a,o]=Y.useState(!0),[c,u]=Y.useState(!1),[d,h]=Y.useState(!1),[m,x]=Y.useState(!1),[y,v]=Y.useState(null),[w,g]=Y.useState(null),[_,b]=Y.useState(null),[N,S]=Y.useState(Xu),[E,R]=Y.useState(!1),[L,O]=Y.useState(!1),[P,F]=Y.useState(!0),[V,oe]=Y.useState(!0),[D,K]=Y.useState(!1),M=Y.useRef(null),ae=Y.useCallback(async()=>{try{o(!0);const{data:k,error:de}=await Ue.from("admission_records").select("*").order("admission_date",{ascending:!1});if(de)throw de;s(k||[])}catch(k){console.error("  :",k)}finally{o(!1)}},[]);Y.useEffect(()=>{ae()},[ae]);const te=k=>{if(!k)return 1/0;const de=parseInt(k.replace(/[^0-9]/g,""),10);return isNaN(de)?1/0:de},Z=r.filter(k=>!k.is_discharged).sort((k,de)=>{const U=te(k.room),T=te(de.room);return U!==1/0||T!==1/0?U-T:(k.admission_date||"").localeCompare(de.admission_date||"")}),we=r.filter(k=>k.is_discharged),ee=()=>{v(null),S(Xu),u(!0)},Ne=k=>{v(k),S({admission_date:k.admission_date||"",bupyeong:k.bupyeong||"",ganghwa:k.ganghwa||"",room:k.room||"",discharge_date:k.discharge_date||"",location:k.location||"",admin_status:k.admin_status||"",notes:k.notes||""}),u(!0)},q=k=>{g(k),h(!0)},I=async()=>{if(w)try{const{error:k}=await Ue.from("admission_records").delete().eq("id",w);if(k)throw k;await ae()}catch(k){console.error(" :",k),alert("   .")}finally{h(!1),g(null)}},X=k=>{b(k),x(!0)},H=async()=>{if(_)try{const k=new Date().toISOString().split("T")[0],{error:de}=await Ue.from("admission_records").update({is_discharged:!0,discharge_date:k}).eq("id",_);if(de)throw de;await ae()}catch(k){console.error("  :",k),alert(`    .
${k?.message||JSON.stringify(k)}`)}finally{x(!1),b(null)}},Q=async()=>{if(!N.admission_date){alert(" .");return}if(!N.ganghwa){alert(" .");return}R(!0);try{const k={admission_date:N.admission_date,bupyeong:N.bupyeong,ganghwa:N.ganghwa,room:N.room,discharge_date:N.discharge_date||null,location:N.location,admin_status:N.admin_status,notes:N.notes};if(y){const{error:de}=await Ue.from("admission_records").update(k).eq("id",y.id);if(de)throw de}else{const{error:de}=await Ue.from("admission_records").insert({...k,is_discharged:!1});if(de)throw de}await ae(),u(!1),S(Xu),v(null)}catch(k){console.error(" :",k),alert(`   .
${k?.message||JSON.stringify(k)}`)}finally{R(!1)}},ie=()=>{if(r.length===0){alert("  .");return}const k=r.map((A,G)=>{const xe=Ku(A.admission_date);return{No:G+1,:A.location||"",:Rs(A.admission_date),:A.ganghwa||"",:A.bupyeong||"",:A.room||""," ":Rs(xe)," ":Rs(A.discharge_date),:A.admin_status||"",:A.notes||"",:A.is_discharged?"":" "}}),de=Fs.json_to_sheet(k),U=Fs.book_new();Fs.book_append_sheet(U,de,""),de["!cols"]=[{wch:5},{wch:12},{wch:14},{wch:12},{wch:8},{wch:8},{wch:14},{wch:14},{wch:15},{wch:25},{wch:10}];const T=new Date().toISOString().split("T")[0];Ud(U,`__${T}.xlsx`)},B=()=>{const k=[["","","","",""," ","",""]],de=Fs.aoa_to_sheet(k),U=Fs.book_new();Fs.book_append_sheet(U,de,""),de["!cols"]=[{wch:12},{wch:14},{wch:12},{wch:8},{wch:8},{wch:14},{wch:15},{wch:25}],Ud(U,"__.xlsx")},z=async k=>{const de=k.target.files?.[0];if(de){M.current&&(M.current.value=""),K(!0);try{const U=await de.arrayBuffer(),T=Bd(U),A=T.Sheets[T.SheetNames[0]],G=Fs.sheet_to_json(A);if(G.length===0){alert("   .");return}const xe=Ce=>{if(!Ce)return"";if(typeof Ce=="number")return new Date((Ce-25569)*86400*1e3).toISOString().split("T")[0];const st=String(Ce).trim(),We=st.match(/(\d{4})[.\-/](\d{1,2})[.\-/](\d{1,2})/);if(We)return`${We[1]}-${We[2].padStart(2,"0")}-${We[3].padStart(2,"0")}`;const Ze=st.match(/(\d{2})[.\-/](\d{1,2})[.\-/](\d{1,2})/);if(Ze){const Re=parseInt(Ze[1],10);return`${Re>=50?1900+Re:2e3+Re}-${Ze[2].padStart(2,"0")}-${Ze[3].padStart(2,"0")}`}return st},be=G.map(Ce=>({admission_date:xe(Ce.||Ce.),bupyeong:String(Ce.||Ce.||"").trim(),ganghwa:String(Ce.||Ce.||"").trim(),room:String(Ce.||"").trim(),discharge_date:xe(Ce[" "]||Ce.||Ce.),location:String(Ce.||Ce.||Ce.||"").trim(),admin_status:String(Ce.||"").trim(),notes:String(Ce.||"").trim()})).filter(Ce=>Ce.admission_date);if(be.length===0){alert("  .  .");return}let ne=0,je=0,Me=0;for(const Ce of be){const st=r.find(We=>We.ganghwa===Ce.ganghwa&&We.admission_date===Ce.admission_date);if(st)if(st.room!==Ce.room||st.location!==Ce.location||st.admin_status!==Ce.admin_status||st.notes!==Ce.notes||st.bupyeong!==Ce.bupyeong){const{error:Ze}=await Ue.from("admission_records").update({bupyeong:Ce.bupyeong,ganghwa:Ce.ganghwa,room:Ce.room,location:Ce.location,admin_status:Ce.admin_status,notes:Ce.notes,discharge_date:Ce.discharge_date||null}).eq("id",st.id);if(Ze)throw Ze;je++}else Me++;else{const{error:We}=await Ue.from("admission_records").insert({admission_date:Ce.admission_date,bupyeong:Ce.bupyeong,ganghwa:Ce.ganghwa,room:Ce.room,discharge_date:Ce.discharge_date||null,location:Ce.location,admin_status:Ce.admin_status,notes:Ce.notes,is_discharged:!1});if(We)throw We;ne++}}await ae();const De=[];ne>0&&De.push(` : ${ne}`),je>0&&De.push(`: ${je}`),Me>0&&De.push(` : ${Me}`),alert(` !
${De.join(`
`)}`)}catch(U){console.error("  :",U),alert(`   .
${U?.message||JSON.stringify(U)}`)}finally{K(!1)}}},ue=r.length,se=Z.length,re=we.length,W=Z,ce=()=>{const de=`
      <div class="stats-grid">
        <div class="stat-box"><div class="label"> </div><div class="value">${ue}<span class="unit"> </span></div></div>
        <div class="stat-box highlight"><div class="label">  </div><div class="value">${se}<span class="unit"> </span></div></div>
        <div class="stat-box"><div class="label"> </div><div class="value">${re}<span class="unit"> </span></div></div>
      </div>
      <div class="section-title">   (${se})</div>
      <table>
        <thead><tr>
          <th>No</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th> </th>
          <th> </th>
          <th></th>
          <th></th>
        </tr></thead>
        <tbody>
          ${Z.map((U,T)=>{const A=Ku(U.admission_date);return`<tr>
              <td style="text-align:center">${T+1}</td>
              <td style="text-align:center">${U.location||"-"}</td>
              <td style="text-align:center">${Rs(U.admission_date)}</td>
              <td style="text-align:center">${U.ganghwa||"-"}</td>
              <td style="text-align:center">${U.bupyeong||"-"}</td>
              <td style="text-align:center">${U.room||"-"}</td>
              <td style="text-align:center">${Rs(A)}</td>
              <td style="text-align:center">${U.discharge_date?Rs(U.discharge_date):"-"}</td>
              <td style="text-align:center;white-space:pre-line">${U.admin_status||"-"}</td>
              <td>${U.notes||"-"}</td>
            </tr>`}).join("")}
        </tbody>
      </table>
    `;il({title:"   ",content:de})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(At,{className:"bg-gradient-to-r from-toss-blue to-blue-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(bd,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:"  "}),n.jsx("p",{className:"text-white/90",children:t?"     ":"    "})]})]})}),n.jsxs(At,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-blue-50 border-b border-blue-100 cursor-pointer",onClick:()=>F(!P),children:[n.jsx("div",{className:"flex items-center gap-3",children:n.jsx("h3",{className:"font-bold text-toss-gray-900",children:"  "})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:k=>{k.stopPropagation(),O(!0)},className:"p-2 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:n.jsx(Xy,{size:18})}),n.jsx("button",{onClick:k=>{k.stopPropagation(),ce()},className:"p-2 text-toss-gray-600 hover:bg-blue-100 rounded-lg transition-colors",title:" ",children:n.jsx(na,{size:18})}),P?n.jsx(sl,{size:20,className:"text-toss-gray-500"}):n.jsx(no,{size:20,className:"text-toss-gray-500"})]})]}),P&&n.jsx("div",{className:"p-4 sm:p-6",children:n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[ue,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-blue-50 border-2 border-blue-300 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"  "}),n.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[se,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[re,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]})]})})]}),n.jsxs(At,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-toss-gray-100",children:[n.jsxs("h3",{className:"font-bold text-toss-gray-900",children:["  ",n.jsxs("span",{className:"text-sm font-normal text-blue-600 ml-1",children:["(",se,")"]})]}),n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsxs(rt,{variant:"secondary",size:"sm",onClick:B,children:[n.jsx(Yy,{size:16,className:"mr-1"}),""]}),n.jsxs(rt,{variant:"secondary",size:"sm",onClick:()=>M.current?.click(),disabled:D,children:[n.jsx(uo,{size:16,className:"mr-1"}),D?" ...":""]}),n.jsx("input",{ref:M,type:"file",accept:".xlsx,.xls",onChange:z,className:"hidden"}),n.jsxs(rt,{variant:"secondary",size:"sm",onClick:ie,children:[n.jsx(ns,{size:16,className:"mr-1"}),""]}),n.jsxs(rt,{variant:"primary",size:"sm",onClick:ee,children:[n.jsx(Ns,{size:16,className:"mr-1"}),""]})]})]}),a?n.jsx("div",{className:"flex justify-center items-center py-20",children:n.jsx("div",{className:"w-10 h-10 border-4 border-toss-blue border-t-transparent rounded-full animate-spin"})}):Z.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-toss-gray-400",children:[n.jsx(bd,{size:48,className:"mb-4"}),n.jsx("p",{className:"text-lg font-medium",children:"    "}),n.jsx("p",{className:"text-sm mt-1",children:"+     "})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsxs("thead",{children:[n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-12",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",colSpan:2,children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-36",children:""})]}),n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{colSpan:6}),n.jsx("th",{className:"px-2 py-1 text-center text-[10px] font-medium text-toss-gray-500",children:" "}),n.jsx("th",{className:"px-2 py-1 text-center text-[10px] font-medium text-toss-gray-500",children:" "}),n.jsx("th",{colSpan:3})]})]}),n.jsx("tbody",{children:Z.map((k,de)=>{const U=Ku(k.admission_date),T=k.discharge_date;return n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors bg-blue-50/30",children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:de+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:k.location||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm font-medium text-toss-gray-900 text-center",children:Rs(k.admission_date)}),n.jsx("td",{className:"px-3 py-3 text-sm font-medium text-toss-gray-900 text-center",children:k.ganghwa||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:k.bupyeong||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:k.room||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-center",children:n.jsx("span",{className:`font-medium ${Qh(U)?"text-red-500":"text-blue-600"}`,children:Rs(U)})}),n.jsx("td",{className:"px-3 py-3 text-sm text-center",children:T&&T!==U?n.jsx("span",{className:`font-medium ${Qh(T)?"text-red-500":"text-orange-600"}`,children:Rs(T)}):n.jsx("span",{className:"text-toss-gray-400",children:"-"})}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center whitespace-pre-line",children:k.admin_status||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 max-w-[150px] truncate",children:k.notes||"-"}),n.jsx("td",{className:"px-2 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-1 whitespace-nowrap",children:[n.jsx("button",{onClick:()=>X(k.id),className:"px-2 py-1 text-xs font-medium text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",title:"",children:""}),n.jsx("button",{onClick:()=>Ne(k),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:"",children:n.jsx(aa,{size:16})}),n.jsx("button",{onClick:()=>q(k.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(cr,{size:16})})]})})]},k.id)})})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:Z.map((k,de)=>{const U=Ku(k.admission_date),T=k.discharge_date;return n.jsxs("div",{className:"px-3 py-2 bg-blue-50/30",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",de+1]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>X(k.id),className:"px-2 py-0.5 text-xs font-medium text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:()=>Ne(k),className:"p-1 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",children:n.jsx(aa,{size:14})}),n.jsx("button",{onClick:()=>q(k.id),className:"p-1 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(cr,{size:14})})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-x-2 gap-y-1 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:k.ganghwa||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-700",children:k.location||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-700",children:k.bupyeong||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:Rs(k.admission_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:" "}),n.jsx("p",{className:`font-medium ${Qh(U)?"text-red-500":"text-blue-600"}`,children:Rs(U)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-700",children:k.room||"-"})]}),T&&T!==U&&n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:" "}),n.jsx("p",{className:`font-medium ${Qh(T)?"text-red-500":"text-orange-600"}`,children:Rs(T)})]}),k.admin_status&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-500 whitespace-pre-line",children:k.admin_status})]}),k.notes&&n.jsxs("div",{className:"col-span-3",children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:k.notes})]})]})]},k.id)})})]})]}),we.length>0&&n.jsxs(At,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-gray-50 border-b border-toss-gray-200 cursor-pointer",onClick:()=>oe(!V),children:[n.jsxs("h3",{className:"font-bold text-toss-gray-700",children:["  ",n.jsxs("span",{className:"text-sm font-normal text-toss-gray-500 ml-1",children:["(",re,")"]})]}),V?n.jsx(sl,{size:20,className:"text-toss-gray-500"}):n.jsx(no,{size:20,className:"text-toss-gray-500"})]}),V&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-12",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-20",children:""})]})}),n.jsx("tbody",{children:we.map((k,de)=>n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors",children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 text-center",children:de+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.location||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:Rs(k.admission_date)}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.ganghwa||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.bupyeong||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.room||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:Rs(k.discharge_date)}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 text-center whitespace-pre-line",children:k.admin_status||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 max-w-[150px] truncate",children:k.notes||"-"}),n.jsx("td",{className:"px-3 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:()=>Ne(k),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",title:"",children:n.jsx(aa,{size:16})}),n.jsx("button",{onClick:()=>q(k.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(cr,{size:16})})]})})]},k.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:we.map((k,de)=>n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",de+1]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>Ne(k),className:"p-1.5 text-toss-blue hover:bg-blue-100 rounded-lg transition-colors",children:n.jsx(aa,{size:14})}),n.jsx("button",{onClick:()=>q(k.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(cr,{size:14})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:k.ganghwa||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:k.location||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:Rs(k.admission_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:Rs(k.discharge_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:k.bupyeong||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:k.room||"-"})]}),k.admin_status&&n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-400 whitespace-pre-line",children:k.admin_status})]}),k.notes&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-400",children:k.notes})]})]})]},k.id))})]})]}),n.jsx(yr,{isOpen:c,onClose:()=>{u(!1),v(null),S(Xu)},title:y?"  ":"  ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.ganghwa,onChange:k=>S({...N,ganghwa:k.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("input",{type:"text",value:N.location,onChange:k=>S({...N,location:k.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsxs("select",{value:N.bupyeong,onChange:k=>S({...N,bupyeong:k.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue bg-white",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("input",{type:"text",value:N.room,onChange:k=>S({...N,room:k.target.value}),placeholder:" ",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:N.admission_date,onChange:k=>S({...N,admission_date:k.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"}),N.admission_date&&n.jsxs("p",{className:"text-xs text-toss-gray-400 mt-1",children:[" : ",Rs(Ku(N.admission_date))," ( )"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:" "}),n.jsx("input",{type:"date",value:N.discharge_date,onChange:k=>S({...N,discharge_date:k.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue"}),n.jsx("p",{className:"text-xs text-toss-gray-400 mt-1",children:"  ,    "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("textarea",{value:N.admin_status,onChange:k=>S({...N,admin_status:k.target.value}),placeholder:"  (  )",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue resize-none"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("textarea",{value:N.notes,onChange:k=>S({...N,notes:k.target.value}),placeholder:" ",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-toss-blue/50 focus:border-toss-blue resize-none"})]}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx(rt,{variant:"secondary",className:"flex-1",onClick:()=>{u(!1),v(null),S(Xu)},children:""}),n.jsx(rt,{variant:"primary",className:"flex-1",onClick:Q,disabled:E,children:E?" ...":y?"":""})]})]})}),n.jsx(yr,{isOpen:d,onClose:()=>{h(!1),g(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 rounded-lg",children:[n.jsx(Gc,{size:24,className:"text-red-500 flex-shrink-0"}),n.jsx("p",{className:"text-sm text-red-700",children:"   ?     ."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(rt,{variant:"secondary",className:"flex-1",onClick:()=>{h(!1),g(null)},children:""}),n.jsx(rt,{variant:"danger",className:"flex-1",onClick:I,children:""})]})]})}),n.jsx(yr,{isOpen:m,onClose:()=>{x(!1),b(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 bg-orange-50 rounded-lg",children:[n.jsx(Jy,{size:24,className:"text-orange-500 flex-shrink-0"}),n.jsxs("p",{className:"text-sm text-orange-700",children:["   ?  (",Rs(new Date().toISOString().split("T")[0]),") ."]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(rt,{variant:"secondary",className:"flex-1",onClick:()=>{x(!1),b(null)},children:""}),n.jsx(rt,{variant:"primary",className:"flex-1 !bg-orange-500 hover:!bg-orange-600",onClick:H,children:" "})]})]})}),n.jsx(j5,{isOpen:L,onClose:()=>O(!1),records:W,stats:{total:ue,active:se,discharged:re},backgroundImage:"back_gw.jpg"})]})}const Yu=e=>{if(!e)return"";const t=new Date(e);return t.setMonth(t.getMonth()+4),t.toISOString().split("T")[0]},Ds=e=>e?e.replace(/-/g,"."):"-",e0=e=>{if(!e)return!1;const t=new Date(e),r=new Date,s=new Date(r.getFullYear(),r.getMonth()+1,r.getDate());return t<=s&&t>=r},hc=e=>{if(!e)return!0;const t=e.trim();return/^\d+?$/.test(t)},zo="bupyeong_admission_records",Ju={admission_date:"",name:"",gender:"",room:"",discharge_date:"",nationality:"",admin_status:"",notes:""};function dZ(){const{profile:e,isAdmin:t}=Yr(),[r,s]=Y.useState([]),[a,o]=Y.useState(!0),[c,u]=Y.useState(!1),[d,h]=Y.useState(!1),[m,x]=Y.useState(!1),[y,v]=Y.useState(null),[w,g]=Y.useState(null),[_,b]=Y.useState(null),[N,S]=Y.useState(Ju),[E,R]=Y.useState(!1),[L,O]=Y.useState(!1),[P,F]=Y.useState(!0),[V,oe]=Y.useState(!0),[D,K]=Y.useState(!1),M=Y.useRef(null),ae=Y.useCallback(async()=>{try{o(!0);const{data:k,error:de}=await Ue.from(zo).select("*").order("admission_date",{ascending:!1});if(de)throw de;s(k||[])}catch(k){console.error("   :",k)}finally{o(!1)}},[]);Y.useEffect(()=>{ae()},[ae]);const te=k=>{if(!k)return 1/0;const de=parseInt(k.replace(/[^0-9]/g,""),10);return isNaN(de)?1/0:de},Z=r.filter(k=>!k.is_discharged).sort((k,de)=>te(k.room)-te(de.room)),we=r.filter(k=>k.is_discharged),ee=()=>{v(null),S(Ju),u(!0)},Ne=k=>{v(k),S({admission_date:k.admission_date||"",name:k.name||"",gender:k.gender||"",room:k.room||"",discharge_date:k.discharge_date||"",nationality:k.nationality||"",admin_status:k.admin_status||"",notes:k.notes||""}),u(!0)},q=k=>{g(k),h(!0)},I=async()=>{if(w)try{const{error:k}=await Ue.from(zo).delete().eq("id",w);if(k)throw k;await ae()}catch(k){console.error(" :",k),alert("   .")}finally{h(!1),g(null)}},X=k=>{b(k),x(!0)},H=async()=>{if(_)try{const k=new Date().toISOString().split("T")[0],{error:de}=await Ue.from(zo).update({is_discharged:!0,discharge_date:k}).eq("id",_);if(de)throw de;await ae()}catch(k){console.error("  :",k),alert(`    .
${k?.message||JSON.stringify(k)}`)}finally{x(!1),b(null)}},Q=async()=>{if(!N.admission_date){alert(" .");return}if(!N.name){alert(" .");return}R(!0);try{const k={admission_date:N.admission_date,name:N.name,gender:N.gender,room:N.room,discharge_date:N.discharge_date||null,nationality:N.nationality,admin_status:N.admin_status,notes:N.notes};if(y){const{error:de}=await Ue.from(zo).update(k).eq("id",y.id);if(de)throw de}else{const{error:de}=await Ue.from(zo).insert({...k,is_discharged:!1});if(de)throw de}await ae(),u(!1),S(Ju),v(null)}catch(k){console.error(" :",k),alert(`   .
${k?.message||JSON.stringify(k)}`)}finally{R(!1)}},ie=()=>{if(r.length===0){alert("  .");return}const k=r.map((A,G)=>{const xe=hc(A.room)?Yu(A.admission_date):"";return{No:G+1,:A.nationality||"",:Ds(A.admission_date),:A.name||"",:A.gender||"","  ()":A.room||""," ":xe?Ds(xe):""," ":Ds(A.discharge_date),:A.admin_status||"",:A.notes||"",:A.is_discharged?"":" "}}),de=Fs.json_to_sheet(k),U=Fs.book_new();Fs.book_append_sheet(U,de,""),de["!cols"]=[{wch:5},{wch:12},{wch:14},{wch:12},{wch:8},{wch:15},{wch:14},{wch:14},{wch:15},{wch:25},{wch:10}];const T=new Date().toISOString().split("T")[0];Ud(U,`__${T}.xlsx`)},B=()=>{const k=[["","","","","  ()"," ","",""]],de=Fs.aoa_to_sheet(k),U=Fs.book_new();Fs.book_append_sheet(U,de,""),de["!cols"]=[{wch:12},{wch:14},{wch:12},{wch:8},{wch:15},{wch:14},{wch:15},{wch:25}],Ud(U,"__.xlsx")},z=async k=>{const de=k.target.files?.[0];if(de){M.current&&(M.current.value=""),K(!0);try{const U=await de.arrayBuffer(),T=Bd(U),A=T.Sheets[T.SheetNames[0]],G=Fs.sheet_to_json(A);if(G.length===0){alert("   .");return}const xe=Ce=>{if(!Ce)return"";if(typeof Ce=="number")return new Date((Ce-25569)*86400*1e3).toISOString().split("T")[0];const st=String(Ce).trim(),We=st.match(/(\d{4})[.\-/](\d{1,2})[.\-/](\d{1,2})/);if(We)return`${We[1]}-${We[2].padStart(2,"0")}-${We[3].padStart(2,"0")}`;const Ze=st.match(/(\d{2})[.\-/](\d{1,2})[.\-/](\d{1,2})/);if(Ze){const Re=parseInt(Ze[1],10);return`${Re>=50?1900+Re:2e3+Re}-${Ze[2].padStart(2,"0")}-${Ze[3].padStart(2,"0")}`}return st},be=G.map(Ce=>({admission_date:xe(Ce.||Ce.),name:String(Ce.||"").trim(),gender:String(Ce.||"").trim(),room:String(Ce["  ()"]||Ce.||"").trim(),discharge_date:xe(Ce[" "]||Ce.||Ce.),nationality:String(Ce.||Ce.||"").trim(),admin_status:String(Ce.||"").trim(),notes:String(Ce.||"").trim()})).filter(Ce=>Ce.admission_date);if(be.length===0){alert("  .  .");return}let ne=0,je=0,Me=0;for(const Ce of be){const st=r.find(We=>We.name===Ce.name&&We.admission_date===Ce.admission_date);if(st)if(st.room!==Ce.room||st.nationality!==Ce.nationality||st.admin_status!==Ce.admin_status||st.notes!==Ce.notes||st.gender!==Ce.gender){const{error:Ze}=await Ue.from(zo).update({name:Ce.name,gender:Ce.gender,room:Ce.room,nationality:Ce.nationality,admin_status:Ce.admin_status,notes:Ce.notes,discharge_date:Ce.discharge_date||null}).eq("id",st.id);if(Ze)throw Ze;je++}else Me++;else{const{error:We}=await Ue.from(zo).insert({admission_date:Ce.admission_date,name:Ce.name,gender:Ce.gender,room:Ce.room,discharge_date:Ce.discharge_date||null,nationality:Ce.nationality,admin_status:Ce.admin_status,notes:Ce.notes,is_discharged:!1});if(We)throw We;ne++}}await ae();const De=[];ne>0&&De.push(` : ${ne}`),je>0&&De.push(`: ${je}`),Me>0&&De.push(` : ${Me}`),alert(` !
${De.join(`
`)}`)}catch(U){console.error("  :",U),alert(`   .
${U?.message||JSON.stringify(U)}`)}finally{K(!1)}}},ue=r.length,se=Z.length,re=we.length,W=Z.map(k=>({id:k.id,admission_date:k.admission_date,bupyeong:k.gender,ganghwa:k.name,room:k.room,discharge_date:k.discharge_date,location:k.nationality,admin_status:k.admin_status,notes:k.notes})),ce=()=>{const de=`
      <div class="stats-grid">
        <div class="stat-box"><div class="label"> </div><div class="value">${ue}<span class="unit"> </span></div></div>
        <div class="stat-box highlight"><div class="label">  </div><div class="value">${se}<span class="unit"> </span></div></div>
        <div class="stat-box"><div class="label"> </div><div class="value">${re}<span class="unit"> </span></div></div>
      </div>
      <div class="section-title">   (${se})</div>
      <table>
        <thead><tr>
          <th>No</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th>  ()</th>
          <th> </th>
          <th> </th>
          <th></th>
          <th></th>
        </tr></thead>
        <tbody>
          ${Z.map((U,T)=>{const A=hc(U.room)?Yu(U.admission_date):"";return`<tr>
              <td style="text-align:center">${T+1}</td>
              <td style="text-align:center">${U.nationality||"-"}</td>
              <td style="text-align:center">${Ds(U.admission_date)}</td>
              <td style="text-align:center">${U.name||"-"}</td>
              <td style="text-align:center">${U.gender||"-"}</td>
              <td style="text-align:center">${U.room||"-"}</td>
              <td style="text-align:center">${A?Ds(A):"-"}</td>
              <td style="text-align:center">${U.discharge_date?Ds(U.discharge_date):"-"}</td>
              <td style="text-align:center;white-space:pre-line">${U.admin_status||"-"}</td>
              <td>${U.notes||"-"}</td>
            </tr>`}).join("")}
        </tbody>
      </table>
    `;il({title:"   ",content:de})};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(At,{className:"bg-gradient-to-r from-emerald-500 to-teal-600 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:n.jsx(bd,{size:24})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold mb-1",children:"  "}),n.jsx("p",{className:"text-white/90",children:t?"     ":"    "})]})]})}),n.jsxs(At,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-emerald-50 border-b border-emerald-100 cursor-pointer",onClick:()=>F(!P),children:[n.jsx("div",{className:"flex items-center gap-3",children:n.jsx("h3",{className:"font-bold text-toss-gray-900",children:"  "})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:k=>{k.stopPropagation(),O(!0)},className:"p-2 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",title:" ",children:n.jsx(Xy,{size:18})}),n.jsx("button",{onClick:k=>{k.stopPropagation(),ce()},className:"p-2 text-toss-gray-600 hover:bg-emerald-100 rounded-lg transition-colors",title:" ",children:n.jsx(na,{size:18})}),P?n.jsx(sl,{size:20,className:"text-toss-gray-500"}):n.jsx(no,{size:20,className:"text-toss-gray-500"})]})]}),P&&n.jsx("div",{className:"p-4 sm:p-6",children:n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[ue,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-emerald-50 border-2 border-emerald-300 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-emerald-600 mb-1",children:"  "}),n.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:[se,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]}),n.jsxs("div",{className:"bg-white border-2 border-toss-gray-200 rounded-xl p-3 text-center",children:[n.jsx("p",{className:"text-xs text-toss-gray-500 mb-1",children:" "}),n.jsxs("p",{className:"text-2xl font-bold text-toss-gray-900",children:[re,n.jsx("span",{className:"text-sm font-normal ml-1",children:""})]})]})]})})]}),n.jsxs(At,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-toss-gray-100",children:[n.jsxs("h3",{className:"font-bold text-toss-gray-900",children:["  ",n.jsxs("span",{className:"text-sm font-normal text-emerald-600 ml-1",children:["(",se,")"]})]}),n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsxs(rt,{variant:"secondary",size:"sm",onClick:B,children:[n.jsx(Yy,{size:16,className:"mr-1"}),""]}),n.jsxs(rt,{variant:"secondary",size:"sm",onClick:()=>M.current?.click(),disabled:D,children:[n.jsx(uo,{size:16,className:"mr-1"}),D?" ...":""]}),n.jsx("input",{ref:M,type:"file",accept:".xlsx,.xls",onChange:z,className:"hidden"}),n.jsxs(rt,{variant:"secondary",size:"sm",onClick:ie,children:[n.jsx(ns,{size:16,className:"mr-1"}),""]}),n.jsxs(rt,{variant:"primary",size:"sm",onClick:ee,children:[n.jsx(Ns,{size:16,className:"mr-1"}),""]})]})]}),a?n.jsx("div",{className:"flex justify-center items-center py-20",children:n.jsx("div",{className:"w-10 h-10 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin"})}):Z.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-toss-gray-400",children:[n.jsx(bd,{size:48,className:"mb-4"}),n.jsx("p",{className:"text-lg font-medium",children:"    "}),n.jsx("p",{className:"text-sm mt-1",children:"+     "})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsxs("thead",{children:[n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-12",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:"  ()"}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",colSpan:2,children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-24",children:""})]}),n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{colSpan:6}),n.jsx("th",{className:"px-2 py-1 text-center text-[10px] font-medium text-toss-gray-500",children:" "}),n.jsx("th",{className:"px-2 py-1 text-center text-[10px] font-medium text-toss-gray-500",children:" "}),n.jsx("th",{colSpan:3})]})]}),n.jsx("tbody",{children:Z.map((k,de)=>{const T=hc(k.room)?Yu(k.admission_date):"",A=k.discharge_date;return n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors bg-emerald-50/30",children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:de+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:k.nationality||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm font-medium text-toss-gray-900 text-center",children:Ds(k.admission_date)}),n.jsx("td",{className:"px-3 py-3 text-sm font-medium text-toss-gray-900 text-center",children:k.name||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:k.gender||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-700 text-center",children:k.room||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-center",children:T?n.jsx("span",{className:`font-medium ${e0(T)?"text-red-500":"text-emerald-600"}`,children:Ds(T)}):n.jsx("span",{className:"text-toss-gray-400",children:"-"})}),n.jsx("td",{className:"px-3 py-3 text-sm text-center",children:A&&A!==T?n.jsx("span",{className:`font-medium ${e0(A)?"text-red-500":"text-orange-600"}`,children:Ds(A)}):n.jsx("span",{className:"text-toss-gray-400",children:"-"})}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center whitespace-pre-line",children:k.admin_status||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 max-w-[150px] truncate",children:k.notes||"-"}),n.jsx("td",{className:"px-2 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-1 whitespace-nowrap",children:[n.jsx("button",{onClick:()=>X(k.id),className:"px-2 py-1 text-xs font-medium text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",title:"",children:""}),n.jsx("button",{onClick:()=>Ne(k),className:"p-1.5 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",title:"",children:n.jsx(aa,{size:16})}),n.jsx("button",{onClick:()=>q(k.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(cr,{size:16})})]})})]},k.id)})})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:Z.map((k,de)=>{const T=hc(k.room)?Yu(k.admission_date):"",A=k.discharge_date;return n.jsxs("div",{className:"px-3 py-2 bg-emerald-50/30",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",de+1]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>X(k.id),className:"px-2 py-0.5 text-xs font-medium text-orange-500 hover:bg-orange-100 rounded-lg transition-colors",children:""}),n.jsx("button",{onClick:()=>Ne(k),className:"p-1 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",children:n.jsx(aa,{size:14})}),n.jsx("button",{onClick:()=>q(k.id),className:"p-1 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(cr,{size:14})})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-x-2 gap-y-1 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:k.name||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-700",children:k.nationality||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-700",children:k.gender||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"font-medium text-toss-gray-900",children:Ds(k.admission_date)})]}),T&&n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:" "}),n.jsx("p",{className:`font-medium ${e0(T)?"text-red-500":"text-emerald-600"}`,children:Ds(T)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:"/"}),n.jsx("p",{className:"text-toss-gray-700",children:k.room||"-"})]}),A&&A!==T&&n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:" "}),n.jsx("p",{className:`font-medium ${e0(A)?"text-red-500":"text-orange-600"}`,children:Ds(A)})]}),k.admin_status&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-500 whitespace-pre-line",children:k.admin_status})]}),k.notes&&n.jsxs("div",{className:"col-span-3",children:[n.jsx("span",{className:"text-toss-gray-400 text-[11px]",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:k.notes})]})]})]},k.id)})})]})]}),we.length>0&&n.jsxs(At,{padding:"p-0",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 bg-gray-50 border-b border-toss-gray-200 cursor-pointer",onClick:()=>oe(!V),children:[n.jsxs("h3",{className:"font-bold text-toss-gray-700",children:["  ",n.jsxs("span",{className:"text-sm font-normal text-toss-gray-500 ml-1",children:["(",re,")"]})]}),V?n.jsx(sl,{size:20,className:"text-toss-gray-500"}):n.jsx(no,{size:20,className:"text-toss-gray-500"})]}),V&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-toss-gray-50 border-b border-toss-gray-200",children:[n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-12",children:"No"}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:"  ()"}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase",children:""}),n.jsx("th",{className:"px-3 py-3 text-center text-xs font-bold text-toss-gray-600 uppercase w-20",children:""})]})}),n.jsx("tbody",{children:we.map((k,de)=>n.jsxs("tr",{className:"border-b border-toss-gray-100 hover:bg-toss-gray-50 transition-colors",children:[n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 text-center",children:de+1}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.nationality||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:Ds(k.admission_date)}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.name||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.gender||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:k.room||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-500 text-center",children:Ds(k.discharge_date)}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 text-center whitespace-pre-line",children:k.admin_status||"-"}),n.jsx("td",{className:"px-3 py-3 text-sm text-toss-gray-400 max-w-[150px] truncate",children:k.notes||"-"}),n.jsx("td",{className:"px-3 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx("button",{onClick:()=>Ne(k),className:"p-1.5 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",title:"",children:n.jsx(aa,{size:16})}),n.jsx("button",{onClick:()=>q(k.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",title:"",children:n.jsx(cr,{size:16})})]})})]},k.id))})]})}),n.jsx("div",{className:"md:hidden divide-y divide-toss-gray-100",children:we.map((k,de)=>n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("span",{className:"text-xs text-toss-gray-400",children:["No. ",de+1]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>Ne(k),className:"p-1.5 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors",children:n.jsx(aa,{size:14})}),n.jsx("button",{onClick:()=>q(k.id),className:"p-1.5 text-red-500 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(cr,{size:14})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:k.name||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:k.nationality||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:Ds(k.admission_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:Ds(k.discharge_date)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-500",children:k.gender||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:"  ()"}),n.jsx("p",{className:"text-toss-gray-500",children:k.room||"-"})]}),k.admin_status&&n.jsxs("div",{children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-400 whitespace-pre-line",children:k.admin_status})]}),k.notes&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("span",{className:"text-toss-gray-400 text-xs",children:""}),n.jsx("p",{className:"text-toss-gray-400",children:k.notes})]})]})]},k.id))})]})]}),n.jsx(yr,{isOpen:c,onClose:()=>{u(!1),v(null),S(Ju)},title:y?"  ":"  ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:N.name,onChange:k=>S({...N,name:k.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("input",{type:"text",value:N.nationality,onChange:k=>S({...N,nationality:k.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsxs("select",{value:N.gender,onChange:k=>S({...N,gender:k.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 bg-white",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:"  ()"}),n.jsx("input",{type:"text",value:N.room,onChange:k=>S({...N,room:k.target.value}),placeholder:": 301  OO(301)",className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:[" ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:N.admission_date,onChange:k=>S({...N,admission_date:k.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"}),N.admission_date&&hc(N.room)&&n.jsxs("p",{className:"text-xs text-toss-gray-400 mt-1",children:[" : ",Ds(Yu(N.admission_date))," ( )"]}),N.admission_date&&!hc(N.room)&&n.jsx("p",{className:"text-xs text-orange-400 mt-1",children:"      "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:" "}),n.jsx("input",{type:"date",value:N.discharge_date,onChange:k=>S({...N,discharge_date:k.target.value}),className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500"}),n.jsx("p",{className:"text-xs text-toss-gray-400 mt-1",children:"  ,    "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("textarea",{value:N.admin_status,onChange:k=>S({...N,admin_status:k.target.value}),placeholder:"  (  )",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 resize-none"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-toss-gray-700 mb-1",children:""}),n.jsx("textarea",{value:N.notes,onChange:k=>S({...N,notes:k.target.value}),placeholder:" ",rows:3,className:"w-full px-3 py-2 border border-toss-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 resize-none"})]}),n.jsxs("div",{className:"flex gap-3 pt-2",children:[n.jsx(rt,{variant:"secondary",className:"flex-1",onClick:()=>{u(!1),v(null),S(Ju)},children:""}),n.jsx(rt,{variant:"primary",className:"flex-1",onClick:Q,disabled:E,children:E?" ...":y?"":""})]})]})}),n.jsx(yr,{isOpen:d,onClose:()=>{h(!1),g(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 rounded-lg",children:[n.jsx(Gc,{size:24,className:"text-red-500 flex-shrink-0"}),n.jsx("p",{className:"text-sm text-red-700",children:"   ?     ."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(rt,{variant:"secondary",className:"flex-1",onClick:()=>{h(!1),g(null)},children:""}),n.jsx(rt,{variant:"danger",className:"flex-1",onClick:I,children:""})]})]})}),n.jsx(yr,{isOpen:m,onClose:()=>{x(!1),b(null)},title:" ",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-4 bg-orange-50 rounded-lg",children:[n.jsx(Jy,{size:24,className:"text-orange-500 flex-shrink-0"}),n.jsxs("p",{className:"text-sm text-orange-700",children:["   ?  (",Ds(new Date().toISOString().split("T")[0]),") ."]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(rt,{variant:"secondary",className:"flex-1",onClick:()=>{x(!1),b(null)},children:""}),n.jsx(rt,{variant:"primary",className:"flex-1 !bg-orange-500 hover:!bg-orange-600",onClick:H,children:" "})]})]})}),n.jsx(j5,{isOpen:L,onClose:()=>O(!1),records:W,stats:{total:ue,active:se,discharged:re},backgroundImage:"back_bp.jpg"})]})}const yj=e=>e?e.length===3?e[0]+"O"+e[2]:e.length===2?e[0]+"O":e.length>=4?e[0]+"O".repeat(e.length-2)+e[e.length-1]:e:"",vj=e=>{if(!e)return"";const t=new Date(e);return t.getFullYear()+"."+String(t.getMonth()+1).padStart(2,"0")+"."+String(t.getDate()).padStart(2,"0")};function fZ(){const[e,t]=Y.useState([{id:1,roomNum:"",persons:[{date:"",gender:"",name:""},{date:"",gender:"",name:""}]}]),[r,s]=Y.useState(2),[a,o]=Y.useState(!1),[c,u]=Y.useState({col1:16.5,col2:53.6,col3:63.6,row1:23.4,row2:55.5}),[d,h]=Y.useState({data:23,name:31,room:22}),m=()=>{t(P=>[...P,{id:r,roomNum:"",persons:[{date:"",gender:"",name:""},{date:"",gender:"",name:""}]}]),s(P=>P+1)},x=P=>{t(F=>F.filter(V=>V.id!==P))},y=(P,F,V,oe)=>{t(D=>D.map(K=>{if(K.id!==P)return K;if(oe!==void 0){const M=[...K.persons];return M[oe]={...M[oe],[F]:V},{...K,persons:M}}return{...K,[F]:V}}))},v=()=>{t([{id:1,roomNum:"",persons:[{date:"",gender:"",name:""},{date:"",gender:"",name:""}]}]),s(2)},w=(P,F)=>u(V=>({...V,[P]:parseFloat(F)})),g=(P,F)=>h(V=>({...V,[P]:parseInt(F)})),_=()=>{const P=`col1:${c.col1} col2:${c.col2} col3:${c.col3} row1:${c.row1} row2:${c.row2} data:${d.data}px name:${d.name}px room:${d.room}px`;navigator.clipboard.writeText(P).then(()=>alert(": "+P))},b=c.col2-c.col1,N=c.col3-c.col2,S=100-c.col3,E=c.row2-c.row1,R=96-c.row2,L={roomNum:{left:0,top:"23.4%",width:`${c.col1}%`,height:"72.6%",fontSize:`${d.room}px`,fontWeight:900,color:"#000"},r1Date:{left:`${c.col1}%`,top:`${c.row1}%`,width:`${b}%`,height:`${E}%`,fontSize:`${d.data}px`,fontWeight:500},r1Gender:{left:`${c.col2}%`,top:`${c.row1}%`,width:`${N}%`,height:`${E}%`,fontSize:`${d.data}px`,fontWeight:500},r1Name:{left:`${c.col3}%`,top:`${c.row1}%`,width:`${S}%`,height:`${E}%`,fontSize:`${d.name}px`,fontWeight:800},r2Date:{left:`${c.col1}%`,top:`${c.row2}%`,width:`${b}%`,height:`${R}%`,fontSize:`${d.data}px`,fontWeight:500},r2Gender:{left:`${c.col2}%`,top:`${c.row2}%`,width:`${N}%`,height:`${R}%`,fontSize:`${d.data}px`,fontWeight:500},r2Name:{left:`${c.col3}%`,top:`${c.row2}%`,width:`${S}%`,height:`${R}%`,fontSize:`${d.name}px`,fontWeight:800}},O={position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"'Noto Sans KR', sans-serif",color:"#1d1d1f"};return n.jsxs(n.Fragment,{children:[n.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;900&display=swap');
        @media print {
          * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
          body { background: #fff !important; margin: 0 !important; padding: 0 !important; }
          .print-hide { display: none !important; }
          .nametag-print-area {
            display: flex !important; flex-wrap: wrap !important; flex-direction: row !important;
            gap: 4mm !important; justify-content: center !important; align-items: flex-start !important;
            padding: 5mm !important;
          }
          .nametag-tag-wrap {
            background: transparent !important; padding: 0 !important; margin: 0 !important;
            box-shadow: none !important; border: none !important;
            page-break-inside: avoid; break-inside: avoid;
            display: inline-block; width: auto; height: auto;
          }
          .nametag-box, .nametag-box * {
            box-shadow: none !important; outline: none !important;
            text-shadow: none !important; filter: none !important;
          }
          aside, header, nav, [class*="shadow-toss"] { display: none !important; }
          main, [class*="flex-1"], [class*="ml-64"] {
            margin: 0 !important; padding: 0 !important; width: 100% !important;
          }
          @page { margin: 5mm; size: auto; }
        }
      `}),n.jsxs("div",{className:"space-y-6",children:[n.jsx(At,{padding:"p-0",className:"print-hide overflow-hidden",children:n.jsx("div",{className:"bg-gradient-to-r from-toss-blue to-blue-600 p-6 md:p-8",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-toss flex items-center justify-center",children:n.jsx(_d,{size:24,className:"text-white"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-xl md:text-2xl font-bold text-white",children:" "}),n.jsx("p",{className:"text-blue-100 text-sm mt-1",children:"    "})]})]})})}),n.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[n.jsxs("div",{className:"w-full lg:w-[400px] lg:min-w-[400px] space-y-4 print-hide",children:[n.jsxs(At,{children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsxs("div",{children:[n.jsx("span",{className:"text-xs font-semibold text-toss-gray-500 uppercase tracking-wider",children:""}),n.jsxs("p",{className:"text-sm font-medium text-toss-gray-900 mt-1",children:[": ",n.jsx("strong",{children:"130 x 45 mm"})]})]})}),n.jsxs("div",{className:"flex gap-2 flex-wrap",children:[n.jsxs(rt,{size:"sm",variant:"primary",onClick:m,children:[n.jsx(Ns,{size:16})," "]}),n.jsxs(rt,{size:"sm",variant:"secondary",onClick:v,children:[n.jsx(CF,{size:16})," "]}),n.jsxs(rt,{size:"sm",variant:"primary",onClick:()=>window.print(),className:"ml-auto",children:[n.jsx(na,{size:16})," "]})]})]}),n.jsxs(At,{padding:"p-0",children:[n.jsxs("button",{onClick:()=>o(!a),className:"w-full flex items-center justify-between p-4 text-sm font-semibold text-toss-gray-700 hover:bg-toss-gray-50 transition-all rounded-toss-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(hl,{size:16,className:"text-toss-gray-500"}),"  ()"]}),a?n.jsx(sl,{size:16}):n.jsx(no,{size:16})]}),a&&n.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[n.jsx("div",{className:"text-[11px] font-semibold text-toss-gray-500 uppercase tracking-wider",children:" "}),[{label:"|",key:"col1",min:5,max:25},{label:"|",key:"col2",min:30,max:65},{label:"|",key:"col3",min:40,max:75}].map(P=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs text-toss-gray-500 min-w-[80px]",children:P.label}),n.jsx("input",{type:"range",min:P.min,max:P.max,step:"0.1",value:c[P.key],onChange:F=>w(P.key,F.target.value),className:"flex-1 h-1 accent-toss-blue"}),n.jsxs("span",{className:"text-xs text-toss-gray-400 min-w-[40px] text-right tabular-nums",children:[c[P.key],"%"]})]},P.key)),n.jsx("div",{className:"text-[11px] font-semibold text-toss-gray-500 uppercase tracking-wider pt-2",children:" "}),[{label:"|1",key:"row1",min:15,max:35},{label:"1|2",key:"row2",min:45,max:70}].map(P=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs text-toss-gray-500 min-w-[80px]",children:P.label}),n.jsx("input",{type:"range",min:P.min,max:P.max,step:"0.1",value:c[P.key],onChange:F=>w(P.key,F.target.value),className:"flex-1 h-1 accent-toss-blue"}),n.jsxs("span",{className:"text-xs text-toss-gray-400 min-w-[40px] text-right tabular-nums",children:[c[P.key],"%"]})]},P.key)),n.jsx("div",{className:"text-[11px] font-semibold text-toss-gray-500 uppercase tracking-wider pt-2",children:" "}),[{label:"/",key:"data",min:10,max:30},{label:"",key:"name",min:16,max:40},{label:"",key:"room",min:14,max:36}].map(P=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs text-toss-gray-500 min-w-[80px]",children:P.label}),n.jsx("input",{type:"range",min:P.min,max:P.max,step:"1",value:d[P.key],onChange:F=>g(P.key,F.target.value),className:"flex-1 h-1 accent-toss-blue"}),n.jsxs("span",{className:"text-xs text-toss-gray-400 min-w-[40px] text-right tabular-nums",children:[d[P.key],"px"]})]},P.key)),n.jsxs("button",{onClick:_,className:"mt-2 flex items-center gap-1 text-xs text-toss-gray-600 hover:text-toss-blue transition-colors",children:[n.jsx(u4,{size:12})," CSS  "]})]})]}),n.jsxs(At,{children:[n.jsxs("div",{className:"text-xs font-semibold text-toss-gray-500 uppercase tracking-wider mb-3",children:["  (",e.length,")"]}),n.jsx("div",{className:"space-y-3",children:e.map((P,F)=>n.jsxs("div",{className:"bg-toss-gray-50 rounded-toss p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-sm font-bold text-toss-gray-900",children:[" ",F+1]}),P.roomNum&&n.jsxs("span",{className:"text-[11px] font-semibold text-toss-blue bg-toss-blue/10 px-2 py-0.5 rounded-full",children:[P.roomNum,""]})]}),n.jsx("button",{onClick:()=>x(P.id),className:"text-toss-gray-400 hover:text-red-500 transition-colors",children:n.jsx(cr,{size:16})})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"text-xs font-medium text-toss-gray-500 min-w-[56px]",children:""}),n.jsx("input",{type:"text",placeholder:"102",value:P.roomNum,onChange:V=>y(P.id,"roomNum",V.target.value),className:"w-20 px-3 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"})]}),n.jsx("div",{className:"h-px bg-toss-gray-200 my-3"}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"text-xs font-medium text-toss-gray-500 min-w-[56px]",children:"1"}),n.jsxs("div",{className:"flex gap-1.5 flex-1 flex-wrap",children:[n.jsx("input",{type:"date",value:P.persons[0].date,onChange:V=>y(P.id,"date",V.target.value,0),className:"px-2.5 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"}),n.jsxs("select",{value:P.persons[0].gender,onChange:V=>y(P.id,"gender",V.target.value,0),className:"min-w-[60px] px-2 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]}),n.jsx("input",{type:"text",placeholder:"",value:P.persons[0].name,onChange:V=>y(P.id,"name",V.target.value,0),className:"flex-1 min-w-[70px] px-3 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs font-medium text-toss-gray-500 min-w-[56px]",children:"2"}),n.jsxs("div",{className:"flex gap-1.5 flex-1 flex-wrap",children:[n.jsx("input",{type:"date",value:P.persons[1].date,onChange:V=>y(P.id,"date",V.target.value,1),className:"px-2.5 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"}),n.jsxs("select",{value:P.persons[1].gender,onChange:V=>y(P.id,"gender",V.target.value,1),className:"min-w-[60px] px-2 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all",children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]}),n.jsx("input",{type:"text",placeholder:"",value:P.persons[1].name,onChange:V=>y(P.id,"name",V.target.value,1),className:"flex-1 min-w-[70px] px-3 py-2 bg-white border border-toss-gray-200 rounded-toss text-sm focus:outline-none focus:ring-2 focus:ring-toss-blue/20 focus:border-toss-blue transition-all"})]})]})]},P.id))})]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx(At,{className:"print-hide mb-4",children:n.jsx("span",{className:"text-xs font-semibold text-toss-gray-500 uppercase tracking-wider",children:""})}),n.jsx("div",{className:"nametag-print-area flex flex-col gap-6 items-center",children:e.length===0?n.jsx(At,{className:"w-full text-center py-16",children:n.jsx("p",{className:"text-toss-gray-400 text-sm",children:" "})}):e.map(P=>n.jsx("div",{className:"nametag-tag-wrap",children:n.jsxs("div",{className:"nametag-box",style:{width:"130mm",height:"45mm",position:"relative",backgroundImage:"url('/company-intranet/name.jpg')",backgroundSize:"100% 100%",backgroundRepeat:"no-repeat",overflow:"hidden"},children:[n.jsx("div",{style:{...O,...L.roomNum},children:P.roomNum?P.roomNum+"":""}),n.jsx("div",{style:{...O,...L.r1Date},children:vj(P.persons[0].date)}),n.jsx("div",{style:{...O,...L.r1Gender},children:P.persons[0].gender}),n.jsx("div",{style:{...O,...L.r1Name},children:yj(P.persons[0].name)}),n.jsx("div",{style:{...O,...L.r2Date},children:vj(P.persons[1].date)}),n.jsx("div",{style:{...O,...L.r2Gender},children:P.persons[1].gender}),n.jsx("div",{style:{...O,...L.r2Name},children:yj(P.persons[1].name)})]})},P.id))})]})]})]})]})}const hZ=({children:e})=>{const{user:t,loading:r}=Yr();return r?n.jsx("div",{className:"min-h-screen bg-toss-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-toss-blue border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-toss-gray-500",children:" ..."})]})}):t?e:n.jsx(Go,{to:"/login",replace:!0})},wj=({children:e})=>{const{user:t,loading:r}=Yr();return r?n.jsx("div",{className:"min-h-screen bg-toss-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"w-12 h-12 border-4 border-toss-blue border-t-transparent rounded-full animate-spin"})}):t?n.jsx(Go,{to:"/",replace:!0}):e};function mZ(){return n.jsxs(s8,{children:[n.jsx(zr,{path:"/login",element:n.jsx(wj,{children:n.jsx(YF,{})})}),n.jsx(zr,{path:"/register",element:n.jsx(wj,{children:n.jsx(JF,{})})}),n.jsxs(zr,{element:n.jsx(hZ,{children:n.jsx(XF,{})}),children:[n.jsx(zr,{path:"/",element:n.jsx(ZF,{})}),n.jsx(zr,{path:"/notices",element:n.jsx(IS,{})}),n.jsx(zr,{path:"/notices/:id",element:n.jsx(IS,{})}),n.jsx(zr,{path:"/events",element:n.jsx(KB,{})}),n.jsx(zr,{path:"/worklogs",element:n.jsx(Go,{to:"/worklogs/daily",replace:!0})}),n.jsx(zr,{path:"/worklogs/daily",element:n.jsx(IB,{})}),n.jsx(zr,{path:"/worklogs/weekly",element:n.jsx(BB,{})}),n.jsx(zr,{path:"/worklogs/monthly",element:n.jsx(qB,{})}),n.jsx(zr,{path:"/rescue",element:n.jsx(HB,{})}),n.jsx(zr,{path:"/meetings",element:n.jsx(GB,{})}),n.jsx(zr,{path:"/document",element:n.jsx(eU,{})}),n.jsx(zr,{path:"/archive",element:n.jsx(Go,{to:"/archive/forms",replace:!0})}),n.jsx(zr,{path:"/archive/:type",element:n.jsx(aU,{})}),n.jsx(zr,{path:"/document-ledger",element:n.jsx(iZ,{})}),n.jsx(zr,{path:"/leave",element:n.jsx(lZ,{})}),n.jsx(zr,{path:"/admission",element:n.jsx(Go,{to:"/admission/ganghwa",replace:!0})}),n.jsx(zr,{path:"/admission/ganghwa",element:n.jsx(uZ,{})}),n.jsx(zr,{path:"/admission/bupyeong",element:n.jsx(dZ,{})}),n.jsx(zr,{path:"/admission/nametag",element:n.jsx(fZ,{})}),n.jsx(zr,{path:"/admin",element:n.jsx(rU,{})}),n.jsx(zr,{path:"/mypage",element:n.jsx(XB,{})})]}),n.jsx(zr,{path:"*",element:n.jsx(Go,{to:"/",replace:!0})})]})}function pZ(){return n.jsx(GF,{children:n.jsx(j8,{basename:"/company-intranet/",children:n.jsx(xO,{children:n.jsx(mZ,{})})})})}const bj=!1,xZ=async()=>{if(h0.isNativePlatform())try{const{LiveUpdate:e}=await MC(async()=>{const{LiveUpdate:r}=await import("./index-jDat603S.js");return{LiveUpdate:r}},[]);(await e.sync()).nextBundleId}catch{}};xZ();VC.createRoot(document.getElementById("root")).render(n.jsx(Y.StrictMode,{children:n.jsx(pZ,{})}));export{Iy as W,MC as _,Ly as r};
